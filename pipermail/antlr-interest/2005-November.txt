From luisl at scarab.co.za  Tue Nov  1 08:40:52 2005
From: luisl at scarab.co.za (Luis Leal)
Date: Tue Nov  1 08:41:10 2005
Subject: [antlr-interest] More on _saveIndex bugs in 2.7.5
In-Reply-To: <000b01c5ddb8$06b0acd0$6902a8c0@hercules>
Message-ID: <MPEMLILMNEOKCPPBGEMKEEKDCIAA.luisl@scarab.co.za>

Perfect. I think it's a good idea to document it in the 2.x branch.

Regards

Luis

-----Original Message-----
From: Micheal J [mailto:open.zone@virgin.net]
Sent: 31 October 2005 03:11 AM
To: ''antlr-interest' Interest'
Subject: RE: [antlr-interest] More on _saveIndex bugs in 2.7.5


-- begin ---
> We don't think we can fix this without fairly involved
> changes to the 2.x codegen. The need to predict future
> _saveIndex usage in nested blocks being the showstopper.

It might be possible to alter the 2.x codegen so that it can switch the
destination of the output statements to a temp buffer. We can then flush the
temp buffer to the output file later. With this hack, it may be possible to
implement a fix to the current issue with _saveIndex without actually
solving (or needing to solve) the "future use prediction problem" above.

It looks possible but it's still quite a bit of work. I've got too much on
my plate currently so, perhaps save this for another time?. Or maybe drop
and fix in 3.x codegen.

Kunle
-- end   ---


I think we got most use cases with our _saveIndex fix in the 2.7.5 release.
My inclination is to document this as a known issue with some grammars with
the ANTLR2 branch and, look to fixing it for the ANTLR3 branch.

Cheers,

Micheal




From parrt at cs.usfca.edu  Tue Nov  1 11:31:55 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  1 11:32:01 2005
Subject: [antlr-interest] ANTLR2005 workshop proceedings / photos
Message-ID: <E784E4CB-9025-4551-93ED-472CA5B02031@cs.usfca.edu>

Howdy,

For your enjoyment:

http://www.antlr.org/workshop/ANTLR2005/summary.html

Lots of great talks and fun was had by all!  Thanks to all of the  
attendees. :)  Lots of great ideas floating around!

Terence
From antlr at shmuelhome.mine.nu  Tue Nov  1 13:49:40 2005
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Tue Nov  1 13:51:13 2005
Subject: [antlr-interest] ANTLR2005 workshop proceedings / photos
In-Reply-To: <E784E4CB-9025-4551-93ED-472CA5B02031@cs.usfca.edu>
References: <E784E4CB-9025-4551-93ED-472CA5B02031@cs.usfca.edu>
Message-ID: <4367E2F4.8000407@shmuelhome.mine.nu>

Terence Parr wrote:
> Howdy,
> 
> For your enjoyment:
> 
> http://www.antlr.org/workshop/ANTLR2005/summary.html
> 
> Lots of great talks and fun was had by all!  Thanks to all of the  
> attendees. :)  Lots of great ideas floating around!
> 
> Terence
> 
> 
I was reading the ANTLR-v3 powerpoint presentation. The following bullet
caught my attention.

"Does single token insertion or deletion if necessary to keep going"

Does this imply that you transparently support the latest definition for
ECMAScript virtual semicolons? I.e., if you reach a point that the
parser cannot consume the next token, insert a virtual semicolon and try
again.




-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.362 / Virus Database: 267.12.6/152 - Release Date: 10/31/2005



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.362 / Virus Database: 267.12.6/152 - Release Date: 10/31/2005

From wirecracker at gmail.com  Tue Nov  1 15:02:17 2005
From: wirecracker at gmail.com (eric nelson)
Date: Tue Nov  1 15:02:22 2005
Subject: [antlr-interest] Re: [stringtemplate-interest] Java In / Java Out
In-Reply-To: <9da4f4520510310912s14896a04m@mail.gmail.com>
References: <ca5eeb330510290518q120825a9o7fdceec2c33a23d7@mail.gmail.com>
	<9da4f4520510310912s14896a04m@mail.gmail.com>
Message-ID: <ca5eeb330511011502t7c511a1em74aa8dbe7cb968b6@mail.gmail.com>

Oliver,
 Thank you very much for the ideas :) I am not sure that it answers my
original question, but it does look like another way of doing it. I may try
using Java Beans, but my understanding is that this should be possible to do
without them. If I am wrong I hope someone will correct me, but otherwise
I'd like to pursue this attempt a little longer ;)
  - e


 On 10/31/05, Oliver Zeigermann <oliver.zeigermann@gmail.com> wrote:
>
> Hi Eric,
>
> I was doing limited Java to Java conversions as well. An example that
> describes how to generate Java sources from Java interface definitions
> can be found here:
>
> http://www.zeigermann.de/genEJB.zip
>
> May idea there was to separate the Java analysis (using ANTLR and a
> Java grammar) from the Java generation part (using StringTemplate)
> with an intermediate step that uses Java Beans for the tree
> representation of the Java interface. Java Beans looked good as they
> are familiar to the Java programmer and make a very good input for
> StringTemplate.
>
> HTH
>
> Oliver
>
> 2005/10/29, eric nelson <wirecracker@gmail.com>:
> > I'm trying to modify the java.g grammar file so that I can use
> > StringTemplate for outputting the file. The input is a Java file. I
> would
> > like the output to be Java also. So, yes, basically no change in content
> > ... mabye some spacing will differ here or there. I am still learning to
> > use ANTLR and StringTemplate and I've written a Java.stg file based on
> what
> > I think I know so far. Exerpts from java.g and Java.stg appear below.
> One
> > of the questions I have is how to handle the "|" (or) symbol (i.e.
> > classDefinition | interfaceDefinition). The way I have it right now
> there
> > would be a list of "modifiers", a list of "classDefinitions", and a list
> of
> > interfaceDefinitions (then naturally I would have a question about the "
> |
> > s:SEMI!" ... but one question at a time ;) So, the problem in Java.stgis
> > how to match up the correct "modifiers" with the corresponding
> > "interfaceDefinition" or "classDefinition". Or what if there is a
> > classDefinition with no modifier, etc. I am quite convinced that my
> > Java.stg template (typeDefinition in particular) and/or my java.g code
> has
> > erred somewhere. Any thoughts? This is HUGE since this will help me
> > understand how to approach the "field" rule in java.g .... if anyone has
> > some hints on a "field" template that would also be great! Thanks :) - e
> >
> >
> > java.g exerpt (java 1.3 grammar)
> >
> >
> //////////////////////////////////////////////////////////////////////////////////////////////////
> > // A type definition in a file is either a class or interface
> definition.
> > typeDefinition returns [StringTemplate
> > code=template("typeDefinition")]
> > options {defaultErrorHandler = true;}
> > {StringTemplate mod=null, cd=null, id=null, semi=null;}
> > : mod=m:modifiers! {code.setAttribute("modifiers", mod);}
> > ( cd=classDefinition[#m] { code.setAttribute("classDefinitions",
> > cd);}
> > | id=interfaceDefinition[#m]
> > {code.setAttribute("interfaceDefinitions", id);}
> > )
> > | s:SEMI!
> > {semi=template("lexer_semi");semi.setAttribute("semi",
> > s.getText());code.setAttribute("semi", semi);}
> > ;
> >
> >
> >
> //////////////////////////////////////////////////////////////////////////////////////////////////
> >
> >
> > Java.stg exerpt
> >
> >
> //////////////////////////////////////////////////////////////////////////////////////////////////
> > typeDefinition(modifiers,classDefinitions,interfaceDefinitions,semi)
> > ::= <<
> > <modifiers><classDefinitions><interfaceDefinitions><semi>
> > >>
> >
> >
> > modifiers(modifiers) ::= "<modifiers>"
> >
> > modifier(modifier) ::= "<modifier>"
> >
> > classDefinition(ident,superClassClause,implementsClause,classBlock)
> > ::= <<
> > class <ident> <superClassClause> <implementsClause>
> > <classBlock>
> > >>
> >
> > interfaceDefinition() ::= <<
> > not yet completed
> > >>
> >
> >
> //////////////////////////////////////////////////////////////////////////////////////////////////
> >
> > _______________________________________________
> > stringtemplate-interest mailing list
> > stringtemplate-interest@antlr.org
> > http://www.antlr.org/mailman/listinfo/stringtemplate-interest
> >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051101/242d5a8a/attachment.html
From parrt at cs.usfca.edu  Tue Nov  1 18:02:58 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  1 18:04:25 2005
Subject: [antlr-interest] ANTLR2005 workshop proceedings / photos
In-Reply-To: <4367E2F4.8000407@shmuelhome.mine.nu>
References: <E784E4CB-9025-4551-93ED-472CA5B02031@cs.usfca.edu>
	<4367E2F4.8000407@shmuelhome.mine.nu>
Message-ID: <1620C7BE-DEDF-4D37-B753-7B6AA758CECE@cs.usfca.edu>


On Nov 1, 2005, at 1:49 PM, shmuel siegel wrote:

> Terence Parr wrote:
>> Howdy,
>> For your enjoyment:
>> http://www.antlr.org/workshop/ANTLR2005/summary.html
>> Lots of great talks and fun was had by all!  Thanks to all of the   
>> attendees. :)  Lots of great ideas floating around!
>> Terence
> I was reading the ANTLR-v3 powerpoint presentation. The following  
> bullet
> caught my attention.
>
> "Does single token insertion or deletion if necessary to keep going"
>
> Does this imply that you transparently support the latest  
> definition for
> ECMAScript virtual semicolons? I.e., if you reach a point that the
> parser cannot consume the next token, insert a virtual semicolon  
> and try
> again.

The single token insertion works upon mismatched token; i.e., LA(1)! 
=t.  It asks if the current token LA(1) is actually something that  
can start what could follow the missing token t.  If so, it pretends  
to insert t and continues the parse.  In your case, if someone forgot  
a semicolon:

a=b
c=d;

then it would say c does not equal semicolon, but c is in fact what  
follows a semicolon; pretend to insert and continue.  So, the upshot  
is, that it might just work though you'd get a syntax error reported  
at the missing semicolon.

Ter
From yjargudo at tiscali.es  Wed Nov  2 01:15:33 2005
From: yjargudo at tiscali.es (yjargudo@tiscali.es)
Date: Wed Nov  2 01:16:48 2005
Subject: [antlr-interest] Re: C++ Comments (Digest 11/49)
In-Reply-To: <43621485.1000001@lsbu.ac.uk>
Message-ID: <4338009900008AB3@pop4.es.tisadm.net>

I used the lexer rule of  David Wigg's C++ grammar, that you can find in
antlr website, and I didn't have any problem
 


?Quieres sacar el m?ximo a tu conexi?n Tiscali?

Toda la informaci?n sobre como configurar tu conexi?n
en nuestra secci?n de Ayuda.
http://ayuda.tiscali.es/ayuda



From esof1 at student.cs.ucc.ie  Wed Nov  2 03:22:55 2005
From: esof1 at student.cs.ucc.ie (Edward Seamus O'Flynn)
Date: Wed Nov  2 03:22:59 2005
Subject: [antlr-interest] Recognising Java 1.4
Message-ID: <4363E3E9@webmail.ucc.ie>

Hi 
I am developing a project that will take an input of a piece of java code
and then transform this code, the only transformations I would be making would 
be adding counter variables around various pieces of java syntax.

My first question is where can i get a complete java 1.4 grammar?

My second is transforming the java code,once I can recognise the java syntax 
how do I go about transforming it, i.e adding more bits of syntax to it?

thanks
eddie.


From wirecracker at gmail.com  Wed Nov  2 04:05:49 2005
From: wirecracker at gmail.com (eric nelson)
Date: Wed Nov  2 04:05:50 2005
Subject: [antlr-interest] Recognising Java 1.4
In-Reply-To: <4363E3E9@webmail.ucc.ie>
References: <4363E3E9@webmail.ucc.ie>
Message-ID: <ca5eeb330511020405w3813f302o3d4003542cdd0d6@mail.gmail.com>

Can you show an example of what the output syntax would look like? How much
of a change are you talking about? It sounds like you might be doing
something similar to what I am working on. Basically I'm taking Java Input
and creating Java Output, with some minor changes to function names, global
variables, etc. My first goal is to just go from Java input to Java output
using ANTLR and StringTemplate. I am still stuck on that first step though
;) Good luck,
  - e


 On 11/2/05, Edward Seamus O'Flynn <esof1@student.cs.ucc.ie> wrote:
>
> Hi
> I am developing a project that will take an input of a piece of java code
> and then transform this code, the only transformations I would be making
> would
> be adding counter variables around various pieces of java syntax.
>
> My first question is where can i get a complete java 1.4 grammar?
>
> My second is transforming the java code,once I can recognise the java
> syntax
> how do I go about transforming it, i.e adding more bits of syntax to it?
>
> thanks
> eddie.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051102/9fd5de1f/attachment.html
From oliver.zeigermann at gmail.com  Wed Nov  2 10:47:55 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Wed Nov  2 10:48:02 2005
Subject: [antlr-interest] Recognising Java 1.4
In-Reply-To: <4363E3E9@webmail.ucc.ie>
References: <4363E3E9@webmail.ucc.ie>
Message-ID: <9da4f4520511021047q59b5e8b6q@mail.gmail.com>

You can find a Java grammar here:

http://www.antlr.org/grammar/list

Oliver

2005/11/2, Edward Seamus O'Flynn <esof1@student.cs.ucc.ie>:
> Hi
> I am developing a project that will take an input of a piece of java code
> and then transform this code, the only transformations I would be making would
> be adding counter variables around various pieces of java syntax.
>
> My first question is where can i get a complete java 1.4 grammar?
>
> My second is transforming the java code,once I can recognise the java syntax
> how do I go about transforming it, i.e adding more bits of syntax to it?
>
> thanks
> eddie.
>
>
>
From mansuk at gmail.com  Wed Nov  2 16:12:49 2005
From: mansuk at gmail.com (Suman Karumuri)
Date: Wed Nov  2 16:12:52 2005
Subject: [antlr-interest] Tree Construction for empty while loop
Message-ID: <c26541e00511021612p20aab56bhec97e32449237b6a@mail.gmail.com>

Hi all,

I have am constructing a grammar for a while loop using the following grammar.

stmt :       WHILE^ cond stmt_lst EOL!
stmt_lst : stmt_lst:       BEGIN^ (EOL!)* (stmt)* END!
                                 { ##.setType(STMT_LIST);##.setText("B"); }


This returns a tree of the form (WHILE (<cond>)  (B (stmt1) (stmt2) ... ) ).
This works for the following while loop:

while( a < b) {
//some statements
}

But it fails to construct a tree when there are no statements(i.e. an
empty while loop).

It only constucts (WHILE (<cond>) B). How can i get the tree as
(WHILE (<cond>) (B) ). Also what does ## signify?
TIA.
-Suman
From ewbank at gmail.com  Thu Nov  3 06:15:21 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Nov  3 06:15:24 2005
Subject: [antlr-interest] Tree Construction for empty while loop
In-Reply-To: <c26541e00511021612p20aab56bhec97e32449237b6a@mail.gmail.com>
References: <c26541e00511021612p20aab56bhec97e32449237b6a@mail.gmail.com>
Message-ID: <dd3a065f0511030615i365cd990o6e7f3de95434446c@mail.gmail.com>

I think it's working as you desire - it's producing a degenerate tree,
or a root.  In ANTLR, every node is a tree, and parens are used only
if there are children - they do not represent a level of the tree. 
Turned around, left nodes are not printed with parenthesis.

Since "B" is a leaf node when there are no statements, it is correctly
reporting "B" rather than "(B)" - just at it's reporting each
identifier as "name" rather than "(name)".

Your grammar will alway produce a WHILE with two children - the
conditional, and the statement list.  The statement list can have zero
or more children.  ANTLR would describe this tree thus:

   #( WHILE COND #( B (stmt)* ) )

I don't know what <cond> produces, so there is certainly more in the
first child of WHILE.

"##" means "currently active root node".

On 11/2/05, Suman Karumuri <mansuk@gmail.com> wrote:
> Hi all,
>
> I have am constructing a grammar for a while loop using the following grammar.
>
> stmt :       WHILE^ cond stmt_lst EOL!
> stmt_lst : stmt_lst:       BEGIN^ (EOL!)* (stmt)* END!
>                                  { ##.setType(STMT_LIST);##.setText("B"); }
>
>
> This returns a tree of the form (WHILE (<cond>)  (B (stmt1) (stmt2) ... ) ).
> This works for the following while loop:
>
> while( a < b) {
> //some statements
> }
>
> But it fails to construct a tree when there are no statements(i.e. an
> empty while loop).
>
> It only constucts (WHILE (<cond>) B). How can i get the tree as
> (WHILE (<cond>) (B) ). Also what does ## signify?
> TIA.
> -Suman
>
From jg at pcCFD.com  Thu Nov  3 12:32:19 2005
From: jg at pcCFD.com (Joseph Goettgens)
Date: Thu Nov  3 12:32:24 2005
Subject: [antlr-interest] Antlr 3 prerelease version
Message-ID: <001301c5e0b5$b1965910$1863a8c0@lynx>

Is there a downloadable prerelease version of antlr 3, possibly with C++ 
code generation? Sorry for the dumb question in case I overlooked it on 
antlr.org.

jg

From nbsherid at secsme.org.au  Thu Nov  3 13:01:48 2005
From: nbsherid at secsme.org.au (Nigel Sheridan-Smith)
Date: Thu Nov  3 13:01:50 2005
Subject: [antlr-interest] Antlr 3 prerelease version
In-Reply-To: <001301c5e0b5$b1965910$1863a8c0@lynx>
Message-ID: <000001c5e0b9$cec97d10$0500a8c0@nigel>


> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Joseph Goettgens
> Sent: Friday, 4 November 2005 7:32 AM
> To: antlr-interest
> Subject: [antlr-interest] Antlr 3 prerelease version
> 
> Is there a downloadable prerelease version of antlr 3, possibly with C++
> code generation? Sorry for the dumb question in case I overlooked it on
> antlr.org.
> 

Hidden away on a separate download page...

http://www.antlr.org/download
http://www.antlr.org/download/antlr-3.0ea3.tar.gz
http://www.antlr.org/download/antlrworks-1.0ea4.jar

Nigel

--
Nigel Sheridan-Smith
PhD research student

Faculty of Engineering
University of Technology, Sydney
Phone: 02 9514 7946
Fax: 02 9514 2435


From nbsherid at secsme.org.au  Thu Nov  3 13:03:40 2005
From: nbsherid at secsme.org.au (Nigel Sheridan-Smith)
Date: Thu Nov  3 13:03:39 2005
Subject: [antlr-interest] Antlr 3 prerelease version
In-Reply-To: <000001c5e0b9$cec97d10$0500a8c0@nigel>
Message-ID: <000101c5e0ba$112e40f0$0500a8c0@nigel>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Nigel Sheridan-Smith
> Sent: Friday, 4 November 2005 8:02 AM
> To: 'antlr-interest'
> Subject: RE: [antlr-interest] Antlr 3 prerelease version
> 
> 
> 
> Hidden away on a separate download page...
> 
> http://www.antlr.org/download
> http://www.antlr.org/download/antlr-3.0ea3.tar.gz
> http://www.antlr.org/download/antlrworks-1.0ea4.jar
> 

Sorry the latest ANTLR 3.0 is EA5, not EA3...

http://www.antlr.org/download/antlr-3.0ea5.tar.gz

--
Nigel Sheridan-Smith
PhD research student

Faculty of Engineering
University of Technology, Sydney
Phone: 02 9514 7946
Fax: 02 9514 2435


From parrt at cs.usfca.edu  Thu Nov  3 13:41:59 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Nov  3 13:43:19 2005
Subject: [antlr-interest] Antlr 3 prerelease version
In-Reply-To: <000101c5e0ba$112e40f0$0500a8c0@nigel>
References: <000101c5e0ba$112e40f0$0500a8c0@nigel>
Message-ID: <F5512903-FB32-4A59-B314-19D162A5327B@cs.usfca.edu>

On Nov 3, 2005, at 1:03 PM, Nigel Sheridan-Smith wrote:
>> http://www.antlr.org/download
>> http://www.antlr.org/download/antlr-3.0ea3.tar.gz
>> http://www.antlr.org/download/antlrworks-1.0ea4.jar
>>
>
> Sorry the latest ANTLR 3.0 is EA5, not EA3...
>
> http://www.antlr.org/download/antlr-3.0ea5.tar.gz

I have been meaning to get 3.0ea6 out (a huge improvement), but am  
overloaded with grad school duties at the moment and a presentation  
next week at Stanford (their grad seminar series).  It might be open  
to the public actually.

http://theory.stanford.edu/~mhn/sss.html

Ter

From open.zone at virgin.net  Thu Nov  3 18:08:00 2005
From: open.zone at virgin.net (Micheal J)
Date: Thu Nov  3 17:52:38 2005
Subject: [antlr-interest] [Re-]Building ANTLR on Windows is a $$$ pain!
	(but it doesn't have to be?)
In-Reply-To: <002701c5deab$7c4110e0$6902a8c0@hercules>
Message-ID: <000001c5e0e4$9580aad0$6402a8c0@hercules>

> Either that, or I'm having a really bad day.
> 
> Building from depot source. On a clean Windows install.

OK, this issue is still on-going but, if you are in a MS Windows shop
without access to 3rd party Unix emulation layers like Cygwin or Uwin, MS
might have a solution for you (that should help in convincing your IS/DP
management):

MS Services for Unix (SFU) 3.5

http://www.microsoft.com/windowsserversystem/sfu/productinfo/overview/defaul
t.mspx


Once I get over the novelty of ls-ing, gawk-ing and cat-ing natively on
Windows, I'll be filling my stocking with cool GNU pressies.

Once you've built GNU versions of make, grep, m4 etc to replace the supplied
ones, your ANTLR build experience should be similar to Cygwin user [and
Wolfgang's ;-)].

http://www.mrp3.com/using-interix.html

Cheers,

Micheal



From alberlau at gmail.com  Thu Nov  3 23:05:32 2005
From: alberlau at gmail.com (=?ISO-8859-2?Q?Albertas_Laurinavi=E8ius?=)
Date: Thu Nov  3 23:05:34 2005
Subject: [antlr-interest] Java grammar IMPLEMENTS_CLAUSE
Message-ID: <346ec18d0511032305m547e0dabl3d9418c672a4b31d@mail.gmail.com>

Hello
I'm using antlr to build AST from java source. ANTLR builds AST, except
IMPLEMENTS_CLAUSE and EXTENDS_CLAUSE nodes. I'm using ANTLR 2.7.5 and java
grammar file's supplied with distribution in examples dir. I tried other
grammars available at site too, but all of them lacks this functionality.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/b73b8a41/attachment.html
From alberlau at gmail.com  Thu Nov  3 23:11:23 2005
From: alberlau at gmail.com (=?ISO-8859-2?Q?Albertas_Laurinavi=E8ius?=)
Date: Thu Nov  3 23:11:26 2005
Subject: [antlr-interest] AST of PL/SQL and XML
Message-ID: <346ec18d0511032311p17791b3du7fe46db33925b40a@mail.gmail.com>

I'm new to ANTLR and language parsers too.
Is there any chnace to build AST for PL/SQL and XML? As far as i know i need
to have somegrammar.tree.g file, but i found that file for java grammar
only. Should i write that file myself, or i'm missing some points.

Thanx!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/45905fb9/attachment.html
From mail at martin-probst.com  Fri Nov  4 02:38:11 2005
From: mail at martin-probst.com (Martin Probst)
Date: Fri Nov  4 02:38:16 2005
Subject: [antlr-interest] AST of PL/SQL and XML
In-Reply-To: <346ec18d0511032311p17791b3du7fe46db33925b40a@mail.gmail.com>
References: <346ec18d0511032311p17791b3du7fe46db33925b40a@mail.gmail.com>
Message-ID: <1131100691.7981.4.camel@localhost.localdomain>

Hi,

> Is there any chnace to build AST for PL/SQL and XML? As far as i know
> i need to have somegrammar.tree.g file, but i found that file for java
> grammar only. 

The freely available grammars are not all distributed with ANTLR. You
can find them here:
> http://www.antlr.org/grammar/list
and there is also one for PL/SQL.

For XML it's usually completely sufficient to use a normal XML parser,
like the one that comes with the Java SDK, or any choice of the freely
available ones. An XML parser usually creates a DOM Tree or a list of
SAX events which you can then handle in your application.

> Should i write that file myself, or i'm missing some points.

Writing an XML parser is a very bad idea. There are high quality parsers
available and XML parsing can be surprisingly tricky sometimes...

Martin

From loic.lefevre at bnpparibas.com  Fri Nov  4 05:07:34 2005
From: loic.lefevre at bnpparibas.com (loic.lefevre@bnpparibas.com)
Date: Fri Nov  4 05:07:47 2005
Subject: [antlr-interest] ASM68000 grammar
Message-ID: <OF1606CEC6.9FA60C0B-ONC12570AF.003AFBD1-C12570AF.00481AC3@bnpparibas.com>

Hello,
Does anyone know where I could find a grammar for the ASM68000 langage?

Thanks in advance,
Lo?c


This message and any attachments (the "message") is
intended solely for the addressees and is confidential. 
If you receive this message in error, please delete it and 
immediately notify the sender. Any use not in accord with 
its purpose, any dissemination or disclosure, either whole 
or partial, is prohibited except formal approval. The internet
can not guarantee the integrity of this message. 
BNP PARIBAS (and its subsidiaries) shall (will) not 
therefore be liable for the message if modified. 

                ---------------------------------------------

Ce message et toutes les pieces jointes (ci-apres le 
"message") sont etablis a l'intention exclusive de ses 
destinataires et sont confidentiels. Si vous recevez ce 
message par erreur, merci de le detruire et d'en avertir 
immediatement l'expediteur. Toute utilisation de ce 
message non conforme a sa destination, toute diffusion 
ou toute publication, totale ou partielle, est interdite, sauf 
autorisation expresse. L'internet ne permettant pas 
d'assurer l'integrite de ce message, BNP PARIBAS (et ses
filiales) decline(nt) toute responsabilite au titre de ce 
message, dans l'hypothese ou il aurait ete modifie.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/922a1eeb/attachment.html
From alberlau at gmail.com  Fri Nov  4 05:36:37 2005
From: alberlau at gmail.com (=?ISO-8859-2?Q?Albertas_Laurinavi=E8ius?=)
Date: Fri Nov  4 05:36:39 2005
Subject: [antlr-interest] AST of PL/SQL and XML
In-Reply-To: <1131100691.7981.4.camel@localhost.localdomain>
References: <346ec18d0511032311p17791b3du7fe46db33925b40a@mail.gmail.com>
	<1131100691.7981.4.camel@localhost.localdomain>
Message-ID: <346ec18d0511040536s87351edy3693f16406564a6d@mail.gmail.com>

Martin,
yes i know http://www.antlr.org/grammar/list grammar list, and i don't want
to write my own xml parser. My task is to write tool that parses some source
code(Java,C#,Pl/SQL) into AST tree in unified way. As far as i know ANTLR
for that purpose uses somelanguage.tree.g file, that defines AST, i found
that file for java, but cannot find it for other languages. Maybe you can
make me point, how could i build AST tree without tree.g (AST Recognizer
Grammar).

On 11/4/05, Martin Probst <mail@martin-probst.com> wrote:
>
> Hi,
>
> > Is there any chnace to build AST for PL/SQL and XML? As far as i know
> > i need to have somegrammar.tree.g file, but i found that file for java
> > grammar only.
>
> The freely available grammars are not all distributed with ANTLR. You
> can find them here:
> > http://www.antlr.org/grammar/list
> and there is also one for PL/SQL.
>
> For XML it's usually completely sufficient to use a normal XML parser,
> like the one that comes with the Java SDK, or any choice of the freely
> available ones. An XML parser usually creates a DOM Tree or a list of
> SAX events which you can then handle in your application.
>
> > Should i write that file myself, or i'm missing some points.
>
> Writing an XML parser is a very bad idea. There are high quality parsers
> available and XML parsing can be surprisingly tricky sometimes...
>
> Martin
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/fa174009/attachment.html
From dragonoe at mcmaster.ca  Fri Nov  4 07:46:39 2005
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Fri Nov  4 07:42:52 2005
Subject: [antlr-interest] StringTemplate output issues
Message-ID: <20051104154639.GA13494@dragon.homelinux.org>

Hi,

I'm having problems with StringTemplate and I would appreciate very much
if someone with experience would help me to look through what is
happening and tell me what silly mistake I'm making :)

I am trying to use StringTemplate to generate code from a syntax tree.
I use an ANTLR grammar to parse the input code and generate the AST, and
a tree grammar to parse the AST and feed it to a template
(StringTemplate). I've based my tree grammar and template on the C- to
Java example found on stringtemplate.org.

However the template doesn't work. I'm getting the template text
literally, including the attribute placeholder. I've looked at the
toDebugString() output and everything looks good to me. I've even tried
to debug it through Eclipse and everything looks fine there too. Here's
my result:

<units; separator="\nc\n">

And the debug string:


template-<programUnits([units])@10>:chunks=[<units; separator="\nc\n">]attributes=[units=template-<subroutine([name, parameters])@11>:chunks=[      subroutine <name> (<parameters>),
,
,       end]attributes=[parameters=template-<commaSeparatedList([listItems])@12>:chunks=[<listItems; separator=", ">]attributes=[listItems=[incy, cy, ca, cx, n, incx]],name=caxpy]]


And the exerpt from my main program, where CodePrinter is the name of
the TreeParser class:

        CodePrinter printer = new CodePrinter();
        File tmpl = new File("fortran77/printer/f77-code_template.stg");
        printer.setTemplates(new StringTemplateGroup(new FileReader(tmpl)));
        StringTemplate code = printer.program(tree);
        System.out.println(code.toString());
        System.out.println(code.toDebugString());


I'm attaching my tree grammar and template files in case it could be
useful.

Thank you. I very much appreciate any help.

-Olivier

-- 
          __-/|    ? ?     |\-__
     __--/  /  \   (^^)   /  \  \--__
  _-/   /   /  /\ / ( )  /\  \   \   \-_
 /  /   /  /  /  (   ^^ ~  \  \  \   \  \
 / Oli Dragon    ( dragonoe@mcmaster.ca \
/  B.Eng. Sfwr   (     )    \    \  \    \
/  /  /    /__--_ (   ) __--__\    \  \  \
|  /  /  _/        \_ \_       \_  \  \  |
 \/  / _/            \_ \_       \_ \  \/
  \_/ /                -\_\        \ \_/
    \/                    )         \/
                        *~
        ___--<***************>--___
       [http://dragon.homelinux.org]
        ~~~--<***************>--~~~
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/7ed32481/attachment-0001.bin
From dragonoe at mcmaster.ca  Fri Nov  4 08:10:53 2005
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Fri Nov  4 08:07:08 2005
Subject: [antlr-interest] StringTemplate output issues
In-Reply-To: <20051104154639.GA13494@dragon.homelinux.org>
References: <20051104154639.GA13494@dragon.homelinux.org>
Message-ID: <20051104161053.GB13711@dragon.homelinux.org>

Skipped content of type multipart/mixed-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051104/ad9745a9/attachment.bin
From parrt at cs.usfca.edu  Fri Nov  4 08:11:47 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov  4 08:11:51 2005
Subject: [antlr-interest] StringTemplate output issues
In-Reply-To: <20051104154639.GA13494@dragon.homelinux.org>
References: <20051104154639.GA13494@dragon.homelinux.org>
Message-ID: <C66B22ED-7701-4B82-ADAF-9264B0A5191F@cs.usfca.edu>

Hi.  Still not caught up on emails, but this one is easy.  Default  
delimiters are $..$.  Look for an example that sends in the  
AngleBracketsLexer.class or whatever it's called to the Group ctor. :)

Ter
On Nov 4, 2005, at 7:46 AM, Olivier Dragon wrote:

[snip]

> However the template doesn't work. I'm getting the template text
> literally, including the attribute placeholder. I've looked at the
> toDebugString() output and everything looks good to me. I've even  
> tried
> to debug it through Eclipse and everything looks fine there too.  
> Here's
> my result:
>
> <units; separator="\nc\n">

[snip]
From dtkien at usfca.edu  Fri Nov  4 08:51:11 2005
From: dtkien at usfca.edu (Kien Te Do)
Date: Fri Nov  4 08:51:13 2005
Subject: [antlr-interest] Java grammar IMPLEMENTS_CLAUSE
Message-ID: <1cb6171cb265.1cb2651cb617@usfca.edu>

> Hello
> I'm using antlr to build AST from java source. ANTLR builds AST, 
> exceptIMPLEMENTS_CLAUSE and EXTENDS_CLAUSE nodes. I'm using ANTLR 
> 2.7.5 and java
> grammar file's supplied with distribution in examples dir. I tried 
> othergrammars available at site too, but all of them lacks this 
> functionality.

With me it works well! Try:

#(CLASS_DEF modifiers IDENT e:extendsClause im:implementsClause
{System.out.println(e.toStringTree() + "\n"
                    + im.toStringTree());
}
objBlock )

-Kien
From greenj at ix.netcom.com  Fri Nov  4 10:43:14 2005
From: greenj at ix.netcom.com (John Green)
Date: Fri Nov  4 10:43:09 2005
Subject: [antlr-interest] Breaking a loop
Message-ID: <436BABC2.6000206@ix.netcom.com>

I've got a pre-existing language with a requirement like this:

    (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
    |    .
    )*

Hopefully my question is obvious from the example. I need to break the loop when I hit a certain production. Until that production is reached, arbitrary tokens are consumed by the ".". Assuming {break;} is a bad hack, what's a good way to do this in Antlr?

Cheers,
john at joanju dot com

From parrt at cs.usfca.edu  Fri Nov  4 12:30:23 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov  4 12:31:39 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <436BABC2.6000206@ix.netcom.com>
References: <436BABC2.6000206@ix.netcom.com>
Message-ID: <D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>

Add a semantic predicate in front of alt(s) that says when to break :)
Ter
On Nov 4, 2005, at 10:43 AM, John Green wrote:

> I've got a pre-existing language with a requirement like this:
>
>    (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>    |    .
>    )*
>
> Hopefully my question is obvious from the example. I need to break  
> the loop when I hit a certain production. Until that production is  
> reached, arbitrary tokens are consumed by the ".". Assuming  
> {break;} is a bad hack, what's a good way to do this in Antlr?
>
> Cheers,
> john at joanju dot com
>

From greenj at ix.netcom.com  Fri Nov  4 13:13:54 2005
From: greenj at ix.netcom.com (John Green)
Date: Fri Nov  4 13:14:41 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>
References: <436BABC2.6000206@ix.netcom.com>
	<D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>
Message-ID: <436BCF12.2030706@ix.netcom.com>

The semantic predicate would be awful complex, since it would have to check for:
  (io_opt)* state_end
In other words, I'd have to hand-code a syntactic predicate into the semantic predicate.


Terence Parr wrote:
> Add a semantic predicate in front of alt(s) that says when to break :)
> Ter
> On Nov 4, 2005, at 10:43 AM, John Green wrote:
> 
>> I've got a pre-existing language with a requirement like this:
>>
>>    (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>>    |    .
>>    )*
>>
>> Hopefully my question is obvious from the example. I need to break the 
>> loop when I hit a certain production. Until that production is 
>> reached, arbitrary tokens are consumed by the ".". Assuming {break;} 
>> is a bad hack, what's a good way to do this in Antlr?
>>
>> Cheers,
>> john at joanju dot com
>>
> 
> 
> 


From parrt at cs.usfca.edu  Fri Nov  4 14:23:54 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov  4 14:25:09 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <436BCF12.2030706@ix.netcom.com>
References: <436BABC2.6000206@ix.netcom.com>
	<D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>
	<436BCF12.2030706@ix.netcom.com>
Message-ID: <91496311-714C-4A07-903B-7846671D8D2E@cs.usfca.edu>


On Nov 4, 2005, at 1:13 PM, John Green wrote:

> The semantic predicate would be awful complex, since it would have  
> to check for:
>  (io_opt)* state_end
> In other words, I'd have to hand-code a syntactic predicate into  
> the semantic predicate.

Does anything follow the loop that signals when to break?  You could  
use a greedy=false loop then.

Ter
From greenj at ix.netcom.com  Fri Nov  4 14:35:43 2005
From: greenj at ix.netcom.com (John Green)
Date: Fri Nov  4 14:35:38 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <91496311-714C-4A07-903B-7846671D8D2E@cs.usfca.edu>
References: <436BABC2.6000206@ix.netcom.com>
	<D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>
	<436BCF12.2030706@ix.netcom.com>
	<91496311-714C-4A07-903B-7846671D8D2E@cs.usfca.edu>
Message-ID: <436BE23F.1060708@ix.netcom.com>


Terence Parr wrote:
> Does anything follow the loop that signals when to break?  You could use 
> a greedy=false loop then.

Unfortunately, no. Any of the tokens in io_opt could also appear in the arbitrary token list (consumed by ".").

   (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
   |    .
   )*

It's only the syntax represented by ((io_opt)* state_end) which signals when to break.

(Yes, it's an ugly language, obviously implemented with an LR parser.)

The {break;} hack seems to work (with my quick regression tests, anyway), but the obvious concern is that a future change to Antlr's C++ code gen could mess up its effect. And I sure don't want to fall behind on Antlr versions.  :)





From parrt at cs.usfca.edu  Fri Nov  4 18:04:01 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov  4 18:05:15 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <436BE23F.1060708@ix.netcom.com>
References: <436BABC2.6000206@ix.netcom.com>
	<D2FE2DE6-677A-4CB1-A24C-081DF246C063@cs.usfca.edu>
	<436BCF12.2030706@ix.netcom.com>
	<91496311-714C-4A07-903B-7846671D8D2E@cs.usfca.edu>
	<436BE23F.1060708@ix.netcom.com>
Message-ID: <17E9683E-9F1D-4A64-A058-9BAB7A755E33@cs.usfca.edu>


On Nov 4, 2005, at 2:35 PM, John Green wrote:

>
> Terence Parr wrote:
>> Does anything follow the loop that signals when to break?  You  
>> could use a greedy=false loop then.
>
> Unfortunately, no. Any of the tokens in io_opt could also appear in  
> the arbitrary token list (consumed by ".").
>
>   (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>   |    .
>   )*
>
> It's only the syntax represented by ((io_opt)* state_end) which  
> signals when to break.
>
> (Yes, it's an ugly language, obviously implemented with an LR parser.)

Yep, we need a "not" syn pred ala Bryan Ford's PEG parser expression  
grammars.

>
> The {break;} hack seems to work (with my quick regression tests,  
> anyway), but the obvious concern is that a future change to Antlr's  
> C++ code gen could mess up its effect. And I sure don't want to  
> fall behind on Antlr versions.  :)

True, though the v2 version will stay as it is for a *long* time as  
I'm moving forward with v3.

Ter
From mansuk at gmail.com  Sat Nov  5 03:02:52 2005
From: mansuk at gmail.com (Suman Karumuri)
Date: Sat Nov  5 03:02:54 2005
Subject: [antlr-interest] Tree Construction for empty while loop
In-Reply-To: <dd3a065f0511030615i365cd990o6e7f3de95434446c@mail.gmail.com>
References: <c26541e00511021612p20aab56bhec97e32449237b6a@mail.gmail.com>
	<dd3a065f0511030615i365cd990o6e7f3de95434446c@mail.gmail.com>
Message-ID: <c26541e00511050302g2ce0c052q8ae5b98cc2848954@mail.gmail.com>

On 11/3/05, Bryan Ewbank <ewbank@gmail.com> wrote:
> I think it's working as you desire - it's producing a degenerate tree,
> or a root.  In ANTLR, every node is a tree, and parens are used only
> if there are children - they do not represent a level of the tree.
> Turned around, left nodes are not printed with parenthesis.
>
> Since "B" is a leaf node when there are no statements, it is correctly
> reporting "B" rather than "(B)" - just at it's reporting each
> identifier as "name" rather than "(name)".
>
This tricked me. All along i did not realise the importance of
equating a node with a tree. Now i see it.
Thanks bryan. Your comments were very useful.

-Suman
From ewbank at gmail.com  Sat Nov  5 04:45:54 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Sat Nov  5 04:45:56 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <436BABC2.6000206@ix.netcom.com>
References: <436BABC2.6000206@ix.netcom.com>
Message-ID: <dd3a065f0511050445u39267a3bt8f446b5b8bc589fe@mail.gmail.com>

Correct me if I'm wrong, or if the example was over-simplified, but
isn't this equivalent?

   ( ( state_end ) => state_end { break; }
   | .
   )*

No need to chew through the (io_opt)* because it will /always/ match
just before a state_end.

It's still the same fundamental problem, but it is perhaps easier to
think about...

On 11/4/05, John Green <greenj@ix.netcom.com> wrote:
> I've got a pre-existing language with a requirement like this:
>
>     (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>     |    .
>     )*
>
From mansuk at gmail.com  Sat Nov  5 15:09:00 2005
From: mansuk at gmail.com (Suman Karumuri)
Date: Sat Nov  5 15:09:02 2005
Subject: [antlr-interest] Do we need an antlr tutorial
Message-ID: <c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>

Hi all,

I have been working on antlr for the past one month and i have
implemented a version of hoc(as described in "The unix programming
environment" by kernighan and pike) using antlr and python.

This is a complete language with loops,conditionals and functions.
>From the tree parser i generate a byte code which is interpretted by
the interpretter. One advantage of this system over hoc is that it is
easy to learn when compared to hoc. However, there are some minor
deviations from the hoc described in the book.

So, is working on the program to convert into a tutorial worth the
effort?If there is some interest i can put in my spare time in writing
the tutorial.There are also some code clean ups that should be done.

-Suman
From sohail at taggedtype.net  Sat Nov  5 15:28:30 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Sat Nov  5 15:28:35 2005
Subject: [antlr-interest] Do we need an antlr tutorial
In-Reply-To: <c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>
References: <c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>
Message-ID: <1131233311.12163.1.camel@localhost.localdomain>

On Sun, 2005-06-11 at 04:39 +0530, Suman Karumuri wrote:
> Hi all,
> 
> I have been working on antlr for the past one month and i have
> implemented a version of hoc(as described in "The unix programming
> environment" by kernighan and pike) using antlr and python.
> 
> This is a complete language with loops,conditionals and functions.
> >From the tree parser i generate a byte code which is interpretted by
> the interpretter. One advantage of this system over hoc is that it is
> easy to learn when compared to hoc. However, there are some minor
> deviations from the hoc described in the book.
> 
> So, is working on the program to convert into a tutorial worth the
> effort?If there is some interest i can put in my spare time in writing
> the tutorial.There are also some code clean ups that should be done.

Tutorials are always welcome, especially those with real applications.
The javadude antlr tutorial was awesome for this reason.

I vote yes.

Sohail

From ewbank at gmail.com  Sat Nov  5 16:12:08 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Sat Nov  5 16:12:11 2005
Subject: [antlr-interest] Do we need an antlr tutorial
In-Reply-To: <1131233311.12163.1.camel@localhost.localdomain>
References: <c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>
	<1131233311.12163.1.camel@localhost.localdomain>
Message-ID: <dd3a065f0511051612y44db5969o58fcfe4ce98e6e71@mail.gmail.com>

[Sorry for the "me too", but...]

There's always more to be learned, especially from substantial
tutorials and examples.  Even if you can't post a complete /tutorial/,
posting an /example/ is a great start.  Tutorial later!

I look forward to seeing anything you can share!

On 11/5/05, Sohail Somani <sohail@taggedtype.net> wrote:
> On Sun, 2005-06-11 at 04:39 +0530, Suman Karumuri wrote:
> > So, is working on the program to convert into a tutorial worth the
> > effort?If there is some interest i can put in my spare time in writing
> > the tutorial.There are also some code clean ups that should be done.
>
> Tutorials are always welcome, especially those with real applications.
> The javadude antlr tutorial was awesome for this reason.
From parrt at cs.usfca.edu  Sat Nov  5 16:57:37 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov  5 16:58:48 2005
Subject: [antlr-interest] Serious Bug when using BitSet generation-Forgot:
	USING ANTLR 2.7.5 !!!!
In-Reply-To: <001a01c5cdd9$e5e7faf0$0100a8c0@rexii>
References: <001a01c5cdd9$e5e7faf0$0100a8c0@rexii>
Message-ID: <30D96FF1-652A-41A0-AB9F-FF37D446E5DD@cs.usfca.edu>

Hi.  I'm looking into this for 2.7.6 release imminent this weekish.

First, this is a bug in your grammar right:

> commonLibraryBlock3
>  : {isCategory}? libraryDeclarations
>  | {isCategory}? ( )

that 2nd production is impossible, right?

Now, you have a rule with:

  | {isProgram}? ( )         ****************   NOTE : These kind of  
empty productions FAIL to match an empty Production when using BITSET  
generation !
  | {isCategory}? ( )
  | {isConstants}?   ( )

Now.  "( )" is not necessary, so remove those; extra code is  
generated I think.

Your intent is to have an if-then-else chain with predicates tested,  
right?  ANTLR should remove all lookahead for the last n-1  
productions as the lookahead clearly is the FOLLOW(your rule) and  
therefore identical for all n productions.  I'm stunned there is any  
lookahead even with no bitsets.  ANTLR should delete all lookahead  
for 2..n-1 productions.  Seems to me it's a bug that it *does* work  
without bitsets.  I'm making an example.

Ter

From parrt at cs.usfca.edu  Sat Nov  5 17:02:04 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov  5 17:03:13 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration-Forgot
In-Reply-To: <000501c5ce48$8721beb0$0100a8c0@rexii>
References: <000501c5ce48$8721beb0$0100a8c0@rexii>
Message-ID: <FA9F0DE1-1ECE-4C68-8FCD-34D9CDC95B4E@cs.usfca.edu>

> Hopefully we can find a solution to this "Empty Pruction & BitSet  
> wrong
> code generation".
>
> It has kept my puzzling about errors in my grammar for a long long  
> time,
> but I have put off investigating it because there had been other more
> important things to look at. However, I know had to solve it, and it
> turned out to be a Bug !

Hi.  Here is my test case:

class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   ;

b : A|D|F|G|H;

All is well.  It generates the following for rule a:

             if ((LA(1)==B)) {
                 match(B);
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p1)) {
                 {
                 }
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p2)) {
                 {
                 }
             }

clearly the bitsets are there.  Can you nail your bug down to a  
simple grammar like this that fails?

I realized that ANTLR will not (as I said in last email) delete the  
lookahead; it's smart enough to know that the predicates are only  
valid in the right context and so it keeps the lookahead the same.

Thanks,
Ter
From parrt at cs.usfca.edu  Sat Nov  5 17:14:54 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov  5 17:16:06 2005
Subject: [antlr-interest] action syntax proposal for v3
Message-ID: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>

Howdy.

While Ric Klaren was here, he and I decided a change in syntax would  
be useful for actions so that you can set code into more places in  
the output.  In fact, we'll be going further.  I think John Mitchell  
suggested that we expose the code gen templates to the user so they  
can alter things as they want without overrides and w/o creating a  
new output template file for ANTLR.  For example, if you want to  
change how ANTLR generates code for exception handling in rules, you  
might want to change the template once rather than cut/paste it  
yourself manually with exception rule clauses.  Perhaps:

@rule.exception {
         reportError(re);
         recover(input,re);
}

where template rule has a region called exception; in  
StringTemplateGroup notation (new for 2.3) you would do something  
similar so syntax is consistent.  This may let us avoid an option  
that turns off exception handling...you can just make rule.exception  
an empty action. :)

This provides flexibility.  In v2 we have named headers for C++ so  
you can stick where you need it for C++.  I'm extending that to just  
be @name{...}.  Currently in v3 rule init actions are:

rulename
init {
  blort
}
	: 	...
	;

We'd change this syntax also so @ implies action:

rulename
@init {
  blort
}
	:	...
	;

I hate to use a valuable symbol like @ for this but it's consistent  
with StringTemplateGroup's syntax, a good thing.

A grammar file might look like this:

grammar t;

@parser.header {
package org.antlr.foo;
}

@lexer.header {
package org.antlr.foo;
}

@parser.members {
int i; // parser needs this
}

@lexer.members {
int j; // lexer needs this, dude
}

a : ID {i++;} ;

ID : 'a'..'z'+ {j++;} ;

It's very explicit but a bit more typing.  What do you think?  I like  
it.  Tweaks?  Counter proposals?

Ter
From sebastian.mies at gmx.net  Sun Nov  6 02:58:49 2005
From: sebastian.mies at gmx.net (Sebastian Mies)
Date: Sun Nov  6 02:59:16 2005
Subject: [antlr-interest] action syntax proposal for v3
In-Reply-To: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
References: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
Message-ID: <285644472.20051106115849@gmx.net>

Hi Terence,

this would be great!
There will be something like @rule.enter { } and @rule.exit { } I hope
;-)
I think adding some conditional generation would be nice too.
Something like:

@define(niceexceptions)
@if(niceexceptions) {
    @rule.exception { }
}

you could also add parameterization to grammars, like

grammar whatever(niceexceptions, ...)

this would avoid having multiple copies of a grammar, but
reduce refactoring capabilities.
It would also give the grammars a slight aspect-oriented touch.

Sebastian.

TP> Howdy.

TP> While Ric Klaren was here, he and I decided a change in syntax would
TP> be useful for actions so that you can set code into more places in
TP> the output.  In fact, we'll be going further.  I think John Mitchell
TP> suggested that we expose the code gen templates to the user so they
TP> can alter things as they want without overrides and w/o creating a
TP> new output template file for ANTLR.  For example, if you want to  
TP> change how ANTLR generates code for exception handling in rules, you
TP> might want to change the template once rather than cut/paste it  
TP> yourself manually with exception rule clauses.  Perhaps:

TP> @rule.exception {
TP>          reportError(re);
TP>          recover(input,re);
TP> }

TP> where template rule has a region called exception; in  
TP> StringTemplateGroup notation (new for 2.3) you would do something
TP> similar so syntax is consistent.  This may let us avoid an option
TP> that turns off exception handling...you can just make rule.exception
TP> an empty action. :)

TP> This provides flexibility.  In v2 we have named headers for C++ so
TP> you can stick where you need it for C++.  I'm extending that to just
TP> be @name{...}.  Currently in v3 rule init actions are:

TP> rulename
TP> init {
TP>   blort
TP> }
TP>         :       ...
TP>         ;

TP> We'd change this syntax also so @ implies action:

TP> rulename
TP> @init {
TP>   blort
TP> }
TP>         :       ...
TP>         ;

TP> I hate to use a valuable symbol like @ for this but it's consistent
TP> with StringTemplateGroup's syntax, a good thing.

TP> A grammar file might look like this:

TP> grammar t;

TP> @parser.header {
TP> package org.antlr.foo;
TP> }

TP> @lexer.header {
TP> package org.antlr.foo;
TP> }

TP> @parser.members {
TP> int i; // parser needs this
TP> }

TP> @lexer.members {
TP> int j; // lexer needs this, dude
TP> }

TP> a : ID {i++;} ;

TP> ID : 'a'..'z'+ {j++;} ;

TP> It's very explicit but a bit more typing.  What do you think? I like
TP> it.  Tweaks?  Counter proposals?

TP> Ter



-- 
Best regards,
Sebastian                            mailto:sebastian.mies@gmx.net

From mail at martin-probst.com  Sun Nov  6 03:38:52 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov  6 03:39:28 2005
Subject: [antlr-interest] action syntax proposal for v3
In-Reply-To: <285644472.20051106115849@gmx.net>
References: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
	<285644472.20051106115849@gmx.net>
Message-ID: <436DEB4C.9090106@martin-probst.com>

Hi,

> I think adding some conditional generation would be nice too.
> Something like:
> 
> @define(niceexceptions)
> @if(niceexceptions) {
>     @rule.exception { }
> }

Do I smell the C pre-processor and his macros-of-doom? I would be very 
careful to enable a macro-ish language aspect.

I would vote to rather provide specific options like this as runtime 
flags, e.g. "Parser.setContinueAfterErrors(true)". You really don't need 
a full blown macro compile-time language to provide such a small feature.

> It would also give the grammars a slight aspect-oriented touch.

Everytime I ask someone for an example for the use of Aspect Oriented 
Programming the only thing they can come up with is logging...

Martin
From sebastian.mies at gmx.net  Sun Nov  6 04:09:42 2005
From: sebastian.mies at gmx.net (Sebastian Mies)
Date: Sun Nov  6 04:09:25 2005
Subject: [antlr-interest] action syntax proposal for v3
In-Reply-To: <436DEB4C.9090106@martin-probst.com>
References: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
	<285644472.20051106115849@gmx.net> <436DEB4C.9090106@martin-probst.com>
Message-ID: <154849433.20051106130942@gmx.net>

Hi Martin,

>> I think adding some conditional generation would be nice too.
>> Something like:
>> 
>> @define(niceexceptions)
>> @if(niceexceptions) {
>>     @rule.exception { }
>> }

MP> Do I smell the C pre-processor and his macros-of-doom? I would be very
MP> careful to enable a macro-ish language aspect.
Well, actually this is no macro at all.

MP> I would vote to rather provide specific options like this as runtime
MP> flags, e.g. "Parser.setContinueAfterErrors(true)". You really don't need
MP> a full blown macro compile-time language to provide such a small feature.
I did not suggest a full-blown macro engine. Its just a way to generate
different versions of one grammar - when a runtime solution is not
suitable. And I admit, that it IS a small feature.

>> It would also give the grammars a slight aspect-oriented touch.

MP> Everytime I ask someone for an example for the use of Aspect Oriented
MP> Programming the only thing they can come up with is logging...
Well, the alternative is having lots of macros.
And BTW: there are many cases where aspect-oriented programming can be
helpful - considering synchronized versions of datastructures,
creating primitive versions...
Just consider ArrayList in java: if you want an IntArrayList you would
have to write one by copy, paste, and replace - that could be solved
with a nice aspect or you have to use a transformation tool, like
inject/j ;-)

Sebastian.



From peter at fortha.org  Sun Nov  6 08:35:23 2005
From: peter at fortha.org (Peter-Frank Spierenburg)
Date: Sun Nov  6 08:35:29 2005
Subject: [antlr-interest] rule classDef trapped: unexpected token: IDENTIFIER
Message-ID: <1131294923.26179.7.camel@greenlyph.fortha.org>

Greetings,

The TreeParser in the following grammar is giving me some problems. I
would actually prefer to have resourceTypeIdentifier in place of
IDENTIFIER in the toSQL rule, but

"The root of a tree pattern must be a token reference, but the children
elements can even be subrules." from
http://www.antlr.org/doc/sor.html#_bb1

I'm not sure why that is, but I can play along.

Does anyone have any ideas what I might be doing wrong?

$ java -cp ~/lib/antlr-2.7.5.jar antlr.Tool Query.g
ANTLR Parser Generator   Version 2.7.5 (20050128)   1989-2005 jGuru.com
Query.g:17:12: rule classDef trapped:
Query.g:17:12: unexpected token: IDENTIFIER
error: aborting grammar 'QueryTreeWalker' due to errors
Exiting due to errors.


// Query.g
class QueryParser extends Parser;
options {
    buildAST = true;
}
propertyExpression : resourceExpression OP_PROPERTY^
propertyNameIdentifier ;
resourceExpression : resourceTypeIdentifier ( OP_REFERENCE^
propertyNameIdentifier )* ;
resourceTypeIdentifier : IDENTIFIER ;
propertyNameIdentifier : IDENTIFIER ;

class QueryLexer extends Lexer;
WHITESPACE : ( ' ' | '\t' | '\n' { newline(); } | '\r' )+
{ $setType(Token.SKIP); } ;
IDENTIFIER : ('A'..'Z' | 'a'..'z')+ ;
OP_REFERENCE : '/' ;
OP_PROPERTY : '@' ;

class QueryTreeWalker extends TreeParser;
toSQL : #( IDENTIFIER ) ;

From sohail at taggedtype.net  Sun Nov  6 09:35:15 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Sun Nov  6 09:35:31 2005
Subject: [antlr-interest] action syntax proposal for v3
In-Reply-To: <436DEB4C.9090106@martin-probst.com>
References: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
	<285644472.20051106115849@gmx.net> <436DEB4C.9090106@martin-probst.com>
Message-ID: <1131298515.8198.1.camel@localhost.localdomain>

On Sun, 2005-06-11 at 12:38 +0100, Martin Probst wrote:
> > It would also give the grammars a slight aspect-oriented touch.
> 
> Everytime I ask someone for an example for the use of Aspect Oriented 
> Programming the only thing they can come up with is logging...

>From what little I know about AOP, I think it would work well for a
compiler operating on syntax trees. I think there are papers on aspect
oriented compilers (compilers written using the aspect oriented method).

AOP is kind of an intrusion (for better or worse) into normal OO ways of
thinking.

From sohail at taggedtype.net  Sun Nov  6 09:55:38 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Sun Nov  6 09:55:50 2005
Subject: [antlr-interest] rule classDef trapped: unexpected token:
	IDENTIFIER
In-Reply-To: <1131294923.26179.7.camel@greenlyph.fortha.org>
References: <1131294923.26179.7.camel@greenlyph.fortha.org>
Message-ID: <1131299739.8241.0.camel@localhost.localdomain>

On Sun, 2005-06-11 at 12:35 -0400, Peter-Frank Spierenburg wrote:
> Greetings,
> 
> The TreeParser in the following grammar is giving me some problems. I
> would actually prefer to have resourceTypeIdentifier in place of
> IDENTIFIER in the toSQL rule, but
> 
> "The root of a tree pattern must be a token reference, but the children
> elements can even be subrules." from
> http://www.antlr.org/doc/sor.html#_bb1

> class QueryTreeWalker extends TreeParser;
> toSQL : #( IDENTIFIER ) ;

replace toSQL with 

toSQL : IDENTIFIER;

You can't have a tree with no children afaik.

From canfield at computer.org  Sun Nov  6 09:58:50 2005
From: canfield at computer.org (Bill Canfield)
Date: Sun Nov  6 09:59:08 2005
Subject: [antlr-interest] action syntax proposal for v3
In-Reply-To: <20051106163530.2F800DCD6A@www.antlr.org>
References: <20051106163530.2F800DCD6A@www.antlr.org>
Message-ID: <436E445A.8020007@computer.org>

 >
 > This provides flexibility.  In v2 we have named headers for C++ so
 > you can stick where you need it for C++.  I'm extending that to just
 > be @name{...}.  Currently in v3 rule init actions are:
 >
 > rulename
 > init {
 >   blort
 > }
 > 	: 	...
 > 	;
 >
 > We'd change this syntax also so @ implies action:
 >
 > rulename
 > @init {
 >   blort
 > }
 > 	:	...
 > 	;
 >
 > I hate to use a valuable symbol like @ for this but it's consistent
 > with StringTemplateGroup's syntax, a good thing.
 >
Terence wrote:
> @rule.exception {
>          reportError(re);
>          recover(input,re);
> }
> 
> where template rule has a region called exception; in  
> StringTemplateGroup notation (new for 2.3) you would do something  
> similar so syntax is consistent.  This may let us avoid an option  
> that turns off exception handling...you can just make rule.exception  
> an empty action. :)

That sounds OK, but will we have to add empty actions for every region? 
  I'm assuming there would be rule.exception, branch.exception, 
label.exception... anything else?  I prefer "defaultErrorHandler=false" :-).

> A grammar file might look like this:
> 
> grammar t;
> 
> @parser.header {
> package org.antlr.foo;
> }
> 
> @lexer.header {
> package org.antlr.foo;
> }
> 
> @parser.members {
> int i; // parser needs this
> }
> 
> @lexer.members {
> int j; // lexer needs this, dude
> }
> 
> a : ID {i++;} ;
> 
> ID : 'a'..'z'+ {j++;} ;
> 
> It's very explicit but a bit more typing.  What do you think?  I like  
> it.  Tweaks?  Counter proposals?

This part looks very good.  The extra typing is worth it.  I assume the 
@*.members regions are where the member is declared inside the class. 
Is there a region for the definition of member functions?  Right now I 
just put them in a {...} after the grammar options, and they get put in 
  the .cpp file instead of the header.

Bill
From damon at agilefactor.com  Sun Nov  6 11:38:32 2005
From: damon at agilefactor.com (Damon Carr)
Date: Sun Nov  6 11:38:41 2005
Subject: [antlr-interest] RE: antlr-interest Digest, Vol 12, Issue 7
In-Reply-To: <20051106163530.38BC8DCD6C@www.antlr.org>
Message-ID: <20051106193839.7EEC6DCC35@www.antlr.org>

"Everytime I ask someone for an example for the use of Aspect Oriented 
Programming the only thing they can come up with is logging... "


What about run-time instrumentation of your application with no code? You
can write the status of every method call including parameter values and
names, time, machine, individual, etc. all with one AOP and should have the
ability to be turn off, typically. For production intelligence into the
run-time state of your applications it's the easiest 'no manual code'
technique I have found.

I all to often see developers deploying applications with no real
Instrumentation and have a 'logging' approach for exceptions. This is a very
'reactive' approach when instead , in addition to the AOP Instrumentation
(which, damn, I guess IS a form of logging (grin), you can add CPU Usage
(per processor), Network Bandwidth Utilization, Memory Usage and Page
Faults, etc.

This has allowed me in the past to monitor a family of servers and
applications via a command console (and you could use SNTP, WMI, or whatever
works) and PROACTIVELY see when trouble may be about to happen. Like the
server who's memory usage goes up linearly every week by 20MB (due to a
memory leek), or that you are CPU Bound typically around 9AM every day and
your requests/sec drop down to 2. So is this logging? Yes but it is more
then that. 

Another example.. IN .NET 1.0-1.1+ (pre 2.0) we had no type specific
collections (expect one for Strings). Therefore you had a problem with
boxing (a value type being stored in these collections always as a reference
type boxed on the managed heap) and no ability (unless you coded it) to
enforce the commonality of the Type(s) that were placed into these
collections.

I created an AOP Attribute that would automatically throw an exception if
the declarative types you specify in the attribute were not being placed in
the collection. There was no way to get around the boxing problem  really
(unless I somehow in my interception modified the storage Type from a
collection to Strongly Type array), but it was very useful to be able to
simply say:

[StronglyTypedCollectionAttribute(typeof(System.Guid),
typeof(System.String)]
This is synonymous in .NET:
[StronglyTypedCollection(typeof(System.Guid), typeof(System.String)]


For the Context Attribute the signature would be: 

StronglyTypedCollection(Type KeyType, Type ValueInCollectionType)

With an overload for simply ArrayList type collections of:

StronglyTypedCollection(Type ValueInCollectionType)

This full code sample is downloadable on www.gotdotnet.com under "Damon
Carr" I believe. Under 'User Samples'.

This would be for a qualified collection where the accessor key is a GUID
and the value is a String. So if I tried to say:

//Threadsafe for single line operations (but never for iteration)
public static Hashtable HashExample = Hashtable.Synchronized(new
Hashtable());

// Invalid Line
HashExample.Add(1533, new ArrayList());


This would throw an exception stating the Key was not a Guid and the Value
was not a String.

On a side note (I see this all too often) if you ARE dealing with a
multi-threaded static (for example) collection and iteration is occuring
remember YOU MUST use SyncRoot:

IDictionaryEnumerator Enumerator;
			
// Even with a synchronized collection 
// an exclusive lock is necessary for iteration
// I often see: lock(HashExample) which is useless and
// the cayuse of many 'mysterious' threading issues

lock(HashExample.SyncRoot)
{
	Enumerator = HashExample.GetEnumerator();
    
	while (Enumerator.MoveNext())
	{
		Trace.Assert(Enumerator.Key is Guid);
		Trace.Assert(Enumerator.Value is String);
	}


}


Sorry for the off-topic and ranting post.. Hope someone finds it usefull..

Kind Regards,
Damon Carr, CTO
agilefactor
www.agilefactor.com

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
antlr-interest-request@antlr.org
Sent: Sunday, November 06, 2005 10:35 AM
To: antlr-interest@antlr.org
Subject: antlr-interest Digest, Vol 12, Issue 7

Send antlr-interest mailing list submissions to
	antlr-interest@antlr.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://www.antlr.org/mailman/listinfo/antlr-interest
or, via email, send a message with subject or body 'help' to
	antlr-interest-request@antlr.org

You can reach the person managing the list at
	antlr-interest-owner@antlr.org

When replying, please edit your Subject line so it is more specific than
"Re: Contents of antlr-interest digest..."


Today's Topics:

   1. Do we need an antlr tutorial (Suman Karumuri)
   2. Re: Do we need an antlr tutorial (Sohail Somani)
   3. Re: Do we need an antlr tutorial (Bryan Ewbank)
   4. Re: Serious Bug when using BitSet generation-Forgot:	USING
      ANTLR 2.7.5 !!!! (Terence Parr)
   5. Re: Serious Bug when using BitSetgeneration-Forgot (Terence Parr)
   6. action syntax proposal for v3 (Terence Parr)
   7. Re: action syntax proposal for v3 (Sebastian Mies)
   8. Re: action syntax proposal for v3 (Martin Probst)
   9. Re[2]: [antlr-interest] action syntax proposal for v3
      (Sebastian Mies)
  10. rule classDef trapped: unexpected token: IDENTIFIER
      (Peter-Frank Spierenburg)


----------------------------------------------------------------------

Message: 1
Date: Sun, 6 Nov 2005 04:39:00 +0530
From: Suman Karumuri <mansuk@gmail.com>
Subject: [antlr-interest] Do we need an antlr tutorial
To: antlr-interest@antlr.org
Message-ID:
	<c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1

Hi all,

I have been working on antlr for the past one month and i have implemented a
version of hoc(as described in "The unix programming environment" by
kernighan and pike) using antlr and python.

This is a complete language with loops,conditionals and functions.
>From the tree parser i generate a byte code which is interpretted by
the interpretter. One advantage of this system over hoc is that it is easy
to learn when compared to hoc. However, there are some minor deviations from
the hoc described in the book.

So, is working on the program to convert into a tutorial worth the effort?If
there is some interest i can put in my spare time in writing the
tutorial.There are also some code clean ups that should be done.

-Suman


------------------------------

Message: 2
Date: Sat, 05 Nov 2005 15:28:30 -0800
From: Sohail Somani <sohail@taggedtype.net>
Subject: Re: [antlr-interest] Do we need an antlr tutorial
To: Suman Karumuri <mansuk@gmail.com>
Cc: antlr-interest@antlr.org
Message-ID: <1131233311.12163.1.camel@localhost.localdomain>
Content-Type: text/plain

On Sun, 2005-06-11 at 04:39 +0530, Suman Karumuri wrote:
> Hi all,
> 
> I have been working on antlr for the past one month and i have 
> implemented a version of hoc(as described in "The unix programming 
> environment" by kernighan and pike) using antlr and python.
> 
> This is a complete language with loops,conditionals and functions.
> >From the tree parser i generate a byte code which is interpretted by
> the interpretter. One advantage of this system over hoc is that it is 
> easy to learn when compared to hoc. However, there are some minor 
> deviations from the hoc described in the book.
> 
> So, is working on the program to convert into a tutorial worth the 
> effort?If there is some interest i can put in my spare time in writing 
> the tutorial.There are also some code clean ups that should be done.

Tutorials are always welcome, especially those with real applications.
The javadude antlr tutorial was awesome for this reason.

I vote yes.

Sohail



------------------------------

Message: 3
Date: Sat, 5 Nov 2005 19:12:08 -0500
From: Bryan Ewbank <ewbank@gmail.com>
Subject: Re: [antlr-interest] Do we need an antlr tutorial
To: ANTLR Interest <antlr-interest@antlr.org>
Message-ID:
	<dd3a065f0511051612y44db5969o58fcfe4ce98e6e71@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1

[Sorry for the "me too", but...]

There's always more to be learned, especially from substantial tutorials and
examples.  Even if you can't post a complete /tutorial/, posting an
/example/ is a great start.  Tutorial later!

I look forward to seeing anything you can share!

On 11/5/05, Sohail Somani <sohail@taggedtype.net> wrote:
> On Sun, 2005-06-11 at 04:39 +0530, Suman Karumuri wrote:
> > So, is working on the program to convert into a tutorial worth the 
> > effort?If there is some interest i can put in my spare time in 
> > writing the tutorial.There are also some code clean ups that should be
done.
>
> Tutorials are always welcome, especially those with real applications.
> The javadude antlr tutorial was awesome for this reason.


------------------------------

Message: 4
Date: Sat, 5 Nov 2005 16:57:37 -0800
From: Terence Parr <parrt@cs.usfca.edu>
Subject: Re: [antlr-interest] Serious Bug when using BitSet
	generation-Forgot:	USING ANTLR 2.7.5 !!!!
To: ANTLR Interest <antlr-interest@antlr.org>
Message-ID: <30D96FF1-652A-41A0-AB9F-FF37D446E5DD@cs.usfca.edu>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed

Hi.  I'm looking into this for 2.7.6 release imminent this weekish.

First, this is a bug in your grammar right:

> commonLibraryBlock3
>  : {isCategory}? libraryDeclarations
>  | {isCategory}? ( )

that 2nd production is impossible, right?

Now, you have a rule with:

  | {isProgram}? ( )         ****************   NOTE : These kind of  
empty productions FAIL to match an empty Production when using BITSET
generation !
  | {isCategory}? ( )
  | {isConstants}?   ( )

Now.  "( )" is not necessary, so remove those; extra code is generated I
think.

Your intent is to have an if-then-else chain with predicates tested, right?
ANTLR should remove all lookahead for the last n-1 productions as the
lookahead clearly is the FOLLOW(your rule) and therefore identical for all n
productions.  I'm stunned there is any lookahead even with no bitsets.
ANTLR should delete all lookahead for 2..n-1 productions.  Seems to me it's
a bug that it *does* work without bitsets.  I'm making an example.

Ter



------------------------------

Message: 5
Date: Sat, 5 Nov 2005 17:02:04 -0800
From: Terence Parr <parrt@cs.usfca.edu>
Subject: Re: [antlr-interest] Serious Bug when using
	BitSetgeneration-Forgot
To: ANTLR Interest <antlr-interest@antlr.org>
Message-ID: <FA9F0DE1-1ECE-4C68-8FCD-34D9CDC95B4E@cs.usfca.edu>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed

> Hopefully we can find a solution to this "Empty Pruction & BitSet 
> wrong code generation".
>
> It has kept my puzzling about errors in my grammar for a long long 
> time, but I have put off investigating it because there had been other 
> more important things to look at. However, I know had to solve it, and 
> it turned out to be a Bug !

Hi.  Here is my test case:

class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   ;

b : A|D|F|G|H;

All is well.  It generates the following for rule a:

             if ((LA(1)==B)) {
                 match(B);
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p1)) {
                 {
                 }
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p2)) {
                 {
                 }
             }

clearly the bitsets are there.  Can you nail your bug down to a simple
grammar like this that fails?

I realized that ANTLR will not (as I said in last email) delete the
lookahead; it's smart enough to know that the predicates are only valid in
the right context and so it keeps the lookahead the same.

Thanks,
Ter


------------------------------

Message: 6
Date: Sat, 5 Nov 2005 17:14:54 -0800
From: Terence Parr <parrt@cs.usfca.edu>
Subject: [antlr-interest] action syntax proposal for v3
To: ANTLR Interest <antlr-interest@antlr.org>
Cc: stringtemplate-interest@antlr.org
Message-ID: <FA75639E-5CB9-4A17-BAD1-4E4CF75C81C1@cs.usfca.edu>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed

Howdy.

While Ric Klaren was here, he and I decided a change in syntax would be
useful for actions so that you can set code into more places in the output.
In fact, we'll be going further.  I think John Mitchell suggested that we
expose the code gen templates to the user so they can alter things as they
want without overrides and w/o creating a new output template file for
ANTLR.  For example, if you want to change how ANTLR generates code for
exception handling in rules, you might want to change the template once
rather than cut/paste it yourself manually with exception rule clauses.
Perhaps:

@rule.exception {
         reportError(re);
         recover(input,re);
}

where template rule has a region called exception; in StringTemplateGroup
notation (new for 2.3) you would do something similar so syntax is
consistent.  This may let us avoid an option that turns off exception
handling...you can just make rule.exception an empty action. :)

This provides flexibility.  In v2 we have named headers for C++ so you can
stick where you need it for C++.  I'm extending that to just be @name{...}.
Currently in v3 rule init actions are:

rulename
init {
  blort
}
	: 	...
	;

We'd change this syntax also so @ implies action:

rulename
@init {
  blort
}
	:	...
	;

I hate to use a valuable symbol like @ for this but it's consistent with
StringTemplateGroup's syntax, a good thing.

A grammar file might look like this:

grammar t;

@parser.header {
package org.antlr.foo;
}

@lexer.header {
package org.antlr.foo;
}

@parser.members {
int i; // parser needs this
}

@lexer.members {
int j; // lexer needs this, dude
}

a : ID {i++;} ;

ID : 'a'..'z'+ {j++;} ;

It's very explicit but a bit more typing.  What do you think?  I like it.
Tweaks?  Counter proposals?

Ter


------------------------------

Message: 7
Date: Sun, 6 Nov 2005 11:58:49 +0100
From: Sebastian Mies <sebastian.mies@gmx.net>
Subject: Re: [antlr-interest] action syntax proposal for v3
To: Terence Parr <parrt@cs.usfca.edu>
Cc: stringtemplate-interest@antlr.org,	ANTLR Interest
	<antlr-interest@antlr.org>
Message-ID: <285644472.20051106115849@gmx.net>
Content-Type: text/plain; charset=us-ascii

Hi Terence,

this would be great!
There will be something like @rule.enter { } and @rule.exit { } I hope
;-)
I think adding some conditional generation would be nice too.
Something like:

@define(niceexceptions)
@if(niceexceptions) {
    @rule.exception { }
}

you could also add parameterization to grammars, like

grammar whatever(niceexceptions, ...)

this would avoid having multiple copies of a grammar, but reduce refactoring
capabilities.
It would also give the grammars a slight aspect-oriented touch.

Sebastian.

TP> Howdy.

TP> While Ric Klaren was here, he and I decided a change in syntax would 
TP> be useful for actions so that you can set code into more places in 
TP> the output.  In fact, we'll be going further.  I think John Mitchell 
TP> suggested that we expose the code gen templates to the user so they 
TP> can alter things as they want without overrides and w/o creating a 
TP> new output template file for ANTLR.  For example, if you want to 
TP> change how ANTLR generates code for exception handling in rules, you 
TP> might want to change the template once rather than cut/paste it 
TP> yourself manually with exception rule clauses.  Perhaps:

TP> @rule.exception {
TP>          reportError(re);
TP>          recover(input,re);
TP> }

TP> where template rule has a region called exception; in 
TP> StringTemplateGroup notation (new for 2.3) you would do something 
TP> similar so syntax is consistent.  This may let us avoid an option 
TP> that turns off exception handling...you can just make rule.exception 
TP> an empty action. :)

TP> This provides flexibility.  In v2 we have named headers for C++ so 
TP> you can stick where you need it for C++.  I'm extending that to just 
TP> be @name{...}.  Currently in v3 rule init actions are:

TP> rulename
TP> init {
TP>   blort
TP> }
TP>         :       ...
TP>         ;

TP> We'd change this syntax also so @ implies action:

TP> rulename
TP> @init {
TP>   blort
TP> }
TP>         :       ...
TP>         ;

TP> I hate to use a valuable symbol like @ for this but it's consistent 
TP> with StringTemplateGroup's syntax, a good thing.

TP> A grammar file might look like this:

TP> grammar t;

TP> @parser.header {
TP> package org.antlr.foo;
TP> }

TP> @lexer.header {
TP> package org.antlr.foo;
TP> }

TP> @parser.members {
TP> int i; // parser needs this
TP> }

TP> @lexer.members {
TP> int j; // lexer needs this, dude
TP> }

TP> a : ID {i++;} ;

TP> ID : 'a'..'z'+ {j++;} ;

TP> It's very explicit but a bit more typing.  What do you think? I like 
TP> it.  Tweaks?  Counter proposals?

TP> Ter



--
Best regards,
Sebastian                            mailto:sebastian.mies@gmx.net



------------------------------

Message: 8
Date: Sun, 06 Nov 2005 12:38:52 +0100
From: Martin Probst <mail@martin-probst.com>
Subject: Re: [antlr-interest] action syntax proposal for v3
To: Sebastian Mies <sebastian.mies@gmx.net>
Cc: stringtemplate-interest@antlr.org,	ANTLR Interest
	<antlr-interest@antlr.org>,	Terence Parr <parrt@cs.usfca.edu>
Message-ID: <436DEB4C.9090106@martin-probst.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi,

> I think adding some conditional generation would be nice too.
> Something like:
> 
> @define(niceexceptions)
> @if(niceexceptions) {
>     @rule.exception { }
> }

Do I smell the C pre-processor and his macros-of-doom? I would be very 
careful to enable a macro-ish language aspect.

I would vote to rather provide specific options like this as runtime 
flags, e.g. "Parser.setContinueAfterErrors(true)". You really don't need 
a full blown macro compile-time language to provide such a small feature.

> It would also give the grammars a slight aspect-oriented touch.

Everytime I ask someone for an example for the use of Aspect Oriented 
Programming the only thing they can come up with is logging...

Martin


------------------------------

Message: 9
Date: Sun, 6 Nov 2005 13:09:42 +0100
From: Sebastian Mies <sebastian.mies@gmx.net>
Subject: Re[2]: [antlr-interest] action syntax proposal for v3
To: Martin Probst <mail@martin-probst.com>
Cc: ANTLR Interest <antlr-interest@antlr.org>
Message-ID: <154849433.20051106130942@gmx.net>
Content-Type: text/plain; charset=us-ascii

Hi Martin,

>> I think adding some conditional generation would be nice too.
>> Something like:
>> 
>> @define(niceexceptions)
>> @if(niceexceptions) {
>>     @rule.exception { }
>> }

MP> Do I smell the C pre-processor and his macros-of-doom? I would be very
MP> careful to enable a macro-ish language aspect.
Well, actually this is no macro at all.

MP> I would vote to rather provide specific options like this as runtime
MP> flags, e.g. "Parser.setContinueAfterErrors(true)". You really don't need
MP> a full blown macro compile-time language to provide such a small
feature.
I did not suggest a full-blown macro engine. Its just a way to generate
different versions of one grammar - when a runtime solution is not
suitable. And I admit, that it IS a small feature.

>> It would also give the grammars a slight aspect-oriented touch.

MP> Everytime I ask someone for an example for the use of Aspect Oriented
MP> Programming the only thing they can come up with is logging...
Well, the alternative is having lots of macros.
And BTW: there are many cases where aspect-oriented programming can be
helpful - considering synchronized versions of datastructures,
creating primitive versions...
Just consider ArrayList in java: if you want an IntArrayList you would
have to write one by copy, paste, and replace - that could be solved
with a nice aspect or you have to use a transformation tool, like
inject/j ;-)

Sebastian.





------------------------------

Message: 10
Date: Sun, 06 Nov 2005 12:35:23 -0400
From: Peter-Frank Spierenburg <peter@fortha.org>
Subject: [antlr-interest] rule classDef trapped: unexpected token:
	IDENTIFIER
To: antlr-interest@antlr.org
Message-ID: <1131294923.26179.7.camel@greenlyph.fortha.org>
Content-Type: text/plain

Greetings,

The TreeParser in the following grammar is giving me some problems. I
would actually prefer to have resourceTypeIdentifier in place of
IDENTIFIER in the toSQL rule, but

"The root of a tree pattern must be a token reference, but the children
elements can even be subrules." from
http://www.antlr.org/doc/sor.html#_bb1

I'm not sure why that is, but I can play along.

Does anyone have any ideas what I might be doing wrong?

$ java -cp ~/lib/antlr-2.7.5.jar antlr.Tool Query.g
ANTLR Parser Generator   Version 2.7.5 (20050128)   1989-2005 jGuru.com
Query.g:17:12: rule classDef trapped:
Query.g:17:12: unexpected token: IDENTIFIER
error: aborting grammar 'QueryTreeWalker' due to errors
Exiting due to errors.


// Query.g
class QueryParser extends Parser;
options {
    buildAST = true;
}
propertyExpression : resourceExpression OP_PROPERTY^
propertyNameIdentifier ;
resourceExpression : resourceTypeIdentifier ( OP_REFERENCE^
propertyNameIdentifier )* ;
resourceTypeIdentifier : IDENTIFIER ;
propertyNameIdentifier : IDENTIFIER ;

class QueryLexer extends Lexer;
WHITESPACE : ( ' ' | '\t' | '\n' { newline(); } | '\r' )+
{ $setType(Token.SKIP); } ;
IDENTIFIER : ('A'..'Z' | 'a'..'z')+ ;
OP_REFERENCE : '/' ;
OP_PROPERTY : '@' ;

class QueryTreeWalker extends TreeParser;
toSQL : #( IDENTIFIER ) ;



------------------------------

_______________________________________________
antlr-interest mailing list
antlr-interest@antlr.org
http://www.antlr.org/mailman/listinfo/antlr-interest


End of antlr-interest Digest, Vol 12, Issue 7
*********************************************

From greenj at ix.netcom.com  Sun Nov  6 12:28:19 2005
From: greenj at ix.netcom.com (John Green)
Date: Sun Nov  6 12:28:26 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <dd3a065f0511050445u39267a3bt8f446b5b8bc589fe@mail.gmail.com>
References: <436BABC2.6000206@ix.netcom.com>
	<dd3a065f0511050445u39267a3bt8f446b5b8bc589fe@mail.gmail.com>
Message-ID: <436E6763.8030705@ix.netcom.com>

Hi Bryan,

Actually, the io_opt rule must be entered in order to build the correctly shaped tree. In other words, the tokens matched by "." are flat siblings in the tree, but some of the productions in io_opt create some parent/child branches in the tree.

Cheers,
John


Bryan Ewbank wrote:
> Correct me if I'm wrong, or if the example was over-simplified, but
> isn't this equivalent?
> 
>    ( ( state_end ) => state_end { break; }
>    | .
>    )*
> 
> No need to chew through the (io_opt)* because it will /always/ match
> just before a state_end.
> 
> It's still the same fundamental problem, but it is perhaps easier to
> think about...
> 
> On 11/4/05, John Green <greenj@ix.netcom.com> wrote:
>> I've got a pre-existing language with a requirement like this:
>>
>>     (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>>     |    .
>>     )*
>>
> 
> 


From eric.mahurin at gmail.com  Sun Nov  6 12:44:48 2005
From: eric.mahurin at gmail.com (Eric Mahurin)
Date: Sun Nov  6 12:44:50 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <436BABC2.6000206@ix.netcom.com>
References: <436BABC2.6000206@ix.netcom.com>
Message-ID: <29256ea00511061244m769bdef1nd98ae44c030b963a@mail.gmail.com>

On 11/4/05, John Green <greenj@ix.netcom.com> wrote:
>
> I've got a pre-existing language with a requirement like this:
>
> ( ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
> | .
> )*
>
> Hopefully my question is obvious from the example. I need to break the
> loop when I hit a certain production. Until that production is reached,
> arbitrary tokens are consumed by the ".". Assuming {break;} is a bad hack,
> what's a good way to do this in Antlr?
>
> Cheers,
> john at joanju dot com
>
>
Sorry, I meant to post this to the group. I accidentally did a reply instead
of reply-all. Used to another group where the reply-to field is the group.

The way to recursively specify this is (not sure if I have the right ANTLR
syntax):

x : ( (io_opt)* state_end )=> (io_opt)* state_end
| . x

I find that many complex loops with strange termination conditions are
easier specified with recursion. Terence, have you considered putting
tail-call optimization into ANTLR so that there isn't a downside with
specifying loops with recursion (actually infers a loop rather than
recursing)? For reference, here is how I would specify the above in my
Grammar parser:

Tail { |x|
(io_opt.repeat0 + state_end).lookahead | # .lookahead equivalent to self as
syntactic predicate
ANY + x
}

or a shorthand I have is (repeat0 method generates a Tail recursion
grammar):

ANY.repeat0((o_opt.repeat0 + state_end).lookahead)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051106/61915476/attachment.html
From wirecracker at gmail.com  Sun Nov  6 18:50:47 2005
From: wirecracker at gmail.com (eric nelson)
Date: Sun Nov  6 18:50:49 2005
Subject: [antlr-interest] Do we need an antlr tutorial
In-Reply-To: <dd3a065f0511051612y44db5969o58fcfe4ce98e6e71@mail.gmail.com>
References: <c26541e00511051509l1dd9ed19h4c47ab51edb41aaf@mail.gmail.com>
	<1131233311.12163.1.camel@localhost.localdomain>
	<dd3a065f0511051612y44db5969o58fcfe4ce98e6e71@mail.gmail.com>
Message-ID: <ca5eeb330511061850r5a0871c0nead03bd429e0fbef@mail.gmail.com>

Yes, please! Post anything you have :) I am desperate for a good solid
example! - e


 On 11/5/05, Bryan Ewbank <ewbank@gmail.com> wrote:
>
> [Sorry for the "me too", but...]
>
> There's always more to be learned, especially from substantial
> tutorials and examples. Even if you can't post a complete /tutorial/,
> posting an /example/ is a great start. Tutorial later!
>
> I look forward to seeing anything you can share!
>
> On 11/5/05, Sohail Somani <sohail@taggedtype.net> wrote:
> > On Sun, 2005-06-11 at 04:39 +0530, Suman Karumuri wrote:
> > > So, is working on the program to convert into a tutorial worth the
> > > effort?If there is some interest i can put in my spare time in writing
> > > the tutorial.There are also some code clean ups that should be done.
> >
> > Tutorials are always welcome, especially those with real applications.
> > The javadude antlr tutorial was awesome for this reason.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051106/e0314111/attachment.html
From StephenC at datacom.co.nz  Sun Nov  6 20:08:23 2005
From: StephenC at datacom.co.nz (Stephen Chell (DSL AK))
Date: Sun Nov  6 20:13:52 2005
Subject: [antlr-interest] ANTLR for C# newbie question
Message-ID: <5286F0898A34704BADDD6F9DDA0AC207E14C1C@dnzakex1.datacom.co.nz>

Hi all

I've installed ANTLR 2.7.5 onto a windows 2003 machine.  The download I
used was antlr-2.7.5.msi (zipped).

I want to use this to generate C# code in a Visual Studio.NET
environment, but I seem to be missing some important files needed for
the Antlr C# runtime environment.  The docs refer to a directory called
lib/csharp which apparently includes some Visual Studio.NET solution and
project files.  However, the lib directory that was created when I
installed the software did not include a csharp sub-directory.  It only
includes the following:

antlr.astframe.dll
antlr.jar
antlr.lib
antlr.py
antlr.runtime.dll
libantlr.a

Where do I get the missing files from?

Thanks in advance ...

Steve

From serge.bogdanov at intel.com  Mon Nov  7 03:58:32 2005
From: serge.bogdanov at intel.com (Bogdanov, Serge)
Date: Mon Nov  7 03:58:38 2005
Subject: [antlr-interest] Breaking a loop
Message-ID: <EFA13842B4FD55469C1A837C9C84964403643850@hdsmsx401.amr.corp.intel.com>

You would need a recursive rule to do something like that:

my_loop:
	io_opt my_loop
	|state_end
	;

>> Sergey Bogdanov
intel massachusetts
M/S HD2-246
77 Reed Road, 
Hudson, MA  01749
Tel: (978)553-2724
>-----Original Message-----
>From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
>bounces@antlr.org] On Behalf Of John Green
>Sent: Friday, November 04, 2005 16:14
>To: ANTLR Interest
>Subject: Re: [antlr-interest] Breaking a loop
>
>The semantic predicate would be awful complex, since it would have to
check
>for:
>  (io_opt)* state_end
>In other words, I'd have to hand-code a syntactic predicate into the
>semantic predicate.
>
>
>Terence Parr wrote:
>> Add a semantic predicate in front of alt(s) that says when to break
:)
>> Ter
>> On Nov 4, 2005, at 10:43 AM, John Green wrote:
>>
>>> I've got a pre-existing language with a requirement like this:
>>>
>>>    (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>>>    |    .
>>>    )*
>>>
>>> Hopefully my question is obvious from the example. I need to break
the
>>> loop when I hit a certain production. Until that production is
>>> reached, arbitrary tokens are consumed by the ".". Assuming {break;}
>>> is a bad hack, what's a good way to do this in Antlr?
>>>
>>> Cheers,
>>> john at joanju dot com
>>>
>>
>>
>>
>

From xdecoret at free.fr  Mon Nov  7 04:54:00 2005
From: xdecoret at free.fr (=?ISO-8859-1?Q?Xavier_D=E9coret?=)
Date: Mon Nov  7 04:54:09 2005
Subject: [antlr-interest] antlr and libtool
Message-ID: <436F4E68.4090608@free.fr>

Hi, weird question:

I am trying to release a rpm of a library based on antlr but I am 
getting rpmbuild error with libantlr.a.  My library is using libtool and 
it seems libtool has problems with the libanltr.a that is produced by 
the standard ANTLR installation tarball.  This tarball uses the 
autoconf/automake approach but does not use libtool.  Is there any good 
reason for that?

Would antlr library (for c++,for linux) be produced one day with 
libtool? I am willing to do the packaging for that but I would need to 
get the original configure.in, Makefile.am etc. of the distrib and not 
the one currently downloadable.
From geiroves at online.no  Mon Nov  7 05:19:33 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Mon Nov  7 05:20:03 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration-Forgot
In-Reply-To: <FA9F0DE1-1ECE-4C68-8FCD-34D9CDC95B4E@cs.usfca.edu>
Message-ID: <000501c5e39d$f1cf6a40$0100a8c0@rexii>

Hello,

I saw your reply first today. Maybe I do not understand your example,
but what give me problems when using BitSets are grammars like this:



class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   |			Emtpty Production: Generates problems using
BitSets, no Problem when NOT using Bitsets
   ;

b : A|D|F|G|H;



Geir Ove

-----Original Message-----
From: Terence Parr [mailto:parrt@cs.usfca.edu] 
Sent: 6. november 2005 02:02
To: ANTLR Interest
Cc: Geir Ove Skjaervik
Subject: Re: [antlr-interest] Serious Bug when using
BitSetgeneration-Forgot


> Hopefully we can find a solution to this "Empty Pruction & BitSet
> wrong
> code generation".
>
> It has kept my puzzling about errors in my grammar for a long long
> time,
> but I have put off investigating it because there had been other more
> important things to look at. However, I know had to solve it, and it
> turned out to be a Bug !

Hi.  Here is my test case:

class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   ;

b : A|D|F|G|H;

All is well.  It generates the following for rule a:

             if ((LA(1)==B)) {
                 match(B);
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p1)) {
                 {
                 }
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p2)) {
                 {
                 }
             }

clearly the bitsets are there.  Can you nail your bug down to a  
simple grammar like this that fails?

I realized that ANTLR will not (as I said in last email) delete the  
lookahead; it's smart enough to know that the predicates are only  
valid in the right context and so it keeps the lookahead the same.

Thanks,
Ter



From zhixueyong at hotmail.com  Mon Nov  7 08:44:06 2005
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Mon Nov  7 08:51:23 2005
Subject: [antlr-interest] Re: ANTLR for C# newbie question
References: <5286F0898A34704BADDD6F9DDA0AC207E14C1C@dnzakex1.datacom.co.nz>
Message-ID: <dko08m$gir$1@sea.gmane.org>

 The document(http://www.antlr.org/doc/csharp-runtime.html) is taking about 
how to build antlr c# runtime library from the source. And you downloaded 
the binary, so you got the prebuilt DLLs.

Xue Yong Zhi
http://seclib.blogspot.com

"Stephen Chell (DSL AK)" <StephenC@datacom.co.nz> 
wrote in message 
news:5286F0898A34704BADDD6F9DDA0AC207E14C1C@dnzakex1.datacom.co.nz...
Hi all

I've installed ANTLR 2.7.5 onto a windows 2003 machine.  The download I
used was antlr-2.7.5.msi (zipped).

I want to use this to generate C# code in a Visual Studio.NET
environment, but I seem to be missing some important files needed for
the Antlr C# runtime environment.  The docs refer to a directory called
lib/csharp which apparently includes some Visual Studio.NET solution and
project files.  However, the lib directory that was created when I
installed the software did not include a csharp sub-directory.  It only
includes the following:

antlr.astframe.dll
antlr.jar
antlr.lib
antlr.py
antlr.runtime.dll
libantlr.a

Where do I get the missing files from?

Thanks in advance ...

Steve




From seclib at seclib.com  Mon Nov  7 08:33:45 2005
From: seclib at seclib.com (Xue Yong Zhi)
Date: Mon Nov  7 08:53:41 2005
Subject: [antlr-interest] Re: ANTLR for C# newbie question
In-Reply-To: <5286F0898A34704BADDD6F9DDA0AC207E14C1C@dnzakex1.datacom.co.nz>
References: <5286F0898A34704BADDD6F9DDA0AC207E14C1C@dnzakex1.datacom.co.nz>
Message-ID: <436F81E9.2040005@seclib.com>

The document(http://www.antlr.org/doc/csharp-runtime.html) is taking 
about how to build antlr c# runtime library from the source. And you 
downloaded the binary, so you got the prebuilt DLLs.

Xue Yong Zhi
http://seclib.blogspot.com

Stephen Chell (DSL AK) wrote:
> Hi all
> 
> I've installed ANTLR 2.7.5 onto a windows 2003 machine.  The download I
> used was antlr-2.7.5.msi (zipped).
> 
> I want to use this to generate C# code in a Visual Studio.NET
> environment, but I seem to be missing some important files needed for
> the Antlr C# runtime environment.  The docs refer to a directory called
> lib/csharp which apparently includes some Visual Studio.NET solution and
> project files.  However, the lib directory that was created when I
> installed the software did not include a csharp sub-directory.  It only
> includes the following:
> 
> antlr.astframe.dll
> antlr.jar
> antlr.lib
> antlr.py
> antlr.runtime.dll
> libantlr.a
> 
> Where do I get the missing files from?
> 
> Thanks in advance ...
> 
> Steve
> 
> 

From greenj at ix.netcom.com  Mon Nov  7 11:54:29 2005
From: greenj at ix.netcom.com (John Green)
Date: Mon Nov  7 11:53:13 2005
Subject: [antlr-interest] Breaking a loop
In-Reply-To: <29256ea00511061244m769bdef1nd98ae44c030b963a@mail.gmail.com>
References: <436BABC2.6000206@ix.netcom.com>
	<29256ea00511061244m769bdef1nd98ae44c030b963a@mail.gmail.com>
Message-ID: <436FB0F5.9000507@ix.netcom.com>

Many thanks to Eric and to Sergey for suggesting recursion. That's exactly what I needed.

I wish I'd thought of it myself.  :)

Cheers


Eric Mahurin wrote:
> John Green wrote:
>>     I've got a pre-existing language with a requirement like this:
>> 
>>         (    ( (io_opt)* state_end )=> (io_opt)* state_end {break;}
>>         |    .
>>         )*
> 

> 
> Sorry, I meant to post this to the group.  I accidentally did a reply 
> instead of reply-all.  Used to another group where the reply-to field is 
> the group.
> 
> The way to recursively specify this is (not sure if I have the right 
> ANTLR syntax):
> 
> x : ( (io_opt)* state_end )=> (io_opt)* state_end
>    | . x
> 
> I find that many complex loops with strange termination conditions are 
> easier specified with recursion.  Terence, have you considered putting 
> tail-call optimization into ANTLR so that there isn't a downside with 
> specifying loops with recursion (actually infers a loop rather than 
> recursing)?  For reference, here is how I would specify the above in my 
> Grammar parser:
> 
> Tail { |x|
>   (io_opt.repeat0 + state_end).lookahead | # .lookahead equivalent to 
> self as syntactic predicate
>   ANY + x
> }
> 
> or a shorthand I have is (repeat0 method generates a Tail recursion 
> grammar):
> 
> ANY.repeat0((o_opt.repeat0 + state_end).lookahead)


From bijoys_2000 at yahoo.com  Mon Nov  7 12:46:39 2005
From: bijoys_2000 at yahoo.com (bijoy thomas)
Date: Mon Nov  7 12:46:48 2005
Subject: [antlr-interest] ANTLR question
Message-ID: <20051107204639.40659.qmail@web53506.mail.yahoo.com>

Hi all,

   I have been working with ANTLR for a while and came
across a wierd behaviour yesterday. For some reason
the call to getFirstChild() returns the while sibling
list instead of the first Child. I'm using version
2.7.4. For eg, 

A
|
|
- B -- C

Calling getFirstChild() on A returns (B C) instead of
just B. Anyone with similar experiences?

Thanks in advance,
Bijoy Thomas.



	
		
__________________________________ 
Yahoo! Mail - PC Magazine Editors' Choice 2005 
http://mail.yahoo.com
From parrt at cs.usfca.edu  Mon Nov  7 12:52:15 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov  7 12:53:20 2005
Subject: [antlr-interest] ANTLR question
In-Reply-To: <20051107204639.40659.qmail@web53506.mail.yahoo.com>
References: <20051107204639.40659.qmail@web53506.mail.yahoo.com>
Message-ID: <2426E963-042D-4788-80EF-7670C6987D16@cs.usfca.edu>

Hi. use toStringTree not toString to print and it will ignore the  
other siblings ;)

Ter
On Nov 7, 2005, at 12:46 PM, bijoy thomas wrote:

> Hi all,
>
>    I have been working with ANTLR for a while and came
> across a wierd behaviour yesterday. For some reason
> the call to getFirstChild() returns the while sibling
> list instead of the first Child. I'm using version
> 2.7.4. For eg,
>
> A
> |
> |
> - B -- C
>
> Calling getFirstChild() on A returns (B C) instead of
> just B. Anyone with similar experiences?
>
> Thanks in advance,
> Bijoy Thomas.
>
>
>
> 	
> 		
> __________________________________
> Yahoo! Mail - PC Magazine Editors' Choice 2005
> http://mail.yahoo.com

From bijoys_2000 at yahoo.com  Mon Nov  7 13:05:05 2005
From: bijoys_2000 at yahoo.com (bijoy thomas)
Date: Mon Nov  7 13:05:08 2005
Subject: [antlr-interest] ANTLR question  
Message-ID: <20051107210506.66129.qmail@web53501.mail.yahoo.com>


I'm trying to cycle through the nodes of a sibling
list by calling getFirstChild() on the root and then
calling getNextSibling() on the returned nodes untill
I get null.
 
But the call to getFirstChild() is returning the whole
sibling list itself.

Thanks,
Bijoy.


		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com
From ewbank at gmail.com  Mon Nov  7 13:30:34 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Mon Nov  7 13:30:38 2005
Subject: [antlr-interest] ANTLR question
In-Reply-To: <20051107210506.66129.qmail@web53501.mail.yahoo.com>
References: <20051107210506.66129.qmail@web53501.mail.yahoo.com>
Message-ID: <dd3a065f0511071330v2e3cd5b0x76bf65b26f58ee2f@mail.gmail.com>

Yes, that's exactly correct.  The implementation is a binary tree with
"left" meaning "child", and "right" meaning "sibling".  Also remember
that a sibling list /is/ a node (with a sibling), not a list.

If you draw your AST, then draw in the "1st child" and "next sibling"
relationshion, you will see that there is a binary tree (rotated 45
degrees :-).

What you are doing is exactly correct:
1. call getFirstChild() to start the list
2. call getNextSibling() repeatedly until it's null

The important thing to remember is to process the node, and not to
worry about the connectivities (unless you're doing tree
transformations :-).

Hope this helps,
- Bryan

On 11/7/05, bijoy thomas <bijoys_2000@yahoo.com> wrote:
>
> I'm trying to cycle through the nodes of a sibling
> list by calling getFirstChild() on the root and then
> calling getNextSibling() on the returned nodes untill
> I get null.
>
> But the call to getFirstChild() is returning the whole
> sibling list itself.
>
> Thanks,
> Bijoy.
>
>
>
> __________________________________
> Yahoo! FareChase: Search multiple travel sites in one click.
> http://farechase.yahoo.com
>
From depappas at yahoo.com  Mon Nov  7 16:19:43 2005
From: depappas at yahoo.com (Derek Pappas)
Date: Mon Nov  7 16:19:46 2005
Subject: [antlr-interest] C++ traceInOut
Message-ID: <20051108001943.10454.qmail@web50008.mail.yahoo.com>

Hi,

I am attempting to get antlr-2.7.5 to compile a
grammar with the -trace option. The following code is
inserted into the generated C++ code.

Tracer traceInOut(this "<rule>");

Which compiles but there is only lexer tracing enabled
during runtime.

The object traceInOut is not used in the parser cpp
file. I was looking at the CppCodeGenerator.cpp code
and I see some sections of code with respect to
traceOut commmented out. 

Any hints?

Derek


	
		
__________________________________ 
Yahoo! Mail - PC Magazine Editors' Choice 2005 
http://mail.yahoo.com
From wirecracker at gmail.com  Mon Nov  7 18:39:27 2005
From: wirecracker at gmail.com (eric nelson)
Date: Mon Nov  7 18:39:31 2005
Subject: [antlr-interest] Java In / Java Out: Going once ...
Message-ID: <ca5eeb330511071839k7ea095eama0c9f76f741f4768@mail.gmail.com>

Sorry, but I still feel like someone must know how to arrange the java.g and
Java.stg code so that we can parse Java source input and produce Java source
output without Java Beans, etc. (although thanks for that suggestion :)
Mabye everyone has been too busy to take a look at this, but really it
should be simple for someone who understands ANTLR and StringTemplate
(unlike me ;) Sorry if I'm being too pushy about this question, but I think
its a good one. If I'm thinking about this totally wrong, at least just tell
me I'm crazy or something k? ;) ... original Q:
 I'm trying to modify the java.g grammar file so that I can use
StringTemplate for outputting the file. The input is a Java file. I would
like the output to be Java also. So, yes, basically no change in content ...
mabye some spacing will differ here or there. I am still learning to use
ANTLR and StringTemplate and I've written a Java.stg file based on what I
think I know so far. Exerpts from java.g and Java.stg appear below. One of
the questions I have is how to handle the "|" (or) symbol (i.e.
classDefinition | interfaceDefinition). The way I have it right now there
would be a list of "modifiers", a list of "classDefinitions", and a list of
interfaceDefinitions (then naturally I would have a question about the " |
s:SEMI!" ... but one question at a time ;) So, the problem in Java.stg is
how to match up the correct "modifiers" with the corresponding
"interfaceDefinition" or "classDefinition". Or what if there is a
classDefinition with no modifier, etc. I am quite convinced that my
Java.stgtemplate (typeDefinition in particular) and/or my
java.g code has erred somewhere. Any thoughts? This is HUGE since this will
help me understand how to approach the "field" rule in java.g .... if anyone
has some hints on a "field" template that would also be great!
 Thanks :) - e
 p.s. In case the above paragraph was too cryptic, what I want to do is
modify the java.g file and Java.stg files to process parsed Java input to
formatted Java output.
  java.g exerpt (java 1.3 grammar)

//////////////////////////////////////////////////////////////////////////////////////////////////
// A type definition in a file is either a class or interface definition.
typeDefinition returns [StringTemplate code=template("typeDefinition")]
options {defaultErrorHandler = true;}
{StringTemplate mod=null, cd=null, id=null, semi=null;}
: mod=m:modifiers! {code.setAttribute("modifiers", mod);}
( cd=classDefinition[#m] { code.setAttribute("classDefinitions", cd);}
| id=interfaceDefinition[#m] {code.setAttribute("interfaceDefinitions",
id);}
)
| s:SEMI! {semi=template("lexer_semi");semi.setAttribute("semi",
s.getText());code.setAttribute("semi",
semi);}
;

//////////////////////////////////////////////////////////////////////////////////////////////////
  Java.stg exerpt

//////////////////////////////////////////////////////////////////////////////////////////////////
typeDefinition(modifiers,classDefinitions,interfaceDefinitions,semi) ::= <<
<modifiers><classDefinitions><interfaceDefinitions><semi>
>>

modifiers(modifiers) ::= "<modifiers>"

modifier(modifier) ::= "<modifier>"

classDefinition(ident,superClassClause,implementsClause,classBlock) ::= <<
class <ident> <superClassClause> <implementsClause>
<classBlock>
>>

interfaceDefinition() ::= <<
not yet completed
>>

//////////////////////////////////////////////////////////////////////////////////////////////////
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051107/09600b56/attachment.html
From sohail at taggedtype.net  Mon Nov  7 20:59:07 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Mon Nov  7 20:59:14 2005
Subject: [antlr-interest] StringTemplate + preserving comments
Message-ID: <1131425947.8193.1.camel@localhost.localdomain>

I think the subject line is basically impossible with antlr
+stringtemplate, BUT in the off-chance someone has any ideas to do this,
I would appreciate some pointers.

It would be really nice if one could do it without a TreeParser :)

Thanks!

Sohail

From esof1 at student.cs.ucc.ie  Tue Nov  8 03:14:34 2005
From: esof1 at student.cs.ucc.ie (Edward O'Flynn)
Date: Tue Nov  8 03:10:32 2005
Subject: [antlr-interest] StringTemplate + preserving comments
In-Reply-To: <1131425947.8193.1.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
Message-ID: <4370889A.5010803@student.cs.ucc.ie>

Sohail Somani wrote:

>I think the subject line is basically impossible with antlr
>+stringtemplate, BUT in the off-chance someone has any ideas to do this,
>I would appreciate some pointers.
>
>It would be really nice if one could do it without a TreeParser :)
>
>Thanks!
>
>Sohail
>
>  
>
Hi
I don't know much about Stringtemplate, but if you want to preserve 
comments,
you could use a tokenstreamhiddentoken filter after pasrsing, see 
http://www.antlr.org/doc/streams.html

ed.
From ric.klaren at gmail.com  Tue Nov  8 03:33:30 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Tue Nov  8 03:30:12 2005
Subject: [antlr-interest] C++ traceInOut
In-Reply-To: <20051108001943.10454.qmail@web50008.mail.yahoo.com>
References: <20051108001943.10454.qmail@web50008.mail.yahoo.com>
Message-ID: <43708D0A.9080106@gmail.com>

Derek Pappas wrote:
> I am attempting to get antlr-2.7.5 to compile a
> grammar with the -trace option. 
...
> Which compiles but there is only lexer tracing enabled
> during runtime.
> 
> The object traceInOut is not used in the parser cpp
> file. I was looking at the CppCodeGenerator.cpp code
> and I see some sections of code with respect to
> traceOut commmented out. 
> 
> Any hints?

Use -traceLexer -traceParser -traceTreeParser

http://www.antlr.org/doc/options.html#Command%20Line%20Options

Cheers,

Ric
From ric.klaren at gmail.com  Tue Nov  8 03:49:29 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Tue Nov  8 03:46:08 2005
Subject: [antlr-interest] antlr and libtool
In-Reply-To: <436F4E68.4090608@free.fr>
References: <436F4E68.4090608@free.fr>
Message-ID: <437090C9.4020409@gmail.com>

Xavier D?coret wrote:
> I am trying to release a rpm of a library based on antlr but I am
> getting rpmbuild error with libantlr.a.  My library is using libtool and
> it seems libtool has problems with the libanltr.a that is produced by
> the standard ANTLR installation tarball. 

libtool might be looking for a .la file that it usually produces itself.
ANTLR's C++ support lib doesn't have it. There might be some option or
something to make libtool behave. Maybe you can work around it by
including the .a file on the link commandline directly e.g. use
<path-to-antlrlib>/libantlr.a in stead of -L<path-to-antlrlib> -lantlr

> This tarball uses the
> autoconf/automake approach but does not use libtool.  Is there any good
> reason for that?

We had a built once with libtool but it sucked (think I kicked it out
together with automake). Gave lots of trouble on solaris stripping off
necessary options during linking and such. It does (did?) not seem to
deal well with libraries in non standard paths. It's also not worth the
trouble. Linking the antlr lib is as straightforward as anything.

I don't recall why it was not included in the configure/makefile rework
by Wolfgang, though it might be that I made no libtool a requirement,
don't recall.

> Would antlr library (for c++,for linux) be produced one day with
> libtool? I am willing to do the packaging for that but I would need to
> get the original configure.in, Makefile.am etc. of the distrib and not
> the one currently downloadable.

Personally I'm not in a hurry to reintroduce libtool. If libtool can't
link a plain old .a file then it's just plain wrong.

Cheers,

Ric
From esof1 at student.cs.ucc.ie  Tue Nov  8 04:22:59 2005
From: esof1 at student.cs.ucc.ie (Edward O'Flynn)
Date: Tue Nov  8 04:18:47 2005
Subject: [antlr-interest] installing antlr on eclipse
In-Reply-To: <437090C9.4020409@gmail.com>
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
Message-ID: <437098A3.6090400@student.cs.ucc.ie>

Hi
I want to install antlr on eclipse(3.1) but i am having problems,
I have tried automatic updates but the site is down and I am getting a 
network problem,
I have downloaded antlr, how do I go about installing it manually, ie. 
where should i put the jar file,
is there any other configuration that needs to be done, and finally how 
do i create an antlr project then,
would greatly appreciate any help
thanks
ed.

>
>  
>

From wirecracker at gmail.com  Tue Nov  8 04:56:23 2005
From: wirecracker at gmail.com (eric nelson)
Date: Tue Nov  8 04:56:25 2005
Subject: [antlr-interest] installing antlr on eclipse
In-Reply-To: <437098A3.6090400@student.cs.ucc.ie>
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
	<437098A3.6090400@student.cs.ucc.ie>
Message-ID: <ca5eeb330511080456m518a4588r344e9177af265008@mail.gmail.com>

I found a general Eclipse tutorial:
https://eclipse-tutorial.dev.java.net/eclipse-tutorial/part1.html
 I'm not sure if that is the kind of help you are looking for, but it seems
to show how to set the path to JAR files, etc.
 As long as the ANTLR JAR file is in the classpath, you should be able to
build any antlr project (command line shown):
 java antlr.Tool mygrammar.g
javac *.java
java Main (or whatever)
 On my Windows machine I installed antlr in the C:\ drive, so I have
C:\antlr\275\lib\antlr.jar. Then just point the classpath to this location.
 Best,
  - e


 On 11/8/05, Edward O'Flynn <esof1@student.cs.ucc.ie> wrote:
>
> Hi
> I want to install antlr on eclipse(3.1) but i am having problems,
> I have tried automatic updates but the site is down and I am getting a
> network problem,
> I have downloaded antlr, how do I go about installing it manually, ie.
> where should i put the jar file,
> is there any other configuration that needs to be done, and finally how
> do i create an antlr project then,
> would greatly appreciate any help
> thanks
> ed.
>
> >
> >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051108/0d5fe02c/attachment.html
From esof1 at student.cs.ucc.ie  Tue Nov  8 06:00:29 2005
From: esof1 at student.cs.ucc.ie (Edward O'Flynn)
Date: Tue Nov  8 05:56:33 2005
Subject: [antlr-interest] installing antlr on eclipse
In-Reply-To: <ca5eeb330511080456m518a4588r344e9177af265008@mail.gmail.com>
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>	
	<437098A3.6090400@student.cs.ucc.ie>
	<ca5eeb330511080456m518a4588r344e9177af265008@mail.gmail.com>
Message-ID: <4370AF7D.9080700@student.cs.ucc.ie>

eric nelson wrote:

> I found a general Eclipse tutorial: 
> https://eclipse-tutorial.dev.java.net/eclipse-tutorial/part1.html 
>  
> I'm not sure if that is the kind of help you are looking for, but it 
> seems to show how to set the path to JAR files, etc. 
>  
> As long as the ANTLR JAR file is in the classpath, you should be able 
> to build any antlr project (command line shown):
>  
> java antlr.Tool mygrammar.g
> javac *.java
> java Main (or whatever)
>  
> On my Windows machine I installed antlr in the C:\ drive, so I have 
> C:\antlr\275\lib\antlr.jar.  Then just point the classpath to this 
> location.
>  
> Best,
>  
>  - e
>
>
>  
> On 11/8/05, *Edward O'Flynn* <esof1@student.cs.ucc.ie 
> <mailto:esof1@student.cs.ucc.ie>> wrote:
>
>     Hi
>     I want to install antlr on eclipse(3.1) but i am having problems,
>     I have tried automatic updates but the site is down and I am
>     getting a
>     network problem,
>     I have downloaded antlr, how do I go about installing it manually, ie.
>     where should i put the jar file,
>     is there any other configuration that needs to be done, and
>     finally how
>     do i create an antlr project then,
>     would greatly appreciate any help
>     thanks
>     ed.
>
>     >
>     >
>     >
>
>
Hi
I know how to add the jar to my class path but how do I go about setting 
up antlr as an external tool, i got the following instructions on a 
website but they are confusing

Run-External Tools-Configure
Press New
As the Name: "Antlr Compiler"
1.As the Tool Location: "C:\jdk1.4.0\bin\javaw.exe" (you may need to 
adjust the path)
2.As the Tool Arguments: "-classpath C:\antlr-2.7.2\antlr.jar antlr.Tool 
${resource_name}"
/
3.These arguments:

    * set the classpath
    * specify antlr.Tool as the main class
    * specify ${resource_name} as the file for antlr.Tool to process
      "${resource_name}" will be the name of a selected file.
      You can set this using the "Browse Variables" button.

/4.As the Working Directory: "${container_loc}"
/You can set this by selecting "Selected resource's container location" 
under the "Browse Options" button.
/Verify that "Block until tool terminates" and "Show execution log on 
console" are both checked.
Press OK.

Question 1, should the external tool be run as an ant build file or as a 
program
Qusetion2, Once this has been established, under the main tab there are 
3 fields,
Location, Working Directory, and arguements,
What exactly should be put in here? and what are the variables specified 
above ie. ${resource_name}

cheers
ed.
From demakov at ispras.ru  Tue Nov  8 06:01:38 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Tue Nov  8 06:01:46 2005
Subject: [antlr-interest] installing antlr on eclipse
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
	<437098A3.6090400@student.cs.ucc.ie>
Message-ID: <017c01c5e46c$f04c2490$8cc79553@marlboro>

Why not use ANTLR Eclipse plugin?
http://antlreclipse.sourceforge.net/
There is detailed installation instructions.
Be sure to download version 4.0.0.b2 from 
http://sourceforge.net/projects/antlreclipse
instead of 4.0.0.b1 from http://antlreclipse.sourceforge.net/updates/

----- Original Message ----- 
From: "Edward O'Flynn" <esof1@student.cs.ucc.ie>
To: "Ric Klaren" <ric.klaren@gmail.com>
Cc: <antlr-interest@antlr.org>
Sent: Tuesday, November 08, 2005 3:22 PM
Subject: [antlr-interest] installing antlr on eclipse


> Hi
> I want to install antlr on eclipse(3.1) but i am having problems,
> I have tried automatic updates but the site is down and I am getting a 
> network problem,
> I have downloaded antlr, how do I go about installing it manually, ie. 
> where should i put the jar file,
> is there any other configuration that needs to be done, and finally how 
> do i create an antlr project then,
> would greatly appreciate any help
> thanks
> ed.
> 
> >
> >  
> >
> 
> 

From mikiw at orb-software.com  Tue Nov  8 08:05:08 2005
From: mikiw at orb-software.com (Miki Watts)
Date: Tue Nov  8 08:00:35 2005
Subject: [antlr-interest] Losing a character when switching parsers
In-Reply-To: <20051108155404.5D178DCC66@www.antlr.org>
Message-ID: <20051108160033.EA7C7DCC66@www.antlr.org>

I've been trying to figure this out for a few days, so I hope someone can
help me.
I have a situation similar to the JavaDoc example in the antlr distribution,
of text within text that has different syntax rules.
My problem is that when I move from each parser/lexer, I lose a character,
so for input "some text [!some other text]" , the secondary parser only sees
"[!", "ome other text", and "]" as the tokens.
 
I won't post the whole parser/lexer files, but here are the important parts:
In the main antlr file, in the parser:
 
------------------
protected pageOption returns [WikiPageOptionToken defaultToken = null]
	:
		StartWikiPageOption
		{
			WikiPageOptionParser parser = new
WikiPageOptionParser(getInputState());
			defaultToken = parser.pageOption();
		}
	;
------------------

And in the lexer:

------------------
StartWikiPageOption : "[!"  {
TokenParser.selector.push("WikiPageOptionLexer"); };
------------------

In the secondary antlr file, in the parser:

------------------
pageOption returns [WikiPageOptionToken defaultToken = null]
	{TextToken pageOptionValue = null;} : 
		w1:Word { TextToken pageOptionName = new
TextToken(w1.getText()); }
		(PageOptionSeperator w2:Word {pageOptionValue = new
TextToken(w2.getText());})? 
		EndWikiPageOption
		{ 
			defaultToken = new WikiPageOptionToken(); 
			defaultToken.AddChildToken(pageOptionName);	
			
			if ((pageOptionValue as TextToken)!=null)
			{
				defaultToken.AddChildToken(pageOptionValue);
			}
		}
	;
------------------

And in the lexer:

------------------
StartPageOption : "[!";
EndPageOption: "]" { TokenParser.selector.pop(); };
PageOptionSeperator: ":";

Word: ('a'..'z' | 'A'..'Z')+;
------------------

For input "[!PreserveWhiteSpace]", I get the following exception:

------------------
TestCase 'JustWikiUnitTest.HtmlTokens.TestTokenParser.TestTranslateToHtml'
failed: System.Exception : wiki page content: [!PreserveWhiteSpace]
  ----> antlr.TokenStreamRecognitionException : unexpected char: 'P'
	
c:\projects\justwiki\justwikiunittest\htmltokens\testtokenparser.cs(73,0):
at JustWikiUnitTest.HtmlTokens.TestTokenParser.TestTranslateToHtml()
	--Exception
	c:\projects\justwiki\justwiki_generated\justwikilexer.cs(105,0): at
JustWiki.JustWikiLexer.nextToken()
	at antlr.TokenStreamSelector.nextToken()
	at antlr.TokenBuffer.fill(Int32 amount)
	at antlr.TokenBuffer.LA(Int32 i)
	at antlr.LLkParser.LA(Int32 i)
	at antlr.Parser.consumeUntil(BitSet bset)
	at antlr.Parser.recover(RecognitionException ex, BitSet tokenSet)
	
c:\projects\justwiki\justwiki_generated\wikipageoptionparser.cs(113,0): at
JustWiki.WikiPageOptionParser.pageOption()
	c:\projects\justwiki\justwiki_generated\justwikiparser.cs(129,0): at
JustWiki.JustWikiParser.pageOption()
	c:\projects\justwiki\justwiki_generated\justwikiparser.cs(80,0): at
JustWiki.JustWikiParser.startRule()
	C:\Projects\JustWiki\Tokens\TokenParser.cs(33,0): at
JustWiki.Tokens.TokenParser.Parse(Controller controller, WikiWord wikiPage)
	
c:\projects\justwiki\justwikiunittest\htmltokens\testtokenparser.cs(23,0):
at JustWikiUnitTest.HtmlTokens.TestTokenParser.ParseWikiPage(String
mockWikiPageContent)
	
c:\projects\justwiki\justwikiunittest\htmltokens\testtokenparser.cs(62,0):
at JustWikiUnitTest.HtmlTokens.TestTokenParser.TestTranslateToHtml()
------------------

And if I debug it, in the part where it looks for the Word token, it has
this:
------------------
	w1 = LT(1);
	match(Word);
------------------

It fails on the LT(1) specifically, though in the debug view it shows LT(1)
as a token of type Word with the text "reserveWhiteSpace", so it looks like
I'm losing a character somewhere... I'm hoping someone can help me.

Thanks, Miki Watts



From geiroves at online.no  Tue Nov  8 08:18:42 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Tue Nov  8 08:18:52 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000501c5e39d$f1cf6a40$0100a8c0@rexii>
Message-ID: <000001c5e480$16b7fab0$0100a8c0@rexii>

Hello,

Just one more comment on this Bug. It is ** clearly ** a bug, since
ANTLR does work correctly when BitSets are NOT used. I find it strange
that this Bug  seems to be passed in almost silence: I would think it to
be rather serious to have a "sleeping" bug that may come and bite you
any time you encounter the right conditions.

Terrence asked me to try to produce a small grammar example to try to
reproduce the problem. I will as soon as time on my project permits it. 

BUT I would think it is equally IMPORTANT for the ANTLR team to try to
hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under
development, but we sure need a strong ** core ** technology that won't
fail. 

I used several months to hunt down errors in my grammar, when it all
turned out to work OK as soon as I disabled the use of BitSets. However,
this clearly slows down the parsing!



Geir Ove

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Geir Ove
Skjaervik
Sent: 7. november 2005 14:20
To: 'Terence Parr'
Cc: 'ANTLR Interest'
Subject: RE: [antlr-interest] Serious Bug when using
BitSetgeneration-Forgot


Hello,

I saw your reply first today. Maybe I do not understand your example,
but what give me problems when using BitSets are grammars like this:



class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   |			Emtpty Production: Generates problems using
BitSets, no Problem when NOT using Bitsets
   ;

b : A|D|F|G|H;



Geir Ove

-----Original Message-----
From: Terence Parr [mailto:parrt@cs.usfca.edu] 
Sent: 6. november 2005 02:02
To: ANTLR Interest
Cc: Geir Ove Skjaervik
Subject: Re: [antlr-interest] Serious Bug when using
BitSetgeneration-Forgot


> Hopefully we can find a solution to this "Empty Pruction & BitSet 
> wrong code generation".
>
> It has kept my puzzling about errors in my grammar for a long long 
> time, but I have put off investigating it because there had been other

> more important things to look at. However, I know had to solve it, and

> it turned out to be a Bug !

Hi.  Here is my test case:

class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
   | {p1}? ( )
   | {p2}? ( )
   ;

b : A|D|F|G|H;

All is well.  It generates the following for rule a:

             if ((LA(1)==B)) {
                 match(B);
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p1)) {
                 {
                 }
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p2)) {
                 {
                 }
             }

clearly the bitsets are there.  Can you nail your bug down to a  
simple grammar like this that fails?

I realized that ANTLR will not (as I said in last email) delete the  
lookahead; it's smart enough to know that the predicates are only  
valid in the right context and so it keeps the lookahead the same.

Thanks,
Ter





From parrt at cs.usfca.edu  Tue Nov  8 09:58:06 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 09:59:07 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000001c5e480$16b7fab0$0100a8c0@rexii>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
Message-ID: <72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>


On Nov 8, 2005, at 8:18 AM, Geir Ove Skjaervik wrote:

> Hello,
>
> Just one more comment on this Bug. It is ** clearly ** a bug, since
> ANTLR does work correctly when BitSets are NOT used. I find it strange

Hi.  Yes, that does seem to say there is a bug.  Note that I cannot  
reproduce this bug.  I added an empty alt and I still get correct code.

class T extends Parser;

x : A|C|D|E|F|G|H;

s : a b ;

// here is the rule of interest
a : B
    | {p1}? ( )
    | {p2}? ( )
    |
    ;

b : A|D|F|G|H;

For rule a() I generate the decision:

             if ((LA(1)==B)) {
                 match(B);
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p1)) {
                 {
                 }
             }
             else if (((_tokenSet_1.member(LA(1))))&&(p2)) {
                 {
                 }
             }
             else if ((_tokenSet_1.member(LA(1)))) {
             }

Unless you can send me a small piece of code that breaks, I may not  
be able to track it down in a reasonable amount of time, which means  
it won't get solved.

> that this Bug  seems to be passed in almost silence: I would think  
> it to

I'm hoping that is because it's not bitten that many people.

> be rather serious to have a "sleeping" bug that may come and bite you
> any time you encounter the right conditions.
>
> Terrence asked me to try to produce a small grammar example to try to
> reproduce the problem. I will as soon as time on my project permits  
> it.
>
> BUT I would think it is equally IMPORTANT for the ANTLR team to try to
> hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under
> development, but we sure need a strong ** core ** technology that  
> won't
> fail.

Wow.  You're pretty demanding for somebody using my free software.   
once you give me a small test that breaks, quoting you, "I will [work  
on it] as soon as time on my project permits it."

> I used several months to hunt down errors in my grammar, when it all
> turned out to work OK as soon as I disabled the use of BitSets.

I'm not sure how it took you several months to look at the single IF  
statement and its bitset to figure out it was missing any lookahead.   
Surely a 0 bitset is obvious.

Terence
From sohail at taggedtype.net  Tue Nov  8 10:00:21 2005
From: sohail at taggedtype.net (sohail@taggedtype.net)
Date: Tue Nov  8 10:00:30 2005
Subject: [antlr-interest] StringTemplate + preserving comments
In-Reply-To: <4370889A.5010803@student.cs.ucc.ie>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
Message-ID: <46205.127.0.0.1.1131472821.squirrel@taggedtype.net>

> Sohail Somani wrote:
>
>>I think the subject line is basically impossible with antlr
>>+stringtemplate, BUT in the off-chance someone has any ideas to do this,
>>I would appreciate some pointers.
>>
>>It would be really nice if one could do it without a TreeParser :)
>>
>>Thanks!
>>
>>Sohail
>>
>>
>>
> Hi
> I don't know much about Stringtemplate, but if you want to preserve
> comments,
> you could use a tokenstreamhiddentoken filter after pasrsing, see
> http://www.antlr.org/doc/streams.html

Hi Ed!

I am aware of this technique. I would ideally like the separation that
StringTemplate provides. This is a bit difficult because (I think) it
would require me to insert <comment>'s between every tag in my template. I
should probably sign up for the stringtemplate ml now.

Sohail
From parrt at cs.usfca.edu  Tue Nov  8 10:04:52 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 10:05:53 2005
Subject: [antlr-interest] StringTemplate + preserving comments
In-Reply-To: <46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
Message-ID: <76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>

On Nov 8, 2005, at 10:00 AM, sohail@taggedtype.net wrote:
>> Sohail Somani wrote:
>>
>>> I think the subject line is basically impossible with antlr
>>> +stringtemplate, BUT in the off-chance someone has any ideas to  
>>> do this,
>>> I would appreciate some pointers.
>>>
>>> It would be really nice if one could do it without a TreeParser :)
>>>
>> Hi
>> I don't know much about Stringtemplate, but if you want to preserve
>> comments,
>> you could use a tokenstreamhiddentoken filter after pasrsing, see
>> http://www.antlr.org/doc/streams.html
>
> Hi Ed!
>
> I am aware of this technique. I would ideally like the separation that
> StringTemplate provides. This is a bit difficult because (I think) it
> would require me to insert <comment>'s between every tag in my  
> template. I
> should probably sign up for the stringtemplate ml now.

Howdy.  For tweaking or augmenting input, ANTLR +  
TokenStreamRewriteEngine is pretty damn hard to beat. :)  That said,  
I'm hoping to learn how to build a pretty printer in the new few  
months as a way to test new v3 functionality.  As you say, preserving  
the comments in this scenario is pretty tough.  I will have to think  
about how to solve that.  Naturally ANTLR has all the info, the  
problem may be simply to assume that any token you insert into the  
template also includes any hidden tokens before it.  Heh, that might  
work :)  In v2 or v3, I think you can just alter Token.toString() to  
print hidden stuff before the token as well.  easy :) Damn!  That  
might work!

Ter
From sohail at taggedtype.net  Tue Nov  8 11:30:22 2005
From: sohail at taggedtype.net (sohail@taggedtype.net)
Date: Tue Nov  8 11:30:29 2005
Subject: [antlr-interest] StringTemplate + preserving comments
In-Reply-To: <76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
Message-ID: <51980.127.0.0.1.1131478222.squirrel@taggedtype.net>

> On Nov 8, 2005, at 10:00 AM, sohail@taggedtype.net wrote:
>>> Sohail Somani wrote:
>>>
>>>> I think the subject line is basically impossible with antlr
>>>> +stringtemplate, BUT in the off-chance someone has any ideas to
>>>> do this,
>>>> I would appreciate some pointers.
>>>>
>>>> It would be really nice if one could do it without a TreeParser :)
>>>>
>>> Hi
>>> I don't know much about Stringtemplate, but if you want to preserve
>>> comments,
>>> you could use a tokenstreamhiddentoken filter after pasrsing, see
>>> http://www.antlr.org/doc/streams.html
>>
>> Hi Ed!
>>
>> I am aware of this technique. I would ideally like the separation that
>> StringTemplate provides. This is a bit difficult because (I think) it
>> would require me to insert <comment>'s between every tag in my
>> template. I
>> should probably sign up for the stringtemplate ml now.
>
> Howdy.  For tweaking or augmenting input, ANTLR +
> TokenStreamRewriteEngine is pretty damn hard to beat. :)  That said,
> I'm hoping to learn how to build a pretty printer in the new few
> months as a way to test new v3 functionality.  As you say, preserving
> the comments in this scenario is pretty tough.  I will have to think
> about how to solve that.  Naturally ANTLR has all the info, the
> problem may be simply to assume that any token you insert into the
> template also includes any hidden tokens before it.  Heh, that might
> work :)  In v2 or v3, I think you can just alter Token.toString() to
> print hidden stuff before the token as well.  easy :) Damn!  That
> might work!

Exciting! I'll give that a shot when I get home tonight.
From sohail at taggedtype.net  Tue Nov  8 21:35:51 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 21:36:46 2005
Subject: [antlr-interest] StringTemplate + preserving comments
In-Reply-To: <76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
Message-ID: <1131514551.8269.1.camel@localhost.localdomain>

On Tue, 2005-08-11 at 10:04 -0800, Terence Parr wrote:
> On Nov 8, 2005, at 10:00 AM, sohail@taggedtype.net wrote:
> >> Sohail Somani wrote:
> >>
> >>> I think the subject line is basically impossible with antlr
> >>> +stringtemplate, BUT in the off-chance someone has any ideas to  
> >>> do this,
> >>> I would appreciate some pointers.
> >>>
> >>> It would be really nice if one could do it without a TreeParser :)
> >>>
> >> Hi
> >> I don't know much about Stringtemplate, but if you want to preserve
> >> comments,
> >> you could use a tokenstreamhiddentoken filter after pasrsing, see
> >> http://www.antlr.org/doc/streams.html
> >
> > Hi Ed!
> >
> > I am aware of this technique. I would ideally like the separation that
> > StringTemplate provides. This is a bit difficult because (I think) it
> > would require me to insert <comment>'s between every tag in my  
> > template. I
> > should probably sign up for the stringtemplate ml now.
> 
> Howdy.  For tweaking or augmenting input, ANTLR +  
> TokenStreamRewriteEngine is pretty damn hard to beat. :)  That said,  
> I'm hoping to learn how to build a pretty printer in the new few  
> months as a way to test new v3 functionality.  As you say, preserving  
> the comments in this scenario is pretty tough.  I will have to think  
> about how to solve that.  Naturally ANTLR has all the info, the  
> problem may be simply to assume that any token you insert into the  
> template also includes any hidden tokens before it.  Heh, that might  
> work :)  In v2 or v3, I think you can just alter Token.toString() to  
> print hidden stuff before the token as well.  easy :) Damn!  That  
> might work!

Are you suggesting I do something like:

import antlr.CommonHiddenStreamToken;

public class MyCommonHiddenStreamToken extends CommonHiddenStreamToken {

    public MyCommonHiddenStreamToken()
    {
        super();
    }

    public MyCommonHiddenStreamToken(int t, String txt) 
    {
        super(t, txt);
    }

    public MyCommonHiddenStreamToken(String s) {
        super(s);
    }    
            
    public String getText()
    {
        if(getHiddenBefore()!=null)
        {
            return getHiddenBefore().getText() + "\n" + super.getText();
        }
        else
        {
            return super.getText();        
        }
    }
    
    public String toString()
    {
        return getText();
    }
}

A problem I'm having is that getHiddenBefore() becomes null when its
time to print it out (getText()).

If I'm on the wrong track, please let me know :)

Thanks

Sohail

From parrt at cs.usfca.edu  Tue Nov  8 21:40:24 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 21:40:28 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate +
	preserving comments
In-Reply-To: <1131514551.8269.1.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
Message-ID: <E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>


On Nov 8, 2005, at 9:35 PM, Sohail Somani wrote:
>> Howdy.  For tweaking or augmenting input, ANTLR +
>> TokenStreamRewriteEngine is pretty damn hard to beat. :)  That said,
>> I'm hoping to learn how to build a pretty printer in the new few
>> months as a way to test new v3 functionality.  As you say, preserving
>> the comments in this scenario is pretty tough.  I will have to think
>> about how to solve that.  Naturally ANTLR has all the info, the
>> problem may be simply to assume that any token you insert into the
>> template also includes any hidden tokens before it.  Heh, that might
>> work :)  In v2 or v3, I think you can just alter Token.toString() to
>> print hidden stuff before the token as well.  easy :) Damn!  That
>> might work!
>
> Are you suggesting I do something like:
>
> import antlr.CommonHiddenStreamToken;
>
> public class MyCommonHiddenStreamToken extends  
> CommonHiddenStreamToken {
>

[snip]

>     public String getText()
>     {
>         if(getHiddenBefore()!=null)
>         {
>             return getHiddenBefore().getText() + "\n" +  
> super.getText();
>         }
>         else
>         {
>             return super.getText();
>         }
>     }
>
>     public String toString()
>     {
>         return getText();
>     }
> }

Yes, that should work.

> A problem I'm having is that getHiddenBefore() becomes null when its
> time to print it out (getText()).

really?  Hmm...it should always point at the hidden stuff in front.   
Perhaps you are not setting the right token into the ST attribute.   
For example, if a comment is between a '{' and an ID, then the ID  
must go into the stringtemplate so that it can print itself out with  
the comment before.

> If I'm on the wrong track, please let me know :)

You are on the right track :)

Ter
From sohail at taggedtype.net  Tue Nov  8 21:51:24 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 21:51:29 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate
	+ preserving comments
In-Reply-To: <E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
Message-ID: <1131515484.8269.8.camel@localhost.localdomain>

On Tue, 2005-08-11 at 21:40 -0800, Terence Parr wrote:
> On Nov 8, 2005, at 9:35 PM, Sohail Somani wrote:
> > A problem I'm having is that getHiddenBefore() becomes null when its
> > time to print it out (getText()).
> 
> really?  Hmm...it should always point at the hidden stuff in front.   
> Perhaps you are not setting the right token into the ST attribute.   
> For example, if a comment is between a '{' and an ID, then the ID  
> must go into the stringtemplate so that it can print itself out with  
> the comment before.

This is quite possible. The language I'm parsing is very whitespace
happy (sometimes!). No this was not fun to parse. So it could be that
the lexer passes:

COMMENT EOL SOME_THING

And of course when I try to print the text of SOME_THING, there is no
hidden before.

Any suggestions?

Perhaps using tokenrewriteengine would work because that would mean I
could keep track of the index of the last token printed and then print
all hidden things from there till now. But this doesn't sound too fun.

Sohail

From parrt at cs.usfca.edu  Tue Nov  8 21:54:21 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 21:54:24 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate +
	preserving comments
In-Reply-To: <1131515484.8269.8.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
Message-ID: <50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>


On Nov 8, 2005, at 9:51 PM, Sohail Somani wrote:

> On Tue, 2005-08-11 at 21:40 -0800, Terence Parr wrote:
>> On Nov 8, 2005, at 9:35 PM, Sohail Somani wrote:
>>> A problem I'm having is that getHiddenBefore() becomes null when its
>>> time to print it out (getText()).
>>
>> really?  Hmm...it should always point at the hidden stuff in front.
>> Perhaps you are not setting the right token into the ST attribute.
>> For example, if a comment is between a '{' and an ID, then the ID
>> must go into the stringtemplate so that it can print itself out with
>> the comment before.
>
> This is quite possible. The language I'm parsing is very whitespace
> happy (sometimes!). No this was not fun to parse. So it could be that
> the lexer passes:
>
> COMMENT EOL SOME_THING
>
> And of course when I try to print the text of SOME_THING, there is no
> hidden before.
>
> Any suggestions?

Yes.  Make that IF a WHILE loop to print ALL hidden tokens between  
your token and the previous :)  It chains them all together :)

> Perhaps using tokenrewriteengine would work because that would mean I
> could keep track of the index of the last token printed and then print
> all hidden things from there till now. But this doesn't sound too fun.

Either way you need a loop to walk back and print the hidden stuff :)

Ter
From sohail at taggedtype.net  Tue Nov  8 22:10:24 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 22:10:32 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate
	+ preserving comments
In-Reply-To: <50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
Message-ID: <1131516624.8269.13.camel@localhost.localdomain>

On Tue, 2005-08-11 at 21:54 -0800, Terence Parr wrote:
> On Nov 8, 2005, at 9:51 PM, Sohail Somani wrote:
> >
> > This is quite possible. The language I'm parsing is very whitespace
> > happy (sometimes!). No this was not fun to parse. So it could be that
> > the lexer passes:
> >
> > COMMENT EOL SOME_THING
> >
> > And of course when I try to print the text of SOME_THING, there is no
> > hidden before.
> >
> > Any suggestions?
> 
> Yes.  Make that IF a WHILE loop to print ALL hidden tokens between  
> your token and the previous :)  It chains them all together :)

Ah, but isn't this information available only in the tokenstream and not
the token? Or am I missing something...

If I try to do SOME_THING.getText(), getHiddenBefore() will be null
because there is no hidden token before (as it is EOL)... So I don't
know where to get this chain from.

Sohail

From parrt at cs.usfca.edu  Tue Nov  8 22:19:26 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 22:19:30 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate +
	preserving comments
In-Reply-To: <1131516624.8269.13.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
	<1131516624.8269.13.camel@localhost.localdomain>
Message-ID: <6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>


On Nov 8, 2005, at 10:10 PM, Sohail Somani wrote:

> On Tue, 2005-08-11 at 21:54 -0800, Terence Parr wrote:
>> On Nov 8, 2005, at 9:51 PM, Sohail Somani wrote:
>>>
>>> This is quite possible. The language I'm parsing is very whitespace
>>> happy (sometimes!). No this was not fun to parse. So it could be  
>>> that
>>> the lexer passes:
>>>
>>> COMMENT EOL SOME_THING
>>>
>>> And of course when I try to print the text of SOME_THING, there  
>>> is no
>>> hidden before.
>>>
>>> Any suggestions?
>>
>> Yes.  Make that IF a WHILE loop to print ALL hidden tokens between
>> your token and the previous :)  It chains them all together :)
>
> Ah, but isn't this information available only in the tokenstream  
> and not
> the token? Or am I missing something...
>
> If I try to do SOME_THING.getText(), getHiddenBefore() will be null
> because there is no hidden token before (as it is EOL)... So I don't
> know where to get this chain from.

Each real token (in v2) will have a linked list between it and the  
previous real token with all hidden tokens.  If you send newlines and  
comments to the parser as hidden, there will be a linked list (right  
to left) from your token to the previous token.  Are you stripping  
out newlines perhaps?

Ter
From sohail at taggedtype.net  Tue Nov  8 22:24:49 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 22:24:55 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate
	+ preserving comments
In-Reply-To: <6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
	<1131516624.8269.13.camel@localhost.localdomain>
	<6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>
Message-ID: <1131517489.8269.18.camel@localhost.localdomain>

On Tue, 2005-08-11 at 22:19 -0800, Terence Parr wrote:
> On Nov 8, 2005, at 10:10 PM, Sohail Somani wrote:
> 
> > On Tue, 2005-08-11 at 21:54 -0800, Terence Parr wrote:
> >> On Nov 8, 2005, at 9:51 PM, Sohail Somani wrote:
> >>>
> >>> This is quite possible. The language I'm parsing is very whitespace
> >>> happy (sometimes!). No this was not fun to parse. So it could be  
> >>> that
> >>> the lexer passes:
> >>>
> >>> COMMENT EOL SOME_THING
> >>>
> >>> And of course when I try to print the text of SOME_THING, there  
> >>> is no
> >>> hidden before.
> >>>
> >>> Any suggestions?
> >>
> >> Yes.  Make that IF a WHILE loop to print ALL hidden tokens between
> >> your token and the previous :)  It chains them all together :)
> >
> > Ah, but isn't this information available only in the tokenstream  
> > and not
> > the token? Or am I missing something...
> >
> > If I try to do SOME_THING.getText(), getHiddenBefore() will be null
> > because there is no hidden token before (as it is EOL)... So I don't
> > know where to get this chain from.
> 
> Each real token (in v2) will have a linked list between it and the  
> previous real token with all hidden tokens.  If you send newlines and  
> comments to the parser as hidden, there will be a linked list (right  
> to left) from your token to the previous token.  Are you stripping  
> out newlines perhaps?

Nope, newlines are being sent to the parser as well (although EOL+
becomes EOL). Where are the fields for this linked list in the Token? I
can't see it in the code API on the web nor in the source (*Token.java).

PS: Thanks for your help!

From sohail at taggedtype.net  Tue Nov  8 22:38:49 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 22:38:58 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate
	+ preserving comments
In-Reply-To: <1131517489.8269.18.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
	<1131516624.8269.13.camel@localhost.localdomain>
	<6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>
	<1131517489.8269.18.camel@localhost.localdomain>
Message-ID: <1131518330.8269.20.camel@localhost.localdomain>

On Tue, 2005-08-11 at 22:24 -0800, Sohail Somani wrote:
> Nope, newlines are being sent to the parser as well (although EOL+
> becomes EOL). Where are the fields for this linked list in the Token? I
> can't see it in the code API on the web nor in the source (*Token.java).

Nevermind, I think I got it... That looping stuff. I was discarding WS
instead of hiding it but EOLS weren't in WS... Heh.

\o/

From parrt at cs.usfca.edu  Tue Nov  8 22:40:08 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov  8 22:40:16 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate +
	preserving comments
In-Reply-To: <1131517489.8269.18.camel@localhost.localdomain>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
	<1131516624.8269.13.camel@localhost.localdomain>
	<6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>
	<1131517489.8269.18.camel@localhost.localdomain>
Message-ID: <AFE6DF3C-4833-4825-AE19-DD35E5F7257E@cs.usfca.edu>

> Nope, newlines are being sent to the parser as well (although EOL+
> becomes EOL). Where are the fields for this linked list in the  
> Token? I
> can't see it in the code API on the web nor in the source  
> (*Token.java).

Must be hanging out in the CommonHiddenStreamToken object.  Yep,

public class CommonHiddenStreamToken extends CommonToken {
     protected CommonHiddenStreamToken hiddenBefore;
     protected CommonHiddenStreamToken hiddenAfter;
...
}

manual linked list. ;)

> PS: Thanks for your help!

At your service :)

Ter

From sohail at taggedtype.net  Tue Nov  8 22:52:27 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue Nov  8 22:52:32 2005
Subject: [stringtemplate-interest] Re: [antlr-interest] StringTemplate
	+ preserving comments
In-Reply-To: <AFE6DF3C-4833-4825-AE19-DD35E5F7257E@cs.usfca.edu>
References: <1131425947.8193.1.camel@localhost.localdomain>
	<4370889A.5010803@student.cs.ucc.ie>
	<46205.127.0.0.1.1131472821.squirrel@taggedtype.net>
	<76875D09-E9C9-4466-BE97-BD0F065B70C4@cs.usfca.edu>
	<1131514551.8269.1.camel@localhost.localdomain>
	<E4B9B52D-6C14-4A77-A886-F1BC6D061DFD@cs.usfca.edu>
	<1131515484.8269.8.camel@localhost.localdomain>
	<50F219D8-EC83-4AAC-9574-CFBE4E0789AE@cs.usfca.edu>
	<1131516624.8269.13.camel@localhost.localdomain>
	<6CAF8B0A-46F3-466A-989A-2E3CB635C6C1@cs.usfca.edu>
	<1131517489.8269.18.camel@localhost.localdomain>
	<AFE6DF3C-4833-4825-AE19-DD35E5F7257E@cs.usfca.edu>
Message-ID: <1131519147.8269.24.camel@localhost.localdomain>

On Tue, 2005-08-11 at 22:40 -0800, Terence Parr wrote:
> > Nope, newlines are being sent to the parser as well (although EOL+
> > becomes EOL). Where are the fields for this linked list in the  
> > Token? I
> > can't see it in the code API on the web nor in the source  
> > (*Token.java).
> 
> Must be hanging out in the CommonHiddenStreamToken object.  Yep,
> 
> public class CommonHiddenStreamToken extends CommonToken {
>      protected CommonHiddenStreamToken hiddenBefore;
>      protected CommonHiddenStreamToken hiddenAfter;
> ...
> }

But again, this is only hidden stuff right?

So a stream like:

HIDDEN_COMMENT EOL_FOR_PARSER SOME_THING

getText() 
{
	// When called for SOME_THING this is always null as EOL_FOR_PARSER is
not hidden...
	while((curr=getHiddenBefore())!=null)
	{
		ret = curr.getText() + ret; // i know i know, slow.
	}
}


From ric.klaren at gmail.com  Wed Nov  9 06:51:52 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Wed Nov  9 06:47:53 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000001c5e480$16b7fab0$0100a8c0@rexii>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
Message-ID: <43720D08.5090405@gmail.com>

Hi,

Geir Ove Skjaervik wrote:
> Just one more comment on this Bug. It is ** clearly ** a bug, since
> ANTLR does work correctly when BitSets are NOT used. I find it strange
> that this Bug  seems to be passed in almost silence: I would think it to
> be rather serious to have a "sleeping" bug that may come and bite you
> any time you encounter the right conditions.

1) As you yourself mentioned there is a workaround. Also you seem to be
the only one that ran into this so far.
2) We cannot reproduce the bug since you don't supply us with the
necessary information to find it: e.g. a clear piece of code that
demonstrates it. I tinkered a bit with the example code you provided but
cannot reproduce it. Terence spent time on it and he cannot reproduce
it. So it's apparently something deeper down in your grammar.

Did you try older antlr versions on the code to see whether it was
introduced in one of the last releases, this might help us narrowing
down where to look? Running the grammar on older antlr's should not take
long.

> Terrence asked me to try to produce a small grammar example to try to
> reproduce the problem. I will as soon as time on my project permits it.

> BUT I would think it is equally IMPORTANT for the ANTLR team to try to
> hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under
> development, but we sure need a strong ** core ** technology that won't
> fail.

Hunting bugs blindly is a waste of time. FYI all ANTLR developers have
fulltime jobs not involving ANTLR. Looking at antlr2 code without
knowing what triggers a bug is useless -> provide a good bugreport that
demonstrates the problem!

For me this bug is on ice untill *you* produce a good defect report.

Shouting at us will really not make things go faster. If the speedloss
is a big issue then you should check with your management to get the
time to help us track down this bug. Taking out your stress on us will
not help you.

Cheers,

Ric
From henryb at ntlworld.com  Wed Nov  9 07:44:28 2005
From: henryb at ntlworld.com (Henry Butowsky)
Date: Wed Nov  9 07:15:16 2005
Subject: [antlr-interest] CPP COMMENTS
Message-ID: <4372195C.5050702@ntlworld.com>

Hi Guys,
   Please help. I am at my wits end.

Im still trying to get C++ style comments working. I have the rule.

CPP_COMMENT: ("//" (~'\n')* '\n')
     { newline(); $setType(antlr::Token::SKIP); };


It seems to be crashing out in the lexer in CalcLexer::mCPP_COMMENT().
More specifically -- whats happening is that it is crashing out on the
line -- match('\n'). I've investigated with the debugger and whats 
happening is that it is matching everything from the comment start till 
the end of the file (ignoring any \n). Thus returning a -1 (which is EOF)

Setting codeGenBitsetTestThreshold to 999 ?
Setting k to 3,4,5 ?
Rebuilding antlr from scratch rather than using rpm distribution

Please help

Many thx Henry


void CalcLexer::mCPP_COMMENT(bool _createToken) {
	int _ttype; ANTLR_USE_NAMESPACE(antlr)RefToken _token; 
ANTLR_USE_NAMESPACE(std)string::size_type _begin = text.length();
	_ttype = CPP_COMMENT;
	ANTLR_USE_NAMESPACE(std)string::size_type _saveIndex;
	
	match("//");
	{ // ( ... )*
	for (;;) {
		if ((_tokenSet_0.member(LA(1)))) {
			matchNot('\n' /* charlit */ );
		}
		else {
			goto _loop36;
		}
		
	}
	_loop36:;
	} // ( ... )*
	match('\n' /* charlit */ );  //CRASHING OUT HERE
#line 139 "calc.g"
	_ttype = antlr::Token::SKIP; newline();
#line 590 "CalcLexer.cpp"
	if ( _createToken && _token==ANTLR_USE_NAMESPACE(antlr)nullToken && 
_ttype!=ANTLR_USE_NAMESPACE(antlr)Token::SKIP ) {
	   _token = makeToken(_ttype);
	   _token->setText(text.substr(_begin, text.length()-_begin));
	}
	_returnToken = _token;
	_saveIndex=0;
}

From madcapmaggie at yahoo.com  Wed Nov  9 07:33:03 2005
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Wed Nov  9 07:33:06 2005
Subject: [antlr-interest] CPP COMMENTS
In-Reply-To: <4372195C.5050702@ntlworld.com>
Message-ID: <20051109153303.47361.qmail@web30204.mail.mud.yahoo.com>



Here's what I use for SL comments -- it's for SQL but 
should work for c++.

I'm generating c++ code on LINUX and I built
antlr-2.7.5 
from scratch.

// Single-line comments
SL_COMMENT
	: ('-' '-'	(~('\n'|'\r'))* ('\n'|'\r'('\n')?) ) => 
		'-' '-'
		(~('\n'|'\r'))* ('\n'|'\r'('\n')?)
		{ newline(); _ttype =
ANTLR_USE_NAMESPACE(antlr)Token::SKIP; }
     | '-' '-'(~('\n'|'\r'))*
       {_ttype =
ANTLR_USE_NAMESPACE(antlr)Token::SKIP; } 
	;


From ric.klaren at gmail.com  Wed Nov  9 07:41:36 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Wed Nov  9 07:38:33 2005
Subject: [antlr-interest] CPP COMMENTS
In-Reply-To: <4372195C.5050702@ntlworld.com>
References: <4372195C.5050702@ntlworld.com>
Message-ID: <437218B0.8080703@gmail.com>

Henry Butowsky wrote:
> Im still trying to get C++ style comments working. I have the rule.
> 
> CPP_COMMENT: ("//" (~'\n')* '\n')
>     { newline(); $setType(antlr::Token::SKIP); };
> 
> It seems to be crashing out in the lexer in CalcLexer::mCPP_COMMENT().
> More specifically -- whats happening is that it is crashing out on the
> line -- match('\n'). I've investigated with the debugger and whats
> happening is that it is matching everything from the comment start till
> the end of the file (ignoring any \n). Thus returning a -1 (which is EOF)
> 
> Setting codeGenBitsetTestThreshold to 999 ?
> Setting k to 3,4,5 ?
> Rebuilding antlr from scratch rather than using rpm distribution

Basically the rule and the generated code look ok.

When you rebuild antlr did you make sure to clean out any old object
files? Also make sure to use the same compiler for both the library and
the project. (make sure it does not pick up a stale libantlr.a from
somewhere else on the system)

What antlr version is this?
What compiler are you using?
On what platform?

It would also be interesting to know why the matchNot is not behaving..
Could you post the _tokenSet_0 contents? (preferably including the
comment with the contents the bitset in front of it)

Does it crash on the call of match or does it crash inside match?

Cheers,

Ric
From madcapmaggie at yahoo.com  Wed Nov  9 07:59:07 2005
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Wed Nov  9 07:59:11 2005
Subject: [antlr-interest] CPP COMMENTS
In-Reply-To: <43722097.3040909@ntlworld.com>
Message-ID: <20051109155907.19148.qmail@web30205.mail.mud.yahoo.com>

Henry,
Here is a lexer declaration that works for me. 
What OS are you working on?  Have you verified
that the newline characters in your file are
OK? 

Other
than that, maybe you should get another copy of the
distribution, rebuild from scratch and reinstall
antlr.

Peggy



class SqlLexer extends Lexer;
options {
    k=2;                   // lookahead
  
    testLiterals=false;    
    caseSensitiveLiterals=false; 
    charVocabulary='\3'..'\377';
    codeGenMakeSwitchThreshold = 4;    
    codeGenBitsetTestThreshold= 4;
    defaultErrorHandler=false; 

--- Henry Butowsky <henryb@ntlworld.com> wrote:

> Hi Peggy,
>  Thx for your quick response
>  I tried the code. Its not now crashing out -- But 
> now  everything from the
> start of the comment to the end of the file  is now
> ignored !!
> Is there some option that I'm missing ?
> 
> 
> Peggy Fieland wrote:
> 
> >Here's what I use for SL comments -- it's for SQL
> but 
> >should work for c++.
> >
> >I'm generating c++ code on LINUX and I built
> >antlr-2.7.5 
> >from scratch.
> >
> >// Single-line comments
> >SL_COMMENT
> >	: ('-' '-'	(~('\n'|'\r'))* ('\n'|'\r'('\n')?) ) =>
> 
> >		'-' '-'
> >		(~('\n'|'\r'))* ('\n'|'\r'('\n')?)
> >		{ newline(); _ttype =
> >ANTLR_USE_NAMESPACE(antlr)Token::SKIP; }
> >     | '-' '-'(~('\n'|'\r'))*
> >       {_ttype =
> >ANTLR_USE_NAMESPACE(antlr)Token::SKIP; } 
> >	;
> >
> >
> >
> >  
> >
> 
> 
> 

From dragonoe at mcmaster.ca  Wed Nov  9 08:29:54 2005
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Wed Nov  9 08:26:02 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
	<72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
Message-ID: <20051109162954.GA26958@dragon.homelinux.org>

On Tue, Nov 08, 2005 at 09:58:06AM -0800, Terence Parr wrote:
> Hi.  Yes, that does seem to say there is a bug.  Note that I cannot  
> reproduce this bug.  I added an empty alt and I still get correct code.

Could this be related to a bug I reported a few months ago?

These are the threads online (spans two months). Unfortunatly mailman
doesn't seem to deal with attachments very well. If you don't keep your
own archive I still have my simple test case, and could resend it.

http://www.antlr.org/pipermail/antlr-interest/2005-July/013231.html
http://www.antlr.org/pipermail/antlr-interest/2005-August/013270.html

I never got a reply about it so I don't know if it was fixed.

Thanks,
-Olivier

-- 
          __-/|    ? ?     |\-__
     __--/  /  \   (^^)   /  \  \--__
  _-/   /   /  /\ / ( )  /\  \   \   \-_
 /  /   /  /  /  (   ^^ ~  \  \  \   \  \
 / Oli Dragon    ( dragonoe@mcmaster.ca \
/  B.Eng. Sfwr   (     )    \    \  \    \
/  /  /    /__--_ (   ) __--__\    \  \  \
|  /  /  _/        \_ \_       \_  \  \  |
 \/  / _/            \_ \_       \_ \  \/
  \_/ /                -\_\        \ \_/
    \/                    )         \/
                        *~
        ___--<***************>--___
       [http://dragon.homelinux.org]
        ~~~--<***************>--~~~
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051109/6978984c/attachment.bin
From parrt at cs.usfca.edu  Wed Nov  9 09:15:56 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov  9 09:16:52 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <20051109162954.GA26958@dragon.homelinux.org>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
	<72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
	<20051109162954.GA26958@dragon.homelinux.org>
Message-ID: <71F211C6-E892-424D-B47D-CBC27E57C0F3@cs.usfca.edu>


On Nov 9, 2005, at 8:29 AM, Olivier Dragon wrote:

> On Tue, Nov 08, 2005 at 09:58:06AM -0800, Terence Parr wrote:
>> Hi.  Yes, that does seem to say there is a bug.  Note that I cannot
>> reproduce this bug.  I added an empty alt and I still get correct  
>> code.
>
> Could this be related to a bug I reported a few months ago?
>
> These are the threads online (spans two months). Unfortunatly mailman
> doesn't seem to deal with attachments very well. If you don't keep  
> your
> own archive I still have my simple test case, and could resend it.
>
> http://www.antlr.org/pipermail/antlr-interest/2005-July/ 
> 013231.html
> http://www.antlr.org/pipermail/antlr-interest/2005-August/ 
> 013270.html
>
> I never got a reply about it so I don't know if it was fixed.

Hi Oliver, I believe it is correct behavior you are seeing:

		 // avoid tokenizing the . from an operator (eg. "1.eq.2")
		('.' (NUM | EXPON | ~('n'|'a'|'o'|'e'|'x'|'l'|'g'|'t'|'f')))=>
		'.' (NUM)* (EXPON)?   // 123. or 123.456
		{_ttype=RCON;}

First, the => pred is totally unnecessary and antlr removes it:

	switch(LA(1)) {
	...
		case '.':
		{
			match('.');


The code it generates seems correct.  Can you tell me what path  
through the code seems bad?

If it is this:

			if ((LA(1)=='d'||LA(1)=='e')) {
				mEXPON(false);
			}
			else {
			}

where the else is blank...don't worry.  That is correct.  It is  
saying any char will work other than the EXPON:

(EXPON)?

Ter
From geiroves at online.no  Wed Nov  9 09:43:55 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Wed Nov  9 09:44:07 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
Message-ID: <000001c5e555$2833c730$5408a8c0@rexii>

Hello,

First of all, I have stated that I WILL try to provide an example that
reproduces the error. I am currently at a conference in Malm? Sweeden
and do not have the time nor opportuinity to do that; It will surely be
time consuming.

Secondly, I sincerely hope you are NOT Serious when you say: QUOTE:
<<Also you seem to be the only one that ran into this so far>>  Well,
someone surely must be the first one to report / encounter a bug, but in
your book that means neglecting it? How do you know that others haven't
encountered this bug? It took me 2 at least 2 months of trying to
rewrite code since I thought it was me, when it was ANTLR all the time.

Thrirdly, the workaround is not good performance wise.

What's worst, is that as long as the Bug is there, you really do not
knows when it bites you: The only way to find out, is to try BOTH with
and without Bitsets whenever a piece of code does not parse as expected.
THAT IS NOT a good solution timewise, and ANTLR is supposed to save us
time, isn't it?



Geir Ove

-----Original Message-----
From: Ric Klaren [mailto:ric.klaren@gmail.com] 
Sent: 9. november 2005 15:52
To: Geir Ove Skjaervik
Cc: 'ANTLR Interest'
Subject: Re: [antlr-interest] Serious Bug when using BitSetgeneration


Hi,

Geir Ove Skjaervik wrote:
> Just one more comment on this Bug. It is ** clearly ** a bug, since
> ANTLR does work correctly when BitSets are NOT used. I find it strange

> that this Bug  seems to be passed in almost silence: I would think it 
> to be rather serious to have a "sleeping" bug that may come and bite 
> you any time you encounter the right conditions.

1) As you yourself mentioned there is a workaround. Also you seem to be
the only one that ran into this so far.
2) We cannot reproduce the bug since you don't supply us with the
necessary information to find it: e.g. a clear piece of code that
demonstrates it. I tinkered a bit with the example code you provided but
cannot reproduce it. Terence spent time on it and he cannot reproduce
it. So it's apparently something deeper down in your grammar.

Did you try older antlr versions on the code to see whether it was
introduced in one of the last releases, this might help us narrowing
down where to look? Running the grammar on older antlr's should not take
long.

> Terrence asked me to try to produce a small grammar example to try to
> reproduce the problem. I will as soon as time on my project permits 
> it.

> BUT I would think it is equally IMPORTANT for the ANTLR team to try to
> hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under 
> development, but we sure need a strong ** core ** technology that 
> won't fail.

Hunting bugs blindly is a waste of time. FYI all ANTLR developers have
fulltime jobs not involving ANTLR. Looking at antlr2 code without
knowing what triggers a bug is useless -> provide a good bugreport that
demonstrates the problem!

For me this bug is on ice untill *you* produce a good defect report.

Shouting at us will really not make things go faster. If the speedloss
is a big issue then you should check with your management to get the
time to help us track down this bug. Taking out your stress on us will
not help you.

Cheers,

Ric



From dragonoe at mcmaster.ca  Wed Nov  9 11:34:15 2005
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Wed Nov  9 11:30:22 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <71F211C6-E892-424D-B47D-CBC27E57C0F3@cs.usfca.edu>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
	<72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
	<20051109162954.GA26958@dragon.homelinux.org>
	<71F211C6-E892-424D-B47D-CBC27E57C0F3@cs.usfca.edu>
Message-ID: <20051109193415.GA27336@dragon.homelinux.org>

On Wed, Nov 09, 2005 at 09:15:56AM -0800, Terence Parr wrote:
> First, the => pred is totally unnecessary and antlr removes it:
> 
> 	switch(LA(1)) {
> 	...
> 		case '.':
> 		{
> 			match('.');
> 
> The code it generates seems correct.  Can you tell me what path  
> through the code seems bad?

The problem appears to me in the above code that the "match('.')" above
should be protected by a syntactic predicate as shown in the grammar.
I've created a simpler test which might help identify this.  To get the
correct behaviour I have to increase the codeGenMakeSwitchThreshold
above the number of alternate paths. Here is the grammar used with the
default codeGen value.


class SimpleSynPredTest extends Lexer;
options {
    exportVocab=SimpleSynPredTest; // call the vocabulary "Fortran77"
    testLiterals=false;    // don't automatically test for literals
    k=1;                   // character lookahead
}

OP: ".gt.";

NUMERAL:
	('0'..'9')+ // integer
	(
		'h' | // hex
		('.' ('0'..'9'| ~('g') )) =>
		'.' ('0'..'9')* // real
	)?
	;


will generate code that causes a lexical error on the simple string
"100.gt.1000" (this is Fortran syntax), because instead of tokenizing to
"100" (integer NUMERAL), ".gt."(OP) and "1000" (integer NUMERAL), it
creates "100.", which is a valid syntax for reals in Fortran, and then
breaks on the "g":

line 1:5: unexpected char: 'g'
	at SimpleSynPredTest.nextToken(SimpleSynPredTest.java:81)
	at Main.main(Main.java:23)

This is the offending code (switch case '.'):


		switch ( LA(1)) {
		case 'h':
		{
			match('h');
			break;
		}
		case '.':
		{
			match('.');
			{
			_loop23:
			do {
				if (((LA(1) >= '0' && LA(1) <= '9'))) {
					matchRange('0','9');
				}
				else {
					break _loop23;
				}
				
			} while (true);
			}
			break;
		}
		default:
			{
			}
		}


This happens with the default value of codeGenMakeSwitchThreshold which
I presume is 1. When I increase its value to greater than the number of
alternatives (2 in this case, so 3), I get the following code which
tokenizes correctly without throwing exceptions. I have been running
code like this with a higher codeGenMakeSwitchThreshold value on a lot
of Fortran code and so far it hasn't failed me.

		if ((LA(1)=='h')) {
			match('h');
		}
		else {
			boolean synPredMatched55 = false;
			if (((LA(1)=='.'))) {
				int _m55 = mark();
				synPredMatched55 = true;
				inputState.guessing++;
				try {
					{
					match('.');
					{
					if (((LA(1) >= '0' && LA(1) <= '9'))) {
						matchRange('0','9');
					}
					else if ((_tokenSet_0.member(LA(1)))) {
						{
						match(_tokenSet_0);
						}
					}
					else {
						throw new NoViableAltForCharException((char)LA(1), getFilename(), getLine(), getColumn());
					}
					
					}
					}
				}
				catch (RecognitionException pe) {
					synPredMatched55 = false;
				}
				rewind(_m55);
inputState.guessing--;
			}
			if ( synPredMatched55 ) {
				match('.');
				{
				_loop57:
				do {
					if (((LA(1) >= '0' && LA(1) <= '9'))) {
						matchRange('0','9');
					}
					else {
						break _loop57;
					}
					
				} while (true);
				}
			}
			else {
			}
			}


Does this make things clearer? Let me know if I can help more.

-Olivier


-- 
          __-/|    ? ?     |\-__
     __--/  /  \   (^^)   /  \  \--__
  _-/   /   /  /\ / ( )  /\  \   \   \-_
 /  /   /  /  /  (   ^^ ~  \  \  \   \  \
 / Oli Dragon    ( dragonoe@mcmaster.ca \
/  B.Eng. Sfwr   (     )    \    \  \    \
/  /  /    /__--_ (   ) __--__\    \  \  \
|  /  /  _/        \_ \_       \_  \  \  |
 \/  / _/            \_ \_       \_ \  \/
  \_/ /                -\_\        \ \_/
    \/                    )         \/
                        *~
        ___--<***************>--___
       [http://dragon.homelinux.org]
        ~~~--<***************>--~~~
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051109/aadd7716/attachment.bin
From ray at soartech.com  Wed Nov  9 12:50:20 2005
From: ray at soartech.com (David Ray)
Date: Wed Nov  9 12:50:23 2005
Subject: [antlr-interest] TreeParser question
Message-ID: <4372610C.1020409@soartech.com>

Hello,

Is there a way for a tree parser rule to match against any occurrence of 
a particular node type without encoding the entire tree structure in the 
rule?  Or am I better off just writing a recursive search in Java?

Thanks,
Dave
From parrt at cs.usfca.edu  Wed Nov  9 12:55:17 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov  9 12:56:12 2005
Subject: [antlr-interest] TreeParser question
In-Reply-To: <4372610C.1020409@soartech.com>
References: <4372610C.1020409@soartech.com>
Message-ID: <5EFE83D8-C751-4A76-ADF6-DAD6E8B31C2B@cs.usfca.edu>


On Nov 9, 2005, at 12:50 PM, David Ray wrote:

> Hello,
>
> Is there a way for a tree parser rule to match against any  
> occurrence of a particular node type without encoding the entire  
> tree structure in the rule?  Or am I better off just writing a  
> recursive search in Java?

Hi. I think you want something like the following AST methods:

     public ASTEnumeration findAll(AST tree);

     public ASTEnumeration findAllPartial(AST subtree);

Ter
From parrt at cs.usfca.edu  Wed Nov  9 14:55:35 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov  9 14:56:28 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <20051109193415.GA27336@dragon.homelinux.org>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
	<72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
	<20051109162954.GA26958@dragon.homelinux.org>
	<71F211C6-E892-424D-B47D-CBC27E57C0F3@cs.usfca.edu>
	<20051109193415.GA27336@dragon.homelinux.org>
Message-ID: <81B01026-4034-4CAC-82D0-52BEE34A1F29@cs.usfca.edu>

On Nov 9, 2005, at 11:34 AM, Olivier Dragon wrote:
> I've created a simpler test which might help identify this.  To get  
> the
> correct behaviour I have to increase the codeGenMakeSwitchThreshold
> above the number of alternate paths. Here is the grammar used with the
> default codeGen value.

[snip]

> OP: ".gt.";
>
> NUMERAL:
> 	('0'..'9')+ // integer
> 	(
> 		'h' | // hex
> 		('.' ('0'..'9'| ~('g') )) => '.' ('0'..'9')* // real
> 	)?
> 	;

First, why is this not what you want:

NUMERAL:
	('0'..'9')+ // integer
	(
		'h' // hex
	|	'.' ('0'..'9')* // real
	)?
	;

Why the predicate?  Set k=2 and it should work perfectly.

That said, it seems to be a bug (different than Geir's bug) that the  
switch threshold causes the pred to be generated or not...hmm...

Ter
From ric.klaren at gmail.com  Wed Nov  9 16:03:58 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Wed Nov  9 16:00:28 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000001c5e555$2833c730$5408a8c0@rexii>
References: <000001c5e555$2833c730$5408a8c0@rexii>
Message-ID: <43728E6E.9020007@gmail.com>

Geir Ove Skjaervik wrote:
> First of all, I have stated that I WILL try to provide an example that
> reproduces the error. I am currently at a conference in Malm? Sweeden
> and do not have the time nor opportuinity to do that; It will surely be
> time consuming.

I'll look forward to the example. In this case it will be enough if it's
a .g file that generates code it doesn't need to compile. (if it does
it's nice though)

> Secondly, I sincerely hope you are NOT Serious when you say: QUOTE:
> <<Also you seem to be the only one that ran into this so far>>  Well,
> someone surely must be the first one to report / encounter a bug, but in
> your book that means neglecting it? How do you know that others haven't
> encountered this bug? It took me 2 at least 2 months of trying to
> rewrite code since I thought it was me, when it was ANTLR all the time.

There's a difference between prioritizing it in a way *you* don't like
and neglecting. We can spent our time bughunting much more efficiently
with a clue where to look if we get a snippet that triggers the problem.

> Thrirdly, the workaround is not good performance wise.

But it 'works'. E.g. you can continue developing. Not in an optimal way
but you can.

> What's worst, is that as long as the Bug is there, you really do not
> knows when it bites you: The only way to find out, is to try BOTH with
> and without Bitsets whenever a piece of code does not parse as expected.
> THAT IS NOT a good solution timewise, and ANTLR is supposed to save us
> time, isn't it?

Well develop with bitsets turned off? Or modify your build to create
both versions so you can directly see if the behaviour differs between
the two. Producing a snippet that triggers the bug is probably more time
efficient though.

Anyway shouting at eachother won't solve anything.

Cheers,

Ric
From atripp at comcast.net  Thu Nov 10 07:12:19 2005
From: atripp at comcast.net (Andy Tripp)
Date: Thu Nov 10 07:14:44 2005
Subject: [antlr-interest] Java In / Java Out: Going once ...
Message-ID: <43736353.9050307@comcast.net>

Eric,
I feel your pain :)

If you're lazy like me and don't feel like even learning StringTemplate 
or even tree walkers,
you can just use my JavaEmitter code. You use the standard java.g to 
read into an AST,
and then this code walks that tree without using the ANTLR treewalker thing.
This code does a good job of formatting the Java output, too.

You could also use Terrance's JavaEmitter that uses an ANTLR treewalker.
Both are available under the "File Sharing" section of antlr.org

Andy
From braden at endoframe.com  Thu Nov 10 11:07:13 2005
From: braden at endoframe.com (Braden McDaniel)
Date: Thu Nov 10 12:12:06 2005
Subject: [antlr-interest] Problem with relative paths on Windows
Message-ID: <dl05oq$669$1@sea.gmane.org>

I'm observing an apparent problem with relative paths on Windows when 
attempting to generate code from a grammar that inherits another one. 
When issuing this command:

java -cp c:/data1/bmcdaniel/antlr/275/lib/antlr.jar antlr.Tool -o 
../../../src/libopenvrml/openvrml -glib 
../../../src/libopenvrml/openvrml/Vrml97Parser.g 
../../../src/libopenvrml/openvrml/X3DVrmlParser.g

I get this error:

ANTLR Parser Generator   Version 2.7.5 (20050128)   1989-2005 jGuru.com
error: cannot write expanded grammar file 
expanded../../../src/libopenvrml/openvrml/X3DVrmlParser.g

It looks like the name/path of the intermediate grammar file isn't being 
constructed correctly. This works just fine on Linux, though.

Braden

From madcapmaggie at yahoo.com  Thu Nov 10 12:19:54 2005
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Thu Nov 10 12:20:00 2005
Subject: [antlr-interest] Problem with relative paths on Windows
In-Reply-To: <dl05oq$669$1@sea.gmane.org>
Message-ID: <20051110201954.94199.qmail@web30206.mail.mud.yahoo.com>

I don't know how you're generating the relative path
name or if the tool is, but that's a UNIX relative
path name ... windows path names are different.

Peggy

--- Braden McDaniel <braden@endoframe.com> wrote:

> I'm observing an apparent problem with relative
> paths on Windows when 
> attempting to generate code from a grammar that
> inherits another one. 
> When issuing this command:
> 
> java -cp c:/data1/bmcdaniel/antlr/275/lib/antlr.jar
> antlr.Tool -o 
> ../../../src/libopenvrml/openvrml -glib 
> ../../../src/libopenvrml/openvrml/Vrml97Parser.g 
> ../../../src/libopenvrml/openvrml/X3DVrmlParser.g
> 
> I get this error:
> 
> ANTLR Parser Generator   Version 2.7.5 (20050128)  
> 1989-2005 jGuru.com
> error: cannot write expanded grammar file 
>
expanded../../../src/libopenvrml/openvrml/X3DVrmlParser.g
> 
> It looks like the name/path of the intermediate
> grammar file isn't being 
> constructed correctly. This works just fine on
> Linux, though.
> 
> Braden
> 
> 

From braden at endoframe.com  Thu Nov 10 12:55:26 2005
From: braden at endoframe.com (Braden McDaniel)
Date: Thu Nov 10 12:59:01 2005
Subject: [antlr-interest] Re: Problem with relative paths on Windows
In-Reply-To: <20051110201954.94199.qmail@web30206.mail.mud.yahoo.com>
References: <dl05oq$669$1@sea.gmane.org>
	<20051110201954.94199.qmail@web30206.mail.mud.yahoo.com>
Message-ID: <dl0c3n$qv4$1@sea.gmane.org>

Peggy Fieland wrote:
> I don't know how you're generating the relative path
> name or if the tool is, but that's a UNIX relative
> path name ... windows path names are different.

The only difference would be backslashes versus slashes. And lots of 
Windows tools--particularly developer tools--support both 
interchangably. (Note that the "java" executable certainly does--forward 
slashes are used in the argument to -cp.)

Changing to backslashes works, thanks. But I think this should be 
regarded as a bug.

Braden

From wirecracker at gmail.com  Thu Nov 10 13:57:43 2005
From: wirecracker at gmail.com (eric nelson)
Date: Thu Nov 10 13:57:45 2005
Subject: [antlr-interest] Java In / Java Out: Going once ...
In-Reply-To: <43736353.9050307@comcast.net>
References: <43736353.9050307@comcast.net>
Message-ID: <ca5eeb330511101357j37f55409pcd56081b71724b50@mail.gmail.com>

Actually, the point is that I am trying to learn StringTemplate and ANTLR. I
thought this would be a great exercise by translating from Java to Java
using ANTLR to parse the input and StringTemplate to format the output. I
have made some recent progress thanks to Terence and Laurent :) If anyone's
interested (and if I finish this sometime before the new year ;), I'll post
my final code :)
 But, yes Andy, thanks for the JavaEmitter suggestion :)
  - e


 On 11/10/05, Andy Tripp <atripp@comcast.net> wrote:
>
> Eric,
> I feel your pain :)
>
> If you're lazy like me and don't feel like even learning StringTemplate
> or even tree walkers,
> you can just use my JavaEmitter code. You use the standard java.g to
> read into an AST,
> and then this code walks that tree without using the ANTLR treewalker
> thing.
> This code does a good job of formatting the Java output, too.
>
> You could also use Terrance's JavaEmitter that uses an ANTLR treewalker.
> Both are available under the "File Sharing" section of antlr.org<http://antlr.org>
>
> Andy
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051110/ff961c8a/attachment.html
From parrt at cs.usfca.edu  Thu Nov 10 15:18:23 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Nov 10 15:19:13 2005
Subject: [antlr-interest] Java In / Java Out: Going once ...
In-Reply-To: <ca5eeb330511101357j37f55409pcd56081b71724b50@mail.gmail.com>
References: <43736353.9050307@comcast.net>
	<ca5eeb330511101357j37f55409pcd56081b71724b50@mail.gmail.com>
Message-ID: <5A627F79-993A-4AA7-956E-5FF42388182C@cs.usfca.edu>


On Nov 10, 2005, at 1:57 PM, eric nelson wrote:

> Actually, the point is that I am trying to learn StringTemplate and  
> ANTLR.  I thought this would be a great exercise by translating  
> from Java to Java using ANTLR to parse the input and StringTemplate  
> to format the output.

I definitely want to do this myself using the v3 antlr as a test.  I  
mainly want to learn how to build a decent pretty printer with ST. :)

>   I have made some recent progress thanks to Terence and  
> Laurent :)  If anyone's interested (and if I finish this sometime  
> before the new year ;), I'll post my final code :)
>

Hooray!

Ter
From dragonoe at mcmaster.ca  Fri Nov 11 07:35:51 2005
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Fri Nov 11 07:48:43 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <81B01026-4034-4CAC-82D0-52BEE34A1F29@cs.usfca.edu>
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
	<72FC7489-D182-41B5-9970-E1D11E08F72E@cs.usfca.edu>
	<20051109162954.GA26958@dragon.homelinux.org>
	<71F211C6-E892-424D-B47D-CBC27E57C0F3@cs.usfca.edu>
	<20051109193415.GA27336@dragon.homelinux.org>
	<81B01026-4034-4CAC-82D0-52BEE34A1F29@cs.usfca.edu>
Message-ID: <20051111153551.GA32122@dragon.homelinux.org>

On Wed, Nov 09, 2005 at 02:55:35PM -0800, Terence Parr wrote:
> First, why is this not what you want:
> 
> NUMERAL:
> 	('0'..'9')+ // integer
> 	(
> 		'h' // hex
> 	|	'.' ('0'..'9')* // real
> 	)?
> 	;
> 
> Why the predicate?  Set k=2 and it should work perfectly.

Unfortunatly it doesn't work. With k=2 and default value for
codeGenMakeSwitchThreshold I get:


		switch ( LA(1)) {
		case 'h':
		{
			match('h');
			break;
		}
		case '.':
		{
			match('.');
			{
			_loop7:
			do {
				if (((LA(1) >= '0' && LA(1) <= '9'))) {
					matchRange('0','9');
				}
				else {
					break _loop7;
				}
				
			} while (true);
			}
			break;
		}
		default:
			{
			}
		}


If I put k=2 and codeGenMakeSwitchThreshold=2 I get something wrong as
well:


		if ((LA(1)=='h')) {
			match('h');
		}
		else if ((LA(1)=='.')) {
			match('.');
			{
			_loop23:
			do {
				if (((LA(1) >= '0' && LA(1) <= '9'))) {
					matchRange('0','9');
				}
				else {
					break _loop23;
				}
				
			} while (true);
			}
		}
		else {
		}

It's like ANTLR doesn't see the non-determinism between OP: ".gt." and
the NUMERAL rule. I also tried changing the (HEX | REAL)? part to
(HEX | REAL | ) and got the same result. I tried increasing look-ahead
to k=5 but got the result as well.

I've tried with both ANTLR 2.7.5 and ANTLR 2.7.6 preview that came with
the the antlreclipse plugin v4.0.0-b2 and Java 1.5. Should I try with a
newer version? 3.0aX?

-Olivier

-- 
          __-/|    ? ?     |\-__
     __--/  /  \   (^^)   /  \  \--__
  _-/   /   /  /\ / ( )  /\  \   \   \-_
 /  /   /  /  /  (   ^^ ~  \  \  \   \  \
 / Oli Dragon    ( dragonoe@mcmaster.ca \
/  B.Eng. Sfwr   (     )    \    \  \    \
/  /  /    /__--_ (   ) __--__\    \  \  \
|  /  /  _/        \_ \_       \_  \  \  |
 \/  / _/            \_ \_       \_ \  \/
  \_/ /                -\_\        \ \_/
    \/                    )         \/
                        *~
        ___--<***************>--___
       [http://dragon.homelinux.org]
        ~~~--<***************>--~~~
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051111/77d262cb/attachment.bin
From parrt at cs.usfca.edu  Fri Nov 11 10:27:02 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov 11 10:27:49 2005
Subject: [antlr-interest] StringTemplate 2.3 regions and ANTLR v3 code gen
Message-ID: <23FBC8C8-15B5-46FE-9362-2A43CC1099EA@cs.usfca.edu>

Ok, another just amazing ST moment.  Imagine the following template  
that was previously used to generate validation code for a predicate:

/** Every predicate is used as a validating predicate (even when it is
*  also hoisted into a prediction expression).
*/
validateSemanticPredicate(pred) ::= <<
if ( !(<if(debug)>evalPredicate(<pred>,"<pred>")<else><pred><endif>) ) {
     throw new FailedPredicateException(input, "<ruleName>", "<pred>");
}
 >>

So when I see

a : {p}? A ;

I want to generate

if ( !(p) ) {
   throw new ...
}

and

if ( !(evalPredicate(p,"p")) ) {
   throw new ...
}

when debugging.

The template is not only hard to read, but you have the debug stuff  
mingled with regular code; bad separation of concerns.  What you  
really want is the normal template to have code that might need  
replacing marked as a region via <@eval>...<@end>:

group Java;
...
/** Every predicate is used as a validating predicate (even when it is
*  also hoisted into a prediction expression).
*/
validateSemanticPredicate(pred) ::= <<
if ( !(<@eval><pred><@end>) ) {
     throw new FailedPredicateException(input, "<ruleName>", "<pred>");
}
 >>

Then, in a subgroup, you can override/specify the code needed to do  
the actual eval:

group Dbg;
...
/** Force predicate validation to trigger an event */
@validateSemanticPredicate.eval() ::= <<evalPredicate(<pred>,"<pred>")>>

This avoids the need to override the *entire*  
validateSemanticPredicate template, thus, duplicating the generation  
code (introducing the usual maintenance nightmare).  You override a  
"snippet" or _region_. :)

Hooray!

Coming soon to a theatre near you. :)

Ter
PS	Thanks again to Ric Klaren for helping invent this!
From jbarnesweb at yahoo.com  Fri Nov 11 19:37:05 2005
From: jbarnesweb at yahoo.com (Jeff Barnes)
Date: Fri Nov 11 19:37:08 2005
Subject: [antlr-interest] Manual Lookaheads
Message-ID: <20051112033705.38100.qmail@web54508.mail.yahoo.com>

I have a lot of this kind of thing going on in my
lexer:

protected
TLE_SF
{
    boolean hasX020B = false;
    boolean hasX36 = false;
    int length = 0;
}
:
    byte1:'\u0000'..'\u007F'  
    byte2:. {length = (byte1<<8)+byte2-8;}
    '\u00D3' 
    '\u00A0' 
    '\u0090' 
    '\0' 
    '\0' 
    '\0' 
    (
        {LA(2) == '\2'}? {length -= LA(1);}
(X02[LA(1),0X0B])! {hasX020B = true;}
    |   {LA(2) == '\u0036'}? {length -= LA(1);} X36!
{hasX36 = true;}
    )+
    ({length > 0}?
        {LA(2) == '\1'}? {length -= LA(1);} X01!
    |   {LA(2) == '\2' && ((LA(3) == '\u0087') ||
(LA(3) == '\15') || (LA(3) == '\u000C'))}? {length -=
LA(1);} (X02[LA(1),LA(3)])!
    |   {LA(2) == '\u0080'}? {length -= LA(1);} X80!
    )*
    {inputState.guessing != 0 || (hasX020B && hasX36
&& length==0)}?
;

The subrules are ambiguous without k > 1, therefore
protected. Of course, this generates a plethora of
nondeterminism warnings. But the lexer works after
very extensive testing. It's just that doing this
*feels* hackish.

Is there something I'm missing? The language (MO:DCA)
is based on structured fields like what's described in
the above rule. Does anybody have experience parsing
AFP files?

Regards,
Jeff
From inshua at gmail.com  Fri Nov 11 19:39:35 2005
From: inshua at gmail.com (=?GB2312?B?0MLC8g==?=)
Date: Fri Nov 11 19:39:39 2005
Subject: [antlr-interest] make a demo editor for tiny-c
Message-ID: <2506dcb70511111939y3d09d3e4y@mail.gmail.com>

i want to make an editor for tiny-c , include syntax highlighting ,code
fold, and more interesting functions.
os: windows xp
language : c#
there are some problems.
a) how can i get the DFA syntax tree ? does the parser that ANTLR generated
have some interface to get it?
b) everytime when user edit the text, should i rebuild the tree?
 thank u help~
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051112/f2bb811a/attachment.html
From parrt at cs.usfca.edu  Sat Nov 12 11:38:59 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 12 11:39:43 2005
Subject: [antlr-interest] Manual Lookaheads
In-Reply-To: <20051112033705.38100.qmail@web54508.mail.yahoo.com>
References: <20051112033705.38100.qmail@web54508.mail.yahoo.com>
Message-ID: <FE023EBF-DC98-42FD-B4B6-C2926B2EE1E0@cs.usfca.edu>

Hi.  You might want to look at PADS, led by Kathleen Fisher:

"PADS is a declarative data description language that allows data  
analysts to describe both the physical layout of ad hoc data sources  
and semantic properties of that data."

http://www.padsproj.org/about.html

It seems pretty cool to me and specifically designed to parse data.

Ter

From naghmeh.daneshmand at informatik.uni-ulm.de  Sat Nov 12 15:12:23 2005
From: naghmeh.daneshmand at informatik.uni-ulm.de (Naghmeh Daneshmand)
Date: Sat Nov 12 15:12:46 2005
Subject: [antlr-interest] parsing and modifying java programs. please help!
Message-ID: <437676D7.10108@informatik.uni-ulm.de>

Hi,
how can I define my own node type (AST). I would like to parse Java 
programs and modify their values. What would be the best way to achieve 
this goal?
Is there any example of this and where can I find them?
Have I to define a new node type?

thank you.
Naghmeh

From nadesai at cse.iitb.ac.in  Sun Nov 13 13:32:06 2005
From: nadesai at cse.iitb.ac.in (Desai Nishitkumar Ashokkumar)
Date: Sun Nov 13 13:32:13 2005
Subject: [antlr-interest] Some problem in parsing. Need Help.
In-Reply-To: <20051113200004.4EE17DCC5F@www.antlr.org>
References: <20051113200004.4EE17DCC5F@www.antlr.org>
Message-ID: <Pine.LNX.4.61.0511140254010.8649@nsl-14.cse.iitb.ac.in>

Hi,
      I want some help. This the problem which i want to solve.

When some wrong token is found, ANTLR gives error like "unexpected 
token:...". What I want to do is when this kind of error is found 
I want to give some other token to ANTLR and want antlr starts parsing 
from previos state with this new given token.

Can anyone tell me that How to do this in ANTLR ?  Where (which places or 
part) I have to make changes do this ??

Thanks in advance.

-Nishit

On Sun, 13 Nov 2005 antlr-interest-request@antlr.org wrote:

> Send antlr-interest mailing list submissions to
> 	antlr-interest@antlr.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	http://www.antlr.org/mailman/listinfo/antlr-interest
> or, via email, send a message with subject or body 'help' to
> 	antlr-interest-request@antlr.org
>
> You can reach the person managing the list at
> 	antlr-interest-owner@antlr.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of antlr-interest digest..."
>
>
> Today's Topics:
>
>   1. parsing and modifying java programs. please help!
>      (Naghmeh Daneshmand)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Sun, 13 Nov 2005 00:12:23 +0100
> From: Naghmeh Daneshmand <naghmeh.daneshmand@informatik.uni-ulm.de>
> Subject: [antlr-interest] parsing and modifying java programs. please
> 	help!
> To: antlr-interest@antlr.org
> Message-ID: <437676D7.10108@informatik.uni-ulm.de>
> Content-Type: text/plain; charset=ISO-8859-15; format=flowed
>
> Hi,
> how can I define my own node type (AST). I would like to parse Java
> programs and modify their values. What would be the best way to achieve
> this goal?
> Is there any example of this and where can I find them?
> Have I to define a new node type?
>
> thank you.
> Naghmeh
>
>
>
> ------------------------------
>
> _______________________________________________
> antlr-interest mailing list
> antlr-interest@antlr.org
> http://www.antlr.org/mailman/listinfo/antlr-interest
>
>
> End of antlr-interest Digest, Vol 12, Issue 20
> **********************************************
>

From parrt at cs.usfca.edu  Sun Nov 13 14:06:26 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 13 14:07:04 2005
Subject: [antlr-interest] ANTLR 3.0ea6 released
Message-ID: <0670B870-40BF-4BC6-823E-7FC2D8C63429@cs.usfca.edu>

Howdy,

Another early access v3 release for you, 3.0ea6:

http://www.antlr.org/download/antlr-3.0ea6.tar.gz

You might also want

http://www.antlr.org/download/examples-v3.tar.gz

(which seems to still work).

BIG improvements from 3.0ea5.  This release requires 2.3b3  
StringTemplate and 2.7.5 ANTLR; the jars are included in the lib dir  
for your convenience.

You'll also note that -debug and -profile are off by default now;  
decided not to continue collecting data and will make it a manual  
push.  Basically, I'm getting all the runs during development etc...,  
but what I really want is a run from a complete working grammar with  
decent inputs.  The data will be collected to analyze common grammar  
issues etc...

Regards,
Ter

From parrt at cs.usfca.edu  Sun Nov 13 16:44:38 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 13 16:45:17 2005
Subject: [antlr-interest] oops; 3.0ea6 tarball updated
Message-ID: <DE9A1548-1CF7-434A-AF7A-27C38F06AC76@cs.usfca.edu>

Oops...Jean noticed a problem with the debug stuff; I just pushed a  
slightly different version.  A template was hosed.

Ter
From antlr-list at arizona-software.ch  Sun Nov 13 20:24:22 2005
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sun Nov 13 20:24:32 2005
Subject: [antlr-interest] ANTLRWorks 1.0ea5 available!
Message-ID: <FA1AD7AC-33D1-4EE4-A898-E71335B6526E@arizona-software.ch>

Hello!

ANTLRWorks 1.0ea5 is now available at this URL:

http://www.antlr.org/works/index.html

This version fixes and improves several things. I would like to  
emphasis some new features:
- it is now possible to see syntax diagram for lexer rules
- as requested at the ANTLR2005 Workshop, syntax diagram and NFA can  
be exported to EPS file
- two new refactoring features: extract rule and inline rule
- debugger: it is now possible to break on exception generated by ANTLR
- it is also now possible to specify the path of the javac tool

The ANTLRWorks jar has everything you need including the latest  
version of ANTLR 3.x and StringTemplate 2.x.

Feel free to send comments to the antlr-interest list or online at:

http://www.antlr.org/misc/feedback


Enjoy this new release!

Jean Bovet


*** History ***

Version 1.0ea5 - 11/13/05

- new: display syntax diagram and NFA for lexer rules
- new: export syntax diagram and NFA to eps file (File>Export Rule>As  
EPS...)
- new: inline and extract rule refactoring

- added optional path to javac in the preferences
- added output text pane in debugger (all System.out from the parser  
are redirected to this pane)
- added break on exception in debugger
- added regex expression in the Find dialog
- added "Find Text at Caret" and modified menu shortcut for "Find  
Previous"
- added invalid character literal detection

- improved caret jump to position by centering the text
- improved syntax coloring to match more of ANTLR 3 specification  
(label, tokens block, etc)
- improved display decision NFA: doesn't require an exact caret  
position anymore
- improved rule folding: can now fold using the bottom anchor
- re-introduced actions folding (anchors can be disabled in the  
preferences)
- expand or collapse all rules or actions
- improved Go To Rule: ignore case and display typed text in red if  
no match found
- improved debugger connection to remote parser (threaded)
- build and debug/debug: the starting rule pop-up menu has been moved  
to the input text dialog
- improved the build & debug feature to include the ANTLRWorks jar  
itself in the classpath

- hide and disable ideas during debugging
- display a message if the syntax diagram cannot be displayed
- display warning message if ANTLR 2.x grammars detected
- changed debugger port from 2005 to 0xC001 (49153)

- fixed a bug where the undo/redo menu item title would not display  
the correct action name
- fixed a bug in the Find dialog where some pattern would cause an  
exception (didn't quote in the regex)
- fixed a bug which would prevent drag and drop of rules to work on  
Windows
- fixed a bug where not all messages would be displayed in the  
console (added group "idle")
- fixed a bug where applying the preferences would apply the current  
look and feel (not needed)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051113/4cde916e/attachment.html
From demakov at ispras.ru  Mon Nov 14 04:44:28 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Mon Nov 14 04:44:36 2005
Subject: [antlr-interest] parsing and modifying java programs. please help!
References: <437676D7.10108@informatik.uni-ulm.de>
Message-ID: <003d01c5e919$27682cc0$8cc79553@marlboro>

Hi,

May be it is not exactly what you want, but may be it will help:

We're developing open-source Java 1.5 frontend.
Now available:
+ Java 1.5 AST description (as heterogenous tree)
+ parser that builds this tree.
+ printer that prints tree back to text.
Will be available in future:
- semantic checker.

AST is described in TreeDL language http://treedl.sf.net
Tree description looks like:
http://treedl.sourceforge.net/frontend/java5/treedl/com/unitesk/java5/Java5.tdl-xref/index.html
Tree description is used to generate Java classes for tree nodes, visitors, walkers etc.

There were many changes since last released version is 0.0.3,
so I recommend to use latest anonymous CVS snapshot before
0.0.4 will be released. Now it is stable enough to successfully parse JDK 1.5 sources.

Small Java program modifications can be implemented as inheritors of
printer visitor using our simple template engine. But you can use any other
template engine if you like.

This frontend is suitable not only for Java code modifications,
but for translation of extention-of-Java to Java language itself.

Feel free to ask any questions you have.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com

----- Original Message ----- 
From: "Naghmeh Daneshmand" <naghmeh.daneshmand@informatik.uni-ulm.de>
To: <antlr-interest@antlr.org>
Sent: Sunday, November 13, 2005 2:12 AM
Subject: [antlr-interest] parsing and modifying java programs. please help!


> Hi,
> how can I define my own node type (AST). I would like to parse Java 
> programs and modify their values. What would be the best way to achieve 
> this goal?
> Is there any example of this and where can I find them?
> Have I to define a new node type?
> 
> thank you.
> Naghmeh
> 
>

From ga-fries at veenendaalnet.nl  Mon Nov 14 08:37:45 2005
From: ga-fries at veenendaalnet.nl (Jos Fries)
Date: Mon Nov 14 08:34:30 2005
Subject: [antlr-interest] Treeparser inheritance?
Message-ID: <001f01c5e939$bd962ab0$0b01a8c0@altb>

Hi,

Last weekend I experimented with grammar inheritance. I successfully extended a lexer and a parser. Extending my tree parser however failed. My statement "class BTreeWalker extends ATreeWalker;" is accepted by ANTLR but compiled to the Java code "public class BTreeWalker extends antlr.TreeParser".

Excuse the newbie character of the question, but does the concept of grammar inheritance also apply to tree parsers? The documentation doesn't state anything about this. I'm using antlr 2.7.4.

Regards,

Jos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051114/e9e4f4c3/attachment.html
From parrt at cs.usfca.edu  Mon Nov 14 10:30:17 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 14 10:30:53 2005
Subject: [antlr-interest] Treeparser inheritance?
In-Reply-To: <001f01c5e939$bd962ab0$0b01a8c0@altb>
References: <001f01c5e939$bd962ab0$0b01a8c0@altb>
Message-ID: <DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu>


On Nov 14, 2005, at 8:37 AM, Jos Fries wrote:

> Hi,
>
> Last weekend I experimented with grammar inheritance. I  
> successfully extended a lexer and a parser. Extending my tree  
> parser however failed. My statement "class BTreeWalker extends  
> ATreeWalker;" is accepted by ANTLR but compiled to the Java code  
> "public class BTreeWalker extends antlr.TreeParser".
>
> Excuse the newbie character of the question, but does the concept  
> of grammar inheritance also apply to tree parsers? The  
> documentation doesn't state anything about this. I'm using antlr  
> 2.7.4.

Hi Jos, it should work as you describe.  Are you sure you're doing it  
just like in the examples?

Terence

From ga-fries at veenendaalnet.nl  Mon Nov 14 11:49:24 2005
From: ga-fries at veenendaalnet.nl (Jos Fries)
Date: Mon Nov 14 11:46:16 2005
Subject: [antlr-interest] Treeparser inheritance?
References: <001f01c5e939$bd962ab0$0b01a8c0@altb>
	<DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu>
Message-ID: <002b01c5e954$83731850$0b01a8c0@altb>

Hi Terrence,

Could you point me to an example in which a tree parser in a subgrammar 
inherits from the tree parser in the supergrammer? I searched in vain for 
that use of inheritance in the reference manual...

Regards,

Jos


>
> On Nov 14, 2005, at 8:37 AM, Jos Fries wrote:
>
>> Hi,
>>
>> Last weekend I experimented with grammar inheritance. I  successfully 
>> extended a lexer and a parser. Extending my tree  parser however failed. 
>> My statement "class BTreeWalker extends  ATreeWalker;" is accepted by 
>> ANTLR but compiled to the Java code  "public class BTreeWalker extends 
>> antlr.TreeParser".
>>
>> Excuse the newbie character of the question, but does the concept  of 
>> grammar inheritance also apply to tree parsers? The  documentation 
>> doesn't state anything about this. I'm using antlr  2.7.4.
>
> Hi Jos, it should work as you describe.  Are you sure you're doing it 
> just like in the examples?
>
> Terence
>
>
>
>
> -- 
> No virus found in this incoming message.
> Checked by AVG Free Edition.
> Version: 7.1.362 / Virus Database: 267.13.0/167 - Release Date: 11-11-2005
>
> 

From parrt at cs.usfca.edu  Mon Nov 14 12:06:04 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 14 12:06:38 2005
Subject: [antlr-interest] Treeparser inheritance?
In-Reply-To: <002b01c5e954$83731850$0b01a8c0@altb>
References: <001f01c5e939$bd962ab0$0b01a8c0@altb>
	<DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu>
	<002b01c5e954$83731850$0b01a8c0@altb>
Message-ID: <6EA52A2E-ECD9-45C7-B0F8-7350086B8CD9@cs.usfca.edu>

Oh, sorry.  Now I remember.  Inheritance is an "include".  The  
implementation says it inherits from the tree parser, but you'll see  
all your overridden rules inside. :)

Ter
On Nov 14, 2005, at 11:49 AM, Jos Fries wrote:

> Hi Terrence,
>
> Could you point me to an example in which a tree parser in a  
> subgrammar inherits from the tree parser in the supergrammer? I  
> searched in vain for that use of inheritance in the reference  
> manual...
>
> Regards,
>
> Jos
>
>
>>
>> On Nov 14, 2005, at 8:37 AM, Jos Fries wrote:
>>
>>> Hi,
>>>
>>> Last weekend I experimented with grammar inheritance. I   
>>> successfully extended a lexer and a parser. Extending my tree   
>>> parser however failed. My statement "class BTreeWalker extends   
>>> ATreeWalker;" is accepted by ANTLR but compiled to the Java code   
>>> "public class BTreeWalker extends antlr.TreeParser".
>>>
>>> Excuse the newbie character of the question, but does the  
>>> concept  of grammar inheritance also apply to tree parsers? The   
>>> documentation doesn't state anything about this. I'm using antlr   
>>> 2.7.4.
>>
>> Hi Jos, it should work as you describe.  Are you sure you're doing  
>> it just like in the examples?
>>
>> Terence
>>
>>
>>
>>
>> -- 
>> No virus found in this incoming message.
>> Checked by AVG Free Edition.
>> Version: 7.1.362 / Virus Database: 267.13.0/167 - Release Date:  
>> 11-11-2005
>>
>

From nadesai at cse.iitb.ac.in  Mon Nov 14 13:22:06 2005
From: nadesai at cse.iitb.ac.in (Desai Nishitkumar Ashokkumar)
Date: Mon Nov 14 13:22:11 2005
Subject: [antlr-interest] Want to change in ANTLR code
In-Reply-To: <20051113200004.4EE17DCC5F@www.antlr.org>
References: <20051113200004.4EE17DCC5F@www.antlr.org>
Message-ID: <Pine.LNX.4.61.0511150248400.22878@nsl-14.cse.iitb.ac.in>


Hi,
     Suppose I have changed ANTLR file TokenBuffer.java. Now, how can I 
incorporate this new java file ?? means I want to use this new class file. 
AT which places I have to make changes ??

thanks in advance.


-- 
Nishit Desai
M.Tech II year 
Computer Science & Engg.
IIT Bombay
From parrt at cs.usfca.edu  Mon Nov 14 13:30:34 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 14 13:31:07 2005
Subject: [antlr-interest] Want to change in ANTLR code
In-Reply-To: <Pine.LNX.4.61.0511150248400.22878@nsl-14.cse.iitb.ac.in>
References: <20051113200004.4EE17DCC5F@www.antlr.org>
	<Pine.LNX.4.61.0511150248400.22878@nsl-14.cse.iitb.ac.in>
Message-ID: <648CFE55-221F-47ED-8C39-B9524CEEB831@cs.usfca.edu>


On Nov 14, 2005, at 1:22 PM, Desai Nishitkumar Ashokkumar wrote:

>
> Hi,
>     Suppose I have changed ANTLR file TokenBuffer.java.

Just put the modified TokenBuffer.class file first in your CLASSPATH  
environment variable and then it will use your version not the  
default in antlr :)

Terence
From jbarnesweb at yahoo.com  Mon Nov 14 16:11:33 2005
From: jbarnesweb at yahoo.com (Jeff Barnes)
Date: Mon Nov 14 16:11:36 2005
Subject: [antlr-interest] java.lang.InternalError
Message-ID: <20051115001133.55244.qmail@web54509.mail.yahoo.com>

When trying to debug the generated lexer in either
Eclipse or NetBeans, "java.lang.InternalError: name is
too long to represent" is thrown. It is thrown when I
try to instantiate my lexer with the InputStream
argument. The fully-qualified name is 34 characters
long.

Is this a known issue and is there a workaround?

Regards,
Jeff Barnes
From parrt at cs.usfca.edu  Mon Nov 14 20:31:50 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 14 20:32:23 2005
Subject: [antlr-interest] added template rewrite stuff to blog
Message-ID: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>

Howdy,

Added my plans for implementing template rewrites to v3:

http://www.antlr.org/blog/antlr3/rewrite.tml

Ter
From open.zone at virgin.net  Tue Nov 15 00:37:42 2005
From: open.zone at virgin.net (Micheal J)
Date: Tue Nov 15 00:22:13 2005
Subject: [antlr-interest] added template rewrite stuff to blog
In-Reply-To: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
Message-ID: <006c01c5e9bf$d968da40$6802a8c0@hercules>

> Howdy,
> 
> Added my plans for implementing template rewrites to v3:
> 
> http://www.antlr.org/blog/antlr3/rewrite.tml

It about time you get an RSS/ATOM-enabled blog. Just pick one of the many OS
blogging packages.

Micheal

From virtualaspirin at yahoo.com  Tue Nov 15 01:45:33 2005
From: virtualaspirin at yahoo.com (Akhilesh Mritunjai)
Date: Tue Nov 15 01:45:35 2005
Subject: [antlr-interest] java.lang.InternalError
In-Reply-To: <20051115001133.55244.qmail@web54509.mail.yahoo.com>
Message-ID: <20051115094533.82295.qmail@web30803.mail.mud.yahoo.com>

Hi

We are facing the same problem. The funny thing is
that only me in my team is having this problem. I'm
using Sun JDK/JRE 1.5 (Patchset 4) with eclipse 3.1.1
on Windows XP. This problem was intermittent (eg it
went temporarily when changing from 3.1 to 3.1.1), but
again appeared.

This problem does not occur when I use JRockit JRE 1.5
for debugging! So I reckon its some specific issue
pertaining to combination of number of above
components.

My teammates on Linux using Sun JRE 1.5_4 for Linux
don't face this problem (may be yet!) with eclipse 3.1

Google doesn't help much with this issue.

- Akhilesh

--- Jeff Barnes <jbarnesweb@yahoo.com> wrote:

> When trying to debug the generated lexer in either
> Eclipse or NetBeans, "java.lang.InternalError: name
> is
> too long to represent" is thrown. It is thrown when
> I
> try to instantiate my lexer with the InputStream
> argument. The fully-qualified name is 34 characters
> long.
> 
> Is this a known issue and is there a workaround?
> 
> Regards,
> Jeff Barnes
> 



	
		
__________________________________ 
Yahoo! Mail - PC Magazine Editors' Choice 2005 
http://mail.yahoo.com
From amohombe at yahoo.com  Tue Nov 15 04:39:52 2005
From: amohombe at yahoo.com (Ahmed Mohombe)
Date: Tue Nov 15 04:51:20 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <006c01c5e9bf$d968da40$6802a8c0@hercules>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules>
Message-ID: <dlckup$djp$2@sea.gmane.org>

>>Howdy,
>>
>>Added my plans for implementing template rewrites to v3:
>>
>>http://www.antlr.org/blog/antlr3/rewrite.tml
> 
> 
> It about time you get an RSS/ATOM-enabled blog. Just pick one of the many OS
> blogging packages.
Yeah, AFAIK Confluence has such a support, and ANTLR had a Confluence license.
Why not using it?

Ahmed.

From parrt at cs.usfca.edu  Tue Nov 15 09:38:36 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 15 09:39:06 2005
Subject: [antlr-interest] anybody interested in writing an ANTLR article?
Message-ID: <48712844-6784-416D-9491-9FE060316647@cs.usfca.edu>

Hi, the following tech magazine is interested in having someone do an  
article on using ANTLR:

> Olga krawczyk
> Software-Wydawnictwo Sp z o.o.
> Product Manager
> olga.krawczyk at software.com.pl
> www.software.com.pl/en

> we are a Polish Publishing House Software-Wydawnictwo. We publish
> several titles in 7 different languages. we would like to propose
> you to
> write an article for us (the article would be published in 2
> magazines :
> Software Developer's Journal and SDJ Extra! and distributed in France,
> Spain, Germany, Austria, Belgium, Switzerland and Poland).

Could be interesting for someone, particular a European looking for  
good exposure :)  Please respond directly to Olga for more information.

Regards,
Terence
From tcurdt at vafer.org  Tue Nov 15 10:13:57 2005
From: tcurdt at vafer.org (Torsten Curdt)
Date: Tue Nov 15 10:13:03 2005
Subject: [antlr-interest] xml grammar
Message-ID: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>

I have to cope with a pre-XML-standard so I cannot use one
of popular parsers. I am surprised I cannot find an antlr
XML grammar on the net.

I gave it a try and I've run into some problems with the
lexer as the lexer cannot distinguish between the literal
that identifies a tag name or the characters inside a tag.

 From the context of the token it should be obvious what it
is.

Here is what I've come up so far. Of course PIs, comments
and DOCTYPE declarations are still missing...

Anyone some insights on how to solve that?

--------------

header {
     package my.package;
     }

class MyParser extends Parser;

options {
	k=2;
}

parse
   :
   ( tag )+
   ;

tag
   : LT tag1:LITERAL (COLON tag2:LITERAL)? (WS)*
     (attr1:LITERAL (COLON attr2:LITERAL)? EQ value1:QLITERAL (WS)*  
{  } )*
     { System.out.println("started " + tag1 + tag2); }
     ((SLASH GT) | (GT tagbody LT SLASH LITERAL (COLON LITERAL)? GT))
     { System.out.println("end " + tag1 + tag2); }
   ;

tagbody
   : (characters)? (tag (characters)?)*
   ;

characters
   : text:CHARACTERS { System.out.println("characters[" + text + "]"); }
   ;

class MyLexer extends Lexer;

options {
	k=2;
	charVocabulary='\u0000'..'\uFFFE';
}

CHARACTERS:
   (~('<'))+
   ;

LITERAL:
   ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-')+
   ;

QLITERAL:
   '"'! (ESC | ~('\\'|'"'))* '"'!
   ;

protected
ESC:
   '\\' ('\\'|'t'|'n'|'r'|'"') ;


WS : (' '|'\t'|'\r'|'\n') ;

LT : '<' ;
GT : '>' ;
EQ : '=' ;
COLON : ':' ;
SLASH : '/' ;

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051115/0955443b/PGP.bin
From oliver.zeigermann at gmail.com  Tue Nov 15 10:51:16 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Tue Nov 15 10:51:21 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
Message-ID: <9da4f4520511151051p11c591abp@mail.gmail.com>

Hi Torsten!

You will need something like lexer modes which you can simulate using
semantic predicates. In one mode you can match text and in the other -
the tag mode - you will have all those special characters. You will
have to switch to that tag mode upon seeing the LT and switch back
upon GT.

Oliver

P.S.: There actually is an existing XML grammar in the examples that
come with ANTLR. It is a lexer only solution, though.

2005/11/15, Torsten Curdt <tcurdt@vafer.org>:
> I have to cope with a pre-XML-standard so I cannot use one
> of popular parsers. I am surprised I cannot find an antlr
> XML grammar on the net.
>
> I gave it a try and I've run into some problems with the
> lexer as the lexer cannot distinguish between the literal
> that identifies a tag name or the characters inside a tag.
>
>  From the context of the token it should be obvious what it
> is.
>
> Here is what I've come up so far. Of course PIs, comments
> and DOCTYPE declarations are still missing...
>
> Anyone some insights on how to solve that?
>
> --------------
>
> header {
>      package my.package;
>      }
>
> class MyParser extends Parser;
>
> options {
>         k=2;
> }
>
> parse
>    :
>    ( tag )+
>    ;
>
> tag
>    : LT tag1:LITERAL (COLON tag2:LITERAL)? (WS)*
>      (attr1:LITERAL (COLON attr2:LITERAL)? EQ value1:QLITERAL (WS)*
> {  } )*
>      { System.out.println("started " + tag1 + tag2); }
>      ((SLASH GT) | (GT tagbody LT SLASH LITERAL (COLON LITERAL)? GT))
>      { System.out.println("end " + tag1 + tag2); }
>    ;
>
> tagbody
>    : (characters)? (tag (characters)?)*
>    ;
>
> characters
>    : text:CHARACTERS { System.out.println("characters[" + text + "]"); }
>    ;
>
> class MyLexer extends Lexer;
>
> options {
>         k=2;
>         charVocabulary='\u0000'..'\uFFFE';
> }
>
> CHARACTERS:
>    (~('<'))+
>    ;
>
> LITERAL:
>    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-')+
>    ;
>
> QLITERAL:
>    '"'! (ESC | ~('\\'|'"'))* '"'!
>    ;
>
> protected
> ESC:
>    '\\' ('\\'|'t'|'n'|'r'|'"') ;
>
>
> WS : (' '|'\t'|'\r'|'\n') ;
>
> LT : '<' ;
> GT : '>' ;
> EQ : '=' ;
> COLON : ':' ;
> SLASH : '/' ;
>
>
>
>
From parrt at cs.usfca.edu  Tue Nov 15 10:56:05 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 15 10:56:36 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <9da4f4520511151051p11c591abp@mail.gmail.com>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
Message-ID: <6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>


On Nov 15, 2005, at 10:51 AM, Oliver Zeigermann wrote:

> Hi Torsten!
>
> You will need something like lexer modes which you can simulate using
> semantic predicates. In one mode you can match text and in the other -
> the tag mode - you will have all those special characters. You will
> have to switch to that tag mode upon seeing the LT and switch back
> upon GT.

Hi gang...actually modes are not needed.  Just call another lexer  
rule to, for example, match stuff inside the <...> versus outside.  I  
think my original HTML grammar did something like this.

Ter

From tcurdt at vafer.org  Tue Nov 15 11:06:46 2005
From: tcurdt at vafer.org (Torsten Curdt)
Date: Tue Nov 15 11:05:59 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <9da4f4520511151051p11c591abp@mail.gmail.com>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
Message-ID: <D33C4A96-4BF2-45C7-9A7B-7382BB3E235F@vafer.org>

> You will need something like lexer modes which you can simulate using
> semantic predicates. In one mode you can match text and in the other -
> the tag mode - you will have all those special characters. You will
> have to switch to that tag mode upon seeing the LT and switch back
> upon GT.

Ahhh ...came across that somewhere!

> P.S.: There actually is an existing XML grammar in the examples that
> come with ANTLR. It is a lexer only solution, though.

Will have a look. That should do it. Awesome!

Thanks a lot, Oliver!

cheers
--
Torsten

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051115/f3a11985/PGP.bin
From parrt at cs.usfca.edu  Tue Nov 15 11:13:00 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 15 11:13:31 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <dlckup$djp$2@sea.gmane.org>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules>
	<dlckup$djp$2@sea.gmane.org>
Message-ID: <594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>


On Nov 15, 2005, at 4:39 AM, Ahmed Mohombe wrote:

>>> Howdy,
>>>
>>> Added my plans for implementing template rewrites to v3:
>>>
>>> http://www.antlr.org/blog/antlr3/rewrite.tml
>> It about time you get an RSS/ATOM-enabled blog. Just pick one of  
>> the many OS
>> blogging packages.
> Yeah, AFAIK Confluence has such a support, and ANTLR had a  
> Confluence license.
> Why not using it?

For some reason that confluence is crashing my system (as is nutch).   
Both are offline until I can figure out what's up. :(

I just created an RSSTarget object for my TML translator.  Please try:

http://www.antlr.org/blog/antlr3/lexical.tml?RSS

(versus w/o the RSS parameter)

to see if that 0.91 RSS comes across ok.  My stupid mac safari  
browser no longer seems to like RSS. :(  The raw XML looks ok  
though.  Actually an RSS aggregator doesn't seem to like it though it  
likes the other RSS from the site.  Is there a size limit or  
something on RSS?

Note that for all RSS output, I've changed the content type to

application/rss+xml

Hopefully this is an improvement.

If that RSS for my "blogs" works, I'll add links.  Spending an hour  
making my blogs do RSS was much easier that wondering why confluence  
crashes my server; oh and either confluence or nutch was also making  
me run out of file descriptors too after 2 weeks.  Ugh.  I wonder why  
I write my own stuff.  It's a luxury I'll grant you of being an  
academic. ;)

Ter

From nadesai at cse.iitb.ac.in  Tue Nov 15 11:16:53 2005
From: nadesai at cse.iitb.ac.in (nadesai@cse.iitb.ac.in)
Date: Tue Nov 15 11:17:00 2005
Subject: [antlr-interest] Re: antlr-interest Digest, Vol 12, Issue 23
In-Reply-To: <20051115185124.0C194DCD0D@www.antlr.org>
References: <20051115185124.0C194DCD0D@www.antlr.org>
Message-ID: <41907.10.105.11.14.1132082213.squirrel@www.cse.iitb.ac.in>

> Send antlr-interest mailing list submissions to
> 	antlr-interest@antlr.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	http://www.antlr.org/mailman/listinfo/antlr-interest
> or, via email, send a message with subject or body 'help' to
> 	antlr-interest-request@antlr.org
>
> You can reach the person managing the list at
> 	antlr-interest-owner@antlr.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of antlr-interest digest..."
>
>
> Today's Topics:
>
>    1. Re: Treeparser inheritance? (Terence Parr)
>    2. Want to change in ANTLR code (Desai Nishitkumar Ashokkumar)
>    3. Re: Want to change in ANTLR code (Terence Parr)
>    4. java.lang.InternalError (Jeff Barnes)
>    5. added template rewrite stuff to blog (Terence Parr)
>    6. RE: added template rewrite stuff to blog (Micheal J)
>    7. Re: java.lang.InternalError (Akhilesh Mritunjai)
>    8. Re: added template rewrite stuff to blog (Ahmed Mohombe)
>    9. anybody interested in writing an ANTLR article? (Terence Parr)
>   10. xml grammar (Torsten Curdt)
>   11. Re: xml grammar (Oliver Zeigermann)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 14 Nov 2005 12:06:04 -0800
> From: Terence Parr <parrt@cs.usfca.edu>
> Subject: Re: [antlr-interest] Treeparser inheritance?
> To: ANTLR Interest <antlr-interest@antlr.org>
> Message-ID: <6EA52A2E-ECD9-45C7-B0F8-7350086B8CD9@cs.usfca.edu>
> Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
>
> Oh, sorry.  Now I remember.  Inheritance is an "include".  The
> implementation says it inherits from the tree parser, but you'll see
> all your overridden rules inside. :)
>
> Ter
> On Nov 14, 2005, at 11:49 AM, Jos Fries wrote:
>
>> Hi Terrence,
>>
>> Could you point me to an example in which a tree parser in a
>> subgrammar inherits from the tree parser in the supergrammer? I
>> searched in vain for that use of inheritance in the reference
>> manual...
>>
>> Regards,
>>
>> Jos
>>
>>
>>>
>>> On Nov 14, 2005, at 8:37 AM, Jos Fries wrote:
>>>
>>>> Hi,
>>>>
>>>> Last weekend I experimented with grammar inheritance. I
>>>> successfully extended a lexer and a parser. Extending my tree
>>>> parser however failed. My statement "class BTreeWalker extends
>>>> ATreeWalker;" is accepted by ANTLR but compiled to the Java code
>>>> "public class BTreeWalker extends antlr.TreeParser".
>>>>
>>>> Excuse the newbie character of the question, but does the
>>>> concept  of grammar inheritance also apply to tree parsers? The
>>>> documentation doesn't state anything about this. I'm using antlr
>>>> 2.7.4.
>>>
>>> Hi Jos, it should work as you describe.  Are you sure you're doing
>>> it just like in the examples?
>>>
>>> Terence
>>>
>>>
>>>
>>>
>>> --
>>> No virus found in this incoming message.
>>> Checked by AVG Free Edition.
>>> Version: 7.1.362 / Virus Database: 267.13.0/167 - Release Date:
>>> 11-11-2005
>>>
>>
>
>
>
> ------------------------------
>
> Message: 2
> Date: Tue, 15 Nov 2005 02:52:06 +0530 (IST)
> From: Desai Nishitkumar Ashokkumar <nadesai@cse.iitb.ac.in>
> Subject: [antlr-interest] Want to change in ANTLR code
> To: antlr-interest@antlr.org
> Message-ID: <Pine.LNX.4.61.0511150248400.22878@nsl-14.cse.iitb.ac.in>
> Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
>
>
> Hi,
>      Suppose I have changed ANTLR file TokenBuffer.java. Now, how can I
> incorporate this new java file ?? means I want to use this new class file.
> AT which places I have to make changes ??
>
> thanks in advance.
>
>
> --
> Nishit Desai
> M.Tech II year
> Computer Science & Engg.
> IIT Bombay
>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 14 Nov 2005 13:30:34 -0800
> From: Terence Parr <parrt@cs.usfca.edu>
> Subject: Re: [antlr-interest] Want to change in ANTLR code
> To: ANTLR Interest <antlr-interest@antlr.org>
> Message-ID: <648CFE55-221F-47ED-8C39-B9524CEEB831@cs.usfca.edu>
> Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
>
>
> On Nov 14, 2005, at 1:22 PM, Desai Nishitkumar Ashokkumar wrote:
>
>>
>> Hi,
>>     Suppose I have changed ANTLR file TokenBuffer.java.
>
> Just put the modified TokenBuffer.class file first in your CLASSPATH
> environment variable and then it will use your version not the
> default in antlr :)
>
  Thanks sir, I have made new antlr.jar with TokenBuffer.class file and
its working.
  I want to give to antlr a new token when some mismatched token comes and
error/exception is generated. and also want to start parsing from
previous point with this new given  token.

Can u plz tell me where/which places I have to make changes. I m trying
since 2 days.

Thanks
> Terence
>
>
> ------------------------------
>
> Message: 4
> Date: Mon, 14 Nov 2005 16:11:33 -0800 (PST)
> From: Jeff Barnes <jbarnesweb@yahoo.com>
> Subject: [antlr-interest] java.lang.InternalError
> To: antlr-interest@antlr.org
> Message-ID: <20051115001133.55244.qmail@web54509.mail.yahoo.com>
> Content-Type: text/plain; charset=iso-8859-1
>
> When trying to debug the generated lexer in either
> Eclipse or NetBeans, "java.lang.InternalError: name is
> too long to represent" is thrown. It is thrown when I
> try to instantiate my lexer with the InputStream
> argument. The fully-qualified name is 34 characters
> long.
>
> Is this a known issue and is there a workaround?
>
> Regards,
> Jeff Barnes
>
>
> ------------------------------
>
> Message: 5
> Date: Mon, 14 Nov 2005 20:31:50 -0800
> From: Terence Parr <parrt@cs.usfca.edu>
> Subject: [antlr-interest] added template rewrite stuff to blog
> To: ANTLR Interest <antlr-interest@antlr.org>
> Cc: stringtemplate-interest@antlr.org
> Message-ID: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
> Content-Type: text/plain; charset=US-ASCII; format=flowed
>
> Howdy,
>
> Added my plans for implementing template rewrites to v3:
>
> http://www.antlr.org/blog/antlr3/rewrite.tml
>
> Ter
>
>
> ------------------------------
>
> Message: 6
> Date: Tue, 15 Nov 2005 08:37:42 -0000
> From: "Micheal J" <open.zone@virgin.net>
> Subject: RE: [antlr-interest] added template rewrite stuff to blog
> To: "'ANTLR Interest'" <antlr-interest@antlr.org>
> Cc: stringtemplate-interest@antlr.org
> Message-ID: <006c01c5e9bf$d968da40$6802a8c0@hercules>
> Content-Type: text/plain;	charset="US-ASCII"
>
>> Howdy,
>>
>> Added my plans for implementing template rewrites to v3:
>>
>> http://www.antlr.org/blog/antlr3/rewrite.tml
>
> It about time you get an RSS/ATOM-enabled blog. Just pick one of the many
> OS
> blogging packages.
>
> Micheal
>
>
>
> ------------------------------
>
> Message: 7
> Date: Tue, 15 Nov 2005 01:45:33 -0800 (PST)
> From: Akhilesh Mritunjai <virtualaspirin@yahoo.com>
> Subject: Re: [antlr-interest] java.lang.InternalError
> To: Jeff Barnes <jbarnesweb@yahoo.com>, antlr-interest@antlr.org
> Message-ID: <20051115094533.82295.qmail@web30803.mail.mud.yahoo.com>
> Content-Type: text/plain; charset=iso-8859-1
>
> Hi
>
> We are facing the same problem. The funny thing is
> that only me in my team is having this problem. I'm
> using Sun JDK/JRE 1.5 (Patchset 4) with eclipse 3.1.1
> on Windows XP. This problem was intermittent (eg it
> went temporarily when changing from 3.1 to 3.1.1), but
> again appeared.
>
> This problem does not occur when I use JRockit JRE 1.5
> for debugging! So I reckon its some specific issue
> pertaining to combination of number of above
> components.
>
> My teammates on Linux using Sun JRE 1.5_4 for Linux
> don't face this problem (may be yet!) with eclipse 3.1
>
> Google doesn't help much with this issue.
>
> - Akhilesh
>
> --- Jeff Barnes <jbarnesweb@yahoo.com> wrote:
>
>> When trying to debug the generated lexer in either
>> Eclipse or NetBeans, "java.lang.InternalError: name
>> is
>> too long to represent" is thrown. It is thrown when
>> I
>> try to instantiate my lexer with the InputStream
>> argument. The fully-qualified name is 34 characters
>> long.
>>
>> Is this a known issue and is there a workaround?
>>
>> Regards,
>> Jeff Barnes
>>
>
>
>
>
>
> __________________________________
> Yahoo! Mail - PC Magazine Editors' Choice 2005
> http://mail.yahoo.com
>
>
> ------------------------------
>
> Message: 8
> Date: Tue, 15 Nov 2005 13:39:52 +0100
> From: Ahmed Mohombe <amohombe@yahoo.com>
> Subject: [antlr-interest] Re: added template rewrite stuff to blog
> To: antlr-interest@antlr.org
> Message-ID: <dlckup$djp$2@sea.gmane.org>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
>>>Howdy,
>>>
>>>Added my plans for implementing template rewrites to v3:
>>>
>>>http://www.antlr.org/blog/antlr3/rewrite.tml
>>
>>
>> It about time you get an RSS/ATOM-enabled blog. Just pick one of the
>> many OS
>> blogging packages.
> Yeah, AFAIK Confluence has such a support, and ANTLR had a Confluence
> license.
> Why not using it?
>
> Ahmed.
>
>
>
> ------------------------------
>
> Message: 9
> Date: Tue, 15 Nov 2005 09:38:36 -0800
> From: Terence Parr <parrt@cs.usfca.edu>
> Subject: [antlr-interest] anybody interested in writing an ANTLR
> 	article?
> To: ANTLR Interest <antlr-interest@antlr.org>
> Message-ID: <48712844-6784-416D-9491-9FE060316647@cs.usfca.edu>
> Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
>
> Hi, the following tech magazine is interested in having someone do an
> article on using ANTLR:
>
>> Olga krawczyk
>> Software-Wydawnictwo Sp z o.o.
>> Product Manager
>> olga.krawczyk at software.com.pl
>> www.software.com.pl/en
>
>> we are a Polish Publishing House Software-Wydawnictwo. We publish
>> several titles in 7 different languages. we would like to propose
>> you to
>> write an article for us (the article would be published in 2
>> magazines :
>> Software Developer's Journal and SDJ Extra! and distributed in France,
>> Spain, Germany, Austria, Belgium, Switzerland and Poland).
>
> Could be interesting for someone, particular a European looking for
> good exposure :)  Please respond directly to Olga for more information.
>
> Regards,
> Terence
>
>
> ------------------------------
>
> Message: 10
> Date: Tue, 15 Nov 2005 19:13:57 +0100
> From: Torsten Curdt <tcurdt@vafer.org>
> Subject: [antlr-interest] xml grammar
> To: antlr-interest@antlr.org
> Message-ID: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
> Content-Type: text/plain; charset="us-ascii"
>
> I have to cope with a pre-XML-standard so I cannot use one
> of popular parsers. I am surprised I cannot find an antlr
> XML grammar on the net.
>
> I gave it a try and I've run into some problems with the
> lexer as the lexer cannot distinguish between the literal
> that identifies a tag name or the characters inside a tag.
>
>  From the context of the token it should be obvious what it
> is.
>
> Here is what I've come up so far. Of course PIs, comments
> and DOCTYPE declarations are still missing...
>
> Anyone some insights on how to solve that?
>
> --------------
>
> header {
>      package my.package;
>      }
>
> class MyParser extends Parser;
>
> options {
> 	k=2;
> }
>
> parse
>    :
>    ( tag )+
>    ;
>
> tag
>    : LT tag1:LITERAL (COLON tag2:LITERAL)? (WS)*
>      (attr1:LITERAL (COLON attr2:LITERAL)? EQ value1:QLITERAL (WS)*
> {  } )*
>      { System.out.println("started " + tag1 + tag2); }
>      ((SLASH GT) | (GT tagbody LT SLASH LITERAL (COLON LITERAL)? GT))
>      { System.out.println("end " + tag1 + tag2); }
>    ;
>
> tagbody
>    : (characters)? (tag (characters)?)*
>    ;
>
> characters
>    : text:CHARACTERS { System.out.println("characters[" + text + "]"); }
>    ;
>
> class MyLexer extends Lexer;
>
> options {
> 	k=2;
> 	charVocabulary='\u0000'..'\uFFFE';
> }
>
> CHARACTERS:
>    (~('<'))+
>    ;
>
> LITERAL:
>    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-')+
>    ;
>
> QLITERAL:
>    '"'! (ESC | ~('\\'|'"'))* '"'!
>    ;
>
> protected
> ESC:
>    '\\' ('\\'|'t'|'n'|'r'|'"') ;
>
>
> WS : (' '|'\t'|'\r'|'\n') ;
>
> LT : '<' ;
> GT : '>' ;
> EQ : '=' ;
> COLON : ':' ;
> SLASH : '/' ;
>
> -------------- next part --------------
> A non-text attachment was scrubbed...
> Name: PGP.sig
> Type: application/pgp-signature
> Size: 186 bytes
> Desc: This is a digitally signed message part
> Url :
> http://www.antlr.org/pipermail/antlr-interest/attachments/20051115/0955443b/PGP-0001.bin
>
> ------------------------------
>
> Message: 11
> Date: Tue, 15 Nov 2005 19:51:16 +0100
> From: Oliver Zeigermann <oliver.zeigermann@gmail.com>
> Subject: Re: [antlr-interest] xml grammar
> To: Torsten Curdt <tcurdt@vafer.org>
> Cc: antlr-interest@antlr.org
> Message-ID: <9da4f4520511151051p11c591abp@mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Hi Torsten!
>
> You will need something like lexer modes which you can simulate using
> semantic predicates. In one mode you can match text and in the other -
> the tag mode - you will have all those special characters. You will
> have to switch to that tag mode upon seeing the LT and switch back
> upon GT.
>
> Oliver
>
> P.S.: There actually is an existing XML grammar in the examples that
> come with ANTLR. It is a lexer only solution, though.
>
> 2005/11/15, Torsten Curdt <tcurdt@vafer.org>:
>> I have to cope with a pre-XML-standard so I cannot use one
>> of popular parsers. I am surprised I cannot find an antlr
>> XML grammar on the net.
>>
>> I gave it a try and I've run into some problems with the
>> lexer as the lexer cannot distinguish between the literal
>> that identifies a tag name or the characters inside a tag.
>>
>>  From the context of the token it should be obvious what it
>> is.
>>
>> Here is what I've come up so far. Of course PIs, comments
>> and DOCTYPE declarations are still missing...
>>
>> Anyone some insights on how to solve that?
>>
>> --------------
>>
>> header {
>>      package my.package;
>>      }
>>
>> class MyParser extends Parser;
>>
>> options {
>>         k=2;
>> }
>>
>> parse
>>    :
>>    ( tag )+
>>    ;
>>
>> tag
>>    : LT tag1:LITERAL (COLON tag2:LITERAL)? (WS)*
>>      (attr1:LITERAL (COLON attr2:LITERAL)? EQ value1:QLITERAL (WS)*
>> {  } )*
>>      { System.out.println("started " + tag1 + tag2); }
>>      ((SLASH GT) | (GT tagbody LT SLASH LITERAL (COLON LITERAL)? GT))
>>      { System.out.println("end " + tag1 + tag2); }
>>    ;
>>
>> tagbody
>>    : (characters)? (tag (characters)?)*
>>    ;
>>
>> characters
>>    : text:CHARACTERS { System.out.println("characters[" + text + "]"); }
>>    ;
>>
>> class MyLexer extends Lexer;
>>
>> options {
>>         k=2;
>>         charVocabulary='\u0000'..'\uFFFE';
>> }
>>
>> CHARACTERS:
>>    (~('<'))+
>>    ;
>>
>> LITERAL:
>>    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-')+
>>    ;
>>
>> QLITERAL:
>>    '"'! (ESC | ~('\\'|'"'))* '"'!
>>    ;
>>
>> protected
>> ESC:
>>    '\\' ('\\'|'t'|'n'|'r'|'"') ;
>>
>>
>> WS : (' '|'\t'|'\r'|'\n') ;
>>
>> LT : '<' ;
>> GT : '>' ;
>> EQ : '=' ;
>> COLON : ':' ;
>> SLASH : '/' ;
>>
>>
>>
>>
>
>
> ------------------------------
>
> _______________________________________________
> antlr-interest mailing list
> antlr-interest@antlr.org
> http://www.antlr.org/mailman/listinfo/antlr-interest
>
>
> End of antlr-interest Digest, Vol 12, Issue 23
> **********************************************
>

From tcurdt at vafer.org  Tue Nov 15 11:18:33 2005
From: tcurdt at vafer.org (Torsten Curdt)
Date: Tue Nov 15 11:17:39 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
	<6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
Message-ID: <BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>

>> You will need something like lexer modes which you can simulate using
>> semantic predicates. In one mode you can match text and in the  
>> other -
>> the tag mode - you will have all those special characters. You will
>> have to switch to that tag mode upon seeing the LT and switch back
>> upon GT.
>
> Hi gang...actually modes are not needed.

> Just call another lexer rule to, for example, match stuff inside  
> the <...> versus outside.
> I think my original HTML grammar did something like this.

I hope I can get away with the provided XML grammar ...but just out
of curiosity - could you explain that a bit ...or give an example? :)

cheers
--
Torsten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051115/7bd0ab77/PGP.bin
From parrt at cs.usfca.edu  Tue Nov 15 11:24:24 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 15 11:24:55 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
	<6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
	<BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>
Message-ID: <20CD5538-F523-40C1-9144-B812E8281B9F@cs.usfca.edu>


On Nov 15, 2005, at 11:18 AM, Torsten Curdt wrote:
> I hope I can get away with the provided XML grammar ...but just out
> of curiosity - could you explain that a bit ...or give an example? :)

Sure.  From my html.g file:

OTABLE	
	:	"<table" (WS (ATTR)*)? '>'
	;

protected
ATTR
options {
ignore=WS;
}
	:	WORD ('=' (WORD ('%')? | ('-')? INT | STRING | HEXNUM))?
	;


I.e., call a lexer rule.  Modal programming is usually considered  
poor form ;)  That OTABLE rule is asking for multiple ATTR  
assignments for that tag.  It's a nested structure :)

This ability is unique to context-free lexers such as the scannerless  
LR style parsers and ANTLR LL lexers. :)  Lex modes exist to make up  
for the weakness of not being able to call another lexer rule.  In a  
parser, are you going to switch modes to match the formal arguments  
of a method definition?  Nope.  Same in the lexer for HTML tag  
arguments. :)

Ter
From mail at martin-probst.com  Tue Nov 15 14:50:20 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 15 14:50:25 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules> <dlckup$djp$2@sea.gmane.org>
	<594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
Message-ID: <1132095020.26394.7.camel@localhost.localdomain>

Hi,

> I just created an RSSTarget object for my TML translator.  Please try:
> 
> http://www.antlr.org/blog/antlr3/lexical.tml?RSS
> 
> (versus w/o the RSS parameter)
> 
> to see if that 0.91 RSS comes across ok.  My stupid mac safari  
> browser no longer seems to like RSS. :(  The raw XML looks ok  
> though.  Actually an RSS aggregator doesn't seem to like it though it  
> likes the other RSS from the site.  Is there a size limit or  
> something on RSS?

Did you try Sam Ruby's feed validator? See
> http://feedvalidator.org/check.cgi?url=http%3A%2F%2Fwww.antlr.org%
2Fblog%2Fantlr3%2Flexical.tml%3FRSS

RSS is actually quite annoying about the content of the <description/>
element, afaik it should be escaped (X)HTML, e.g. HTML in which all <
are escaped to &lt; and & to &amp;, or just dump the contents into a
CDATA section. Most feed readers will support directly written HTML, but
your feed is currently not even a valid XML document - see the validator
output for more info on that. XML tends to look easy, but producing
correct output is sometimes surprisingly difficult. See 
> http://hsivonen.iki.fi/producing-xml/
on that.

> Note that for all RSS output, I've changed the content type to
> 
> application/rss+xml
> 
> Hopefully this is an improvement.

That's certainly correct.

> If that RSS for my "blogs" works, I'll add links.  Spending an hour  
> making my blogs do RSS was much easier that wondering why confluence  
> crashes my server; 

Well, they kind of don't, though they are very close. There are very
valid reasons to rely on third party tools rather then doing it
yourself ;-)

Anyways, I look forward to see a nice ANTLR/Terence feed, so rock on.

Martin

From mail at martin-probst.com  Tue Nov 15 15:34:53 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 15 15:35:02 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <20CD5538-F523-40C1-9144-B812E8281B9F@cs.usfca.edu>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
	<6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
	<BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>
	<20CD5538-F523-40C1-9144-B812E8281B9F@cs.usfca.edu>
Message-ID: <1132097693.26394.17.camel@localhost.localdomain>

Hi,

> Sure.  From my html.g file:
> 
> OTABLE	
> 	:	"<table" (WS (ATTR)*)? '>'
> 	;

But that's a parser for a particular XML application, e.g. it returns
OTABLE as a token, and not QNAME vs. ELEMENT_CONTENT. If you want a
generic XML parser, you'll run into that problem, as "foo" is a valid
QNAME after a "<" or as an attribute name, but also valid
ELEMENT_CONTENT in other places.

Are there any plans on enhancing ANTLR Lexers by providing support for
stateful lexers? I'm aware that it's doable using semantic predicates,
but that's quite cumbersome. It could be really easy, e.g.

state DEFAULT:
  ELEMENT_START -> ELEMENT_STATE:
    '<';
state ELEMENT_STATE:
  QNAME -> ATTR_LIST_STATE:
    ...;

and so on. I guess it would be not so much work to implement that in
ANTLR, and it would be a really big improvement for people that have to
implement stateful lexers. Do you have any ideas on this? I would be
interested in doing that, but I certainly won't have time until April
next year ...

Martin

From pgonzalez at bluel.com  Tue Nov 15 16:24:32 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Tue Nov 15 16:24:38 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <1129651947.28074@mx9.mysite4now.com>
References: <1129651947.28074@mx9.mysite4now.com>
Message-ID: <437A7C40.2040402@bluel.com>

Don Caton wrote:
> Putting if's throughout the code isn't going to slow anything down, you're
> talking about a handful of cpu instructions.  Contrast that to throwing a
> single exception that requires thousands of instructions to execute, then
> multiply that by the number of exceptions thrown in any non-trivial grammar.

I recently joined the mailing list, and I'd like to add a couple comments 
to last month's debate about unexceptional exceptions, since this issue has 
been an ongoing headache for my team using C# Antlr.

First, exceptions are slooooow in C#.  I am working on a real-world project 
that parses a text file containing relatively simple field/value pairs. 
We're using the lexer from Robin Debreuil's C# grammar example, which I 
assume is reasonably well designed.  On my 2.4Ghz Pentium PC, the input 
file (which is only 8671 lines / 228969 bytes) takes 840 ms to parse. 
This is pretty damn slow by yacc standards, but certainly usable.  However, 
when running in the debugger, I was shocked to find that the same parser 
takes 55.062 seconds, which is totally unacceptable, especially when you 
consider that the application will eventually have to parse thousands of 
files, not just a measly 8000 lines.  Why so slow?  Exceptions.

If you are a Java person applying Java thinking to C#, you'll probably say 
"well the C# compiler is broken -- those performance issues are a Microsoft 
flaw, not an Antlr problem."  I disagree.  In my experience, C# libraries 
simply don't throw hundreds of exceptions per second, and most exceptions 
correspond to real errors that end up being displayed in the GUI.  Since 
the Antlr web site very clearly advertises support for C#, I think this 
should warrant at least a gesture at compliance with the conventions for 
this platform.  In case there's any doubt, here's an unambiguous excerpt 
from a Microsoft "Best Practices" document:

http://tinyurl.com/aqzzh
 > Exceptions Are For Exceptional Circumstances
 >
 > Do not throw exceptions as a means of communicating between
 > components -- use events for that. Exceptions should not be
 > thrown in cases where completely expected results occur. For
 > example, a component that reads text files should not throw an
 > exception when it reaches the end of the file. This is a case
 > where an event would be appropriate. By limiting throwing
 > exceptions to exceptional cases, you will help developers to
 > debug their application rapidly by not having to wade through
 > numerous 'expected' exceptions.

This brings us to my second point:  trying to debug a application with 
Antlr calls.  In C#, NORMALLY in I would just set my debugger to break 
whenever an exception is thrown, and then hit F5 a few times until I reach 
the bug.  With Antlr, this is no longer possible.  Instead I have to turn 
off exception trapping, set a breakpoint somewhere near the problem but 
after the parser has finished, run to the breakpoint, then then re-enable 
exception trapping to catch the "real" error.  If Antlr is being called in 
a loop, this often requires hacking the code to add some kind of counter or 
if/then test around the breakpoint.  This is what Microsoft means when they 
say "wade through numerous expected exceptions", and it is a real headache.


In conclusion:  With regards to Java, we've discussed three possible 
choices (exceptions, no exceptions, or supporting both), and there have 
been good arguments in favor of each choice.  But for the C# version, I 
don't see how there can be any debate at all.

Cheers,
-Pete

NOTE: I use a spam filter, so if you e-mail me directly please put "antlr" 
in your subject line.  Thanks!

From kroepke at dolphin-services.de  Tue Nov 15 17:24:51 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Tue Nov 15 17:25:00 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules>
	<dlckup$djp$2@sea.gmane.org>
	<594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
Message-ID: <465A0DD0-6972-4C2B-8D20-33229520D039@dolphin-services.de>


On 15. Nov 2005, at 20:13 Uhr, Terence Parr wrote:

>  Actually an RSS aggregator doesn't seem to like it though it likes  
> the other RSS from the site.

FYI, NetNewsWire seems to have no problem with that feed, so it  
should be alright...

- kay

From parrt at cs.usfca.edu  Tue Nov 15 17:39:17 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 15 17:39:49 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <1132095020.26394.7.camel@localhost.localdomain>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules>
	<dlckup$djp$2@sea.gmane.org>
	<594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
	<1132095020.26394.7.camel@localhost.localdomain>
Message-ID: <742A5EF5-EF49-4AD8-8424-3852B031C2EF@cs.usfca.edu>


On Nov 15, 2005, at 2:50 PM, Martin Probst wrote:
>
> Did you try Sam Ruby's feed validator? See
>> http://feedvalidator.org/check.cgi?url=http%3A%2F%2Fwww.antlr.org%
> 2Fblog%2Fantlr3%2Flexical.tml%3FRSS

Very useful, thanks!

> RSS is actually quite annoying about the content of the <description/>
> element, afaik it should be escaped (X)HTML, e.g. HTML in which all <
> are escaped to &lt; and & to &amp;, or just dump the contents into a
> CDATA section.

That was the trick.  CDATA.

>> If that RSS for my "blogs" works, I'll add links.  Spending an hour
>> making my blogs do RSS was much easier that wondering why confluence
>> crashes my server;
>
> Well, they kind of don't, though they are very close. There are very
> valid reasons to rely on third party tools rather then doing it
> yourself ;-)

Ok, another hour and they work:

http://www.antlr.org/blog/antlr3/lookahead.tml

has a nice little "RSS Feed" link and it works.  Heh heh heh :)

> Anyways, I look forward to see a nice ANTLR/Terence feed, so rock on.

The RSS is crappy in terms of 0.91 RSS, but it's working.  My Safari  
browser does a great job of showing it.

Hooooray!

Ter
From stephen at covidimus.net  Tue Nov 15 17:56:55 2005
From: stephen at covidimus.net (Stephen Quattlebaum)
Date: Tue Nov 15 17:57:08 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <437A7C40.2040402@bluel.com>
Message-ID: <4enk8j$d0nb71@mxip30a.cluster1.charter.net>

> This brings us to my second point:  trying to debug a application with 
> Antlr calls.  In C#, NORMALLY in I would just set my debugger to break 
> whenever an exception is thrown, and then hit F5 a few times until I reach

> the bug.  With Antlr, this is no longer possible.  Instead I have to turn 
> off exception trapping, set a breakpoint somewhere near the problem but 
> after the parser has finished, run to the breakpoint, then then re-enable 
> exception trapping to catch the "real" error.  If Antlr is being called in

> a loop, this often requires hacking the code to add some kind of counter
> or if/then test around the breakpoint.  This is what Microsoft means when
> they  say "wade through numerous expected exceptions", and it is a real
> headache.

I would like to second this!  I've spent the last three years dreading
debugging one of my projects that uses an ANTLR-generated-C# to parse
expressions at runtime, b/c the generated code uses exceptions to report
internal, expected conditions, so it results in a lot of "noise" if I turn
on "break on all exceptions", which I like to keep on b/c it helps me find
errors quickly.

- Stephen

From scott at javadude.com  Tue Nov 15 20:26:25 2005
From: scott at javadude.com (Scott Stanchfield)
Date: Tue Nov 15 20:26:58 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
Message-ID: <200511160419.jAG4JQNU012718@s2.eroute.net>

Hey!

I'd recommend taking a peek at ANTXR, my ANTLR offshoot for XML parsing.
You'd want to look at the provided scanner for XMLPull as a starting point.

http://javadude.com/tools/antxr

The front-end uses SAX or XMLPull under the covers, but could easily take
whatever scanner you want to use to create the tokens.

This could be very helpful on the parsing end, but you're still on your own
for the scanning...

LMK if this helps...
-- Scott 

> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Torsten Curdt
> Sent: Tuesday, November 15, 2005 1:14 PM
> To: antlr-interest@antlr.org
> Subject: [antlr-interest] xml grammar
> 
> I have to cope with a pre-XML-standard so I cannot use one of 
> popular parsers. I am surprised I cannot find an antlr XML 
> grammar on the net.
> 
> I gave it a try and I've run into some problems with the 
> lexer as the lexer cannot distinguish between the literal 
> that identifies a tag name or the characters inside a tag.
> 
>  From the context of the token it should be obvious what it is.
> 
> Here is what I've come up so far. Of course PIs, comments and 
> DOCTYPE declarations are still missing...
> 
> Anyone some insights on how to solve that?
> 
> --------------
> 
> header {
>      package my.package;
>      }
> 
> class MyParser extends Parser;
> 
> options {
> 	k=2;
> }
> 
> parse
>    :
>    ( tag )+
>    ;
> 
> tag
>    : LT tag1:LITERAL (COLON tag2:LITERAL)? (WS)*
>      (attr1:LITERAL (COLON attr2:LITERAL)? EQ value1:QLITERAL 
> (WS)* {  } )*
>      { System.out.println("started " + tag1 + tag2); }
>      ((SLASH GT) | (GT tagbody LT SLASH LITERAL (COLON LITERAL)? GT))
>      { System.out.println("end " + tag1 + tag2); }
>    ;
> 
> tagbody
>    : (characters)? (tag (characters)?)*
>    ;
> 
> characters
>    : text:CHARACTERS { System.out.println("characters[" + 
> text + "]"); }
>    ;
> 
> class MyLexer extends Lexer;
> 
> options {
> 	k=2;
> 	charVocabulary='\u0000'..'\uFFFE';
> }
> 
> CHARACTERS:
>    (~('<'))+
>    ;
> 
> LITERAL:
>    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-')+
>    ;
> 
> QLITERAL:
>    '"'! (ESC | ~('\\'|'"'))* '"'!
>    ;
> 
> protected
> ESC:
>    '\\' ('\\'|'t'|'n'|'r'|'"') ;
> 
> 
> WS : (' '|'\t'|'\r'|'\n') ;
> 
> LT : '<' ;
> GT : '>' ;
> EQ : '=' ;
> COLON : ':' ;
> SLASH : '/' ;
> 
> 


From me at sebastienboving.com  Tue Nov 15 22:49:10 2005
From: me at sebastienboving.com (Sebastien Boving)
Date: Tue Nov 15 22:49:13 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
Message-ID: <3dcf0a2a0511152249j2c362042hd8300f82d28deab6@mail.gmail.com>

I searched the mailing list but noone seems to have asked for this so far,
yet i'm a newbie so it must be a stupid proposal... Basically i can't find
why, next to the unexpected token, NoViableAltException doesn't record what
it tried to match against (such as MismatchedTokenException.expecting does)?
This looks like it would be useful information to include for error
reporting or auto-completion features. Or are there other, better ways of
investigating the parser's state at the time of a RecognitionException?

thanks,
-seb.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051115/6f101e80/attachment.html
From geiroves at online.no  Wed Nov 16 00:53:03 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Wed Nov 16 00:53:18 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
In-Reply-To: <3dcf0a2a0511152249j2c362042hd8300f82d28deab6@mail.gmail.com>
Message-ID: <000d01c5ea8b$28c574b0$0100a8c0@rexii>

Hello,
 
Not a stupid question at all. I think it is just a ANTLR 2.x weakness
that we can just hope will get rectified in an 2.x upgrade. I sure miss
a more sensible exception in that case as well.
 
 
Geir Ove

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Sebastien Boving
Sent: 16. november 2005 07:49
To: antlr-interest@antlr.org
Subject: [antlr-interest] NoViableAltException.expecting ?



I searched the mailing list but noone seems to have asked for this so
far, yet i'm a newbie so it must be a stupid proposal... Basically i
can't find why, next to the unexpected token, NoViableAltException
doesn't record what it tried to match against (such as
MismatchedTokenException.expecting does)?  This looks like it would be
useful information to include for error reporting or auto-completion
features.  Or are there other, better ways of investigating the parser's
state at the time of a RecognitionException?

thanks,
-seb.









-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051116/362ff448/attachment-0001.html
From mail at martin-probst.com  Wed Nov 16 01:29:58 2005
From: mail at martin-probst.com (Martin Probst)
Date: Wed Nov 16 01:30:04 2005
Subject: [antlr-interest] Re: added template rewrite stuff to blog
In-Reply-To: <465A0DD0-6972-4C2B-8D20-33229520D039@dolphin-services.de>
References: <0E0160E2-21F1-4550-B65D-0FB8E0CBAEF7@cs.usfca.edu>
	<006c01c5e9bf$d968da40$6802a8c0@hercules> <dlckup$djp$2@sea.gmane.org>
	<594193E2-5190-48F1-ADF4-8556B00FEDDD@cs.usfca.edu>
	<465A0DD0-6972-4C2B-8D20-33229520D039@dolphin-services.de>
Message-ID: <1132133398.8395.5.camel@localhost.localdomain>

Hi,

> FYI, NetNewsWire seems to have no problem with that feed, so it  
> should be alright...

That does only mean that the (liberal) parser of NNW can handle it. I
think we should be careful with RSS, otherwise we end up where HTML
went. It should at least be valid XML.

Martin

From ewbank at gmail.com  Wed Nov 16 02:21:21 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Wed Nov 16 02:21:23 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <200511160419.jAG4JQNU012718@s2.eroute.net>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<200511160419.jAG4JQNU012718@s2.eroute.net>
Message-ID: <dd3a065f0511160221k422efbcdp83326a122c261c7@mail.gmail.com>

Perhaps I'm over-simplifying, but in XML isn't it easier to reverse
your thought processes, so that everything from ">" to "<" is slurped
as data, very much like a classic text string?

It would seem that the content (as opposed to the XML-isms) are simply
raw goo that you don't want to process in any case - so treat it as
something that is opaque.
From thn-d at gmx.de  Wed Nov 16 05:40:38 2005
From: thn-d at gmx.de (Thomas N.)
Date: Wed Nov 16 05:40:43 2005
Subject: [antlr-interest] Lexer rule SL_COMMENT (any java grammar)
Message-ID: <8490.1132148438@www90.gmx.net>

Hi,

the lexer rule (found in any java grammar)

SL_COMMENT
    :    "//"
        (~('\n'|'\r'))* ('\n'|'\r'('\n')?)
        { $setType(Token.SKIP); newline(); }
    ;

loops if the single line comment is at the end of the .java file and does
not end with a newline. Unfortunately, the java compiler allows such
comments. How can this bug be fixed (by consifering EOF)?

Regards,
Thomas N.

-- 
10 GB Mailbox, 100 FreeSMS/Monat http://www.gmx.net/de/go/topmail
+++ GMX - die erste Adresse fr Mail, Message, More +++
From mail at martin-probst.com  Wed Nov 16 06:56:12 2005
From: mail at martin-probst.com (Martin Probst)
Date: Wed Nov 16 06:56:20 2005
Subject: [antlr-interest] Bug with tree construction
Message-ID: <1132152972.8395.17.camel@localhost.localdomain>

Hi,
I have the following code in a grammar file:

varDefn:
  kd:Kdefine_variable^ q:bindVar! (td:typeDeclaration!)?
  { ... }
  ( COLON_EQUALS! expr
  | ext:Kexternal 
      { ... }
  )

Which produces the following code directly after the code inserted for
the first { ... } block:

currentAST.root = varDefn_AST;
currentAST.child = varDefn_AST!=null &&
                   varDefn_AST.getFirstChild()!=null 
                   ? varDefn_AST.getFirstChild() : varDefn_AST;
currentAST.advanceChildToEnd(); // <- not important

This creates a currentAST AST Pair that has a root of varDefn_AST and a
child of varDefn_AST. When afterwards "expr" matches something,
automatic AST creation tries to add that to the currentAST tree by:

match(COLON_EQUALS);
expr();
astFactory.addASTChild(currentAST, returnAST);

Which in turn by default adds the returnAST as a sibling to the
currentAST.child AST, if present. This is not what I would expect, as
Kdefine_variable is supposed to be the root of the result ("^").

Is this a known bug for Version 2.7.5 (20050128)? Do you need more to
reproduce the error?

Martin

From henryb at ntlworld.com  Wed Nov 16 07:44:51 2005
From: henryb at ntlworld.com (Henry Butowsky)
Date: Wed Nov 16 07:15:09 2005
Subject: [antlr-interest] unary Operators
Message-ID: <437B53F3.2030306@ntlworld.com>

Hi Guys,
    Im using a C like grammer and am having trouble getting unary 
operators to work

I have in the parser

unary_exp
	:primary_exp
	| (LNOT^ | MINUS^ |PLUS^) primary_exp
          ;
	
It works  OK with a single unary operator eg   !10 or -2.4
But put them together and nogo e.g !!20 or -!0

Regards Henry

From jhvdven at xs4all.nl  Wed Nov 16 07:25:38 2005
From: jhvdven at xs4all.nl (Jan H. van der Ven)
Date: Wed Nov 16 07:25:41 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
Message-ID: <21835.82.92.2.221.1132154738.squirrel@webmail.xs4all.nl>

Hi,


I am currently working on a SQL parser (we want to support all databases,
but I am taking baby steps). I used the MS SQL select statement from
Tomasz Jastrzebski that can be downloaded from antlr.org. It checks my
statements ok, but that is not the only result I am looking for.

What I want is that after the parsing the tokens contain extra information
about their syntactic nature. For instance, the parser will find out that
a certain 'identifier' is actually a column and I would like that
knowledge to become part of the token or the AST.

I am new to all of this, so if this is something you guys do all day
please let me know.

If it is not, could you point me in the right direction.


Kind regards,


Jan van der Ven

From demakov at ispras.ru  Wed Nov 16 07:31:52 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Wed Nov 16 07:32:17 2005
Subject: [antlr-interest] Lexer rule SL_COMMENT (any java grammar)
References: <8490.1132148438@www90.gmx.net>
Message-ID: <009401c5eac2$de8acac0$8cc79553@marlboro>

Hi,

I use the following rule for single line comments:

SL_COMMENT : "//"
             ( ~( '\n' | '\r' ) )*
             /*
              * single line comment may not
              * be followed by new line
              * at the end of file
              */
             ( NL )?
           ;

NL : (   {LA(2) == '\n'}? '\r' '\n'
       | '\r'
       | '\n'
     )
     { newline(); }
   ;

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: "Thomas N." <thn-d@gmx.de>
To: <antlr-interest@antlr.org>
Sent: Wednesday, November 16, 2005 4:40 PM
Subject: [antlr-interest] Lexer rule SL_COMMENT (any java grammar)


> Hi,
>
> the lexer rule (found in any java grammar)
>
> SL_COMMENT
>     :    "//"
>         (~('\n'|'\r'))* ('\n'|'\r'('\n')?)
>         { $setType(Token.SKIP); newline(); }
>     ;
>
> loops if the single line comment is at the end of the .java file and does
> not end with a newline. Unfortunately, the java compiler allows such
> comments. How can this bug be fixed (by consifering EOF)?
>
> Regards,
> Thomas N.
>
> -- 
> 10 GB Mailbox, 100 FreeSMS/Monat http://www.gmx.net/de/go/topmail
> +++ GMX - die erste Adresse f?r Mail, Message, More +++
>


From demakov at ispras.ru  Wed Nov 16 07:32:35 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Wed Nov 16 07:32:57 2005
Subject: [antlr-interest] unary Operators
References: <437B53F3.2030306@ntlworld.com>
Message-ID: <009c01c5eac2$f92677d0$8cc79553@marlboro>

> unary_exp
> :primary_exp
> | (LNOT^ | MINUS^ |PLUS^) primary_exp
>           ;

----- Original Message ----- 
From: "Henry Butowsky" <henryb@ntlworld.com>
To: <antlr-interest@antlr.org>
Sent: Wednesday, November 16, 2005 6:44 PM
Subject: [antlr-interest] unary Operators


> Hi Guys,
>     Im using a C like grammer and am having trouble getting unary 
> operators to work
> 
> I have in the parser
> 
> unary_exp
> :primary_exp
> | (LNOT^ | MINUS^ |PLUS^) primary_exp
>           ;
> 
> It works  OK with a single unary operator eg   !10 or -2.4
> But put them together and nogo e.g !!20 or -!0
> 
> Regards Henry
> 
> 

From demakov at ispras.ru  Wed Nov 16 07:34:48 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Wed Nov 16 07:34:56 2005
Subject: [antlr-interest] unary Operators
References: <437B53F3.2030306@ntlworld.com>
Message-ID: <00a801c5eac3$476fd1c0$8cc79553@marlboro>

Sorry for previous incomplete message :(

Unary operator can be repeated zero or more times?

unary_exp : (LNOT | MINUS |PLUS)* primary_exp ;

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: "Henry Butowsky" <henryb@ntlworld.com>
To: <antlr-interest@antlr.org>
Sent: Wednesday, November 16, 2005 6:44 PM
Subject: [antlr-interest] unary Operators


> Hi Guys,
>     Im using a C like grammer and am having trouble getting unary 
> operators to work
> 
> I have in the parser
> 
> unary_exp
> :primary_exp
> | (LNOT^ | MINUS^ |PLUS^) primary_exp
>           ;
> 
> It works  OK with a single unary operator eg   !10 or -2.4
> But put them together and nogo e.g !!20 or -!0
> 
> Regards Henry
> 
> 

From jbb at acm.org  Wed Nov 16 07:35:18 2005
From: jbb at acm.org (John B. Brodie)
Date: Wed Nov 16 07:35:21 2005
Subject: [antlr-interest] unary Operators
In-Reply-To: <437B53F3.2030306@ntlworld.com> (message from Henry Butowsky on
	Wed, 16 Nov 2005 15:44:51 +0000)
References: <437B53F3.2030306@ntlworld.com>
Message-ID: <E1EcPJe-0007wI-00@gecko>

Sir :-

You asked:
>unary_exp
>	:primary_exp
>	| (LNOT^ | MINUS^ |PLUS^) primary_exp
>          ;
>	
>It works  OK with a single unary operator eg   !10 or -2.4
>But put them together and nogo e.g !!20 or -!0

You could try the following but I don't think you can keep the ^ tree
operator, you'll need to figure out some other way to build the tree:

unary_exp : ( LNOT | MINUS | PLUS )* primary_exp ;

or perhaps just use recursion (i think this produces the tree you
might intuitively expect):

unary_exp
	:primary_exp
	| (LNOT^ | MINUS^ |PLUS^) unary_exp
          ;

My tree building skills are rather weak, sorry...

Hope this helps.
   -jbb
From parrt at cs.usfca.edu  Wed Nov 16 07:55:40 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 07:55:44 2005
Subject: [antlr-interest] unary Operators
In-Reply-To: <437B53F3.2030306@ntlworld.com>
References: <437B53F3.2030306@ntlworld.com>
Message-ID: <4ED1C933-7BA1-44AC-91AE-1717522D4CF6@cs.usfca.edu>


On Nov 16, 2005, at 7:44 AM, Henry Butowsky wrote:

> Hi Guys,
>    Im using a C like grammer and am having trouble getting unary  
> operators to work
>
> I have in the parser
>
> unary_exp
> 	:primary_exp
> 	| (LNOT^ | MINUS^ |PLUS^) primary_exp
>          ;
> 	
> It works  OK with a single unary operator eg   !10 or -2.4
> But put them together and nogo e.g !!20 or -!0

You should make the ref to primary after the ops to unary :)  It  
would use recursion to loop and get the precedence right at the same  
time I think. :)

Ter
From madcapmaggie at yahoo.com  Wed Nov 16 07:56:46 2005
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Wed Nov 16 07:56:56 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <21835.82.92.2.221.1132154738.squirrel@webmail.xs4all.nl>
Message-ID: <20051116155646.97232.qmail@web30208.mail.mud.yahoo.com>

I use different token types in the parser, eg
  SQL_E_COLUMN_NAME
  SQL_E_TABLE_NAME
usually in the case of column names, the actual name
is a child of this node:
Here is part of the column_name definition for one of
the databases:

 o0:schema_name DOT! 
            t0:table_name DOT! c0:column_name_ref 
            { ## = #([SQL_E_COLUMN_NAME,
"COLUMN_NAME"], #c0, #t0, #o0); }
...

--- "Jan H. van der Ven" <jhvdven@xs4all.nl> wrote:

> Hi,
> 
> 
> I am currently working on a SQL parser (we want to
> support all databases,
> but I am taking baby steps). I used the MS SQL
> select statement from
> Tomasz Jastrzebski that can be downloaded from
> antlr.org. It checks my
> statements ok, but that is not the only result I am
> looking for.
> 
> What I want is that after the parsing the tokens
> contain extra information
> about their syntactic nature. For instance, the
> parser will find out that
> a certain 'identifier' is actually a column and I
> would like that
> knowledge to become part of the token or the AST.
> 
> I am new to all of this, so if this is something you
> guys do all day
> please let me know.
> 
> If it is not, could you point me in the right
> direction.
> 
> 
> Kind regards,
> 
> 
> Jan van der Ven
> 
> 

From ray at soartech.com  Wed Nov 16 08:51:16 2005
From: ray at soartech.com (David Ray)
Date: Wed Nov 16 08:51:13 2005
Subject: [antlr-interest] Calling code at rule exit
Message-ID: <437B6384.60400@soartech.com>

Hello,

I have some code that I would like to be called whenever a rule exits 
whether it exits normally or due to an error (I'm using the default 
error handler, so reportError() is called and the exception never 
actually leaves the method). I'm maintaining a variable scope stack and 
I need to push/pop it in rules that introduce a new scope. Right now, if 
an error occurs, the pop is never called and my stack is left in a bad 
state.

If this were C++, I'd just make a sentry object and call pop in the 
destructor, but since I'm doing this in Java I'm not sure if there is a 
good way to do that.  Does anyone know of a Java equivalent to C++ 
sentry objects, or some way I can do this in ANTLR?

Thanks,
Dave Ray
ray@soartech.com
From me at sebastienboving.com  Wed Nov 16 08:52:04 2005
From: me at sebastienboving.com (Sebastien Boving)
Date: Wed Nov 16 08:52:09 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
In-Reply-To: <000d01c5ea8b$28c574b0$0100a8c0@rexii>
References: <3dcf0a2a0511152249j2c362042hd8300f82d28deab6@mail.gmail.com>
	<000d01c5ea8b$28c574b0$0100a8c0@rexii>
Message-ID: <3dcf0a2a0511160852g27bc1cf7p9a681c2a8e94df58@mail.gmail.com>

Any existing work-arounds to this (finding out a list of failed matches
after a NoViableAltException), however cumbersome, until this feature makes
it in an upgrade? Or should i turn to other parsers for such a
functionality?

thank you,
-seb.



On 11/16/05, Geir Ove Skjaervik <geiroves@online.no> wrote:
>
> Hello,
>  Not a stupid question at all. I think it is just a ANTLR 2.x weakness
> that we can just hope will get rectified in an 2.x upgrade. I sure miss a
> more sensible exception in that case as well.
>   Geir Ove
>
>  -----Original Message-----
> *From:* antlr-interest-bounces@antlr.org [mailto:
> antlr-interest-bounces@antlr.org] *On Behalf Of *Sebastien Boving
> *Sent:* 16. november 2005 07:49
> *To:* antlr-interest@antlr.org
> *Subject:* [antlr-interest] NoViableAltException.expecting ?
>
>
> I searched the mailing list but noone seems to have asked for this so far,
> yet i'm a newbie so it must be a stupid proposal... Basically i can't find
> why, next to the unexpected token, NoViableAltException doesn't record what
> it tried to match against (such as MismatchedTokenException.expectingdoes)? This looks like it would be useful information to include for error
> reporting or auto-completion features. Or are there other, better ways of
> investigating the parser's state at the time of a RecognitionException?
>
> thanks,
> -seb.
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051116/fd001564/attachment.html
From parrt at cs.usfca.edu  Wed Nov 16 09:40:37 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 09:41:06 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <437A7C40.2040402@bluel.com>
References: <1129651947.28074@mx9.mysite4now.com> <437A7C40.2040402@bluel.com>
Message-ID: <6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>

On Nov 15, 2005, at 4:24 PM, Pete Gonzalez wrote:
> First, exceptions are slooooow in C#.  I am working on a real-world  
> project that parses a text file containing relatively simple field/ 
> value pairs. We're using the lexer from Robin Debreuil's C# grammar  
> example, which I assume is reasonably well designed.  On my 2.4Ghz  
> Pentium PC, the input file (which is only 8671 lines / 228969  
> bytes) takes 840 ms to parse. This is pretty damn slow by yacc  
> standards, but certainly usable.  However, when running in the  
> debugger, I was shocked to find that the same parser takes 55.062  
> seconds, which is totally unacceptable, especially when you  
> consider that the application will eventually have to parse  
> thousands of files, not just a measly 8000 lines.  Why so slow?   
> Exceptions.

Hi.  First, are you parsing C# or are you parsing simple field/value  
pairs?  Second, yes exceptions are slooooow!  Best to avoid syntactic  
predicates if you can.  I've seen people use them in exceptions and  
get exponential behavior.

> If you are a Java person applying Java thinking to C#, you'll  
> probably say "well the C# compiler is broken -- those performance  
> issues are a Microsoft flaw, not an Antlr problem."  I disagree.   
> In my experience, C# libraries simply don't throw hundreds of  
> exceptions per second, and most exceptions correspond to real  
> errors that end up being displayed in the GUI.  Since the Antlr web  
> site very clearly advertises support for C#, I think this should  
> warrant at least a gesture at compliance with the conventions for  
> this platform.  In case there's any doubt, here's an unambiguous  
> excerpt from a Microsoft "Best Practices" document:
>
> http://tinyurl.com/aqzzh
> > Exceptions Are For Exceptional Circumstances
> >
> > Do not throw exceptions as a means of communicating between
> > components -- use events for that. Exceptions should not be
> > thrown in cases where completely expected results occur. For
> > example, a component that reads text files should not throw an
> > exception when it reaches the end of the file. This is a case
> > where an event would be appropriate. By limiting throwing
> > exceptions to exceptional cases, you will help developers to
> > debug their application rapidly by not having to wade through
> > numerous 'expected' exceptions.

Yes, in generated programs however I believe it's an "exception" to  
the rule. ;)  That said, I'm going to try to avoid exceptions in v3.

> This brings us to my second point:  trying to debug a application  
> with Antlr calls.  In C#, NORMALLY in I would just set my debugger  
> to break whenever an exception is thrown, and then hit F5 a few  
> times until I reach the bug.  With Antlr, this is no longer  
> possible.  Instead I have to turn off exception trapping, set a  
> breakpoint somewhere near the problem but after the parser has  
> finished, run to the breakpoint, then then re-enable exception  
> trapping to catch the "real" error.  If Antlr is being called in a  
> loop, this often requires hacking the code to add some kind of  
> counter or if/then test around the breakpoint.  This is what  
> Microsoft means when they say "wade through numerous expected  
> exceptions", and it is a real headache.

Agreed.  Debugging is not a problem until you say "run until you hit  
an exception".

> In conclusion:  With regards to Java, we've discussed three  
> possible choices (exceptions, no exceptions, or supporting both),  
> and there have been good arguments in favor of each choice.  But  
> for the C# version, I don't see how there can be any debate at all.

Thanks very much for the valuable info.  I'm going to try for no- 
exceptions to see what happens.  Note that v3 should make syn preds  
MUCH less needed.

Ter
From parrt at cs.usfca.edu  Wed Nov 16 09:44:45 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 09:45:12 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <1132097693.26394.17.camel@localhost.localdomain>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
	<6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
	<BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>
	<20CD5538-F523-40C1-9144-B812E8281B9F@cs.usfca.edu>
	<1132097693.26394.17.camel@localhost.localdomain>
Message-ID: <3E6329C3-89E4-4ABB-95F0-1A45EC8E9DA1@cs.usfca.edu>


On Nov 15, 2005, at 3:34 PM, Martin Probst wrote:

> Hi,
>
>> Sure.  From my html.g file:
>>
>> OTABLE	
>> 	:	"<table"
>> 	;
>
> But that's a parser for a particular XML application, e.g. it returns
> OTABLE as a token, and not QNAME vs. ELEMENT_CONTENT.

True, but imagine

TAG : '<' ID  (WS (ATTR)*)? '>' ;

and you have XML tags don't you?

> If you want a
> generic XML parser, you'll run into that problem, as "foo" is a valid
> QNAME after a "<" or as an attribute name, but also valid
> ELEMENT_CONTENT in other places.

Yeah, I remember the PCDATA part being a hassle.

> Are there any plans on enhancing ANTLR Lexers by providing support for
> stateful lexers? I'm aware that it's doable using semantic predicates,
> but that's quite cumbersome. It could be really easy, e.g.
>
> state DEFAULT:
>   ELEMENT_START -> ELEMENT_STATE:
>     '<';
> state ELEMENT_STATE:
>   QNAME -> ATTR_LIST_STATE:
>     ...;

Well, yes, I've considered allowing you to specify a start rule for  
the lexer so you can do context-sensitive lexing.  Pretty cool, eh?   
Only issue is, how do you call a random method in Java w/o function  
pointers?  Reflection is SLOOOOW and not supported in all targets...

> and so on. I guess it would be not so much work to implement that in
> ANTLR, and it would be a really big improvement for people that  
> have to
> implement stateful lexers. Do you have any ideas on this?

Sure do! :)  Use the start rule idea, but also you can simply invoke  
another lexer to handle everything for PCDATA or do it the other way:  
have a special lexer for inside the tag.  Just call like an island  
grammar, right?

Ter
From parrt at cs.usfca.edu  Wed Nov 16 09:45:51 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 09:46:16 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
In-Reply-To: <000d01c5ea8b$28c574b0$0100a8c0@rexii>
References: <000d01c5ea8b$28c574b0$0100a8c0@rexii>
Message-ID: <DE551FA6-30E1-463B-97C4-DA0DB6437E09@cs.usfca.edu>


On Nov 16, 2005, at 12:53 AM, Geir Ove Skjaervik wrote:

> Hello,
>
> Not a stupid question at all. I think it is just a ANTLR 2.x  
> weakness that we can just hope will get rectified in an 2.x  
> upgrade. I sure miss a more sensible exception in that case as well.

Hi.  The data is not easily available to ANTLR at runtime so I didn't  
include it.  That is, the code wasn't convenient at the time.  Sorry.

Ter
From parrt at cs.usfca.edu  Wed Nov 16 09:54:18 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 09:54:44 2005
Subject: [antlr-interest] Bug with tree construction
In-Reply-To: <1132152972.8395.17.camel@localhost.localdomain>
References: <1132152972.8395.17.camel@localhost.localdomain>
Message-ID: <E1D9A5AC-8C70-43BB-A0D9-49C0B0AB66F8@cs.usfca.edu>


On Nov 16, 2005, at 6:56 AM, Martin Probst wrote:

> Hi,
> I have the following code in a grammar file:
>
> varDefn:
>   kd:Kdefine_variable^ q:bindVar! (td:typeDeclaration!)?
>   { ... }
>   ( COLON_EQUALS! expr
>   | ext:Kexternal
>       { ... }
>   )

Hi Martin, I just tried this grammar:

a: A^ b! (c!)?
   {;}
   ( E! expr
   | D {;}
   )
;

and it generates correct code (nothing like what you have).  Very  
odd!  Relevant chunks:

             tmp1_AST = astFactory.create(LT(1));
             astFactory.makeASTRoot(currentAST, tmp1_AST);
             match(A);

correct.

                 match(E);
                 expr();
                 astFactory.addASTChild(currentAST, returnAST);

correct.

Hmm...using  2.7.6rc1 (2005-11-04).  Perhaps we've fixed something in  
2.7.6 but I doubt it.

Ter

From mail at martin-probst.com  Wed Nov 16 10:05:53 2005
From: mail at martin-probst.com (Martin Probst)
Date: Wed Nov 16 10:06:04 2005
Subject: [antlr-interest] Bug with tree construction
In-Reply-To: <E1D9A5AC-8C70-43BB-A0D9-49C0B0AB66F8@cs.usfca.edu>
References: <1132152972.8395.17.camel@localhost.localdomain>
	<E1D9A5AC-8C70-43BB-A0D9-49C0B0AB66F8@cs.usfca.edu>
Message-ID: <1132164353.8395.19.camel@localhost.localdomain>

Hi,

I don't have time right now (it's 7pm in Europe...) but maybe it's
because of the labels? I'll try tomorrow...

Martin

On Wed, 2005-11-16 at 09:54 -0800, Terence Parr wrote:
> On Nov 16, 2005, at 6:56 AM, Martin Probst wrote:
> 
> > Hi,
> > I have the following code in a grammar file:
> >
> > varDefn:
> >   kd:Kdefine_variable^ q:bindVar! (td:typeDeclaration!)?
> >   { ... }
> >   ( COLON_EQUALS! expr
> >   | ext:Kexternal
> >       { ... }
> >   )
> 
> Hi Martin, I just tried this grammar:
> 
> a: A^ b! (c!)?
>    {;}
>    ( E! expr
>    | D {;}
>    )
> ;
> 
> and it generates correct code (nothing like what you have).  Very  
> odd!  Relevant chunks:
> 
>              tmp1_AST = astFactory.create(LT(1));
>              astFactory.makeASTRoot(currentAST, tmp1_AST);
>              match(A);
> 
> correct.
> 
>                  match(E);
>                  expr();
>                  astFactory.addASTChild(currentAST, returnAST);
> 
> correct.
> 
> Hmm...using  2.7.6rc1 (2005-11-04).  Perhaps we've fixed something in  
> 2.7.6 but I doubt it.
> 
> Ter
> 
> 

From parrt at cs.usfca.edu  Wed Nov 16 10:08:21 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 10:08:47 2005
Subject: [antlr-interest] Bug with tree construction
In-Reply-To: <1132164353.8395.19.camel@localhost.localdomain>
References: <1132152972.8395.17.camel@localhost.localdomain>
	<E1D9A5AC-8C70-43BB-A0D9-49C0B0AB66F8@cs.usfca.edu>
	<1132164353.8395.19.camel@localhost.localdomain>
Message-ID: <F9B044E5-3680-42E9-9CE6-EB1946BE1A0D@cs.usfca.edu>


On Nov 16, 2005, at 10:05 AM, Martin Probst wrote:

> Hi,
>
> I don't have time right now (it's 7pm in Europe...) but maybe it's
> because of the labels? I'll try tomorrow...

Good thought, but it seems to be ok still.  Hmm...weird.

Ter
From mail at martin-probst.com  Wed Nov 16 10:11:36 2005
From: mail at martin-probst.com (Martin Probst)
Date: Wed Nov 16 10:11:43 2005
Subject: [antlr-interest] xml grammar
In-Reply-To: <3E6329C3-89E4-4ABB-95F0-1A45EC8E9DA1@cs.usfca.edu>
References: <7E941C19-F75D-416E-8F71-495600D3A52B@vafer.org>
	<9da4f4520511151051p11c591abp@mail.gmail.com>
	<6256EEDE-8495-43A7-BDB1-7D80E8205AD3@cs.usfca.edu>
	<BF470D93-CDB6-4324-8F6D-75E1FBC520E7@vafer.org>
	<20CD5538-F523-40C1-9144-B812E8281B9F@cs.usfca.edu>
	<1132097693.26394.17.camel@localhost.localdomain>
	<3E6329C3-89E4-4ABB-95F0-1A45EC8E9DA1@cs.usfca.edu>
Message-ID: <1132164697.8395.23.camel@localhost.localdomain>

Hi,

> > state DEFAULT:
> >   ELEMENT_START -> ELEMENT_STATE:
> >     '<';
> > state ELEMENT_STATE:
> >   QNAME -> ATTR_LIST_STATE:
> >     ...;
> 
> Well, yes, I've considered allowing you to specify a start rule for  
> the lexer so you can do context-sensitive lexing.  Pretty cool, eh?   
> Only issue is, how do you call a random method in Java w/o function  
> pointers?  Reflection is SLOOOOW and not supported in all targets...

Can't you just have an "int state", DEFAULT = 1, ELEMENT_STATE = 2, etc.
and then switch over the state when lexing the next token? ->
ELEMENT_STATE then sets state to ELEMENT_STATE and your done - am I
missing something?

> > and so on. I guess it would be not so much work to implement that in
> > ANTLR, and it would be a really big improvement for people that  
> > have to
> > implement stateful lexers. Do you have any ideas on this?
> 
> Sure do! :)  Use the start rule idea, but also you can simply invoke  
> another lexer to handle everything for PCDATA or do it the other way:  
> have a special lexer for inside the tag.  Just call like an island  
> grammar, right?

Well, I was thinking more general (read: my XQuery Grammar ;-)), not
about XML itself.

Martin

From pgonzalez at bluel.com  Wed Nov 16 10:30:26 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Wed Nov 16 10:30:37 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>
References: <1129651947.28074@mx9.mysite4now.com> <437A7C40.2040402@bluel.com>
	<6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>
Message-ID: <437B7AC2.8040409@bluel.com>

Terence Parr wrote:
> Hi.  First, are you parsing C# or are you parsing simple field/value  
> pairs?

We are parsing field/value pairs, but the grammar was created by modifying 
an example grammar for C# from your web site.  This may seem like overkill 
for simple field/value pairs, but the application requires parsers for 
several different languages with syntax similar to C#, so it made sense to 
use a common framework.

 > Second, yes exceptions are slooooow!  Best to avoid syntactic
> predicates if you can.  I've seen people use them in exceptions and  get 
> exponential behavior.

The exceptions I see right now are MismatchedCharException (1870 times) and 
NoViableAltForCharException (3755 times).  I searched for "=>", and the 
only instances I see are in the NUMERIC_LITERAL lexer rule pasted below. 
Is there a better way to parse numeric literals?  We do need to distinguish 
integers, floating point, and hexadecimal.

> Thanks very much for the valuable info.  I'm going to try for no- 
> exceptions to see what happens.  Note that v3 should make syn preds  
> MUCH less needed.

How hard is it to convert 2.0 grammars for Antlr 3.0?  How usable is the 
current "early access" build?  What's the ETA for the official 3.0 release? 
  These seem like basic questions, but I didn't see them in the FAQ.  :-)

Cheers,
-Pete

__

// ***** A.1.8 LITERALS *****

NUMERIC_LITERAL
   // real
   : ('.' DECIMAL_DIGIT) =>
      '.' (DECIMAL_DIGIT)+ (EXPONENT_PART)? (REAL_TYPE_SUFFIX)?

   | ((DECIMAL_DIGIT)+ '.' DECIMAL_DIGIT) =>
      (DECIMAL_DIGIT)+ '.' (DECIMAL_DIGIT)+ (EXPONENT_PART)? 
(REAL_TYPE_SUFFIX)?

   | ((DECIMAL_DIGIT)+ (EXPONENT_PART)) =>
      (DECIMAL_DIGIT)+ (EXPONENT_PART) (REAL_TYPE_SUFFIX)?

   | ((DECIMAL_DIGIT)+ (REAL_TYPE_SUFFIX)) =>
      (DECIMAL_DIGIT)+ (REAL_TYPE_SUFFIX)

   // integer
   |  (DECIMAL_DIGIT)+ (INTEGER_TYPE_SUFFIX)?

   // just a dot
   | '.'
   ;
From parrt at cs.usfca.edu  Wed Nov 16 10:39:58 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 10:40:24 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <437B7AC2.8040409@bluel.com>
References: <1129651947.28074@mx9.mysite4now.com> <437A7C40.2040402@bluel.com>
	<6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>
	<437B7AC2.8040409@bluel.com>
Message-ID: <D7586DAE-F427-4058-ADC4-29FB9AAFFB61@cs.usfca.edu>


On Nov 16, 2005, at 10:30 AM, Pete Gonzalez wrote:

> Terence Parr wrote:
>> Hi.  First, are you parsing C# or are you parsing simple field/ 
>> value  pairs?
>
> We are parsing field/value pairs, but the grammar was created by  
> modifying an example grammar for C# from your web site.  This may  
> seem like overkill for simple field/value pairs, but the  
> application requires parsers for several different languages with  
> syntax similar to C#, so it made sense to use a common framework.

Ah.  Makes sense.

> The exceptions I see right now are MismatchedCharException (1870  
> times) and NoViableAltForCharException (3755 times).

The *LEXER* is backtracking?  Oh gawd, it will kill you.  See what  
the java grammar does for matching numbers...I think it avoids them.   
An exception per char is deadly.

>> Thanks very much for the valuable info.  I'm going to try for no-  
>> exceptions to see what happens.  Note that v3 should make syn  
>> preds  MUCH less needed.
>
> How hard is it to convert 2.0 grammars for Antlr 3.0?  How usable  
> is the current "early access" build?  What's the ETA for the  
> official 3.0 release?  These seem like basic questions, but I  
> didn't see them in the FAQ.  :-)

We don't have a faq yet ;)  Gotta figure out why the wiki was  
crashing and get that going again.

I'll be doing an auto-converter to 3.0.  Current version I just  
released is pretty usable if you ask me, but I'm going to try it out  
on a real app soon to see if it does anything useful.  It crashes on  
bad input at the moment etc...  I wouldn't bet my job on it yet ;)   
3.0 eta will be next summer probably.

Ter
From virtualaspirin at yahoo.com  Wed Nov 16 10:43:35 2005
From: virtualaspirin at yahoo.com (Akhilesh Mritunjai)
Date: Wed Nov 16 10:43:39 2005
Subject: [antlr-interest] Calling code at rule exit
In-Reply-To: <437B6384.60400@soartech.com>
Message-ID: <20051116184336.6190.qmail@web30811.mail.mud.yahoo.com>


I know its like using an elephant gun to kill a
cockroach, but have you given a thought in using AOP
frameworks like AspectJ and kins.

I believe ANTLR gives options to add exception
handlers, but dunno about finalizers... and even they
don't apply to complete method body, afaik. AOP hacks
are only things guaranteed to work.

- Akhilesh


--- David Ray <ray@soartech.com> wrote:

> Hello,
> 
> I have some code that I would like to be called
> whenever a rule exits 
> whether it exits normally or due to an error (I'm
> using the default 
> error handler, so reportError() is called and the
> exception never 
> actually leaves the method). I'm maintaining a
> variable scope stack and 
> I need to push/pop it in rules that introduce a new
> scope. Right now, if 
> an error occurs, the pop is never called and my
> stack is left in a bad 
> state.
> 
> If this were C++, I'd just make a sentry object and
> call pop in the 
> destructor, but since I'm doing this in Java I'm not
> sure if there is a 
> good way to do that.  Does anyone know of a Java
> equivalent to C++ 
> sentry objects, or some way I can do this in ANTLR?
> 
> Thanks,
> Dave Ray
> ray@soartech.com
> 



	
		
__________________________________ 
Yahoo! Mail - PC Magazine Editors' Choice 2005 
http://mail.yahoo.com
From me at sebastienboving.com  Wed Nov 16 11:02:12 2005
From: me at sebastienboving.com (Sebastien Boving)
Date: Wed Nov 16 11:02:14 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
In-Reply-To: <DE551FA6-30E1-463B-97C4-DA0DB6437E09@cs.usfca.edu>
References: <000d01c5ea8b$28c574b0$0100a8c0@rexii>
	<DE551FA6-30E1-463B-97C4-DA0DB6437E09@cs.usfca.edu>
Message-ID: <3dcf0a2a0511161102l56d9ee5wf4328dbdbc3561df@mail.gmail.com>

Either we're talking about different information, or i'm not getting why it
isn't readily available to ANTLR at code generation time. Taking the example
of the generated python implementation for rule 'base_operation' in a LL(1)
grammar:

def base_operation(self):

la1 = self.LA(1)
if False:
pass
elif la1 and la1 in [LITERAL_show]:
pass
self.show_operation()
elif la1 and la1 in [LITERAL_no,LITERAL_set]:
pass
self.set_operation()
else:
raise antlr.NoViableAltException(self.LT(1), self.getFilename())

why can't you generate

antlr.NoViableAltException(self.LT(1).self.getFilename(), [LITERAL_show,
LITERAL_no, LITERAL_set])

to be raised instead? ANTLR should be able to build this list as it just
constructed the flow control displayed above the error handling, right?

(this could be implemented differently, for instance referencing a rule id
and providing a looking from rule id to next expected tokens, just trying to
make the point using a list)

thanks.


On 11/16/05, Terence Parr <parrt@cs.usfca.edu> wrote:
>
>
> On Nov 16, 2005, at 12:53 AM, Geir Ove Skjaervik wrote:
>
> > Hello,
> >
> > Not a stupid question at all. I think it is just a ANTLR 2.x
> > weakness that we can just hope will get rectified in an 2.x
> > upgrade. I sure miss a more sensible exception in that case as well.
>
> Hi. The data is not easily available to ANTLR at runtime so I didn't
> include it. That is, the code wasn't convenient at the time. Sorry.
>
> Ter
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051116/2402a168/attachment.html
From ray at soartech.com  Wed Nov 16 11:21:13 2005
From: ray at soartech.com (David Ray)
Date: Wed Nov 16 11:21:11 2005
Subject: [antlr-interest] Calling code at rule exit
In-Reply-To: <20051116184336.6190.qmail@web30811.mail.mud.yahoo.com>
References: <20051116184336.6190.qmail@web30811.mail.mud.yahoo.com>
Message-ID: <437B86A9.7060607@soartech.com>

Thanks for the suggestion. AOP is a little overkill though :)

After thinking a little more the solution I came up with is just a 
simple sub-rule. It's a little annoying, but not too bad:

rule:
    ...
    { pushScope(); }
    ruleScope  /* actual rule that may fail */
    { popScope(); }
;

This isn't totally exception-safe, but seems like it will work for the 
time being. Unit tests pass anyway.

Thanks,
Dave

Akhilesh Mritunjai wrote:
> I know its like using an elephant gun to kill a
> cockroach, but have you given a thought in using AOP
> frameworks like AspectJ and kins.
> 
> I believe ANTLR gives options to add exception
> handlers, but dunno about finalizers... and even they
> don't apply to complete method body, afaik. AOP hacks
> are only things guaranteed to work.
> 
> - Akhilesh
> 
> 
> --- David Ray <ray@soartech.com> wrote:
> 
> 
>>Hello,
>>
>>I have some code that I would like to be called
>>whenever a rule exits 
>>whether it exits normally or due to an error (I'm
>>using the default 
>>error handler, so reportError() is called and the
>>exception never 
>>actually leaves the method). I'm maintaining a
>>variable scope stack and 
>>I need to push/pop it in rules that introduce a new
>>scope. Right now, if 
>>an error occurs, the pop is never called and my
>>stack is left in a bad 
>>state.
>>
>>If this were C++, I'd just make a sentry object and
>>call pop in the 
>>destructor, but since I'm doing this in Java I'm not
>>sure if there is a 
>>good way to do that.  Does anyone know of a Java
>>equivalent to C++ 
>>sentry objects, or some way I can do this in ANTLR?
>>
>>Thanks,
>>Dave Ray
>>ray@soartech.com
>>
> 
> 
> 
> 
> 	
> 		
> __________________________________ 
> Yahoo! Mail - PC Magazine Editors' Choice 2005 
> http://mail.yahoo.com
From parrt at cs.usfca.edu  Wed Nov 16 11:21:43 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 11:22:09 2005
Subject: [antlr-interest] NoViableAltException.expecting ?
In-Reply-To: <3dcf0a2a0511161102l56d9ee5wf4328dbdbc3561df@mail.gmail.com>
References: <000d01c5ea8b$28c574b0$0100a8c0@rexii>
	<DE551FA6-30E1-463B-97C4-DA0DB6437E09@cs.usfca.edu>
	<3dcf0a2a0511161102l56d9ee5wf4328dbdbc3561df@mail.gmail.com>
Message-ID: <5EF0699F-D576-4F16-97D5-DC4BF2CCBAE9@cs.usfca.edu>


On Nov 16, 2005, at 11:02 AM, Sebastien Boving wrote:
> why can't you generate
>
>  antlr.NoViableAltException(self.LT(1).self.getFilename(),  
> [LITERAL_show, LITERAL_no, LITERAL_set])
>
> to be raised instead?  ANTLR should be able to build this list as  
> it just constructed the flow control displayed above the error  
> handling, right?

Well, ANTLR can figure out the LL(1) FIRST set of course but it will  
not always makes sense:

a : A B
   | A C
  ;

upon A D you'd get "missing A" found A. ;)

I'm just saying it's not obvious what you want and it wasn't  
convenient to generate this when I was doing it so I left it out.   
Sorry about that...lots of little holes like that.  Trivial to add to  
new system.  Bug me in a few months when I get back to error stuff.

Ter
From parrt at cs.usfca.edu  Wed Nov 16 12:46:38 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 16 12:47:06 2005
Subject: [antlr-interest] big update to rewriting with templates blog
Message-ID: <59325E0A-C6DA-431A-BB77-4173B8FECD44@cs.usfca.edu>

Looks like my blog thingie is working, but for those  
nonblogaggregators (like me), I thought I'd ping the list:

http://www.antlr.org/blog/antlr3/rewrite.tml

or

feed://www.antlr.org/blog/antlr3/rewrite.tml?RSS

Basically it's a side by side comparison of what v2 looked liked for  
an ANTLR+StringTemplate translation and what v3 should look like:

Ter
From virtualaspirin at yahoo.com  Wed Nov 16 14:50:44 2005
From: virtualaspirin at yahoo.com (Akhilesh Mritunjai)
Date: Wed Nov 16 14:50:51 2005
Subject: [antlr-interest] java.lang.InternalError
In-Reply-To: <20051115001133.55244.qmail@web54509.mail.yahoo.com>
Message-ID: <20051116225044.58978.qmail@web30812.mail.mud.yahoo.com>

Hi All

Found the real reason why it happens, esp why it
started happening "only recently".

http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6294277

Basically, if you have a *large* grammar, you may run
into this issue as recent (2.7.5+) version of ANTLR
generates SMAP files for debug info. If this info
exceeds 64K and JVM is run with -XDebug (in debug
mode), the JVM crashes with InternalError.

I've voted for resolution of this bug... did you ?

Workaround is to disable generation of smap
files/delete them prior to compiling java files. It'd
defeat ANTLR source level debugging which anyways
never worked for me inside eclipse. (If someone knows
howto make it work, please let me know).

Thanks

- Akhilesh


--- Jeff Barnes <jbarnesweb@yahoo.com> wrote:

> When trying to debug the generated lexer in either
> Eclipse or NetBeans, "java.lang.InternalError: name
> is
> too long to represent" is thrown. It is thrown when
> I
> try to instantiate my lexer with the InputStream
> argument. The fully-qualified name is 34 characters
> long.
> 
> Is this a known issue and is there a workaround?
> 
> Regards,
> Jeff Barnes
> 



		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com
From pgonzalez at bluel.com  Wed Nov 16 19:37:47 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Wed Nov 16 19:37:58 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <D7586DAE-F427-4058-ADC4-29FB9AAFFB61@cs.usfca.edu>
References: <1129651947.28074@mx9.mysite4now.com>
	<437A7C40.2040402@bluel.com>	<6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>	<437B7AC2.8040409@bluel.com>
	<D7586DAE-F427-4058-ADC4-29FB9AAFFB61@cs.usfca.edu>
Message-ID: <437BFB0B.1020800@bluel.com>

Terence Parr wrote:
> The *LEXER* is backtracking?  Oh gawd, it will kill you.  See what  the 
> java grammar does for matching numbers...I think it avoids them.   An 
> exception per char is deadly.

Thanks!  I tried the lexer from your Java grammar and this eliminated the 
exceptions.  The improvement is significant:  0.406 secs outside of 
debugger (i.e. 48% of original), 0.456 secs in the debugger (i.e. 0.8%!).  :-)

FYI I noticed that Todd King recently posted an updated C# grammar on the 
Antlr web site saying:

"I designed this grammar for speed so I avoided using arbitrary lookaheads 
where I could. I got it down to just 7 lookaheads."

However, he is using the exact same lexer (from Robin Debreuil) with 
backtracking.  I didn't see an e-mail address, but someone should notify 
him about the technique used in your Java lexer.

> I'll be doing an auto-converter to 3.0.  Current version I just  
> released is pretty usable if you ask me, but I'm going to try it out  on 
> a real app soon to see if it does anything useful.  It crashes on  bad 
> input at the moment etc...  I wouldn't bet my job on it yet ;)   3.0 eta 
> will be next summer probably.

I took a look at the 3.0 examples and this new design really does "kick 
ass" to quote a PowerPoint slide.  I think you are doing some genuinely 
innovative work, and I think your approach to the problem is right on.  I'm 
really looking forward to this release, and will give the "early access" 
build a try as soon as the C# codegen is in place.  Anyway, thanks for your 
help!

Cheers,
-Pete
From mathieu.clabaut at gmail.com  Thu Nov 17 01:48:58 2005
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Thu Nov 17 01:49:01 2005
Subject: [antlr-interest] About tree duplication ?
Message-ID: <db9360ca0511170148q648486a4u@mail.gmail.com>

 Hello,

  In a tree parser, I can not reference twice the same tree when
constructing a new tree. I have to call astFactory->create().
  Is there a way to only use antlr notation ? Is this a feature or a bug ?

 For example, the following creation rules
  	    ##= #([OR_SERVICE,"||"],
		     #([TWOWAY,"<>"],#s3,
			#([SOURCE,":<"], #f3),
			#([DESTINATION,":>"],#t3)
		     ),
		     #([TWOWAY,"<>"],#s3,
			#([SOURCE,":<"], #t3),
			#([DESTINATION,":>"],#f3)
		     )
gives the following tree :
||
 <>
  s3 :<f3 :> t3 :<t3 :>f3
 <>
  s3 :<f3 :> t3 :<t3 :>f3

Whereas the following creation rules:
	    ##= #([OR_SERVICE,"||"],
		     #([TWOWAY,"<>"],#s3,
			#([TWOCOLON,"::"] , #b3),
			#([SOURCE,":<"], #f3),
			#([DESTINATION,":>"],#t3)
		     ),
		     #([TWOWAY,"<>"],astFactory->create(#s3),
			#([TWOCOLON,"::"] , #b3),
			#([SOURCE,":<"], #t3),
			#([DESTINATION,":>"],#f3)
		     )
Gives the expected results :
||
 <>
  s3 :<f3 :> t3
 <>
  s3 :<t3 :>f3

-mathieu

--
____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
           F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
From ewbank at gmail.com  Thu Nov 17 01:55:53 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Nov 17 01:55:58 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <db9360ca0511170148q648486a4u@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
Message-ID: <dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>

The easiest way I've found is to use the "dup" member functions of the
parser and treeparser classes.  Another way that is closer, perhaps,
to what you are wanting, is to write a production that duplicates a
node (works only with buildAST=true).

On 11/17/05, Mathieu Clabaut <mathieu.clabaut@gmail.com> wrote:
>  Hello,
>
>   In a tree parser, I can not reference twice the same tree when
> constructing a new tree. I have to call astFactory->create().
>   Is there a way to only use antlr notation ? Is this a feature or a bug ?
>
>  For example, the following creation rules
>             ##= #([OR_SERVICE,"||"],
>                      #([TWOWAY,"<>"],#s3,
>                         #([SOURCE,":<"], #f3),
>                         #([DESTINATION,":>"],#t3)
>                      ),
>                      #([TWOWAY,"<>"],#s3,
>                         #([SOURCE,":<"], #t3),
>                         #([DESTINATION,":>"],#f3)
>                      )
> gives the following tree :
> ||
>  <>
>   s3 :<f3 :> t3 :<t3 :>f3
>  <>
>   s3 :<f3 :> t3 :<t3 :>f3
>
> Whereas the following creation rules:
>             ##= #([OR_SERVICE,"||"],
>                      #([TWOWAY,"<>"],#s3,
>                         #([TWOCOLON,"::"] , #b3),
>                         #([SOURCE,":<"], #f3),
>                         #([DESTINATION,":>"],#t3)
>                      ),
>                      #([TWOWAY,"<>"],astFactory->create(#s3),
>                         #([TWOCOLON,"::"] , #b3),
>                         #([SOURCE,":<"], #t3),
>                         #([DESTINATION,":>"],#f3)
>                      )
> Gives the expected results :
> ||
>  <>
>   s3 :<f3 :> t3
>  <>
>   s3 :<t3 :>f3
>
> -mathieu
>
> --
> ____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
> Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
>            F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
>
From mathieu.clabaut at gmail.com  Thu Nov 17 02:18:55 2005
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Thu Nov 17 02:18:58 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
Message-ID: <db9360ca0511170218r70443df8j@mail.gmail.com>

On 17/11/05, Bryan Ewbank <ewbank@gmail.com> wrote:
 Thanks for your tips.
> The easiest way I've found is to use the "dup" member functions of the
> parser and treeparser classes.
 Ok, but I only find a dup function in the ASTFactory class. I do not
know in what it differs from the create member ?

> Another way that is closer, perhaps,
> to what you are wanting, is to write a production that duplicates a
> node (works only with buildAST=true).
 mmmmh, would you mind to give me an example ? I have some
difficulties to draw something wich approach your suggestion...

 Thank you very much...
-mathieu


--
____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
           F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
From ric.klaren at gmail.com  Thu Nov 17 03:09:59 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Thu Nov 17 03:06:47 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <db9360ca0511170148q648486a4u@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
Message-ID: <437C6507.2060803@gmail.com>

Hi,

Mathieu Clabaut wrote:
>   In a tree parser, I can not reference twice the same tree when
> constructing a new tree. I have to call astFactory->create().
>   Is there a way to only use antlr notation ? Is this a feature or a bug ?

Keep in mind that the antlr tree objects are references or reference
counted objects. Basically they behave like pointers.

>  For example, the following creation rules
>   	    ##= #([OR_SERVICE,"||"],
> 		     #([TWOWAY,"<>"],#s3,
> 			#([SOURCE,":<"], #f3),
> 			#([DESTINATION,":>"],#t3)
> 		     ),
> 		     #([TWOWAY,"<>"],#s3,
> 			#([SOURCE,":<"], #t3),
> 			#([DESTINATION,":>"],#f3)
> 		     )

This is really bad practice since you link a node into the tree at
multiple spots, potentially creating loops in the tree that will hang
the normal tree traversal functions.

Before you stick the nodes in the tree you have to duplicate them using
ASTFactory->dup() or dupTree() in case it's a subtree you're dealing
with. Another option is to use the clone method of the nodes.

> Whereas the following creation rules:
> 	    ##= #([OR_SERVICE,"||"],
> 		     #([TWOWAY,"<>"],#s3,
> 			#([TWOCOLON,"::"] , #b3),
> 			#([SOURCE,":<"], #f3),
> 			#([DESTINATION,":>"],#t3)
> 		     ),
> 		     #([TWOWAY,"<>"],astFactory->create(#s3),
> 			#([TWOCOLON,"::"] , #b3),
> 			#([SOURCE,":<"], #t3),
> 			#([DESTINATION,":>"],#f3)
> 		     )
> Gives the expected results :
> ||
>  <>
>   s3 :<f3 :> t3
>  <>
>   s3 :<t3 :>f3

This is better but you should dup/clone all the nodes you put in twice.
Safest practice is to clone everything but if you're sure the
s3/b3/f3/t3 are only used once then it suffices to only do it once.

Cheers,

Ric
From mathieu.clabaut at gmail.com  Thu Nov 17 04:24:12 2005
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Thu Nov 17 04:24:18 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <437C6507.2060803@gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<437C6507.2060803@gmail.com>
Message-ID: <db9360ca0511170424u532d6fbco@mail.gmail.com>

 Thank you Ric for your explanations.... but ..

On 17/11/05, Ric Klaren <ric.klaren@gmail.com> wrote:
> Keep in mind that the antlr tree objects are references or reference
> counted objects. Basically they behave like pointers.
> >  For example, the following creation rules
> >           ##= #([OR_SERVICE,"||"],
> >                    #([TWOWAY,"<>"],#s3,
> >                       #([SOURCE,":<"], #f3),
> >                       #([DESTINATION,":>"],#t3)
> >                    ),
> >                    #([TWOWAY,"<>"],#s3,
> >                       #([SOURCE,":<"], #t3),
> >                       #([DESTINATION,":>"],#f3)
> >                    )
>
> This is really bad practice since you link a node into the tree at
> multiple spots, potentially creating loops in the tree that will hang
> the normal tree traversal functions.

 It may be bad practice, but it is not really said in antlr
documentation (not complaining, just stating).
 You can know it is bad practice if you have a suficiant insight of
how antlr translate the #xx notations  (I could have imagine that
antlr  check how many time a reference is use in tree construction...)
and how the AST class are made (or when you meet such a problem, which
force you to dig deeper in the backstage)...

 Anyway thank you for your help... I'll review my code to check If I
other simlilar cases in....

-mathieu



--
____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
           F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
From jhvdven at xs4all.nl  Thu Nov 17 07:09:45 2005
From: jhvdven at xs4all.nl (Jan H. van der Ven)
Date: Thu Nov 17 07:09:48 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <20051116155646.97232.qmail@web30208.mail.mud.yahoo.com>
References: <21835.82.92.2.221.1132154738.squirrel@webmail.xs4all.nl>
	<20051116155646.97232.qmail@web30208.mail.mud.yahoo.com>
Message-ID: <10258.82.92.2.221.1132240185.squirrel@webmail.xs4all.nl>

Sorry my first response went out to you personally. Luckily the others did
not get my newbie response.
In the meantime i did some reading and coding and headstomping.

My simplified statement parser now sometimes knows when it is dealing with
a table or a column but when i have a common construction like select
table.column from table my cpu rises to 100% even though my ambiguities on
this (there are 2 that I think do not matter) are resolved.

I have attached my .g. The trouble is with the dbObject I think.

The statement that's giving me headaches is: SELECT a.b from C (see how
far I am already ;-)

Please advise.

<quote who="Peggy Fieland">
> I use different token types in the parser, eg
>   SQL_E_COLUMN_NAME
>   SQL_E_TABLE_NAME
> usually in the case of column names, the actual name
> is a child of this node:
> Here is part of the column_name definition for one of
> the databases:
>
>  o0:schema_name DOT!
>             t0:table_name DOT! c0:column_name_ref
>             { ## = #([SQL_E_COLUMN_NAME,
> "COLUMN_NAME"], #c0, #t0, #o0); }
> ...
>
> --- "Jan H. van der Ven" <jhvdven@xs4all.nl> wrote:
>
>> Hi,
>>
>>
>> I am currently working on a SQL parser (we want to
>> support all databases,
>> but I am taking baby steps). I used the MS SQL
>> select statement from
>> Tomasz Jastrzebski that can be downloaded from
>> antlr.org. It checks my
>> statements ok, but that is not the only result I am
>> looking for.
>>
>> What I want is that after the parsing the tokens
>> contain extra information
>> about their syntactic nature. For instance, the
>> parser will find out that
>> a certain 'identifier' is actually a column and I
>> would like that
>> knowledge to become part of the token or the AST.
>>
>> I am new to all of this, so if this is something you
>> guys do all day
>> please let me know.
>>
>> If it is not, could you point me in the right
>> direction.
>>
>>
>> Kind regards,
>>
>>
>> Jan van der Ven
>>
>>
>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQL92Select.g
Type: application/octet-stream
Size: 15767 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051117/72e05aa9/SQL92Select-0001.obj
From jhvdven at xs4all.nl  Thu Nov 17 07:14:36 2005
From: jhvdven at xs4all.nl (Jan H. van der Ven)
Date: Thu Nov 17 07:14:38 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <10258.82.92.2.221.1132240185.squirrel@webmail.xs4all.nl>
References: <21835.82.92.2.221.1132154738.squirrel@webmail.xs4all.nl>   
	<20051116155646.97232.qmail@web30208.mail.mud.yahoo.com>
	<10258.82.92.2.221.1132240185.squirrel@webmail.xs4all.nl>
Message-ID: <12720.82.92.2.221.1132240476.squirrel@webmail.xs4all.nl>

And the race condition is in
ASTFactory:
    public AST make(AST[] nodes) {
        if (nodes == null || nodes.length == 0) return null;
        AST root = nodes[0];
        AST tail = null;
        if (root != null) {
            root.setFirstChild(null);	// don't leave any old pointers set
        }
        // link in children;
        for (int i = 1; i < nodes.length; i++) {
            if (nodes[i] == null) continue;	// ignore null nodes
            if (root == null) {
                // Set the root and set it up for a flat list
                root = tail = nodes[i];
            }
            else if (tail == null) {
                root.setFirstChild(nodes[i]);
                tail = root.getFirstChild();
            }
            else {
                tail.setNextSibling(nodes[i]);
                tail = tail.getNextSibling();
            }
---->            // Chase tail to last sibling
---->            while (tail.getNextSibling() != null) {
---->                tail = tail.getNextSibling();
---->            }
// bites its own tail
        }
        return root;
    }

<quote who="Jan H. van der Ven">
> Sorry my first response went out to you personally. Luckily the others did
> not get my newbie response.
> In the meantime i did some reading and coding and headstomping.
>
> My simplified statement parser now sometimes knows when it is dealing with
> a table or a column but when i have a common construction like select
> table.column from table my cpu rises to 100% even though my ambiguities on
> this (there are 2 that I think do not matter) are resolved.
>
> I have attached my .g. The trouble is with the dbObject I think.
>
> The statement that's giving me headaches is: SELECT a.b from C (see how
> far I am already ;-)
>
> Please advise.
>
> <quote who="Peggy Fieland">
>> I use different token types in the parser, eg
>>   SQL_E_COLUMN_NAME
>>   SQL_E_TABLE_NAME
>> usually in the case of column names, the actual name
>> is a child of this node:
>> Here is part of the column_name definition for one of
>> the databases:
>>
>>  o0:schema_name DOT!
>>             t0:table_name DOT! c0:column_name_ref
>>             { ## = #([SQL_E_COLUMN_NAME,
>> "COLUMN_NAME"], #c0, #t0, #o0); }
>> ...
>>
>> --- "Jan H. van der Ven" <jhvdven@xs4all.nl> wrote:
>>
>>> Hi,
>>>
>>>
>>> I am currently working on a SQL parser (we want to
>>> support all databases,
>>> but I am taking baby steps). I used the MS SQL
>>> select statement from
>>> Tomasz Jastrzebski that can be downloaded from
>>> antlr.org. It checks my
>>> statements ok, but that is not the only result I am
>>> looking for.
>>>
>>> What I want is that after the parsing the tokens
>>> contain extra information
>>> about their syntactic nature. For instance, the
>>> parser will find out that
>>> a certain 'identifier' is actually a column and I
>>> would like that
>>> knowledge to become part of the token or the AST.
>>>
>>> I am new to all of this, so if this is something you
>>> guys do all day
>>> please let me know.
>>>
>>> If it is not, could you point me in the right
>>> direction.
>>>
>>>
>>> Kind regards,
>>>
>>>
>>> Jan van der Ven
>>>
>>>
>>
>>
>


From madcapmaggie at yahoo.com  Thu Nov 17 07:45:02 2005
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Thu Nov 17 07:45:06 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <12720.82.92.2.221.1132240476.squirrel@webmail.xs4all.nl>
Message-ID: <20051117154502.62411.qmail@web30202.mail.mud.yahoo.com>

You'll need to disambiguate dotted names.

I didn't do it this way  but I've been thinking about
pushing the 
business with the dot qualifier into the lexer and
then letting the
parser split the names into pieces as needed and tag
the pieces 
with SCHEMA, TABLE, COLUMN qualifiers. 

You want to avoid the syntactic predicates:
(a.b) =>

and use instead semantic predicates.  
{ LT(1)->getText() == "a" && LT(2)->getText() == "." 
&& LT(3)->getText() == "b"}?

There's been a lot of discussion about this on the
list -- check the archives.



--- "Jan H. van der Ven" <jhvdven@xs4all.nl> wrote:

> And the race condition is in
> ASTFactory:
>     public AST make(AST[] nodes) {
>         if (nodes == null || nodes.length == 0)
> return null;
>         AST root = nodes[0];
>         AST tail = null;
>         if (root != null) {
>             root.setFirstChild(null);	// don't leave
> any old pointers set
>         }
>         // link in children;
>         for (int i = 1; i < nodes.length; i++) {
>             if (nodes[i] == null) continue;	//
> ignore null nodes
>             if (root == null) {
>                 // Set the root and set it up for a
> flat list
>                 root = tail = nodes[i];
>             }
>             else if (tail == null) {
>                 root.setFirstChild(nodes[i]);
>                 tail = root.getFirstChild();
>             }
>             else {
>                 tail.setNextSibling(nodes[i]);
>                 tail = tail.getNextSibling();
>             }
> ---->            // Chase tail to last sibling
> ---->            while (tail.getNextSibling() !=
> null) {
> ---->                tail = tail.getNextSibling();
> ---->            }
> // bites its own tail
>         }
>         return root;
>     }
> 
> <quote who="Jan H. van der Ven">
> > Sorry my first response went out to you
> personally. Luckily the others did
> > not get my newbie response.
> > In the meantime i did some reading and coding and
> headstomping.
> >
> > My simplified statement parser now sometimes knows
> when it is dealing with
> > a table or a column but when i have a common
> construction like select
> > table.column from table my cpu rises to 100% even
> though my ambiguities on
> > this (there are 2 that I think do not matter) are
> resolved.
> >
> > I have attached my .g. The trouble is with the
> dbObject I think.
> >
> > The statement that's giving me headaches is:
> SELECT a.b from C (see how
> > far I am already ;-)
> >
> > Please advise.
> >
> > <quote who="Peggy Fieland">
> >> I use different token types in the parser, eg
> >>   SQL_E_COLUMN_NAME
> >>   SQL_E_TABLE_NAME
> >> usually in the case of column names, the actual
> name
> >> is a child of this node:
> >> Here is part of the column_name definition for
> one of
> >> the databases:
> >>
> >>  o0:schema_name DOT!
> >>             t0:table_name DOT! c0:column_name_ref
> >>             { ## = #([SQL_E_COLUMN_NAME,
> >> "COLUMN_NAME"], #c0, #t0, #o0); }
> >> ...
> >>
> >> --- "Jan H. van der Ven" <jhvdven@xs4all.nl>
> wrote:
> >>
> >>> Hi,
> >>>
> >>>
> >>> I am currently working on a SQL parser (we want
> to
> >>> support all databases,
> >>> but I am taking baby steps). I used the MS SQL
> >>> select statement from
> >>> Tomasz Jastrzebski that can be downloaded from
> >>> antlr.org. It checks my
> >>> statements ok, but that is not the only result I
> am
> >>> looking for.
> >>>
> >>> What I want is that after the parsing the tokens
> >>> contain extra information
> >>> about their syntactic nature. For instance, the
> >>> parser will find out that
> >>> a certain 'identifier' is actually a column and
> I
> >>> would like that
> >>> knowledge to become part of the token or the
> AST.
> >>>
> >>> I am new to all of this, so if this is something
> you
> >>> guys do all day
> >>> please let me know.
> >>>
> >>> If it is not, could you point me in the right
> >>> direction.
> >>>
> >>>
> >>> Kind regards,
> >>>
> >>>
> >>> Jan van der Ven
> >>>
> >>>
> >>
> >>
> >
> 
> 
> 

From mail at martin-probst.com  Thu Nov 17 08:51:37 2005
From: mail at martin-probst.com (Martin Probst)
Date: Thu Nov 17 08:51:44 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <12720.82.92.2.221.1132240476.squirrel@webmail.xs4all.nl>
References: <21835.82.92.2.221.1132154738.squirrel@webmail.xs4all.nl>
	<20051116155646.97232.qmail@web30208.mail.mud.yahoo.com>
	<10258.82.92.2.221.1132240185.squirrel@webmail.xs4all.nl>
	<12720.82.92.2.221.1132240476.squirrel@webmail.xs4all.nl>
Message-ID: <1132246297.8153.9.camel@localhost.localdomain>

You probably created a loop in your AST somehow. Somewhat is calling
make() with an AST node whose children have a loop. Check your
construction syntax!

Martin

On Thu, 2005-11-17 at 16:14 +0100, Jan H. van der Ven wrote:
> And the race condition is in
> ASTFactory:
>     public AST make(AST[] nodes) {
>         if (nodes == null || nodes.length == 0) return null;
>         AST root = nodes[0];
>         AST tail = null;
>         if (root != null) {
>             root.setFirstChild(null);	// don't leave any old pointers set
>         }
>         // link in children;
>         for (int i = 1; i < nodes.length; i++) {
>             if (nodes[i] == null) continue;	// ignore null nodes
>             if (root == null) {
>                 // Set the root and set it up for a flat list
>                 root = tail = nodes[i];
>             }
>             else if (tail == null) {
>                 root.setFirstChild(nodes[i]);
>                 tail = root.getFirstChild();
>             }
>             else {
>                 tail.setNextSibling(nodes[i]);
>                 tail = tail.getNextSibling();
>             }
> ---->            // Chase tail to last sibling
> ---->            while (tail.getNextSibling() != null) {
> ---->                tail = tail.getNextSibling();
> ---->            }
> // bites its own tail
>         }
>         return root;
>     }
> 
> <quote who="Jan H. van der Ven">
> > Sorry my first response went out to you personally. Luckily the others did
> > not get my newbie response.
> > In the meantime i did some reading and coding and headstomping.
> >
> > My simplified statement parser now sometimes knows when it is dealing with
> > a table or a column but when i have a common construction like select
> > table.column from table my cpu rises to 100% even though my ambiguities on
> > this (there are 2 that I think do not matter) are resolved.
> >
> > I have attached my .g. The trouble is with the dbObject I think.
> >
> > The statement that's giving me headaches is: SELECT a.b from C (see how
> > far I am already ;-)
> >
> > Please advise.
> >
> > <quote who="Peggy Fieland">
> >> I use different token types in the parser, eg
> >>   SQL_E_COLUMN_NAME
> >>   SQL_E_TABLE_NAME
> >> usually in the case of column names, the actual name
> >> is a child of this node:
> >> Here is part of the column_name definition for one of
> >> the databases:
> >>
> >>  o0:schema_name DOT!
> >>             t0:table_name DOT! c0:column_name_ref
> >>             { ## = #([SQL_E_COLUMN_NAME,
> >> "COLUMN_NAME"], #c0, #t0, #o0); }
> >> ...
> >>
> >> --- "Jan H. van der Ven" <jhvdven@xs4all.nl> wrote:
> >>
> >>> Hi,
> >>>
> >>>
> >>> I am currently working on a SQL parser (we want to
> >>> support all databases,
> >>> but I am taking baby steps). I used the MS SQL
> >>> select statement from
> >>> Tomasz Jastrzebski that can be downloaded from
> >>> antlr.org. It checks my
> >>> statements ok, but that is not the only result I am
> >>> looking for.
> >>>
> >>> What I want is that after the parsing the tokens
> >>> contain extra information
> >>> about their syntactic nature. For instance, the
> >>> parser will find out that
> >>> a certain 'identifier' is actually a column and I
> >>> would like that
> >>> knowledge to become part of the token or the AST.
> >>>
> >>> I am new to all of this, so if this is something you
> >>> guys do all day
> >>> please let me know.
> >>>
> >>> If it is not, could you point me in the right
> >>> direction.
> >>>
> >>>
> >>> Kind regards,
> >>>
> >>>
> >>> Jan van der Ven
> >>>
> >>>
> >>
> >>
> >
> 
> 
> 

From pgonzalez at bluel.com  Thu Nov 17 09:16:12 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Thu Nov 17 09:16:17 2005
Subject: [antlr-interest] Island grammars in Antlr 2?
Message-ID: <437CBADC.1040608@bluel.com>

I need to parse something like this:

     block {
       block {
       }
       exec {
         freeform text
       }
     }

That is, I want to collect the raw text inside the "exec" block (i.e. 
[^}]*) and return it as a single token, which will be parsed by separately 
by a different grammar.  I know that this is addressed explicitly in Antlr 
3, but is it possible with Antlr 2?

Cheers,
-Pete
From fiid at fiid.net  Thu Nov 17 09:55:24 2005
From: fiid at fiid.net (Fiid Williams)
Date: Thu Nov 17 09:55:33 2005
Subject: [antlr-interest] Island grammars in Antlr 2?
In-Reply-To: <437CBADC.1040608@bluel.com>
References: <437CBADC.1040608@bluel.com>
Message-ID: <280E0736-7E7D-4125-BA1A-FDE8E1827ED6@fiid.net>

I did something like this for a Cisco IOS parser I am working on for  
the banner keyword.  Used in the following way

banner &
freeform banner text 1
freeform banner text 2
&

(so & is the delimiter, which can be any character).  It's a little  
ugly but:

"banner"  delim=one_token  {
             // eat tokens until the end of the banner.
             String delimchar = delim.getText().substring(0,1);
             while(true) {
                 Token t = LT(1);
                 if(t.getText().contains(delimchar)) {
                     break;
                 }
                 consume();
             }
             consume();
         };

You could concatenate the strings you get back from token t to get  
the full text of what's between the braces.  one_token matches  
everything except a newline (which is significant in my grammar.).

This might be a terrible solution - just throwing it out to see what  
people think.

Fiid.




On Nov 17, 2005, at 9:16 AM, Pete Gonzalez wrote:

> I need to parse something like this:
>
>     block {
>       block {
>       }
>       exec {
>         freeform text
>       }
>     }
>
> That is, I want to collect the raw text inside the "exec" block  
> (i.e. [^}]*) and return it as a single token, which will be parsed  
> by separately by a different grammar.  I know that this is  
> addressed explicitly in Antlr 3, but is it possible with Antlr 2?
>
> Cheers,
> -Pete
>
>

From parrt at cs.usfca.edu  Thu Nov 17 10:00:50 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Nov 17 10:01:13 2005
Subject: [antlr-interest] Island grammars in Antlr 2?
In-Reply-To: <437CBADC.1040608@bluel.com>
References: <437CBADC.1040608@bluel.com>
Message-ID: <CB9C85BF-9613-4050-B8D5-A0C151C8DFF9@cs.usfca.edu>

Hi Pete,

There is an example of java/javadoc in the distribution that should  
help.

Ter
From parrt at cs.usfca.edu  Thu Nov 17 10:04:14 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Nov 17 10:04:37 2005
Subject: [antlr-interest] syntactic predicates and exceptions
In-Reply-To: <437BFB0B.1020800@bluel.com>
References: <1129651947.28074@mx9.mysite4now.com>
	<437A7C40.2040402@bluel.com>	<6CF0EEC6-D366-49D0-B3F2-B1CDAD0CFFBB@cs.usfca.edu>	<437B7AC2.8040409@bluel.com>
	<D7586DAE-F427-4058-ADC4-29FB9AAFFB61@cs.usfca.edu>
	<437BFB0B.1020800@bluel.com>
Message-ID: <CAA65B0F-84C0-450D-A2BE-8E2FE5C7EE79@cs.usfca.edu>

On Nov 16, 2005, at 7:37 PM, Pete Gonzalez wrote:
> Terence Parr wrote:
>> The *LEXER* is backtracking?  Oh gawd, it will kill you.  See  
>> what  the java grammar does for matching numbers...I think it  
>> avoids them.   An exception per char is deadly.
>
> Thanks!  I tried the lexer from your Java grammar and this  
> eliminated the exceptions.  The improvement is significant:  0.406  
> secs outside of debugger (i.e. 48% of original), 0.456 secs in the  
> debugger (i.e. 0.8%!).  :-)

Hooray!

> FYI I noticed that Todd King recently posted an updated C# grammar  
> on the Antlr web site saying:
>
> "I designed this grammar for speed so I avoided using arbitrary  
> lookaheads where I could. I got it down to just 7 lookaheads."
>
> However, he is using the exact same lexer (from Robin Debreuil)  
> with backtracking.  I didn't see an e-mail address, but someone  
> should notify him about the technique used in your Java lexer.

I don't see his email anywhere so might be hard to contact him.

>> I'll be doing an auto-converter to 3.0.  Current version I just   
>> released is pretty usable if you ask me, but I'm going to try it  
>> out  on a real app soon to see if it does anything useful.  It  
>> crashes on  bad input at the moment etc...  I wouldn't bet my job  
>> on it yet ;)   3.0 eta will be next summer probably.
>
> I took a look at the 3.0 examples and this new design really does  
> "kick ass" to quote a PowerPoint slide.  I think you are doing some  
> genuinely innovative work, and I think your approach to the problem  
> is right on.  I'm really looking forward to this release, and will  
> give the "early access" build a try as soon as the C# codegen is in  
> place.  Anyway, thanks for your help!

My pleasure.  Thanks for the nice words.  I've been collecting ideas  
from people for years and forging them into a single coherent theme  
for v3.  Some of the stuff is really crazy cool like the rewrite from  
grammar to tree grammar for tree construction.  It's been a mad rush  
for 2.5 years, 3 by the time I finish.  With the addition of tools  
like ANTLRWorks and ANTLRStudio, I think making languages/data  
translators etc... will be much easier. :)

Ter
From pgonzalez at bluel.com  Thu Nov 17 10:08:47 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Thu Nov 17 10:08:52 2005
Subject: [antlr-interest] Island grammars in Antlr 2?
In-Reply-To: <280E0736-7E7D-4125-BA1A-FDE8E1827ED6@fiid.net>
References: <437CBADC.1040608@bluel.com>
	<280E0736-7E7D-4125-BA1A-FDE8E1827ED6@fiid.net>
Message-ID: <437CC72F.3040309@bluel.com>

Fiid Williams wrote:
> "banner"  delim=one_token  {
>             // eat tokens until the end of the banner.
>             String delimchar = delim.getText().substring(0,1);
>             while(true) {
>                 Token t = LT(1);
>                 if(t.getText().contains(delimchar)) {
>                     break;
>                 }
>                 consume();
>             }
>             consume();
>         };
> 
> You could concatenate the strings you get back from token t to get  the 
> full text of what's between the braces.  one_token matches  everything 
> except a newline (which is significant in my grammar.).

Interesting idea.  But with this approach I think parts of the text (e.g. 
comments and whitespace) will be discarded by the lexer.

I'm experimenting with another approach where a public flag controls a 
semantic predicate in the lexer -- the parser would set this flag when it 
is expecting the island token.   I'm not sure if it will work however, 
since other tokens could accidentally invoke the lexer as part of their 
lookahead.

Cheers,
-Pete
From ewbank at gmail.com  Thu Nov 17 12:35:45 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Nov 17 12:35:48 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <db9360ca0511170218r70443df8j@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
	<db9360ca0511170218r70443df8j@mail.gmail.com>
Message-ID: <dd3a065f0511171235w2095eeeu4c1a3352451873ed@mail.gmail.com>

> > Another way that is closer, perhaps, to what you are wanting,
> > is to write a production that duplicates a node (works only
> > with buildAST=true).
>
>  mmmmh, would you mind to give me an example ? I have some
>  difficulties to draw something wich approach your suggestion...

A production like this will generate an exactly duplicate of a
tree....

	// duplicate tree rooted at current node
	duptree: #( . ( duptree )* );

Or perhaps this, to reduce push/pop on the call stack by following
sibling chains in one function:

	// duplicate tree rooted at current node
	duptree: #( . duplist );
	duplist: ( #( . duplist ) )*;

When I am building a transformation pass, I usually start here,
and then start extending it for exceptions (e.g., "copy it everywhere,
except when ...").
From fiid at fiid.net  Thu Nov 17 12:49:30 2005
From: fiid at fiid.net (Fiid Williams)
Date: Thu Nov 17 12:49:40 2005
Subject: [antlr-interest] Island grammars in Antlr 2?
In-Reply-To: <437CC72F.3040309@bluel.com>
References: <437CBADC.1040608@bluel.com>
	<280E0736-7E7D-4125-BA1A-FDE8E1827ED6@fiid.net>
	<437CC72F.3040309@bluel.com>
Message-ID: <F5A85851-E229-4572-BB7D-755D8F97BDED@fiid.net>

Yup.  I don't need the banner information so I'm just tossing it, so  
spaces or anything else aren't on my list of things to try and  
understand.

I was wondering if it's possible to use the multiplexing lexer stuff  
to deal with cases like this and switch to another lexer for the  
piece in-between...  there are times where I may want to do that in  
my application since IOS doesn't have any reserved words and it also  
supports short versions of some of the literals.

Fiid.


On Nov 17, 2005, at 10:08 AM, Pete Gonzalez wrote:

> Fiid Williams wrote:
>> "banner"  delim=one_token  {
>>             // eat tokens until the end of the banner.
>>             String delimchar = delim.getText().substring(0,1);
>>             while(true) {
>>                 Token t = LT(1);
>>                 if(t.getText().contains(delimchar)) {
>>                     break;
>>                 }
>>                 consume();
>>             }
>>             consume();
>>         };
>> You could concatenate the strings you get back from token t to  
>> get  the full text of what's between the braces.  one_token  
>> matches  everything except a newline (which is significant in my  
>> grammar.).
>
> Interesting idea.  But with this approach I think parts of the text  
> (e.g. comments and whitespace) will be discarded by the lexer.
>
> I'm experimenting with another approach where a public flag  
> controls a semantic predicate in the lexer -- the parser would set  
> this flag when it is expecting the island token.   I'm not sure if  
> it will work however, since other tokens could accidentally invoke  
> the lexer as part of their lookahead.
>
> Cheers,
> -Pete
>
>

From software.au at gmail.com  Thu Nov 17 14:43:06 2005
From: software.au at gmail.com (software.au@gmail.com)
Date: Thu Nov 17 14:43:08 2005
Subject: [antlr-interest] Parsing complex languages like C++
Message-ID: <bee7fa0c0511171443i4585fdf5ibe290944708592ee@mail.gmail.com>

Does anyone know how to parse complex languages like C++?  Can it only
be done with significant hacks to an LALR or LR parser?  Can it be
done at all recursive descent?  Any type of algorithm that works for
this language, and other complex/difficult to parse languages?

Thanks,
James
From pgonzalez at bluel.com  Thu Nov 17 15:40:57 2005
From: pgonzalez at bluel.com (Pete Gonzalez)
Date: Thu Nov 17 15:41:02 2005
Subject: [antlr-interest] Parsing complex languages like C++
In-Reply-To: <bee7fa0c0511171443i4585fdf5ibe290944708592ee@mail.gmail.com>
References: <bee7fa0c0511171443i4585fdf5ibe290944708592ee@mail.gmail.com>
Message-ID: <437D1509.3000707@bluel.com>

software.au@gmail.com wrote:
> Does anyone know how to parse complex languages like C++?  Can it only
> be done with significant hacks to an LALR or LR parser?  Can it be
> done at all recursive descent?  Any type of algorithm that works for
> this language, and other complex/difficult to parse languages?

In order to tackle this problem, you need to obtain a utility called a "web 
browser".  It will enable you to access the following document:

http://www.antlr.org/grammar/list

Cheers,
-Pete
From jimi at temporal-wave.com  Thu Nov 17 19:13:54 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu Nov 17 19:15:57 2005
Subject: [antlr-interest] antlr and libtool
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
Message-ID: <B36CCC332A32904F8FA3DE134A23533608A4B9@wavemachine.temporal-wave.com>

 

________________________________

From: antlr-interest-bounces@antlr.org on behalf of Ric Klaren


> We had a built once with libtool but it sucked (think I kicked it out
> together with automake).

Amen brother. Both of these things are monstrosities, but libtool is an ill-thought-out abberation. We owe it to evolution theory to cull them from the gene pool.

Jim

From jimi at temporal-wave.com  Thu Nov 17 19:24:03 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu Nov 17 19:24:05 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
References: <000001c5e480$16b7fab0$0100a8c0@rexii>
Message-ID: <B36CCC332A32904F8FA3DE134A23533608A4BA@wavemachine.temporal-wave.com>

 

________________________________

From: antlr-interest-bounces@antlr.org on behalf of Geir Ove Skjaervik




> Hello,

> Just one more comment on this Bug. It is ** clearly ** a bug, since
> ANTLR does work correctly when BitSets are NOT used. 

Well, it could be just a limitation, perhaps catered for with a few tweaks, or perhaps better addressed with efforts in the Antlr 3 space.

>I find it strange
> that this Bug  seems to be passed in almost silence: I would think it to
> be rather serious to have a "sleeping" bug that may come and bite you
> any time you encounter the right conditions.

> Terrence asked me to try to produce a small grammar example to try to
> reproduce the problem. I will as soon as time on my project permits it.

Hmmm - I thought you said it was a serious bug? Can't be THAT serious can it? ;-) 

> BUT I would think it is equally IMPORTANT for the ANTLR team to try to
> hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under
> development, but we sure need a strong ** core ** technology that won't
> fail.

Well, the last time I was there I noticed that beer and pizza were significantly more expensive in San Francsico than most other parts of the world except Geneva. I am sure that donating a few vouchers for same would make this bug very much more important. Remember that it is free (for you anyway) and we should be careful to give out a bit of respect for people's time and efforts given freely :-).

Jim

From duboimat at iro.umontreal.ca  Thu Nov 17 22:50:02 2005
From: duboimat at iro.umontreal.ca (duboimat@iro.umontreal.ca)
Date: Thu Nov 17 22:50:05 2005
Subject: [antlr-interest] Antlr and string template
Message-ID: <20051118015002.d2tmajzzcokwcckg@webmail.iro.umontreal.ca>

I am looking for some examples to take a AST tree created by antlr and using
string template engine.
How can I can generate code with string template model and a AST antlr tree?

thank you,
Mat


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
From geiroves at online.no  Thu Nov 17 23:13:01 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Thu Nov 17 23:13:09 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <B36CCC332A32904F8FA3DE134A23533608A4BA@wavemachine.temporal-wave.com>
Message-ID: <000501c5ec0f$8497e9a0$0100a8c0@rexii>

Hello,

Are we supposed to take this kind of feedback seriously? You may make
fun of other peoples problems, but does this kind of feedback belong
here?

You clearly do not understand the nature of the problem, or you would
not have replied the way you do; and when you do not udnerstand, why
don't you refreain from replying?

a) Switching to 3.x is NOT an option after having written about 5000
lines of Parser and Tree Parser code

b) If it is a limitation, ANTLR should warn you about that. 

c) The workaround means avoiding BitSets alltogehter for ** everyone **.
As long as we (programmers and the ANTLR developemnt team) does NOT
understand the nature of the problem, then we do NOT know when this bug
strikes!

d) Avoiding BitSets all the time means two things: 
   i) Performance takes a big hit
   ii) Why are they there if all they can do is pose a BIG problem in
unknown situations




Geir Ove


Geir Ove

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Jim Idle
Sent: 18. november 2005 04:24
To: ANTLR Interest
Subject: RE: [antlr-interest] Serious Bug when using BitSetgeneration


 

________________________________

From: antlr-interest-bounces@antlr.org on behalf of Geir Ove Skjaervik


Jim Idle wrote:

> Hello,

> Just one more comment on this Bug. It is ** clearly ** a bug, since 
> ANTLR does work correctly when BitSets are NOT used.

Well, it could be just a limitation, perhaps catered for with a few
tweaks, or perhaps better addressed with efforts in the Antlr 3 space.

>I find it strange
> that this Bug  seems to be passed in almost silence: I would think it 
>to  be rather serious to have a "sleeping" bug that may come and bite 
>you  any time you encounter the right conditions.

> Terrence asked me to try to produce a small grammar example to try to 
> reproduce the problem. I will as soon as time on my project permits 
> it.

Hmmm - I thought you said it was a serious bug? Can't be THAT serious
can it? ;-) 

> BUT I would think it is equally IMPORTANT for the ANTLR team to try to

> hunt down this ** serious ** bug. It is nice that ANTLR 3.0 is under 
> development, but we sure need a strong ** core ** technology that 
> won't fail.

Well, the last time I was there I noticed that beer and pizza were
significantly more expensive in San Francsico than most other parts of
the world except Geneva. I am sure that donating a few vouchers for same
would make this bug very much more important. Remember that it is free
(for you anyway) and we should be careful to give out a bit of respect
for people's time and efforts given freely :-).

Jim



From mathieu.clabaut at gmail.com  Fri Nov 18 01:00:27 2005
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Fri Nov 18 01:00:30 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <dd3a065f0511171235w2095eeeu4c1a3352451873ed@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
	<db9360ca0511170218r70443df8j@mail.gmail.com>
	<dd3a065f0511171235w2095eeeu4c1a3352451873ed@mail.gmail.com>
Message-ID: <db9360ca0511180100yd82eae9s@mail.gmail.com>

On 17/11/05, Bryan Ewbank <ewbank@gmail.com> wrote:
> > > Another way that is closer, perhaps, to what you are wanting,
> > > is to write a production that duplicates a node (works only
> > > with buildAST=true).
> A production like this will generate an exactly duplicate of a
> tree....
>
>         // duplicate tree rooted at current node
>         duptree: #( . ( duptree )* );

 Mhhh, I may be dumb, but I do not understand the rule. What does the
dot stand for ?

Thank you for your help.

-mathieu

--
____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
           F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
From gt54-antlr at cyconix.com  Fri Nov 18 01:20:27 2005
From: gt54-antlr at cyconix.com (Paul Johnson)
Date: Fri Nov 18 01:20:34 2005
Subject: [antlr-interest] Parsing complex languages like C++
In-Reply-To: <bee7fa0c0511171443i4585fdf5ibe290944708592ee@mail.gmail.com>
References: <bee7fa0c0511171443i4585fdf5ibe290944708592ee@mail.gmail.com>
Message-ID: <437D9CDB.7020200@cyconix.com>

software.au@gmail.com wrote:
> Does anyone know how to parse complex languages like C++?  Can it only
> be done with significant hacks to an LALR or LR parser?  Can it be
> done at all recursive descent?  Any type of algorithm that works for
> this language, and other complex/difficult to parse languages?

g++ is still, I think, LALR(1). They switched from Bison to a hand-coded 
recursive-descent parser sometime around 3.3, and it made a vast 
improvement in the language conformance.

I can't immediately see that using LR makes it intrinsically difficult 
to parse C++, but I haven't tried it. The gcc team did blame a lot of 
bugs on Bison, but I think that's probably just down to Bison's 
shortcomings. In particular, I think a much tighter coupling between 
Bison and Flex would make it a lot more useful and generally applicable.

Bison has been GLR for a couple of years at least; it supports unlimited 
(?) lookahead.

Paul

From mail at martin-probst.com  Fri Nov 18 01:40:40 2005
From: mail at martin-probst.com (Martin Probst)
Date: Fri Nov 18 01:40:44 2005
Subject: [antlr-interest] antlr and libtool
In-Reply-To: <B36CCC332A32904F8FA3DE134A23533608A4B9@wavemachine.temporal-wave.com>
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
	<B36CCC332A32904F8FA3DE134A23533608A4B9@wavemachine.temporal-wave.com>
Message-ID: <1132306840.9389.1.camel@localhost.localdomain>

Hi,

> > We had a built once with libtool but it sucked (think I kicked it out
> > together with automake).
> 
> Amen brother. Both of these things are monstrosities, but libtool is an ill-thought-out abberation. We owe it to evolution theory to cull them from the gene pool.

As someone from Java-Land who has had some, limited, experience with C/
C++ Make systems and the tool environment around that, I still wonder
how people manage to actually produce working applications without
spending 50% of the time on making the build work ...

Martin

From sohail at taggedtype.net  Fri Nov 18 01:48:21 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Fri Nov 18 01:48:30 2005
Subject: [antlr-interest] antlr and libtool
In-Reply-To: <1132306840.9389.1.camel@localhost.localdomain>
References: <436F4E68.4090608@free.fr> <437090C9.4020409@gmail.com>
	<B36CCC332A32904F8FA3DE134A23533608A4B9@wavemachine.temporal-wave.com>
	<1132306840.9389.1.camel@localhost.localdomain>
Message-ID: <1132307301.18126.0.camel@localhost.localdomain>

On Fri, 2005-18-11 at 10:40 +0100, Martin Probst wrote:
> Hi,
> 
> > > We had a built once with libtool but it sucked (think I kicked it out
> > > together with automake).
> > 
> > Amen brother. Both of these things are monstrosities, but libtool is an ill-thought-out abberation. We owe it to evolution theory to cull them from the gene pool.
> 
> As someone from Java-Land who has had some, limited, experience with C/
> C++ Make systems and the tool environment around that, I still wonder
> how people manage to actually produce working applications without
> spending 50% of the time on making the build work ...

Hey, hey make is good. autohell is bad.

From ga-fries at veenendaalnet.nl  Fri Nov 18 07:24:22 2005
From: ga-fries at veenendaalnet.nl (Jos Fries)
Date: Fri Nov 18 07:21:04 2005
Subject: [antlr-interest] Treeparser inheritance?
References: <001f01c5e939$bd962ab0$0b01a8c0@altb><DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu><002b01c5e954$83731850$0b01a8c0@altb>
	<6EA52A2E-ECD9-45C7-B0F8-7350086B8CD9@cs.usfca.edu>
Message-ID: <03e201c5ec54$27093510$0b01a8c0@altb>

Terence wrote:

> Oh, sorry.  Now I remember.  Inheritance is an "include".  The  
> implementation says it inherits from the tree parser, but you'll see  
> all your overridden rules inside. :)
> 
> Ter

I see what you mean but it doesn't function for me... I'll get more concrete. I have a simple AST for predicate expressions:

class PredicateTreeWalker extends TreeParser;

expr returns [ String s ]
{ String e1, e2 = new String (); s = new String (); }
: #(FORALL v1:VPSNAME c1:VPSNAME e1=expr) { s = "forAll (" + v1 + ", " + c1 + ", " + e1 + ")"; }
| #(EXISTS v2:VPSNAME c2:VPSNAME e2=expr) { s = "exists (" + v2 + ", " + c1 + ", " + e2 + ")"; } 
| #(OR e1=expr e2=expr) { s = e1 + " + " + e2; }
| #(AND e1=expr e2=expr) { s = e1 + " * " + e2; }
| #(LPAREN e1=expr) { s = "( " + e1 + " )"; }
| #(NOT e1=expr) { s = ".N. " + e1; }
| n:VPSNAME { s = n.getText (); };

Now I would like to extend this AST with an assignment statement:

class StateExprTreeWalker extends PredicateTreeWalker;
options { importVocab = PredicateLexer; }

expr returns [ String s ]
{ String e1 = new String(); s = new String (); }
: #(EQUALS v1:VPSNAME e1=expr) { s = v1 + " = " + e1; }
;

The generated class StateExprTreeWalker only contains its own actions. How can I get it to contain also the actions from PredicateTreeWalker?

Regards,

Jos

----- Original Message ----- 
From: "Terence Parr" <parrt@cs.usfca.edu>
To: "ANTLR Interest" <antlr-interest@antlr.org>
Sent: Monday, November 14, 2005 9:06 PM
Subject: Re: [antlr-interest] Treeparser inheritance?


> Oh, sorry.  Now I remember.  Inheritance is an "include".  The  
> implementation says it inherits from the tree parser, but you'll see  
> all your overridden rules inside. :)
> 
> Ter
> On Nov 14, 2005, at 11:49 AM, Jos Fries wrote:
> 
>> Hi Terrence,
>>
>> Could you point me to an example in which a tree parser in a  
>> subgrammar inherits from the tree parser in the supergrammer? I  
>> searched in vain for that use of inheritance in the reference  
>> manual...
>>
>> Regards,
>>
>> Jos
>>
>>
>>>
>>> On Nov 14, 2005, at 8:37 AM, Jos Fries wrote:
>>>
>>>> Hi,
>>>>
>>>> Last weekend I experimented with grammar inheritance. I   
>>>> successfully extended a lexer and a parser. Extending my tree   
>>>> parser however failed. My statement "class BTreeWalker extends   
>>>> ATreeWalker;" is accepted by ANTLR but compiled to the Java code   
>>>> "public class BTreeWalker extends antlr.TreeParser".
>>>>
>>>> Excuse the newbie character of the question, but does the  
>>>> concept  of grammar inheritance also apply to tree parsers? The   
>>>> documentation doesn't state anything about this. I'm using antlr   
>>>> 2.7.4.
>>>
>>> Hi Jos, it should work as you describe.  Are you sure you're doing  
>>> it just like in the examples?
>>>
>>> Terence
>>>
>>>
>>>
>>>
>>> -- 
>>> No virus found in this incoming message.
>>> Checked by AVG Free Edition.
>>> Version: 7.1.362 / Virus Database: 267.13.0/167 - Release Date:  
>>> 11-11-2005
>>>
>>
> 
> 
> 
> 
> -- 
> No virus found in this incoming message.
> Checked by AVG Free Edition.
> Version: 7.1.362 / Virus Database: 267.13.0/167 - Release Date: 11-11-2005
> 
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051118/5504d017/attachment.html
From parrt at cs.usfca.edu  Fri Nov 18 08:12:10 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov 18 08:12:15 2005
Subject: [antlr-interest] Treeparser inheritance?
In-Reply-To: <03e201c5ec54$27093510$0b01a8c0@altb>
References: <001f01c5e939$bd962ab0$0b01a8c0@altb><DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu><002b01c5e954$83731850$0b01a8c0@altb>
	<6EA52A2E-ECD9-45C7-B0F8-7350086B8CD9@cs.usfca.edu>
	<03e201c5ec54$27093510$0b01a8c0@altb>
Message-ID: <A3B1490A-E7F5-43BA-90DB-AFC3C77E90E2@cs.usfca.edu>


On Nov 18, 2005, at 7:24 AM, Jos Fries wrote:
> class PredicateTreeWalker extends TreeParser;
>
> expr returns [ String s ]
> { String e1, e2 = new String (); s = new String (); }
> : #(FORALL v1:VPSNAME c1:VPSNAME e1=expr) { s = "forAll (" + v1 +  
> ", " + c1 + ", " + e1 + ")"; }
> | #(EXISTS v2:VPSNAME c2:VPSNAME e2=expr) { s = "exists (" + v2 +  
> ", " + c1 + ", " + e2 + ")"; }
> | #(OR e1=expr e2=expr) { s = e1 + " + " + e2; }
> | #(AND e1=expr e2=expr) { s = e1 + " * " + e2; }
> | #(LPAREN e1=expr) { s = "( " + e1 + " )"; }
> | #(NOT e1=expr) { s = ".N. " + e1; }
> | n:VPSNAME { s = n.getText (); };
>
> Now I would like to extend this AST with an assignment statement:
>
> class StateExprTreeWalker extends PredicateTreeWalker;
> options { importVocab = PredicateLexer; }
>
> expr returns [ String s ]
> { String e1 = new String(); s = new String (); }
> : #(EQUALS v1:VPSNAME e1=expr) { s = v1 + " = " + e1; }
> ;
>
> The generated class StateExprTreeWalker only contains its own  
> actions. How can I get it to contain also the actions from  
> PredicateTreeWalker?

You have overridden rule expr so it doesn't contain the original.  It  
mirrors how method overriding workings too.  You cannot bring in just  
a few alts from above.  Sorry.
Ter
From ewbank at gmail.com  Fri Nov 18 08:25:32 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Nov 18 08:25:34 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <db9360ca0511180100yd82eae9s@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
	<db9360ca0511170218r70443df8j@mail.gmail.com>
	<dd3a065f0511171235w2095eeeu4c1a3352451873ed@mail.gmail.com>
	<db9360ca0511180100yd82eae9s@mail.gmail.com>
Message-ID: <dd3a065f0511180825g4a8cccf5x83949b3a59cbafea@mail.gmail.com>

No dumb questions, just different experiences...

On 11/18/05, Mathieu Clabaut <mathieu.clabaut@gmail.com> wrote:
> .
> > A production like this will generate an exactly duplicate of a
> > tree....
> >
> >         // duplicate tree rooted at current node
> >         duptree: #( . ( duptree )* );
>
> What does the dot stand for ?

"." means "match anything here", so #( . (duptree)* ) means

-- match any node (the ".") as the root of the tree (first token in a
"#( )" list).
-- match zero or more children (the "*") with the rule "duptree"
From ewbank at gmail.com  Fri Nov 18 08:39:03 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Nov 18 08:39:05 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000501c5ec0f$8497e9a0$0100a8c0@rexii>
References: <B36CCC332A32904F8FA3DE134A23533608A4BA@wavemachine.temporal-wave.com>
	<000501c5ec0f$8497e9a0$0100a8c0@rexii>
Message-ID: <dd3a065f0511180839x4cd249e8i2622e2ef144fe150@mail.gmail.com>

Let's back up a bit here, please...

We all agree that bugs are bad.  This BitSet stuff is a potential bug.
I've changed my production 2.x ANTLR code to avoid them where possible,
and I'm sure others have as well.

I would encourage you and others that do have time, or other motivation,
to continue exploring the bug and figuring out exactly what's happening,
and when.

A few months ago I would have eagerly attacked this once a good
reproduceable testcase was available.  Now, I cannot.  It's that simple.

I also think that we all understand that ANTLR is open source, and that
people have other things calling them.

What we should not expect is that there are people available to help at
the drop of a hat; there may be some, certainly, but there may not at a
particular time, either.  That's a risk.

On 11/18/05, Geir Ove Skjaervik <geiroves@online.no> wrote:
> c) The workaround means avoiding BitSets alltogehter for ** everyone **.
> As long as we (programmers and the ANTLR developemnt team) does NOT
> understand the nature of the problem, then we do NOT know when this bug
> strikes!
>
> d) Avoiding BitSets all the time means two things: i) Performance takes
> a big hit ii) Why are they there if all they can do is pose a BIG
> problem in unknown situations
From mathieu.clabaut at gmail.com  Fri Nov 18 08:40:30 2005
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Fri Nov 18 08:40:36 2005
Subject: [antlr-interest] About tree duplication ?
In-Reply-To: <dd3a065f0511180825g4a8cccf5x83949b3a59cbafea@mail.gmail.com>
References: <db9360ca0511170148q648486a4u@mail.gmail.com>
	<dd3a065f0511170155r1c7bcf34m6d4a9ec41564b15@mail.gmail.com>
	<db9360ca0511170218r70443df8j@mail.gmail.com>
	<dd3a065f0511171235w2095eeeu4c1a3352451873ed@mail.gmail.com>
	<db9360ca0511180100yd82eae9s@mail.gmail.com>
	<dd3a065f0511180825g4a8cccf5x83949b3a59cbafea@mail.gmail.com>
Message-ID: <db9360ca0511180840u6590ed56g@mail.gmail.com>

On 18/11/05, Bryan Ewbank <ewbank@gmail.com> wrote:
> No dumb questions, just different experiences...

 :-) thank you !

> > >         duptree: #( . ( duptree )* );
> > What does the dot stand for ?
> "." means "match anything here", so #( . (duptree)* ) means

  Ok, It's the first time I've seen that construction. It may prove
very useful.
  I'll give a try at your solution immediately.

 Thanks !

-mathieu



--
____________http://www.gnu.org/philosophy/no-word-attachments.fr.html
Mathieu CLABAUT                         mailto:mathieu.clabaut@gmail.com
           F2F5 442F F2AC E1D5 9D31  3EFC 842A BC4A 123B 9A65
From ga-fries at veenendaalnet.nl  Fri Nov 18 08:58:00 2005
From: ga-fries at veenendaalnet.nl (Jos Fries)
Date: Fri Nov 18 08:54:43 2005
Subject: [antlr-interest] Treeparser inheritance?
References: <001f01c5e939$bd962ab0$0b01a8c0@altb><DA4EDDAA-B8EB-486C-A142-F3BF3D86D2D7@cs.usfca.edu><002b01c5e954$83731850$0b01a8c0@altb><6EA52A2E-ECD9-45C7-B0F8-7350086B8CD9@cs.usfca.edu><03e201c5ec54$27093510$0b01a8c0@altb>
	<A3B1490A-E7F5-43BA-90DB-AFC3C77E90E2@cs.usfca.edu>
Message-ID: <041801c5ec61$3bb1fb70$0b01a8c0@altb>

Ofcause! I renamed the second rule and it now works as expected. Thanks for 
you help!

Jos
----- Original Message ----- 
From: "Terence Parr" <parrt@cs.usfca.edu>
To: "antlr-interest Interest" <antlr-interest@antlr.org>
Sent: Friday, November 18, 2005 5:12 PM
Subject: Re: [antlr-interest] Treeparser inheritance?


>
> On Nov 18, 2005, at 7:24 AM, Jos Fries wrote:
>> class PredicateTreeWalker extends TreeParser;
>>
>> expr returns [ String s ]
>> { String e1, e2 = new String (); s = new String (); }
>> : #(FORALL v1:VPSNAME c1:VPSNAME e1=expr) { s = "forAll (" + v1 +  ", " + 
>> c1 + ", " + e1 + ")"; }
>> | #(EXISTS v2:VPSNAME c2:VPSNAME e2=expr) { s = "exists (" + v2 +  ", " + 
>> c1 + ", " + e2 + ")"; }
>> | #(OR e1=expr e2=expr) { s = e1 + " + " + e2; }
>> | #(AND e1=expr e2=expr) { s = e1 + " * " + e2; }
>> | #(LPAREN e1=expr) { s = "( " + e1 + " )"; }
>> | #(NOT e1=expr) { s = ".N. " + e1; }
>> | n:VPSNAME { s = n.getText (); };
>>
>> Now I would like to extend this AST with an assignment statement:
>>
>> class StateExprTreeWalker extends PredicateTreeWalker;
>> options { importVocab = PredicateLexer; }
>>
>> expr returns [ String s ]
>> { String e1 = new String(); s = new String (); }
>> : #(EQUALS v1:VPSNAME e1=expr) { s = v1 + " = " + e1; }
>> ;
>>
>> The generated class StateExprTreeWalker only contains its own  actions. 
>> How can I get it to contain also the actions from  PredicateTreeWalker?
>
> You have overridden rule expr so it doesn't contain the original.  It 
> mirrors how method overriding workings too.  You cannot bring in just  a 
> few alts from above.  Sorry.
> Ter
>
>
>
> -- 
> No virus found in this incoming message.
> Checked by AVG Free Edition.
> Version: 7.1.362 / Virus Database: 267.13.3/174 - Release Date: 17-11-2005
>
> 

From parrt at cs.usfca.edu  Fri Nov 18 09:49:04 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov 18 09:49:23 2005
Subject: [antlr-interest] Antlr and string template
In-Reply-To: <20051118015002.d2tmajzzcokwcckg@webmail.iro.umontreal.ca>
References: <20051118015002.d2tmajzzcokwcckg@webmail.iro.umontreal.ca>
Message-ID: <F0F61148-BE62-4A23-A11C-37F3A22D48C4@cs.usfca.edu>

On Nov 17, 2005, at 10:50 PM, duboimat@iro.umontreal.ca wrote:
> I am looking for some examples to take a AST tree created by antlr  
> and using
> string template engine.
> How can I can generate code with string template model and a AST  
> antlr tree?

Hi.  You'll have an example soon as I intend to build a pretty  
printer.  I will do it in v3 though not v2. :(  Sorry I don't have a  
ready example...

Ter
From gudnabrsam at yahoo.com  Fri Nov 18 10:48:41 2005
From: gudnabrsam at yahoo.com (Matt Benson)
Date: Fri Nov 18 10:48:45 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <dd3a065f0511180839x4cd249e8i2622e2ef144fe150@mail.gmail.com>
Message-ID: <20051118184842.26112.qmail@web30904.mail.mud.yahoo.com>

--- Bryan Ewbank <ewbank@gmail.com> wrote:
[SNIP]
> What we should not expect is that there are people
> available to help at
> the drop of a hat; there may be some, certainly, but
> there may not at a
> particular time, either.  That's a risk.

One of the most attractive things about open-source
IMHO is that a capable developer has all the resources
needed to go in himself and figure out what the hell
is going on; you're not at the mercy of the vendor of
a proprietary tool.  Thus it's all a matter of
perspective.  If guaranteed support is what you need
maybe ANTLR isn't the tool for you.

$0.02
-Matt



		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com
From parrt at cs.usfca.edu  Fri Nov 18 11:42:39 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov 18 11:42:58 2005
Subject: [antlr-interest] specifying actions in v3
Message-ID: <1A526EE6-8193-4448-9679-A3A623033754@cs.usfca.edu>

hi.  I've updated the Nov 18th entry to have more Stringtemplate  
integration stuff and to include information on including header  
actions, parser/lexer instance actions, rule init actions etc...

http://www.antlr.org/blog/antlr3/rewrite.tml

Further, it discusses overriding codegen templates easily. :)  For  
example, to override how tokens are matched, just add this to the  
bottom of the grammar:

codegen {
/** Override how tokens are matched to print out tracing info */
tokenRef(token,label,elementIndex) ::= <<
System.out.println("about to match token <token>");
<super.tokenRef(...)> <! do normal behavior !>
 >>
}

All that w/o recompiling antlr or anything complicated.

I think that something like this will be cool.

Ter
From virtualaspirin at yahoo.com  Fri Nov 18 12:30:26 2005
From: virtualaspirin at yahoo.com (Akhilesh Mritunjai)
Date: Fri Nov 18 12:30:28 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000501c5ec0f$8497e9a0$0100a8c0@rexii>
Message-ID: <20051118203026.46634.qmail@web30808.mail.mud.yahoo.com>

Geir

I've been using ANTLR a bit longer than you, and my
perception is different.

If you're a developer with any significant experience
I'd expect you to know the basics of QA process.

While logging a bug one is supposed to give
description of the problem with a test case in which
bug is at least sometimes reproducible.

This has been iterated again and again, many people
think it is an interesting and priority bug, *if* it
infact exists. So far you have not provided any inputs
to demonstrate it is there!

Understand that its hard to look for a something if
you dont even know how it looks like or if its infact
there.

Oh, and taking people who work for nothing and provide
a tool of this quality, for granted, *is NOT polite*.
If you can't invest time to come up with a testcase
how do you expect people to spend their time hunting
down something that may or may not be there just
because someone sent a feedback 'hey I think its
there!'


- Akhilesh

--- Geir Ove Skjaervik <geiroves@online.no> wrote:

> Hello,
> 
> Are we supposed to take this kind of feedback
> seriously? You may make
> fun of other peoples problems, but does this kind of
> feedback belong
> here?
> 
> You clearly do not understand the nature of the
> problem, or you would
> not have replied the way you do; and when you do not
> udnerstand, why
> don't you refreain from replying?
> 
> a) Switching to 3.x is NOT an option after having
> written about 5000
> lines of Parser and Tree Parser code
> 
> b) If it is a limitation, ANTLR should warn you
> about that. 
> 
> c) The workaround means avoiding BitSets alltogehter
> for ** everyone **.
> As long as we (programmers and the ANTLR developemnt
> team) does NOT
> understand the nature of the problem, then we do NOT
> know when this bug
> strikes!
> 
> d) Avoiding BitSets all the time means two things: 
>    i) Performance takes a big hit
>    ii) Why are they there if all they can do is pose
> a BIG problem in
> unknown situations
> 
> 
> 
> 
> Geir Ove
> 
> 
> Geir Ove
> 
> -----Original Message-----
> From: antlr-interest-bounces@antlr.org
> [mailto:antlr-interest-bounces@antlr.org] On Behalf
> Of Jim Idle
> Sent: 18. november 2005 04:24
> To: ANTLR Interest
> Subject: RE: [antlr-interest] Serious Bug when using
> BitSetgeneration
> 
> 
>  
> 
> ________________________________
> 
> From: antlr-interest-bounces@antlr.org on behalf of
> Geir Ove Skjaervik
> 
> 
> Jim Idle wrote:
> 
> > Hello,
> 
> > Just one more comment on this Bug. It is **
> clearly ** a bug, since 
> > ANTLR does work correctly when BitSets are NOT
> used.
> 
> Well, it could be just a limitation, perhaps catered
> for with a few
> tweaks, or perhaps better addressed with efforts in
> the Antlr 3 space.
> 
> >I find it strange
> > that this Bug  seems to be passed in almost
> silence: I would think it 
> >to  be rather serious to have a "sleeping" bug that
> may come and bite 
> >you  any time you encounter the right conditions.
> 
> > Terrence asked me to try to produce a small
> grammar example to try to 
> > reproduce the problem. I will as soon as time on
> my project permits 
> > it.
> 
> Hmmm - I thought you said it was a serious bug?
> Can't be THAT serious
> can it? ;-) 
> 
> > BUT I would think it is equally IMPORTANT for the
> ANTLR team to try to
> 
> > hunt down this ** serious ** bug. It is nice that
> ANTLR 3.0 is under 
> > development, but we sure need a strong ** core **
> technology that 
> > won't fail.
> 
> Well, the last time I was there I noticed that beer
> and pizza were
> significantly more expensive in San Francsico than
> most other parts of
> the world except Geneva. I am sure that donating a
> few vouchers for same
> would make this bug very much more important.
> Remember that it is free
> (for you anyway) and we should be careful to give
> out a bit of respect
> for people's time and efforts given freely :-).
> 
> Jim
> 
> 
> 
> 



		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com
From geiroves at online.no  Fri Nov 18 13:15:25 2005
From: geiroves at online.no (Geir Ove Skjaervik)
Date: Fri Nov 18 13:15:39 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <20051118203026.46634.qmail@web30808.mail.mud.yahoo.com>
Message-ID: <000101c5ec85$3420d6a0$0100a8c0@rexii>

Hello,

Obviosuly you haven't read my previous postings on this: I have said
that I will post an example of the problem WHEN I am able to produce a
small case that shows the problem and WHEN I have the time for it on my
project: My clients are NOT paying me to post bug reports to you. Surely
you know how that works.

Who said I am taking the ANTLR team for gratnted ? As a matter of fact,
I have on several occasions thanked Terrence for bringing this great
tool to the community.

However, none of this fixes the bug. It is wasted bandwith on this
forum.


Geir Ove

-----Original Message-----
From: Akhilesh Mritunjai [mailto:virtualaspirin@yahoo.com] 
Sent: 18. november 2005 21:30
To: Geir Ove Skjaervik; 'ANTLR Interest'
Subject: RE: [antlr-interest] Serious Bug when using BitSetgeneration


Geir

I've been using ANTLR a bit longer than you, and my
perception is different.

If you're a developer with any significant experience
I'd expect you to know the basics of QA process.

While logging a bug one is supposed to give
description of the problem with a test case in which
bug is at least sometimes reproducible.

This has been iterated again and again, many people
think it is an interesting and priority bug, *if* it
infact exists. So far you have not provided any inputs
to demonstrate it is there!

Understand that its hard to look for a something if
you dont even know how it looks like or if its infact
there.

Oh, and taking people who work for nothing and provide
a tool of this quality, for granted, *is NOT polite*.
If you can't invest time to come up with a testcase
how do you expect people to spend their time hunting
down something that may or may not be there just
because someone sent a feedback 'hey I think its
there!'


- Akhilesh

--- Geir Ove Skjaervik <geiroves@online.no> wrote:

> Hello,
> 
> Are we supposed to take this kind of feedback
> seriously? You may make
> fun of other peoples problems, but does this kind of
> feedback belong
> here?
> 
> You clearly do not understand the nature of the
> problem, or you would
> not have replied the way you do; and when you do not udnerstand, why
> don't you refreain from replying?
> 
> a) Switching to 3.x is NOT an option after having
> written about 5000
> lines of Parser and Tree Parser code
> 
> b) If it is a limitation, ANTLR should warn you
> about that.
> 
> c) The workaround means avoiding BitSets alltogehter
> for ** everyone **.
> As long as we (programmers and the ANTLR developemnt
> team) does NOT
> understand the nature of the problem, then we do NOT
> know when this bug
> strikes!
> 
> d) Avoiding BitSets all the time means two things: 
>    i) Performance takes a big hit
>    ii) Why are they there if all they can do is pose
> a BIG problem in
> unknown situations
> 
> 
> 
> 
> Geir Ove
> 
> 
> Geir Ove
> 
> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Jim Idle
> Sent: 18. november 2005 04:24
> To: ANTLR Interest
> Subject: RE: [antlr-interest] Serious Bug when using
> BitSetgeneration
> 
> 
>  
> 
> ________________________________
> 
> From: antlr-interest-bounces@antlr.org on behalf of
> Geir Ove Skjaervik
> 
> 
> Jim Idle wrote:
> 
> > Hello,
> 
> > Just one more comment on this Bug. It is **
> clearly ** a bug, since
> > ANTLR does work correctly when BitSets are NOT
> used.
> 
> Well, it could be just a limitation, perhaps catered
> for with a few
> tweaks, or perhaps better addressed with efforts in
> the Antlr 3 space.
> 
> >I find it strange
> > that this Bug  seems to be passed in almost
> silence: I would think it
> >to  be rather serious to have a "sleeping" bug that
> may come and bite
> >you  any time you encounter the right conditions.
> 
> > Terrence asked me to try to produce a small
> grammar example to try to
> > reproduce the problem. I will as soon as time on
> my project permits
> > it.
> 
> Hmmm - I thought you said it was a serious bug?
> Can't be THAT serious
> can it? ;-)
> 
> > BUT I would think it is equally IMPORTANT for the
> ANTLR team to try to
> 
> > hunt down this ** serious ** bug. It is nice that
> ANTLR 3.0 is under
> > development, but we sure need a strong ** core **
> technology that
> > won't fail.
> 
> Well, the last time I was there I noticed that beer
> and pizza were
> significantly more expensive in San Francsico than
> most other parts of
> the world except Geneva. I am sure that donating a
> few vouchers for same
> would make this bug very much more important.
> Remember that it is free
> (for you anyway) and we should be careful to give
> out a bit of respect
> for people's time and efforts given freely :-).
> 
> Jim
> 
> 
> 
> 



		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com


From sohail at taggedtype.net  Fri Nov 18 19:01:20 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Fri Nov 18 19:01:28 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000101c5ec85$3420d6a0$0100a8c0@rexii>
References: <000101c5ec85$3420d6a0$0100a8c0@rexii>
Message-ID: <1132369281.8288.1.camel@localhost.localdomain>

On Fri, 2005-18-11 at 22:15 +0100, Geir Ove Skjaervik wrote:
> Hello,
> 
> Obviosuly you haven't read my previous postings on this: I have said
> that I will post an example of the problem WHEN I am able to produce a
> small case that shows the problem and WHEN I have the time for it on my
> project: My clients are NOT paying me to post bug reports to you. Surely
> you know how that works.
> 
> Who said I am taking the ANTLR team for gratnted ? As a matter of fact,
> I have on several occasions thanked Terrence for bringing this great
> tool to the community.
> 
> However, none of this fixes the bug. It is wasted bandwith on this
> forum.

Dude, just take it easy. Atleast be glad you found the bug during development, even if you can't reproduce it *and* you have a workaround (iirc). The kinds of bugs that really suck are the ones that require upgrades and no workarounds.

From ewbank at gmail.com  Fri Nov 18 19:22:29 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Nov 18 19:22:32 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
In-Reply-To: <000101c5ec85$3420d6a0$0100a8c0@rexii>
References: <20051118203026.46634.qmail@web30808.mail.mud.yahoo.com>
	<000101c5ec85$3420d6a0$0100a8c0@rexii>
Message-ID: <dd3a065f0511181922v67dfb0b0w487ab116c1d2f1c9@mail.gmail.com>

Yes, that is EXACTLY how it works, and I think this is really the key.
 Yes, there is weird/wrong behavior.  it's a bug somewhere; perhaps in
ANTLR, perhaps somewhere else (java version, mistranslation, ...)

It's marked, such as it is, as "waiting for input (can not
reproduce)".  WHEN that input is delivered, THEN folks might be able
to make progress.  There may be progress made in the meantime, but
without that input the odds are not very good.  It's exactly the
process described.   No more, and no less, than what I'd expect from a
customer that is reporting some bug that is not generally
reproducable.

On 11/18/05, Geir Ove Skjaervik <geiroves@online.no> wrote:
> Obviosuly you haven't read my previous postings on this: I have said
> that I will post an example of the problem WHEN I am able to produce a
> small case that shows the problem and WHEN I have the time for it on my
> project: My clients are NOT paying me to post bug reports to you. Surely
> you know how that works.
From parrt at cs.usfca.edu  Sat Nov 19 13:01:48 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 19 13:02:02 2005
Subject: [antlr-interest] lexer "modes" for XML parsing etc...
Message-ID: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>

Hi Oliver,

I'm in a situation where, for v3, I need an island grammar for the  
stuff to the right of the rewrite "->" symbol to handle string  
templates.  So, I have to think about modes or switching streams or  
something to deal with different contexts within the same stream (I'm  
ignoring include file type switching for this email).

Your problem was that you wanted to gate certain rules in/out for XML  
parsing (inside/outside of a tag), right?  Can you simply define  
rules as usual for outside of a tag and then another rule that says  
which rules can be in the tag:

class L extends Lexer;
{protected boolean insideTag=false;}
// normal stuff (is put into mTokens() method)
PCDATA : ... ;
CDATA : ... ;
COMMENT : ... ;
OPEN : '<' {insideTag=true;} ;

// inside tag tag
ID : ... ;
EQ : '=' ;
STRING : ... ;
CLOSE : '>' {insideTag=false;} ;
TAG_TOKENS : ID | EQ | STRING | CLOSE | ... ;
...

Then in a subclass of L, do this:

class SL extends L {
   public Token mTokens() {
     if ( insideTag ) {
       return mTAG_TOKENS();
     }
     else {
       return super.mTokens();
     }
   }
}

Will something like that work?  It avoids the predicates in the lexer  
and we manually add them in code so we can really make it a gate.

In v3, perhaps we can formalize this situation (single input stream,  
multiple contexts) by allowing you set the start rule for the lexer.   
The default is Tokens but you can define another tokens rule and then  
have an action set the next start rule (for when the lexer is asked  
to emit a token again).

Ter
From oliver.zeigermann at gmail.com  Sat Nov 19 13:19:08 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Sat Nov 19 13:19:11 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
Message-ID: <9da4f4520511191319k299315f6k@mail.gmail.com>

Hi Terence,

I suppose something like this will work as a quick hack, but you do
not consider this a permanent fix, right. Because it's ugly...

What you describe for v3 final really sounds like lexer modes which -
as far as I remember - you don't like?! Finally giving in? Hihihihi ;)

Oliver

2005/11/19, Terence Parr <parrt@cs.usfca.edu>:
> Hi Oliver,
>
> I'm in a situation where, for v3, I need an island grammar for the
> stuff to the right of the rewrite "->" symbol to handle string
> templates.  So, I have to think about modes or switching streams or
> something to deal with different contexts within the same stream (I'm
> ignoring include file type switching for this email).
>
> Your problem was that you wanted to gate certain rules in/out for XML
> parsing (inside/outside of a tag), right?  Can you simply define
> rules as usual for outside of a tag and then another rule that says
> which rules can be in the tag:
>
> class L extends Lexer;
> {protected boolean insideTag=false;}
> // normal stuff (is put into mTokens() method)
> PCDATA : ... ;
> CDATA : ... ;
> COMMENT : ... ;
> OPEN : '<' {insideTag=true;} ;
>
> // inside tag tag
> ID : ... ;
> EQ : '=' ;
> STRING : ... ;
> CLOSE : '>' {insideTag=false;} ;
> TAG_TOKENS : ID | EQ | STRING | CLOSE | ... ;
> ...
>
> Then in a subclass of L, do this:
>
> class SL extends L {
>    public Token mTokens() {
>      if ( insideTag ) {
>        return mTAG_TOKENS();
>      }
>      else {
>        return super.mTokens();
>      }
>    }
> }
>
> Will something like that work?  It avoids the predicates in the lexer
> and we manually add them in code so we can really make it a gate.
>
> In v3, perhaps we can formalize this situation (single input stream,
> multiple contexts) by allowing you set the start rule for the lexer.
> The default is Tokens but you can define another tokens rule and then
> have an action set the next start rule (for when the lexer is asked
> to emit a token again).
>
> Ter
>
From parrt at cs.usfca.edu  Sat Nov 19 13:24:14 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 19 13:24:30 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <9da4f4520511191319k299315f6k@mail.gmail.com>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
Message-ID: <1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>


On Nov 19, 2005, at 1:19 PM, Oliver Zeigermann wrote:

> Hi Terence,
>
> I suppose something like this will work as a quick hack, but you do
> not consider this a permanent fix, right. Because it's ugly...

Mainly thinking of quick fix, but we can formalize to get you the  
kind of predicates you want.

> What you describe for v3 final really sounds like lexer modes which -
> as far as I remember - you don't like?! Finally giving in? Hihihihi ;)

I'm thinking of it as more of a goal-oriented lexer with multiple  
contexts.  Note that it's still better than modes in lex which people  
use to match strings etc...  You should use a separate rule in ANTLR  
for that.  For context-sensitive lexical regions in a single input  
stream, however, context-sensitive lexers can be implemented in a  
modal sense; here the mode implies context which I think is probably  
ok. ;)  I won't call it a mode though ;)

It will be very nice eventually when the parser can say "heh, I'm  
looking for an INT or an ID (and that's it)" so that messages are  
really good and the context is so specific it can built a smaller  
faster predictor.  This solves the List<List<int>> issue of the ">>"  
as it will only be looking for a '>' :)

Ter
From oliver.zeigermann at gmail.com  Sat Nov 19 13:30:45 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Sat Nov 19 13:30:48 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
Message-ID: <9da4f4520511191330q2dff7c5fo@mail.gmail.com>

2005/11/19, Terence Parr <parrt@cs.usfca.edu>:
> On Nov 19, 2005, at 1:19 PM, Oliver Zeigermann wrote:
> > What you describe for v3 final really sounds like lexer modes which -
> > as far as I remember - you don't like?! Finally giving in? Hihihihi ;)
>
> I'm thinking of it as more of a goal-oriented lexer with multiple
> contexts.  Note that it's still better than modes in lex which people
> use to match strings etc...  You should use a separate rule in ANTLR
> for that.  For context-sensitive lexical regions in a single input
> stream, however, context-sensitive lexers can be implemented in a
> modal sense; here the mode implies context which I think is probably
> ok. ;)  I won't call it a mode though ;)
>
> It will be very nice eventually when the parser can say "heh, I'm
> looking for an INT or an ID (and that's it)" so that messages are
> really good and the context is so specific it can built a smaller
> faster predictor.  This solves the List<List<int>> issue of the ">>"
> as it will only be looking for a '>' :)

Oh, so I did not get the point. But, is it really possible to only ask
for a certain set of possible tokens "dynamically"? I mean, the lexer
does not know what the parser will ask for at generation time.

Or did I get it all wrong again?

Oliver
From parrt at cs.usfca.edu  Sat Nov 19 13:32:55 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 19 13:33:07 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <9da4f4520511191330q2dff7c5fo@mail.gmail.com>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
Message-ID: <21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>


On Nov 19, 2005, at 1:30 PM, Oliver Zeigermann wrote:
>> It will be very nice eventually when the parser can say "heh, I'm
>> looking for an INT or an ID (and that's it)" so that messages are
>> really good and the context is so specific it can built a smaller
>> faster predictor.  This solves the List<List<int>> issue of the ">>"
>> as it will only be looking for a '>' :)
>
> Oh, so I did not get the point. But, is it really possible to only ask
> for a certain set of possible tokens "dynamically"? I mean, the lexer
> does not know what the parser will ask for at generation time.

Correct.  The parser would not call Tokens rule it would call a  
different start rule for each unique context in the grammar.  Well,  
unique in the sense that the set of tokens is different.

If you have a rule:

a : A
   | B
   | C
   ;

Rule 'a' might be able to tell the lexer to get one of A,B,C rather  
than any token.  I just don't know how lookahead would work in this  
environment.

Ter
From oliver.zeigermann at gmail.com  Sat Nov 19 14:10:26 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Sat Nov 19 14:10:33 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
Message-ID: <9da4f4520511191410s2498f6eak@mail.gmail.com>

2005/11/19, Terence Parr <parrt@cs.usfca.edu>:
>
> On Nov 19, 2005, at 1:30 PM, Oliver Zeigermann wrote:
> >> It will be very nice eventually when the parser can say "heh, I'm
> >> looking for an INT or an ID (and that's it)" so that messages are
> >> really good and the context is so specific it can built a smaller
> >> faster predictor.  This solves the List<List<int>> issue of the ">>"
> >> as it will only be looking for a '>' :)
> >
> > Oh, so I did not get the point. But, is it really possible to only ask
> > for a certain set of possible tokens "dynamically"? I mean, the lexer
> > does not know what the parser will ask for at generation time.
>
> Correct.  The parser would not call Tokens rule it would call a
> different start rule for each unique context in the grammar.  Well,
> unique in the sense that the set of tokens is different.
>
> If you have a rule:
>
> a : A
>    | B
>    | C
>    ;
>
> Rule 'a' might be able to tell the lexer to get one of A,B,C rather
> than any token.  I just don't know how lookahead would work in this
> environment.

Well, that's what I was talking about. How to do this *dynamically*?
Or would you suppose that the lexer knows all kinds of wishes the
parser may have? If it is statical only, lookahead should not be too
hard, you would just have to generate something you would when
something is a fragment, I guess.

Oliver
From mail at martin-probst.com  Sun Nov 20 05:25:17 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 20 05:25:24 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
Message-ID: <1132493117.10033.9.camel@localhost.localdomain>

Hi,

> Rule 'a' might be able to tell the lexer to get one of A,B,C rather  
> than any token.  I just don't know how lookahead would work in this  
> environment.

I can see two cases:
     1. the Lexing is only controlled by the structure of the text
        stream, e.g. the parser does not call/set anything in the Lexer,
        a classical stateful Lexer.
     2. the Lexing is controlled by the Parser. In this case the Parser
        tells the Lexer that the next token must be of a specific set.
        I've done that and it leads to big problems with lookahead. This
        can probably only be fixed by re-lexing the Tokens each time,
        either generally, or just if the Parser knows it's running into
        different lexing rules.

The second will either give you a big performance hit or be very
complicated to implement in a general way with ANTLR, I guess.

I think the first case can easily be solved in ANTLR, see the other
discussion we had. Support for this in ANTLR would be nice, as it's
really a mess to do that manually if it's more than just a single
boolean flag.

Martin

From mark.kattenbelt at gmail.com  Sun Nov 20 07:34:53 2005
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Sun Nov 20 07:34:57 2005
Subject: [antlr-interest] Compile & link to DLL with mingw (code::blocks)
Message-ID: <4380979D.7000802@gmail.com>

Hello,

I have been using ANTLR as a static lib in my c++ project for a while. 
This works great but I'd like to make a dynamic library instead. I 
encounter problems linking to my own antlr.dll.

I use Code::Blocks as a IDE, with the compiler GNU GCC (mingw). I can 
compile an antlr.dll by doing the following:

I included all files in \lib\cpp\src and all headers from 
\lib\cpp\antlr. I included the \lib\cpp too. I used the following 
defines: WIN32, NDEBUG, _WINDOWS, _USRDLL, ANTLR_EXPORTS, 
ANTLR_CXX_SUPPORTS_NAMESPACE.

And I compile this to a antlr.dll file. This all goes ok and without a 
warning or error.

Now when I want to compile my own program, I get linker errors. I have 
the following settings:

I defined ANTLR_IMPORTS, ANTLR_CXX_SUPPORTS_NAMESPACE. Included the 
antlr headers in \lib\cpp and pointed the linker to the antlr root. I 
also specify linker option -lantlr.

Now the errors I get are because GNU GCC fails to auto import data or 
something similar. I probably am doing something stupid but I cannot 
that noone else has had the same problems. I would appreciate the help!

The link errors I get are at: http://pastebin.ca/29604

I have tried to disable autoimport, tried to specify 
--enable-runtime-pseudo-relocs and a bunch of other things. I just 
cannot get it to work!

Please help,

Mark
From oliver.zeigermann at gmail.com  Sun Nov 20 10:38:06 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Sun Nov 20 10:38:10 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <1132493117.10033.9.camel@localhost.localdomain>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
	<1132493117.10033.9.camel@localhost.localdomain>
Message-ID: <9da4f4520511201038n2daff85cp@mail.gmail.com>

Yes, (2) is what I was wondering about when I said "dynamic". Sounds
interesting...

Martin, how did you solve (2)?

Oliver

2005/11/20, Martin Probst <mail@martin-probst.com>:
> Hi,
>
> > Rule 'a' might be able to tell the lexer to get one of A,B,C rather
> > than any token.  I just don't know how lookahead would work in this
> > environment.
>
> I can see two cases:
>      1. the Lexing is only controlled by the structure of the text
>         stream, e.g. the parser does not call/set anything in the Lexer,
>         a classical stateful Lexer.
>      2. the Lexing is controlled by the Parser. In this case the Parser
>         tells the Lexer that the next token must be of a specific set.
>         I've done that and it leads to big problems with lookahead. This
>         can probably only be fixed by re-lexing the Tokens each time,
>         either generally, or just if the Parser knows it's running into
>         different lexing rules.
>
> The second will either give you a big performance hit or be very
> complicated to implement in a general way with ANTLR, I guess.
>
> I think the first case can easily be solved in ANTLR, see the other
> discussion we had. Support for this in ANTLR would be nice, as it's
> really a mess to do that manually if it's more than just a single
> boolean flag.
>
> Martin
>
>
From mail at martin-probst.com  Sun Nov 20 10:54:24 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 20 10:54:37 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <9da4f4520511201038n2daff85cp@mail.gmail.com>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
	<1132493117.10033.9.camel@localhost.localdomain>
	<9da4f4520511201038n2daff85cp@mail.gmail.com>
Message-ID: <1132512864.10033.21.camel@localhost.localdomain>

Am Sonntag, den 20.11.2005, 19:38 +0100 schrieb Oliver Zeigermann:
> Yes, (2) is what I was wondering about when I said "dynamic". Sounds
> interesting...
> 
> Martin, how did you solve (2)?

I didn't. I ran into bugs with a Lexer that is controlled by the Parser
(not because of lookahead, but because of predicates. The problem is the
same though) and ended up with a mixture where some states were switched
by the Lexer and some by the Parser. That worked, but was really ugly
and hard to maintain. 

Now I'm working with a manually written Lexer that follows (1), e.g.
state switching is exclusively done by the Lexer. This works nicely,
except that a handwritten Lexer for a lexically complex (23 states, 200
different Token types) language is also a real pain. Slightly better as
there are no bugs in the interop between the lexer and the parser, as
it's only calling nextToken(), but still. This is why I'm trying to prod
Terence into providing better support for stateful lexers ;-)

Solving (2) would probably include identifying the sections where
different tokens are possible depending on the lookahead decision,
marking the character(!) stream and re-lexing the token(s) in the case
of mismatches. That is IMHO complete overkill. It should be possible to
pull down the rules about states etc. into the Lexer with any sane
language.

Martin

> >      2. the Lexing is controlled by the Parser. In this case the Parser
> >         tells the Lexer that the next token must be of a specific set.
> >         I've done that and it leads to big problems with lookahead. This
> >         can probably only be fixed by re-lexing the Tokens each time,
> >         either generally, or just if the Parser knows it's running into
> >         different lexing rules.
> >
> > The second will either give you a big performance hit or be very
> > complicated to implement in a general way with ANTLR, I guess.
> >
> > I think the first case can easily be solved in ANTLR, see the other
> > discussion we had. Support for this in ANTLR would be nice, as it's
> > really a mess to do that manually if it's more than just a single
> > boolean flag.
> >
> > Martin
> >
> >
> 

From parrt at cs.usfca.edu  Sun Nov 20 11:42:32 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 20 11:42:42 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <1132512864.10033.21.camel@localhost.localdomain>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
	<1132493117.10033.9.camel@localhost.localdomain>
	<9da4f4520511201038n2daff85cp@mail.gmail.com>
	<1132512864.10033.21.camel@localhost.localdomain>
Message-ID: <C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>


On Nov 20, 2005, at 10:54 AM, Martin Probst wrote:
> Now I'm working with a manually written Lexer that follows (1), e.g.
> state switching is exclusively done by the Lexer. This works nicely,
> except that a handwritten Lexer for a lexically complex (23 states,  
> 200
> different Token types) language is also a real pain. Slightly  
> better as
> there are no bugs in the interop between the lexer and the parser, as
> it's only calling nextToken(), but still. This is why I'm trying to  
> prod
> Terence into providing better support for stateful lexers ;-)

Your wish is my command.  ;)  Do we need something like

lexer grammar L;

ID : ... ;
SQLSTART : "sql(" {pushContext(SQL);} ;
WS : ... ;

context SQL {
ID : ... ;
ACTION : ...;
STRING : ... ;
ENDSQL : ')' {popContext();}
}

context island2 {
...
}

[note the push/pop rather than simple set; very useful]

Then, the lexer would simply generate multiple Tokens-like rules for  
all contexts?  You see a different lexer entry rule for each  
context.  How do you switch?  We'd need an int constant (as we have  
no function poitners in Java--a pox on their family) that would jump  
to the right starting method.

Sounds easy.  Is this what we want?  It is proper for island grammars  
that feed off the same input stream.  Multiple input streams like  
include files need to be handled with a multiplexing input buffer.

> Solving (2) would probably include identifying the sections where
> different tokens are possible depending on the lookahead decision,
> marking the character(!) stream and re-lexing the token(s) in the case
> of mismatches. That is IMHO complete overkill. It should be  
> possible to
> pull down the rules about states etc. into the Lexer with any sane
> language.

Agreed.  THat is really hard.

ter
From stephen at covidimus.net  Sun Nov 20 12:28:25 2005
From: stephen at covidimus.net (Stephen Quattlebaum)
Date: Sun Nov 20 12:28:30 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
Message-ID: <4enjqd$1m088c1@mxip17a.cluster1.charter.net>

> Your wish is my command.  ;)  Do we need something like
>
> lexer grammar L;
>
> ID : ... ;
> SQLSTART : "sql(" {pushContext(SQL);} ;
> WS : ... ;
>
> context SQL {
> ID : ... ;
> ACTION : ...;
> STRING : ... ;
> ENDSQL : ')' {popContext();}
> }
>
> context island2 {
> ...
>}

Have been following this conversation.  Something like what you describe
above would very nicely replace an ugly hack I've had to use to switch
between lexers for the primary language and embedded languages in one of my
projects.  Now, if the contexts could be defined independently (in different
files) and then included as separate contexts in other grammars, that'd
_really_ be nice. :-)


From parrt at cs.usfca.edu  Sun Nov 20 12:30:22 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 20 12:30:35 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <4enjqd$1m088c1@mxip17a.cluster1.charter.net>
References: <4enjqd$1m088c1@mxip17a.cluster1.charter.net>
Message-ID: <655CD668-A723-441A-A230-EB146CA32A1B@cs.usfca.edu>


On Nov 20, 2005, at 12:28 PM, Stephen Quattlebaum wrote:
>> lexer grammar L;
>>
>> ID : ... ;
>> SQLSTART : "sql(" {pushContext(SQL);} ;
>> WS : ... ;
>>
>> context SQL {
>> ID : ... ;
>> ACTION : ...;
>> STRING : ... ;
>> ENDSQL : ')' {popContext();}
>> }
>>
>> context island2 {
>> ...
>> }
>
> Have been following this conversation.  Something like what you  
> describe
> above would very nicely replace an ugly hack I've had to use to switch
> between lexers for the primary language and embedded languages in  
> one of my
> projects.  Now, if the contexts could be defined independently (in  
> different
> files) and then included as separate contexts in other grammars,  
> that'd
> _really_ be nice. :-)

Hi.  Well we can do separate files right now and you can use a  
selector to switch between different lexers, just have the ctor to  
the lexer share the same input stream.  The reason to have them in  
the same file I think is probably convenience.  Perhaps I'm wrong...

Ter
From open.zone at virgin.net  Sun Nov 20 12:56:03 2005
From: open.zone at virgin.net (Micheal J)
Date: Sun Nov 20 12:40:29 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
Message-ID: <000601c5ee14$d2657bf0$6b02a8c0@hercules>

> Your wish is my command.  ;)  Do we need something like
> 
> lexer grammar L;
> 
> ID : ... ;
> SQLSTART : "sql(" {pushContext(SQL);} ;
> WS : ... ;
> 
> context SQL {
> ID : ... ;
> ACTION : ...;
> STRING : ... ;
> ENDSQL : ')' {popContext();}
> }
> 
> context island2 {
> ...
> }
> 
> [note the push/pop rather than simple set; very useful]
> 
> Then, the lexer would simply generate multiple Tokens-like rules for  
> all contexts?  You see a different lexer entry rule for each  
> context.  How do you switch?  We'd need an int constant (as we have  
> no function poitners in Java--a pox on their family) that would jump  
> to the right starting method.
> 
> Sounds easy.  Is this what we want?  It is proper for island 
> grammars  
> that feed off the same input stream.  Multiple input streams like  
> include files need to be handled with a multiplexing input buffer.


How is this different from using TokenStreamSelectors?. Is this just a
ANTLR-generates-the-tokenselector-plumbing-and-glue-too scenario. Or is this
a case where all the switching in done within a single lexer with no
tokenselector-style switching?

Cheers,

Micheal

From juangelos at gmail.com  Sun Nov 20 12:41:34 2005
From: juangelos at gmail.com (Juan Ignacio Gelos)
Date: Sun Nov 20 12:41:39 2005
Subject: [antlr-interest] Undeterminism - SQL column specification?
Message-ID: <514bff6b0511201241y4044c672yedf097807b32c6d5@mail.gmail.com>

Hi all,

I'm trying to generate a parser for SQL statements, and I need to
recognize columns and get each element in the column specification.
I need to match the following alternatives, but I'm getting
undeterminism errors:

canonColumn
    // columnName
    // object.columnName
    // schema.object.columnName
    // catalog.schema.object.columnName
    // catalog..object.columnName
    // server.catalog.schema.object.columnName
    // server.catalog..object.columnName
    :
    ((((server:someName DOT)? db:someName DOT)? (schema:someName)?
DOT)? object:someName DOT)? col:someName
    // this works, but I need the labels:  (someName DOT | DOT)* someName
    ;


D:\antlr>antlr-2.7.5.exe tsql-select2.g
ANTLR Parser Generator   Version 2.7.5 (20050201)   1989-2005 jGuru.com


tsql-select2.g:326:5: warning:nondeterminism between alts 1 and 2 of block upon

tsql-select2.g:326:5:    
k==1:"ties","cube","rollup","hash","concat","merge","loop","fast","force","maxdop","robust","keep","keepfixed","expand","views","xml","raw","auto","explicit","xmldata","elements","binary","base64","remote","fastfirstrow","nolock","paglock","readcommited","readpast","readuncommited","repeatableread","rowlock","serializable","tablock","tablockx","updlock","xlock","identitycol","rowguidcol","cast",NonQuotedIdentifier,QuotedIdentifier

tsql-select2.g:326:5:    
k==2:"ties","cube","rollup","hash","concat","merge","loop","fast","force","maxdop","robust","keep","keepfixed","expand","views","xml","raw","auto","explicit","xmldata","elements","binary","base64","remote","fastfirstrow","nolock","paglock","readcommited","readpast","readuncommited","repeatableread","rowlock","serializable","tablock","tablockx","updlock","xlock","cast",NonQuotedIdentifier,QuotedIdentifier

tsql-select2.g:326:6: warning:nondeterminism between alts 1 and 2 of block upon

tsql-select2.g:326:6:    
k==1:"ties","cube","rollup","hash","concat","merge","loop","fast","force","maxdop","robust","keep","keepfixed","expand","views","xml","raw","auto","explicit","xmldata","elements","binary","base64","remote","fastfirstrow","nolock","paglock","readcommited","readpast","readuncommited","repeatableread","rowlock","serializable","tablock","tablockx","updlock","xlock","identitycol","rowguidcol","cast",NonQuotedIdentifier,QuotedIdentifier

tsql-select2.g:326:6:     k==2:DOT

tsql-select2.g:326:7: warning:nondeterminism between alts 1 and 2 of block upon

tsql-select2.g:326:7:    
k==1:"ties","cube","rollup","hash","concat","merge","loop","fast","force","maxdop","robust","keep","keepfixed","expand","views","xml","raw","auto","explicit","xmldata","elements","binary","base64","remote","fastfirstrow","nolock","paglock","readcommited","readpast","readuncommited","repeatableread","rowlock","serializable","tablock","tablockx","updlock","xlock","identitycol","rowguidcol","cast",NonQuotedIdentifier,QuotedIdentifier

tsql-select2.g:326:7:     k==2:DOT

tsql-select2.g:326:8: warning:nondeterminism between alts 1 and 2 of block upon

tsql-select2.g:326:8:    
k==1:"ties","cube","rollup","hash","concat","merge","loop","fast","force","maxdop","robust","keep","keepfixed","expand","views","xml","raw","auto","explicit","xmldata","elements","binary","base64","remote","fastfirstrow","nolock","paglock","readcommited","readpast","readuncommited","repeatableread","rowlock","serializable","tablock","tablockx","updlock","xlock","identitycol","rowguidcol","cast",NonQuotedIdentifier,QuotedIdentifier
tsql-select2.g:326:8:     k==2:DOT



Any ideas?

Thanks,
Juan Ignacio Gelos
From parrt at cs.usfca.edu  Sun Nov 20 12:44:18 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 20 12:44:28 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <000601c5ee14$d2657bf0$6b02a8c0@hercules>
References: <000601c5ee14$d2657bf0$6b02a8c0@hercules>
Message-ID: <A02F1087-FDC0-46EC-A533-D48C0D2606C8@cs.usfca.edu>


On Nov 20, 2005, at 12:56 PM, Micheal J wrote:
>> Sounds easy.  Is this what we want?  It is proper for island
>> grammars
>> that feed off the same input stream.  Multiple input streams like
>> include files need to be handled with a multiplexing input buffer.
>
>
> How is this different from using TokenStreamSelectors?. Is this just a
> ANTLR-generates-the-tokenselector-plumbing-and-glue-too scenario.  
> Or is this
> a case where all the switching in done within a single lexer with no
> tokenselector-style switching?

Well you need the multiplexor thing for multiple input streams and  
the same sort of selector thing works for multiple lexers feeding off  
the same input stream.  THis would only be "sugar" to make it  
easier.  currently you have to open a new file, add the new lexer  
bits (possibly having complications due to instance variables/ 
methods), run antlr on it, and add some glue during the parser/lexer  
construction and launching.

Ter
From open.zone at virgin.net  Sun Nov 20 13:36:47 2005
From: open.zone at virgin.net (Micheal J)
Date: Sun Nov 20 13:21:12 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <A02F1087-FDC0-46EC-A533-D48C0D2606C8@cs.usfca.edu>
Message-ID: <000701c5ee1a$832f4240$6b02a8c0@hercules>


> > How is this different from using TokenStreamSelectors?. Is 
> this just a 
> > ANTLR-generates-the-tokenselector-plumbing-and-glue-too scenario.
> > Or is this
> > a case where all the switching in done within a single lexer with no
> > tokenselector-style switching?
> 
> Well you need the multiplexor thing for multiple input streams and  
> the same sort of selector thing works for multiple lexers 
> feeding off  
> the same input stream.  THis would only be "sugar" to make it  
> easier.  currently you have to open a new file, add the new lexer  
> bits (possibly having complications due to instance variables/ 
> methods), run antlr on it, and add some glue during the parser/lexer  
> construction and launching.

OK. I was trying to contrast it with an all-in-one hand-coded
lexer+preprocessor Kunle & I built where there is a int to store the current
state (or lexing context/mode if you will) and, GetNextToken() switch()-es
on the current_lexer_state_int to determine which of a number of
NextToken_XXX() methods to delegate to.

This sounds like what we're now planning for ANTLR 3. Is it?

Cheers,

Micheal

From parrt at cs.usfca.edu  Sun Nov 20 13:25:35 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 20 13:25:45 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <000701c5ee1a$832f4240$6b02a8c0@hercules>
References: <000701c5ee1a$832f4240$6b02a8c0@hercules>
Message-ID: <4CE57F94-93A7-4CF6-A112-E2730C7FCC7F@cs.usfca.edu>


On Nov 20, 2005, at 1:36 PM, Micheal J wrote:
> OK. I was trying to contrast it with an all-in-one hand-coded
> lexer+preprocessor Kunle & I built where there is a int to store  
> the current
> state (or lexing context/mode if you will) and, GetNextToken()  
> switch()-es
> on the current_lexer_state_int to determine which of a number of
> NextToken_XXX() methods to delegate to.
>
> This sounds like what we're now planning for ANTLR 3. Is it?

Yeah, something like this could be convenient even if people will  
sometimes use it when they should be using a rule reference (like for  
matching Strings, etc...)

Ter
From mail at martin-probst.com  Sun Nov 20 15:40:47 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 20 15:40:54 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
	<1132493117.10033.9.camel@localhost.localdomain>
	<9da4f4520511201038n2daff85cp@mail.gmail.com>
	<1132512864.10033.21.camel@localhost.localdomain>
	<C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
Message-ID: <1132530047.10033.57.camel@localhost.localdomain>

Hi,

> context SQL {
> ID : ... ;
> ACTION : ...;
> STRING : ... ;
> ENDSQL : ')' {popContext();}
> }
> 
> context island2 {
> ...
> }

> Sounds easy.  Is this what we want?  It is proper for island grammars  
> that feed off the same input stream.  Multiple input streams like  
> include files need to be handled with a multiplexing input buffer.

That's exactly what I was hoping for. Though I'm not so much into island
grammars for different languages, but rather different states for the
same language, e.g. an operator state (where 'and' is the binary
operator) and a default state (where 'and' is a QName) etc. - that's the
problem I have to tackle. This would help a lot in both cases.

> [note the push/pop rather than simple set; very useful]

Yes, I nearly forgot that. We need push/pop and set.

Martin

From oliver.zeigermann at gmail.com  Sun Nov 20 21:49:44 2005
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Sun Nov 20 21:49:46 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
In-Reply-To: <C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
References: <BA694D78-98F0-4BCE-8CF3-C65F3E733AAD@cs.usfca.edu>
	<9da4f4520511191319k299315f6k@mail.gmail.com>
	<1A9F333A-A60A-4355-B3C9-CFF644969344@cs.usfca.edu>
	<9da4f4520511191330q2dff7c5fo@mail.gmail.com>
	<21E386E9-411A-4FFA-A0F3-7ECDC10006DD@cs.usfca.edu>
	<1132493117.10033.9.camel@localhost.localdomain>
	<9da4f4520511201038n2daff85cp@mail.gmail.com>
	<1132512864.10033.21.camel@localhost.localdomain>
	<C26AC016-6DAE-4D8D-9A41-6F8B5F4D233C@cs.usfca.edu>
Message-ID: <9da4f4520511202149k3d68ea68l@mail.gmail.com>

2005/11/20, Terence Parr <parrt@cs.usfca.edu>:
> Your wish is my command.  ;)  Do we need something like
>
> lexer grammar L;
>
> ID : ... ;
> SQLSTART : "sql(" {pushContext(SQL);} ;
> WS : ... ;
>
> context SQL {
> ID : ... ;
> ACTION : ...;
> STRING : ... ;
> ENDSQL : ')' {popContext();}
> }
>
> context island2 {
> ...
> }
>
> [note the push/pop rather than simple set; very useful]
>
> Then, the lexer would simply generate multiple Tokens-like rules for
> all contexts?  You see a different lexer entry rule for each
> context.  How do you switch?  We'd need an int constant (as we have
> no function poitners in Java--a pox on their family) that would jump
> to the right starting method.
>
> Sounds easy.  Is this what we want?  It is proper for island grammars
> that feed off the same input stream.  Multiple input streams like
> include files need to be handled with a multiplexing input buffer.

That's what I would like to see.

Oliver
From broshan at gmail.com  Sun Nov 20 22:06:09 2005
From: broshan at gmail.com (Roshan Achar)
Date: Sun Nov 20 22:06:11 2005
Subject: [antlr-interest] nondeterminism
Message-ID: <43c638920511202206l2202996cq33d9bd22fcac87bb@mail.gmail.com>

Hi,

I am trying to write grammer for a bookmarks file. Iam getting the
following error -

 warning:nondeterminism upon
Bookmarks.g:44:     k==1:A_START,H3_START
Bookmarks.g:44:     between alt 1 and exit branch of block

I am not sure of the cause since with k=2 there should be no
nondeterminism between A_START and H3_START.

The grammer is as follows -

options
{
    language = "CSharp";
}

class BookmarksParser extends Parser;

file
    : (item)+
    ;

item
    : (shortcut | subfolder)
    ;

subfolder
    : (item_title) (item)*
    ;

shortcut
    : (A_START) (TEXT)+  (TAG_END)
    ;

item_title
    : (H3_START) (TEXT)+ (TAG_END)
    ;

class BookmarksLexer extends Lexer;
options
{
    k=2;
    //caseSensitive=false;
}

TAG_START
    : '<' ~( 'A' | 'H' | 'a' | 'h' | '/' | '<' | '>' ) (TEXT)* 
(ATTRIBUTES)* '>'
    {
        $setType(Token.SKIP);
    }
    ;

TAG_END
    : "</" (~( '>' ))+ '>'
    {
        $setType(Token.SKIP);
    }
    ;

H3_START
    : "<H3"  (attr:ATTRIBUTES {Console.WriteLine("Got attribute -
"+attr.getText());})* '>'
    ;


// Atleast one attribute href="" is needed
A_START
    : "<A"  (attr:ATTRIBUTES {Console.WriteLine("Got attribute -
"+attr.getText());})+  '>'
    ;

ATTRIBUTES
    : (TEXT)+ '=' '"' (~('"' | '<' | '>' ))* '"'
    ;

TEXT
    : ~('"' | '<' | '>' | '\r' | '\t' | '\n' | ' ')
    ;

SKIP_WS
    : ( '\r' '\n'
      | '\n'
      | '  '
      | '\t' )
    {
        $setType(Token.SKIP);
    }
    ;

The file format is specified at -
http://msdn.microsoft.com/workshop/browser/external/overview/bookmark_file_format.asp

Any help is appreciated.

Thanks ,
Roshan
broshan@gmail.com
From r.paterson at ioof.com.au  Sun Nov 20 22:22:59 2005
From: r.paterson at ioof.com.au (PATERSON, Robert)
Date: Sun Nov 20 22:23:03 2005
Subject: [antlr-interest] nondeterminism
Message-ID: <FB120A6865FF7741A38A948247A91F12DF11DC@MELSSRV007.ioof.com.au>

This is an educated guess as I'm a bit of an ANTLR newbie, but I imagine
the non-determinism is due to (item)* in subfolder being optional. It's
not sure when it encounters two item titles in a row, whether the
H3_START is the manadatory start of an 'item_title' in 'subfolder' or
the start of an optional 'item_title' 'item' at the end of a 'subfolder'
rule.



-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Roshan Achar
Sent: Monday, 21 November 2005 2:06 PM
To: antlr-interest@antlr.org
Subject: [antlr-interest] nondeterminism

Hi,

I am trying to write grammer for a bookmarks file. Iam getting the
following error -

 warning:nondeterminism upon
Bookmarks.g:44:     k==1:A_START,H3_START
Bookmarks.g:44:     between alt 1 and exit branch of block

I am not sure of the cause since with k=2 there should be no
nondeterminism between A_START and H3_START.

The grammer is as follows -

options
{
    language = "CSharp";
}

class BookmarksParser extends Parser;

file
    : (item)+
    ;

item
    : (shortcut | subfolder)
    ;

subfolder
    : (item_title) (item)*
    ;

shortcut
    : (A_START) (TEXT)+  (TAG_END)
    ;

item_title
    : (H3_START) (TEXT)+ (TAG_END)
    ;

class BookmarksLexer extends Lexer;
options
{
    k=2;
    //caseSensitive=false;
}

TAG_START
    : '<' ~( 'A' | 'H' | 'a' | 'h' | '/' | '<' | '>' ) (TEXT)*
(ATTRIBUTES)* '>'
    {
        $setType(Token.SKIP);
    }
    ;

TAG_END
    : "</" (~( '>' ))+ '>'
    {
        $setType(Token.SKIP);
    }
    ;

H3_START
    : "<H3"  (attr:ATTRIBUTES {Console.WriteLine("Got attribute -
"+attr.getText());})* '>'
    ;


// Atleast one attribute href="" is needed A_START
    : "<A"  (attr:ATTRIBUTES {Console.WriteLine("Got attribute -
"+attr.getText());})+  '>'
    ;

ATTRIBUTES
    : (TEXT)+ '=' '"' (~('"' | '<' | '>' ))* '"'
    ;

TEXT
    : ~('"' | '<' | '>' | '\r' | '\t' | '\n' | ' ')
    ;

SKIP_WS
    : ( '\r' '\n'
      | '\n'
      | '  '
      | '\t' )
    {
        $setType(Token.SKIP);
    }
    ;

The file format is specified at -
http://msdn.microsoft.com/workshop/browser/external/overview/bookmark_fi
le_format.asp

Any help is appreciated.

Thanks ,
Roshan
broshan@gmail.com


****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From wiggjd at lsbu.ac.uk  Mon Nov 21 04:02:32 2005
From: wiggjd at lsbu.ac.uk (David Wigg)
Date: Mon Nov 21 03:56:19 2005
Subject: [antlr-interest] Updated C++ parser version 3.1 published November
	2005
Message-ID: <4381B758.7060804@lsbu.ac.uk>

Hello C++ parsers,

I have uploaded our updated C++ parser, CPP_parser.g Version 3.1
November 2005, to the list of grammars on the antlr website at
http://www.antlr.org/grammar/list to replace Version 3.0 July 2004.

It still uses ANTLR 2.7.3 but it should work with all later
versions of ANTLR 2.7.? . I may be able to produce a version
which uses ANTLR 3.?  next year.

Please note that this latest version still assumes input of
preprocessed C/C++ programs and produces lexers and parsers
written in C++.

This version has been improved by the cooperation of users who
have submitted problem code which the previous version, V.3.0
July 2004, could not parse.

I realise that introducing an updated version of a parser
entails extra work but I hope that by using my method of
subclassing your application code that this work will be reduced
to a minimum. See MyReadMe3.1.txt for further information.

This version includes additional features to assist debugging as
follows,

*   Statement trace feature which as supplied is ON for
demonstration purposes. It can be turned ON/OFF in CPP_parser.g 
or CPPParser.cpp.

*   ANTLR trace feature which requires replacing LLkParser.cpp
and LLkParser.hpp with slightly modified version supplied. It 
can be turned ON/OFF in CPP_parser.g or CPPParser.cpp.

*   A slightly modified version of Parser.cpp which produces
error messages to cout as well as cerr.

Please see MyReadMe3.1.txt for further information.

You can use the preprocessed program Quadratic.i in
...\CPP_parserV3.1\TestIfiles to verify correct installation.

I welcome queries and questions from users.

David Wigg
Research Fellow
Centre for Systems and Software Engineering
London South Bank University
London, UK
wiggjd@bcs.org.uk
blackse@lsbu.ac.uk










From lance at thinkingworks.com  Mon Nov 21 10:45:25 2005
From: lance at thinkingworks.com (Lance Gutteridge)
Date: Mon Nov 21 10:48:49 2005
Subject: [antlr-interest] A simple question regarding statement clauses
In-Reply-To: <20051121060615.32553DCCFA@www.antlr.org>
References: <20051121060615.32553DCCFA@www.antlr.org>
Message-ID: <6.1.2.0.2.20051121103231.025b33c0@pop3.thinkingworks.com>

Sorry if this question has been asked before.
I'm using ANTLR to parse a language that has various statements. A common 
case is when I have several clauses in the statement but I want them to be 
optional, in any order and only one of each.

So for example the report statement can take four margin clauses.
eg. report left margin 20 right margin 40 top margin 30 bottom margin 30 ;
So I can say in ANTLR:
REPORT (MARGIN_CLAUSE)*
where
MARGIN_CLAUSE: (MARGIN! LEFT^ AMOUNT) | (MARGIN! RIGHT^ AMOUNT) | (MARGIN! 
TOP^ AMOUNT ) | (MARGIN! BOTTOM^ AMOUNT) ;

But that would allow
REPORT LEFT MARGIN 20 LEFT MARGIN 20

I could put the clauses in as optional
something like:
REPORT (LEFT_CLAUSE)? (RIGHT_CLAUSE)? (TOP_CLAUSE)? (BOTTOM_CLAUSE)?

That would make sure there is only one of each but it forces them to be in 
that exact order.

I could allow multiples and just take the last specification and have it 
override any previous ones, but that seems somewhat cheesy.

So my question is, what is the easiest way to specify that I want the 
statement to have any or none of these margin clauses, in any order, but no 
more than one of each.

Thanks
Lance


From y0016408 at yahoo.de  Mon Nov 21 13:17:08 2005
From: y0016408 at yahoo.de (Sergej Bogomolow)
Date: Mon Nov 21 13:17:11 2005
Subject: [antlr-interest] dynamic parsers
Message-ID: <20051121211708.10592.qmail@web25708.mail.ukl.yahoo.com>

I've got a question concerned dynamic parsers. Does
antlr 3.0 make it possible to create dynamic parsers,
i.e. intepreters? 

I have my statechart grammar. If I use my program to
translate this grammar, then I'll get ASt class files
and a Antlr file. Then I run antlr and the result is a
parser. In the next step this parser should be
compiled. Is it possible to create a dynamic parser
which intepret the statechart grammar on the fly using
antlr 3.0? It is important to point that the Java
parser must be available in the compiled form at the
end of the process. 

Thanks 
Sergej


	

	
		
___________________________________________________________ 
Gesendet von Yahoo! Mail - Jetzt mit 1GB Speicher kostenlos - Hier anmelden: http://mail.yahoo.de
From parrt at cs.usfca.edu  Mon Nov 21 13:24:26 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 21 13:24:32 2005
Subject: [antlr-interest] dynamic parsers
In-Reply-To: <20051121211708.10592.qmail@web25708.mail.ukl.yahoo.com>
References: <20051121211708.10592.qmail@web25708.mail.ukl.yahoo.com>
Message-ID: <0EFD827A-6658-4819-A221-3EDB2F63BF1A@cs.usfca.edu>


On Nov 21, 2005, at 1:17 PM, Sergej Bogomolow wrote:

> I've got a question concerned dynamic parsers. Does
> antlr 3.0 make it possible to create dynamic parsers,
> i.e. intepreters?

You bet!  I'm going to make it even better.  Here is one of my  
functional tests:

	public void testSimpleParse() throws Exception {
		Grammar pg = new Grammar(
			"parser grammar p;\n"+
			"prog : WHILE ID LCURLY (assign)* RCURLY;\n" +
			"assign : ID ASSIGN expr SEMI ;\n" +
			"expr : INT | FLOAT | ID ;\n");
		Grammar g = new Grammar();
		g.importTokenVocabulary(pg);
		g.setGrammarContent(
			"lexer grammar t;\n"+
			"WHILE : \"while\";\n"+
			"LCURLY : '{';\n"+
			"RCURLY : '}';\n"+
			"ASSIGN : '=';\n"+
			"SEMI : ';';\n"+
			"ID : ('a'..'z')+ ;\n"+
			"INT : (DIGIT)+ ;\n"+
			"FLOAT : (DIGIT)+ '.' (DIGIT)* ;\n"+
			"fragment DIGIT : '0'..'9';\n" +
			"WS : (' ')+ ;\n");
		CharStream input = new ANTLRStringStream("while x { i=1; y=3.42;  
z=y; }");
		Interpreter lexEngine = new Interpreter(g, input);

		CommonTokenStream tokens = new CommonTokenStream(lexEngine);
		tokens.setTokenTypeChannel(g.getTokenType("WS"), 99);
		//System.out.println("tokens="+tokens.toString());
		Interpreter parseEngine = new Interpreter(pg, tokens);
		ParseTree t = parseEngine.parse("prog");
		String result = t.toStringTree();
		String expecting =
			"(<grammar p> (prog [@0,0:4='while',<4>,1:0] [@2,6:6='x',<5>,1:6]  
[@4,8:8='{',<6>,1:8] (assign [@6,10:10='i',<5>,1:10]  
[@7,11:11='=',<8>,1:11] (expr [@8,12:12='1',<10>,1:12])  
[@9,13:13=';',<9>,1:13]) (assign [@11,15:15='y',<5>,1:15]  
[@12,16:16='=',<8>,1:16] (expr [@13,17:20='3.42',<11>,1:17])  
[@14,21:21=';',<9>,1:21]) (assign [@16,23:23='z',<5>,1:23]  
[@17,24:24='=',<8>,1:24] (expr [@18,25:25='y',<5>,1:25])  
[@19,26:26=';',<9>,1:26]) [@21,28:28='}',<7>,1:28]))";
		assertEqual(result, expecting);
	}


I plan on making that really easy to just give me a few rules and  
have it do it's magic.

> I have my statechart grammar. If I use my program to
> translate this grammar, then I'll get ASt class files
> and a Antlr file.

Actually, I'm interpreting all that so it can't have actions but is  
much easier to use.

> Then I run antlr and the result is a
> parser. In the next step this parser should be
> compiled. Is it possible to create a dynamic parser
> which intepret the statechart grammar on the fly using
> antlr 3.0?

You can easily compile and run antlr parsers on the fly as every one  
of my function tests do this.  See the TestCompileAndExecSupport.java  
file in the v3 distribution.

> It is important to point that the Java
> parser must be available in the compiled form at the
> end of the process.

No problem :)

Ter
From parrt at cs.usfca.edu  Mon Nov 21 13:58:25 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 21 13:58:31 2005
Subject: [antlr-interest] $r.st vs $r.template
Message-ID: <C043B228-AF7B-411D-8AF5-AD9D30020B54@cs.usfca.edu>

Howdy.  I can't decide whether to use .st or .template as the  
predefined property of a rule label reference.  Do you like this:

formalParameter
     :   type declarator
         -> parameter(type={$type.st},name={$declarator.st})
     ;

or would you prefer $type.template and $declarator.template?  I had  
it this verbose way at first, but I quickly got tired of typing it.   
My one concern with .st is it is the file extension for template  
files (only for people using it for web stuff I guess though).

ST is an officially approved abbreviation for StringTemplate in email  
though ;)  Perhaps it's ok.

By the way, do you like that ANTLR+ST integration?  I've got it  
working and am converting my cminus.g translator to this v3 stuff.   
Should be done shortly.

Ter
From broshan at gmail.com  Mon Nov 21 19:16:45 2005
From: broshan at gmail.com (Roshan Achar)
Date: Mon Nov 21 19:16:50 2005
Subject: [antlr-interest] nondeterminism
In-Reply-To: <FB120A6865FF7741A38A948247A91F12DF11DC@MELSSRV007.ioof.com.au>
References: <FB120A6865FF7741A38A948247A91F12DF11DC@MELSSRV007.ioof.com.au>
Message-ID: <43c638920511211916q6ba9abe8h297f25f49d8fd417@mail.gmail.com>

On 11/21/05, PATERSON, Robert <r.paterson@ioof.com.au> wrote:
> This is an educated guess as I'm a bit of an ANTLR newbie, but I imagine
> the non-determinism is due to (item)* in subfolder being optional. It's
> not sure when it encounters two item titles in a row, whether the
> H3_START is the manadatory start of an 'item_title' in 'subfolder' or
> the start of an optional 'item_title' 'item' at the end of a 'subfolder'
> rule.

You were right. I eliminated that confusion by redifining subfolder as -

subfolder
    : (item_title) SUBFOLDER_START (item)* SUBFOLDER_END
    ;

 Thanks ,
 Roshan
 broshan@gmail.com
From robgreene at gmail.com  Mon Nov 21 19:38:05 2005
From: robgreene at gmail.com (Rob Greene)
Date: Mon Nov 21 19:38:11 2005
Subject: [antlr-interest] Truely, a BASIC question
Message-ID: <738584f80511211938u608d01c6m1fcf45c0a5930f2b@mail.gmail.com>

I am most definitely new to ANTLR. I'm working out a grammar file for
a BASICish language where line endings are important. Language
statements do not end with a colon uniformly - instead it is most
likely a newline that separates statements. I haven't discovered any
tutorials that covers this and haven't located any information in the
documentation.

What I've tried:
* optionally allow the colon separator - but that allows stuff like
"goto this goto that" instead of requiring a colon/newline between
commands ("goto this : goto that").
* pulled newline out of the WS variable (?? terminology) in my grammar
file and added a separator rule of "( COLON | NEWLINE )+" to require
one or more separators and then attempt to use the rule appropriately.
This seems to work, but I get odd errors:

line 8:15: unexpected token:

line 9:9: unexpected token:

line 10:1: unexpected token:

line 11:1: unexpected token: gosub

Which appear (to the novice) to imply my separator are hosing up the
interpretation somewhere.

Are there any gotchas in the grammar rules I need to look out for?
I've included what I have at this point for the grammar file (with the
really clever name of rbasic).

Thanks!
-Rob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rbasic.g
Type: application/octet-stream
Size: 3559 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051121/70bf2b9c/rbasic.obj
From robgreene at gmail.com  Mon Nov 21 21:23:48 2005
From: robgreene at gmail.com (Rob Greene)
Date: Mon Nov 21 21:23:52 2005
Subject: [antlr-interest] Truely, a BASIC question
In-Reply-To: <FB120A6865FF7741A38A948247A91F12DF11E5@MELSSRV007.ioof.com.au>
References: <FB120A6865FF7741A38A948247A91F12DF11E5@MELSSRV007.ioof.com.au>
Message-ID: <738584f80511212123l66ba02bftc06e563cd0be076b@mail.gmail.com>

Oh, of course... note that I'm just typing in bits that should
syntactically be fine and that's it.
-Rob

On 11/21/05, PATERSON, Robert <r.paterson@ioof.com.au> wrote:
> Do you have your sample source file? Might help in tracking things down.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test1.rb
Type: application/octet-stream
Size: 163 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051121/b7a7ac12/test1.obj
From nbsherid at secsme.org.au  Mon Nov 21 22:03:49 2005
From: nbsherid at secsme.org.au (Nigel Sheridan-Smith)
Date: Mon Nov 21 22:03:42 2005
Subject: [antlr-interest] Truely, a BASIC question
In-Reply-To: <738584f80511211938u608d01c6m1fcf45c0a5930f2b@mail.gmail.com>
Message-ID: <000601c5ef2a$82552450$0500a8c0@nigel>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Rob Greene
> Sent: Tuesday, 22 November 2005 2:38 PM
> To: ANTLR Interest
> Subject: [antlr-interest] Truely, a BASIC question
> 
> I am most definitely new to ANTLR. I'm working out a grammar file for
> a BASICish language where line endings are important. Language
> statements do not end with a colon uniformly - instead it is most
> likely a newline that separates statements. I haven't discovered any
> tutorials that covers this and haven't located any information in the
> documentation.
> 
> What I've tried:
> * optionally allow the colon separator - but that allows stuff like
> "goto this goto that" instead of requiring a colon/newline between
> commands ("goto this : goto that").
> * pulled newline out of the WS variable (?? terminology) in my grammar
> file and added a separator rule of "( COLON | NEWLINE )+" to require
> one or more separators and then attempt to use the rule appropriately.
> This seems to work, but I get odd errors:
> 
> line 8:15: unexpected token:
> 
> line 9:9: unexpected token:
> 
> line 10:1: unexpected token:
> 
> line 11:1: unexpected token: gosub
> 

Hi Rob,

It all looks legit to me, but maybe I am missing something.

Can you send the input file that reproduces those errors? 

Thanks,

Nigel

P.S. The line 'LT: "<"; ' might cause trouble with ANTLR look-ahead.

--
Nigel Sheridan-Smith
PhD research student

Faculty of Engineering
University of Technology, Sydney
Phone: 02 9514 7946
Fax: 02 9514 2435


From nbsherid at secsme.org.au  Mon Nov 21 22:17:56 2005
From: nbsherid at secsme.org.au (Nigel Sheridan-Smith)
Date: Mon Nov 21 22:17:48 2005
Subject: [antlr-interest] Truely, a BASIC question
In-Reply-To: <000601c5ef2a$82552450$0500a8c0@nigel>
Message-ID: <000001c5ef2c$7ab5a010$0500a8c0@nigel>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Nigel Sheridan-Smith
> Sent: Tuesday, 22 November 2005 5:04 PM
> To: 'ANTLR Interest'
> Subject: RE: [antlr-interest] Truely, a BASIC question
> 
> 
> 
> Hi Rob,
> 
> It all looks legit to me, but maybe I am missing something.
> 
> Can you send the input file that reproduces those errors?
> 

I hooked up a quick test (attached) and I can't get it to go wrong... it
appears to be working correctly with the simple input I am giving it.

So, yeah... send us your input file.

Nigel

--
Nigel Sheridan-Smith
PhD research student

Faculty of Engineering
University of Technology, Sydney
Phone: 02 9514 7946
Fax: 02 9514 2435

-------------- next part --------------
A non-text attachment was scrubbed...
Name: rbasic.java
Type: text/java
Size: 282 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051122/5ac29c3c/rbasic-0001.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rbasic.g
Type: application/octet-stream
Size: 3513 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051122/5ac29c3c/rbasic-0001.obj
From nbsherid at secsme.org.au  Tue Nov 22 00:31:50 2005
From: nbsherid at secsme.org.au (Nigel Sheridan-Smith)
Date: Tue Nov 22 00:31:40 2005
Subject: [antlr-interest] Truely, a BASIC question
In-Reply-To: <000001c5ef2c$7ab5a010$0500a8c0@nigel>
Message-ID: <000001c5ef3f$2f519120$0500a8c0@nigel>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Nigel Sheridan-Smith
> Sent: Tuesday, 22 November 2005 5:18 PM
> To: 'ANTLR Interest'
> Subject: RE: [antlr-interest] Truely, a BASIC question
> 
> 
> 
> 
> I hooked up a quick test (attached) and I can't get it to go wrong... it
> appears to be working correctly with the simple input I am giving it.
> 

This was resolved by Rob Patterson - missing '*' on the expressions.

Nigel

--
Nigel Sheridan-Smith
PhD research student

Faculty of Engineering
University of Technology, Sydney
Phone: 02 9514 7946
Fax: 02 9514 2435


From Anthony.Youngman at eca-international.com  Tue Nov 22 03:48:48 2005
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Tue Nov 22 03:48:53 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
Message-ID: <C7FE35004D40FD45AA342991B88CE404012900B5@lnml1.eca-international.local>

ALL databases?

Sorry for jumping on my hobbyhorse, but from your other messages, you
seem to be assuming that columns and tables are universals. They are NOT
:-)

Cheers,
Wol

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Jan H. van der
Ven
Sent: 16 November 2005 15:26
To: antlr-interest@antlr.org
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.

Hi,


I am currently working on a SQL parser (we want to support all
databases,
but I am taking baby steps). I used the MS SQL select statement from
Tomasz Jastrzebski that can be downloaded from antlr.org. It checks my
statements ok, but that is not the only result I am looking for.

What I want is that after the parsing the tokens contain extra
information
about their syntactic nature. For instance, the parser will find out
that
a certain 'identifier' is actually a column and I would like that
knowledge to become part of the token or the AST.

I am new to all of this, so if this is something you guys do all day
please let me know.

If it is not, could you point me in the right direction.


Kind regards,


Jan van der Ven


* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From mail at martin-probst.com  Tue Nov 22 05:01:45 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 22 05:02:05 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
In-Reply-To: <C7FE35004D40FD45AA342991B88CE404012900B5@lnml1.eca-international.local>
References: <C7FE35004D40FD45AA342991B88CE404012900B5@lnml1.eca-international.local>
Message-ID: <1132664505.14747.20.camel@localhost.localdomain>

> ALL databases?
> 
> Sorry for jumping on my hobbyhorse, but from your other messages, you
> seem to be assuming that columns and tables are universals. 

Plus, I've once worked at a company producing a relational database that
provided some sort of a compatibility mode for Oracle. They were nicely
implementing all the Oracle bugs. Those were known to Oracle, but they
just didn't care because of their market power.
Be aware that there is an SQL standard, but that's only used for
teaching students. There is not a single implementation that you could
call compliant to the standard, not even close to. AFAIK Postgres is
closest, but Oracle is _really_ different (e.g. "" === NULL and other
funny things).

Your probably aware of that, so how do you want to create a
cross-database SQL parser?

Martin

From Anthony.Youngman at eca-international.com  Tue Nov 22 07:00:04 2005
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Tue Nov 22 07:00:10 2005
Subject: [antlr-interest] Upgrade a token/AST from inside the parser.
Message-ID: <C7FE35004D40FD45AA342991B88CE404012900B9@lnml1.eca-international.local>

And my comment was because I'm a fan of MV databases. You can use SQL to
access those, but because they are not 1NF, you need a load of extra
commands to massage the data to look like it's relational ... (for
example, UNNEST).

Cheers,
Wol 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Martin Probst
Sent: 22 November 2005 13:02
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] Upgrade a token/AST from inside the
parser.

> ALL databases?
> 
> Sorry for jumping on my hobbyhorse, but from your other messages, you
> seem to be assuming that columns and tables are universals. 

Plus, I've once worked at a company producing a relational database that
provided some sort of a compatibility mode for Oracle. They were nicely
implementing all the Oracle bugs. Those were known to Oracle, but they
just didn't care because of their market power.
Be aware that there is an SQL standard, but that's only used for
teaching students. There is not a single implementation that you could
call compliant to the standard, not even close to. AFAIK Postgres is
closest, but Oracle is _really_ different (e.g. "" === NULL and other
funny things).

Your probably aware of that, so how do you want to create a
cross-database SQL parser?

Martin


* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From Anthony.Youngman at eca-international.com  Tue Nov 22 07:06:56 2005
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Tue Nov 22 07:07:00 2005
Subject: [antlr-interest] Serious Bug when using BitSetgeneration
Message-ID: <C7FE35004D40FD45AA342991B88CE404012900BA@lnml1.eca-international.local>

And YOU aren't paying the ANTLR team either.

Maybe if you were, you'd carry more weight when you try to call the
shots.

Cheers,
Wol

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Geir Ove
Skjaervik
Sent: 18 November 2005 21:15
To: 'ANTLR Interest'
Subject: RE: [antlr-interest] Serious Bug when using BitSetgeneration

Hello,

Obviosuly you haven't read my previous postings on this: I have said
that I will post an example of the problem WHEN I am able to produce a
small case that shows the problem and WHEN I have the time for it on my
project: My clients are NOT paying me to post bug reports to you. Surely
you know how that works.

Who said I am taking the ANTLR team for gratnted ? As a matter of fact,
I have on several occasions thanked Terrence for bringing this great
tool to the community.

However, none of this fixes the bug. It is wasted bandwith on this
forum.


Geir Ove

-----Original Message-----
From: Akhilesh Mritunjai [mailto:virtualaspirin@yahoo.com] 
Sent: 18. november 2005 21:30
To: Geir Ove Skjaervik; 'ANTLR Interest'
Subject: RE: [antlr-interest] Serious Bug when using BitSetgeneration


Geir

I've been using ANTLR a bit longer than you, and my
perception is different.

If you're a developer with any significant experience
I'd expect you to know the basics of QA process.

While logging a bug one is supposed to give
description of the problem with a test case in which
bug is at least sometimes reproducible.

This has been iterated again and again, many people
think it is an interesting and priority bug, *if* it
infact exists. So far you have not provided any inputs
to demonstrate it is there!

Understand that its hard to look for a something if
you dont even know how it looks like or if its infact
there.

Oh, and taking people who work for nothing and provide
a tool of this quality, for granted, *is NOT polite*.
If you can't invest time to come up with a testcase
how do you expect people to spend their time hunting
down something that may or may not be there just
because someone sent a feedback 'hey I think its
there!'


- Akhilesh

--- Geir Ove Skjaervik <geiroves@online.no> wrote:

> Hello,
> 
> Are we supposed to take this kind of feedback
> seriously? You may make
> fun of other peoples problems, but does this kind of
> feedback belong
> here?
> 
> You clearly do not understand the nature of the
> problem, or you would
> not have replied the way you do; and when you do not udnerstand, why
> don't you refreain from replying?
> 
> a) Switching to 3.x is NOT an option after having
> written about 5000
> lines of Parser and Tree Parser code
> 
> b) If it is a limitation, ANTLR should warn you
> about that.
> 
> c) The workaround means avoiding BitSets alltogehter
> for ** everyone **.
> As long as we (programmers and the ANTLR developemnt
> team) does NOT
> understand the nature of the problem, then we do NOT
> know when this bug
> strikes!
> 
> d) Avoiding BitSets all the time means two things: 
>    i) Performance takes a big hit
>    ii) Why are they there if all they can do is pose
> a BIG problem in
> unknown situations
> 
> 
> 
> 
> Geir Ove
> 
> 
> Geir Ove
> 
> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Jim Idle
> Sent: 18. november 2005 04:24
> To: ANTLR Interest
> Subject: RE: [antlr-interest] Serious Bug when using
> BitSetgeneration
> 
> 
>  
> 
> ________________________________
> 
> From: antlr-interest-bounces@antlr.org on behalf of
> Geir Ove Skjaervik
> 
> 
> Jim Idle wrote:
> 
> > Hello,
> 
> > Just one more comment on this Bug. It is **
> clearly ** a bug, since
> > ANTLR does work correctly when BitSets are NOT
> used.
> 
> Well, it could be just a limitation, perhaps catered
> for with a few
> tweaks, or perhaps better addressed with efforts in
> the Antlr 3 space.
> 
> >I find it strange
> > that this Bug  seems to be passed in almost
> silence: I would think it
> >to  be rather serious to have a "sleeping" bug that
> may come and bite
> >you  any time you encounter the right conditions.
> 
> > Terrence asked me to try to produce a small
> grammar example to try to
> > reproduce the problem. I will as soon as time on
> my project permits
> > it.
> 
> Hmmm - I thought you said it was a serious bug?
> Can't be THAT serious
> can it? ;-)
> 
> > BUT I would think it is equally IMPORTANT for the
> ANTLR team to try to
> 
> > hunt down this ** serious ** bug. It is nice that
> ANTLR 3.0 is under
> > development, but we sure need a strong ** core **
> technology that
> > won't fail.
> 
> Well, the last time I was there I noticed that beer
> and pizza were
> significantly more expensive in San Francsico than
> most other parts of
> the world except Geneva. I am sure that donating a
> few vouchers for same
> would make this bug very much more important.
> Remember that it is free
> (for you anyway) and we should be careful to give
> out a bit of respect
> for people's time and efforts given freely :-).
> 
> Jim
> 
> 
> 
> 



		
__________________________________ 
Yahoo! FareChase: Search multiple travel sites in one click.
http://farechase.yahoo.com



* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From Anthony.Youngman at eca-international.com  Tue Nov 22 07:18:43 2005
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Tue Nov 22 07:18:47 2005
Subject: [antlr-interest] Re: lexer "modes" for XML parsing etc...
Message-ID: <C7FE35004D40FD45AA342991B88CE404012900BB@lnml1.eca-international.local>

Okay, the language has evolved, but this (if I'm following correctly)
would be perfect for parsing DATABASIC. The original language
specification actually WAS a state table, if I understand the history
correctly. The flowchart is long lost, but its existence was well known.

I don't know how well the modern language would lex/parse that way, but
it would probably make life a lot easier.

Cheers,
Wol 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Martin Probst
Sent: 20 November 2005 23:41
To: antlr-interest@antlr.org
Subject: Re: [antlr-interest] Re: lexer "modes" for XML parsing etc...

Hi,

> context SQL {
> ID : ... ;
> ACTION : ...;
> STRING : ... ;
> ENDSQL : ')' {popContext();}
> }
> 
> context island2 {
> ...
> }

> Sounds easy.  Is this what we want?  It is proper for island grammars

> that feed off the same input stream.  Multiple input streams like  
> include files need to be handled with a multiplexing input buffer.

That's exactly what I was hoping for. Though I'm not so much into island
grammars for different languages, but rather different states for the
same language, e.g. an operator state (where 'and' is the binary
operator) and a default state (where 'and' is a QName) etc. - that's the
problem I have to tackle. This would help a lot in both cases.

> [note the push/pop rather than simple set; very useful]

Yes, I nearly forgot that. We need push/pop and set.

Martin


* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From poess at ira.uka.de  Tue Nov 22 07:30:18 2005
From: poess at ira.uka.de (Bernhard Poess)
Date: Tue Nov 22 07:30:31 2005
Subject: [antlr-interest] building cgram
Message-ID: <4383398A.2000208@ira.uka.de>

Hi folks,

I've got some problems building the GNU C grammar files, I've searched
the web for about two hours now, but was not able to find a solution.
When I try to run make in the grammars dir, I get the attached output.
Help would be very appreciated.

java -version:
java version "1.4.2_07"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_07-b05)
Java HotSpot(TM) Client VM (build 1.4.2_07-b05, mixed mode)

echo $CLASSPATH:
/home/poess/programming/antlr/antlr-install/lib/antlr.jar

Thanks in advance,
bernhard
-------------- next part --------------
A non-text attachment was scrubbed...
Name: output.log
Type: text/x-log
Size: 17369 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051122/34f30706/output-0001.bin
From monty at codetransform.com  Tue Nov 22 09:03:52 2005
From: monty at codetransform.com (Monty Zukowski)
Date: Tue Nov 22 09:07:01 2005
Subject: [antlr-interest] building cgram
In-Reply-To: <4383398A.2000208@ira.uka.de>
References: <4383398A.2000208@ira.uka.de>
Message-ID: <43834F78.1020603@codetransform.com>

Bernhard Poess wrote:
> Hi folks,
> 
> I've got some problems building the GNU C grammar files, I've searched
> the web for about two hours now, but was not able to find a solution.
> When I try to run make in the grammars dir, I get the attached output.
> Help would be very appreciated.
> 

Did you modify the makefile or grammar files?  You've got a problem
because classes like CSymbolTable are not part of a named package, and
java isn't finding them in the classpath.

Monty
From prashant.deva at gmail.com  Tue Nov 22 09:34:37 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Tue Nov 22 09:34:41 2005
Subject: [antlr-interest] ANTLR Studio RELEASED !!!
Message-ID: <41fed8f80511220934n10b172bg8452ae30a4775217@mail.gmail.com>

Yes, its finally released!!!

You can get all the info at http://antlrstudio.com.

Please read the latest blog posting on details about the release.

For those who dont already know, ANTLR Studio is a (supercool) ;-) IDE for
ANTLR which plugs into eclipse and allows you to edit, debug and visualize
your grammars.

--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com <http://www.antlrstudio.com>
Founder, Placid Systems, www.placidsystems.com<http://www.placidsystems.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051122/dbefd090/attachment.html
From parrt at cs.usfca.edu  Tue Nov 22 11:51:26 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 22 11:51:27 2005
Subject: [antlr-interest] Re: [stringtemplate-interest] $r.st vs $r.template
In-Reply-To: <4269E50D-E603-406F-9D5F-8A694D9A8756@infonie.fr>
References: <C043B228-AF7B-411D-8AF5-AD9D30020B54@cs.usfca.edu>
	<4269E50D-E603-406F-9D5F-8A694D9A8756@infonie.fr>
Message-ID: <524CFAFB-C27A-4DEC-8724-588B7782E663@cs.usfca.edu>


On Nov 21, 2005, at 10:13 PM, Laurent Vaucher wrote:
>   Hi.
>
>> formalParameter
>>     :   type declarator
>>         -> parameter(type={$type.st},name={$declarator.st})
>>     ;
>>
>> ST is an officially approved abbreviation for StringTemplate in  
>> email though ;)  Perhaps it's ok.
>
>   Tough decision you've got here. Of course .template is more  
> explicit but if that "ANTLR+ST" is to become mainstream, we'll soon  
> regret the short option. "Don't underestimate the power of  
> conciseness." (I probably read that in some essay from Paul Graham).

So are you saying short is good or bad?  I'm leaning now  
towards .template again.

>> By the way, do you like that ANTLR+ST integration?  I've got it  
>> working and am converting my cminus.g translator to this v3  
>> stuff.  Should be done shortly.
>
>   Not tried yet, though I'm working on a PowerBuilder->JavaScript  
> expression translator (with ANTLR-2.7 and hand-written code  
> generation). Is ANTLR v3 stable enough to use or is it still moving  
> too much?

Well, Jim Idle claims to have working stuff with it.  The only  
changes will be some small syntax changes for actions most likely.   
The biggest issue is that bad input makes it crash ;)  That's my next  
big project after getting ST integrated.

Ter
From euluis at zmail.pt  Tue Nov 22 17:42:44 2005
From: euluis at zmail.pt (Luis Sergio Oliveira)
Date: Tue Nov 22 17:43:08 2005
Subject: language independent C++ grammar [was Re: [antlr-interest] Updated
	C++ parser version 3.1 published November	2005]
In-Reply-To: <4381B758.7060804@lsbu.ac.uk>
References: <4381B758.7060804@lsbu.ac.uk>
Message-ID: <4383C914.9030208@zmail.pt>

Hello David and ANTLR fellows,

first of all thanks for your grammar, it provides a fundamental basis 
for my work in the
ArgoUML C++ module.

I was waiting for your update to propose a joint effort to further 
develop the grammar.
Currently I'm using a version of your grammar which was ported to Java 
by Yolanda Jargudo
and enriched by callbacks as needed by ArgoUML reverse engineering of 
C++ code.

Now, the callbacks are poluting the grammar code and I will work in 
replacing them by
AST statements that besides being more according to ANTLR spirit, are 
also language
independent and therefore provide better reuse opportunities. I'll also 
diff the your updated
grammar against 3.0 to get the improvements and corrections into the 
ported version.

But, all this would be much more desirable if we could have the whole 
grammar base defined
in a language independent way. So, is this feasible - to have a grammar 
which is usable
by C++, Java, Python and other languages without having to hand port it 
from the C++ version
every time David provides a new update?

I notice that the examples with ANTLR are made available in several 
languages. Is there some
particular magic that enables this automatically or is it out of manual 
porting efforts?

-- 
Luis Sergio Oliveira


David Wigg wrote:

> Hello C++ parsers,
>
> I have uploaded our updated C++ parser, CPP_parser.g Version 3.1
> November 2005, to the list of grammars on the antlr website at
> http://www.antlr.org/grammar/list to replace Version 3.0 July 2004.
>
> It still uses ANTLR 2.7.3 but it should work with all later
> versions of ANTLR 2.7.? . I may be able to produce a version
> which uses ANTLR 3.?  next year.
>
> Please note that this latest version still assumes input of
> preprocessed C/C++ programs and produces lexers and parsers
> written in C++.
>
> This version has been improved by the cooperation of users who
> have submitted problem code which the previous version, V.3.0
> July 2004, could not parse.
>
> I realise that introducing an updated version of a parser
> entails extra work but I hope that by using my method of
> subclassing your application code that this work will be reduced
> to a minimum. See MyReadMe3.1.txt for further information.
>
> This version includes additional features to assist debugging as
> follows,
>
> *   Statement trace feature which as supplied is ON for
> demonstration purposes. It can be turned ON/OFF in CPP_parser.g or 
> CPPParser.cpp.
>
> *   ANTLR trace feature which requires replacing LLkParser.cpp
> and LLkParser.hpp with slightly modified version supplied. It can be 
> turned ON/OFF in CPP_parser.g or CPPParser.cpp.
>
> *   A slightly modified version of Parser.cpp which produces
> error messages to cout as well as cerr.
>
> Please see MyReadMe3.1.txt for further information.
>
> You can use the preprocessed program Quadratic.i in
> ...\CPP_parserV3.1\TestIfiles to verify correct installation.
>
> I welcome queries and questions from users.
>
> David Wigg
> Research Fellow
> Centre for Systems and Software Engineering
> London South Bank University
> London, UK
> wiggjd@bcs.org.uk
> blackse@lsbu.ac.uk
>
>

From parrt at cs.usfca.edu  Tue Nov 22 22:26:14 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 22 22:26:20 2005
Subject: [antlr-interest] Re: [stringtemplate-interest] $r.st vs $r.template
In-Reply-To: <AA0650A8-4E18-4C8A-91E5-7DDFDEB0FFBE@infonie.fr>
References: <C043B228-AF7B-411D-8AF5-AD9D30020B54@cs.usfca.edu>
	<4269E50D-E603-406F-9D5F-8A694D9A8756@infonie.fr>
	<524CFAFB-C27A-4DEC-8724-588B7782E663@cs.usfca.edu>
	<AA0650A8-4E18-4C8A-91E5-7DDFDEB0FFBE@infonie.fr>
Message-ID: <DE9D3D17-100A-467A-A367-78E6F3B9FF81@cs.usfca.edu>


On Nov 22, 2005, at 10:10 PM, Laurent Vaucher wrote:

>>
>> So are you saying short is good or bad?  I'm leaning now  
>> towards .template again.
>>
>
>   Well, I don't have an a priori opinion. What I wanted to say was  
> that for something that is not used very often, the long explicit  
> name is the good choice (no need for a lookup in the manual, the  
> name says it all). But if it is something that appears in every  
> rule for a translation grammar, I think it will feel heavy  
> (everything is already in the reader's short-term memory, so  
> there's no need for a long descriptive name).

A very good point.  Damn, just when I was convinced that .template  
was right.  .st looks wrong but it is really long to type and believe  
me, you'll use it in every rule...

Ter
From parrt at cs.usfca.edu  Tue Nov 22 22:38:59 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 22 22:39:01 2005
Subject: [antlr-interest] do we need "..." and '.' ??
Message-ID: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>

howdy.  For string literals like keywords in ANTLR v3, I use "void"  
and "int" in double quotes.  For single char like semi-colon etc... I  
use single quotes like ';' and '{'.  Is there a real reason to do  
this?  None from ANTLR's point of view.  I'm even thinking that it  
really complicates my code.  Programmers used to C/Java family will  
grok it immediately but many languages don't distinguish between one  
and multi-lettered strings.  All they do is get dumped down into the  
lexer for matching anyway.

Can anybody think of a reason to have single-quote mean single char  
string?  The single-quotes could be useful for something else in the  
future.  One must be frugal with the use of symbols ;)

Ter
From bsl04 at uark.edu  Tue Nov 22 23:36:42 2005
From: bsl04 at uark.edu (brian)
Date: Tue Nov 22 23:36:44 2005
Subject: [antlr-interest] action syntax
Message-ID: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>

If I do
type:("char"|"int") name:IDENTIFIER
{ do something with 'type' and 'name' }
in the parser, ANTLR tells me there's no variable 'type'.

If I make TYPE:"char"|"int"; in the lexer and say type:TYPE instead in
the parser and try to parse some sensible data, I always get "unexpected
token: char" or "unexpected token: int" as if it doesn't see I said to
expect TYPE and that I wanted to refer to it in the action as 'type'.

Thanks for any help.
From antlr at shmuelhome.mine.nu  Tue Nov 22 23:55:39 2005
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Tue Nov 22 23:55:57 2005
Subject: [antlr-interest] do we need "..." and '.' ??
In-Reply-To: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>
References: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>
Message-ID: <4384207B.5020405@shmuelhome.mine.nu>

Terence Parr wrote:
> 
> Can anybody think of a reason to have single-quote mean single char  
> string?  The single-quotes could be useful for something else in the  
> future.  One must be frugal with the use of symbols ;)
> 
> Ter
Probably not the answer that you were looking for but I feel that the 
main use of dropping the distinction would be to allow embedded quotes 
without escape characters.  From your point of view, is this desirable.



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.362 / Virus Database: 267.13.5/178 - Release Date: 11/22/2005



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.362 / Virus Database: 267.13.5/178 - Release Date: 11/22/2005

From mritun at gmail.com  Wed Nov 23 01:29:24 2005
From: mritun at gmail.com (Akhilesh Mritunjai)
Date: Wed Nov 23 01:26:58 2005
Subject: [antlr-interest] do we need "..." and '.' ??
In-Reply-To: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>
References: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>
Message-ID: <op.s0osnaq75qofyi@mritunjai.intra.powailabs.com>

Hi

No, we don't need both. I have not been able to come up with a use case  
for both.

However, in several place we need embedded quotes or double quotes. So it  
might be worthwhile to ponder over making it python like where single  
quotes and double quotes are equivalent when used as string delimiters.

- Akhilesh


On Wed, 23 Nov 2005 12:08:59 +0530, Terence Parr <parrt@cs.usfca.edu>  
wrote:

> howdy.  For string literals like keywords in ANTLR v3, I use "void" and  
> "int" in double quotes.  For single char like semi-colon etc... I use  
> single quotes like ';' and '{'.  Is there a real reason to do this?   
> None from ANTLR's point of view.  I'm even thinking that it really  
> complicates my code.  Programmers used to C/Java family will grok it  
> immediately but many languages don't distinguish between one and  
> multi-lettered strings.  All they do is get dumped down into the lexer  
> for matching anyway.
>
> Can anybody think of a reason to have single-quote mean single char  
> string?  The single-quotes could be useful for something else in the  
> future.  One must be frugal with the use of symbols ;)
>
> Ter



-- 
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/
From mritun at gmail.com  Wed Nov 23 01:34:12 2005
From: mritun at gmail.com (Akhilesh Mritunjai)
Date: Wed Nov 23 01:31:44 2005
Subject: [antlr-interest] action syntax
In-Reply-To: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
Message-ID: <op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>


> If I do
> type:("char"|"int") name:IDENTIFIER
> { do something with 'type' and 'name' }
> in the parser, ANTLR tells me there's no variable 'type'.

Its my favorite pet-peeve with ANTLR. Labels are extremely limited in how  
they can be used.

> If I make TYPE:"char"|"int"; in the lexer and say type:TYPE instead in
> the parser and try to parse some sensible data, I always get "unexpected
> token: char" or "unexpected token: int" as if it doesn't see I said to

Nope. It'd conflict with identifier.

The solution is:

typeName: "int" | "char";

decl:
   type:typeName name:IDENTIFIER
{
   // do whatever
}
;


-- 
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/
From open.zone at virgin.net  Wed Nov 23 02:50:48 2005
From: open.zone at virgin.net (Micheal J)
Date: Wed Nov 23 02:35:18 2005
Subject: language independent C++ grammar [was Re: [antlr-interest]
	UpdatedC++ parser version 3.1 published November	2005]
In-Reply-To: <4383C914.9030208@zmail.pt>
Message-ID: <001101c5f01b$c47089a0$6b02a8c0@hercules>

> But, all this would be much more desirable if we could have the whole 
> grammar base defined
> in a language independent way. So, is this feasible - to have 
> a grammar 
> which is usable
> by C++, Java, Python and other languages without having to 
> hand port it 
> from the C++ version
> every time David provides a new update?
> 
> I notice that the examples with ANTLR are made available in several 
> languages. Is there some
> particular magic that enables this automatically or is it out 
> of manual 
> porting efforts?

Magic?. Yes. I do believe Ter has a team of dedicated elfs punching away on
keybaords at ANTLR HQ somewhere near Lapland......  ;-)

As to the problems of supporting multiple language versions of a single
grammar, Bodgan Mitu's annotation tool (the ASP grammar guy - Anakreon I
think his name was - did an update to it) offers one way of achieving this.
You can find it here:
	http://parr-research.com/share/1081982914285/annotation20040415.tgz

Anakreon's ASP grammars project is also an example of how to use the tool -
http://storm.cs.unipi.gr/~anakreon/aspa.html


Basically, it allows you to keep the grammar itself in one file and the
actions in another (one file per language). The grammar has place holders
for all the actions. You then add an extra step to your build process that
run a tool to combine the grammar template and an action template to
generate your *.g file.

Cheers,

Micheal

From rui at obando.org  Wed Nov 23 02:47:37 2005
From: rui at obando.org (Rui Maranhao)
Date: Wed Nov 23 02:47:40 2005
Subject: [antlr-interest] basic question
In-Reply-To: <41fed8f80511220934n10b172bg8452ae30a4775217@mail.gmail.com>
Message-ID: <20051123104738.86DE019635D@plunder.dreamhost.com>

Hi all, 

 

 

   I am trying to use an ANSI C parser and I am stucked in one step. Since I
am using Windows, I am trying to preprocess the c code using cl. Does
anybody knows how to preprocess the source code for ANSI C compliance. When
I preprocess using cl I get all those annoying Microsoft directives and I
don't know how to get rid of it.

 

I am sorry for this email which is not completely related with ANTLR.

 

Kind Regards,  

   Rui

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051123/41f6784c/attachment.html
From prashant.deva at gmail.com  Wed Nov 23 02:58:19 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Wed Nov 23 02:58:21 2005
Subject: [antlr-interest] (Please) Rate ANTLR Studio
Message-ID: <41fed8f80511230258w78b5097bi7d1a91c841d33cb6@mail.gmail.com>

I have put ANTLR Studio on Eclipse plugin Central (
www.eclipseplugincentral.com)

You can see the listing here-
http://www.eclipseplugincentral.com/Web_Links+index-req-viewlink-cid-498.html

If you like ANTLR Studio, please click on the 'Rate this web site' link or
go to -
http://www.eclipseplugincentral.com/Web_Links+index-req-ratelink-lid-471-ttitle-ANTLR_Studio.html
and enter a rating (preferably a comment too) ;-)

Thanks,
--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051123/9d97520d/attachment-0001.html
From mproud at gmail.com  Wed Nov 23 03:48:19 2005
From: mproud at gmail.com (Martin Proud)
Date: Wed Nov 23 03:48:21 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on Darwin/Mac
	OS X
Message-ID: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>

Hello ANTLR Community,

Please forgive me if I am in the wrong place. Perhaps you would be so
kind to direct me otherwise?

I downloaded the 2.7.5 source distribution from the ANTLR web page to
my desktop. I then did ./configure in the terminal on my Mac running
OS X 10.4.3 and PPC Darwin 8.3.0 and it configured just fine (except
for saying C# support would be disabled, which is fine by me - it's
not like I can run .NET anyway).

When I went to make, however, I ran into a slew of errors.

As far as I know, I have GNU make, unless you need a certain version
number? Output from the configure step:

checking for make... /usr/bin/make
checking for gmake... no
checking for gnumake... /usr/bin/gnumake
checking for /bin/make... no
checking for /usr/bin/make... yes
checking whether /usr/bin/make is GNU make... yes
checking for make... /usr/bin/make

Also, I've got jikes and javac:

checking for java... /usr/bin/java
checking for gij... no
checking for jikes... /usr/bin/jikes
checking for javac... /usr/bin/javac
checking for gcj... no
checking for jar... /usr/bin/jar

So the errors: here's the first one:


mini:~/Desktop/antlr-2.7.5 martinproud$ make
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>> make -C ./antlr all
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
*** compiling 209 Java file(s)

Found 1 semantic error compiling "ASTFactory.java":

                                <
    26. public class ASTFactory {
   . . .
   410. }
        >
*** Semantic Error: A class file was not generated for the type
"antlr.ASTFactory" because a library method that it depends on was not
found. See system messages for more information.


And here's another error later on, on something as trivial as an
import statement, for Java Swing:


    15. import javax.swing.*;
               ^---------^
*** Semantic Error: You need to modify your classpath, sourcepath,
bootclasspath, and/or extdirs setup. Jikes could not find package
"javax.swing" in:
               
/System/Library/Frameworks/JavaVM.framework/Versions/1.3.1/Classes/classes.jar
                /Users/martinproud/Desktop/antlr-2.7.5/antlr/antlr.jar
                /Users/martinproud/Desktop/antlr-2.7.5/scripts/..


I don't know what's going on here. Java 1.3.1 is installed by default,
as well as 1.4.1 and I've even got 5.0, so I can't imagine the trouble
is with java. Could jikes be giving me the jitters? Do I need any
special flags for configure or make? Any ideas? (Does anyone want my
config.status file?)

Thanks,

Proud
From kroepke at dolphin-services.de  Wed Nov 23 04:22:01 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Wed Nov 23 04:22:10 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
Message-ID: <2DE43585-FCE4-4F4F-A2A2-96930C2A1ED5@dolphin-services.de>


On 23. Nov 2005, at 12:48 Uhr, Martin Proud wrote:

> I downloaded the 2.7.5 source distribution from the ANTLR web page to
> my desktop. I then did ./configure in the terminal on my Mac running
> OS X 10.4.3 and PPC Darwin 8.3.0 and it configured just fine (except
> for saying C# support would be disabled, which is fine by me - it's
> not like I can run .NET anyway).

  Martin,

jikes doesn't play well (for reasons which I can't remember ;).
To force configure to use javac just use:
JAVAC=java ./configure

(assuming you use bash)

Then all's well in the state of Denmark.

Regards,

Kay (who always forgets to use JAVAC=javac, too)
From poess at ira.uka.de  Wed Nov 23 04:59:46 2005
From: poess at ira.uka.de (Bernhard Poess)
Date: Wed Nov 23 05:00:06 2005
Subject: [antlr-interest] building cgram
In-Reply-To: <43834F78.1020603@codetransform.com>
References: <4383398A.2000208@ira.uka.de> <43834F78.1020603@codetransform.com>
Message-ID: <438467C2.1070405@ira.uka.de>

Monty Zukowski wrote:
> Bernhard Poess wrote:
> 
>>Hi folks,
>>
>>I've got some problems building the GNU C grammar files, I've searched
>>the web for about two hours now, but was not able to find a solution.
>>When I try to run make in the grammars dir, I get the attached output.
>>Help would be very appreciated.
>>
> 
> 
> Did you modify the makefile or grammar files?  You've got a problem
> because classes like CSymbolTable are not part of a named package, and
> java isn't finding them in the classpath.
> 
> Monty
> 
No, I didn't modify anything.
I'm building on a Suse 10.0 workstation if that helps.

Bernhard
From mproud at gmail.com  Wed Nov 23 05:01:49 2005
From: mproud at gmail.com (Martin Proud)
Date: Wed Nov 23 05:01:52 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <2DE43585-FCE4-4F4F-A2A2-96930C2A1ED5@dolphin-services.de>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
	<2DE43585-FCE4-4F4F-A2A2-96930C2A1ED5@dolphin-services.de>
Message-ID: <c16aa4e00511230501q19eebd10u43ce925879e6930@mail.gmail.com>

Thank you for the tip, Kay!

I entered that and configured again. And then I make'd. Looks like
another error (hehe, nice and obscure as well):

mini:~/Desktop/antlr-2.7.5 martinproud$ make
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>> make -C ./antlr all
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
*** compiling 209 Java file(s)
Unrecognized option: -d
Could not create the Java virtual machine.

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                      >> E R R O R <<
============================================================


which is followed by a list of all the java source files.

Suggestions?

Martin


On 11/23/05, Kay Roepke <kroepke@dolphin-services.de> wrote:
>
> On 23. Nov 2005, at 12:48 Uhr, Martin Proud wrote:
>
> > I downloaded the 2.7.5 source distribution from the ANTLR web page to
> > my desktop. I then did ./configure in the terminal on my Mac running
> > OS X 10.4.3 and PPC Darwin 8.3.0 and it configured just fine (except
> > for saying C# support would be disabled, which is fine by me - it's
> > not like I can run .NET anyway).
>
>   Martin,
>
> jikes doesn't play well (for reasons which I can't remember ;).
> To force configure to use javac just use:
> JAVAC=java ./configure
>
> (assuming you use bash)
>
> Then all's well in the state of Denmark.
>
> Regards,
>
> Kay (who always forgets to use JAVAC=javac, too)
>
From kroepke at dolphin-services.de  Wed Nov 23 05:12:43 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Wed Nov 23 05:12:48 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <c16aa4e00511230501q19eebd10u43ce925879e6930@mail.gmail.com>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
	<2DE43585-FCE4-4F4F-A2A2-96930C2A1ED5@dolphin-services.de>
	<c16aa4e00511230501q19eebd10u43ce925879e6930@mail.gmail.com>
Message-ID: <D1AC6B52-3FE7-4BD9-AAC1-0EED8F1F60CB@dolphin-services.de>


On 23. Nov 2005, at 14:01 Uhr, Martin Proud wrote:

> Unrecognized option: -d
> Could not create the Java virtual machine.

mhm. strange. You are using the JavaVM 1.3.1, right?
The '-d' is set in antlr-2.7.5/scripts/javac.sh, which is used to  
compile the java classes.
I cannot see right now, why that should be a problem.
Could you look where your /usr/bin/javac points to? (It should go
into /System/Library/Frameworks/JavaVM.framework/Commands/javac (in  
which
Commands is a symlink to ./Versions/CurrentJDK/Commands)

Might that be the trouble? For it builds nicely, but I'm always using  
the "CurrentJDK" version...

HTH, Kay
From tommy.nordgren at chello.se  Wed Nov 23 05:29:16 2005
From: tommy.nordgren at chello.se (Tommy Nordgren)
Date: Wed Nov 23 05:29:22 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
Message-ID: <B6809DA1-6FE9-46E7-9594-950E780FA1E8@chello.se>

Building on MacOS X requires either,
a) Overriding the default choice of Jikes in favor of javac,
or b) Explicitly setting the environment vaiable BOOTCLASSPATH to the  
directory containing
the standard Jar archives.

Nov 23, 2005 kl. 12:48 PM skrev Martin Proud:

> Hello ANTLR Community,
>
> Please forgive me if I am in the wrong place. Perhaps you would be so
> kind to direct me otherwise?
>
> I downloaded the 2.7.5 source distribution from the ANTLR web page to
> my desktop. I then did ./configure in the terminal on my Mac running
> OS X 10.4.3 and PPC Darwin 8.3.0 and it configured just fine (except
> for saying C# support would be disabled, which is fine by me - it's
> not like I can run .NET anyway).
>
> When I went to make, however, I ran into a slew of errors.
>
> As far as I know, I have GNU make, unless you need a certain version
> number? Output from the configure step:
>
> checking for make... /usr/bin/make
> checking for gmake... no
> checking for gnumake... /usr/bin/gnumake
> checking for /bin/make... no
> checking for /usr/bin/make... yes
> checking whether /usr/bin/make is GNU make... yes
> checking for make... /usr/bin/make
>
> Also, I've got jikes and javac:
>
> checking for java... /usr/bin/java
> checking for gij... no
> checking for jikes... /usr/bin/jikes
> checking for javac... /usr/bin/javac
> checking for gcj... no
> checking for jar... /usr/bin/jar
>
> So the errors: here's the first one:
>
>
> mini:~/Desktop/antlr-2.7.5 martinproud$ make
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>> make -C ./antlr all
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> *** compiling 209 Java file(s)
>
> Found 1 semantic error compiling "ASTFactory.java":
>
>                                 <
>     26. public class ASTFactory {
>    . . .
>    410. }
>>
> *** Semantic Error: A class file was not generated for the type
> "antlr.ASTFactory" because a library method that it depends on was not
> found. See system messages for more information.
>
>
> And here's another error later on, on something as trivial as an
> import statement, for Java Swing:
>
>
>     15. import javax.swing.*;
>                ^---------^
> *** Semantic Error: You need to modify your classpath, sourcepath,
> bootclasspath, and/or extdirs setup. Jikes could not find package
> "javax.swing" in:
>
> /System/Library/Frameworks/JavaVM.framework/Versions/1.3.1/Classes/ 
> classes.jar
>                 /Users/martinproud/Desktop/antlr-2.7.5/antlr/antlr.jar
>                 /Users/martinproud/Desktop/antlr-2.7.5/scripts/..
>
>
> I don't know what's going on here. Java 1.3.1 is installed by default,
> as well as 1.4.1 and I've even got 5.0, so I can't imagine the trouble
> is with java. Could jikes be giving me the jitters? Do I need any
> special flags for configure or make? Any ideas? (Does anyone want my
> config.status file?)
>
> Thanks,
>
> Proud

-------------------------------------
This sig is dedicated to the advancement of Nuclear Power
Tommy Nordgren
tommy.nordgren@chello.se



From kroepke at dolphin-services.de  Wed Nov 23 05:51:30 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Wed Nov 23 05:51:34 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <B6809DA1-6FE9-46E7-9594-950E780FA1E8@chello.se>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
	<B6809DA1-6FE9-46E7-9594-950E780FA1E8@chello.se>
Message-ID: <8C328CEF-C6B6-4D5F-A7A0-2BEA67B7E814@dolphin-services.de>


On 23. Nov 2005, at 14:29 Uhr, Tommy Nordgren wrote:

> b) Explicitly setting the environment vaiable BOOTCLASSPATH to the  
> directory containing
> the standard Jar archives.

That's the reason what I always forget...;)

- Kay
From mproud at gmail.com  Wed Nov 23 06:08:06 2005
From: mproud at gmail.com (Martin Proud)
Date: Wed Nov 23 06:08:09 2005
Subject: [antlr-interest] Trouble making 2.7.5 during install on
	Darwin/Mac OS X
In-Reply-To: <B6809DA1-6FE9-46E7-9594-950E780FA1E8@chello.se>
References: <c16aa4e00511230348w644a5379g2da323499ea22e91@mail.gmail.com>
	<B6809DA1-6FE9-46E7-9594-950E780FA1E8@chello.se>
Message-ID: <c16aa4e00511230608o3c4b8fecvea59edfca5944541@mail.gmail.com>

Thanks for the info, Tommy. You are correct.

So I ended up just renaming /usr/bin/jikes to /usr/bin/disabled-jikes
(hehe, well it sounded like an easier thing to do) and whaddya know?
it seems to be working now. (And now to change it back...)

Thanks everyone,

Martin


On 11/23/05, Tommy Nordgren <tommy.nordgren@chello.se> wrote:
> Building on MacOS X requires either,
> a) Overriding the default choice of Jikes in favor of javac,
> or b) Explicitly setting the environment vaiable BOOTCLASSPATH to the
> directory containing
> the standard Jar archives.
>
> Nov 23, 2005 kl. 12:48 PM skrev Martin Proud:
>
> > Hello ANTLR Community,
> >
> > Please forgive me if I am in the wrong place. Perhaps you would be so
> > kind to direct me otherwise?
> >
> > I downloaded the 2.7.5 source distribution from the ANTLR web page to
> > my desktop. I then did ./configure in the terminal on my Mac running
> > OS X 10.4.3 and PPC Darwin 8.3.0 and it configured just fine (except
> > for saying C# support would be disabled, which is fine by me - it's
> > not like I can run .NET anyway).
> >
> > When I went to make, however, I ran into a slew of errors.
> >
> > As far as I know, I have GNU make, unless you need a certain version
> > number? Output from the configure step:
> >
> > checking for make... /usr/bin/make
> > checking for gmake... no
> > checking for gnumake... /usr/bin/gnumake
> > checking for /bin/make... no
> > checking for /usr/bin/make... yes
> > checking whether /usr/bin/make is GNU make... yes
> > checking for make... /usr/bin/make
> >
> > Also, I've got jikes and javac:
> >
> > checking for java... /usr/bin/java
> > checking for gij... no
> > checking for jikes... /usr/bin/jikes
> > checking for javac... /usr/bin/javac
> > checking for gcj... no
> > checking for jar... /usr/bin/jar
> >
> > So the errors: here's the first one:
> >
> >
> > mini:~/Desktop/antlr-2.7.5 martinproud$ make
> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> >>> make -C ./antlr all
> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> > *** compiling 209 Java file(s)
> >
> > Found 1 semantic error compiling "ASTFactory.java":
> >
> >                                 <
> >     26. public class ASTFactory {
> >    . . .
> >    410. }
> >>
> > *** Semantic Error: A class file was not generated for the type
> > "antlr.ASTFactory" because a library method that it depends on was not
> > found. See system messages for more information.
> >
> >
> > And here's another error later on, on something as trivial as an
> > import statement, for Java Swing:
> >
> >
> >     15. import javax.swing.*;
> >                ^---------^
> > *** Semantic Error: You need to modify your classpath, sourcepath,
> > bootclasspath, and/or extdirs setup. Jikes could not find package
> > "javax.swing" in:
> >
> > /System/Library/Frameworks/JavaVM.framework/Versions/1.3.1/Classes/
> > classes.jar
> >                 /Users/martinproud/Desktop/antlr-2.7.5/antlr/antlr.jar
> >                 /Users/martinproud/Desktop/antlr-2.7.5/scripts/..
> >
> >
> > I don't know what's going on here. Java 1.3.1 is installed by default,
> > as well as 1.4.1 and I've even got 5.0, so I can't imagine the trouble
> > is with java. Could jikes be giving me the jitters? Do I need any
> > special flags for configure or make? Any ideas? (Does anyone want my
> > config.status file?)
> >
> > Thanks,
> >
> > Proud
>
> -------------------------------------
> This sig is dedicated to the advancement of Nuclear Power
> Tommy Nordgren
> tommy.nordgren@chello.se
>
>
>
>
From poess at ira.uka.de  Wed Nov 23 06:21:29 2005
From: poess at ira.uka.de (Bernhard Poess)
Date: Wed Nov 23 06:21:40 2005
Subject: [antlr-interest] building cgram
In-Reply-To: <43834F78.1020603@codetransform.com>
References: <4383398A.2000208@ira.uka.de> <43834F78.1020603@codetransform.com>
Message-ID: <43847AE9.5040508@ira.uka.de>

Hi,

I've finally got it running, the problem whas with my classpath. For
everybody who might get the same problems here what I had to do:

Set $CLASSPATH:
export CLASSPATH=.:/path/to/antlr.jar

be aware of the ., it is important.

After that remove the lines

import CToken
import LineObject

from

TNode.java
StdCParser.g
GnuCParser.g
expandedGnuCParser.g

After that, delete all class files (make clean does *not* work) and do a
make all.

Bernhard
From bsl04 at uark.edu  Wed Nov 23 08:24:19 2005
From: bsl04 at uark.edu (brian)
Date: Wed Nov 23 08:24:22 2005
Subject: [antlr-interest] action syntax
In-Reply-To: <op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
Message-ID: <Pine.GSO.4.58.0511231015530.10053@comp.uark.edu>

On Wed, 23 Nov 2005, Akhilesh Mritunjai wrote:

> The solution is:
> typeName: "int" | "char";
> decl:
>    type:typeName name:IDENTIFIER
> {
>    // do whatever
> }
> ;

I wish. But when I do this and try to do something with the variable
'type' within the braces, I always get a compiler error telling me that
'type' is undefined.

This stuff fails with "cannot find symbol" (referring to the variable
'type'):
typeName: "int" | "char";
decl: type:typeName name:IDENTIFIER { System.out.println(type.getText());
};

From endigitalmind at yahoo.co.uk  Wed Nov 23 09:15:33 2005
From: endigitalmind at yahoo.co.uk (Phil Ritchie)
Date: Wed Nov 23 09:15:37 2005
Subject: [antlr-interest] Making a contribution.
Message-ID: <20051123171533.3600.qmail@web25811.mail.ukl.yahoo.com>

What would constitute a requisite/realistic amount of
time, programming ability and parser knowledge to
volunteer/qualify in order to make a worthwhile
contribution to antlr? (I would only feel confident
about contributing to the C# effort.)

Phil.


		
___________________________________________________________ 
How much free photo storage do you get? Store your holiday 
snaps for FREE with Yahoo! Photos http://uk.photos.yahoo.com
From parrt at cs.usfca.edu  Wed Nov 23 09:59:12 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 09:59:10 2005
Subject: [antlr-interest] action syntax
In-Reply-To: <op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
Message-ID: <E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>


On Nov 23, 2005, at 1:34 AM, Akhilesh Mritunjai wrote:

>
>> If I do
>> type:("char"|"int") name:IDENTIFIER
>> { do something with 'type' and 'name' }
>> in the parser, ANTLR tells me there's no variable 'type'.
>
> Its my favorite pet-peeve with ANTLR. Labels are extremely limited  
> in how they can be used.

Mine too. ;)  Fixed in v3. ;)

Ter
From parrt at cs.usfca.edu  Wed Nov 23 09:59:59 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 09:59:56 2005
Subject: [antlr-interest] do we need "..." and '.' ??
In-Reply-To: <op.s0osnaq75qofyi@mritunjai.intra.powailabs.com>
References: <E9ACA31E-46E3-4973-AEF1-6DD3262B2300@cs.usfca.edu>
	<op.s0osnaq75qofyi@mritunjai.intra.powailabs.com>
Message-ID: <E25901A7-B0EF-40EA-8FAE-12C93F8497FB@cs.usfca.edu>


On Nov 23, 2005, at 1:29 AM, Akhilesh Mritunjai wrote:

> Hi
>
> No, we don't need both. I have not been able to come up with a use  
> case for both.
>
> However, in several place we need embedded quotes or double quotes.  
> So it might be worthwhile to ponder over making it python like  
> where single quotes and double quotes are equivalent when used as  
> string delimiters.

Yeah, seems like we should drop '.' for now and later perhaps make it  
mean something else.

Ok, i'll rework the examples & tests (ugh) and the code.

Ter
From parrt at cs.usfca.edu  Wed Nov 23 10:01:13 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 10:01:11 2005
Subject: [antlr-interest] Making a contribution.
In-Reply-To: <20051123171533.3600.qmail@web25811.mail.ukl.yahoo.com>
References: <20051123171533.3600.qmail@web25811.mail.ukl.yahoo.com>
Message-ID: <8F91CD41-C4F1-4C1C-8580-0E7F494F268A@cs.usfca.edu>


On Nov 23, 2005, at 9:15 AM, Phil Ritchie wrote:

> What would constitute a requisite/realistic amount of
> time, programming ability and parser knowledge to
> volunteer/qualify in order to make a worthwhile
> contribution to antlr? (I would only feel confident
> about contributing to the C# effort.)

Hi Phil,

The easiest thing to do is build grammars and/or actual translators  
etc...  Michael J "owns" the C# output for v2 and presumably for  
v3...he might be able to use some help :)

Ter
From parrt at cs.usfca.edu  Wed Nov 23 10:15:57 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 10:15:55 2005
Subject: [antlr-interest] dynamically scoped attribute syntax
Message-ID: <1E484C0F-DA84-467A-8AF0-150FC3E0EA26@cs.usfca.edu>

I've changed my mind on this syntax too (yet more changes in my tests/ 
examples).  John Mitchell and others warned me that access to  
dynamically scoped stuff vs parameters etc... should be syntactically  
different.  I agreed but was loath to use an extra valuable char like  
@, which I note is now very useful for actions.

Anyway, imagine how things currently work:

function returns [String funcName]
scope {
	String name;
}
	: "function" ID {$name=$ID.text; $funcName=$name;} args body ;

body : ... {System.out.println("fname="+$function.name);} ;

Since function calls body, body can access the dynamic scope of  
function.  You must explicitly say was is visible with the scope  
notation.  Setting the dynamic value $name looks exactly like the  
parameter $funcName.  In the body rule, you must specifically  
reference the scope with the attribute as $function.name, but this  
still doesn't scream "the value is in another rule, dude!"

I am proposing to avoid use of a special '@' symbol or whatever in  
favor of the C++ style scope override "::".  THat said, I think the  
distinction should be sort of "local" vs "global" so that you can say  
$name inside the rule that defines the scope, but you must use  
$scope::name in an invoked rule like body:

function returns [String funcName]
scope {
	String name;
}
	: "function" ID {$name=$ID.text; $funcName=$name;} args body ;

body : ... {System.out.println("fname="+$function::name);} ;

What about shared global scopes?  I propose that we always have to  
use the fully-qualified scope in this case.

scope Symbols {
	List names;
}

classDef
scope Symbols;
init {
	$Symbols::names = new ArrayList();
}
	:	... {$Symbols::names.add("foo");} ;

body
scope Symbols;
init {
	$Symbols::names = new ArrayList();
}
	:	... {$Symbols::names.add("foo");} ;

Speaking of which, we need to be able to specify some init code in  
the global scope so we can avoid code duplication and do avoid  
forgetting.  I shied away from it originally because I didn't know  
what the syntax would look like and whether it would be useful.  This  
bit me hard yesterday when building an ANTLR+ST example.  How about  
just adding the init action into the scope?

scope Symbols {
	List names;
	init {
		$Symbols::names = new ArrayList();
	}
}

Actually I'll be using probably @init {...} (yet another tweak to the  
syntax...sorry! It's rapidly converging though I'm letting actual  
experience show me my faulty syntax).

That's a lot to think about but does anybody wanna comment?  I added  
to blog:

http://www.antlr.org/blog/antlr3/rewrite.tml

Ter
From naghmeh.daneshmand at informatik.uni-ulm.de  Wed Nov 23 10:26:01 2005
From: naghmeh.daneshmand at informatik.uni-ulm.de (Naghmeh Daneshmand)
Date: Wed Nov 23 10:26:21 2005
Subject: [antlr-interest] AST to Java
In-Reply-To: <20051123171533.3600.qmail@web25811.mail.ukl.yahoo.com>
References: <20051123171533.3600.qmail@web25811.mail.ukl.yahoo.com>
Message-ID: <4384B439.40203@informatik.uni-ulm.de>

Hi,

is it possible to reproduce a java program (code) from a changed tree 
(AST)? The point is that I have produced a tree (AST) from a java 
program. As you know one can change the tree. I need to produce a java 
proram code from the changed tree. Is this possible?

if yes, how?

Do you have examples for this?

Thank you in advance for your support

Naghmeh


From parrt at cs.usfca.edu  Wed Nov 23 11:22:06 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 11:22:03 2005
Subject: [antlr-interest] quoted strings round 2
Message-ID: <206D6DE8-161B-499C-BEB5-E25CEEB61B61@cs.usfca.edu>

Ok, so in the lexer does "0".."9" look funny?  What about ("x"|"y")?

Looks funny, but it's cool as long as I use a predicate to ensure the  
length is 1 (sensitive to escapes that is).

Ter
From parrt at cs.usfca.edu  Wed Nov 23 12:44:30 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 12:44:26 2005
Subject: [antlr-interest] new attribute ref syntax
Message-ID: <E8D6C42F-5E37-4E31-A614-39FD32960514@cs.usfca.edu>

here is the comment on the ActionTranslator related to translated $y,  
$x.y, $x::y notation:

/** This class embodies the translation of actions written in the target
*  language but containing special references that must be translated
*  for reasons of terseness and isolation from underlying  
implementation.
*
*  There are three forms of interest:
*
* 	$y		return value, parameter, rule or token label, predefined
* 			rule property, or token or rule reference within the enclosing
* 			rule's outermost alt. y must be a "local" reference; i.e., it
* 			must be referring to something defined within the enclosing rule.
*
* 			r[int i] returns [int j]
* 				:	{$i, $j, $start, $stop, $template, $tree}
* 					(ids+=ID)+ {$ids.size()} // .size is not used by antlr here
* 				;
*
* 	$x.y	if x is enclosing rule, y is a return value, parameter, or
* 			predefined property.  If x is a token label, y is predefined
* 			property of a token.  If x is a rule label, y is a return value
* 			of the invoked rule or a predefined rule property such as "stop".
* 			If x is a token referenced in that alt, it behaves like a token
* 			label.  If x is a rule reference in that alt, it behaves like
* 			a rule label.
*
* 			r[int i] returns [int j]
* 				:	{$r.i, $r.j, $r.start, $r.stop, $r.template, $r.tree}
* 					ID {$ID.text} s {$s.start; $s.k}
* 				;
* 			s returns [int k] : ... ;
*
* 	$x::y	the only way to access the attributes within a dynamic scope
* 			regardless of whether or not you are in the defining rule.
*
* 			scope Symbols { List names; }
* 			r
* 			scope {int i;}
* 			scope Symbols;
* 				:	{$r::i=3;} s {$Symbols::names;}
* 				;
* 			s	:	{$r::i; $Symbols::names;}
* 				;
*
*  This is the new syntax as of 11/23/2005 and should simplify things  
a bit
*  as all dynamic scope stuff is accessed with a different operator.   
Actually
*  all it does is make the set of scopes to search for $y a bit  
smaller.  Oh,
*  and I should be able to be more specific with error messages.
*/

Ter
From jimi at temporal-wave.com  Wed Nov 23 12:56:22 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed Nov 23 12:56:25 2005
Subject: [antlr-interest] quoted strings round 2
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BEFF@wavemachine.temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Terence Parr
> Sent: Wednesday, November 23, 2005 11:22 AM
> To: ANTLR Interest
> Subject: [antlr-interest] quoted strings round 2
> 
> Ok, so in the lexer does "0".."9" look funny?  

I quite like this, but perhaps it is because I am just used to it.

> What about ("x"|"y")?

This looks strange to me. I would vote to keep the .., but at the end of
the day I don't hate this.

> 
> Looks funny, but it's cool as long as I use a predicate to ensure the
> length is 1 (sensitive to escapes that is).
> 
> Ter
From jimi at temporal-wave.com  Wed Nov 23 13:02:21 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed Nov 23 13:02:23 2005
Subject: [antlr-interest] dynamically scoped attribute syntax
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BF00@wavemachine.temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Terence Parr
> Sent: Wednesday, November 23, 2005 10:16 AM
> To: ANTLR Interest
> Subject: [antlr-interest] dynamically scoped attribute syntax
> 
> I've changed my mind on this syntax too (yet more changes in my tests/
> examples).

> In the body rule, you must specifically
> reference the scope with the attribute as $function.name, but this
> still doesn't scream "the value is in another rule, dude!"
> 
> I am proposing to avoid use of a special '@' symbol or whatever in
> favor of the C++ style scope override "::".  

I totally agree with this as I have had issues with the $stuff not being
able to work out what I meant.

> THat said, I think the
> distinction should be sort of "local" vs "global" so that you can say
> $name inside the rule that defines the scope, but you must use
> $scope::name in an invoked rule like body:

Gets my vote.
 
> What about shared global scopes?  I propose that we always have to
> use the fully-qualified scope in this case.

I agree.

> Speaking of which, we need to be able to specify some init code in
> the global scope so we can avoid code duplication and do avoid
> forgetting.  I shied away from it originally because I didn't know
> what the syntax would look like and whether it would be useful.  This
> bit me hard yesterday when building an ANTLR+ST example.  How about
> just adding the init action into the scope?
> 
> scope Symbols {
> 	List names;
> 	init {
> 		$Symbols::names = new ArrayList();
> 	}
> }
> 
> Actually I'll be using probably @init {...} 

I am in favor of all of this. Very much so... so can you type it in now
so I get on with the C code generator? ;-)

Jim
From parrt at cs.usfca.edu  Wed Nov 23 13:03:07 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 13:03:03 2005
Subject: [antlr-interest] quoted strings round 2
In-Reply-To: <B36CCC332A32904F8FA3DE134A23533615BEFF@wavemachine.temporal-wave.com>
References: <B36CCC332A32904F8FA3DE134A23533615BEFF@wavemachine.temporal-wave.com>
Message-ID: <9BAF7E08-ADAF-4540-B80D-8443100F74DD@cs.usfca.edu>


On Nov 23, 2005, at 12:56 PM, Jim Idle wrote:

>
>
>> -----Original Message-----
>> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
>> bounces@antlr.org] On Behalf Of Terence Parr
>> Sent: Wednesday, November 23, 2005 11:22 AM
>> To: ANTLR Interest
>> Subject: [antlr-interest] quoted strings round 2
>>
>> Ok, so in the lexer does "0".."9" look funny?
>
> I quite like this, but perhaps it is because I am just used to it.
>
>> What about ("x"|"y")?
>
> This looks strange to me. I would vote to keep the .., but at the  
> end of
> the day I don't hate this.

Well we need both actually so you can have sets of chars...

Ter
From jimi at temporal-wave.com  Wed Nov 23 13:05:25 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed Nov 23 13:05:28 2005
Subject: [antlr-interest] quoted strings round 2
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BF01@wavemachine.temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> >> Ok, so in the lexer does "0".."9" look funny?
> >
> > I quite like this, but perhaps it is because I am just used to it.
> >
> >> What about ("x"|"y")?
> >
> 
> Well we need both actually so you can have sets of chars...

I see what you're getting at.

Jim
From parrt at cs.usfca.edu  Wed Nov 23 13:12:57 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 13:12:55 2005
Subject: [antlr-interest] dynamically scoped attribute syntax
In-Reply-To: <B36CCC332A32904F8FA3DE134A23533615BF00@wavemachine.temporal-wave.com>
References: <B36CCC332A32904F8FA3DE134A23533615BF00@wavemachine.temporal-wave.com>
Message-ID: <29E99962-3EFF-4B34-9CCC-14AF742DAC2C@cs.usfca.edu>


On Nov 23, 2005, at 1:02 PM, Jim Idle wrote:
>> THat said, I think the
>> distinction should be sort of "local" vs "global" so that you can say
>> $name inside the rule that defines the scope, but you must use
>> $scope::name in an invoked rule like body:
>
> Gets my vote.

I decided that any ref to a dynamically scoped attribute (even inside  
rule that defines the attribute) should use $x::y.  Just made the  
implementation cleaner :)  Also, Jean in ANTLRWorks will be able to  
highlight all refs with potentially nonlocal effects :)

>> Speaking of which, we need to be able to specify some init code in
>> the global scope so we can avoid code duplication and do avoid
>> forgetting.  I shied away from it originally because I didn't know
>> what the syntax would look like and whether it would be useful.  This
>> bit me hard yesterday when building an ANTLR+ST example.  How about
>> just adding the init action into the scope?
>>
>> scope Symbols {
>> 	List names;
>> 	init {
>> 		$Symbols::names = new ArrayList();
>> 	}
>> }
>>
>> Actually I'll be using probably @init {...}

> I am in favor of all of this. Very much so... so can you type it in  
> now
> so I get on with the C code generator? ;-)

Turns out putting the init inside is very hard.  The whole thing is  
language independent and I just get ACTION from the ANTLR lexer.  I  
am thinking that we need something like:

   scope Foo {...}
   @Foo::init {...} // to be consistent with scope access?

then we'd also allow

@header {...}
@lexer::header {...}

etc...

Working on the x::y thing now...60 unit tests to change and all the  
examples! ;)

Ter



From mritun at gmail.com  Wed Nov 23 13:28:49 2005
From: mritun at gmail.com (Akhilesh Mritunjai)
Date: Wed Nov 23 13:26:28 2005
Subject: [antlr-interest] action syntax
In-Reply-To: <E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
	<E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>
Message-ID: <op.s0ppybdh5qofyi@mritunjai.intra.powailabs.com>

On Wed, 23 Nov 2005 23:29:12 +0530, Terence Parr <parrt@cs.usfca.edu>  
wrote:
>> Its my favorite pet-peeve with ANTLR. Labels are extremely limited in  
>> how they can be used.
>
> Mine too. ;)  Fixed in v3. ;)


You mean I can do something like:

rule:
(
    a:branch0
  | a:branch1
  | a:branch2
)
{
   doSomething(a);
}

Its obvious that branch0/1/2 are mutually exclusive, but ANTLR does't  
allow same label for them, so I need to write

rule:
   a:branch0 { doSomething(a); }
| b:branch1 { doSomething(b); }
| c:branch2 { doSomething(c); }

Which doesn't look nice when I have 20 branches.

- Akhilesh
From parrt at cs.usfca.edu  Wed Nov 23 13:35:11 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 23 13:35:09 2005
Subject: [antlr-interest] action syntax
In-Reply-To: <op.s0ppybdh5qofyi@mritunjai.intra.powailabs.com>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
	<E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>
	<op.s0ppybdh5qofyi@mritunjai.intra.powailabs.com>
Message-ID: <17333C44-CA71-47C3-85F5-71DCFF05F8EB@cs.usfca.edu>


On Nov 23, 2005, at 1:28 PM, Akhilesh Mritunjai wrote:

> On Wed, 23 Nov 2005 23:29:12 +0530, Terence Parr  
> <parrt@cs.usfca.edu> wrote:
>>> Its my favorite pet-peeve with ANTLR. Labels are extremely  
>>> limited in how they can be used.
>>
>> Mine too. ;)  Fixed in v3. ;)
>
>
> You mean I can do something like:
>
> rule:
> (
>    a:branch0
>  | a:branch1
>  | a:branch2
> )
> {
>   doSomething(a);
> }

Correct.

Ter
From bsl04 at uark.edu  Wed Nov 23 13:43:26 2005
From: bsl04 at uark.edu (brian)
Date: Wed Nov 23 13:43:28 2005
Subject: [antlr-interest] ANT ANTLR task with 3.0?
In-Reply-To: <17333C44-CA71-47C3-85F5-71DCFF05F8EB@cs.usfca.edu>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>
	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>
	<E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>
	<op.s0ppybdh5qofyi@mritunjai.intra.powailabs.com>
	<17333C44-CA71-47C3-85F5-71DCFF05F8EB@cs.usfca.edu>
Message-ID: <Pine.GSO.4.58.0511231538510.19034@comp.uark.edu>

Sorry to be a little off-topic. So far, I can't make ANT use my ANTLR 3
jar for its antlr task. If someone knows how to do it or why I shouldn't,
please let me know. Thanks.
From chris at lotuscat.com  Wed Nov 23 13:58:36 2005
From: chris at lotuscat.com (Chris Black)
Date: Wed Nov 23 13:58:42 2005
Subject: [antlr-interest] ANT ANTLR task with 3.0?
In-Reply-To: <Pine.GSO.4.58.0511231538510.19034@comp.uark.edu>
References: <Pine.GSO.4.58.0511230128110.2603@comp.uark.edu>	<op.s0osvaqh5qofyi@mritunjai.intra.powailabs.com>	<E570721B-A886-45F9-BAF6-F83A2F0D3558@cs.usfca.edu>	<op.s0ppybdh5qofyi@mritunjai.intra.powailabs.com>	<17333C44-CA71-47C3-85F5-71DCFF05F8EB@cs.usfca.edu>
	<Pine.GSO.4.58.0511231538510.19034@comp.uark.edu>
Message-ID: <4384E60C.3060205@lotuscat.com>

brian wrote:

>Sorry to be a little off-topic. So far, I can't make ANT use my ANTLR 3
>jar for its antlr task. If someone knows how to do it or why I shouldn't,
>please let me know. Thanks.
>  
>
I don't know what platform you are on, but make sure you don't have an 
antlr 2.7.x jars in your java lib directory (often /usr/share/java/ on 
unix) or in your ant lib directory (/usr/share/ant/lib on unix).

Hope this helps,
Chris
From euluis at zmail.pt  Wed Nov 23 14:41:19 2005
From: euluis at zmail.pt (Luis Sergio Oliveira)
Date: Wed Nov 23 14:41:44 2005
Subject: language independent C++ grammar [was Re:
	[antlr-interest]	UpdatedC++
	parser version 3.1 published November	2005]
In-Reply-To: <001101c5f01b$c47089a0$6b02a8c0@hercules>
References: <001101c5f01b$c47089a0$6b02a8c0@hercules>
Message-ID: <4384F00F.4050609@zmail.pt>


Micheal J wrote:

>>But, all this would be much more desirable if we could have the whole 
>>grammar base defined
>>in a language independent way. So, is this feasible - to have 
>>a grammar 
>>which is usable
>>by C++, Java, Python and other languages without having to 
>>hand port it 
>>from the C++ version
>>every time David provides a new update?
>>
>>I notice that the examples with ANTLR are made available in several 
>>languages. Is there some
>>particular magic that enables this automatically or is it out 
>>of manual 
>>porting efforts?
>>    
>>
>
>Magic?. Yes. I do believe Ter has a team of dedicated elfs punching away on
>keybaords at ANTLR HQ somewhere near Lapland......  ;-)
>
>As to the problems of supporting multiple language versions of a single
>grammar, Bodgan Mitu's annotation tool (the ASP grammar guy - Anakreon I
>think his name was - did an update to it) offers one way of achieving this.
>You can find it here:
>	http://parr-research.com/share/1081982914285/annotation20040415.tgz
>
>Anakreon's ASP grammars project is also an example of how to use the tool -
>http://storm.cs.unipi.gr/~anakreon/aspa.html
>
>
>  
>
Thanks Micheal,

the annotation tool seams to fit my wishes, but, why isn't this used for 
simplifying
the ANTLR examples maintenance?... Well, maybe because it is cheaper to 
feed the
elfs ;-)

So, David, I'll try to use the annotation tool and if it works I'll get 
back with a C++ and
Java version of the grammar. If not I'll report the failure anyway. Are 
you interested?

-- 
Luis Sergio Oliveira



From jimi at temporal-wave.com  Wed Nov 23 18:46:56 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed Nov 23 18:46:58 2005
Subject: [antlr-interest] ANT ANTLR task with 3.0?
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BF02@wavemachine.temporal-wave.com>

Actually, I am not sure (I see an answer later that sort of implies that
it can, but that was not my experience so far) that the 2.7.5 task will
be able to handle ANTLR3 without a few tweaks. 

I was going to look at it as I hate hard coding the build using a java
task. However I don't really know enough about ANT to check out the
current task definition. I would be interested in an ABTLR3 task if
someone would write it :-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of brian
> Sent: Wednesday, November 23, 2005 1:43 PM
> To: antlr-interest@antlr.org
> Subject: [antlr-interest] ANT ANTLR task with 3.0?
> 
> Sorry to be a little off-topic. So far, I can't make ANT use my ANTLR
3
> jar for its antlr task. If someone knows how to do it or why I
shouldn't,
> please let me know. Thanks.
From thiago.arrais at gmail.com  Wed Nov 23 19:24:31 2005
From: thiago.arrais at gmail.com (Thiago Arrais)
Date: Wed Nov 23 19:24:38 2005
Subject: [antlr-interest] Lexer - Counting from zero
Message-ID: <e163e2f50511231924s4fe6fd7aq@mail.gmail.com>

I am writing a lexer with Antlr and I need it to keep track of the
line and column information. The standard way didn't suffice my needs,
because I needed to start the count at 0, not at 1. So, I overrid the
makeToken() method on my Lexer to reduce the coordinates by one.

It works, but I don't like it. Just seems too hacky for me. Is there
some standard way to do that? I browsed through the docs and the list
archives but the only advice I found was to override the consume()
method (on the manual). That looked even hackier to me.

Cheers,

Thiago Arrais
From sohail at taggedtype.net  Wed Nov 23 22:44:18 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Wed Nov 23 22:44:27 2005
Subject: [antlr-interest] Lexer - Counting from zero
In-Reply-To: <e163e2f50511231924s4fe6fd7aq@mail.gmail.com>
References: <e163e2f50511231924s4fe6fd7aq@mail.gmail.com>
Message-ID: <1132814658.8252.0.camel@localhost.localdomain>

On Wed, 2005-23-11 at 23:24 -0400, Thiago Arrais wrote:
> I am writing a lexer with Antlr and I need it to keep track of the
> line and column information. The standard way didn't suffice my needs,
> because I needed to start the count at 0, not at 1. So, I overrid the
> makeToken() method on my Lexer to reduce the coordinates by one.

Dude, nothing wrong with this. Thats why java makes every function
virtual :)

From thiago.arrais at gmail.com  Thu Nov 24 03:33:30 2005
From: thiago.arrais at gmail.com (Thiago Arrais)
Date: Thu Nov 24 03:33:32 2005
Subject: [antlr-interest] Lexer - Counting from zero
In-Reply-To: <1132814658.8252.0.camel@localhost.localdomain>
References: <e163e2f50511231924s4fe6fd7aq@mail.gmail.com>
	<1132814658.8252.0.camel@localhost.localdomain>
Message-ID: <e163e2f50511240333v3010edf8j@mail.gmail.com>

2005/11/24, Sohail Somani <sohail@taggedtype.net>:
> Dude, nothing wrong with this. Thats why java makes every function
> virtual :)

My problem isn't really with the the virtual function. What I don't
like is to set a counter twice and to calculate more that necessary on
a method that is called for every created token. I am not that
perfomance paranoid, I just would rather say 'Hey, lexer, start
counting from 0' and what I am doing is let him count the way he
counts and them converting to my needs. It seems cleaner to me.

I sure can live with that, but I'd like to know if there are other
solutions. How do people do people deal with this problem?

Regards,

Thiago Arrais
From Oliver.Kowalke at infineon.com  Thu Nov 24 04:55:57 2005
From: Oliver.Kowalke at infineon.com (Oliver.Kowalke@infineon.com)
Date: Thu Nov 24 04:56:06 2005
Subject: [antlr-interest] why will this be parsed (no exception)?
Message-ID: <7509DD89A305F34E9EF16F1EEDFB80AF0176DE14@drsse401.eu.infineon.com>

Hello,
if I let parse the string "adder && repeater quatsch" I doen't get an
exception thrown. Why? 'quatsch' is not be recognized in the
productions.
I hope you can give me some advice how to get this right (throw an
exception).
With best regards,
Oliver

options
{
	language="Cpp";
	namespace="ymfl";
}

class FilterLexer extends Lexer;
options 
{
    k=2;
    exportVocab=YMFL;
    charVocabulary='\u0000'..'\u007F';
    caseSensitive=false;
    caseSensitiveLiterals=false;
}

tokens
{
	ADDER = "adder";
	REPEATER = "repeater";
}

AND
	options { paraphrase = "&&"; }
	: "&&"
;

OR
	options { paraphrase = "||"; }
	: "||"
;

NOT
	options { paraphrase = "!"; }
	: '!'
;

DELIM 
	options { paraphrase = "an delimeter (' ' \t \f \r \n)"; }
	: ( ' '
	| '\t'
	| '\f'
	|	( "\r\n"
		| '\r'
		| '\n'
		)
		{ newline(); }
	)
	{ $setType( antlr::Token::SKIP ); }
;

IDENT
	options {testLiterals=true;}
	: ('a'..'z') ('a'..'z'|'0'..'9')*
;

/////////////////////////////////////////////////////////////////////
//	Parser
/////////////////////////////////////////////////////////////////////

class FilterParser extends Parser;

options 
{	
    k=2;
    exportVocab=YMFL;
}

existence_op
	: 
	(
		ADDER
	|	REPEATER
	)
;

primitive
	: 
	existence_op
;

negation_expression
	: 
	(
		primitive
		| NOT primitive
	)
;

expression
	: negation_expression
	( 
		(
			AND	
		|	OR	
		) 
		negation_expression
	)*
;

run
	: expression
;
From demakov at ispras.ru  Thu Nov 24 05:07:56 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Thu Nov 24 05:07:42 2005
Subject: [antlr-interest] why will this be parsed (no exception)?
References: <7509DD89A305F34E9EF16F1EEDFB80AF0176DE14@drsse401.eu.infineon.com>
Message-ID: <023201c5f0f8$160466b0$8cc79553@marlboro>

It's because you don't have EOF at the end of run rule:

run
: expression EOF
;

and parser simply returns after it found something that is not a part of expression

Now it will try to match EOF but wil find IDENT
 
Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: <Oliver.Kowalke@infineon.com>
To: <antlr-interest@antlr.org>
Sent: Thursday, November 24, 2005 3:55 PM
Subject: [antlr-interest] why will this be parsed (no exception)?


> Hello,
> if I let parse the string "adder && repeater quatsch" I doen't get an
> exception thrown. Why? 'quatsch' is not be recognized in the
> productions.
> I hope you can give me some advice how to get this right (throw an
> exception).
> With best regards,
> Oliver
> 
> options
> {
> language="Cpp";
> namespace="ymfl";
> }
> 
> class FilterLexer extends Lexer;
> options 
> {
>    k=2;
>    exportVocab=YMFL;
>    charVocabulary='\u0000'..'\u007F';
>    caseSensitive=false;
>    caseSensitiveLiterals=false;
> }
> 
> tokens
> {
> ADDER = "adder";
> REPEATER = "repeater";
> }
> 
> AND
> options { paraphrase = "&&"; }
> : "&&"
> ;
> 
> OR
> options { paraphrase = "||"; }
> : "||"
> ;
> 
> NOT
> options { paraphrase = "!"; }
> : '!'
> ;
> 
> DELIM 
> options { paraphrase = "an delimeter (' ' \t \f \r \n)"; }
> : ( ' '
> | '\t'
> | '\f'
> | ( "\r\n"
> | '\r'
> | '\n'
> )
> { newline(); }
> )
> { $setType( antlr::Token::SKIP ); }
> ;
> 
> IDENT
> options {testLiterals=true;}
> : ('a'..'z') ('a'..'z'|'0'..'9')*
> ;
> 
> /////////////////////////////////////////////////////////////////////
> // Parser
> /////////////////////////////////////////////////////////////////////
> 
> class FilterParser extends Parser;
> 
> options 
> { 
>    k=2;
>    exportVocab=YMFL;
> }
> 
> existence_op
> : 
> (
> ADDER
> | REPEATER
> )
> ;
> 
> primitive
> : 
> existence_op
> ;
> 
> negation_expression
> : 
> (
> primitive
> | NOT primitive
> )
> ;
> 
> expression
> : negation_expression
> ( 
> (
> AND 
> | OR 
> ) 
> negation_expression
> )*
> ;
> 
> run
> : expression
> ;
> 
>

From poess at ira.uka.de  Thu Nov 24 05:32:03 2005
From: poess at ira.uka.de (Bernhard Poess)
Date: Thu Nov 24 05:32:23 2005
Subject: [antlr-interest] Error parsing Linux Kernel Files
Message-ID: <4385C0D3.1070103@ira.uka.de>

Hi,

I'm trying to use the cgram grammars to parse files from the Linux
Kernel, but I get many exceptions doing that. Should'nt the GNU C
grammar parser be able to parse Linux kernel files:

Error Message:
ANTLR Parsing Error: line 139:3745: unexpected token: static token
name:"static"
line 139:3745: unexpected token: static
        at GnuCParser.externalDef(GnuCParser.java:505)
        at GnuCParser.externalList(GnuCParser.java:241)
        at GnuCParser.translationUnit(GnuCParser.java:202)
        at Test.main(Test.java:39)
ANTLR Parsing Error: line 139:3752: unexpected token: int token name:"int"
line 139:3752: unexpected token: int
        at GnuCParser.externalDef(GnuCParser.java:505)
        at GnuCParser.externalList(GnuCParser.java:241)
        at GnuCParser.translationUnit(GnuCParser.java:202)
        at Test.main(Test.java:39)
ANTLR Parsing Error: line 139:3763: unexpected token: nosmp token name:ID
line 139:3763: unexpected token: nosmp
        at GnuCParser.initDecl(GnuCParser.java:3420)
        at GnuCParser.initDeclList(GnuCParser.java:1104)
        at GnuCParser.typelessDeclaration(GnuCParser.java:832)
        at GnuCParser.externalDef(GnuCParser.java:500)
        at GnuCParser.externalList(GnuCParser.java:241)
        at GnuCParser.translationUnit(GnuCParser.java:202)
        at Test.main(Test.java:39)
exception: java.lang.NullPointerException
java.lang.NullPointerException
        at
antlr.MismatchedTokenException.tokenName(MismatchedTokenException.java:165)
        at
antlr.MismatchedTokenException.getMessage(MismatchedTokenException.java:132)
        at antlr.RecognitionException.toString(RecognitionException.java:67)
        at java.lang.String.valueOf(String.java:2131)
        at java.lang.StringBuffer.append(StringBuffer.java:370)
        at GnuCEmitter.reportError(GnuCEmitter.java:278)
        at GnuCEmitter.initDecl(GnuCEmitter.java:2514)
        at GnuCEmitter.initDeclList(GnuCEmitter.java:727)
        at GnuCEmitter.typelessDeclaration(GnuCEmitter.java:700)
        at GnuCEmitter.externalDef(GnuCEmitter.java:426)
        at GnuCEmitter.externalList(GnuCEmitter.java:376)
        at GnuCEmitter.translationUnit(GnuCEmitter.java:345)
        at Test.main(Test.java:65)


I've attached the source file.

Any help with this would be very appreciated.

-Bernhard
-------------- next part --------------
A non-text attachment was scrubbed...
Name: main.c
Type: text/x-csrc
Size: 18086 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051124/9f68f931/main-0001.bin
From open.zone at virgin.net  Thu Nov 24 07:41:58 2005
From: open.zone at virgin.net (Micheal J)
Date: Thu Nov 24 07:26:25 2005
Subject: language independent C++ grammar [was
	Re:[antlr-interest]	UpdatedC++parser version 3.1 published
	November	2005]
In-Reply-To: <4384F00F.4050609@zmail.pt>
Message-ID: <000001c5f10d$9d0f4660$6b02a8c0@hercules>

> So, David, I'll try to use the annotation tool and if it 
> works I'll get 
> back with a C++ and
> Java version of the grammar. If not I'll report the failure 
> anyway. Are 
> you interested?

Yes. It would considerably ease the effort required to produce a C# version
as well.

Micheal

From Jean-Claude.Durand at imag.fr  Thu Nov 24 09:18:53 2005
From: Jean-Claude.Durand at imag.fr (Jean-Claude Durand)
Date: Thu Nov 24 09:20:44 2005
Subject: [antlr-interest] Bug with more than one parser
Message-ID: <a163fff9bf41bde20a49b313ec7f3d81@imag.fr>

Hi,
I got bugs when I try to have 2 parsers one calling the other with some 
types of rules. I use ANTLR for a large project
but I isolated the problem on a very simple example:
The example parses sequences of assignments as simple as:
x = a * bb * c;

The main grammar consists of 2 rules:

// an example:  "x = a * bb * c;"
assignments:	
	( IDF ASSIGN prod SEMI )+
	;

// this rule "calls" the grammar Expression which parses a simple 
product of terms like "a * bb * c":
prod:	
	{
		Expression exp(getInputState());
		exp.product();
	}
	;

The called grammar just parses the product, it can be done with:
// The iterative formulation is OK:
product:
	IDF
	(
		PROD IDF
	)*
	;

/* Although with these rules, I got a bug "unexpected token":
product:
	IDF
	remaining
	;

remaining:
		PROD IDF
		remaining
	|
		// empty
	;
*/

The same kind of pb arises if for instance you want to have tabs 
elements or variables, and the rule below does
not work:
product:
	IDF ( LB INTEGER RB )?
	(
		PROD IDF ( LB INTEGER RB )?
	)*
	;

I send you the files of the example:

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Assignment.tar.gz
Type: application/x-gzip
Size: 1495 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051124/e8a57d85/Assignment.tar.gz
-------------- next part --------------


Thanks for your answer,

Jean-Claude Durand
GETA, CLIPS, IMAG-Campus, BP 53
385, rue de la Biblioth?que
38041 Grenoble Cedex 9
France

+33 (0)4 76 51 43 81
jean-claude.durand@imag.f// The iterative formulation is OK:
From robgreene at gmail.com  Thu Nov 24 10:31:02 2005
From: robgreene at gmail.com (Rob Greene)
Date: Thu Nov 24 10:31:05 2005
Subject: [antlr-interest] Intermediate code generation...
Message-ID: <738584f80511241031x5736d409k813850bb6b7f4c4b@mail.gmail.com>

I'm curious what strategies people use when generating intermediate
code from an ANTLR grammar/language.

I'm putzing with a BASIC (that RBASIC sample I needed help with
earlier) compiler which I would like to have multiple target CPUs
coming out of the backend (principally 6502, 65c02, and 65816, but
potentially for embedded devices too).

The general process was to be source code ==compile=> intermediate
code ==optimize=> intermediate code ==generate=> target CPU assembly
==assemble=> executable. I think that's fairly standard...

What has me stymied a bit is that ANTLR to intermediate code
generation step. I'm pretty much looking at a separate Java
application to take the generated AST and start writing code. It feels
brute-force, but I'm not certain there's really a better method. I see
a lot of people dump stuff into the TreeParser, but seems to add
confusion rather than clarity.

Thanks!
-Rob
From sohail at taggedtype.net  Thu Nov 24 11:20:07 2005
From: sohail at taggedtype.net (sohail@taggedtype.net)
Date: Thu Nov 24 11:20:14 2005
Subject: [antlr-interest] Intermediate code generation...
In-Reply-To: <738584f80511241031x5736d409k813850bb6b7f4c4b@mail.gmail.com>
References: <738584f80511241031x5736d409k813850bb6b7f4c4b@mail.gmail.com>
Message-ID: <47802.127.0.0.1.1132860007.squirrel@taggedtype.net>

> I'm curious what strategies people use when generating intermediate
> code from an ANTLR grammar/language.
>
> I'm putzing with a BASIC (that RBASIC sample I needed help with
> earlier) compiler which I would like to have multiple target CPUs
> coming out of the backend (principally 6502, 65c02, and 65816, but
> potentially for embedded devices too).
>
> The general process was to be source code ==compile=> intermediate
> code ==optimize=> intermediate code ==generate=> target CPU assembly
> ==assemble=> executable. I think that's fairly standard...
>
> What has me stymied a bit is that ANTLR to intermediate code
> generation step. I'm pretty much looking at a separate Java
> application to take the generated AST and start writing code. It feels
> brute-force, but I'm not certain there's really a better method. I see
> a lot of people dump stuff into the TreeParser, but seems to add
> confusion rather than clarity.

Hi Rob,

I would suggest having a TreeParser to create your AST and then multiple
TreeParsers to generate code. I don't know how well you could optimize
with multiple tree parsers though.

Sohail
From zhixueyong at hotmail.com  Thu Nov 24 19:26:21 2005
From: zhixueyong at hotmail.com (Yong)
Date: Thu Nov 24 19:27:58 2005
Subject: [antlr-interest] Where the conflict comes from (java
	arrayInitializer)?
Message-ID: <loom.20051125T034828-609@post.gmane.org>


I am reading the java 1.3 grammar (java.g), and can not understand the 
arrayInitializer rule. I have read the embedded comment several times, but still 
do not know where the conflict comes from so that we have to shut it down.

As far as I know, arrayInitializer can only end with RCURLY or COMMA RCURLY, so 
antlr should have no difficulty to predict the exit branch if K >= 2.

The question may have been asked before, but I failed to find it on google.
Thank you very much and have a good holiday!

arrayInitializer
		:	LCURLY
				(	initializer
					(
						// CONFLICT: does a COMMA after an 
initializer start a new
						//           initializer or start the option 
',' at end?
						//           ANTLR generates proper code by 
matching
						//			 the comma as soon as 
possible.
						options {
							warnWhenFollowAmbig = false;
						}
					:
						COMMA! initializer
					)*
					(COMMA!)?
				)?
			RCURLY
		;


From jochen.wiedmann at gmail.com  Thu Nov 24 22:38:53 2005
From: jochen.wiedmann at gmail.com (Jochen Wiedmann)
Date: Thu Nov 24 22:38:55 2005
Subject: [antlr-interest] Version 1.22.3 of java.g?
Message-ID: <4386B17D.8030902@gmail.com>


Hi,

I am using a slightly modified version 1.22.3 of Michael Studmans 
java.g. Unfortunately, I lost the original unpatched version. For an 
update to the current version, I'd need to create a patch between 
original and my current version. Does anyone have a pointer to version 
1.22.3? Some CVS repository or things like that?


Regards,

Jochen

From prashant.deva at gmail.com  Fri Nov 25 05:01:25 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri Nov 25 05:01:28 2005
Subject: [antlr-interest] ANTLR Studio website working again
Message-ID: <41fed8f80511250501u54f21080x36d61c1f97176de7@mail.gmail.com>

For the last few days there was a lot of downtime on the antlr studio
website and i believe quite a few of you were having trouble creating
accounts or logging in.
The problem was with the host server where the web site was hosted.

I have changed hosts now and hopefully the website will now run smoothly.

So those of you who gave up trying to create an account can do so now :)

http://www.antlrstudio.com

Hope you enjoy ANTLR Studio :-)
--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051125/2fa34b81/attachment.html
From prashant.deva at gmail.com  Fri Nov 25 12:14:51 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri Nov 25 12:14:55 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
Message-ID: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>

Me and Terence were recently having a discussion about this.
Its about how to handle newlines in antlr 3.

Now as you probably know that currently ANTLR 2 cant handle all 3 types of
newlines.
ie, if we have a rule like this-

WS : '\r' '\n' {newline();}
       | '\r'    {newline();}
       | '\n'   {newline();}
     ;

we would get a non determinism warning.

The reason this problem arises is solely because currently we have chosen to
store 'lines & columns' in tokens instead of offsets.

I mean, think about it this way, if we didnt have to put that newline()
call, we could easily write this rule as-

WS : '\r' | '\n' ;

This would handle all 3 types of newlines.

So i propose that in antlr 3 you identify the position of the tokens by
offset instead of 'line/columns'

This has the following advantages -


   1. Some people may like line nos to start from 1 while some may want
   them to start from 0, but 'offsets' are universally considered to start from
   0.
   2. We need to keep track of just 1 value ( the offset) instead of 2
   values (row/column), so lesser complexity.
   3. And of course we can handle all 3 types of 'newlines' easily :-)


On the other hand Terence suggests that call to newline() can be put inside
the CharBuffer class where it is handled automatically so people who need to
track line nos can do so easily.
This would be nice but then again it increases the complexity if we decide
to keep both offsets and row/cols.

Which approach do you think would be best?

If you guys would like we can put up a poll for this on the ANTLR Studio
forum.



--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051126/fbe5513c/attachment.html
From mental at rydia.net  Fri Nov 25 12:41:08 2005
From: mental at rydia.net (MenTaLguY)
Date: Fri Nov 25 12:40:46 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
Message-ID: <1132951269.6830.374.camel@localhost.localdomain>

On Sat, 2005-11-26 at 01:44 +0530, Prashant Deva wrote:

> On the other hand Terence suggests that call to newline() can be put
> inside the CharBuffer class where it is handled automatically so
> people who need to track line nos can do so easily.

My feeling is tracking it implicitly inside CharBuffer is best.  The
lines/columns people care about are the "text editor address", which the
grammar itself really shouldn't have to be concerned with.

I like the notion of making offsets the primary notion of ... offsets,
though.

-mental
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051125/d56f4d43/attachment.bin
From open.zone at virgin.net  Fri Nov 25 12:58:20 2005
From: open.zone at virgin.net (Micheal J)
Date: Fri Nov 25 12:42:47 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
Message-ID: <000501c5f202$f97d6c10$6b02a8c0@hercules>

Please don't post HTML mail to the list. 
 
Me and Terence were recently having a discussion about this.
Its about how to handle newlines in antlr 3.
  
Now as you probably know that currently ANTLR 2 cant handle all 3 types of
newlines.
ie, if we have a rule like this-

WS : '\r' '\n' {newline();}
       | '\r'    {newline();}
       | '\n'   {newline();}
     ;

we would get a non determinism warning.

The reason this problem arises is solely because currently we have chosen to
store 'lines & columns' in tokens instead of offsets.
 
No. The reason is that we have to count newlines in action code. It can
perhaps be done behind the scenes.
 
I mean, think about it this way, if we didnt have to put that newline()
call, we could easily write this rule as-

WS : '\r' | '\n' ;

This would handle all 3 types of newlines. 
 
But we would lose the accurate line count ability.

So i propose that in antlr 3 you identify the position of the tokens by
offset instead of 'line/columns'

This has the following advantages - 
 
<SNIP>
 
On the other hand Terence suggests that call to newline() can be put inside
the CharBuffer class where it is handled automatically so people who need to
track line nos can do so easily.
This would be nice but then again it increases the complexity if we decide
to keep both offsets and row/cols. 
 
Not really. Can't the newline calculation be abstracted?. If a newline count
isn't required, no code should be run that calculates it.
 
Which approach do you think would be best? 
 
An approach where I can decide if I want one or the other. Perhaps by
setting a grammar property.

If you guys would like we can put up a poll for this on the ANTLR Studio
forum.

That what we have a list for... ;-)
 
Cheers,
 
Micheal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051125/cab3f7d9/attachment.html
From mritun at gmail.com  Fri Nov 25 14:27:24 2005
From: mritun at gmail.com (Akhilesh Mritunjai)
Date: Fri Nov 25 14:24:58 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
Message-ID: <op.s0thzym95qofyi@mritunjai.intra.powailabs.com>

On Sat, 26 Nov 2005 01:44:51 +0530, Prashant Deva  
<prashant.deva@gmail.com> wrote:

> Me and Terence were recently having a discussion about this.
> Its about how to handle newlines in antlr 3.

Will have to think more about this, but lets finish off the excruciating  
problem of keeping track of filenames too along with line and column  
numbers.

I can' think of any sensible programming language, at least, that doesn't  
use modules/include files that are processed along with a given set of  
input files. Keeping track of file names and *their* line numbers is a  
painful business. Given all the funky things we're doing with ANTLR right  
now, we haven't got source error reporting right till now :-(

-- 
Regards
- Akhilesh Mritunjai

The problem with the world is that wise are never sure and fools are ever  
so damn confident
From prashant.deva at gmail.com  Fri Nov 25 14:45:30 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri Nov 25 14:45:32 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <op.s0thzym95qofyi@mritunjai.intra.powailabs.com>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
	<op.s0thzym95qofyi@mritunjai.intra.powailabs.com>
Message-ID: <41fed8f80511251445t3e4a834hac85bb75c09d11d2@mail.gmail.com>

I would be against putting file name tracking in antlr.
I mean we can put all kinds of stuff in there which we like, but that would
cause bloat.

I believe antlr itself should just do parsing and everything else like
source file tracking, line tracking ,etc should be added on top.

--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051126/761fca79/attachment.html
From jbb at acm.org  Fri Nov 25 15:17:53 2005
From: jbb at acm.org (John B. Brodie)
Date: Fri Nov 25 15:18:02 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
	(message from Prashant Deva on Sat, 26 Nov 2005 01:44:51 +0530)
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
Message-ID: <E1EfmpF-0006Bp-00@gecko>

Pardon me for being stupid...

but would it make sense that instead of


WS : '\r' '\n' {newline();}
       | '\r'    {newline();}
       | '\n'   {newline();}
     ;



use



WS : ( '\r' ( '\n' )? | '\n' ) { newline(); /*$setType(Token.SKIP)*/ };



for me, no non-determinism.

i haven't had to deal with line/col tracking (yet;-). but seems like
my version calls newline() in the same way as the non-deterministic
version...

hope this helps...
   -jbb
From mail at martin-probst.com  Fri Nov 25 15:17:59 2005
From: mail at martin-probst.com (Martin Probst)
Date: Fri Nov 25 15:18:11 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251445t3e4a834hac85bb75c09d11d2@mail.gmail.com>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
	<op.s0thzym95qofyi@mritunjai.intra.powailabs.com>
	<41fed8f80511251445t3e4a834hac85bb75c09d11d2@mail.gmail.com>
Message-ID: <1132960679.10305.5.camel@localhost.localdomain>

Please don't post HTML to mailing lists.

> I would be against putting file name tracking in antlr.
> I mean we can put all kinds of stuff in there which we like, but that
> would cause bloat.

I concur. It's really quite easy to add file name handling to ANTLR if
needed by overriding some methods, and if used in a bigger project you
probably do some conversion on the exceptions anyways, so it's not a
problem to add your file names there.

I think that's more of a documentation problem, ANTLR should maybe get a
better FAQ than currently (I've never really gotten the point of that
JGuru thing...).

Martin

From mail at martin-probst.com  Fri Nov 25 15:28:35 2005
From: mail at martin-probst.com (Martin Probst)
Date: Fri Nov 25 15:28:44 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <000501c5f202$f97d6c10$6b02a8c0@hercules>
References: <000501c5f202$f97d6c10$6b02a8c0@hercules>
Message-ID: <1132961315.10305.17.camel@localhost.localdomain>

Am Freitag, den 25.11.2005, 20:58 +0000 schrieb Micheal J:
> Please don't post HTML mail to the list. 

Yeah, please don't do that. You too ;-)

> WS : '\r' '\n' {newline();}
>        | '\r'    {newline();}
>        | '\n'   {newline();}
>      ;

What about

NL: (('\r' ( '\n' /* Windows */ | /* empty, MAC OS <=9 */ )
    ) | '\n' /* the proper way ... */ ) { newline(); };

(untested, but works, doesn't it?).

It's a documentation issue, just put it into a prominently linked FAQ.
Also tell people which method to override in case they want to count
from 0 (e.g. "return super.getLine() - 1;").

I would opt against doing the newline magic behind the scenes
automagically. Doing newlines properly is a good exercise to get started
with ANTLR, and those who can't get it to work with some documentation
have much bigger problems. On the other hand, there are people parsing
binary files (line what?), people using Eclipse (that's the offset
people ;-)), people who want to provide proper line/column numbers to
users. It's easy to do all of these, just some minor Java work. IMHO
ANTLR should keep out of that business.

Martin

From mail at martin-probst.com  Fri Nov 25 15:30:50 2005
From: mail at martin-probst.com (Martin Probst)
Date: Fri Nov 25 15:30:58 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <E1EfmpF-0006Bp-00@gecko>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
	<E1EfmpF-0006Bp-00@gecko>
Message-ID: <1132961450.10305.20.camel@localhost.localdomain>

> WS : ( '\r' ( '\n' )? | '\n' ) { newline(); /*$setType(Token.SKIP)*/ };

Your indentation/parenthesis usage is a lot better than mine ;-)

Martin

From parrt at cs.usfca.edu  Fri Nov 25 17:52:18 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Nov 25 17:52:05 2005
Subject: [antlr-interest] big changes to action spec in v3
Message-ID: <6660A6D9-8BC1-486F-9198-37E72BC2872C@cs.usfca.edu>

Howdy,

Spent all day altering how you specify actions outside of  
productions.  I wanted something much more flexible and here is the  
comment from the README.

Ter
---------------
* action syntax changed "@scope::actionname {action}" where scope  
defaults
   to "parser" if parser grammar or combined grammar, "lexer" if  
lexer grammar,
   and "treeparser" if tree grammar.  The code generation targets decide
   what scopes are available.  Each "scope" yields a hashtable for  
use in
   the output templates.  The scopes full of actions are sent to all  
output
   file templates (currently headerFile and outputFile) as attribute  
actions.
   Then you can reference <actions.scope> to get the map of actions  
associated
   with scope and <actions.parser.header> to get the parser's header  
action
   for example.  This should be very flexible.  The target should  
only have
   to define which scopes are valid, but the action names should be  
variable
   so we don't have to recompile ANTLR to add actions to code gen  
templates.

   grammar T;
   options {language=Java;}
   @header { package foo; }
   @parser::stuff { int i; } // names within scope not checked;  
target dependent
   @members { int i; }
   @lexer::header {head}
   @lexer::members { int j; }
   @headerfile::blort {...} // error: this target doesn't have  
headerfile
   @treeparser::members {...} // error: this is not a tree parser
   a
   @init {int i;}
     : ID
     ;
   ID : 'a'..'z';

   For now, the Java target uses members and header as a valid name.   
Within a
   rule, the init action name is valid.

From open.zone at virgin.net  Fri Nov 25 18:17:43 2005
From: open.zone at virgin.net (Micheal J)
Date: Fri Nov 25 18:02:13 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1132961315.10305.17.camel@localhost.localdomain>
Message-ID: <001001c5f22f$9a2248d0$6b02a8c0@hercules>

> Am Freitag, den 25.11.2005, 20:58 +0000 schrieb Micheal J:
> > Please don't post HTML mail to the list.
> 
> Yeah, please don't do that. You too ;-)

I was being tolerant  ;-)

> I would opt against doing the newline magic behind the scenes 
> automagically. Doing newlines properly is a good exercise to 
> get started with ANTLR, and those who can't get it to work 
> with some documentation have much bigger problems. On the 
> other hand, there are people parsing binary files (line 
> what?), people using Eclipse (that's the offset people ;-)), 
> people who want to provide proper line/column numbers to 
> users. It's easy to do all of these, just some minor Java 
> work. IMHO ANTLR should keep out of that business.

Doing line/col/offset tracking badly can have a serious impact on lexer
performance. I'm already worried about the too many virtual methods we have
currently in v2.

Micheal

From open.zone at virgin.net  Fri Nov 25 18:17:43 2005
From: open.zone at virgin.net (Micheal J)
Date: Fri Nov 25 18:02:22 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251445t3e4a834hac85bb75c09d11d2@mail.gmail.com>
Message-ID: <001101c5f22f$9b8f6d60$6b02a8c0@hercules>

Please don't post HTML mail to the list.

> I would be against putting file name tracking in antlr.

I can't agree with that. I just want the ability to turn it off.

> I believe antlr itself should just do parsing and everything else
> like source file tracking, line tracking ,etc should be added on 
> top.

Filename tracking is a quite different from col/line/offset tracking. The
latter really should be handled by the tool as it can have a serious impact
on lexer performance if done inefficiently. Parsers would just inherit
whatever the lexer was able to gather.

Micheal

From ceckak at alumni.washington.edu  Fri Nov 25 22:37:47 2005
From: ceckak at alumni.washington.edu (Ken and Timi Cecka)
Date: Fri Nov 25 23:01:06 2005
Subject: [antlr-interest] header and extra code blocks in supergrammars
Message-ID: <dm8vs0$idn$1@sea.gmane.org>

Hi All,

I'm experimenting with splitting my TreeParser into a supergrammar and
several distinct subgrammars.  One annoyance I'm running in to is that the
subgrammars don't appear to inherit the header block or the extra code
block.  That means I have to replicate those sections in each subgrammar,
which is a bit of a maintenance headache.

For the header section, I can get away with having the subgrammar's include
the supergrammar's header, but this trick won't work for the extra code
block because it gets inserted into the cpp file.

Am I missing something?  If not, would this be hard to include in v3.0?  I
can work around it by moving my utility functions into the header block or
a separate library, but it seems like the natural thing would be for these
code blocks to carry across in the inheritance chain.

A contrived example is included below.

Ken




---begin super.g---

header
{
  #define LIFE_VAL 6
  #define UNIVERSE_VAL 7
}

options
{
  language="Cpp";
}

{
  static int ask(void)
  {
    return LIFE_VAL * UNIVERSE_VAL;
  }
}

class Super extends TreeParser;

question returns [int i] 
  : #(QUESTION LIFE UNIVERSE)
    { i = ask(); }
  ;

---end super.g---

---begin sub.g---

header
{
#ifdef WORKAROUND2 //would prefer this was inherited
  #include "Super.hpp"
#endif
}

options
{
  language="Cpp";  //would prefer this was inherited
}

{
#ifdef WORKAROUND1 //would prefer this was inherited
  static int ask(void)
  {
    return LIFE_VAL * UNIVERSE_VAL;
  }
#endif
}

class Sub extends Super;

answer returns [int i]
  : i=question
  ;

---end sub.g---

---begin build log---
$ g++ -c -DWORKAROUND1 -DWORKAROUND2 Sub.cpp
$ antlr super.g
ANTLR Parser Generator   Version 2.7.5 (20050128)   1989-2005 jGuru.com
$ antlr -glib super.g sub.g
ANTLR Parser Generator   Version 2.7.5 (20050128)   1989-2005 jGuru.com
$ g++ -c Super.cpp
$ g++ -c Sub.cpp
expandedsub.g: In member function `int Sub::question(antlr::RefAST)':
expandedsub.g:29: error: `ask' undeclared (first use this function)
expandedsub.g:29: error: (Each undeclared identifier is reported only once
for each function it appears in.)
$ g++ -c -DWORKAROUND1 Sub.cpp
expandedsub.g: In function `int ask()':
expandedsub.g:15: error: `LIFE_VAL' undeclared (first use this function)
expandedsub.g:15: error: (Each undeclared identifier is reported only once
for each function it appears in.)
expandedsub.g:15: error: `UNIVERSE_VAL' undeclared (first use this function)
$ g++ -c -DWORKAROUND1 -DWORKAROUND2 Sub.cpp
---end build log---

From mail at martin-probst.com  Sat Nov 26 04:12:23 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sat Nov 26 04:12:30 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <001101c5f22f$9b8f6d60$6b02a8c0@hercules>
References: <001101c5f22f$9b8f6d60$6b02a8c0@hercules>
Message-ID: <1133007143.9942.7.camel@localhost.localdomain>

Hi,

> The latter really should be handled by the tool as it can have a serious impact
> on lexer performance if done inefficiently.

Maybe I'm lacking imagination, but in what parsing task do you actually
expect that counting lines/offsets is a significant performance
bottleneck? I really can't imagine anything complex enough to justify
using something like ANTLR but so trivial that line counting might give
significant performance differences.

About the virtual methods: maybe some C++ crack might be able to change
the ANTLR C++ code creation and move lots of the stuff now handled by
virtual functions into some template magic. That would of course ruin
compatibility with old compilers, so probably both modes should be
available.

Martin

From sohail at taggedtype.net  Sat Nov 26 04:21:40 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Sat Nov 26 04:21:50 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133007143.9942.7.camel@localhost.localdomain>
References: <001101c5f22f$9b8f6d60$6b02a8c0@hercules>
	<1133007143.9942.7.camel@localhost.localdomain>
Message-ID: <1133007701.8463.0.camel@localhost.localdomain>

On Sat, 2005-26-11 at 13:12 +0100, Martin Probst wrote:
> About the virtual methods: maybe some C++ crack 
Haha... C++ crack. You meant www.boost.org


From ric.klaren at gmail.com  Sat Nov 26 04:46:58 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Sat Nov 26 04:47:04 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133007143.9942.7.camel@localhost.localdomain>
References: <001101c5f22f$9b8f6d60$6b02a8c0@hercules>
	<1133007143.9942.7.camel@localhost.localdomain>
Message-ID: <43885942.809@gmail.com>

Martin Probst wrote:
> Maybe I'm lacking imagination, but in what parsing task do you actually
> expect that counting lines/offsets is a significant performance
> bottleneck? I really can't imagine anything complex enough to justify
> using something like ANTLR but so trivial that line counting might give
> significant performance differences.
> 
> About the virtual methods: maybe some C++ crack might be able to change
> the ANTLR C++ code creation and move lots of the stuff now handled by
> virtual functions into some template magic. That would of course ruin
> compatibility with old compilers, so probably both modes should be
> available.

For the C++ support code I've been experimenting with this. It works
really great, by plugging in different Position Tracking objects you get
a customized lexer that only tracks what's needed. Even on small toy
grammars this safes quite some space. (and hopefully also overhead)

The only thing I still need to figure out is the d*mn unicode handling,
where you have issues with binary offset and logical (character) offset.
For unicode I only want to decode a character once, but that's tricky
atm with how I set up the prototype.

I'll only maintain one version e.g. a templatized version. A C++
compiler that can't deal with basic templates should go the dino way
asap. But if someone wants to maintain another version he's welcome :)

Cheers,

Ric
From open.zone at virgin.net  Sat Nov 26 05:14:51 2005
From: open.zone at virgin.net (Micheal J)
Date: Sat Nov 26 04:59:16 2005
Subject: [antlr-interest] header and extra code blocks in supergrammars
In-Reply-To: <dm8vs0$idn$1@sea.gmane.org>
Message-ID: <000201c5f28b$63c30bb0$6b02a8c0@hercules>

> Hi All,
> 
> I'm experimenting with splitting my TreeParser into a 
> supergrammar and several distinct subgrammars.  One annoyance 
> I'm running in to is that the subgrammars don't appear to 
> inherit the header block or the extra code block.  That means 
> I have to replicate those sections in each subgrammar, which 
> is a bit of a maintenance headache.
> 
> For the header section, I can get away with having the 
> subgrammar's include the supergrammar's header, but this 
> trick won't work for the extra code block because it gets 
> inserted into the cpp file.
> 
> Am I missing something?

Perhaps not. I've usually tackled this by instructing ANTLR to generate tree
parsers that derive from my own custom class (itself a
TreeParser-derivative). This takes care of the common code in the extra code
block since I can include all that in my custom base class.

ANTLR v2's "inheritance" feature is then used to ensure the right
rules/actions are generated for individual tree parsers.

As you say, the header stuff has to be repeated in each grammar but that's
not an issue really.

Micheal

From ric.klaren at gmail.com  Sat Nov 26 05:07:03 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Sat Nov 26 05:07:09 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
Message-ID: <43885DF7.3090107@gmail.com>

Prashant Deva wrote:
> Me and Terence were recently having a discussion about this.
> Its about how to handle newlines in antlr 3.

Can't you do it in a similar way as I intend to do it in C++? E.g. plug
in a user defined object that knows about the type of token tracking you
want to do? And one that knows how to put this location info inside a
newly created token?

In C++ I can now plug in an object that only deals with binary offsets
in the file. Or instantiate the lexer with a object that tracks
everything. No changes to the basic lexer code. On the test lexers (one
of them the java lexer) using full tracking or minimalist position
tracking cut 10-11% of the binary size, just by changing a template
parameter.

> Now as you probably know that currently ANTLR 2 cant handle all 3 types of
> newlines.
> ie, if we have a rule like this-
> 
> WS : '\r' '\n' {newline();}
>        | '\r'    {newline();}
>        | '\n'   {newline();}
>      ;
> 
> we would get a non determinism warning.

A warning *shrug* ;)

> The reason this problem arises is solely because currently we have chosen to
> store 'lines & columns' in tokens instead of offsets.

It's more due to the choice to mark the newlines in this way with action
 code.

> I mean, think about it this way, if we didnt have to put that newline()
> call, we could easily write this rule as-
> 
> WS : '\r' | '\n' ;
> 
> This would handle all 3 types of newlines.
> 
> So i propose that in antlr 3 you identify the position of the tokens by
> offset instead of 'line/columns'
> 
> This has the following advantages -
> 
> 
>    1. Some people may like line nos to start from 1 while some may want
>    them to start from 0, but 'offsets' are universally considered to start from
>    0.
>    2. We need to keep track of just 1 value ( the offset) instead of 2
>    values (row/column), so lesser complexity.
>    3. And of course we can handle all 3 types of 'newlines' easily :-)

And the people who want to track line/col/filename have to jump through
hoops to do that ? This is only moving the problem around. Where the
problem is: how do we tell antlr to track what in the first place.

> On the other hand Terence suggests that call to newline() can be put inside
> the CharBuffer class where it is handled automatically so people who need to
> track line nos can do so easily.

E.g. put an extra if and logic for the types of newlines (if so
required) in a critical path of the lexer? This is currently happening
in antlr2 at some spots as well and it's ugly. Someone parsing binary
stuff who'd want pure performance is then bothered with some newline
checks he'd not need.

> This would be nice but then again it increases the complexity if we decide
> to keep both offsets and row/cols.
> 
> Which approach do you think would be best?

I'd be in favour of trying to make the java stuff do what I now
do/intend in C++. e.g. have some object that knows how to track the
offset or whatever you want in the stream and combine it with some
factory that knows how to make the token from the offset tracker and the
start and end position of the token.

That way you have a consistent and transparent way in which stream
locations are tracked and the locations are put in the tokens. With some
extra tinkering you can even reduce a token to just an int if you need
or to something more fullblown that tracks line/col/file.

So for C++ if I'd want full position tracking I'd say:

typedef CharStream<FullPosition> MyStream;
class MyTokenBuilder {
public:
   static TokenFullPos* build( token_type tp,
                               const FullPosition& start,
                               const MyStream& stream,
                               channel_type chan = DEFAULT_CHANNEL )
{
   return new TokenFullPos( tp,
            stream.substring(start.getOffset(),stream.getOffset()),
            start.getLine(), start.getColumn(),
            stream.getFilename() );
}
};
...
MyStream input( file, filename );
JavaParserLexer<MyStream,TokenFullPos,MyTokenBuilder> lexer( &input );
...
TokenFullPos* t = lexer.nextToken();

For minimalist tracking I'd just plug in a different token builder and a
different Position tracker in stead of FullPosition and that's it. Doing
a few typedefs at the top of the code hides all the template parameter
details for the most common cases.

Cheers,

Ric
From open.zone at virgin.net  Sat Nov 26 05:29:36 2005
From: open.zone at virgin.net (Micheal J)
Date: Sat Nov 26 05:14:01 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133007143.9942.7.camel@localhost.localdomain>
Message-ID: <000301c5f28d$745b53e0$6b02a8c0@hercules>

> > The latter really should be handled by the tool as it can have a 
> > serious impact on lexer performance if done inefficiently.
> 
> Maybe I'm lacking imagination, but in what parsing task do 
> you actually expect that counting lines/offsets is a 
> significant performance bottleneck?

In all tasks that need lines/col/offset counting and care about performace
actually. My point is that how it is implemented can have a serious impact
on performance. At the lexer level, you would want to reduce the number of
times each character is "processed" or "touched" and the duration of the
processing to the absolute minimum. Short of editing generated code, I can't
see how that can be achieved optimally if the generator isn't generating the
tracking code as part of the lexer's core.

> I really can't imagine 
> anything complex enough to justify using something like ANTLR 
> but so trivial that line counting might give significant 
> performance differences.

I can. Attempting to tack on line/col/offset counting to a lexer via virtual
method overrides for instance.

> About the virtual methods: maybe some C++ crack might be able 
> to change the ANTLR C++ code creation and move lots of the 
> stuff now handled by virtual functions into some template 
> magic. That would of course ruin compatibility with old 
> compilers, so probably both modes should be available.

My comments also extend to the Java/C# targets. Virtual methods cost more
than non-virtual methods. This probably isn't a worry in the general case...

Micheal

From mail at martin-probst.com  Sat Nov 26 06:54:28 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sat Nov 26 06:54:36 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <000301c5f28d$745b53e0$6b02a8c0@hercules>
References: <000301c5f28d$745b53e0$6b02a8c0@hercules>
Message-ID: <1133016868.9942.14.camel@localhost.localdomain>

> I can. Attempting to tack on line/col/offset counting to a lexer via virtual
> method overrides for instance.

That's basically one virtual method call (newline();) per line break,
which is in turn one pointer de-referencing plus a method call per
newline. E.g. with a 4000 line file you get 4000 pointer de-referencing
ops more with a virtual function instead of a "normal" function. I don't
know what you're doing with the 4000 lines you have parsed in the same
time, but are 4000 de-refs really significant compared to stepping
through the parsing rules for 4000 lines of code and building the AST?

> > About the virtual methods: maybe some C++ crack might be able 
> > to change the ANTLR C++ code creation and move lots of the 
> > stuff now handled by virtual functions into some template 
> > magic. That would of course ruin compatibility with old 
> > compilers, so probably both modes should be available.
> 
> My comments also extend to the Java/C# targets. Virtual methods cost more
> than non-virtual methods. This probably isn't a worry in the general case...

Well, with Java/C# the JIT (and whatever the C# equivalent is) can find
methods that are virtual, but don't have any overriding classes, so that
they are inlinable. Still, I can't imagine this gives a real life
difference.

Martin

From royne.borrud at gmail.com  Sat Nov 26 07:16:30 2005
From: royne.borrud at gmail.com (Royne Borrud)
Date: Sat Nov 26 07:16:34 2005
Subject: [antlr-interest] (Basic Questions) Non-greedy loops & non-determinism
Message-ID: <c67bc1880511260716p12435e4i22ca7f7380f188c2@mail.gmail.com>

Started out with antlr a couple of days ago, so I have a feeling these
are rather basic questions... :) In my grammar that's supposed to
allow C/++ style comments I've got the following in the lexer:

*********************

LINECOMMENT:
            ( "((" ( options { greedy = false; }: . )* NEWLINE ) {
$setType(antlr::Token::SKIP); };

MULTICOMMENT options { ignore = NEWLINE; }:
            ( "/*" ( options { greedy = false; }: . )* "*/" ) {
$setType(antlr::Token::SKIP); };

NEWLINE:
            ( '\r' ( '\n' )? | '\n' ) { newline(); };

This gives the following warnings;

On linecomment row:
warning:nongreedy block may exit incorrectly due to limitations of
linear approximate lookahead (first k-1 sets in lookahead not
singleton).

On multicomment row:
warning:lexical nondeterminism between alts 1 and 2 of block upon k==1:'\n','\r'
k==2:'\u0000'..'\u007f'

*********************

So, my questions:
Why the first warning? If the lexer sees a '\n' or '\r' when in the
linecomment loop it should break the loop. I don't see how this can
ever 'exit incorrectly'. The only nondeterminism in the NEWLINE token
is for the optional second token, if the first is '\r', so whether to
enter the newline rule should be clear at any point in the loop?

What does the second warning mean in plain english? Seems like the
lexer won't know what to do when encountering a '\n' or '\r', but
won't ignore = NEWLINE ensure that those all get eaten? And btw, the
reason for using ignore = NEWLINE is to make sure line numbers are
tracked correctly even inside multi line comments. Does that work as
intended?

So, are these just overly cautios warnings that I could safely ignore
( or shut off ), or am I doing something dangerous?

Also, I've looked at the generated lexer code, and in mMULTICOMMENT it
doesn't call NEWLINE between every match as I thought it would. It
only calls NEWLINE between matching "/*" and entering the loop. Maybe
I'm misunderstanding the way the ignore option works?
(http://www.antlr.org/doc/lexer.html#ignoringwhitespace)

Any and all help and/or answers appreciated.
From open.zone at virgin.net  Sat Nov 26 08:21:47 2005
From: open.zone at virgin.net (Micheal J)
Date: Sat Nov 26 08:06:11 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133016868.9942.14.camel@localhost.localdomain>
Message-ID: <000701c5f2a5$81048590$6b02a8c0@hercules>

> > I can. Attempting to tack on line/col/offset counting to a 
> lexer via 
> > virtual method overrides for instance.
> 
> That's basically one virtual method call (newline();) per 
> line break,

If the lexer core is doing it or has specific support for detecting newlines
which isn't what you were advocating.

In any case you've omitted the per-character call for col/offset tracking.
We were discussing line/col/offset counting not just newlines.

> which is in turn one pointer de-referencing plus 
> a method call per newline. E.g. with a 4000 line file you get 
> 4000 pointer de-referencing ops more with a virtual function 
> instead of a "normal" function.

If the lexer was built to do it properly, there would be no function calls
at all.

> I don't know what you're 
> doing with the 4000 lines you have parsed in the same time, 
> but are 4000 de-refs really significant compared to stepping 
> through the parsing rules for 4000 lines of code and building the AST?

Lexers don't build ASTs. The per-char calls needed for line/col/offset
tracking would definitely hurt lexer performance if the counts were tacked
on via overridden methods.

Micheal

From mail at martin-probst.com  Sat Nov 26 08:52:36 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sat Nov 26 08:52:48 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <000701c5f2a5$81048590$6b02a8c0@hercules>
References: <000701c5f2a5$81048590$6b02a8c0@hercules>
Message-ID: <1133023956.9942.30.camel@localhost.localdomain>

Hi,

> In any case you've omitted the per-character call for col/offset tracking.
> We were discussing line/col/offset counting not just newlines.

Well, the offset gets tracked anyway, as ANTLR is going through a String
where it has to track the input position anyways. That value is IIRC
also accessible (or could be made accessible very easily).

What is left is line breaks. How would you imagine ANTLR Lexers do that
more efficiently? E.g. always checking if the next character(s) is a \r
\n, \n or \r? What about users that want \0 to be their line separator?
Or users that don't want that at all?

> If the lexer was built to do it properly, there would be no function calls
> at all.

The overhead of a function call on x86 is very low. Plus, your compiler
might decide to inline, at least in managed languages, as said. For C++
a no-virtual-method-needed way via templates has been discussed.

> > I don't know what you're 
> > doing with the 4000 lines you have parsed in the same time, 
> > but are 4000 de-refs really significant compared to stepping 
> > through the parsing rules for 4000 lines of code and building the AST?
> 
> Lexers don't build ASTs. The per-char calls needed for line/col/offset
> tracking would definitely hurt lexer performance if the counts were tacked
> on via overridden methods.

The only thing that is (currently) done using an overridden method is
the newline thing, isn't it? A per character virtual method call would
be ugly, that's true.

Are you using the Lexer standalone? Even in that case I'd wonder if it
really makes a difference. For each character you have at least one
switch, you have the testing of alternatives etc. Will a virtual method
call for every ~20 characters make a difference bigger than maybe 1%? I
think there are more important places where ANTLR could - and is - be
enhanced, e.g. the String copying thing or various things in the C++
part that have been discussed countless times on this list.

I'm not generally arguing against including something like that, but
you'd have to find a very flexible way to do so. Otherwise users will be
unhappy because it doesn't match what they want to have, and their
solution might get more complex.

Martin

From ceckak at alumni.washington.edu  Sat Nov 26 09:43:00 2005
From: ceckak at alumni.washington.edu (Ken and Timi Cecka)
Date: Sat Nov 26 09:46:31 2005
Subject: [antlr-interest] RE: header and extra code blocks in supergrammars
References: <dm8vs0$idn$1@sea.gmane.org>
	<000201c5f28b$63c30bb0$6b02a8c0@hercules>
Message-ID: <dma6r4$7fp$1@sea.gmane.org>

Micheal J wrote:

>> Hi All,
>> 
>> I'm experimenting with splitting my TreeParser into a
>> supergrammar and several distinct subgrammars.  One annoyance
>> I'm running in to is that the subgrammars don't appear to
>> inherit the header block or the extra code block.  That means
>> I have to replicate those sections in each subgrammar, which
>> is a bit of a maintenance headache.
>> 
>> For the header section, I can get away with having the
>> subgrammar's include the supergrammar's header, but this
>> trick won't work for the extra code block because it gets
>> inserted into the cpp file.
>> 
>> Am I missing something?
> 
> Perhaps not. I've usually tackled this by instructing ANTLR to generate
> tree parsers that derive from my own custom class (itself a
> TreeParser-derivative). This takes care of the common code in the extra
> code block since I can include all that in my custom base class.
> 
> ANTLR v2's "inheritance" feature is then used to ensure the right
> rules/actions are generated for individual tree parsers.
> 
> As you say, the header stuff has to be repeated in each grammar but that's
> not an issue really.
> 
> Micheal

Thanks.  For now I've moved the functions from the global extra code block
down into the class's extra code block.  That inserts the functions as
inlines in the class definition, which antlr *does* propagate to derived
classes.  The only potential downside is that they're inline functions, but
your approach would solve that problem.

Ken

From parrt at cs.usfca.edu  Sat Nov 26 11:40:52 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 26 11:40:36 2005
Subject: [antlr-interest] newlines in v3 (codegen, runtime solutions)
Message-ID: <B0B6C720-4800-4831-BA16-9D254EB0F4F1@cs.usfca.edu>

Howdy,

My philosophy behind v3 is that it should do by default what most  
people will want it to do.  Most people just want it to work and are  
not that concerned with speed.  Those that are concerned have the  
flexibility to do amazing things by changing templates so that  
overhead is reduced and method calls are eliminated etc...  For  
example, here is how I generate token references for the Java target:

/** match a token optionally with a label in front */
tokenRef(token,label,elementIndex) ::= <<
<if(label)>
<label>=(<labelType>)input.LT(1);<\n>
<endif>
match(input,<token>,FOLLOW_<token>_in_<ruleName><elementIndex>);
 >>

For references with += labels, I just do this:

/** ids+=ID */
tokenRefAndListLabel(token,label,elementIndex) ::= <<
<tokenRef(...)>
<listLabel(...)>
 >>

listLabel(label) ::= <<
if (list_<label>==null) list_<label>=new ArrayList();
list_<label>.add(<label>);<\n>
 >>

So, if you want, you can totally inline the invocation of match.   
Most people won't want this.  If you do, then change it.   You will  
even be able to do it within the grammar file itself by specifying  
these overridden templates! :) All this w/o recompiling/rebuilding  
ANTLR.

On to newlines.  I'm not sure this is worth arguing about as along as  
you can make it do what you want.  I check for \n automatically as  
that is what most people will want.  In my stream classes I have:

public void consume() {
     if ( p < data.length ) {
         charPositionInLine++;
         if ( data[p]=='\n' ) {
             line++;
             charPositionInLine=0;
         }
         p++;
     }
}

If you want to avoid that data[p] test for newline, I'm pretty sure  
people will know how to subclass the stream and override.  I could  
even provide a default one.

For binary, I'm sure people will simply implement my CharStream and  
be done with it. :)

Anyway, don't worry folks.  You will be able to do just about  
anything you want either by changing code generation or by tweaking  
some classes. :)

Ter
From mritun at gmail.com  Sat Nov 26 14:45:30 2005
From: mritun at gmail.com (Akhilesh Mritunjai)
Date: Sat Nov 26 14:43:05 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133023956.9942.30.camel@localhost.localdomain>
References: <000701c5f2a5$81048590$6b02a8c0@hercules>
	<1133023956.9942.30.camel@localhost.localdomain>
Message-ID: <op.s0vdh4wn5qofyi@mritunjai.intra.powailabs.com>


The difference is *few 100 microseconds* for even 10000 virtual function  
calls. See for yourself in this benchmark (makes 1 billion calls). Run the  
jvm both with and without "-server" option.

Attachments: Calls.java and Calls2.java


On Sat, 26 Nov 2005 22:22:36 +0530, Martin Probst <mail@martin-probst.com>  
wrote:

> Hi,
>
>> In any case you've omitted the per-character call for col/offset  
>> tracking.
>> We were discussing line/col/offset counting not just newlines.
>
> Well, the offset gets tracked anyway, as ANTLR is going through a String
> where it has to track the input position anyways. That value is IIRC
> also accessible (or could be made accessible very easily).
>
> What is left is line breaks. How would you imagine ANTLR Lexers do that
> more efficiently? E.g. always checking if the next character(s) is a \r
> \n, \n or \r? What about users that want \0 to be their line separator?
> Or users that don't want that at all?
>
>> If the lexer was built to do it properly, there would be no function  
>> calls
>> at all.
>
> The overhead of a function call on x86 is very low. Plus, your compiler
> might decide to inline, at least in managed languages, as said. For C++
> a no-virtual-method-needed way via templates has been discussed.
>
>> > I don't know what you're
>> > doing with the 4000 lines you have parsed in the same time,
>> > but are 4000 de-refs really significant compared to stepping
>> > through the parsing rules for 4000 lines of code and building the AST?
>>
>> Lexers don't build ASTs. The per-char calls needed for line/col/offset
>> tracking would definitely hurt lexer performance if the counts were  
>> tacked
>> on via overridden methods.
>
> The only thing that is (currently) done using an overridden method is
> the newline thing, isn't it? A per character virtual method call would
> be ugly, that's true.
>
> Are you using the Lexer standalone? Even in that case I'd wonder if it
> really makes a difference. For each character you have at least one
> switch, you have the testing of alternatives etc. Will a virtual method
> call for every ~20 characters make a difference bigger than maybe 1%? I
> think there are more important places where ANTLR could - and is - be
> enhanced, e.g. the String copying thing or various things in the C++
> part that have been discussed countless times on this list.
>
> I'm not generally arguing against including something like that, but
> you'd have to find a very flexible way to do so. Otherwise users will be
> unhappy because it doesn't match what they want to have, and their
> solution might get more complex.
>
> Martin
>



-- 
The problem with the world is that wise are never sure and fools are ever  
so damn confident
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Calls.java
Type: application/octet-stream
Size: 1129 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051127/4ea737d5/Calls.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Calls2.java
Type: application/octet-stream
Size: 988 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051127/4ea737d5/Calls2.obj
From parrt at cs.usfca.edu  Sat Nov 26 14:44:26 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Nov 26 14:44:14 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
Message-ID: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>

Next time you grab a release of ANTLR v3, you'll note that all char  
literals must be string literals.  All unit tests and examples have  
changed.  So, you'll now do

INT : "0".."9"+ ;

instead of

INT : '0'..'9'+ ;

I thought a lot about this and I just can't justify wasting single  
quotes on char literals; it's actually easier to say that all  
literals matched are in double quotes.   Made a number of routines  
easier in ANTLR.

The only negative so far is that all the unit tests have grammars  
that are String literals in the Java program and so the grammars have  
to have the double quote escaped.  This is hideous, but I'm not sure  
we have a choice.  Here's a taste:

	public void testParserCharLiteralWithEscape() throws Exception {
		Grammar g = new Grammar(
				"grammar t;\n"+
				"a : \"\\n\";\n");
		Set literals = g.getStringLiterals();
		// must store literals how they appear in the antlr grammar
		assertEqual(literals.toArray()[0], "\"\\n\"");
	}

Ter
From ric.klaren at gmail.com  Sat Nov 26 16:04:33 2005
From: ric.klaren at gmail.com (Ric Klaren)
Date: Sat Nov 26 16:04:35 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
Message-ID: <bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>

On 11/26/05, Terence Parr <parrt@cs.usfca.edu> wrote:
> Next time you grab a release of ANTLR v3, you'll note that all char
> literals must be string literals.  All unit tests and examples have
> changed.  So, you'll now do
>
> INT : "0".."9"+ ;
>
> instead of
>
> INT : '0'..'9'+ ;
>
> I thought a lot about this and I just can't justify wasting single
> quotes on char literals; it's actually easier to say that all
> literals matched are in double quotes.   Made a number of routines
> easier in ANTLR.
>
> The only negative so far is that all the unit tests have grammars
> that are String literals in the Java program and so the grammars have
> to have the double quote escaped.  This is hideous, but I'm not sure
> we have a choice.  Here's a taste:
>
>         public void testParserCharLiteralWithEscape() throws Exception {
>                 Grammar g = new Grammar(
>                                 "grammar t;\n"+
>                                 "a : \"\\n\";\n");
>                 Set literals = g.getStringLiterals();
>                 // must store literals how they appear in the antlr grammar
>                 assertEqual(literals.toArray()[0], "\"\\n\"");
>         }

Just a thought: Isn't it easier then to use single quotes in stead of
double quotes for everything ? Assuming that double quotes are used
more often.

Ric
From prashant.deva at gmail.com  Sun Nov 27 05:33:58 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Sun Nov 27 05:34:01 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
Message-ID: <41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>

Also to type a double quote you need to press the shift key+quote key while
for the single quote you just press the quote key ;-)

On 11/27/05, Ric Klaren <ric.klaren@gmail.com> wrote:
>
> On 11/26/05, Terence Parr <parrt@cs.usfca.edu> wrote:
> > Next time you grab a release of ANTLR v3, you'll note that all char
> > literals must be string literals.  All unit tests and examples have
> > changed.  So, you'll now do
> >
> > INT : "0".."9"+ ;
> >
> > instead of
> >
> > INT : '0'..'9'+ ;
> >
> > I thought a lot about this and I just can't justify wasting single
> > quotes on char literals; it's actually easier to say that all
> > literals matched are in double quotes.   Made a number of routines
> > easier in ANTLR.
> >
> > The only negative so far is that all the unit tests have grammars
> > that are String literals in the Java program and so the grammars have
> > to have the double quote escaped.  This is hideous, but I'm not sure
> > we have a choice.  Here's a taste:
> >
> >         public void testParserCharLiteralWithEscape() throws Exception {
> >                 Grammar g = new Grammar(
> >                                 "grammar t;\n"+
> >                                 "a : \"\\n\";\n");
> >                 Set literals = g.getStringLiterals();
> >                 // must store literals how they appear in the antlr
> grammar
> >                 assertEqual(literals.toArray()[0], "\"\\n\"");
> >         }
>
> Just a thought: Isn't it easier then to use single quotes in stead of
> double quotes for everything ? Assuming that double quotes are used
> more often.
>
> Ric
>



--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051127/ca39e23d/attachment.html
From mail at martin-probst.com  Sun Nov 27 09:05:58 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 27 09:06:09 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
Message-ID: <1133111158.9590.1.camel@localhost.localdomain>

> Also to type a double quote you need to press the shift key+quote key
> while for the single quote you just press the quote key ;-)

... on a US/English keyboard. On French (?) and German keyboards you'll
have to break your fingers to reach the single quote.

Martin

From parrt at cs.usfca.edu  Sun Nov 27 09:07:22 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 27 09:07:29 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
Message-ID: <324997DC-C520-4473-A0B0-137363B87553@cs.usfca.edu>


On Nov 26, 2005, at 4:04 PM, Ric Klaren wrote:
>>         public void testParserCharLiteralWithEscape() throws  
>> Exception {
>>                 Grammar g = new Grammar(
>>                                 "grammar t;\n"+
>>                                 "a : \"\\n\";\n");
>>                 Set literals = g.getStringLiterals();
>>                 // must store literals how they appear in the  
>> antlr grammar
>>                 assertEqual(literals.toArray()[0], "\"\\n\"");
>>         }
>
> Just a thought: Isn't it easier then to use single quotes in stead of
> double quotes for everything ? Assuming that double quotes are used
> more often.

Hi Ric.  I'm willing to change it to '...' just to make those unit  
tests readable again!  However, we should focus on what is better for  
the people that specify a grammar.  Most people will be used to  
seeing double quotes for strings but the double quotes around a char  
(particularly in a "0".."9" situation) will seem unusual.  The other  
way, actually might not bother people 'int' and 'begin' actually  
immediately make you say "oh, they are using single quote for string  
character".   Hmm...did I just convince myself to spend 4 hours  
changing tests/examples/code to single quotes?  Argh!  Ok, we better  
wait until people come back to work on Monday to decide this.  I'm  
all ears as we say...suggestions?

What would double quotes be useful for?  I guess we reserve that for  
the future.

Ter
From parrt at cs.usfca.edu  Sun Nov 27 09:11:08 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 27 09:11:11 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <1133111158.9590.1.camel@localhost.localdomain>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
Message-ID: <29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>


On Nov 27, 2005, at 9:05 AM, Martin Probst wrote:

>> Also to type a double quote you need to press the shift key+quote key
>> while for the single quote you just press the quote key ;-)
>
> ... on a US/English keyboard. On French (?) and German keyboards  
> you'll
> have to break your fingers to reach the single quote.

ah!  A good argument!  Yes, I remember typing on a french keyboard  
for 6 months.  Fun flipping back and forth between that and US  
layout.  What exactly is the sequence again for single quote on euro- 
keyboards?  What about Asian keyboards?

Ok, so we have a pretty good argument FOR and AGAINST now.  More  
ideas folks?

Terence
From parrt at cs.usfca.edu  Sun Nov 27 09:11:40 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 27 09:11:47 2005
Subject: [antlr-interest] ANTLR v3 ruby grammar
Message-ID: <07570D69-A84A-40FE-B296-665E5BCE3E70@cs.usfca.edu>

BTW, I'm working on a Ruby grammar as a means of testing and making  
ANTLR more friendly; right now it crashes with any bad input.  If  
anybody wants to help with the ruby grammar, you can lurk/join-in on  
the list:

http://rubyforge.org/mailman/listinfo/rubygrammar-grammarians

and here is the rubyforge project:

http://rubyforge.org/projects/rubygrammar/

Ter
From kroepke at dolphin-services.de  Sun Nov 27 10:19:40 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Sun Nov 27 10:19:49 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
Message-ID: <DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>


On 27. Nov 2005, at 18:11 Uhr, Terence Parr wrote:

>  What exactly is the sequence again for single quote on euro- 
> keyboards?

That'd be Shift-# which is approximately located to the right side of  
the Return-key and above the right
Shift. (Remember that the Return key is shaped differently on euro- 
style keyboards: it's an upside-down-L)

For that matter the double quote is on Shift-2. Even more awkwardly  
the numerous brackets, braces, parens are
all hidden away with modifier keys on the 8 and 9 keys (differently  
on the Mac of course...I think the square
ones are on Alt-5 and Alt-6 but I cannot remember that, since I long  
ago switched to an US-style keyboard layout
and hardware for that reason alone..)

Regards,

Kay
From kroepke at dolphin-services.de  Sun Nov 27 10:27:59 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Sun Nov 27 10:28:07 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
Message-ID: <AF6DA097-96CC-4755-ADD2-97A77F7FF6D0@dolphin-services.de>


On 27. Nov 2005, at 18:11 Uhr, Terence Parr wrote:

> Ok, so we have a pretty good argument FOR and AGAINST now.  More  
> ideas folks?

On an afterthought,

having to use a lot of escaping is pretty counterproductive, IMHO.  
What kind of different usage do
you have in mind for the remaining single quote characters?

I'd support the double-quote-only strategy, though. I think that the  
shift-' isn't that much of a deal,
because in other languages that's not a big problem, either. One is  
quite used to do that, anyway.
And if it means that ANTLR's source code is getting simpler that way,  
I think it's worth it.

Kay
From e9725431 at student.tuwien.ac.at  Sun Nov 27 10:34:58 2005
From: e9725431 at student.tuwien.ac.at (Stefan Rank)
Date: Sun Nov 27 10:35:03 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <324997DC-C520-4473-A0B0-137363B87553@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<324997DC-C520-4473-A0B0-137363B87553@cs.usfca.edu>
Message-ID: <4389FC52.8060503@stud3.tuwien.ac.at>

on 27.11.2005 18:07 Terence Parr said the following:
> 
> On Nov 26, 2005, at 4:04 PM, Ric Klaren wrote:
> 
>> Just a thought: Isn't it easier then to use single quotes in stead of
>> double quotes for everything ? Assuming that double quotes are used
>> more often.
> 
> Hi Ric.  I'm willing to change it to '...' just to make those unit  
> tests readable again!  However, we should focus on what is better for  
> the people that specify a grammar.  Most people will be used to  seeing 
> double quotes for strings but the double quotes around a char  
> (particularly in a "0".."9" situation) will seem unusual.  The other  
> way, actually might not bother people 'int' and 'begin' actually  
> immediately make you say "oh, they are using single quote for string  
> character".   Hmm...did I just convince myself to spend 4 hours  
> changing tests/examples/code to single quotes?  Argh!  Ok, we better  
> wait until people come back to work on Monday to decide this.  I'm  all 
> ears as we say...suggestions?

This may be heretic, but what about allowing both variants?
(just as python does)
Then you don't need to escape double quotes inside the string when using 
single quotes and vice versa.

This makes parsing harder, but everyone can choose what looks best, a 
source of error (using the wrong quotes) is eliminated, and the need to 
escape is reduced to the cases where you have both ' and " inside the 
string.

stefan




From jimi at temporal-wave.com  Sun Nov 27 10:38:11 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun Nov 27 10:38:16 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
References: <41fed8f80511251214p101cd96fr67a576b8017f7d1f@mail.gmail.com>
	<43885DF7.3090107@gmail.com>
Message-ID: <B36CCC332A32904F8FA3DE134A23533608A4C8@wavemachine.temporal-wave.com>

 

________________________________

From: antlr-interest-bounces@antlr.org on behalf of Ric Klaren
Sent: Sat 11/26/2005 5:07 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] Antlr 3 and the newline token problem



Prashant Deva wrote:
> Me and Terence were recently having a discussion about this.
> Its about how to handle newlines in antlr 3.

Can't you do it in a similar way as I intend to do it in C++? E.g. plug
in a user defined object that knows about the type of token tracking you
want to do? And one that knows how to put this location info inside a
newly created token?

In fact this is what I am doing for the C target. Though it is harder to do such things in C (neatly at least) as the language does not have built-in mechanisms for it, it is still the case that if we just get the very basics correct then a grammar author should be able to set up things to override anything and do as they will. By 'correct', I mean merely that we don't lose information that some object/class/struct/programmar might want to track.  

By default though, you will get the 'standard' stuff with lines and columns if only for the fact that I don't want to have the C runtime be inherently differnt to the other language targets. If that were to change then I would change the C target. But, just tracking offsets does not seem the way to me. 

In short then I agree with Ric's point of view. In fact the ability to override anything that makes sense to in a fairly trivial fashion (so long as you know the target language reasonably well) should be a general precept. If you don't like the default object/struct/typedef/blob then just supply your own definition and a bit of code to handle it.

Jim

From parrt at cs.usfca.edu  Sun Nov 27 10:49:19 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 27 10:49:05 2005
Subject: [antlr-interest] v3 code generator developers unite!
Message-ID: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>

Howdy,

More and more people are coming forward to build back-ends for v3  
(since it's so easy). :)  I'd like to ensure we coordinate and don't  
waste effort.  Further, we should all record our thoughts so we can  
cobble together a guide to building a code generator.  As I see it,  
the first targets must be:

Java: uncle T
C++: Ric
C#: Michael / Kunle??
C: Jim Idle
Objective-C: Kay Roepke just signed up (should coordinate with Jim Idle)

Then we could get:

Python: Marq Kole?
Ruby: ??
LISP: somebody is exploring this at the moment

What other targets are useful?

Ter
From parrt at cs.usfca.edu  Sun Nov 27 10:54:44 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Nov 27 10:54:25 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <4389FC52.8060503@stud3.tuwien.ac.at>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<324997DC-C520-4473-A0B0-137363B87553@cs.usfca.edu>
	<4389FC52.8060503@stud3.tuwien.ac.at>
Message-ID: <07574F1F-032C-4CD3-B1AD-E95AB5D2611B@cs.usfca.edu>


On Nov 27, 2005, at 10:34 AM, Stefan Rank wrote:

> on 27.11.2005 18:07 Terence Parr said the following:
>> On Nov 26, 2005, at 4:04 PM, Ric Klaren wrote:
>>> Just a thought: Isn't it easier then to use single quotes in  
>>> stead of
>>> double quotes for everything ? Assuming that double quotes are used
>>> more often.
>> Hi Ric.  I'm willing to change it to '...' just to make those  
>> unit  tests readable again!  However, we should focus on what is  
>> better for  the people that specify a grammar.  Most people will  
>> be used to  seeing double quotes for strings but the double quotes  
>> around a char  (particularly in a "0".."9" situation) will seem  
>> unusual.  The other  way, actually might not bother people 'int'  
>> and 'begin' actually  immediately make you say "oh, they are using  
>> single quote for string  character".   Hmm...did I just convince  
>> myself to spend 4 hours  changing tests/examples/code to single  
>> quotes?  Argh!  Ok, we better  wait until people come back to work  
>> on Monday to decide this.  I'm  all ears as we say...suggestions?
>
> This may be heretic, but what about allowing both variants?
> (just as python does)

Hi Stefan. :)  Well, I'm of the camp that likes one way to do each  
thing.  Escaping a quote happens once or twice in for parsing a  
language like Java...not a big deal.  I did consider the issue of  
perhaps multi-line strings etc..., but you are breaking stuff up into  
bites on purpose with a parser...you don't get long token string  
definitions.

> This makes parsing harder, but everyone can choose what looks best,  
> a source of error (using the wrong quotes) is eliminated, and the  
> need to escape is reduced to the cases where you have both ' and "  
> inside the string.

I'm mainly concerned with the 100s of unit tests I have that are now  
unreadable.  i'm tempted to make it '...' just to get my unit tests  
back ;)

I was thinking on the way to my office today that perhaps if we use  
'...' for literals, then "..." could be used for a lexer grammar  
fragment like: "'0'..'9'* ('X'|'L')", but then I decided that this is  
rarely what you want...unless you are trying to write a small amazing  
example for a journal paper article ;)

Ter
From kroepke at dolphin-services.de  Sun Nov 27 11:05:24 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Sun Nov 27 11:05:32 2005
Subject: [antlr-interest] v3 code generator developers unite!
In-Reply-To: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
References: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
Message-ID: <982C766F-1E7C-4F24-893D-63C215BBF8FC@dolphin-services.de>


On 27. Nov 2005, at 19:49 Uhr, Terence Parr wrote:

> What other targets are useful?

I could probably be talked into doing a Perl backend, too...;)
Although that pretty much depends on how much my $day_job has a need  
for parsers
in Perl.

Kay
From MichaelNedzelsky at yandex.ru  Sun Nov 27 12:37:29 2005
From: MichaelNedzelsky at yandex.ru (Michael Nedzelsky)
Date: Sun Nov 27 12:37:44 2005
Subject: [antlr-interest] v3 code generator developers unite!
In-Reply-To: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
References: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
Message-ID: <200511272337.29884.MichaelNedzelsky@yandex.ru>

> As I see it,
> the first targets must be:
>
> Java: uncle T
> C++: Ric
> C#: Michael / Kunle??
> C: Jim Idle
> Objective-C: Kay Roepke just signed up (should coordinate with Jim Idle)
>
> Then we could get:
>
> Python: Marq Kole?
> Ruby: ??
> LISP: somebody is exploring this at the moment
>
> What other targets are useful?

Oberon, Component Pascal
Eiffel (may be SmartEiffel and ECMA Eiffel - now they are different languages)

Michael Nedzelsky

From eric.mahurin at gmail.com  Sun Nov 27 13:07:40 2005
From: eric.mahurin at gmail.com (Eric Mahurin)
Date: Sun Nov 27 13:07:41 2005
Subject: [antlr-interest] ANTLR v3 ruby grammar
In-Reply-To: <07570D69-A84A-40FE-B296-665E5BCE3E70@cs.usfca.edu>
References: <07570D69-A84A-40FE-B296-665E5BCE3E70@cs.usfca.edu>
Message-ID: <29256ea00511271307s3b02c732kc50d014e83e3d6e5@mail.gmail.com>

On 11/27/05, Terence Parr <parrt@cs.usfca.edu> wrote:
> BTW, I'm working on a Ruby grammar as a means of testing and making
> ANTLR more friendly; right now it crashes with any bad input.  If
> anybody wants to help with the ruby grammar, you can lurk/join-in on
> the list:
>
> http://rubyforge.org/mailman/listinfo/rubygrammar-grammarians
>
> and here is the rubyforge project:
>
> http://rubyforge.org/projects/rubygrammar/
>
> Ter
>

I am quite interested.  I'm also try to get a ruby parser working in a
LL parser (my grammar project).  I think it would be quite useful to
collaborate.  Here are a few questions I have:

- What are you using as a spec?  parse.y from ruby 1.8?  This is what I'm using.

- Are you going to have the parser control the lexer state as it is
done in parse.y?  I'm doing this and possibly refactoring a little.
The big downside is that the parser and lexer have to stay
synchronized making a multi-threaded solution be slow - mine.  I'll
redo mine at a certain point to not be multi-threaded.

- Do heredocs look feasible?  I think this is the toughest lexer
feature.  My current plan is to read/store the rest of the line, lex
the heredoc, and push ("unread") the stored rest of line back to the
input cursor so that it reads it next.  I'll need to use an
appropriate buffering cursor to be able to do this (usually my lexers
go almost directly from the IO - just needing IO#getc).

- Are you planning on doing a complete LR to LL conversion or do
something else where it gets messy?  I believe in some places doing a
complete conversion may make portions of the grammar grow unwieldy.
An example is a LHS vs an expression.  With LR parsing, you can figure
out whether something is assignable by looking at the right side of
the expression.  Currently, my plan is to pass around some parser
state where necessary.  For example, when parsing an expression, I'll
return whether the expression is assignable or not.

- What's the status?  With mine, I have a lexer with all the states
(but the parser isn't manipulating them yet).  The lexer is fairly
complete with the exception of various quoting mechanisms (heredocs
are missing completely).  I'm still working through the parser to
convert from LR to LL.

- Are you planning on doing ruby code generation for ANTLR?

Good luck!  Ruby is a very tough think to parse in my opinion.

Eric
From mail at martin-probst.com  Sun Nov 27 13:08:03 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 27 13:08:12 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
	<DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>
Message-ID: <1133125683.9590.5.camel@localhost.localdomain>

Hi,

> For that matter the double quote is on Shift-2. Even more awkwardly  
> the numerous brackets, braces, parens are
> all hidden away with modifier keys on the 8 and 9 keys (differently  
> on the Mac of course...I think the square
> ones are on Alt-5 and Alt-6 but I cannot remember that, since I long  
> ago switched to an US-style keyboard layout
> and hardware for that reason alone..)

That's why I use a modified US layout for programming, it's just
unbearable with the {} and []. French is even more weird, where you have
to press shift to type numbers ...

Anyway, the ' vs " thing is not really an issue, I just wanted to point
that out, not that we Europeans get out of sight in here ;-)

Is quoting/escaping really an issue? I guess most of the time the source
code to be parsed will reside in it's own file, without quoting issues,
or not?

Martin

From mental at rydia.net  Sun Nov 27 13:09:57 2005
From: mental at rydia.net (MenTaLguY)
Date: Sun Nov 27 13:09:28 2005
Subject: [antlr-interest] v3 code generator developers unite!
In-Reply-To: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
References: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
Message-ID: <1133125797.24508.56.camel@localhost.localdomain>

On Sun, 2005-11-27 at 10:49 -0800, Terence Parr wrote:
> Ruby: ??

I'm interested in doing the Ruby backend, once I get a good handle on
normal use of ANTLR.

-mental
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051127/7a371b4b/attachment.bin
From mail at martin-probst.com  Sun Nov 27 13:18:33 2005
From: mail at martin-probst.com (Martin Probst)
Date: Sun Nov 27 13:18:42 2005
Subject: [antlr-interest] Incremental Lexing in an Editor with Stateful
	Lexers
Message-ID: <1133126313.9590.13.camel@localhost.localdomain>

Hi,

I'm currently trying to create a nice GUI for our XQuery enabled XML
database. This of course includes a proper editor for XQuery, and I'm
going to do that in Eclipse. Eclipse standard TextEditors have some
really nifty features about incremental/partial parsing, e.g.
partitioning the document, detecting the 'damage' done to the view and
re-lexing only those parts that are damaged.

So far so good, but my language (XQuery) requires highly stateful
lexing. I have to maintain several different states throughout the
process, every input usually changes state, and to top it off I need a
stack of states.

So my problem is: even if I'm able to detect where exactly someone typed
something, I cannot start lexing for that region only again, as I need
the state stack the Lexer was in just before that region. This would be
fairly complex and brings a lot of overhead in turn (storing the lexing
state stack for each token).

I can only think of two solutions, either mark the places where the
lexer returns to the default state with an empty stack, or copy and
store the whole stack every n tokens. Another solution would be to
re-lex lazily after some 100ms of no keyboard activity, but that seems
less attractive (and is also not so easy, with background threads and
such...).

Has anyone done something like this before? Any experiences/tips?

Martin

From wirecracker at gmail.com  Sun Nov 27 18:19:03 2005
From: wirecracker at gmail.com (eric nelson)
Date: Sun Nov 27 18:19:05 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
Message-ID: <ca5eeb330511271819i5792b47ax2ad9556cdd94107a@mail.gmail.com>

Yeah!  Finally I can actually contribute something instead of just lurking
around :)

In Japan, I've been using a keyboard where the double quote is typed via
"Shift + 2", the single quote is typed via "Shift + 7".  So mabye we should
form an intensive study to determine whether people prefer using their left
ring finger or their right index finger!  Totally kidding ... please
don't ;)

I hope that helps, however small a contribution it is ;)

 - e



On 11/27/05, Terence Parr <parrt@cs.usfca.edu> wrote:
>
>
> On Nov 27, 2005, at 9:05 AM, Martin Probst wrote:
>
> >> Also to type a double quote you need to press the shift key+quote key
> >> while for the single quote you just press the quote key ;-)
> >
> > ... on a US/English keyboard. On French (?) and German keyboards
> > you'll
> > have to break your fingers to reach the single quote.
>
> ah!  A good argument!  Yes, I remember typing on a french keyboard
> for 6 months.  Fun flipping back and forth between that and US
> layout.  What exactly is the sequence again for single quote on euro-
> keyboards?  What about Asian keyboards?
>
> Ok, so we have a pretty good argument FOR and AGAINST now.  More
> ideas folks?
>
> Terence
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051127/32830fa3/attachment.html
From prashant.deva at gmail.com  Sun Nov 27 19:24:09 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Sun Nov 27 19:24:13 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <ca5eeb330511271819i5792b47ax2ad9556cdd94107a@mail.gmail.com>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
	<ca5eeb330511271819i5792b47ax2ad9556cdd94107a@mail.gmail.com>
Message-ID: <41fed8f80511271924q3977a08cu72f5f8c3a41409c8@mail.gmail.com>

Also escaping quotes in not a problem if your are using eclipse, as it does
that for you automatically ;-)
--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051128/bbb0c260/attachment.html
From Anthony.Youngman at eca-international.com  Mon Nov 28 03:32:17 2005
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Mon Nov 28 03:32:20 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
Message-ID: <C7FE35004D40FD45AA342991B88CE404012900C8@lnml1.eca-international.local>

And don't forget, in some languages newlines have semantic meaning.

For example, in DATABASIC, they can be a *block* terminator.

I have a load of code to handle newlines, for precisely this reason. Oh
- and don't forget you're jumping to assumptions that a newline is \r
and/or \n. I've worked on a system where it could be (iirc) \n or \n\0.
Lines were stored in an exact multiple of 16-bit words, null-padded ...

My preferred solution would be a special code eg '\lf' which is platform
dependent, but even that screws up - I do a load of work on Windows then
process it on linux - it's nice to work with tools that don't care.

Cheers,
Wol

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Martin Probst
Sent: 25 November 2005 23:29
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] Antlr 3 and the newline token problem

Am Freitag, den 25.11.2005, 20:58 +0000 schrieb Micheal J:
> Please don't post HTML mail to the list. 

Yeah, please don't do that. You too ;-)

> WS : '\r' '\n' {newline();}
>        | '\r'    {newline();}
>        | '\n'   {newline();}
>      ;

What about

NL: (('\r' ( '\n' /* Windows */ | /* empty, MAC OS <=9 */ )
    ) | '\n' /* the proper way ... */ ) { newline(); };

(untested, but works, doesn't it?).

It's a documentation issue, just put it into a prominently linked FAQ.
Also tell people which method to override in case they want to count
from 0 (e.g. "return super.getLine() - 1;").

I would opt against doing the newline magic behind the scenes
automagically. Doing newlines properly is a good exercise to get started
with ANTLR, and those who can't get it to work with some documentation
have much bigger problems. On the other hand, there are people parsing
binary files (line what?), people using Eclipse (that's the offset
people ;-)), people who want to provide proper line/column numbers to
users. It's easy to do all of these, just some minor Java work. IMHO
ANTLR should keep out of that business.

Martin


* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From parrt at cs.usfca.edu  Mon Nov 28 09:25:56 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 28 09:25:34 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <1133125683.9590.5.camel@localhost.localdomain>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
	<DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>
	<1133125683.9590.5.camel@localhost.localdomain>
Message-ID: <ED16A7BA-B200-4F2F-AB0E-0D01877E44D4@cs.usfca.edu>


On Nov 27, 2005, at 1:08 PM, Martin Probst wrote:

> Hi,
>
>> For that matter the double quote is on Shift-2. Even more awkwardly
>> the numerous brackets, braces, parens are
>> all hidden away with modifier keys on the 8 and 9 keys (differently
>> on the Mac of course...I think the square
>> ones are on Alt-5 and Alt-6 but I cannot remember that, since I long
>> ago switched to an US-style keyboard layout
>> and hardware for that reason alone..)
>
> That's why I use a modified US layout for programming, it's just
> unbearable with the {} and []. French is even more weird, where you  
> have
> to press shift to type numbers ...

Yeah, I found that really strange and uncomfortable.  The English  
keyboard just seems made for coding...well, now if we could banish  
that stupid capslock and replace it with the ctrl key like gawd  
intended. ;)  Seriously, has anyone actually used capslock for  
anything ('cept shouting!)? ;)

> Anyway, the ' vs " thing is not really an issue, I just wanted to  
> point
> that out, not that we Europeans get out of sight in here ;-)

Indeed...

> Is quoting/escaping really an issue? I guess most of the time the  
> source
> code to be parsed will reside in it's own file, without quoting  
> issues,
> or not?

Yep.  I'm building a ruby grammar at the moment and this double quote  
just looks super wrong to me in the lexer and for many literals in  
the parser...seriously thinking about taking the 4 hours to switch  
all my unit tests to single quotes and change the code ;)

Ter
From jimi at temporal-wave.com  Mon Nov 28 10:47:02 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon Nov 28 10:47:04 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BF0E@wavemachine.temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Anthony Youngman
> Sent: Monday, November 28, 2005 3:32 AM
> To: antlr-interest@antlr.org
> Subject: RE: [antlr-interest] Antlr 3 and the newline token problem
> 
> And don't forget, in some languages newlines have semantic meaning.
> 
> For example, in DATABASIC, they can be a *block* terminator.

Unless you use ANTLR 3, where having to use the newlines in parsing this
was not needed :-)

Jim
From open.zone at virgin.net  Mon Nov 28 11:48:13 2005
From: open.zone at virgin.net (Micheal J)
Date: Mon Nov 28 11:32:37 2005
Subject: [antlr-interest] Antlr 3 and the newline token problem
In-Reply-To: <1133023956.9942.30.camel@localhost.localdomain>
Message-ID: <003d01c5f454$ac529290$6b02a8c0@hercules>

> > In any case you've omitted the per-character call for col/offset 
> > tracking. We were discussing line/col/offset counting not just 
> > newlines.
> 
> Well, the offset gets tracked anyway, as ANTLR is going 
> through a String where it has to track the input position 
> anyways. That value is IIRC also accessible (or could be made 
> accessible very easily).

Assuming the implementation buffers the whole input in a string/char[]. Not
optimal for larger files (especially if parser is building ASTs and
"project" contains multiple files).

> What is left is line breaks. How would you imagine ANTLR 
> Lexers do that more efficiently? E.g. always checking if the 
> next character(s) is a \r \n, \n or \r? What about users that 
> want \0 to be their line separator? Or users that don't want 
> that at all?

Special syntax to inform ANTLR of what constitues a "newline"?

> > If the lexer was built to do it properly, there would be no 
> function 
> > calls at all.
> 
> The overhead of a function call on x86 is very low. Plus, 
> your compiler might decide to inline, at least in managed 
> languages, as said. For C++ a no-virtual-method-needed way 
> via templates has been discussed.

Either way, the lexer core either supports it or performance degrades
(probably not as much for C/C++).

> The only thing that is (currently) done using an overridden 
> method is the newline thing, isn't it? A per character 
> virtual method call would be ugly, that's true.
> 
> Are you using the Lexer standalone? Even in that case I'd 
> wonder if it really makes a difference. For each character 
> you have at least one switch, you have the testing of 
> alternatives etc. Will a virtual method call for every ~20 
> characters make a difference bigger than maybe 1%?

For tracking newlines only, it will be on par with ANTLR v2 lexers I guess.

> I'm not generally arguing against including something like 
> that, but you'd have to find a very flexible way to do so. 
> Otherwise users will be unhappy because it doesn't match what 
> they want to have, and their solution might get more complex.

Would some syntax that instructs ANTLR on what constitutes a newline do?

Micheal

From Bernhard.Schmalhofer at gmx.de  Mon Nov 28 12:20:05 2005
From: Bernhard.Schmalhofer at gmx.de (Bernhard Schmalhofer)
Date: Mon Nov 28 12:20:16 2005
Subject: [antlr-interest] v3 code generator developers unite!
In-Reply-To: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
References: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
Message-ID: <438B6675.5090308@gmx.de>

Terence Parr schrieb:

> Howdy,
>
> More and more people are coming forward to build back-ends for v3  
> (since it's so easy). :)  I'd like to ensure we coordinate and don't  
> waste effort.  Further, we should all record our thoughts so we can  
> cobble together a guide to building a code generator.  As I see it,  
> the first targets must be:
>
> Java: uncle T
> C++: Ric
> C#: Michael / Kunle??
> C: Jim Idle
> Objective-C: Kay Roepke just signed up (should coordinate with Jim Idle)
>
> Then we could get:
>
> Python: Marq Kole?
> Ruby: ??
> LISP: somebody is exploring this at the moment
>
> What other targets are useful?

Hi,

I'm currently playing with ANTLR and Parrot, http://www.parrotcode.org.
So I'm interested in working on a PIR backend.

CU, Bernhard

From parrt at cs.usfca.edu  Mon Nov 28 12:28:33 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 28 12:28:13 2005
Subject: [antlr-interest] v3 code generator developers unite!
In-Reply-To: <438B6675.5090308@gmx.de>
References: <7BC0C559-B7EF-4E17-8F54-A4001B3065D9@cs.usfca.edu>
	<438B6675.5090308@gmx.de>
Message-ID: <51363408-8CFA-41F2-8BFC-D2F4FD7B3DB9@cs.usfca.edu>


On Nov 28, 2005, at 12:20 PM, Bernhard Schmalhofer wrote:
> Hi,
>
> I'm currently playing with ANTLR and Parrot, http:// 
> www.parrotcode.org.
> So I'm interested in working on a PIR backend.

Nice!  Got you down for Parrot :)

Ter
From open.zone at virgin.net  Mon Nov 28 12:55:41 2005
From: open.zone at virgin.net (Micheal J)
Date: Mon Nov 28 12:40:09 2005
Subject: [antlr-interest] newlines in v3 (codegen, runtime solutions)
In-Reply-To: <B0B6C720-4800-4831-BA16-9D254EB0F4F1@cs.usfca.edu>
Message-ID: <004001c5f45e$18bb04e0$6b02a8c0@hercules>

> My philosophy behind v3 is that it should do by default what most  
> people will want it to do.  Most people just want it to work and
> are not that concerned with speed.

Noted. We'll adopt that philosophy for the v3 codegen.

Micheal

From chris at lotuscat.com  Mon Nov 28 13:20:33 2005
From: chris at lotuscat.com (Chris Black)
Date: Mon Nov 28 13:20:39 2005
Subject: [antlr-interest] newlines in v3 (codegen, runtime solutions)
In-Reply-To: <004001c5f45e$18bb04e0$6b02a8c0@hercules>
References: <004001c5f45e$18bb04e0$6b02a8c0@hercules>
Message-ID: <438B74A1.7020406@lotuscat.com>

Micheal J wrote:

>>My philosophy behind v3 is that it should do by default what most  
>>people will want it to do.  Most people just want it to work and
>>are not that concerned with speed.
>>    
>>
>
>Noted. We'll adopt that philosophy for the v3 codegen.
>
>Micheal
>  
>
Neeeoooooohhh!!!
It makes me crazy when I see exchanges like this. We use ANTLR not only 
because it is easier to write and more maintainable in many instances, 
but because it is FAST! I don't see how having it "just work" is at odds 
with making it quick. I've also already stated my opinion that I would 
much rather have speed over prettiness/readability of generated code. I 
just really don't understand the attitude some people seem to have 
regarding speed trade offs. SPEED IS IMPORTANT TO MANY USERS.

Chris
From parrt at cs.usfca.edu  Mon Nov 28 13:32:52 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Nov 28 13:32:28 2005
Subject: [antlr-interest] newlines in v3 (codegen, runtime solutions)
In-Reply-To: <438B74A1.7020406@lotuscat.com>
References: <004001c5f45e$18bb04e0$6b02a8c0@hercules>
	<438B74A1.7020406@lotuscat.com>
Message-ID: <8CA6CBCD-81A7-413F-BB8D-AD167ED4DB50@cs.usfca.edu>

On Nov 28, 2005, at 1:20 PM, Chris Black wrote:
> Micheal J wrote:
>
>>> My philosophy behind v3 is that it should do by default what  
>>> most  people will want it to do.  Most people just want it to  
>>> work and
>>> are not that concerned with speed.
>>>
>>
>> Noted. We'll adopt that philosophy for the v3 codegen.
>>
>> Micheal
>>
> Neeeoooooohhh!!!
> It makes me crazy when I see exchanges like this. We use ANTLR not  
> only because it is easier to write and more maintainable in many  
> instances, but because it is FAST!

Hi.  Apparently you're saying I know how to do both so don't worry. ;)

> I don't see how having it "just work" is at odds with making it  
> quick. I've also already stated my opinion that I would much rather  
> have speed over prettiness/readability of generated code. I just  
> really don't understand the attitude some people seem to have  
> regarding speed trade offs. SPEED IS IMPORTANT TO MANY USERS.

Yep, and you'll get it either by default or by stripping things down  
easily.  Jim Idle reports that the current Java target with all the  
goodies results in faster parsers than v2 (I should hope so!).

Ter
From jimi at temporal-wave.com  Mon Nov 28 16:01:39 2005
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon Nov 28 16:01:42 2005
Subject: [antlr-interest] newlines in v3 (codegen, runtime solutions)
Message-ID: <B36CCC332A32904F8FA3DE134A23533615BF14@wavemachine.temporal-wave.com>

I should qualify that the particular parser I have was faster - it would
be hard to justify a claim to ALL parsers from that one instance ;-).
However, I think that the general layout of the generated code and the
runtime should result in ANTLR3 being faster. 

On the speed vs "load-and-go" bit, I think that anyone wanting to get
more speed is mostly willing to look in to the innards a bit. Therefore,
if the defaults can be tuned easily to a specific situation without
nailing anyone to a cross, then I think everyone will be happy. Here we
are not talking about precluding speed, but that a parser generated with
the defaults might not be as fast as one generated with a few overrides.

All in all, I would expect the C targets to be faster than the other
targets (though these days the C++ compilers are not the overhead they
once seemed to be, so the C++ target may well be the equal). We will
find out soon enough I guess. So, if you really want the fastest parser,
you would probably use the C target and override anything that your
particular parser wasn't interested in. If you MUST have java, then the
tweaking rules apply there but you may not be able to get it to go as
fast as a C version.

Having said that, maybe the JIT and ANTLR 3 structure will make it all
irrelevant anyway!

Jim

> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-


> Yep, and you'll get it either by default or by stripping things down
> easily.  Jim Idle reports that the current Java target with all the
> goodies results in faster parsers than v2 (I should hope so!).
> 
> Ter
From robgreene at gmail.com  Mon Nov 28 19:00:24 2005
From: robgreene at gmail.com (Rob Greene)
Date: Mon Nov 28 19:00:28 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
Message-ID: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>

At work, I'm trying to get functions to work within expressions but I
have no clue how to handle the variable number of parameters (the
functions will be defined outside of the grammar file). The example
(the basic interpreter) doesn't explain what's going on, so is simply
baffling to me.

I've got my early prototype here at home (amazing how a lot of cool
work is done first at home!), and am identifying the function, but I'm
not sure how to pick up the parameters (which are expressions
themselves, of course).

What I'm expecting to be able to do is to fire a rule when the
argument/expression is evaluated, allowing me to add the result to a
list, for example. Then, when the function "executes", those
parameters are available. Note that the arguments must be evaluated
prior to the function being triggered.

I've included my sample from home. Evaluates expressions as double
(boolean reverts to zero being false and non-zero being true).
expression.g is the grammar and Main.java is my stupid test-bed.

Suggestions or pointers?

Thanks!
-Rob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: expression.g
Type: application/octet-stream
Size: 2816 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051128/14c12382/expression.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Main.java
Type: application/octet-stream
Size: 1174 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051128/14c12382/Main.obj
From sohail at taggedtype.net  Mon Nov 28 19:19:13 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Mon Nov 28 19:19:22 2005
Subject: [antlr-interest] How does one handle variable number of
	function parameters?
In-Reply-To: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
Message-ID: <1133234353.8214.0.camel@localhost.localdomain>

On Mon, 2005-28-11 at 21:00 -0600, Rob Greene wrote:
> At work, I'm trying to get functions to work within expressions but I
> have no clue how to handle the variable number of parameters (the
> functions will be defined outside of the grammar file). The example
> (the basic interpreter) doesn't explain what's going on, so is simply
> baffling to me.

Functions within expressions? Could you elaborate a bit? Do you mean
that an expression can contain a function call?

Sohail

From robgreene at gmail.com  Mon Nov 28 20:05:54 2005
From: robgreene at gmail.com (Rob Greene)
Date: Mon Nov 28 20:05:55 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <1133234353.8214.0.camel@localhost.localdomain>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
Message-ID: <738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>

On 11/28/05, Sohail Somani <sohail@taggedtype.net> wrote:
> On Mon, 2005-28-11 at 21:00 -0600, Rob Greene wrote:
> > At work, I'm trying to get functions to work within expressions but I
> > have no clue how to handle the variable number of parameters (the
> > functions will be defined outside of the grammar file). The example
> > (the basic interpreter) doesn't explain what's going on, so is simply
> > baffling to me.
>
> Functions within expressions? Could you elaborate a bit? Do you mean
> that an expression can contain a function call?

Exactly. I may be embedding something like
"veryImportantFunction(32/3, anotherFunc(3, 2)) < 25" or
"nameOfThis(12356) = 'Fred'". How do I get the subexpressions? (ie,
"32/3" and "anotherFunc(3,2)" for the veryImportantFunction.

I want to have the functions expandable without embedding them into
the grammar - especially since I'm the only one at this time with an
idea on how the whole thing works! Setting up the functions and
identifying them is pretty easy.

As an FYI, these functions will be going against various sets of data
as well as accessing the database. Not that it matters for the
exercise. :-)

How do I handle all the function parameter expressions is what's throwing me...
-Rob
From ewbank at gmail.com  Mon Nov 28 21:31:54 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Mon Nov 28 21:31:57 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
Message-ID: <dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>

On 11/28/05, Rob Greene <robgreene@gmail.com> wrote:
> How do I handle all the function parameter expressions is what's throwing me...
> -Rob
>

A function call sounds like it looks something like this:

   function_call : ID LPAREN^ args RPAREN!;
   args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;

Is this the place you need help, or is it something after this? Once
you have it parsed, where do you need to go?
From sohail at taggedtype.net  Mon Nov 28 22:25:39 2005
From: sohail at taggedtype.net (Sohail Somani)
Date: Mon Nov 28 22:26:06 2005
Subject: [antlr-interest] How does one handle variable number of
	function parameters?
In-Reply-To: <738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
Message-ID: <1133245539.10100.1.camel@localhost.localdomain>

On Mon, 2005-28-11 at 22:05 -0600, Rob Greene wrote:
> On 11/28/05, Sohail Somani <sohail@taggedtype.net> wrote:
> > On Mon, 2005-28-11 at 21:00 -0600, Rob Greene wrote:
> > > At work, I'm trying to get functions to work within expressions but I
> > > have no clue how to handle the variable number of parameters (the
> > > functions will be defined outside of the grammar file). The example
> > > (the basic interpreter) doesn't explain what's going on, so is simply
> > > baffling to me.
> >
> > Functions within expressions? Could you elaborate a bit? Do you mean
> > that an expression can contain a function call?
> 
> Exactly. I may be embedding something like
> "veryImportantFunction(32/3, anotherFunc(3, 2)) < 25" or
> "nameOfThis(12356) = 'Fred'". How do I get the subexpressions? (ie,
> "32/3" and "anotherFunc(3,2)" for the veryImportantFunction.
> 
> I want to have the functions expandable without embedding them into
> the grammar - especially since I'm the only one at this time with an
> idea on how the whole thing works! Setting up the functions and
> identifying them is pretty easy.
> 
> As an FYI, these functions will be going against various sets of data
> as well as accessing the database. Not that it matters for the
> exercise. :-)

It might do you good to print out (and thoroughly read)
http://www.javadude.com/articles/antlrtut

From mail at martin-probst.com  Tue Nov 29 01:24:38 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 29 01:24:45 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <ED16A7BA-B200-4F2F-AB0E-0D01877E44D4@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>
	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>
	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>
	<1133111158.9590.1.camel@localhost.localdomain>
	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>
	<DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>
	<1133125683.9590.5.camel@localhost.localdomain>
	<ED16A7BA-B200-4F2F-AB0E-0D01877E44D4@cs.usfca.edu>
Message-ID: <1133256278.8208.5.camel@localhost.localdomain>

> Yeah, I found that really strange and uncomfortable.  The English  
> keyboard just seems made for coding...

Or maybe just the other way round ...

> Seriously, has anyone actually used capslock for  
> anything ('cept shouting!)? ;)

Well, if your CAPS works like IBM intended it, then you'll get uppercase
characters but 'lowercase' numbers and punctuation. That may be useful,
under yet to be known circumstances...

Most people I know who do a lot of programming have some sort of a
customised keyboard layout.

Martin

From vonwedel at web.de  Tue Nov 29 01:26:25 2005
From: vonwedel at web.de (Lars von Wedel)
Date: Tue Nov 29 01:26:46 2005
Subject: [antlr-interest] Defining keywords with varying length
Message-ID: <438C1EC1.8000206@web.de>


Hello,

I am about to write parsers for (lots of) input files to an existing 
tool. The language I have to deal with (besides other annoyances) 
permits abbreviated keywords, so you could write something like

 LIBRARY

as a keyword, but since

 LIB

is unique to identify that keyword it would be sufficient, as well as 
anything else such as LIBR, LIBRAR or so. Defining all these variants as 
tokens and dealing with them in the parser does not appear as a clean 
solution to me.

How would I best incorporate this into a lexer/parser developed in Antlr?

Lars


From mail at martin-probst.com  Tue Nov 29 02:15:36 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 29 02:15:42 2005
Subject: [antlr-interest] Defining keywords with varying length
In-Reply-To: <438C1EC1.8000206@web.de>
References: <438C1EC1.8000206@web.de>
Message-ID: <1133259336.8208.13.camel@localhost.localdomain>

Well, you can have a rule:

tokens {
  LIBRARY,
  FOO,
  BAR
}

KEYWORD {
  
}:
  ('a'..'z'|'A'..'Z')+
  { $setType(myKeywords.lookup($getText())); 
    /* LIBRARY for "LIB", "LIBR" etc., FOO for "foo", ... */ }

And then you'd have to maintain a structure myKeywords which maps from
word-start to token types. You'd probably want to use a TRIE for that.

Martin

From gt54-antlr at cyconix.com  Tue Nov 29 02:50:19 2005
From: gt54-antlr at cyconix.com (Paul Johnson)
Date: Tue Nov 29 02:50:30 2005
Subject: [antlr-interest] changed 'x' to "x" for v3
In-Reply-To: <ED16A7BA-B200-4F2F-AB0E-0D01877E44D4@cs.usfca.edu>
References: <6111CD03-07A4-445B-B20F-3407C04762BD@cs.usfca.edu>	<bc607a4e0511261604n1fbcae02oa736c9debe5c21f9@mail.gmail.com>	<41fed8f80511270533g7c119e97u72a52d65a09d7de0@mail.gmail.com>	<1133111158.9590.1.camel@localhost.localdomain>	<29026E19-8CC6-4202-9EB1-CAADC8B33521@cs.usfca.edu>	<DDFA0B1E-F9A0-4B82-A77D-4055FD8403B4@dolphin-services.de>	<1133125683.9590.5.camel@localhost.localdomain>
	<ED16A7BA-B200-4F2F-AB0E-0D01877E44D4@cs.usfca.edu>
Message-ID: <438C326B.7050905@cyconix.com>

Terence Parr wrote:

> Seriously, has anyone actually used capslock for  anything ('cept 
> shouting!)? ;)

A lot of VHDL coders use caps a lot. The language itself is 
case-insensitive.

Paul

From robgreene at gmail.com  Tue Nov 29 05:35:48 2005
From: robgreene at gmail.com (Rob Greene)
Date: Tue Nov 29 05:35:51 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <1133245539.10100.1.camel@localhost.localdomain>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<1133245539.10100.1.camel@localhost.localdomain>
Message-ID: <738584f80511290535w2b8d0c21mff072a4b6e49b4b@mail.gmail.com>

> It might do you good to print out (and thoroughly read)
> http://www.javadude.com/articles/antlrtut

Been there (printed it out). I have the grammar defined, but I don't
know what I need to do in the tree parser. (Actually, I think I need
to redefine the function in the parser itself too...)
-Rob
From robgreene at gmail.com  Tue Nov 29 05:43:07 2005
From: robgreene at gmail.com (Rob Greene)
Date: Tue Nov 29 05:43:09 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
Message-ID: <738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>

> A function call sounds like it looks something like this:
>
>    function_call : ID LPAREN^ args RPAREN!;
>    args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;
>
> Is this the place you need help, or is it something after this? Once
> you have it parsed, where do you need to go?

Yes, I think this is where I need help. I've currently got the
function defined as this (identifier piece, of course):

term
	: NUMBER
	| LPAREN! expression RPAREN!
	| IDENTIFIER^ ( LPAREN! expression (COMMA! expression)* RPAREN! )?
	;

I see:
1) You've made the LPAREN the root - why? I figured I'd have the
IDENTIFIER as the root with the expressions as the children. Probaby
doesn't matter if I get the tree parser setup right...?

2) What the heck does this mean? I've seen it mentioned in the ANTLR
documentation, but I didn't grok it.
    args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;

3) I'd like to have the parenthesis optional. Do I want to have two
definitions to pick up the parenthesis in the parser grammar file?
	| (IDENTIFIER LPARN) => IDENTIFIER^ LPAREN! expression (COMMA!
expression)* RPAREN!
	| IDENTIFIER^

4) and, finally, I need to figure out how to "process" this. With my
expression parser, I'm basically doing an interpreter, so that seems
to make everything a lot simpler. All the other functions are working
(you'll see it at the bottom of the expression.g file.

I've re-attached my current grammar and hacking file just in case that
helps. Note that I think the Main class will hold the function
arguments as they get evaluated and then they will be available for
the function call itself.

Thanks again! This is really neat - but I keep on missing important tidbits. :-(
-Rob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: expression.g
Type: application/octet-stream
Size: 2813 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051129/41c32137/expression.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Main.java
Type: application/octet-stream
Size: 1172 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20051129/41c32137/Main.obj
From mail at martin-probst.com  Tue Nov 29 06:48:18 2005
From: mail at martin-probst.com (Martin Probst)
Date: Tue Nov 29 06:48:25 2005
Subject: [antlr-interest] How does one handle variable number of
	function parameters?
In-Reply-To: <738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
	<738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
Message-ID: <1133275698.8208.24.camel@localhost.localdomain>


> Yes, I think this is where I need help. I've currently got the
> function defined as this (identifier piece, of course):
> 
> term
> 	: NUMBER
> 	| LPAREN! expression RPAREN!
> 	| IDENTIFIER^ ( LPAREN! expression (COMMA! expression)* RPAREN! )?
> 	;
> 
> I see:
> 1) You've made the LPAREN the root - why? I figured I'd have the
> IDENTIFIER as the root with the expressions as the children. Probaby
> doesn't matter if I get the tree parser setup right...?

Yes, that's a matter of style. Just make sure you can easily identify a
function call as a whole, plus the single arguments (and can make out
the difference between a list of arguments and an argument that is a
list, if your language allows that).

> 
> 2) What the heck does this mean? I've seen it mentioned in the ANTLR
> documentation, but I didn't grok it.
>     args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;

## is the AST subtree of the current rule, e.g. in "foo: bar;" it's the
same as #foo. The statement means: create a new Tree "#( ... )" which
roots at a newly created node of type ARGLIST "#[ ... ]" and append as
it's children the current tree "##". Then assign this new AST to the
current tree "## = ...". This basically inserts ARGLIST as a new root to
the current AST, very handy.

> 
> 3) I'd like to have the parenthesis optional. Do I want to have two
> definitions to pick up the parenthesis in the parser grammar file?
> 	| (IDENTIFIER LPARN) => IDENTIFIER^ LPAREN! expression (COMMA!
> expression)* RPAREN!
> 	| IDENTIFIER^

What happens with this:
> myfunc (foo), bar
Is that FUNCTION LPAREN ARGUMENT RPAREN ... syntax error
or FUNCTION ARGUMENT ARGUMENT where (foo) is a single argument? And how
do you want to make out the difference?


> 4) and, finally, I need to figure out how to "process" this. With my
> expression parser, I'm basically doing an interpreter, so that seems
> to make everything a lot simpler. All the other functions are working
> (you'll see it at the bottom of the expression.g file.

Well, if you have something like
expr returns [Result res]: ...
Then you could do:
functionCall {Result arg;}: 
  id:IDENTIFIER ( arg=expr { arguments.add(arg); })*
  { callFunc(#id.getText(), arguments); }

HTH,
Martin

From andy at exchange.voelkel.us  Tue Nov 29 07:27:11 2005
From: andy at exchange.voelkel.us (Andy Voelkel)
Date: Tue Nov 29 07:22:54 2005
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?
Message-ID: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>

Hi all,
I am quite intrigued by the possibilities of ANTLR, and have been
perusing the site. One thing that strikes me is that it seems very
Java/Linux-centric.
Our development is all Windows/C#/.NET based, so that is a potential
mismatch.
Are there a substantial number of ANTLR users who use C#/.NET as a host
platform? Or would that be swimming upstream?
Thanks!
- Andy
P.S. If using ANTLR user Windows/.NET is not a realistic/painless
option, are there other parser/lexer packages that anyone could
recommend?
From ewbank at gmail.com  Tue Nov 29 07:28:38 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Tue Nov 29 07:28:42 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
	<738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
Message-ID: <dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>

On 11/29/05, Rob Greene <robgreene@gmail.com> wrote:
> >    function_call : ID LPAREN^ args RPAREN!;
> >    args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;
>
> 1) You've made the LPAREN the root - why? I figured I'd have the
> IDENTIFIER as the root with the expressions as the children. Probaby
> doesn't matter if I get the tree parser setup right...?

The LPAREN as the root helps to distinguish between an identifier and a function
call with no arguments.  You can probably set up the tree parser correctly, but
I've found it simpler to have different node types for different operations.

<oops>
    I see that your grammar requires at least one argument to a function call;
    I did the same thing, and didn't even notice it.  Was this intentional, so
    you reject things like "date()" as illegal?
</oops>

Generally, if I see lots of references to the type attribute, and to the
shape of the tree, I find it worth while to introduce a new node type.

> 2) What the heck does this mean? I've seen it mentioned in the ANTLR
> documentation, but I didn't grok it.
>     args  :  expr ( COMMA! expr )* { ## = #( #[ARGLIST,"ARGLIST"], ## ); } ;

(just love that word; "grok").

As Martin said, this introduces a wrapper node.  It wraps the expressions in
one node so that the shape of the tree is well-defined.  I find it much easier
to know that only certain nodes have unknown numbers of children, and having a
wrapper node makes this much easier.

Going back to the <oops> above, if functions can be called with zero or more
arguments, then the line-noise above can be changed to this:

    args :
        ( expr ( COMMA! expr )* )?
        { ## = #( #[ARGLIST,"ARGLIST"], ## ); }
        ;

    // perhaps this is easier to understand.  it does (i hope :-) the same
    // thing with an extra production.

    exprlist :
        ( expr ( COMMA! expr )* )?
        ;

    args :
        elist:exprlist
        { #args = #( #[ARGLIST,"ARGLIST"], #elist ); }
        ;

In either case, you are guaranteed to have an ARGLIST node for the
argument list, even if there
are no arguments.  If you need to print out the function call later, that also
gives you a production into which you can place the parens and comma:

    arglist:
        #( ARGLIST
            { cout << "("; }
            (
                expr
                (
                    // commas *between* expressions, not *after* expressions
                    { cout << ", "; }
                    expr
                )*
            )?
            { cout << ")"; }
        )
    ;

> 3) I'd like to have the parenthesis optional. Do I want to have two
> definitions to pick up the parenthesis in the parser grammar file?
>         | (IDENTIFIER LPARN) => IDENTIFIER^ LPAREN! expression (COMMA!
> expression)* RPAREN!
>         | IDENTIFIER^

I'm sorry, I don't grok the purpose of this...  This would be identical to the
original grammar you had with the argument list as optional.
From henryb at ntlworld.com  Tue Nov 29 08:40:27 2005
From: henryb at ntlworld.com (Henry Butowsky)
Date: Tue Nov 29 08:09:56 2005
Subject: [antlr-interest] hyperslabs
Message-ID: <438C847B.5070702@ntlworld.com>

Hi Guys,
   Im using a vary basic C grammer for a scientific application
   I want to be able to use "hyper-slabs" on the left and right hand 
side
   of an assignment statement

   var1(expr,expr,expr)	

    The relevent grammar is:

assign_statement:
         hyper_slb  ASSIGN^ expr SEMI!
      ;


hyper_slb: VAR_ID (arg_list)?
      ;

arg_list
   : LPAREN! expr ( COMMA! expr )* RPAREN!
    { #arg_list = #( [ARG_LIST, "arg_list"], #arg_list ); }
   ;
	   	
   	
so for say  temperaure(2,3,10*2)=100;
I want to get the tree to be something like

( = temperature ( arg_list (20),(3), (*(10,2) ) )  100)

At the momnet Im only getting only the first argument in the tree.
Any Ideas ?

Regards Henry

From vonwedel at web.de  Tue Nov 29 08:13:00 2005
From: vonwedel at web.de (Lars von Wedel)
Date: Tue Nov 29 08:13:25 2005
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?
In-Reply-To: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
References: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
Message-ID: <438C7E0C.9070802@web.de>



Hello,

I am using Antlr with C#/.NET on Windows as well. I picked up the binary 
package and an example and made things work. The biggest obstacle in 
more efficient parser development is my non-existing knowledge about 
finite state automata and other theoretical stuff. Otherwise I am very 
pleased with Antlr, even though I also noted that seems rather driven by 
the Java users of it.

Lars


From monty at codetransform.com  Tue Nov 29 08:18:48 2005
From: monty at codetransform.com (Monty Zukowski)
Date: Tue Nov 29 08:18:57 2005
Subject: [antlr-interest] hyperslabs
In-Reply-To: <438C847B.5070702@ntlworld.com>
References: <438C847B.5070702@ntlworld.com>
Message-ID: <438C7F68.5060803@codetransform.com>

Henry Butowsky wrote:
> Hi Guys,
>   Im using a vary basic C grammer for a scientific application
>   I want to be able to use "hyper-slabs" on the left and right hand side
>   of an assignment statement
> 
>   var1(expr,expr,expr)   
> 
>    The relevent grammar is:
> 
> assign_statement:
>         hyper_slb  ASSIGN^ expr SEMI!
>      ;
> 
> 
> hyper_slb: VAR_ID (arg_list)?
>      ;
> 
> arg_list
>   : LPAREN! expr ( COMMA! expr )* RPAREN!
>    { #arg_list = #( [ARG_LIST, "arg_list"], #arg_list ); }
>   ;
>           
>      
> so for say  temperaure(2,3,10*2)=100;
> I want to get the tree to be something like
> 
> ( = temperature ( arg_list (20),(3), (*(10,2) ) )  100)
> 
> At the momnet Im only getting only the first argument in the tree.
> Any Ideas ?

Yeah, what's your tree grammar?

Also, it would be good to print out the the tree you actually are
producing using toStringList (or is it toStringTree)?

Monty
From MichaelNedzelsky at yandex.ru  Tue Nov 29 08:26:13 2005
From: MichaelNedzelsky at yandex.ru (Michael Nedzelsky)
Date: Tue Nov 29 08:26:32 2005
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?
In-Reply-To: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
References: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
Message-ID: <200511291926.13730.MichaelNedzelsky@yandex.ru>

On Tuesday 29 November 2005 18:27, Andy Voelkel wrote:
> Hi all,
> I am quite intrigued by the possibilities of ANTLR, and have been
> perusing the site. One thing that strikes me is that it seems very
> Java/Linux-centric.
> Our development is all Windows/C#/.NET based, so that is a potential
> mismatch.
> Are there a substantial number of ANTLR users who use C#/.NET as a host
> platform? Or would that be swimming upstream?

I used ANTLR for some C# projects and it works well.
For one  example, see 
http://svn.castleproject.org/svn/castleincubator/trunk/yaml/

Using ANTLR is a pleasure, and you can use for Windows/C# develpoment without 
any troubles.

Hope this helps,
Michael Nedzelsky

From henryb at ntlworld.com  Tue Nov 29 09:00:46 2005
From: henryb at ntlworld.com (Henry Butowsky)
Date: Tue Nov 29 08:30:12 2005
Subject: [antlr-interest] Henry Butowsky wrote: >> Hi Guys,
	>>   Im using a vary basic C grammer for a scientific application
	>>   I want to be able to use "hyper-slabs"
	on the left and right hand side >>   of an assignment statement >> 
Message-ID: <438C893E.2040103@ntlworld.com>

 >>   var1(expr,expr,expr)   
	>> 
	>>    The relevent grammar is:
	>>
 
	>> assign_statement:
	>>         hyper_slb  ASSIGN^ expr SEMI!
	>> 
     ;
	>> 
	>> 
	>> hyper_slb: VAR_ID (arg_list)?
	>>      ;
	>> 

 >> arg_list
	>>   : LPAREN! expr ( COMMA! expr )* RPAREN!
	>>    { #arg_list
 = #( [ARG_LIST, "arg_list"], #arg_list ); }
	>>   ;
	>>           
	>>
      
	>> so for say  temperaure(2,3,10*2)=100;
	>> I want to get the tree
 to be something like
	>> 
	>> ( = temperature ( arg_list (20),(3), (*(10,2)
 ) )  100)
	>> 
	>> At the momnet Im only getting only the first argument
 in the tree.
	>> Any Ideas ?
	
	
	Yeah, what's your tree grammar?
	

 Also, it would be good to print out the the tree you actually are
	producing
 using toStringList (or is it toStringTree)?
	
	Hyperslabs
Content-Type: multipart/mixed;
 boundary="------------080905080509040709030407"

This is a multi-part message in MIME format.
--------------080905080509040709030407
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

Henry Butowsky wrote:

 >> Hi Guys,
 >>   Im using a vary basic C grammer for a scientific application
 >>   I want to be able to use "hyper-slabs" on the left and right hand side
 >>   of an assignment statement
 >>
 >>   var1(expr,expr,expr)
 >>
 >>    The relevent grammar is:
 >>
 >> assign_statement:
 >>         hyper_slb  ASSIGN^ expr SEMI!
 >>      ;
 >>
 >>
 >> hyper_slb: VAR_ID (arg_list)?
 >>      ;
 >>
 >> arg_list
 >>   : LPAREN! expr ( COMMA! expr )* RPAREN!
 >>    { #arg_list = #( [ARG_LIST, "arg_list"], #arg_list ); }
 >>   ;
 >>
 >>
 >> so for say  temperaure(2,3,10*2)=100;
 >> I want to get the tree to be something like
 >>
 >> ( = temperature ( arg_list (20),(3), (*(10,2) ) )  100)
 >>
 >> At the momnet Im only getting only the first argument in the tree.
 >> Any Ideas ?


Yeah, what's your tree grammar?

Also, it would be good to print out the the tree you actually are
producing using toStringList (or is it toStringTree)?

Monty
----------------------------------------------------------------------

Hi Monty

With the following script

a=10.12-20-30-40;
b=-20*-100.987;
c=-100e2/20;
d=10S+20b;
e=1.25f+1e2f+1f;
f=1.25d+1e2+1d;
g=.12;
h=.2e4f+.2e-1f+.2d;
i=2;
j(10)=1-19;

toStringTree() produces

( = a ( - ( - ( - 10.12 20 ) 30 ) 40 ) )
  ( = b ( * ( - 20 ) ( - 100.987 ) ) )
  ( = c ( / ( - 100e2 ) 20 ) )
  ( = d ( + 10S 20b ) )
  ( = e ( + ( + 1.25f 1e2f ) 1f ) )
  ( = f ( + ( + 1.25d 1e2 ) 1d ) )
  ( = g .12 )
  ( = h ( + ( + .2e4f .2e-1f ) .2d ) )
  ( = i 2 )
  ( = j ( arg_list 10 ) ( - 1 19 ) )

---------------------
Parser barfs when j has more than one argument

Attached is my tree grammer

Regards Henry





--------------080905080509040709030407
Content-Type: text/plain;
 name="tree.g"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="tree.g"


class CalcTreeWalker extends TreeParser;



assign 
{
  double r;
}
   :#(ASSIGN  v:VAR_ID  r=out ) {
       Symbol *sp;
       const char* var;                  
       var =v->getText().c_str();

 	   if( (sp=lookup(var)) ) {
		 sp->type=1;
		 sp->u.val=r;
	   }else{
		 sp=install(var,1,r);
	   }
            
      }
   ;

out returns [double r]
{
	double a,b;
	r=0;
}  
    // arithmetic operators 

    :  (#(PLUS out out)) =>  #( PLUS  a=out b=out)	{r = a+b;}
	|  (#(MINUS out out)) => #( MINUS a=out b=out)	{r = a-b;}
	|	#(TIMES a=out b=out)	{r = a*b;}
	|	#(DIVIDE a=out b=out)	{r = a/b;}
	|	#(MOD a=out b=out)	    {r = fmod(a, fabs(b) );}
    |   #(CARET a=out b=out)    {r= pow(a,b); }

    //unary Operators
    |   #(LNOT a=out )        { r=!a; }
	|   #(MINUS a=out )       {r=-a;}
    |   #(PLUS a=out )        {r=+a;}
    
    // math functions 
   |  #(m:FUNC a=out)         { Symbol *sp;
                                const char *var;
                                var =m->getText().c_str();
                                if( (sp=lookup(var)) ) {
                                    r=(sp->u.ptr)(a);
                                }else{
                cout << "Function  " << m->getText() << " not found" << endl;
                exit(1);
                           }
                               }
                                

    // Logical Operators
    | #(LAND a=out b=out)   {r = (a && b); }
    | #(LOR  a=out b=out)   { r = (a || b);   }

    // Comparison Operators
    | #(LTHAN  a=out b=out) { r = (a < b);   }
    | #(GTHAN  a=out b=out) { r = (a >  b);   }
    | #(GEQ  a=out b=out)   { r = (a >= b);   }
    | #(LEQ  a=out b=out)   { r = (a <= b);   }
    | #(EQ  a=out b=out)    { r = (a == b);   }
    | #(NEQ  a=out b=out)   { r = (a != b);   }


    // Naked numbers
	|	c:BYTE			{ 
                         r = atof(c->getText().c_str());
                         //cout << "lexing byte=" << r<< endl;           
                        }
	|	s:SHORT			{r = atof(s->getText().c_str());
                         //cout << "lexing short=" << r<< endl;           
                        }
	|	i:INT			{r = atof(i->getText().c_str());
                         //cout << "lexing int=" << r<< endl;           
                        }
    |   f:FLOAT        { r=strtod(f->getText().c_str(),(char**)NULL); 
                        //cout << "lexing float=" << r<< endl;           
                        }
    |   d:DOUBLE        { r=strtod(d->getText().c_str(),(char**)NULL);
                        //cout << "lexing double=" << r<< endl;           
                        }

    // variables & attributes
	|   v:VAR_ID       { Symbol *sp;
                         const char *var;
                         var =v->getText().c_str();
                           if( (sp=lookup(var)) ) {
                             r=sp->u.val;
                           }else{
                cout << "var " << v->getText() << " not found" << endl;
                exit(1);
                           }
                       }

    |   t:ATT_ID       { Symbol *sp;
                         const char *var;
                         var =t->getText().c_str();
                           if( (sp=lookup(var)) ) {
                             r=sp->u.val;
                           }else{
                cout << "Attribute " << v->getText() << " not found" << endl;
                exit(1);
                           }
                       }
    ;








--------------080905080509040709030407--

From monty at codetransform.com  Tue Nov 29 08:40:09 2005
From: monty at codetransform.com (Monty Zukowski)
Date: Tue Nov 29 08:40:19 2005
Subject: [antlr-interest] Re: hyperslabs
In-Reply-To: <438C893E.2040103@ntlworld.com>
References: <438C893E.2040103@ntlworld.com>
Message-ID: <438C8469.8070602@codetransform.com>

> j(10)=1-19;
> 
> toStringTree() produces
...
>   ( = j ( arg_list 10 ) ( - 1 19 ) )
> 
> ---------------------
> Parser barfs when j has more than one argument
> 
> Attached is my tree grammer
...
> class CalcTreeWalker extends TreeParser;

I think you attached the wrong tree grammar.  Is it the parser or tree
parser that barfs with multiple args?  What's the message?

Something was also hideously wrong in the formatting of that message.
It may be my email client (Thunderbird) or maybe it was something wrong
on your end.   None of the attachments were recognized as attachments.

Monty
From greenj at ix.netcom.com  Tue Nov 29 09:10:15 2005
From: greenj at ix.netcom.com (John Green)
Date: Tue Nov 29 09:10:26 2005
Subject: [antlr-interest] Defining keywords with varying length
In-Reply-To: <438C1EC1.8000206@web.de>
References: <438C1EC1.8000206@web.de>
Message-ID: <438C8B77.1070500@ix.netcom.com>

Hi Lars,

My parser for Progress has to support its nearly 1000 keywords, many of those with abbreviations. Not only that, but the language is case insensitive. Antlr handles all this fine.

You will want to review this link, and the two links it leads to:
  http://antlr.org/doc/lexer.html#Keywords_and_literals

In your case, you will want LIBRARY to be the keyword, but your literals table will contain "LIB", "LIBR", ..., "LIBRARY", all with the integer type for LIBRARY.

In other words, the lexer deals with it, not the parser. All your parser grammar has to deal with is the LIBRARY token type, because the lexer has taken care of recognizing the string literal.

HTH,
John
www.joanju.com


Lars von Wedel wrote:
> 
> Hello,
> 
> I am about to write parsers for (lots of) input files to an existing 
> tool. The language I have to deal with (besides other annoyances) 
> permits abbreviated keywords, so you could write something like
> 
> LIBRARY
> 
> as a keyword, but since
> 
> LIB
> 
> is unique to identify that keyword it would be sufficient, as well as 
> anything else such as LIBR, LIBRAR or so. Defining all these variants as 
> tokens and dealing with them in the parser does not appear as a clean 
> solution to me.
> 
> How would I best incorporate this into a lexer/parser developed in Antlr?
> 
> Lars
> 
> 
> 
> 


From easjolly at ix.netcom.com  Tue Nov 29 09:34:25 2005
From: easjolly at ix.netcom.com (Susan Jolly)
Date: Tue Nov 29 09:34:31 2005
Subject: [antlr-interest] Re: Defining keywords with varying length
In-Reply-To: <20051129152847.D9A3ADCE4D@www.antlr.org>
Message-ID: <E1Eh9N5-0003vg-3p@smtpauth10.mail.atl.earthlink.net>

I'd make one modification to what Martin wrote.  Rather than using a TRIE,
I'd start with a simpler structure that is likely less efficient but
probably quicker to implement.

This would depend on the number of different minimal lengths of the unique
abbreviations. If there are only a few minimal lengths, say either 3
characters as for LIBRARY or 4 characters as for XXXY...., the structure
could be a simple hashtable with LIB and LIBR and XXXY (and the other 3 and
4 character starting strings) as the keys.  Then, if the user entry has more
than 4 characters, you would use its first four characters, rather than the
complete entry, to locate the full keyword.

You would then need to compare the complete user entry with relevant portion
of the full keyword to eliminate items like LIBRX. 

Susan



From ga-fries at veenendaalnet.nl  Tue Nov 29 09:52:30 2005
From: ga-fries at veenendaalnet.nl (Jos Fries)
Date: Tue Nov 29 09:52:38 2005
Subject: [antlr-interest] How does one handle variable number of
	functionparameters?
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com><1133234353.8214.0.camel@localhost.localdomain><738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com><dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com><738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
	<dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>
Message-ID: <004301c5f50d$ab637890$0a01a8c0@altb>

Bryan,

Brilliant! :-) Thank you for the example. I immediately applied it in my 
treeparser and it made me understand semantic actions a lot better.

Jos

----- Original Message ----- 
From: "Bryan Ewbank" <ewbank@gmail.com>
To: "ANTLR Interest" <antlr-interest@antlr.org>
Sent: Tuesday, November 29, 2005 4:28 PM
Subject: Re: [antlr-interest] How does one handle variable number of 
functionparameters?


 If you need to print out the function call later, that also
gives you a production into which you can place the parens and comma:

    arglist:
        #( ARGLIST
            { cout << "("; }
            (
                expr
                (
                    // commas *between* expressions, not *after* expressions
                    { cout << ", "; }
                    expr
                )*
            )?
            { cout << ")"; }
        )
    ;

From endigitalmind at yahoo.co.uk  Tue Nov 29 10:17:43 2005
From: endigitalmind at yahoo.co.uk (Phil Ritchie)
Date: Tue Nov 29 10:17:50 2005
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?
In-Reply-To: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
Message-ID: <20051129181743.19366.qmail@web25802.mail.ukl.yahoo.com>

You can count me among the satisfied ANTLR/C#'ers.

--- Andy Voelkel <andy@exchange.voelkel.us> wrote:

> Hi all,
> I am quite intrigued by the possibilities of ANTLR,
> and have been
> perusing the site. One thing that strikes me is that
> it seems very
> Java/Linux-centric.
> Our development is all Windows/C#/.NET based, so
> that is a potential
> mismatch.
> Are there a substantial number of ANTLR users who
> use C#/.NET as a host
> platform? Or would that be swimming upstream?
> Thanks!
> - Andy
> P.S. If using ANTLR user Windows/.NET is not a
> realistic/painless
> option, are there other parser/lexer packages that
> anyone could
> recommend?
> 



		
___________________________________________________________ 
WIN ONE OF THREE YAHOO! VESPAS - Enter now! - http://uk.cars.yahoo.com/features/competitions/vespa.html
From robgreene at gmail.com  Tue Nov 29 10:59:55 2005
From: robgreene at gmail.com (Rob Greene)
Date: Tue Nov 29 10:59:58 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
	<738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
	<dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>
Message-ID: <738584f80511291059i39ffc6f5n63659f5c3703a04d@mail.gmail.com>

I'm sorry, but I'm still totally lost. I've chopped out everything
except numbers and the function calls trying to simplify, but no
luck... Here's the code that doesn't work, I'm hoping somebody can
straighten me out. Anything with more than two "#" characters is
simply copy & pasted.  :-)
-Rob

class FunctionParser extends Parser;

options {
	buildAST = true;
	k = 1;
	exportVocab  = Function;		// name of the vocabulary
}

imaginaryTokenDefinitions
	: ARGLIST
	;

expression
	: NUMBER
	| IDENTIFIER LPAREN^ argList RPAREN!
	| LPAREN! expression RPAREN!
	;
argList
	: expression (COMMA! expression)* { ## = #( #[ARGLIST,"ARGLIST"], ## ); }
	;


class FunctionLexer extends Lexer;

options {
	caseSensitive=false;
	k = 2;
	exportVocab = Function;		// name of the vocabulary
}

IDENTIFIER
	options { testLiterals = true; }
	: 'a'..'z' ( 'a'..'z' | '0'..'9' )*
	;

NUMBER
	: ('0'..'9')+ ( '.' ('0'..'9')+ )?
	;

// Whitespace -- ignored
WS	: ( ' '
	|	'\t'
	|	'\f'
	| ( "\r\n"  // Evil DOS
	  | '\r'    // Macintosh
	  | '\n'    // Unix (the right way)
	  )
	)
	{ $setType(Token.SKIP); }
	;

LPAREN
	: "("
	;
RPAREN
	: ")"
	;
COMMA
	: ","
	;


class FunctionTreeParser extends TreeParser;

expression returns [double value]
{
	double a,b;
	value = 0;
}
	:	n:NUMBER { value = Double.parseDouble(n.getText());
				   System.out.println("number = " + value); }
	|	i:IDENTIFIER
//			( arg=expression { System.out.println("Adding argument " + arg); })*
			{ System.out.println("Executing function " + i.getText()); }
	;
argList
	:	#( ARGLIST
			(
				d:expression { System.out.println("expression = " + d); }
				(
					e:expression { System.out.println("expression = " + e); }
				)*
			)?
		)
	;
From parrt at cs.usfca.edu  Tue Nov 29 15:09:06 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 29 15:08:40 2005
Subject: [antlr-interest] forced or "gate" semantic predicates
Message-ID: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>

So, I'm playing around with real grammars (python and ruby) to find  
nasty parsing problems (boy did I find them).  In python, there are  
only lexical problems really.  newline is context-sensitive and  
somethings you want to ignore them and sometimes you don't.  Smells  
like we need a predicate, but problems arise.  For example, here is  
the comment rule:

COMMENT
@init {
     int startPos = getCharPositionInLine();
}
     :   "#" (~"\n")* { channel=99; }
         ( {startPos==0}? "\n" )+
     ;

You want it to scarf all trailing comments as they are not statement  
terminators; we don't want COMMENT to fall out, which would let  
NEWLINE have them (annoying the parser).

The loop:

( {startPos==0}? "\n" )+

*looks* like it would not match the subrule according to the  
predicate, but....it is not even part of the prediction!  Remember  
predicates exist to disambiguate syntactic problems.  In this case,  
the lexers thinks that as long as newlines are present, it will scarf  
them.  No semantics required.

This is the problem that Oliver ran into for XML.  He needs a  
predicate that "gates" in/out a production or loop.  I know how to  
insert that (analysis would ignore; code gen would simply insert  
always), but what the hell would the syntax be to distinguish?

The parser seems to work naturally with disambiguating predicates but  
the lexer seems to want gating predicates.  Interesting.  Loring  
Craymer had an interesting suggestion at the workshop: use syn pred  
notation around it.  ({...}?)=>

Perhaps a variation:

( {startPos==0}=> "\n" )+

where the action implies when it's ok to proceed.

These would NOT hoist as you'd be evaluating them out of context  
(which is why the {..}? variety are always evaluated *after* the  
lookahead test).  These gate predicates would simply get shoved into  
the lookahead decision for that specific production.

The problem is that sometimes you want to distinguish between two  
lexical rules like Oliver did:

TAG_OPEN : { !tagMode } => '<' { tagMode = true; } ;
TAG_CLOSE : { tagMode } => '>' { tagMode = false; } ;

Perhaps the special case of gate predicates on the left edge of  
lexical rules get hoisted one level into the special Tokens rule that  
chooses among lexer rules.

Heh, i like it!  Adding to blog.  Comments?

Ter
From dskolovos at gmail.com  Tue Nov 29 16:10:02 2005
From: dskolovos at gmail.com (Dimitrios Kolovos)
Date: Tue Nov 29 16:10:09 2005
Subject: [antlr-interest] Simple ASP-like grammar
In-Reply-To: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>
References: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>
Message-ID: <438CEDDA.50004@gmail.com>

Hi,

I am trying to crate a grammar for a simple language that contains two 
kinds of things: Text inside [% %] and text outside it (something like a 
simple version of ASP or JSP but inside or outside the brackets any type 
of text can exist). An example file that I would like to parse would be:

Text1 [%Text2%] Text3
[%Text4%]

The tree I would expect to have is:
-Program
---Text1 (anyText)
---Text2 (tagged)
---Text3 (anyText)
---Text4 (tagged)

The grammar I have developed is compiled without errors or warnings. 
However the parser returns the whole text as a single child of the root 
AST node. I have tried to find similar grammars on the web but no luck. 
My grammar follows:

header {
package org.xtgl.parse;
import java.util.*;
}

class XtglParser extends Parser;

options {
    k = 2;
    exportVocab = XtglParser;
    buildAST = true;
}

tokens {
    TAGGED;
    ANYTEXT;
    PROGRAM;
}

program
    : (tagged|anyText)*
    {#program = #(#[PROGRAM,"Program"], program);}
    ;

anyText
    : AnyTextBlock^
    {#anyText.setType(ANYTEXT);}
    ;

tagged
    : "[%" AnyTextBlock^ "%]"
    {#tagged.setType(TAGGED);}
    ;

class XtglLexer extends Lexer;

options {
    k = 2;
    exportVocab = XtglParser;
    charVocabulary = '\0' .. '\u00FF';
}

AnyTextBlock
    :
    ('\0' .. '\u00FF')+
    ;

Any ideas?

Cheers,
Dimitrios

-- 
Dimitrios S. Kolovos,
Research Associate,
Department of Computer Science,
The University of York,
Url: http://www-users.cs.york.ac.uk/~dkolovos
Phone: 01904434333



From kroepke at dolphin-services.de  Tue Nov 29 16:40:23 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Tue Nov 29 16:40:28 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
Message-ID: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>

Hi!

I just wanted to update to the last rev from the depot and notice  
that due to a change in
org.antlr.tool.Grammar (changeset 2080 - rev 98) which renamed  
TOKEN_RULENAME to ARTIFICIAL_TOKENS_RULENAME
the CodeGenTreeWalker barfs - it still wants TOKEN_RULENAME :(

Quick fix is obviously to change codegen.g to use the corrent  
ARTIFICIAL_TOKENS_RULENAME.

Ter, have you just forgot to commit the changes in codegen.g? I  
suppose so...:)

Have a good one,

Kay
From parrt at cs.usfca.edu  Tue Nov 29 16:50:44 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 29 16:50:17 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
In-Reply-To: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
References: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
Message-ID: <973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>


On Nov 29, 2005, at 4:40 PM, Kay Roepke wrote:

> Hi!
>
> I just wanted to update to the last rev from the depot and notice  
> that due to a change in
> org.antlr.tool.Grammar (changeset 2080 - rev 98) which renamed  
> TOKEN_RULENAME to ARTIFICIAL_TOKENS_RULENAME
> the CodeGenTreeWalker barfs - it still wants TOKEN_RULENAME :(
>
> Quick fix is obviously to change codegen.g to use the corrent  
> ARTIFICIAL_TOKENS_RULENAME.
>
> Ter, have you just forgot to commit the changes in codegen.g? I  
> suppose so...:)

Yup.  Jim noticed that too. I pushed again afterwards I think.  I'm  
pushing now to be sure.

Ter
From kroepke at dolphin-services.de  Tue Nov 29 17:46:45 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Tue Nov 29 17:46:51 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
In-Reply-To: <973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>
References: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
	<973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>
Message-ID: <DC86A983-7A32-4949-9A5F-882575C93C83@dolphin-services.de>


On 30. Nov 2005, at 1:50 Uhr, Terence Parr wrote:

> Yup.  Jim noticed that too. I pushed again afterwards I think.  I'm  
> pushing now to be sure.

Mhmh strange. Doesn't seem to be in my workspace...I still have the  
old version of codegen.g?!?

- k
From open.zone at virgin.net  Tue Nov 29 18:03:32 2005
From: open.zone at virgin.net (Micheal J)
Date: Tue Nov 29 17:47:59 2005
Subject: [antlr-interest] Simple ASP-like grammar
In-Reply-To: <438CEDDA.50004@gmail.com>
Message-ID: <001301c5f552$45aa4fc0$6b02a8c0@hercules>

> The grammar I have developed is compiled without errors or warnings. 
> However the parser returns the whole text as a single child 
> of the root 
> AST node. I have tried to find similar grammars on the web 
> but no luck. 

http://storm.cs.unipi.gr/~anakreon/aspa.html

Cheers,

Micheal

From ewbank at gmail.com  Tue Nov 29 17:51:03 2005
From: ewbank at gmail.com (Bryan Ewbank)
Date: Tue Nov 29 17:51:07 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <738584f80511291059i39ffc6f5n63659f5c3703a04d@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
	<738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
	<dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>
	<738584f80511291059i39ffc6f5n63659f5c3703a04d@mail.gmail.com>
Message-ID: <dd3a065f0511291751t779ea152nfafca2e8892445f7@mail.gmail.com>

Hi Rob,

Don't give up.  You're very close to groking ANTLR.  I think you tried
to merge what several people suggested, but there were not really
meant to work together.  They were more ideas bouncing around.

If you are lost, then we failed in our attempt to assimilate you into
the uber-ANTLR collective, and we must try again :-)

The lexer appears okay (even to the "evil DOS" comment!).  I don't use
ANTLR for lexing (I roll my own), so I just gave it a cursory
glance...

The parser and the tree parser both look "correct", but they don't
play well together.

The parser you have written produces trees (from the "expression"
production) that look like this:
    // Read "#( e1 e2 ... eN )" as "the tree with root e1, and children e2..eN".
    #( LPAREN IDENTIFIER #( ARGLIST expr expr ... ) )
    NUMBER

The tree parser (looking just at "expression") will only accept trees
that look like this:
    NUMBER
    IDENTIFIER
    // there's also the argList production which matches trees like this:
    //      #( ARGLIST expr expr expr ... )

The crux of the problem is that the tree parser is not eating the
function-call tree that is produced by the parser - it's only looking
for NUMBER or IDENTIFIER, but the parser will never produce
IDENTIFIER.

To get the tree parser to match the parser, it should look something like this:

expression
returns [double value = 0]
:
    ( n:NUMBER
        { ... as your example ... }
    | #( LPAREN i:IDENTIFIER a:argList )
        { ... #a contains the argument list; #i is the function to call... }
    )
;

argList
{ double v; }
:
    #( ARGLIST
        (
            v=arg:expression
            {
                System.out.println("expression = " + v);
                ... need to do something with the value, v ...
            }
        )*
    )
;
From parrt at cs.usfca.edu  Tue Nov 29 17:56:53 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 29 17:56:23 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
In-Reply-To: <DC86A983-7A32-4949-9A5F-882575C93C83@dolphin-services.de>
References: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
	<973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>
	<DC86A983-7A32-4949-9A5F-882575C93C83@dolphin-services.de>
Message-ID: <5428E3CC-5786-4614-96FD-5FA380386647@cs.usfca.edu>


On Nov 29, 2005, at 5:46 PM, Kay Roepke wrote:

>
> On 30. Nov 2005, at 1:50 Uhr, Terence Parr wrote:
>
>> Yup.  Jim noticed that too. I pushed again afterwards I think.   
>> I'm pushing now to be sure.
>
> Mhmh strange. Doesn't seem to be in my workspace...I still have the  
> old version of codegen.g?!?

Did you rebuild the generated code from codegen.g?  Do a p4 sync -f  
codegen.g from the codegen dir too maybe.

Ter
From kroepke at dolphin-services.de  Tue Nov 29 18:12:42 2005
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Tue Nov 29 18:12:49 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
In-Reply-To: <5428E3CC-5786-4614-96FD-5FA380386647@cs.usfca.edu>
References: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
	<973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>
	<DC86A983-7A32-4949-9A5F-882575C93C83@dolphin-services.de>
	<5428E3CC-5786-4614-96FD-5FA380386647@cs.usfca.edu>
Message-ID: <094E04D3-FCD8-4CF6-AB59-5F4138E1DD41@dolphin-services.de>


On 30. Nov 2005, at 2:56 Uhr, Terence Parr wrote:

> Did you rebuild the generated code from codegen.g?  Do a p4 sync -f  
> codegen.g from the codegen dir too maybe.

Yeah, I did that, since I moved to my laptop a few minutes ago.

p4 fstat codegen.g tells me this (even after a forced sync)

... depotFile //depot/code/antlr/main/src/org/antlr/codegen/codegen.g
... clientFile /Users/kroepke/Projects/antlr3-workspace/src/org/antlr/ 
codegen/codegen.g
... headAction edit
... headType text
... headTime 1133044771
... headRev 58
... headChange 2073
... haveRev 58

Rebuilding the code doesn't because in lines 312 and 333 it still says:
                         if ( r.equals(Grammar.TOKEN_RULENAME) ) {
which the compiler doesn't like....

Bewildered,

Kay

From parrt at cs.usfca.edu  Tue Nov 29 18:37:41 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Nov 29 18:37:11 2005
Subject: [antlr-interest] [v3] glitch in codegen.g
In-Reply-To: <094E04D3-FCD8-4CF6-AB59-5F4138E1DD41@dolphin-services.de>
References: <0B221397-518F-4712-960F-4BD0110928C3@dolphin-services.de>
	<973C8E28-C427-4131-9A51-16D03DCF2C03@cs.usfca.edu>
	<DC86A983-7A32-4949-9A5F-882575C93C83@dolphin-services.de>
	<5428E3CC-5786-4614-96FD-5FA380386647@cs.usfca.edu>
	<094E04D3-FCD8-4CF6-AB59-5F4138E1DD41@dolphin-services.de>
Message-ID: <E14A9496-3D41-4F41-B809-AA1B4AB035C0@cs.usfca.edu>


On Nov 29, 2005, at 6:12 PM, Kay Roepke wrote:

>
> On 30. Nov 2005, at 2:56 Uhr, Terence Parr wrote:
>
>> Did you rebuild the generated code from codegen.g?  Do a p4 sync - 
>> f codegen.g from the codegen dir too maybe.
>
> Yeah, I did that, since I moved to my laptop a few minutes ago.

ok, i'm a moron...somehow didn't get the fix in.  Try now :)

Ter
From robgreene at gmail.com  Tue Nov 29 18:58:41 2005
From: robgreene at gmail.com (Rob Greene)
Date: Tue Nov 29 18:58:44 2005
Subject: [antlr-interest] How does one handle variable number of function
	parameters?
In-Reply-To: <dd3a065f0511291751t779ea152nfafca2e8892445f7@mail.gmail.com>
References: <738584f80511281900xa1b522aj1e5db075c99fd8dc@mail.gmail.com>
	<1133234353.8214.0.camel@localhost.localdomain>
	<738584f80511282005j4da7e46dm45e38e4c7fce927a@mail.gmail.com>
	<dd3a065f0511282131j19f9d29aq5538dc9a3a97b093@mail.gmail.com>
	<738584f80511290543m1f2eef29t8a4a43707210bff8@mail.gmail.com>
	<dd3a065f0511290728t59737b36pdd59c4757a06e2c7@mail.gmail.com>
	<738584f80511291059i39ffc6f5n63659f5c3703a04d@mail.gmail.com>
	<dd3a065f0511291751t779ea152nfafca2e8892445f7@mail.gmail.com>
Message-ID: <738584f80511291858k29b11c20hae1d9fdff917e735@mail.gmail.com>

> Don't give up.  You're very close to groking ANTLR.  I think you tried
> to merge what several people suggested, but there were not really
> meant to work together.  They were more ideas bouncing around.

Not a problem - I'm finding the syntax confusing, which is ironic
since I'm working on writing an expression parser and a compiler,
isn't it? If you've been following my questions, I've got a project at
home to do a BASIC compiler, and we think having a good expression
parser at work will really allow us to enhance our product (my
"lunchtime" projects sometimes get carried away). I've then created a
simpler version of the expression parser at home to work out issues
(evaluates to doubles; the one at work is capable of handling Doubles,
Dates, Booleans, and Strings), plus the little sideline ones for WTF
resolution.  I'm confused myself - I have at least 4 grammars going
right now.  :-|

> If you are lost, then we failed in our attempt to assimilate you into
> the uber-ANTLR collective, and we must try again :-)

I think part of it is that my single compiler course was between 1988
and 1990, so that's 15 years ago. I've forgotton a lot, plus I've
never used lex or yacc (or bison or flex or ...) so the terminology
and capabilities are a mystery. I've got the Dragon Book, but that's
all I have for resources and I've only spot-checked stuff since my
compiler class.

> The lexer appears okay (even to the "evil DOS" comment!).

That was stolen from an example I read, so I can take no credit.

> The parser and the tree parser both look "correct", but they don't
> play well together.

You may have hit the nail on the head. When I'm working on this, I'm
not thinking of the AST created. From what you're saying, that's
something I better try to pay attention to... and maybe why I've
gotten lost on the argument list - I may need pictures (or verbal
descriptions of them).

> The parser you have written... (snip)

The good news is that with your suggestions, my simple expression
parser WORKS now. I'm not actually performing any functions, but I'm
getting output for the arguments before I see that the function is
being evaluated.

Let me walk the AST for the functions...

(1) In the parser, "IDENTIFIER LPAREN^ argList RPAREN!" instructs
ANTLR to build an AST with LPAREN (literally "(") as the root node.
This becomes my "key" to seeing the function call. IDENTIFIER becomes
the first child and argList is the second child.

(2) Still in the parser, for argList, "expression (COMMA! expression)*
{ ## = #( #[ARGLIST,"ARGLIST"], ## ); }" requires one expression
optionally followed by additional expressions separated by commas. The
comma is not stored in the AST.

I *think*, after re-reading this thread, that "##" stuff creates one
AST tree with "ARGLIST" as the root and each expression being appended
as a child... ?  I think this is instead of having multiple
parent-children structures?

Ok, I cannot figure out what it would look like without the ARGLIST
building stuff. I'd have "(" as the parent, first child would be
IDENTIFIER, and then... additional children with expression? Which
wouldn't be a problem, except I have no way to match the argument list
in the tree parser??

(3) In the tree parser, the expression rule, "#(LPAREN i:IDENTIFIER
args:argList) { System.out.println("i=" + i + ", args=" + args); }" is
sort of a regex expression to match the AST created by (1). "i" and
"args" are just AST trees. "i" is useful because that gives me the
function name, but "args" is worthless - right? It's just an AST
without any of the evaluated values. I need to track those in the
argList rule.

(4) Finally, in the tree parser,

argList
{ double v; }
	:	#( ARGLIST
			(
				v=expression
				{
					System.out.println("expression = " + v);
				}
			)*
  		)
  	;

This mess matches the fake token "ARGLIST" and then forces the
argument expressions to be evaluated. "v", in this case, is a double.
I think I need to create a List somewhere and start collecting the
value which the function call would reference and then clear up.

----

Close?

I hope so... 'cause then I'll have more questions, but I think this is
plenty enough for you kind souls to answer!!! Plus I don't want to go
too far overboard...

Thanks!
-Rob
From robgreene at gmail.com  Tue Nov 29 19:13:57 2005
From: robgreene at gmail.com (Rob Greene)
Date: Tue Nov 29 19:13:59 2005
Subject: [antlr-interest] Simple ASP-like grammar
In-Reply-To: <438CEDDA.50004@gmail.com>
References: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>
	<438CEDDA.50004@gmail.com>
Message-ID: <738584f80511291913r620f67beo871afd8ba2964679@mail.gmail.com>

On 11/29/05, Dimitrios Kolovos <dskolovos@gmail.com> wrote:
> The grammar I have developed is compiled without errors or warnings.
> However the parser returns the whole text as a single child of the root
> AST node. I have tried to find similar grammars on the web but no luck.

I'm going to punt. Being the newbie, take this with a grain of salt...
I've read that ANTLR's lexer is greedy. I'd guess that once it enters
either of the antText or tagged rule, there's nothing to make it exit.
I'm not sure if the answer is to define the "[%" and "%]" in the lexer
or to exclude them from the AnyTextBlock.

Hope that leads to something...
-Rob
From demakov at ispras.ru  Tue Nov 29 23:25:35 2005
From: demakov at ispras.ru (Alexey Demakov)
Date: Tue Nov 29 23:25:38 2005
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?
References: <7AE2E53336B37440A20C9590DB11BCB9713FBB@EXVS01.ex.dslextreme.net>
Message-ID: <007301c5f57f$417f2330$8cc79553@marlboro>

We've implemented extention of C# language using ANTLR/C# for parser generation.
No problem with ANTLR 2.7.5.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: "Andy Voelkel" <andy@exchange.voelkel.us>
To: "ANTLR Interest" <antlr-interest@antlr.org>
Sent: Tuesday, November 29, 2005 6:27 PM
Subject: [antlr-interest] Size of the ANTLR-C#-.NET "community"?


> Hi all,
> I am quite intrigued by the possibilities of ANTLR, and have been
> perusing the site. One thing that strikes me is that it seems very
> Java/Linux-centric.
> Our development is all Windows/C#/.NET based, so that is a potential
> mismatch.
> Are there a substantial number of ANTLR users who use C#/.NET as a host
> platform? Or would that be swimming upstream?
> Thanks!
> - Andy
> P.S. If using ANTLR user Windows/.NET is not a realistic/painless
> option, are there other parser/lexer packages that anyone could
> recommend?
> 
>

From dskolovos at gmail.com  Wed Nov 30 01:21:38 2005
From: dskolovos at gmail.com (Dimitrios Kolovos)
Date: Wed Nov 30 01:21:46 2005
Subject: [antlr-interest] Simple ASP-like grammar
In-Reply-To: <738584f80511291913r620f67beo871afd8ba2964679@mail.gmail.com>
References: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>	<438CEDDA.50004@gmail.com>
	<738584f80511291913r620f67beo871afd8ba2964679@mail.gmail.com>
Message-ID: <438D6F22.7060100@gmail.com>

I have found a working solution in case someone faces the same issue 
sometime later. Thanks for your replies!

AnyTextBlock
    :
    (
    '\0' .. '\u00FF'
    {
        if (LA(1) == '%' && LA(2) == ']'){
            break;
        }
        else if (LA(1) == '[' && LA(2) == '%'){
            break;
        }
    }
    )+
    ;

Cheers,
Dimitrios

Rob Greene wrote:

>On 11/29/05, Dimitrios Kolovos <dskolovos@gmail.com> wrote:
>  
>
>>The grammar I have developed is compiled without errors or warnings.
>>However the parser returns the whole text as a single child of the root
>>AST node. I have tried to find similar grammars on the web but no luck.
>>    
>>
>
>I'm going to punt. Being the newbie, take this with a grain of salt...
>I've read that ANTLR's lexer is greedy. I'd guess that once it enters
>either of the antText or tagged rule, there's nothing to make it exit.
>I'm not sure if the answer is to define the "[%" and "%]" in the lexer
>or to exclude them from the AnyTextBlock.
>
>Hope that leads to something...
>-Rob
>
>  
>
From parrt at cs.usfca.edu  Wed Nov 30 09:36:36 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 30 09:36:04 2005
Subject: [antlr-interest] Simple ASP-like grammar
In-Reply-To: <438D6F22.7060100@gmail.com>
References: <79A37E18-D2D1-482A-9B25-7D820BB7062E@cs.usfca.edu>	<438CEDDA.50004@gmail.com>
	<738584f80511291913r620f67beo871afd8ba2964679@mail.gmail.com>
	<438D6F22.7060100@gmail.com>
Message-ID: <E5B77DFB-D3B0-4178-B134-B336FC3DD0DC@cs.usfca.edu>


On Nov 30, 2005, at 1:21 AM, Dimitrios Kolovos wrote:

> I have found a working solution in case someone faces the same  
> issue sometime later. Thanks for your replies!
>
> AnyTextBlock
>    :
>    (
>    '\0' .. '\u00FF'
>    {
>        if (LA(1) == '%' && LA(2) == ']'){
>            break;
>        }
>        else if (LA(1) == '[' && LA(2) == '%'){
>            break;
>        }
>    }
>    )+
>    ;


A quick note: you could put those conditions in a predicate:

( {...}? . )*

or some such.

Ter
From duboimat at iro.umontreal.ca  Wed Nov 30 09:56:11 2005
From: duboimat at iro.umontreal.ca (duboimat@iro.umontreal.ca)
Date: Wed Nov 30 09:56:15 2005
Subject: [antlr-interest] C# and antlr 2.7.5
Message-ID: <20051130125611.uyud8vz7k0004kwk@webmail.iro.umontreal.ca>

Hi,

I'm trying to parse C# with grammar that i have taken on the antlr website from

Error The type or namespace name 'Nodes' does not exist in the namespace
'CodeCritic' (are you missing an assembly reference?)

Should i use another file or just csharp.g is required.

thanks,
mat



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
From parrt at cs.usfca.edu  Wed Nov 30 10:13:31 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 30 10:12:58 2005
Subject: [antlr-interest] calling Jim Idle
Message-ID: <C7DB0D1D-5DC6-48DF-8F18-E33381EE13A8@cs.usfca.edu>

Jim, is your MX record or something messed up?  I get bounces but you  
seem to get mail to the list...anyhoo, I'm responding to your direct  
emails about the C code generator...

[sorry for the broadcast]

Ter
From open.zone at virgin.net  Wed Nov 30 11:23:33 2005
From: open.zone at virgin.net (Micheal J)
Date: Wed Nov 30 11:07:55 2005
Subject: [antlr-interest] C# and antlr 2.7.5
In-Reply-To: <20051130125611.uyud8vz7k0004kwk@webmail.iro.umontreal.ca>
Message-ID: <001e01c5f5e3$8fe6b510$6b02a8c0@hercules>


> I'm trying to parse C# with grammar that i have taken on the 
> antlr website from
> 
> Error The type or namespace name 'Nodes' does not exist in 
> the namespace 'CodeCritic' (are you missing an assembly reference?)

Todd's grammar is part of his CodeCritic project and might not have been
sanitized to work as-is in any other project.

> Should i use another file or just csharp.g is required.

You may have to edit his grammar file to remove references to Classes/Types
that you don't have.

Micheal

From parrt at cs.usfca.edu  Wed Nov 30 11:20:34 2005
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Nov 30 11:20:03 2005
Subject: [antlr-interest] calling Jim Idle
In-Reply-To: <B36CCC332A32904F8FA3DE134A23533615BF2F@wavemachine.temporal-wave.com>
References: <B36CCC332A32904F8FA3DE134A23533615BF2F@wavemachine.temporal-wave.com>
Message-ID: <E91448D1-A687-497B-B43E-FC3B0EA517D9@cs.usfca.edu>


On Nov 30, 2005, at 11:17 AM, Jim Idle wrote:

> Weird. We have a business Comcast account with our own mail server. It
> occasionally changes IP address because Comcast want one million  
> dollars
> for a fixed IP. It sometimes means people reject our outgoing mail  
> too.
>
> I will double check it but it changed about a week ago and I  
> updated the
> DNS (which advertises the record with a 500 second lifetime or  
> something
> silly, so it should not be cached. What do you get for ping
> mail.temporal-wave.com ?

You probably won't get this email, but it says:

$ ping mail.temporal-wave.com
PING mail.temporal-wave.com (71.193.192.7): 56 data bytes

then nothing...not even "* * *"

[again, sorry for the broadcast!]

Ter
PS	I sent you like 3 direct emails yesterday in response to your mail.
From rmann at latencyzero.com  Wed Nov 30 15:25:21 2005
From: rmann at latencyzero.com (Rick Mann)
Date: Wed Nov 30 15:25:25 2005
Subject: [antlr-interest] Help with grammar keywords
Message-ID: <35828BD5-B0C8-4619-BA2B-F8803CF8A3E0@latencyzero.com>

Hi. I was working on a grammar to parse hierarchical URIs into a URI  
with parameters. We have URIs like the following:

http://www.keepmedia.com/pubs/Esquire/
http://www.keepmedia.com/pubs/Esquire/2005
http://www.keepmedia.com/pubs/Esquire/current
http://www.keepmedia.com/pubs/Esquire/columns/Sex/
http://www.keepmedia.com/pubs/Esquire/2005/11/01/1037813
http://www.keepmedia.com/columns/Sex/


These get resolved into URIs used internally like:

/content/Content.do?pubId=19
/content/Content.do?pubId=19&itemId=1037813
/content/Content.do?pubId=19&pgv=current

For the most part, I've got a grammar that works, but one difficulty  
I'm having has to do with an optional keyword that may hang off the  
end ("current" is an example above). There are a handful of such  
special words, and they're always found at the very end of a URI.

In any case, it's not working. I've included the grammar below.  
However, it's been a few weeks since I did this, and I'm not sure  
where I left it off. Some test code I have complains bitterly. Here's  
sample output:

This works:
--------------------
Parsing: /topics/World/Europe/Western/popular
Topics path
Subtopic: World
Subtopic: Europe
Subtopic: Western
Variant: popular



This doesn't:
--------------------
Parsing: /pubs
exception: line 1:2: unexpected char: 'p'

Parsing: /pubs/
exception: line 1:2: unexpected char: 'p'

Parsing: /pubs/popular
exception: line 1:2: unexpected char: 'p'



Any suggestions would be most welcome. Sorry for the lack of more  
specific info. Thanks!


Grammar
--------------------------------


/*
URL Variants

http://localhost/pubs/
http://localhost/pubs/<pubID>
http://localhost/pubs/<pubName>
http://localhost/pubs/

http://localhost/pubs/OpinionJournal.com/suggested/
http://localhost/pubs/OpinionJournal.com/2005/03/28/727710

http://localhost/topics/

*/



class URIParser extends Parser;

options
{
	k=2;
}

path
	:
	PATHSEP!
	(	articlesPath
	|	picksPath
	|	pubsPath
	|	rfsPath
	|	topicsPath
	)
	(variant)?
	(PATHSEP!)?
	(EOL!)?
	;

protected
articlesPath
	:	"articles"			{ System.out.println("Articles path"); }
		PATHSEP!
		id:ID				{ System.out.println("Article ID: " + id.getText()); }
	;
	
protected
picksPath
	:	"picks"				{ System.out.println("Picks path"); }
		PATHSEP!
		id:ID				{ System.out.println("Picks ID: " + id.getText()); }
	;
	
protected
pubsPath
	:	PUBS!				{ System.out.println("Pubs path"); }
	(	PATHSEP!
		id:ID				{ System.out.println("Pubs ID: " + id.getText()); }
	)
	(	PATHSEP!
		articlesPath
	)?
	;
	
protected
rfsPath
	:
	(	"columns"			{ System.out.println("Columns path"); }
	|	"sections"			{ System.out.println("Sections path"); }
	|	"rfs"				{ System.out.println("rfs path"); }
	)
		PATHSEP!
		id:ID				{ System.out.println("rf ID: " + id.getText()); }
	;
	
protected
topicsPath
	:	"topics"			{ System.out.println("Topics path"); }
	(	(	PATHSEP!
			id:ID				{ System.out.println("Top topic ID: " + id.getText()); }
		)
		|
		(	PATHSEP!
			stn:STRING_LITERAL	{ System.out.println("Subtopic: " + stn.getText 
()); }
		)*
	)
	;
	
protected
variant
	:	PATHSEP!
		s:VARIANT	{ System.out.println("Variant: " + s.getText()); }
	;
	
class URILexer extends Lexer;

options
{
	k=2;
	testLiterals=true;
	filter=false;
}

	/*
tokens
{
	ARTICLES="articles";
	COLUMNS="columns";
	CURRENT="current";
	ITEMS="items";
	PICKS="picks";
	POPULAR="popular";
	PREMIUM="premium";
	PUBS="pubs";
	RFS="rfs";
	SECTIONS="sections";
	SUGGESTED="suggested";
	TOPICS="topics";
}
	*/

VARIANT
	:	COLUMNS
	|	CURRENT
	|	PICKS
	|	POPULAR
	|	PREMIUM
	|	RELATED
	|	SUGGESTED
	;


protected	COLUMNS				:	"columns";
protected	CURRENT				:	"current";
protected	PICKS				:	"picks";
protected	POPULAR				:	"popular";
protected	PREMIUM				:	"premium";
protected	RELATED				:	"related";
protected	SUGGESTED			:	"suggested";

protected	PUBS				:	"pubs";

PATHSEP
	:	(SLASH)
	;
	
ID
	:	('0'..'9')+
	;
	
STRING_LITERAL
	:	('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'.')+
	;

protected
SLASH				:	'/';
EOL					:	('\r'|'\n');


From harsha.nagesh at csfb.com  Wed Nov 30 17:07:32 2005
From: harsha.nagesh at csfb.com (Nagesh, Harsha)
Date: Wed Nov 30 17:07:49 2005
Subject: [antlr-interest] question on simple grammar for tick format to
 decimal conversion
Message-ID: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD645@enyc12p32001.corpny.csfb.com>


Hi,

    I am trying to implement a very simple parser for converting strings to
decimal numbers. The strings are bond prices given in tick format such as
"101-12(5+)" or "103-1+", etc. I am sure antlr is an overkill, but I am doing 
it for fun and I am kind of stuck with this error that I need some help. 

my parser rules looks like this (this is just trying to match a number like
"102-3" or "1345-1")

parse returns [decimal result]
{result = -1.0;}
   :  Number (MINUS DigitsA)? EOF

Number: (DigitsA | DigitsB | DigitsC)+
   ;

My lexer has the following literals
 
MINUS: "-";

DigitsA: '0'..'3';
DigitsB: '4'..'8';
DigitsA: '9';

I need to group the digits into these tree groups as the number after the MINUS
can only be from 0 to 32. and further in some places I need to restrict the 
number from 0 to 8.

But antlr is complaining that "Lexical rule Number defined outside of lexer.
Exiting due to errors"

Can somebody explain what is wrong here ?

Thanks,
Harsha

ps: I am quite familiar with antlr and I have done some serious syntax directed
translation using it recently, but I am stuck with this problem.

==============================================================================
Please access the attached hyperlink for an important electronic communications disclaimer: 

http://www.csfb.com/legal_terms/disclaimer_external_email.shtml

==============================================================================

From open.zone at virgin.net  Wed Nov 30 17:29:08 2005
From: open.zone at virgin.net (Micheal J)
Date: Wed Nov 30 17:13:30 2005
Subject: [antlr-interest] question on simple grammar for tick format to
	decimal conversion
In-Reply-To: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD645@enyc12p32001.corpny.csfb.com>
Message-ID: <003101c5f616$a14da1a0$6b02a8c0@hercules>

> parse returns [decimal result]
> {result = -1.0;}
>    :  Number (MINUS DigitsA)? EOF
> 
> Number: (DigitsA | DigitsB | DigitsC)+
>    ;
> 
> My lexer has the following literals

<SNIP>

> But antlr is complaining that "Lexical rule Number defined 
> outside of lexer. Exiting due to errors"
> 
> Can somebody explain what is wrong here ?

ANTLR parser rules cannot begin with an upper-case char. Trying changing
"Number" to "number".

Micheal

From harsha.nagesh at csfb.com  Wed Nov 30 18:14:11 2005
From: harsha.nagesh at csfb.com (Nagesh, Harsha)
Date: Wed Nov 30 18:14:43 2005
Subject: [antlr-interest] question on simple grammar for tick format
	t o decimal conversion
Message-ID: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD646@enyc12p32001.corpny.csfb.com>


Thanks Micheal ! that fixed my problem.

Another question. In antlr is it possible to turn off a particular literal while
parsing the token stream ? For example - if I have a string "43242-3465678",
and I define "NUM" as (DIGIT)+, till I hit the "-" sign I would like to get
the first part, i.e "43242" as NUM (single token), but after I hit "-", I want
to the parser to start treating the right side of the string as single DIGITs
and not a complete number i.e I don't want to get token of type NUM anymore.
Is it possible to do this ?

Thanks,
Harsha

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org]On Behalf Of Micheal J
Sent: Wednesday, November 30, 2005 8:29 PM
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] question on simple grammar for tick format
to decimal conversion


> parse returns [decimal result]
> {result = -1.0;}
>    :  Number (MINUS DigitsA)? EOF
> 
> Number: (DigitsA | DigitsB | DigitsC)+
>    ;
> 
> My lexer has the following literals

<SNIP>

> But antlr is complaining that "Lexical rule Number defined 
> outside of lexer. Exiting due to errors"
> 
> Can somebody explain what is wrong here ?

ANTLR parser rules cannot begin with an upper-case char. Trying changing
"Number" to "number".

Micheal


==============================================================================
Please access the attached hyperlink for an important electronic communications disclaimer: 

http://www.csfb.com/legal_terms/disclaimer_external_email.shtml

==============================================================================

From open.zone at virgin.net  Wed Nov 30 18:47:59 2005
From: open.zone at virgin.net (Micheal J)
Date: Wed Nov 30 18:32:23 2005
Subject: [antlr-interest] question on simple grammar for tick formatt o
	decimal conversion
In-Reply-To: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD646@enyc12p32001.corpny.csfb.com>
Message-ID: <003201c5f621$a734b490$6b02a8c0@hercules>

> Thanks Micheal ! that fixed my problem.

You're wecome.

> Another question. In antlr is it possible to turn off a 
> particular literal while parsing the token stream ? For 
> example - if I have a string "43242-3465678", and I define 
> "NUM" as (DIGIT)+, till I hit the "-" sign I would like to 
> get the first part, i.e "43242" as NUM (single token), but 
> after I hit "-", I want to the parser to start treating the 
> right side of the string as single DIGITs and not a complete 
> number i.e I don't want to get token of type NUM anymore. Is 
> it possible to do this ?

Yes. But since ANTLR doesn't (can't?) provide support for that behaviour
directly, it is neither easy nor pretty.

Easiest option: Deal with this in the parser. The lexer returns NUM MINUS
NUM as usual and in you parser rule you can do whatever you need to do on a
digit-by-digit basis by getting the text of the token and processing it
char-by-char:

------ in parser.g ------
numMinusNumRule
   :  NUM 
	(MINUS d:NUM
	{
		String digits = #d.getText();
		// do your digit-by-digit processing here
	}
	)? EOF
-------------------------

Fancy option: Use a smart, filtering TokenStream. It implements TokenStream
so your parser can use it as input. It reads from another TokenStream (your
lexer). When it detects the NUM MINUS NUM sequence, it breaks the last NUM
into a series of DIGIT tokens (one for each char in the NUM). Your parser
can now be written to expect 

	NUM (MINUS (DIGIT)+ )?

Cheers,

Micheal

From prashant.deva at gmail.com  Wed Nov 30 19:47:52 2005
From: prashant.deva at gmail.com (Prashant Deva)
Date: Wed Nov 30 19:47:54 2005
Subject: [antlr-interest] New videos of ANTLR Studio!
Message-ID: <41fed8f80511301947u4b972124oa319caab398a3cb3@mail.gmail.com>

I have updated the videos of ANTLR Studio.
They are from the antlr 2005 workshop and contain voice too!
Should be more entertaining and informative than the original text ones :)

http://antlrstudio.com
--
Prashant Deva
Creator, ANTLR Studio,www.antlrstudio.com
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20051201/5025f366/attachment.html
From harsha.nagesh at csfb.com  Wed Nov 30 19:54:05 2005
From: harsha.nagesh at csfb.com (Nagesh, Harsha)
Date: Wed Nov 30 19:54:33 2005
Subject: [antlr-interest] question on simple grammar for tick
	formatt o decimal conversion
Message-ID: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD647@enyc12p32001.corpny.csfb.com>


Micheal - I wanted to exactly avoid the very same problem of writing conditional code
for parsing character by character. I prefer to write the grammar than code :)

Can you please tell me more about the Fancy option - are you saying that I need to
implement a TokenStream which will do this toggling after hitting the MINUS ?

It just occurred to me that this problem is similar to the "island grammars" that
was being discussed recently - here what I am looking for is island lexers, ability
to toggle a lexer in the middle of parsing...

-----------------------------
Fancy option: Use a smart, filtering TokenStream. It implements TokenStream
so your parser can use it as input. It reads from another TokenStream (your
lexer). When it detects the NUM MINUS NUM sequence, it breaks the last NUM
into a series of DIGIT tokens (one for each char in the NUM). Your parser
can now be written to expect 

	NUM (MINUS (DIGIT)+ )?

Cheers,

Micheal


==============================================================================
Please access the attached hyperlink for an important electronic communications disclaimer: 

http://www.csfb.com/legal_terms/disclaimer_external_email.shtml

==============================================================================

From open.zone at virgin.net  Wed Nov 30 20:56:26 2005
From: open.zone at virgin.net (Micheal J)
Date: Wed Nov 30 20:40:51 2005
Subject: [antlr-interest] question on simple grammar for tick format to
	decimal conversion
In-Reply-To: <FDFBED0CBC3CA04BB7F633CC85ADDA5B15AAD647@enyc12p32001.corpny.csfb.com>
Message-ID: <003501c5f633$966e1950$6b02a8c0@hercules>

> Can you please tell me more about the Fancy option - are you 
> saying that I need to implement a TokenStream which will do 
> this toggling after hitting the MINUS ?

Yes. After seeing a NUM MINUS sequence you may set a flag then if the next
token is NUM break up into digits. 

And then use it in your code. 
- You create your lexer. 
- Create the filter TokenStream to reads from your lexer. 
- Create the parser to read from your filter.
- Use parser.


Cheers,

Micheal

