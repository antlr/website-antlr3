<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Infinite lexer exception allocation loop in	Ctarget C parser, antlr3.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Infinite%20lexer%20exception%20allocation%20loop%20in%0A%09Ctarget%20C%20parser%2C%20antlr3.0&In-Reply-To=%3C62BABE024B7C074E9194E9727A418979C4F034%40dvs-sms-mail01.digi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022012.html">
   <LINK REL="Next"  HREF="022080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Infinite lexer exception allocation loop in	Ctarget C parser, antlr3.0</H1>
    <B>Hardy, Stephen</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Infinite%20lexer%20exception%20allocation%20loop%20in%0A%09Ctarget%20C%20parser%2C%20antlr3.0&In-Reply-To=%3C62BABE024B7C074E9194E9727A418979C4F034%40dvs-sms-mail01.digi.com%3E"
       TITLE="[antlr-interest] Infinite lexer exception allocation loop in	Ctarget C parser, antlr3.0">Stephen_Hardy at rabbit.com
       </A><BR>
    <I>Tue Jul  3 09:29:04 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022012.html">[antlr-interest] Infinite lexer exception allocation loop in	Ctarget C parser, antlr3.0
</A></li>
        <LI>Next message: <A HREF="022080.html">[antlr-interest] Infinite lexer exception allocation loop	inCtarget C parser, antlr3.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22047">[ date ]</a>
              <a href="thread.html#22047">[ thread ]</a>
              <a href="subject.html#22047">[ subject ]</a>
              <a href="author.html#22047">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jim,

thanks for that.  Yeah, I already added the \x support, but it sowed the
seeds of doubt that some other user syntax or lexical error may cause
the same problem.  I use Fedore core 3, and it seemed to recover by
killing the task once it asked for all 2Gbytes, but I don't know if XP
is equally robust.

BTW, really nice job on the C target.  Much better documentation than
most open source projects.  I'm really looking forward to the C++
target, if only to eliminate the explicit passing of the 'this' pointer.

Just a few points: 

1) I basically had little trouble getting it to work.  The only real
problem was that the sources don't come with a configure script already
built, so one has to use autoconf.  To cut a long story short, I
eventually gave up on the GNU tools because makefile.in wasn't available
so I couldn't successfully run automake.  It turned out to be easy to
create a config.h file from scratch, so that's what I ended up doing.
Nevertheless, you might want to add a working configure script and
makefile.am's as is done with most source distros, to avoid
inconvenience to those with back-level autoconf tools.  (Admittedly I'm
all at sea with autoconf tools, so it's probably my stupidity).

2) Before I realized you had already ported Terrence's C grammar/Java
target to a C target, I was attempting to do so myself.  While doing
this, I found out that the @header stuff is put into both the .c and the
.h files.  I really wanted to put the @header stuff in just the .h file
(is that unreasonable?) so I decided to tweak the string template file.
Lo and behold, the changes to the string templates were not noticed by
the antlr tool.  What am I missing?  I thought it was just a matter of
changing 

$(ANTLR_HOME)/src/org/antlr/codegen/templates/C/C.stg

but it obviously isn't that simple...  Surely I don't have to rebuild
antlr - that would mean I'd have to get a java compiler - argh!

Regards,
SJH


&gt;<i> -----Original Message-----
</I>&gt;<i> From: Jim Idle [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">jimi at temporal-wave.com</A>] 
</I>&gt;<i> Sent: Monday, July 02, 2007 7:25 PM
</I>&gt;<i> To: Hardy, Stephen; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> Subject: RE: [antlr-interest] Infinite lexer exception 
</I>&gt;<i> allocation loop in Ctarget C parser, antlr3.0
</I>&gt;<i> 
</I>&gt;<i> I t sounds like an issue with the grammar that exposes an issue in the
</I>&gt;<i> runtime, though something tells me that this may be related to an
</I>&gt;<i> extremely recent change to deal with something related. 
</I>&gt;<i> 
</I>&gt;<i> Thanks for pointing this out - I will endeavor to fix this tomorrow or
</I>&gt;<i> at least provide an answer/work around (which might be to allow \x
</I>&gt;<i> sequences ;-).
</I>&gt;<i> 
</I>&gt;<i> Jim
</I>&gt;<i> 
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:antlr-interest-
</I>&gt;<i> &gt; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bounces at antlr.org</A>] On Behalf Of Hardy, Stephen
</I>&gt;<i> &gt; Sent: Monday, July 02, 2007 1:31 PM
</I>&gt;<i> &gt; To: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> &gt; Subject: [antlr-interest] Infinite lexer exception 
</I>&gt;<i> allocation loop in
</I>&gt;<i> &gt; Ctarget C parser, antlr3.0
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt; I'm tasked with some C-to-C translation, and have been 
</I>&gt;<i> using the ANSI
</I>&gt;<i> C
</I>&gt;<i> &gt; grammar with the C target as a starting point, with antlr3.0.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The grammar inadvertently omits the possibility of using \x (hex)
</I>&gt;<i> &gt; escapes in a literal string, and this causes an infinite memory
</I>&gt;<i> &gt; allocation loop when the parser is run against tokens such as
</I>&gt;<i> &gt; &quot;\x00\x00&quot;.  The offending sequence of code is in mSTRING_LITERAL(),
</I>&gt;<i> &gt; which calls mEscapeSequence(), which in turn allocates an exception
</I>&gt;<i> &gt; struct (CONSTRUCTEX()) when it fails to understand the \x.
</I>&gt;<i> &gt; Unfortunately, the calling code is a for(;;) loop which does not
</I>&gt;<i> &gt; advance
</I>&gt;<i> &gt; the token stream, hence the lexer will allocate forever.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Sorry I'm really new to this, so it may be my fault, but it 
</I>&gt;<i> looks like
</I>&gt;<i> &gt; it may be a C target problem.  Didn't see any similar problem
</I>&gt;<i> mentioned
</I>&gt;<i> &gt; in the most recent archive.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; SJH
</I>&gt;<i> 
</I></PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022012.html">[antlr-interest] Infinite lexer exception allocation loop in	Ctarget C parser, antlr3.0
</A></li>
	<LI>Next message: <A HREF="022080.html">[antlr-interest] Infinite lexer exception allocation loop	inCtarget C parser, antlr3.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22047">[ date ]</a>
              <a href="thread.html#22047">[ thread ]</a>
              <a href="subject.html#22047">[ subject ]</a>
              <a href="author.html#22047">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
