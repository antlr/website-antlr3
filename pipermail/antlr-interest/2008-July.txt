From Daniel.Kasmeroglu at Kasisoft.net  Tue Jul  1 03:21:10 2008
From: Daniel.Kasmeroglu at Kasisoft.net (Daniel Kasmeroglu)
Date: Tue, 01 Jul 2008 12:21:10 +0200
Subject: [antlr-interest] List-Labels Problem
Message-ID: <486A0516.4090902@Kasisoft.net>

Maybe I'm a fool but I'm struggling with a grammar that looks like the following

one:



declaration_header :    '[' e+=id (',' e+=id)* ']' -> header(elements={e}) ;



id                 :     'id' i=ID -> element(el={i});



For an input like this: "[ id bla, id blub, id frog, id hello ]" I expected to 
handle a list of 4 items using the StringTemplate header (see rule 
declaration_header). But there's only the last label processed. Checking out the 
parser I've noticed that the label itself will be passed as an argument instead 
of the list-variable. Is that correct behaviour (according to Chapter 4 of the 
ANTLR Reference I believe not) ? And if it is correct where is this documented ?

Can anyone explain to me why and how such a list label can be handled ?



Thanks in advance.



Ciao

Kasimir

From AndrevdM at pyrogenesis.co.za  Tue Jul  1 03:23:51 2008
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Tue, 1 Jul 2008 12:23:51 +0200
Subject: [antlr-interest] List-Labels Problem
Message-ID: <E7035321714C624BA01ADCBA6F99CADF0102FF75DF6B@mercury.pyrogenesis.co.za>

Hi,

Have you tried using $e?

e.g.
   -> header(elements={$e}) ;

Andre


-----Original Message-----
Maybe I'm a fool but I'm struggling with a grammar that looks like the following

one:



declaration_header :    '[' e+=id (',' e+=id)* ']' -> header(elements={e}) ;



id                 :     'id' i=ID -> element(el={i});



For an input like this: "[ id bla, id blub, id frog, id hello ]" I expected to
handle a list of 4 items using the StringTemplate header (see rule
declaration_header). But there's only the last label processed. Checking out the
parser I've noticed that the label itself will be passed as an argument instead
of the list-variable. Is that correct behaviour (according to Chapter 4 of the
ANTLR Reference I believe not) ? And if it is correct where is this documented ?

Can anyone explain to me why and how such a list label can be handled ?



Thanks in advance.



Ciao

Kasimir

From g.vandeglind at beinformed.nl  Tue Jul  1 07:34:14 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Tue, 1 Jul 2008 16:34:14 +0200
Subject: [antlr-interest] context information through rule parameters
Message-ID: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>

Dear all,

 

I want to pass context information along with the rules that are parsed.

 

Consider the following grammar:

 

expression : rule1[false] | rule2[true];

 

rule1[boolean bool]: rule3[true] | rule4[$bool];

 

rule2[boolean bool]: rule3[false] | rule4[$bool];

 

...

 

However, rule4[$bool] is not accepted. Is this an invalid construct? If
yes, is there a work-around?

 

Thanks a lot!

 

Cheers, Gerard

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/d721e811/attachment-0001.html 

From jdmitchell at gmail.com  Tue Jul  1 07:47:17 2008
From: jdmitchell at gmail.com (John D. Mitchell)
Date: Tue, 1 Jul 2008 07:47:17 -0700
Subject: [antlr-interest] FSM codegen
In-Reply-To: <mailman.3788.1214922861.2486.antlr-interest@antlr.org>
References: <mailman.3788.1214922861.2486.antlr-interest@antlr.org>
Message-ID: <9A654E62-F91C-461C-9F83-F5317ADA3F08@gmail.com>

On Tuesday 2008.07.01, "Chris Rebert" <cvrebert+antlr at gmail.com> wrote:
 > On Mon, Jun 30, 2008 at 12:23 PM, Arnulf Heller <aheller at gmx.at>  
wrote:
[...]
>> is anyone aware of a system translating some formal specification  
>> of finite
>> state machines to C++ code? using ANTLR3 + stringtemplate?
>> I found ECharts in the grammars list but that uses ANTLR2, python  
>> for code
>> emission and seems to be an overkill for my purposes ...
>
> There's the Ragel State Machine Compiler (
> http://research.cs.queensu.ca/~thurston/ragel/ ). It compiles FSM
> definitions written in a DSL into C or C++ (among other target
> languages).
> It shouldn't be too hard to write some stringtemplates to generate the
> FSM definition programmatically.

There's also SMC:  http://smc.sourceforge.net/

Have fun,
John


From antlr at jazillian.com  Tue Jul  1 08:38:10 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 01 Jul 2008 11:38:10 -0400
Subject: [antlr-interest] Access to lexer warning/error messages after
 parsing
In-Reply-To: <1a92904d9130f0673605df7c51603394@mail.frhk.de>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
Message-ID: <486A4F62.3030905@jazillian.com>

Raphael Reitzig wrote:
> * possibility to set output stream for error messages via grammar option:
> @errors { System.err } (default)

Note that you can do this yourself today with System.setErr().

From jimi at temporal-wave.com  Tue Jul  1 09:06:20 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 01 Jul 2008 09:06:20 -0700
Subject: [antlr-interest] Access to lexer warning/error messages
	after	parsing
In-Reply-To: <1a92904d9130f0673605df7c51603394@mail.frhk.de>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
Message-ID: <1214928380.26777.13.camel@jimi>

On Tue, 2008-07-01 at 08:54 +0200, Raphael Reitzig wrote:

> Hi!
> 
> I second that for I am about to write something quite similar. System.err
> is no good in a user oriented GUI application.
> 
> I can think of two possibilties to integrate such behaviour in ANTLR:
> * grammar option like "warnMode", i.e. with values "console" and "collect".
> I'd like to have _one_ exceptions thrown if there ocurred any error while
> parsing.
> * possibility to set output stream for error messages via grammar option:
> @errors { System.err } (default)
> Implementation of either should be no obstacle (*guess*).


In the case of lexers, it is best to build a lexer that almost cannot
throw errors as once you lex incorrectly then there isn't much you can
do. Having rules in the lexer that catch known common mistakes and/or
catch any character that makes no sense in your lexer means that your
whole solution will be more robust. For most lexers,. just having:

BADCHAR: . {insert your error code};

As the last rule will improve things.

However, in the case of lexer, parser and tree parser it is trivial to
override the error output method and add your errors to collections/a
collection. As the standard error messages are usually of no use to a
real application (and they cannot be, there are too many things you
might wish to do on error), then you will almost certainly want to
implement your own error output anyway. Just add the message to a
collection. I do this with virtually every recognizer I write and it
takes less time than learning some new syntax and access methods for
ANTLR (which everyone will then complain about because they don't do
exactly what they had in mind. ;-)

So, the method that is called has all the information that you could
need, but YOU have to make it in to a collection, format it in a way
that makes sense for your application, and present the errors to your
users. There is no generic solution that would provide much more than a
different set of questions than there is right now. Sure, the errors
could all be collected as objects that you then iterate, but then there
is more code for people to rip out when they don't want that!

Come on guys the error messages are an afternoons coding that you can
probably reuse on related projects (if they are living in the same
environment.) I last did this in C# and if it took an hour to get it all
together I would be surprised. You only need to learn the ANTLR bit
once.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/8130766e/attachment.html 

From Waverly.Edwards at genesys.com  Tue Jul  1 09:42:36 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Tue, 1 Jul 2008 12:42:36 -0400
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <486A4F62.3030905@jazillian.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com><1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>

 
Wouldn't it be wise to just let the lexical error go and let the parser
catch it.
Any invalid character isn't really recoverable and since the user has to
fix it
anyway, it will just show up a misplaced identifier, number or symbol as
far as the
parser is concerned.  Also if you store the lexical error, you'll end up
reporting
the error twice... once as a lexical error and once as a parse error.


W.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andy Tripp
Sent: Tuesday, July 01, 2008 11:38 AM
To: Raphael Reitzig
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Access to lexer warning/error messages
after parsing

Raphael Reitzig wrote:
> * possibility to set output stream for error messages via grammar
option:
> @errors { System.err } (default)

Note that you can do this yourself today with System.setErr().

From aegana at noao.edu  Tue Jul  1 09:46:02 2008
From: aegana at noao.edu (Alvaro Egana Viedma)
Date: Tue, 01 Jul 2008 12:46:02 -0400
Subject: [antlr-interest] AST rewriting
Message-ID: <486A5F4A.5050307@noao.edu>

Hi all,

I'm new to the list and kind of new to ANTLR so I don't know if this 
stuff is possible or not. I'm working with antlr v3.1b1 and I noticed 
that you can use output=AST for tree grammars in that version. Well, I'm 
using output=AST and but I have a little problem with it. My tree 
grammar looks like:


def : ^(DEF name expr)
     ;
name : <<some rules>>;

expr  returns [String value]
     : <<some rules>>
     ;


I've been trying to do this rewrite:

def : ^(DEF name expr) -> ^(DEF name $expr.value)

(I'm writing a name resolver ...)


But antlr complains saying there is a reference to an undefined rule 
'value'.

Does anyone knows some hack to do something like this?

Thanks in advance for any help.

Alvaro Egana


From antlr at jazillian.com  Tue Jul  1 10:02:42 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 01 Jul 2008 13:02:42 -0400
Subject: [antlr-interest] Access to lexer warning/error messages	after
 parsing
In-Reply-To: <1214928380.26777.13.camel@jimi>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<1214928380.26777.13.camel@jimi>
Message-ID: <486A6332.1050507@jazillian.com>

Jim,

As you point out, the default case is that people will want to process their own error messages,
rather than have ANTLR send them to stderr. So doesn't it make more sense to
have ANTLR package them into a data structure (which has a toString() method
which ANTLR calls and sends to stderr? The alternative is that people
have to either parse the error text or look at the ANTLR-generated code to
understand how to override the default behavior.

You mention reusing your error handling mechanism across "virtually all" your
grammars. I think that for almost ANTLR users, the number of lexer/parsers that they're
going to write is exactly 1. Better to make it as easy as possible to write that
first grammar and not assume that they're going to be creating more grammars
anyway. Part of making it easy is to make it possible to build a lexer/parser
as a "black box", without having to ever look at the ANTLR-generated code.

Andy


Jim Idle wrote:
> On Tue, 2008-07-01 at 08:54 +0200, Raphael Reitzig wrote:
>> Hi!
>>
>> I second that for I am about to write something quite similar. System.err
>> is no good in a user oriented GUI application.
>>
>> I can think of two possibilties to integrate such behaviour in ANTLR:
>> * grammar option like "warnMode", i.e. with values "console" and "collect".
>> I'd like to have _one_ exceptions thrown if there ocurred any error while
>> parsing.
>> * possibility to set output stream for error messages via grammar option:
>> @errors { System.err } (default)
>> Implementation of either should be no obstacle (*guess*).
> 
> In the case of lexers, it is best to build a lexer that almost cannot 
> throw errors as once you lex incorrectly then there isn't much you can 
> do. Having rules in the lexer that catch known common mistakes and/or 
> catch any character that makes no sense in your lexer means that your 
> whole solution will be more robust. For most lexers,. just having:
> 
> BADCHAR: . {insert your error code};
> 
> As the last rule will improve things.
> 
> However, in the case of lexer, parser and tree parser it is trivial to 
> override the error output method and add your errors to collections/a 
> collection. As the standard error messages are usually of no use to a 
> real application (and they cannot be, there are too many things you 
> might wish to do on error), then you will almost certainly want to 
> implement your own error output anyway. Just add the message to a 
> collection. I do this with virtually every recognizer I write and it 
> takes less time than learning some new syntax and access methods for 
> ANTLR (which everyone will then complain about because they don't do 
> exactly what they had in mind. ;-)
> 
> So, the method that is called has all the information that you could 
> need, but YOU have to make it in to a collection, format it in a way 
> that makes sense for your application, and present the errors to your 
> users. There is no generic solution that would provide much more than a 
> different set of questions than there is right now. Sure, the errors 
> could all be collected as objects that you then iterate, but then there 
> is more code for people to rip out when they don't want that!
> 
> Come on guys the error messages are an afternoons coding that you can 
> probably reuse on related projects (if they are living in the same 
> environment.) I last did this in C# and if it took an hour to get it all 
> together I would be surprised. You only need to learn the ANTLR bit once.
> 
> Jim


From belayda at gmail.com  Tue Jul  1 10:18:58 2008
From: belayda at gmail.com (Bernardo Elayda)
Date: Tue, 1 Jul 2008 10:18:58 -0700
Subject: [antlr-interest] AST rewriting
Message-ID: <3e5ed32f0807011018x760300bbh1cf93c779ab8f94f@mail.gmail.com>

Hi!
Try this instead:

def : ^(DEF name mylabel=expr) -> ^(DEF name $mylabel.value)

hth,
Bernardo Elayda


----------------------------
def : ^(DEF name expr)
     ;
name : <<some rules>>;

expr  returns [String value]
     : <<some rules>>
     ;


I've been trying to do this rewrite:

def : ^(DEF name expr) -> ^(DEF name $expr.value)

(I'm writing a name resolver ...)


But antlr complains saying there is a reference to an undefined rule
'value'.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/d13cab3a/attachment.html 

From jens.boeykens at gmail.com  Tue Jul  1 10:47:06 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 01 Jul 2008 19:47:06 +0200
Subject: [antlr-interest] templates and question marks (-> '?')
Message-ID: <486A6D9A.3070000@gmail.com>

Hi,

Consider a grammar:

grammarDef
    :   ^( grammarType ID DOC_COMMENT? optionsSpec? tokensSpec? attrScope* action* rule+ )
    ;

If I want to add a template rewrite rule and use e.g. optionsSpec:

grammarDef
    :   ^( grammarType ID DOC_COMMENT? optionsSpec? tokensSpec? attrScope* action* rule+ ) -> temp(options={$optionsSpec.text})
    ;

This can give nullpointer exceptions when there is no optionsSpec given 
(note the '?').
What is the easiest way to change the rewrite and avoid an exception?

Thanx in advance for any help!

From nelson.ana at gmail.com  Tue Jul  1 10:54:08 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Tue, 1 Jul 2008 18:54:08 +0100
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <486A6332.1050507@jazillian.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<1214928380.26777.13.camel@jimi> <486A6332.1050507@jazillian.com>
Message-ID: <a7d6d2740807011054u5f7dd72fs3d4d74560b4324d1@mail.gmail.com>

I agree that this should be easier to implement. My work-around is to
capture System.err in a buffer and, at the end of parsing, raise an
error if there is any text there. I know there are other ways of doing
this, but this way was simplest for me in that I didn't have to change
a single line of my grammar.

I have this encapsulated in a Ruby module (I use the Java target and
JRuby), so I don't have to think about it and can reuse the logic for
any grammar. This works fine for me now that I have it set up, but
writing to System.err by default seems to be less than ideal.

Also, Andy raises a very good point about many people only ever
creating a single ANTLR grammar. I think that's a good mindset to
approach the UI design with. (Of course, once they've created their
single ANTLR grammar and see how much fun it is, they'll be back for
more.)


2008/7/1 Andy Tripp <antlr at jazillian.com>:
> Jim,
>
> As you point out, the default case is that people will want to process their
> own error messages,
> rather than have ANTLR send them to stderr. So doesn't it make more sense to
> have ANTLR package them into a data structure (which has a toString() method
> which ANTLR calls and sends to stderr? The alternative is that people
> have to either parse the error text or look at the ANTLR-generated code to
> understand how to override the default behavior.
>
> You mention reusing your error handling mechanism across "virtually all"
> your
> grammars. I think that for almost ANTLR users, the number of lexer/parsers
> that they're
> going to write is exactly 1. Better to make it as easy as possible to write
> that
> first grammar and not assume that they're going to be creating more grammars
> anyway. Part of making it easy is to make it possible to build a
> lexer/parser
> as a "black box", without having to ever look at the ANTLR-generated code.
>
> Andy
>
>
> Jim Idle wrote:
>>
>> On Tue, 2008-07-01 at 08:54 +0200, Raphael Reitzig wrote:
>>>
>>> Hi!
>>>
>>> I second that for I am about to write something quite similar. System.err
>>> is no good in a user oriented GUI application.
>>>
>>> I can think of two possibilties to integrate such behaviour in ANTLR:
>>> * grammar option like "warnMode", i.e. with values "console" and
>>> "collect".
>>> I'd like to have _one_ exceptions thrown if there ocurred any error while
>>> parsing.
>>> * possibility to set output stream for error messages via grammar option:
>>> @errors { System.err } (default)
>>> Implementation of either should be no obstacle (*guess*).
>>
>> In the case of lexers, it is best to build a lexer that almost cannot
>> throw errors as once you lex incorrectly then there isn't much you can do.
>> Having rules in the lexer that catch known common mistakes and/or catch any
>> character that makes no sense in your lexer means that your whole solution
>> will be more robust. For most lexers,. just having:
>>
>> BADCHAR: . {insert your error code};
>>
>> As the last rule will improve things.
>>
>> However, in the case of lexer, parser and tree parser it is trivial to
>> override the error output method and add your errors to collections/a
>> collection. As the standard error messages are usually of no use to a real
>> application (and they cannot be, there are too many things you might wish to
>> do on error), then you will almost certainly want to implement your own
>> error output anyway. Just add the message to a collection. I do this with
>> virtually every recognizer I write and it takes less time than learning some
>> new syntax and access methods for ANTLR (which everyone will then complain
>> about because they don't do exactly what they had in mind. ;-)
>>
>> So, the method that is called has all the information that you could need,
>> but YOU have to make it in to a collection, format it in a way that makes
>> sense for your application, and present the errors to your users. There is
>> no generic solution that would provide much more than a different set of
>> questions than there is right now. Sure, the errors could all be collected
>> as objects that you then iterate, but then there is more code for people to
>> rip out when they don't want that!
>>
>> Come on guys the error messages are an afternoons coding that you can
>> probably reuse on related projects (if they are living in the same
>> environment.) I last did this in C# and if it took an hour to get it all
>> together I would be surprised. You only need to learn the ANTLR bit once.
>>
>> Jim
>
>

From jimi at temporal-wave.com  Tue Jul  1 11:20:16 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 01 Jul 2008 11:20:16 -0700
Subject: [antlr-interest] Access to lexer warning/error messages
	after	parsing
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
Message-ID: <1214936416.26777.50.camel@jimi>

On Tue, 2008-07-01 at 12:42 -0400, Edwards, Waverly wrote:

> Wouldn't it be wise to just let the lexical error go and let the parser
> catch it.
> Any invalid character isn't really recoverable and since the user has to
> fix it
> anyway, it will just show up a misplaced identifier, number or symbol as
> far as the
> parser is concerned.  Also if you store the lexical error, you'll end up
> reporting
> the error twice... once as a lexical error and once as a parse error.


if you do not report both, then sometimes the error from the parser will
be very confusing. so, if you intercept an illegal character in the
lexer, you can first print - or store in a collection ;-0 - the position
of the character that threw things out;

xxx.hhh  parameter

line 17, offset 4, illegal character 0x7ff 

then the parser says;

line 17, offset 5 - near 'hhh'  expecting '.'

without the lexer pointing out that you have the wrong '.' - i didn't
look up what 0x7ff actually is, this is just an example of course - you
would need a few glances at this to realize what had happened.

jim
       

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/73ee06cb/attachment.html 

From Waverly.Edwards at genesys.com  Tue Jul  1 11:30:15 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Tue, 1 Jul 2008 14:30:15 -0400
Subject: [antlr-interest] Access to lexer warning/error messages
	afterparsing
In-Reply-To: <1214936416.26777.50.camel@jimi>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
	<1214936416.26777.50.camel@jimi>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1012D7A8E@navamane001.ad.internal.corp>

I see.
I understand.
I learned something.
I concede.
I thank you.
 
 
W.

________________________________

From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Tuesday, July 01, 2008 2:20 PM
To: Edwards, Waverly
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Access to lexer warning/error messages
afterparsing


On Tue, 2008-07-01 at 12:42 -0400, Edwards, Waverly wrote: 

	Wouldn't it be wise to just let the lexical error go and let the
parser
	catch it.
	Any invalid character isn't really recoverable and since the
user has to
	fix it
	anyway, it will just show up a misplaced identifier, number or
symbol as
	far as the
	parser is concerned.  Also if you store the lexical error,
you'll end up
	reporting
	the error twice... once as a lexical error and once as a parse
error.


if you do not report both, then sometimes the error from the parser will
be very confusing. so, if you intercept an illegal character in the
lexer, you can first print - or store in a collection ;-0 - the position
of the character that threw things out;

xxx.hhh  parameter

line 17, offset 4, illegal character 0x7ff 

then the parser says;

line 17, offset 5 - near 'hhh'  expecting '.'

without the lexer pointing out that you have the wrong '.' - i didn't
look up what 0x7ff actually is, this is just an example of course - you
would need a few glances at this to realize what had happened.

jim
       


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/28f58e52/attachment.html 

From granville at gbarnett.org  Tue Jul  1 11:29:55 2008
From: granville at gbarnett.org (Granville Barnett)
Date: Tue, 1 Jul 2008 19:29:55 +0100
Subject: [antlr-interest] Access to lexer warning/error messages
	after	parsing
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com><1a92904d9130f0673605df7c51603394@mail.frhk.de>	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
Message-ID: <001a01c8dba8$768d2790$63a776b0$@org>

I agree with Waverly, catching the lexical error's as well seems a little
extreme and not really necessary.

Granville

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Edwards, Waverly
Sent: 01 July 2008 17:43
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Access to lexer warning/error messages after
parsing

 
Wouldn't it be wise to just let the lexical error go and let the parser
catch it.
Any invalid character isn't really recoverable and since the user has to
fix it
anyway, it will just show up a misplaced identifier, number or symbol as
far as the
parser is concerned.  Also if you store the lexical error, you'll end up
reporting
the error twice... once as a lexical error and once as a parse error.


W.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andy Tripp
Sent: Tuesday, July 01, 2008 11:38 AM
To: Raphael Reitzig
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Access to lexer warning/error messages
after parsing

Raphael Reitzig wrote:
> * possibility to set output stream for error messages via grammar
option:
> @errors { System.err } (default)

Note that you can do this yourself today with System.setErr().




From granville at gbarnett.org  Tue Jul  1 11:35:57 2008
From: granville at gbarnett.org (Granville Barnett)
Date: Tue, 1 Jul 2008 19:35:57 +0100
Subject: [antlr-interest] Access to lexer warning/error
	messages	after	parsing
In-Reply-To: <1214936416.26777.50.camel@jimi>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>	<1a92904d9130f0673605df7c51603394@mail.frhk.de>	<486A4F62.3030905@jazillian.com>	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
	<1214936416.26777.50.camel@jimi>
Message-ID: <002c01c8dba9$4eb48af0$ec1da0d0$@org>

Ooops. I stand corrected.

 

Granville

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: 01 July 2008 19:20
To: Edwards, Waverly
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Access to lexer warning/error messages after parsing

 

On Tue, 2008-07-01 at 12:42 -0400, Edwards, Waverly wrote: 

 
Wouldn't it be wise to just let the lexical error go and let the parser
catch it.
Any invalid character isn't really recoverable and since the user has to
fix it
anyway, it will just show up a misplaced identifier, number or symbol as
far as the
parser is concerned.  Also if you store the lexical error, you'll end up
reporting
the error twice... once as a lexical error and once as a parse error.


if you do not report both, then sometimes the error from the parser will be very confusing. so, if you intercept an illegal character in the lexer, you can first print - or store in a collection ;-0 - the position of the character that threw things out;

xxx.hhh  parameter

line 17, offset 4, illegal character 0x7ff 

then the parser says;

line 17, offset 5 - near 'hhh'  expecting '.'

without the lexer pointing out that you have the wrong '.' - i didn't look up what 0x7ff actually is, this is just an example of course - you would need a few glances at this to realize what had happened.

jim
       

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/f5f3d1ff/attachment.html 

From jimi at temporal-wave.com  Tue Jul  1 12:07:15 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 01 Jul 2008 12:07:15 -0700
Subject: [antlr-interest] Access to lexer warning/error
	messages	after	parsing
In-Reply-To: <486A6332.1050507@jazillian.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<1214928380.26777.13.camel@jimi>  <486A6332.1050507@jazillian.com>
Message-ID: <1214939235.11423.6.camel@jimi>

On Tue, 2008-07-01 at 13:02 -0400, Andy Tripp wrote:

> Jim,
> 
> As you point out, the default case is that people will want to process their own error messages,
> rather than have ANTLR send them to stderr. So doesn't it make more sense to
> have ANTLR package them into a data structure (which has a toString() method
> which ANTLR calls and sends to stderr? The alternative is that people
> have to either parse the error text or look at the ANTLR-generated code to
> understand how to override the default behavior.
> 
> You mention reusing your error handling mechanism across "virtually all" your
> grammars. I think that for almost ANTLR users, the number of lexer/parsers that they're
> going to write is exactly 1. Better to make it as easy as possible to write that
> first grammar and not assume that they're going to be creating more grammars
> anyway. Part of making it easy is to make it possible to build a lexer/parser
> as a "black box", without having to ever look at the ANTLR-generated code.

No need to go into a long conversations about this, but placing the
messages in a collection would then just hide them away. So, they would
just sit there and the users would not even know there WERE any
messages. So, then you have to supply... errr... a method to print them
out. Then you have to override that method to print them out in the way
you want. Then one finds that the information in the collection isn't
quite what you want, or that most people want the messages to print as
they occur, so now there are two methods that you might need to
override. So, you are back to square one, or maybe worse. In short,
while I don't think that collection the messages is bad idea at all (I
do it myself), my feeling is that creating the collection would actually
complicate things for new users, not simplify them. 

At the end of the day though, if that's what most people wanted and Ter
thought it to be a reasonable request, then I certainly would not object
to it.

Jim


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/a7b630a5/attachment.html 

From jimi at temporal-wave.com  Tue Jul  1 12:18:51 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 01 Jul 2008 12:18:51 -0700
Subject: [antlr-interest] templates and question marks (-> '?')
In-Reply-To: <486A6D9A.3070000@gmail.com>
References: <486A6D9A.3070000@gmail.com>
Message-ID: <1214939931.11423.15.camel@jimi>

On Tue, 2008-07-01 at 19:47 +0200, Jens Boeykens wrote:

> Hi,
> 
> Consider a grammar:
> 
> grammarDef
>     :   ^( grammarType ID DOC_COMMENT? optionsSpec? tokensSpec? attrScope* action* rule+ )
>     ;
> 
> If I want to add a template rewrite rule and use e.g. optionsSpec:
> 
> grammarDef
>     :   ^( grammarType ID DOC_COMMENT? optionsSpec? tokensSpec? attrScope* action* rule+ ) -> temp(options={$optionsSpec.text})
>     ;
> 
> This can give nullpointer exceptions when there is no optionsSpec given 
> (note the '?').
> What is the easiest way to change the rewrite and avoid an exception?


Use conditional rewrites such as:

gd
@init { boolean haveOptions = false;}
:
    ^(  x y (options {haveOptions = true})?)  

   -> {haveOptions}? temp....
   -> othertemp ...
;

I use a flag because I have been seeing a confusing scheme with labels,
which I need to ask Ter about i think:

 x=options?

-> {$x == null} xxxxxxxxxx

Missing attribute for $x

but if you use $x.tree then you will get a null pointer exception.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/95353618/attachment.html 

From parrt at cs.usfca.edu  Tue Jul  1 12:19:10 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 1 Jul 2008 12:19:10 -0700
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
Message-ID: <8B58B6C6-68DF-43E0-9F1C-AA0049217CB4@cs.usfca.edu>

Hi Gang, :)

My intention was that you override one method and do what you want.   
Not sure what else anybody would want. Replace System.err in override  
with errors.add(...) and you're done.  Not sure what the long  
conversation is about.  Can't think of an easier way.

Ter

On Jun 30, 2008, at 3:25 PM, Sumanto Biswas wrote:

> Hi,
>
> Many times the lexer gives warnings but tries to continue. When the
> parser is not able to handle, then we get exception.
>
> As an example, for an input for my lexer-parser, from the parser I get
> NoViableAltException, with the following (formatted) information
> :"Mesg: Line number:0, Column no:-1, Message:no viable alternative at
> input '<EOF>'". Earlier the lexer had given the following warning:
> "line 1:17 mismatched character '}' expecting '"'".
>
> If I use antlr within a product, the lexer warning seems to be much
> better to show since its clear and the line and column nos are correct
> with respect to the input. But the messages are in the error stream,
> and not stored somewhere. So I have to do something like what is
> pasted below.
>
> I think it would be nice to have a list of structures which contain
> the line no, column no, and the error message, and the exception so
> that programmatically it would be easy to get that to see warnings
> generated. Maybe something like 'getWarnings()' on the lexer.
>
> Regards,
> Sumanto
>
> ==========================================================
> @lexer::members {
>  private List<String> messages = new ArrayList<String>();
>
>  public void displayRecognitionError(String[] tokenNames,
> RecognitionException e) {
>    String hdr = getErrorHeader(e);
>    String msg = getErrorMessage(e, tokenNames);
>    messages.add(hdr+" "+msg);
>  }
> 	
>  public List<String> getMessages() {
>    return messages;
>  }
>
>  // And other methods to get line no/column no as needed.
> }
> ==========================================================


From parrt at cs.usfca.edu  Tue Jul  1 12:19:58 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 1 Jul 2008 12:19:58 -0700
Subject: [antlr-interest] context information through rule parameters
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
Message-ID: <18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>


On Jul 1, 2008, at 7:34 AM, Gerard van de Glind wrote:

> Dear all,
>
> I want to pass context information along with the rules that are  
> parsed.
>
> Consider the following grammar:
>
> expression : rule1[false] | rule2[true];
>
> rule1[boolean bool]: rule3[true] | rule4[$bool];
>
> rule2[boolean bool]: rule3[false] | rule4[$bool];
>
> ?
>
> However, rule4[$bool] is not accepted. Is this an invalid construct?  
> If yes, is there a work-around?

what is the error?  note rule4 is not defined in example.
Ter

From depakbhalla at gmail.com  Tue Jul  1 12:26:31 2008
From: depakbhalla at gmail.com (Deepak Bhalla)
Date: Tue, 1 Jul 2008 12:26:31 -0700
Subject: [antlr-interest] Extracting line number while parsing
Message-ID: <ed8521100807011226x29e9f116vefb87d8be0da13cf@mail.gmail.com>

Hi,

I am writing a tool in C# to find patterns  in  Java code. I am using Antlr
to parse the java code and to extract the information. Can anyone tell me
how to extract the line number while parsing the java file.

Thanks,
DB
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/0facc2d8/attachment.html 

From david at gohazel.com  Tue Jul  1 13:05:52 2008
From: david at gohazel.com (David Goldberg)
Date: Tue, 1 Jul 2008 16:05:52 -0400
Subject: [antlr-interest] Size of generated lexer code
In-Reply-To: <002c01c8dba9$4eb48af0$ec1da0d0$@org>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
	<1214936416.26777.50.camel@jimi> <002c01c8dba9$4eb48af0$ec1da0d0$@org>
Message-ID: <A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>

Is it normal for a lexer with approximately 125 tokens to generate a C# lexer file of about 7500k? That seems rather large to me. I am running ANTLR 3.01

David

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/328d3406/attachment.html 

From david.beckedorff at gmail.com  Tue Jul  1 13:19:23 2008
From: david.beckedorff at gmail.com (David Beckedorff)
Date: Tue, 1 Jul 2008 16:19:23 -0400
Subject: [antlr-interest] String Template Puzzle
In-Reply-To: <1c7463980807010743n419e95daib1bed4126c659adc@mail.gmail.com>
References: <1c7463980806301428n554de028l8c1b5d4d846ba10e@mail.gmail.com>
	<4869563A.9030801@gmx.de>
	<1c7463980807010743n419e95daib1bed4126c659adc@mail.gmail.com>
Message-ID: <1c7463980807011319pe2af79bp457538c210a358e@mail.gmail.com>

Later enhancements ...

          update $dto.tableName$
          set $dto.fields : { f |
$if(!f.idColumn)$$if(!f.versionColumn)$$if(!f.extraColumn)$
            $f.dbColName$ = #$f.name
;format="ilc"$:$f.dbColType$#$if(!f.penultimateField)$,$endif$
$endif$$endif$$endif$}$
          where current of c1; c1;


But I still have the blank line problem.




On 7/1/08, David Beckedorff <david.beckedorff at gmail.com> wrote:
>
> OK, Johannes, cool suggestion!
>
>
> So I added boolean fields 'reqForUpdate' and 'lastFieldForUpdate" to my
> DtoField class & now the template looks like this:
>
>           update $dto.tableName$
>           set $dto.fields : { f |
> $if(f.reqForUpdate)$
>             $f.dbColName$ = #$f.name
> ;format="ilc"$:$f.dbColType$#$if(!f.lastFieldForUpdate)$,$endif$
> $endif$}$
>           where current of c1;
>
>
> which generates:
>
>
>           update DP_JRNL_ENTRY
>           set
>
>             OWNR_PERS_NTL_ID = #ownerId:VARCHAR#,
>             OWNR_DP_TYPE_CD = #ownerDpType:VARCHAR#,
>             ATHR_PERS_NTL_ID = #authorId:VARCHAR#,
>             ATHR_PERS_SRC_ID = #authorSourceId:NUMERIC#,
>             SBJ_AREA_ID = #subjectAreaId:NUMERIC#,
>             DP_GOAL_TYPE_CD = #goalTypeCode:VARCHAR#,
>             DP_JRNL_TITLE_TX = #title:VARCHAR#,
>             DP_JRNL_ENTRY_TX = #entry:CLOB#,
>             DP_JRNL_ENTRY_CMNT = #comments:CLOB#,
>             DP_JRNL_CRTN_DT = #createDate:DATE#,
>             DP_JRNL_UPDT_DT = #modifiedDate:DATE#,
>             DP_JRNL_STRT_DT = #startDate:DATE#,
>             DP_JRNL_END_DT = #endDate:DATE#,
>             DP_JRNL_ACHV_DT = #achievementDate:DATE#
>
>           where current of c1;
>
>
>
> So, now, for the gold ring, how do I get rid of the 2 blank lines, one
> after 'set' and the second after 'DP_JRNL_ACHV_DT = ...'  ??   The $if$ test
> when false seems always to generate a blank line.
>
> -David
>
>
>  On 6/30/08, Johannes Luber <jaluber at gmx.de> wrote:
>>
>> David Beckedorff schrieb:
>>
>>> Dear String Templaters,
>>>  I have a ST template that generates a SQL update statement::
>>>  dtoSqlMap(service,dto) ::= <<
>>> ...
>>> update $dto.tableName$
>>> set $dto.fields : { f |
>>>  $f.dbColName$ = #$f.name <http://f.name>;format="ilc"$:$f.dbColType$#};
>>> separator=","$           <== "ilc" means to format the initial letter
>>> lowercase
>>> where current of c1;
>>> ...
>>>  >>
>>>  which in a specific case generates the following code:
>>>  update DP_JRNL_ENTRY
>>> set
>>>  DP_JRNL_ENTRY_ID = #id:NUMERIC,
>>>  OWNR_PERS_NTL_ID = #ownerId:VARCHAR,
>>>  OWNR_DP_TYPE_CD = #ownerDpType:VARCHAR,
>>>  ATHR_PERS_NTL_ID = #authorId:VARCHAR,
>>>  ATHR_PERS_SRC_ID = #authorSourceId:NUMERIC,
>>>  SBJ_AREA_ID = #subjectAreaId:NUMERIC,
>>>  DP_GOAL_TYPE_CD = #goalTypeCode:VARCHAR,
>>>  DP_JRNL_TITLE_TX = #title:VARCHAR,
>>>  DP_JRNL_ENTRY_TX = #entry:CLOB,
>>>  DP_JRNL_CRTN_DT = #createDate:DATE,
>>>  DP_JRNL_UPDT_DT = #modifiedDate:DATE,
>>>  DP_JRNL_STRT_DT = #startDate:DATE,
>>>  DP_JRNL_END_DT = #endDate:DATE,
>>>  DP_JRNL_ACHV_DT = #achievementDate:DATE,
>>>  VER_NBR = #version:NUMERIC         where current of c1;
>>>   However, I want to suppress the DP_JRNL_ENTRY_ID and VER_NBR fields.
>>> The former is implied by "where current of c1" and the latter is updated by
>>> a trigger, so should be omitted from the update statement. But they are
>>> valid fields of the Data Transfer Object (DTO).
>>>  It appears that the $if(...)$ construct allows to test for the presence
>>> of an attribute or the value of a boolean. But I don't think it allows to
>>> test for:  if  ( $f.dbColName$ == "DP_JRNL_ENTRY_ID" ).
>>>  Is there some other way to accomplish this?
>>>  Thanks,
>>> David
>>>
>>
>> Create a new attribute IsdbColNameJournalEntry.
>>
>> Johannes
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/68ddafda/attachment-0001.html 

From antlr at jazillian.com  Tue Jul  1 13:25:55 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 01 Jul 2008 16:25:55 -0400
Subject: [antlr-interest] Access to lexer warning/error messages	after
 parsing
In-Reply-To: <1214939235.11423.6.camel@jimi>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>	
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>	
	<1214928380.26777.13.camel@jimi> <486A6332.1050507@jazillian.com>
	<1214939235.11423.6.camel@jimi>
Message-ID: <486A92D3.5090202@jazillian.com>

Jim Idle wrote:

> No need to go into a long conversations about this, but placing the 
> messages in a collection would then just hide them away. 

What's being suggested is to have ANTLR store the error in some data structure,
then ANTLR can call toString() on that and send to stderr, as it does today.
...and then just provide access to the data structure.

> So, they would 
> just sit there and the users would not even know there WERE any 
> messages. So, then you have to supply... errr... a method to print them 
> out. 
ANTLR would supply that, as it does today.

> Then you have to override that method to print them out in the way 
> you want. 

Yes, if you want to print it in a different way (unlikely).

> Then one finds that the information in the collection isn't 
> quite what you want, 

Yes, that's always a potential problem.

> or that most people want the messages to print as 
> they occur, so now there are two methods that you might need to 
> override. So, you are back to square one, or maybe worse. In short, 
> while I don't think that collection the messages is bad idea at all (I 
> do it myself), my feeling is that creating the collection would actually 
> complicate things for new users, not simplify them.

The choice is between:
today: getting a message sent to stderr, override ANTLR-generated code if that's not good enough
proposed: getting a message sent to stderr, having access to the error in
   a data structure, override ANTLR-generated code if that's not good enough

> 
> At the end of the day though, if that's what most people wanted and Ter 
> thought it to be a reasonable request, then I certainly would not object 
> to it.
> 
> Jim

The situation is analogous to Java stack traces.
At first, the JVM would just spit out the stack trace as text on an exception.
Now, it does the same thing, but also gives the programmer the ability to
access the stack trace as a data structure.

Andy
 


From darach at gmail.com  Tue Jul  1 13:41:02 2008
From: darach at gmail.com (Darach Ennis)
Date: Tue, 1 Jul 2008 21:41:02 +0100
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <486A92D3.5090202@jazillian.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<1214928380.26777.13.camel@jimi> <486A6332.1050507@jazillian.com>
	<1214939235.11423.6.camel@jimi> <486A92D3.5090202@jazillian.com>
Message-ID: <4d596d820807011341v394832bchee4b8bc9a233da87@mail.gmail.com>

Hi guys,
For an IDL compiler I wrote years ago (using JavaCC I think) I used
subject/observer to catch/store errors
in a data structure and a degenerate visitor to format them for output and
for asserting actual/expected errors/warnings
for destructive unit testing.

It turned out to be very useful during development and testing and forced me
to consider
the quality of error messages being produced.

If a standard error mechanism / data structure were added then support in
gunit
would be a useful related enhancement.

Regards,

Darach.

On Tue, Jul 1, 2008 at 9:25 PM, Andy Tripp <antlr at jazillian.com> wrote:

> Jim Idle wrote:
>
>  No need to go into a long conversations about this, but placing the
>> messages in a collection would then just hide them away.
>>
>
> What's being suggested is to have ANTLR store the error in some data
> structure,
> then ANTLR can call toString() on that and send to stderr, as it does
> today.
> ...and then just provide access to the data structure.
>
>  So, they would just sit there and the users would not even know there WERE
>> any messages. So, then you have to supply... errr... a method to print them
>> out.
>>
> ANTLR would supply that, as it does today.
>
>  Then you have to override that method to print them out in the way you
>> want.
>>
>
> Yes, if you want to print it in a different way (unlikely).
>
>  Then one finds that the information in the collection isn't quite what you
>> want,
>>
>
> Yes, that's always a potential problem.
>
>  or that most people want the messages to print as they occur, so now there
>> are two methods that you might need to override. So, you are back to square
>> one, or maybe worse. In short, while I don't think that collection the
>> messages is bad idea at all (I do it myself), my feeling is that creating
>> the collection would actually complicate things for new users, not simplify
>> them.
>>
>
> The choice is between:
> today: getting a message sent to stderr, override ANTLR-generated code if
> that's not good enough
> proposed: getting a message sent to stderr, having access to the error in
>  a data structure, override ANTLR-generated code if that's not good enough
>
>
>> At the end of the day though, if that's what most people wanted and Ter
>> thought it to be a reasonable request, then I certainly would not object to
>> it.
>>
>> Jim
>>
>
> The situation is analogous to Java stack traces.
> At first, the JVM would just spit out the stack trace as text on an
> exception.
> Now, it does the same thing, but also gives the programmer the ability to
> access the stack trace as a data structure.
>
> Andy
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/035e6fcb/attachment.html 

From mig.marques at gmail.com  Tue Jul  1 13:43:08 2008
From: mig.marques at gmail.com (Miguel Marques)
Date: Tue, 1 Jul 2008 21:43:08 +0100
Subject: [antlr-interest] Access to lexer warning/error messages	after
	parsing
References: <0086AB40-F714-4AC7-BCBE-C2AAA4D6433B@gmail.com>
Message-ID: <B44533E2-E621-4753-AE4C-CD4DE0BEF641@gmail.com>

Hy,

I'm writing an eclipse plugin so I need the errors.

public void displayRecognitionError(String[] tokenNames,
			RecognitionException e){   		
		if(errorHandler!=null){
			this.register(errorHandler, e, this.getErrorMessage(e,  
this.getTokenNames()));
		} else{
			String hdr = getErrorHeader(e);
			String msg = getErrorMessage(e, tokenNames);
			emitErrorMessage(hdr+" "+msg);

		}
	}

I've overriden the displayRecognitionError in both the Parser and  
Lexer classes. My handler does all the work, I register the exception  
that has all the information on the error and then process it.

miguel
>
> On 2008/07/01, at 18:02, Andy Tripp wrote:
>
>> Jim,
>>
>> As you point out, the default case is that people will want to  
>> process their own error messages,
>> rather than have ANTLR send them to stderr. So doesn't it make more  
>> sense to
>> have ANTLR package them into a data structure (which has a  
>> toString() method
>> which ANTLR calls and sends to stderr? The alternative is that people
>> have to either parse the error text or look at the ANTLR-generated  
>> code to
>> understand how to override the default behavior.
>>
>> You mention reusing your error handling mechanism across "virtually  
>> all" your
>> grammars. I think that for almost ANTLR users, the number of lexer/ 
>> parsers that they're
>> going to write is exactly 1. Better to make it as easy as possible  
>> to write that
>> first grammar and not assume that they're going to be creating more  
>> grammars
>> anyway. Part of making it easy is to make it possible to build a  
>> lexer/parser
>> as a "black box", without having to ever look at the ANTLR- 
>> generated code.
>>
>> Andy
>>
>>
>> Jim Idle wrote:
>>> On Tue, 2008-07-01 at 08:54 +0200, Raphael Reitzig wrote:
>>>> Hi!
>>>>
>>>> I second that for I am about to write something quite similar.  
>>>> System.err
>>>> is no good in a user oriented GUI application.
>>>>
>>>> I can think of two possibilties to integrate such behaviour in  
>>>> ANTLR:
>>>> * grammar option like "warnMode", i.e. with values "console" and  
>>>> "collect".
>>>> I'd like to have _one_ exceptions thrown if there ocurred any  
>>>> error while
>>>> parsing.
>>>> * possibility to set output stream for error messages via grammar  
>>>> option:
>>>> @errors { System.err } (default)
>>>> Implementation of either should be no obstacle (*guess*).
>>> In the case of lexers, it is best to build a lexer that almost  
>>> cannot throw errors as once you lex incorrectly then there isn't  
>>> much you can do. Having rules in the lexer that catch known common  
>>> mistakes and/or catch any character that makes no sense in your  
>>> lexer means that your whole solution will be more robust. For most  
>>> lexers,. just having:
>>> BADCHAR: . {insert your error code};
>>> As the last rule will improve things.
>>> However, in the case of lexer, parser and tree parser it is  
>>> trivial to override the error output method and add your errors to  
>>> collections/a collection. As the standard error messages are  
>>> usually of no use to a real application (and they cannot be, there  
>>> are too many things you might wish to do on error), then you will  
>>> almost certainly want to implement your own error output anyway.  
>>> Just add the message to a collection. I do this with virtually  
>>> every recognizer I write and it takes less time than learning some  
>>> new syntax and access methods for ANTLR (which everyone will then  
>>> complain about because they don't do exactly what they had in  
>>> mind. ;-)
>>> So, the method that is called has all the information that you  
>>> could need, but YOU have to make it in to a collection, format it  
>>> in a way that makes sense for your application, and present the  
>>> errors to your users. There is no generic solution that would  
>>> provide much more than a different set of questions than there is  
>>> right now. Sure, the errors could all be collected as objects that  
>>> you then iterate, but then there is more code for people to rip  
>>> out when they don't want that!
>>> Come on guys the error messages are an afternoons coding that you  
>>> can probably reuse on related projects (if they are living in the  
>>> same environment.) I last did this in C# and if it took an hour to  
>>> get it all together I would be surprised. You only need to learn  
>>> the ANTLR bit once.
>>> Jim
>>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/5d2253f0/attachment.html 

From siva.kumar at loglogic.com  Tue Jul  1 13:48:41 2008
From: siva.kumar at loglogic.com (siva.kumar at loglogic.com)
Date: Tue, 1 Jul 2008 13:48:41 -0700
Subject: [antlr-interest] Does ANTLR read the entire file before parsing?
In-Reply-To: <117A6478DABB1D4E9509EA7F413AE789075684FA@CTMAIL2.calltower.com>
References: <117A6478DABB1D4E9509EA7F413AE78907567DF3@CTMAIL2.calltower.com><L01SLCSMTP01zzmZ4pV0000a2fd@L01SLCSMTP01.calltower.com>
	<117A6478DABB1D4E9509EA7F413AE789075684FA@CTMAIL2.calltower.com>
Message-ID: <117A6478DABB1D4E9509EA7F413AE789076DB8F2@CTMAIL2.calltower.com>

Hi,
   Just wanted confirmation that ANTLR will generate code that will read
the entire file before it's passed to the lexer.

That is, this is the typical use (I've removed the actual grammar but
it's quite simple):


  public static void main(String[] args) throws Exception {
        testLexer lex = new testLexer(new ANTLRFileStream(args[0]));
        CommonTokenStream tokens = new CommonTokenStream(lex);

        testParser parser = new testParser(tokens);

        try {
            parser.line();
        } catch (RecognitionException e)  {
            e.printStackTrace();
        }
  }

I had posted a question earlier with a problem reading large files and
from the responses it appears to be the only way.

Thanks,
-Siva


From r_reitzi at cs.uni-kl.de  Tue Jul  1 14:02:57 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Tue, 01 Jul 2008 23:02:57 +0200
Subject: [antlr-interest]
 =?utf-8?q?Access_to_lexer_warning/error_messages?=
 =?utf-8?q?=09after_parsing?=
In-Reply-To: <B44533E2-E621-4753-AE4C-CD4DE0BEF641@gmail.com>
References: <0086AB40-F714-4AC7-BCBE-C2AAA4D6433B@gmail.com>
	<B44533E2-E621-4753-AE4C-CD4DE0BEF641@gmail.com>
Message-ID: <9ba23c8db087d6f83ad8fa411f084675@mail.frhk.de>

Phew, what a discussion.

Personally, I did not intend to remove the current solution. It's perfectly
fine for prototyping, developing and perhaps most console programs. I just
liked to have the _option_ to have something different generated, i.e. an
error collection data structure or setting another stream as error output
target. I, too, feel that saying "I did something like this dozens of
times" strongly supports this point of view. Why do it multiple times (or
have many ANTLR users do it over and over again) if I can create it? 
I'd like to refer to the cite Terence quotes in the prelude of his book
here ;)

You say it's "just overriding one or two methods". Probably right. My
problem with this is, however, that I do not _see_ what I override. The
code is not in the generated classes but in the super classes compiled and
packaged away. So I have to go seperatly downloading ANTLR sources to look
up how errors are handled exactly to build something useful in the end.
Currently, I cannot even rethrow RecognitionException so that it hits my
caller. Worked for appr. two hours on it (stupid me).

Regards

Raphael

On Tue, 1 Jul 2008 21:43:08 +0100, Miguel Marques <mig.marques at gmail.com>
wrote:
> Hy,
> 
> I'm writing an eclipse plugin so I need the errors.
> 
> public void displayRecognitionError(String[] tokenNames,
> 			RecognitionException e){
> 		if(errorHandler!=null){
> 			this.register(errorHandler, e, this.getErrorMessage(e,
> this.getTokenNames()));
> 		} else{
> 			String hdr = getErrorHeader(e);
> 			String msg = getErrorMessage(e, tokenNames);
> 			emitErrorMessage(hdr+" "+msg);
> 
> 		}
> 	}
> 
> I've overriden the displayRecognitionError in both the Parser and
> Lexer classes. My handler does all the work, I register the exception
> that has all the information on the error and then process it.
> 
> miguel
>>
>> On 2008/07/01, at 18:02, Andy Tripp wrote:
>>
>>> Jim,
>>>
>>> As you point out, the default case is that people will want to
>>> process their own error messages,
>>> rather than have ANTLR send them to stderr. So doesn't it make more
>>> sense to
>>> have ANTLR package them into a data structure (which has a
>>> toString() method
>>> which ANTLR calls and sends to stderr? The alternative is that people
>>> have to either parse the error text or look at the ANTLR-generated
>>> code to
>>> understand how to override the default behavior.
>>>
>>> You mention reusing your error handling mechanism across "virtually
>>> all" your
>>> grammars. I think that for almost ANTLR users, the number of lexer/
>>> parsers that they're
>>> going to write is exactly 1. Better to make it as easy as possible
>>> to write that
>>> first grammar and not assume that they're going to be creating more
>>> grammars
>>> anyway. Part of making it easy is to make it possible to build a
>>> lexer/parser
>>> as a "black box", without having to ever look at the ANTLR-
>>> generated code.
>>>
>>> Andy
>>>
>>>
>>> Jim Idle wrote:
>>>> On Tue, 2008-07-01 at 08:54 +0200, Raphael Reitzig wrote:
>>>>> Hi!
>>>>>
>>>>> I second that for I am about to write something quite similar.
>>>>> System.err
>>>>> is no good in a user oriented GUI application.
>>>>>
>>>>> I can think of two possibilties to integrate such behaviour in
>>>>> ANTLR:
>>>>> * grammar option like "warnMode", i.e. with values "console" and
>>>>> "collect".
>>>>> I'd like to have _one_ exceptions thrown if there ocurred any
>>>>> error while
>>>>> parsing.
>>>>> * possibility to set output stream for error messages via grammar
>>>>> option:
>>>>> @errors { System.err } (default)
>>>>> Implementation of either should be no obstacle (*guess*).
>>>> In the case of lexers, it is best to build a lexer that almost
>>>> cannot throw errors as once you lex incorrectly then there isn't
>>>> much you can do. Having rules in the lexer that catch known common
>>>> mistakes and/or catch any character that makes no sense in your
>>>> lexer means that your whole solution will be more robust. For most
>>>> lexers,. just having:
>>>> BADCHAR: . {insert your error code};
>>>> As the last rule will improve things.
>>>> However, in the case of lexer, parser and tree parser it is
>>>> trivial to override the error output method and add your errors to
>>>> collections/a collection. As the standard error messages are
>>>> usually of no use to a real application (and they cannot be, there
>>>> are too many things you might wish to do on error), then you will
>>>> almost certainly want to implement your own error output anyway.
>>>> Just add the message to a collection. I do this with virtually
>>>> every recognizer I write and it takes less time than learning some
>>>> new syntax and access methods for ANTLR (which everyone will then
>>>> complain about because they don't do exactly what they had in
>>>> mind. ;-)
>>>> So, the method that is called has all the information that you
>>>> could need, but YOU have to make it in to a collection, format it
>>>> in a way that makes sense for your application, and present the
>>>> errors to your users. There is no generic solution that would
>>>> provide much more than a different set of questions than there is
>>>> right now. Sure, the errors could all be collected as objects that
>>>> you then iterate, but then there is more code for people to rip
>>>> out when they don't want that!
>>>> Come on guys the error messages are an afternoons coding that you
>>>> can probably reuse on related projects (if they are living in the
>>>> same environment.) I last did this in C# and if it took an hour to
>>>> get it all together I would be surprised. You only need to learn
>>>> the ANTLR bit once.
>>>> Jim
>>>
>>


From antlr at mirality.co.nz  Tue Jul  1 14:13:13 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 02 Jul 2008 09:13:13 +1200
Subject: [antlr-interest] Does ANTLR read the entire file before parsing?
In-Reply-To: <117A6478DABB1D4E9509EA7F413AE789076DB8F2@CTMAIL2.calltower .com>
References: <117A6478DABB1D4E9509EA7F413AE78907567DF3@CTMAIL2.calltower.com>
	<L01SLCSMTP01zzmZ4pV0000a2fd@L01SLCSMTP01.calltower.com>
	<117A6478DABB1D4E9509EA7F413AE789075684FA@CTMAIL2.calltower.com>
	<117A6478DABB1D4E9509EA7F413AE789076DB8F2@CTMAIL2.calltower.com>
Message-ID: <20080701211325.897032F4323@www.antlr.org>

At 08:48 2/07/2008, siva.kumar at loglogic.com wrote:
 >   Just wanted confirmation that ANTLR will generate code that 
will
 >read the entire file before it's passed to the lexer.

The timing is a little different (I think it actually slurps the 
file when the lexer is asked to produce the first token, which is 
when the token stream is created), but essentially yes.


From lgcraymer at yahoo.com  Tue Jul  1 14:21:43 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Tue, 1 Jul 2008 14:21:43 -0700 (PDT)
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
Message-ID: <135438.95447.qm@web55914.mail.re3.yahoo.com>

I think that there is even a good way to do this.? First, adopt the ErrorManager mechanism from the ANTLR 3 source, abstracting a base class and building a tool that maps string templates to error? numbers and generates custom ErrorManagers.? Secondly, add a stringtemplate compiler (StringTemplate is currently limited in its targets); a compiled string template group could be a class that (for?Java)?looks like:
class Foo extends TemplateGroup {
int index;
HashMap<String, Object>?fields;
static HashSet<String>[] legalFields = {?...?}
public Object getAttribute(String name) {
??? if (legalFields[index].contains(name))
???????? return fields.get(name);
?? else
????? // throw exception
?}
public Object setAttribute(String name, Object value) {
???? if (legalFields[index].contains(name)
??????? fields.put(name, value);
??? else
?????? // throw exception
}
// ToString methods; names taken from template defs
protected String foo() {? // example
??? String retval = "text1 " + fields.get("bar").toString() + "text2 ";
??? return retval;
}
toString() {
??? switch (index) {
??????? ...
??? }
}
}
and the source template group would look like
group Foo;
foo(bar) ::= "text1 <bar>text2"
...
There would also have to be some machinery to support context variables (table management not shown), but this is fairly doable in a short amount of time.? I have these on my "to do" list for Yggdrasil.
--Loring



----- Original Message ----
> From: Andy Tripp <antlr at jazillian.com>
> To: Jim Idle <jimi at temporal-wave.com>
> Cc: antlr-interest at antlr.org
> Sent: Tuesday, July 1, 2008 1:25:55 PM
> Subject: Re: [antlr-interest] Access to lexer warning/error messages after parsing
> 
> Jim Idle wrote:
> 
> > No need to go into a long conversations about this, but placing the 
> > messages in a collection would then just hide them away. 
> 
> What's being suggested is to have ANTLR store the error in some data structure,
> then ANTLR can call toString() on that and send to stderr, as it does today.
> ...and then just provide access to the data structure.
> 
> > So, they would 
> > just sit there and the users would not even know there WERE any 
> > messages. So, then you have to supply... errr... a method to print them 
> > out. 
> ANTLR would supply that, as it does today.
> 
> > Then you have to override that method to print them out in the way 
> > you want. 
> 
> Yes, if you want to print it in a different way (unlikely).
> 
> > Then one finds that the information in the collection isn't 
> > quite what you want, 
> 
> Yes, that's always a potential problem.
> 
> > or that most people want the messages to print as 
> > they occur, so now there are two methods that you might need to 
> > override.. So, you are back to square one, or maybe worse. In short, 
> > while I don't think that collection the messages is bad idea at all (I 
> > do it myself), my feeling is that creating the collection would actually 
> > complicate things for new users, not simplify them.
> 
> The choice is between:
> today: getting a message sent to stderr, override ANTLR-generated code if that's 
> not good enough
> proposed: getting a message sent to stderr, having access to the error in
> ? a data structure, override ANTLR-generated code if that's not good enough
> 
> > 
> > At the end of the day though, if that's what most people wanted and Ter 
> > thought it to be a reasonable request, then I certainly would not object 
> > to it.
> > 
> > Jim
> 
> The situation is analogous to Java stack traces.
> At first, the JVM would just spit out the stack trace as text on an exception.
> Now, it does the same thing, but also gives the programmer the ability to
> access the stack trace as a data structure.
> 
> Andy



      


From jimi at temporal-wave.com  Tue Jul  1 14:50:52 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 01 Jul 2008 14:50:52 -0700
Subject: [antlr-interest] Size of generated lexer code
In-Reply-To: <A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
	<1214936416.26777.50.camel@jimi> <002c01c8dba9$4eb48af0$ec1da0d0$@org>
	<A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>
Message-ID: <1214949052.11423.54.camel@jimi>

On Tue, 2008-07-01 at 16:05 -0400, David Goldberg wrote:
> Is it normal for a lexer with approximately 125 tokens to generate a
> C# lexer file of about 7500k? That seems rather large to me. I am
> running ANTLR 3.01


This usually happens because you either specify alts in a rule in a way
that causes huge tables, or you are trying to make the lexer scan for
all sorts of character ranges for naming compliance in variables say.
When the initial set is the entire unicode range, then of course you end
up with huge tables and rulesets.

It is generally a lot easier to accept any old characters for something
liek a variable, then validate them. This way you will also generate a
semantic message such as "Variable xxxxxy cannot use the character y in
its name." instead of the lexer producing errors or a token sequence you
are not expecting. Whether you cna do this depends on what your token
set is of course. Why don't you post your lexer? 

You might also try 3.1beta and see if it makes a difference.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/3f06f447/attachment.html 

From cvrebert at gmail.com  Tue Jul  1 18:26:30 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Tue, 1 Jul 2008 18:26:30 -0700
Subject: [antlr-interest] non-LL(*) error in list rule
Message-ID: <47c890dc0807011826j198ff552j30c81d9e9b6d59f7@mail.gmail.com>

I have a grammar and am getting an error about the rule 'exprlist'
being non-LL(*), even after turning on backtracking as suggested by
the error:


exprlist options {backtrack=true;}: es+=expr? (',' es+=expr)*  -> es;
list: '['! exprlist ']'!;


And suffice it to say that the rule for 'expr' includes some rules
like 'list' as alternatives.
ANTLRWorks' diagram shows red lines indicating (I think) that ANTLR
can't see whether to try and match the first expr or skip past it, but
I don't see how to refactor exprlist to avoid this. I understand
exprlist could recursively call itself through 'expr', but shouldn't
backtracking take care of this?

How do I go about fixing this grammar?

Thanks,
Chris Rebert

From jbb at acm.org  Tue Jul  1 19:16:40 2008
From: jbb at acm.org (John B. Brodie)
Date: Tue, 01 Jul 2008 22:16:40 -0400
Subject: [antlr-interest] non-LL(*) error in list rule
In-Reply-To: <47c890dc0807011826j198ff552j30c81d9e9b6d59f7@mail.gmail.com>
	(cvrebert@gmail.com)
References: <47c890dc0807011826j198ff552j30c81d9e9b6d59f7@mail.gmail.com>
Message-ID: <E1KDrtg-0004xm-RV@gecko.home.org>

Chris Rebert wrote:
>I have a grammar and am getting an error about the rule 'exprlist'
>being non-LL(*), even after turning on backtracking as suggested by
>the error:
>
>exprlist options {backtrack=true;}: es+=expr? (',' es+=expr)*  -> es;
>list: '['! exprlist ']'!;
>
>And suffice it to say that the rule for 'expr' includes some rules
>like 'list' as alternatives.
>...snipped...
>How do I go about fixing this grammar?

It is hard to say without seeing the entire grammar.

exprList can recognize the empty string (because of the ? on the first expr
reference).

rules which can match the empty string are always, in my experience,
problematic.  I always try to hoist the emptyness choice up into parents.

I suspect that somewhere in your grammar there is an instance of exprList
that is followed by some other possibly empty element which causes an
ambiguity regarding which empty element is supposed to be matched.



Or Perhaps Something Else Is Wrong.



anyway, try to find a way to not have any rules that match the empty string.



sorry for not being really very helpful.  perhaps you can post a *MINIMAL*
yet *COMPLETE* grammar that exhibits this same issue for you.  and then we
can go from there?

   -jbb

From cvrebert at gmail.com  Tue Jul  1 19:29:34 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Tue, 1 Jul 2008 19:29:34 -0700
Subject: [antlr-interest] non-LL(*) error in list rule
In-Reply-To: <E1KDrtg-0004xm-RV@gecko.home.org>
References: <47c890dc0807011826j198ff552j30c81d9e9b6d59f7@mail.gmail.com>
	<E1KDrtg-0004xm-RV@gecko.home.org>
Message-ID: <47c890dc0807011929m4f4b15eekfe44d870763baaa0@mail.gmail.com>

Dear John,

Thanks a million!

Hoisting the emptyness choice up into the parent rules appears to have
solved the problem!
If only this had been in the ANTLR book...

Anyway, thanks again.

- Chris

On Tue, Jul 1, 2008 at 7:16 PM, John B. Brodie <jbb at acm.org> wrote:
> Chris Rebert wrote:
>>I have a grammar and am getting an error about the rule 'exprlist'
>>being non-LL(*), even after turning on backtracking as suggested by
>>the error:
>>
>>exprlist options {backtrack=true;}: es+=expr? (',' es+=expr)*  -> es;
>>list: '['! exprlist ']'!;
>>
>>And suffice it to say that the rule for 'expr' includes some rules
>>like 'list' as alternatives.
>>...snipped...
>>How do I go about fixing this grammar?
>
> It is hard to say without seeing the entire grammar.
>
> exprList can recognize the empty string (because of the ? on the first expr
> reference).
>
> rules which can match the empty string are always, in my experience,
> problematic.  I always try to hoist the emptyness choice up into parents.
>
> I suspect that somewhere in your grammar there is an instance of exprList
> that is followed by some other possibly empty element which causes an
> ambiguity regarding which empty element is supposed to be matched.
>
>
>
> Or Perhaps Something Else Is Wrong.
>
>
>
> anyway, try to find a way to not have any rules that match the empty string.
>
>
>
> sorry for not being really very helpful.  perhaps you can post a *MINIMAL*
> yet *COMPLETE* grammar that exhibits this same issue for you.  and then we
> can go from there?
>
>   -jbb
>

From belayda at gmail.com  Tue Jul  1 19:57:15 2008
From: belayda at gmail.com (Bernardo Elayda)
Date: Tue, 1 Jul 2008 19:57:15 -0700
Subject: [antlr-interest] AST rewriting
In-Reply-To: <3e5ed32f0807011445l288dfa00t36f99001adbaec30@mail.gmail.com>
References: <3e5ed32f0807011018x760300bbh1cf93c779ab8f94f@mail.gmail.com>
	<7bd1c1c70807011024v449495and82f294967ac6a94@mail.gmail.com>
	<3e5ed32f0807011445l288dfa00t36f99001adbaec30@mail.gmail.com>
Message-ID: <3e5ed32f0807011957m1c6d4211y690674d5e8c85455@mail.gmail.com>

>def : ^(DEF name expr) -> ^(DEF name $expr.value)
I tried some additional experiments.  I don['t think you can access the
attribute 'value' in the context of a tree rewrite.

I reviewed my own experiements with tree rewriting.  I found one can only
reference tokens and rules(which are trees). I think you'll need to approach
your rewrite in a different direction.

hth,
Bernardo
On Tue, Jul 1, 2008 at 2:45 PM, Bernardo Elayda <belayda at gmail.com> wrote:

> Hmmmm.....
> try this:
> def : ^(DEF name mylabel=expr) -> ^(DEF name $mylabel.token.value)
>
> Sometimes Antler 3.x has trouble figuring out where to get a value.  In
> theory, I agree with your original code that $expr.value should have worked.
> Let me know if it still doesn't work.  I've run into this issue myself, but
> I don't have any of my grammars here.  I'll have to check this later this
> evening.
>
> regards,
> Bernardo
>
>
> On Tue, Jul 1, 2008 at 10:24 AM, Alvaro Egana <alvarorama at gmail.com>
> wrote:
>
>> Bernardo,
>>
>> Thanks for yor quick answer. I did what you said but it didn't work. I
>> get the same error (about the undefined rule 'value').
>>
>> Alvaro
>>
>> 2008/7/1 Bernardo Elayda <belayda at gmail.com>:
>>  > Hi!
>> > Try this instead:
>> >
>> > def : ^(DEF name mylabel=expr) -> ^(DEF name $mylabel.value)
>> >
>> > hth,
>> > Bernardo Elayda
>> >
>> >
>> > ----------------------------
>> > def : ^(DEF name expr)
>> >      ;
>> > name : <<some rules>>;
>> >
>> >
>> > expr  returns [String value]
>> >      : <<some rules>>
>> >      ;
>> >
>> >
>> > I've been trying to do this rewrite:
>> >
>> > def : ^(DEF name expr) -> ^(DEF name $expr.value)
>> >
>> > (I'm writing a name resolver ...)
>> >
>> >
>> >
>> > But antlr complains saying there is a reference to an undefined rule
>> > 'value'.
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080701/b187ccb2/attachment-0001.html 

From sam.ellis at arm.com  Wed Jul  2 00:30:00 2008
From: sam.ellis at arm.com (Sam Ellis)
Date: Wed, 02 Jul 2008 08:30:00 +0100
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <8B58B6C6-68DF-43E0-9F1C-AA0049217CB4@cs.usfca.edu>
Message-ID: <C490ED08.341E4%sam.ellis@arm.com>

On 1/7/08 20:19, "Terence Parr" <parrt at cs.usfca.edu> wrote:
> My intention was that you override one method and do what you want.
> Not sure what else anybody would want. Replace System.err in override
> with errors.add(...) and you're done.  Not sure what the long
> conversation is about.  Can't think of an easier way.

I feel the current approach of the parser writing to stderr does not cleanly
separate out the responsibilities of the objects. The parser is for parsing,
not error reporting :-) I also had the same problem as somebody else, in
that I had to go and examine the antlr sources to work out how to override
the error reporting. Admittedly this was not hard, but gave me the
impression I was needing to know more about the internals of the parser
implementation than I would ideally like.

The approach I used in my grammar was to define an IErrorReporter interface,
and to pass an object that implements this interface to both the lexer and
parser. The parser then calls this interface when an error occurs, and I
have some custom logic in the lexer that checks for illegal chars and
reports these too (but does not throw an exception because I want it to
continue). The same object is also used elsewhere in my code for reporting
other errors. I have an implementation of this interface for reporting to
stderr, and another implementation that stores the errors in a data
structure (ultimately for consumption by Eclipse) and a null implementation
that just throws errors away.


-- 
Sam Ellis, Engineering Manager,
Product Engineering Group,                 Tel: +44 (0) 1223 400516
System Design Division,                    Fax: +44 (0) 1223 400887
ARM Ltd., 110 Fulbourn Road,               skype:armsamellis
Cambridge, CB1 9NJ                         mailto:sam.ellis at arm.com



-- 
IMPORTANT NOTICE: The contents of this email and any attachments are confidential and may also be privileged. If you are not the intended recipient, please notify the sender immediately and do not disclose the contents to any other person, use it for any purpose, or store or copy the information in any medium.  Thank you.



From jens.boeykens at gmail.com  Wed Jul  2 01:17:34 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Wed, 2 Jul 2008 10:17:34 +0200
Subject: [antlr-interest] error in antlrv3.g? missing suffixes in tree
Message-ID: <53c4e43f0807020117h7e877eb2p446ae28c7241c447@mail.gmail.com>

Hi,

I'm on a project where I need to parse grammars. Therefor I use
*antlrv3.g *which
can be fount here:
http://www.antlr.org/grammar/ANTLR/

The problem is this:
consider the example

*grammar T;

a : p+;

*If I parse this grammar I get the following tree:

*(grammar T (RULE a (BLOCK (ALT (BLOCK (ALT p EOA) EOB) EOA) EOB) EOR))

*As you can see there is no '+' in the tree. I need the '+' so I can
regenerate the original grammar.
When using parentheses it works:

*grammar T;

a : (p)+;

(grammar T (RULE a (BLOCK (ALT (+ (BLOCK (ALT p EOA) EOB)) EOA) EOB) EOR))

*Now the '+' has been added to the tree.

My question is: what is to be changed in antlrv3.g so that it also works
with the parentheses?

Thanx!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/829a7cc1/attachment.html 

From alex at thehandofagony.com  Wed Jul  2 02:28:40 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Wed, 2 Jul 2008 11:28:40 +0200
Subject: [antlr-interest] ANTLR C++ target
Message-ID: <200807021128.40476.alex@thehandofagony.com>

Hello,

Is there any info about when the C++ target for ANTLR will be released?
The company I work for is interested in using C++ for ANTLR parsing.  Now I 
know that the C target is C++ compatible, but it would be really helpful to 
have access to ANTLR C++ classes.  :)



Regards,

Alexander N. S?rnes

From wiggjd at bcs.org.uk  Wed Jul  2 02:36:17 2008
From: wiggjd at bcs.org.uk (David Wigg)
Date: Wed, 2 Jul 2008 10:36:17 +0100
Subject: [antlr-interest] Access to ANTLR error/warning messages
Message-ID: <c34954d70807020236q72e72a4v8ac05cb0ea18b53f@mail.gmail.com>

I find it useful to be able to write selected output to a file where it
remains available for reference. Running from a DOS window I can redirect
output to a file. If errors could be directed to stderr and warnings to
stdout, we could choose which to divert to a file using "1>" or "2>" if we
wanted to. As things stand "2>" sends everything, including the ANTLR Parser
Generator heading line, to a file.

The same principle applies to the runtime, I think.

David.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/7501febb/attachment.html 

From pink at odahoda.de  Wed Jul  2 02:44:14 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Wed, 2 Jul 2008 11:44:14 +0200
Subject: [antlr-interest] Found bug on lexer with ANTLR 3.0.1 with
	Python target
In-Reply-To: <op.udnnjjhk03jqhe@cesareprova.org>
References: <op.udnnjjhk03jqhe@cesareprova.org>
Message-ID: <543531490807020244g1394eba7sea6b412e35a1d64c@mail.gmail.com>

Hi Cesare,

[+antlr-interest, as this might be of interest for more people]

I don't think, this is a problem specific to Python.
You define INT as ('0'..'9')*, so an empty token is a valid int.
Technically the behavior is correct, albeit not very useful. The
correct solution would be to emit a warning or even error for tokens
that could match an empty sequence.

The quick fix is to make use ('0'..'9')+ for INT.

-Ben

On Wed, Jul 2, 2008 at 10:07 AM, Cesare Di Mauro
<cesare.dimauro at a-tono.com> wrote:
> Hi
>
> I think I have found a bug which makes lexer rules cause infinite loop.
>
> I have attached files for grammar, test application, and a simple text files that shows the bug (break it quickly with Ctrl-C, because after a few seconds it will hog all available memory).
>
> The text file has a simple line:
>
> TEST;: 12345
>
> which failes when reaching the ";", which is an unknown (to the lexer) character. Removing the ";" (TEST: 12345) the parsing executes correctly.
>
> Tracing with the debugger I found that the problem stays in the generated mTokens method in the lexer:
>
>    def mTokens(self):
>        # D:\\Test\\BadSyntax.g:1:8: ( T8 | ID | INT | NEWLINE | WHITE_SPACE )
>        alt5 = 5
>        LA5 = self.input.LA(1)
>        if LA5 == u':':
>            alt5 = 1
>        elif LA5 == u'A' or LA5 == u'B' or LA5 == u'C' or LA5 == u'D' or LA5 == u'E' or LA5 == u'F' or LA5 == u'G' or LA5 == u'H' or LA5 == u'I' or LA5 == u'J' or LA5 == u'K' or LA5 == u'L' or LA5 == u'M' or LA5 == u'N' or LA5 == u'O' or LA5 == u'P' or LA5 == u'Q' or LA5 == u'R' or LA5 == u'S' or LA5 == u'T' or LA5 == u'U' or LA5 == u'V' or LA5 == u'W' or LA5 == u'X' or LA5 == u'Y' or LA5 == u'Z' or LA5 == u'_' or LA5 == u'a' or LA5 == u'b' or LA5 == u'c' or LA5 == u'd' or LA5 == u'e' or LA5 == u'f' or LA5 == u'g' or LA5 == u'h' or LA5 == u'i' or LA5 == u'j' or LA5 == u'k' or LA5 == u'l' or LA5 == u'm' or LA5 == u'n' or LA5 == u'o' or LA5 == u'p' or LA5 == u'q' or LA5 == u'r' or LA5 == u's' or LA5 == u't' or LA5 == u'u' or LA5 == u'v' or LA5 == u'w' or LA5 == u'x' or LA5 == u'y' or LA5 == u'z':
>            alt5 = 2
>        elif LA5 == u'\n' or LA5 == u'\r':
>            alt5 = 4
>        elif LA5 == u'\t' or LA5 == u' ':
>            alt5 = 5
>        else:
>            alt5 = 3
>        if alt5 == 1:
>            # D:\\Test\\BadSyntax.g:1:10: T8
>            self.mT8()
>
>
>
>        elif alt5 == 2:
>            # D:\\Test\\BadSyntax.g:1:13: ID
>            self.mID()
>
>
>
>        elif alt5 == 3:
>            # D:\\Test\\BadSyntax.g:1:16: INT
>            self.mINT()
>
>
>
>        elif alt5 == 4:
>            # D:\\Test\\BadSyntax.g:1:20: NEWLINE
>            self.mNEWLINE()
>
>
>
>        elif alt5 == 5:
>            # D:\\Test\\BadSyntax.g:1:28: WHITE_SPACE
>            self.mWHITE_SPACE()
>
>
> After checking for the tab char and failed, the code executes the following else statement:
>
> else:
>            alt5 = 3
>
> which assumes that we have found (the beginning of) an INT token, so the lexer goes into an infinite loop.
> That's because an "empty" token (a token with the text attribute set to an empty string) will be generated, bug the ";" character will not be consumed, so the next time that fillbuffer() invokes mTokens(), the same pattern will be repeated, generating an unlimited growing of token list.
>
> Is it any way to fix this problem?
>
> Thanks in advance
>
> Cesare
>
> --
> Dott. Cesare Di Mauro
> A-Tono S.r.l.
> T.: (+39)095-7365314
> Information in this email is confidential and may be privileged. It is intended for the addresses only.
> If you have received it in error, please notify the sender immediately and delete it from your system. You should not otherwise copy it, retransmit it or use or disclose its content to anyone.
> Thank you for your co-operation.

From iwm at doc.ic.ac.uk  Wed Jul  2 02:53:58 2008
From: iwm at doc.ic.ac.uk (Ian Moor)
Date: Wed, 2 Jul 2008 10:53:58 +0100 (BST)
Subject: [antlr-interest] Access to lexer warning/error messages after
 parsing
Message-ID: <27944981.831214992438083.JavaMail.ICEMail@snegopad>

>My intention was that you override one method and do what you want.   
>Not sure what else anybody would want. Replace System.err in override  
>with errors.add(...) and you're done.  Not sure what the long  
>conversation is about.  Can't think of an easier way.
>
>Ter

I would use the java logger, or if the compiler has to
run on java 1.3 or  earlier log4j, rather than write my own code 
       Ian W Moor              Department of Computing,
iwm at doc.ic.ac.uk           Imperial College.
                                    180 Queensgate
                                     London SW7 2AZ UK.
 


From jaluber at gmx.de  Wed Jul  2 03:18:07 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 02 Jul 2008 12:18:07 +0200
Subject: [antlr-interest] Size of generated lexer code
In-Reply-To: <A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>	<1a92904d9130f0673605df7c51603394@mail.frhk.de>	<486A4F62.3030905@jazillian.com>	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>	<1214936416.26777.50.camel@jimi>
	<002c01c8dba9$4eb48af0$ec1da0d0$@org>
	<A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>
Message-ID: <486B55DF.1090601@gmx.de>

David Goldberg schrieb:
> Is it normal for a lexer with approximately 125 tokens to generate a C# 
> lexer file of about 7500k? That seems rather large to me. I am running 
> ANTLR 3.01

3.1b1 supports RLE so files are generally smaller. The CSharp target has 
a bug in the support code, though, thus you have to use CSharp2 until 
the next beta comes out. But switching to CSharp2 is a good idea anyway 
- see the wiki page.

Johannes

From nelson.ana at gmail.com  Wed Jul  2 03:18:09 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Wed, 2 Jul 2008 11:18:09 +0100
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <27944981.831214992438083.JavaMail.ICEMail@snegopad>
References: <27944981.831214992438083.JavaMail.ICEMail@snegopad>
Message-ID: <a7d6d2740807020318p336e4adodc80d878acf09f86@mail.gmail.com>

I think this topic calls for a Wiki page.

:-)

(No, sorry, I'm not volunteering, but I will add my workaround to it
if anyone's interested.)




2008/7/2 Ian Moor <iwm at doc.ic.ac.uk>:
>>My intention was that you override one method and do what you want.
>>Not sure what else anybody would want. Replace System.err in override
>>with errors.add(...) and you're done.  Not sure what the long
>>conversation is about.  Can't think of an easier way.
>>
>>Ter
>
> I would use the java logger, or if the compiler has to
> run on java 1.3 or  earlier log4j, rather than write my own code
>       Ian W Moor              Department of Computing,
> iwm at doc.ic.ac.uk           Imperial College.
>                                    180 Queensgate
>                                     London SW7 2AZ UK.
>
>
>

From atlan at gmx.li  Wed Jul  2 07:26:03 2008
From: atlan at gmx.li (Marc Bischof)
Date: Wed, 2 Jul 2008 16:26:03 +0200
Subject: [antlr-interest] similar constructs using '['  ']'
Message-ID: <200807021626.03238.atlan@gmx.li>

Hej List,

I'am confused about the following, may be you can give me a hint.

I have two similar constructs using '['  ']'.
One which represents an extended expression (using nongreedy wildcard) and one 
which contain some other stuff.

Now every time I want to use the sequence rule the EXT_EXPR is invoked.
Is it possible to keep that modelling?

sequence 
	:	('[' j+=join? s+=signal* ']')? b=body  ;

join
	:	'join' '(' k+=ID (',' k+=ID)* (',' expr)? ')' -> ^(JOIN $k+ expr?);

expr	
	:	s_expr | EXT_EXPR | funct_call;

EXT_EXPR
	:	'[' (options {greedy=false;} : .)* ']';

Cheers Marc

From jimi at temporal-wave.com  Wed Jul  2 07:50:00 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 02 Jul 2008 07:50:00 -0700
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <200807021128.40476.alex@thehandofagony.com>
References: <200807021128.40476.alex@thehandofagony.com>
Message-ID: <1215010200.5833.38.camel@jimi>

On Wed, 2008-07-02 at 11:28 +0200, Alexander Nicolaysen S?rnes wrote:

> Hello,
> 
> Is there any info about when the C++ target for ANTLR will be released?
> The company I work for is interested in using C++ for ANTLR parsing.  Now I 
> know that the C target is C++ compatible, but it would be really helpful to 
> have access to ANTLR C++ classes.  :)


I am going to look properly at a pure C++ approach after we release 3.1
(shortly hopefully, it is all  waiting on me ;-). Though I am still
unsure what this would give anyone over having some C++ facades for the
C runtime. Though, in theory, it should be no slower and not using
pointers to functions might make the optimizer more effective. For this
reason I am also contemplating one (or more) C-lite runtimes, as many
people don't need to override anything but the error message handling.


Jim

> 
> 
> 
> Regards,
> 
> Alexander N. S?rnes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/be44d58c/attachment-0001.html 

From jimi at temporal-wave.com  Wed Jul  2 07:52:52 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 02 Jul 2008 07:52:52 -0700
Subject: [antlr-interest] Found bug on lexer with ANTLR 3.0.1
	with	Python target
In-Reply-To: <543531490807020244g1394eba7sea6b412e35a1d64c@mail.gmail.com>
References: <op.udnnjjhk03jqhe@cesareprova.org>
	<543531490807020244g1394eba7sea6b412e35a1d64c@mail.gmail.com>
Message-ID: <1215010372.5833.42.camel@jimi>

On Wed, 2008-07-02 at 11:44 +0200, Benjamin Niemann wrote:

> Hi Cesare,
> 
> [+antlr-interest, as this might be of interest for more people]
> 
> I don't think, this is a problem specific to Python.
> You define INT as ('0'..'9')*, so an empty token is a valid int.


This is not a bug - defining an empty lexer token is not a valid thing
to do.


> Technically the behavior is correct, albeit not very useful. The
> correct solution would be to emit a warning or even error for tokens
> that could match an empty sequence.



I agree that an empty token definition should issue an error - it seems a lot of people fall over this inadvertently. 

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/ff8a1fbc/attachment.html 

From sumanto at gmail.com  Wed Jul  2 08:01:42 2008
From: sumanto at gmail.com (Sumanto Biswas)
Date: Wed, 2 Jul 2008 08:01:42 -0700
Subject: [antlr-interest] Lexer options question and debugging suggestion
Message-ID: <6c9aae640807020801v73cdc955h51cf9cb6fbd3a300@mail.gmail.com>

Hi,

I have an question related to antlr options: If I have an combined
grammar, can I separate lexer and parser options? Currently the
options on top of grammar file file seem to apply for parser only and
if I give a lexer specific option it complains. It would be nice if we
can have some sort of lexer::options.

Also, my understanding is that antlr is used as a tool to solve
problem, many times inside other applications. It would be great if we
could have an option to dynamically set debug mode. That ways, I can
just say lexer.setDebug(boolean), parser.setDebug(boolean) and I would
get debugging information.

Examples of some debugging:
1. Logging inside mTokens() in lexer for each input and its
corresponding token no (and name if possible).
2. Trace of parser decisions.

I am sure there would be more places where this can be implemented.
Just a suggestion to make antlr more useful - that ways I can just set
an option, maybe through a backdoor and get all debugging information,
and then unset to get normal behavior.

Regards,
Sumanto

From pink at odahoda.de  Wed Jul  2 10:02:44 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Wed, 2 Jul 2008 19:02:44 +0200
Subject: [antlr-interest] Found bug on @header with ANTLR 3.0.1 with
	Python target
In-Reply-To: <op.udn1jso503jqhe@cesareprova.org>
References: <op.udnnjjhk03jqhe@cesareprova.org>
	<543531490807020244g1394eba7sea6b412e35a1d64c@mail.gmail.com>
	<op.udn1jso503jqhe@cesareprova.org>
Message-ID: <543531490807021002v1382c22ei3d612ead759b69a3@mail.gmail.com>

Hi Cesare,

On Wed, Jul 2, 2008 at 3:10 PM, Cesare Di Mauro
<cesare.dimauro at a-tono.com> wrote:
> Thank you very much for your help.
>
> I found another bug (I hope it's a real bug this time! :)) on the @header instruction.
>
> If I put this:
>
> @header {import antlr3

Can you insert a linebreak in front of the import? I'm not sure about
the semantics from the top of my head, but it might be that it treats
the import as indented by 9 characters, so the rest of the section has
'negative' indention.

-Ben

> from BadSyntaxLexer import BadSyntaxLexer
>
> class TParser(object):
>
>  def LoadSyntax(self, TextSyntax):
>
>    self.TextSyntax = TextSyntax
>    CharStream = antlr3.FileStream(TextSyntax)
>    Lexer = BadSyntaxLexer(CharStream)
>    TokenStream = antlr3.CommonTokenStream(Lexer)
>    self.Parser = BadSyntaxParser(TokenStream)
>    self.Parser.services()}
>
> on the grammar file, the parser file will have a completely removed indentation:
>
> from antlr3 import *
> from antlr3.compat import set, frozenset
> import antlr3
> from BadSyntaxLexer import BadSyntaxLexer
>
> class TParser(object):
>
> def LoadSyntax(self, TextSyntax):
>
> self.TextSyntax = TextSyntax
> CharStream = antlr3.FileStream(TextSyntax)
> Lexer = BadSyntaxLexer(CharStream)
> TokenStream = antlr3.CommonTokenStream(Lexer)
> self.Parser = BadSyntaxParser(TokenStream)
> self.Parser.services()
>
>
> generating a Python syntax error:
>
> D:\Test>python BadSyntaxTest.py
> Traceback (most recent call last):
>  File "BadSyntaxTest.py", line 3, in <module>
>    import BadSyntaxParser
>  File "D:\Test\BadSyntaxParser.py", line 10
>    def LoadSyntax(self, TextSyntax):
>      ^
> IndentationError: expected an indented block
>
>
> ANTLR states that @header statement can be used to put imports or function / classes at the beginning of file, but for Python its useless (except for imports) if the indentation is removed.
>
> Cesare
>
> In data 02 luglio 2008 alle ore 11:44:14, Benjamin Niemann <pink at odahoda.de> ha scritto:
>
>> Hi Cesare,
>>
>> [+antlr-interest, as this might be of interest for more people]
>>
>> I don't think, this is a problem specific to Python.
>> You define INT as ('0'..'9')*, so an empty token is a valid int.
>> Technically the behavior is correct, albeit not very useful. The
>> correct solution would be to emit a warning or even error for tokens
>> that could match an empty sequence.
>>
>> The quick fix is to make use ('0'..'9')+ for INT.
>>
>> -Ben
>
> --
> Dott. Cesare Di Mauro
> A-Tono S.r.l.
> T.: (+39)095-7365314
> Information in this email is confidential and may be privileged. It is intended for the addresses only.
> If you have received it in error, please notify the sender immediately and delete it from your system. You should not otherwise copy it, retransmit it or use or disclose its content to anyone.
> Thank you for your co-operation.
>

From parrt at cs.usfca.edu  Wed Jul  2 10:21:28 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 2 Jul 2008 10:21:28 -0700
Subject: [antlr-interest] error in antlrv3.g? missing suffixes in tree
In-Reply-To: <53c4e43f0807020117h7e877eb2p446ae28c7241c447@mail.gmail.com>
References: <53c4e43f0807020117h7e877eb2p446ae28c7241c447@mail.gmail.com>
Message-ID: <6ABF962E-7C15-4F03-8BB8-4A6B74A3AB59@cs.usfca.edu>

thereAre indeed some issues without as I have not done anything but an  
initial work on that. I have some graduate students that are looking  
into this as they build another project.
Ter
On Jul 2, 2008, at 1:17 AM, Jens Boeykens wrote:

> Hi,
>
> I'm on a project where I need to parse grammars. Therefor I use  
> antlrv3.g which can be fount here:
> http://www.antlr.org/grammar/ANTLR/
>
> The problem is this:
> consider the example
>
> grammar T;
>
> a : p+;
>
> If I parse this grammar I get the following tree:
>
> (grammar T (RULE a (BLOCK (ALT (BLOCK (ALT p EOA) EOB) EOA) EOB) EOR))
>
> As you can see there is no '+' in the tree. I need the '+' so I can  
> regenerate the original grammar.
> When using parentheses it works:
>
> grammar T;
>
> a : (p)+;
>
> (grammar T (RULE a (BLOCK (ALT (+ (BLOCK (ALT p EOA) EOB)) EOA) EOB)  
> EOR))
>
> Now the '+' has been added to the tree.
>
> My question is: what is to be changed in antlrv3.g so that it also  
> works with the parentheses?
>
> Thanx!


From parrt at cs.usfca.edu  Wed Jul  2 10:22:13 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 2 Jul 2008 10:22:13 -0700
Subject: [antlr-interest] Found bug on lexer with ANTLR 3.0.1
	with	Python target
In-Reply-To: <1215010372.5833.42.camel@jimi>
References: <op.udnnjjhk03jqhe@cesareprova.org>
	<543531490807020244g1394eba7sea6b412e35a1d64c@mail.gmail.com>
	<1215010372.5833.42.camel@jimi>
Message-ID: <015AD81F-8E29-4759-AA0F-E0D9345A2CDC@cs.usfca.edu>

IBelieve I have already had a bug about this.
Ter
On Jul 2, 2008, at 7:52 AM, Jim Idle wrote:

> On Wed, 2008-07-02 at 11:44 +0200, Benjamin Niemann wrote:
>>
>> Hi Cesare,
>>
>> [+antlr-interest, as this might be of interest for more people]
>>
>> I don't think, this is a problem specific to Python.
>> You define INT as ('0'..'9')*, so an empty token is a valid int.
>
> This is not a bug - defining an empty lexer token is not a valid  
> thing to do.
>
>> Technically the behavior is correct, albeit not very useful. The
>> correct solution would be to emit a warning or even error for tokens
>> that could match an empty sequence.
>
> I agree that an empty token definition should issue an error - it  
> seems a lot of people fall over this inadvertently.
>
> Jim


From parrt at cs.usfca.edu  Wed Jul  2 10:31:49 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 2 Jul 2008 10:31:49 -0700
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <a7d6d2740807020318p336e4adodc80d878acf09f86@mail.gmail.com>
References: <27944981.831214992438083.JavaMail.ICEMail@snegopad>
	<a7d6d2740807020318p336e4adodc80d878acf09f86@mail.gmail.com>
Message-ID: <7F499F5E-E84B-42B6-A5F2-6098DEF686B9@cs.usfca.edu>

howdy!

p237 of TDAR: "To get these rich error messages,  override two methods  
from BaseRecognizer, displayRecognitionError() and  
getTokenErrorDisplay(), ..."

That pretty much says what you need to override to completely change  
how errors are displayed. If you don't care about the message, just  
where it goes, then simply override the display method. Making it safe  
instead of printing is the only hook I can imagine a computer  
scientist needing to do anything they want.

print vs add. do we really need a listener for this? ANTLR itself has  
a listener for errors and I suppose there could be one for the  
recognizers themselves, but I am not sure it is worth the extra  
complexity.

Ter

On Jul 2, 2008, at 3:18 AM, Ana Nelson wrote:

> I think this topic calls for a Wiki page.
>
> :-)
>
> (No, sorry, I'm not volunteering, but I will add my workaround to it
> if anyone's interested.)
>
>
>
>
> 2008/7/2 Ian Moor <iwm at doc.ic.ac.uk>:
>>> My intention was that you override one method and do what you want.
>>> Not sure what else anybody would want. Replace System.err in  
>>> override
>>> with errors.add(...) and you're done.  Not sure what the long
>>> conversation is about.  Can't think of an easier way.
>>>
>>> Ter
>>
>> I would use the java logger, or if the compiler has to
>> run on java 1.3 or  earlier log4j, rather than write my own code
>>      Ian W Moor              Department of Computing,
>> iwm at doc.ic.ac.uk           Imperial College.
>>                                   180 Queensgate
>>                                    London SW7 2AZ UK.
>>
>>
>>


From sumanto at gmail.com  Wed Jul  2 10:53:07 2008
From: sumanto at gmail.com (Sumanto Biswas)
Date: Wed, 2 Jul 2008 10:53:07 -0700
Subject: [antlr-interest] gUnit: Some suggestions
Message-ID: <6c9aae640807021053p3944b01ek5c52304e3973c364@mail.gmail.com>

Hi,

I have been using gUnit 1.0.2 with antlr 3.1b1 and it has helped me in
automating test cases, specially positive ones a lot. Thanks for
developing a unit test framework for antlr !!

I have a few suggestions:
1. Add debug option which when set can print some debug info, like:
   > Start/End execution of each test case with i/p string, rule name etc,
   > Lexer and parser classes being used.
2. Should not exit on InvocationTargetException. Presently code does
"System.setErr(consoleErr); e.printStackTrace(); System.exit(1);".
Since I have set test-case to FAIL anyways, and the exception wraps
MismatchedTokenException, I would want to continue with test case
processing. Stack trace pasted below for reference.
3. Ability to check and match for Exception and messages. e.g. '"a = 4
+- 5" FAIL::Exception::message

Regards,
Sumanto

--------------------------------------------------------------------------
java.lang.reflect.InvocationTargetException
	at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.antlr.gunit.gUnitExecuter.runParser(gUnitExecuter.java:239)
	at org.antlr.gunit.gUnitExecuter.runCorrectParser(gUnitExecuter.java:131)
	at org.antlr.gunit.gUnitExecuter.executeTests(gUnitExecuter.java:149)
	at org.antlr.gunit.gUnitExecuter.execTest(gUnitExecuter.java:96)
	at org.antlr.gunit.Interp.main(Interp.java:62)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:90)
Caused by: MismatchedTokenException(-1!=27)
	at org.antlr.runtime.BaseRecognizer.recoverFromMismatchedToken(BaseRecognizer.java:630)
	at org.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:117)
	at soslParser.searchSpec(soslParser.java:933)
	at soslParser.sosl(soslParser.java:298)
	... 13 more
--------------------------------------------------------------------------

From vbar at comp.cz  Wed Jul  2 11:10:01 2008
From: vbar at comp.cz (Vaclav Barta)
Date: Wed, 2 Jul 2008 20:10:01 +0200
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <1215010200.5833.38.camel@jimi>
References: <200807021128.40476.alex@thehandofagony.com>
	<1215010200.5833.38.camel@jimi>
Message-ID: <200807022010.01140.vbar@comp.cz>

On Wednesday 02 July 2008 16:50:00 Jim Idle wrote:
> I am going to look properly at a pure C++ approach after we release 3.1
> (shortly hopefully, it is all  waiting on me ;-). Though I am still
> unsure what this would give anyone over having some C++ facades for the
Exceptions?

	Bye
		Vasek

From david at gohazel.com  Wed Jul  2 11:19:00 2008
From: david at gohazel.com (David Goldberg)
Date: Wed, 2 Jul 2008 14:19:00 -0400
Subject: [antlr-interest] Size of generated lexer code
In-Reply-To: <1214949052.11423.54.camel@jimi>
References: <6c9aae640806301525n5dbfd366l6305de1b1dc3f32c@mail.gmail.com>
	<1a92904d9130f0673605df7c51603394@mail.frhk.de>
	<486A4F62.3030905@jazillian.com>
	<FF993752CB890B4EB591BE5450C37BF1012D7A65@navamane001.ad.internal.corp>
	<1214936416.26777.50.camel@jimi> <002c01c8dba9$4eb48af0$ec1da0d0$@org>
	<A23D2A4BF1A7B149B6D47EED157BFF8F01DDDE34F6@MAIL30.thoughtbus.com>
	<1214949052.11423.54.camel@jimi>
Message-ID: <A23D2A4BF1A7B149B6D47EED157BFF8F032292147C@MAIL30.thoughtbus.com>

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle

This usually happens because you either specify alts in a rule in a way that causes huge tables, or you are trying to make the lexer scan for all sorts of character ranges for naming compliance in variables say. When the initial set is the entire unicode range, then of course you end up with huge tables and rulesets.

It is generally a lot easier to accept any old characters for something liek a variable, then validate them. This way you will also generate a semantic message such as "Variable xxxxxy cannot use the character y in its name." instead of the lexer producing errors or a token sequence you are not expecting. Whether you cna do this depends on what your token set is of course. Why don't you post your lexer?

You might also try 3.1beta and see if it makes a difference.



Your suggestion about name compliance in variables seems to have done it. I commented out the Lexer rules below and the generated file shrunk from 7000k to 1500k. I assume if I make the middle part less complicated I could probably save a lot of space and then manually check as you suggest.

//IDENTIFIER
//            :               LETTER ((LETTER | IDDIGIT | '-')* (LETTER | IDDIGIT))? ('?' | '!' | '%' | '@' | '^' )?
//            ;

/*
fragment
LETTER :               '\u0024' |
       '\u0041'..'\u005a' |
       '\u005f' |
       '\u0061'..'\u007a' |
       '\u00c0'..'\u00d6' |
       '\u00d8'..'\u00f6' |
       '\u00f8'..'\u00ff' |
       '\u0100'..'\u1fff' |
       '\u3040'..'\u318f' |
       '\u3300'..'\u337f' |
       '\u3400'..'\u3d2d' |
       '\u4e00'..'\u9fff' |
       '\uf900'..'\ufaff'
    ;
fragment
IDDIGIT
    :  '\u0030'..'\u0039' |
       '\u0660'..'\u0669' |
       '\u06f0'..'\u06f9' |
       '\u0966'..'\u096f' |
       '\u09e6'..'\u09ef' |
       '\u0a66'..'\u0a6f' |
       '\u0ae6'..'\u0aef' |
       '\u0b66'..'\u0b6f' |
       '\u0be7'..'\u0bef' |
       '\u0c66'..'\u0c6f' |
       '\u0ce6'..'\u0cef' |
       '\u0d66'..'\u0d6f' |
       '\u0e50'..'\u0e59' |
       '\u0ed0'..'\u0ed9' |
       '\u1040'..'\u1049'
   ;
*/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/981fa3ea/attachment-0001.html 

From leon.antlr at mac.com  Wed Jul  2 11:34:18 2008
From: leon.antlr at mac.com (Leon Su)
Date: Wed, 02 Jul 2008 11:34:18 -0700
Subject: [antlr-interest] gUnit: Some suggestions
In-Reply-To: <6c9aae640807021053p3944b01ek5c52304e3973c364@mail.gmail.com>
References: <6c9aae640807021053p3944b01ek5c52304e3973c364@mail.gmail.com>
Message-ID: <0855E4BD-AE30-4BDB-AE1F-F9298BFA6562@mac.com>

Hi Sumanto,

Thanks for the suggestions. Good points for my development of the  
next version.
About the number 2, I also noticed the same issue from a user's  
response. I fixed
it on the 1.0.1, and will update 1.0.2 soon :)

Leon

On Jul 2, 2008, at 10:53 AM, Sumanto Biswas wrote:

> Hi,
>
> I have been using gUnit 1.0.2 with antlr 3.1b1 and it has helped me in
> automating test cases, specially positive ones a lot. Thanks for
> developing a unit test framework for antlr !!
>
> I have a few suggestions:
> 1. Add debug option which when set can print some debug info, like:
>> Start/End execution of each test case with i/p string, rule name etc,
>> Lexer and parser classes being used.
> 2. Should not exit on InvocationTargetException. Presently code does
> "System.setErr(consoleErr); e.printStackTrace(); System.exit(1);".
> Since I have set test-case to FAIL anyways, and the exception wraps
> MismatchedTokenException, I would want to continue with test case
> processing. Stack trace pasted below for reference.
> 3. Ability to check and match for Exception and messages. e.g. '"a = 4
> +- 5" FAIL::Exception::message
>
> Regards,
> Sumanto
>
> ---------------------------------------------------------------------- 
> ----
> java.lang.reflect.InvocationTargetException
> 	at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
> 	at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
> 	at java.lang.reflect.Method.invoke(Method.java:597)
> 	at org.antlr.gunit.gUnitExecuter.runParser(gUnitExecuter.java:239)
> 	at org.antlr.gunit.gUnitExecuter.runCorrectParser 
> (gUnitExecuter.java:131)
> 	at org.antlr.gunit.gUnitExecuter.executeTests(gUnitExecuter.java:149)
> 	at org.antlr.gunit.gUnitExecuter.execTest(gUnitExecuter.java:96)
> 	at org.antlr.gunit.Interp.main(Interp.java:62)
> 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> 	at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
> 	at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
> 	at java.lang.reflect.Method.invoke(Method.java:597)
> 	at com.intellij.rt.execution.application.AppMain.main(AppMain.java: 
> 90)
> Caused by: MismatchedTokenException(-1!=27)
> 	at org.antlr.runtime.BaseRecognizer.recoverFromMismatchedToken 
> (BaseRecognizer.java:630)
> 	at org.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:117)
> 	at soslParser.searchSpec(soslParser.java:933)
> 	at soslParser.sosl(soslParser.java:298)
> 	... 13 more
> ---------------------------------------------------------------------- 
> ----


From gikas.gikas at gmail.com  Wed Jul  2 12:09:29 2008
From: gikas.gikas at gmail.com (Gikas Gikas)
Date: Wed, 02 Jul 2008 15:09:29 -0400
Subject: [antlr-interest] Static initializer is exceeding the 65535 bytes
 limit in the generated parser
Message-ID: <C4914AA9.2E1C%gikas.gikas@gmail.com>

HI,

Anyone else has seen this?
It  happens with a 3.1b2. The same grammar with 3.0.1 works fine.

The grammar has about 800 keywords and is very ambiguous.  It seems that
most of the static code in the parser is DFA-related. Is there any option to
control the generated DFA code?

Would adding disambiguating semantic predicates in the grammar solve this
problem?

Regards,
Gikas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/7ecafffd/attachment.html 

From antlr at mirality.co.nz  Wed Jul  2 14:06:26 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 03 Jul 2008 09:06:26 +1200
Subject: [antlr-interest] AST rewriting
In-Reply-To: <3e5ed32f0807011957m1c6d4211y690674d5e8c85455@mail.gmail.co
 m>
References: <3e5ed32f0807011018x760300bbh1cf93c779ab8f94f@mail.gmail.com>
	<7bd1c1c70807011024v449495and82f294967ac6a94@mail.gmail.com>
	<3e5ed32f0807011445l288dfa00t36f99001adbaec30@mail.gmail.com>
	<3e5ed32f0807011957m1c6d4211y690674d5e8c85455@mail.gmail.com>
Message-ID: <20080702210640.D1384312961@www.antlr.org>

At 14:57 2/07/2008, Bernardo Elayda wrote:
> >def : ^(DEF name expr) -> ^(DEF name $expr.value)
>I tried some additional experiments.  I don['t think you can 
>access the attribute 'value' in the context of a tree rewrite.

Have you tried this:

def : ^(DEF name expr) -> ^(DEF name {$expr.value}) ;

(Not sure if that's right either, but I have seen some examples 
using something similar.)

Having said that, AST nodes can usually only be tokens -- you 
can't add a raw string to it.  So you'll probably need to do 
something like this instead:

def : ^(DEF name expr) -> ^(DEF name STRING[$expr.value]) ;

(Not entirely sure about that syntax, but it's something like 
that.)


From antlr at mirality.co.nz  Wed Jul  2 14:12:33 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 03 Jul 2008 09:12:33 +1200
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <200807022010.01140.vbar@comp.cz>
References: <200807021128.40476.alex@thehandofagony.com>
	<1215010200.5833.38.camel@jimi> <200807022010.01140.vbar@comp.cz>
Message-ID: <20080702211243.3B12D312961@www.antlr.org>

At 06:10 3/07/2008, Vaclav Barta wrote:
 >On Wednesday 02 July 2008 16:50:00 Jim Idle wrote:
 >> I am going to look properly at a pure C++ approach after we
 >> release 3.1 (shortly hopefully, it is all  waiting on me ;-).
 >> Though I am still unsure what this would give anyone over
 >> having some C++ facades for the
 >
 >Exceptions?

C++ exceptions aren't as useful as Java/C# ones, since you don't 
get a stack trace :(


From antlr at mirality.co.nz  Wed Jul  2 14:15:17 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 03 Jul 2008 09:15:17 +1200
Subject: [antlr-interest] Access to lexer warning/error messages after
 parsing
In-Reply-To: <C490ED08.341E4%sam.ellis@arm.com>
References: <8B58B6C6-68DF-43E0-9F1C-AA0049217CB4@cs.usfca.edu>
	<C490ED08.341E4%sam.ellis@arm.com>
Message-ID: <20080702211526.6000A11ED71@www.antlr.org>

At 19:30 2/07/2008, Sam Ellis wrote:
 >The approach I used in my grammar was to define an 
IErrorReporter
 >interface, and to pass an object that implements this interface
 >to both the lexer and parser. The parser then calls this 
interface
 >when an error occurs, and I have some custom logic in the lexer
 >that checks for illegal chars and reports these too (but does 
not
 >throw an exception because I want it to continue). The same 
object
 >is also used elsewhere in my code for reporting other errors. I
 >have an implementation of this interface for reporting to 
stderr,
 >and another implementation that stores the errors in a data
 >structure (ultimately for consumption by Eclipse) and a null
 >implementation that just throws errors away.

Sounds good to me.  The Strategy pattern is usually a good choice 
for implementing pluggable functionality :)

Any chance you could Wiki your solution for others to use?  And 
maybe even get it incorporated into a future version of the 
runtime?


From belayda at gmail.com  Wed Jul  2 14:29:11 2008
From: belayda at gmail.com (Bernardo Elayda)
Date: Wed, 2 Jul 2008 14:29:11 -0700
Subject: [antlr-interest] AST rewriting
In-Reply-To: <486bede0.30e1220a.4a8c.ffffddb9SMTPIN_ADDED@mx.google.com>
References: <3e5ed32f0807011018x760300bbh1cf93c779ab8f94f@mail.gmail.com>
	<7bd1c1c70807011024v449495and82f294967ac6a94@mail.gmail.com>
	<3e5ed32f0807011445l288dfa00t36f99001adbaec30@mail.gmail.com>
	<3e5ed32f0807011957m1c6d4211y690674d5e8c85455@mail.gmail.com>
	<486bede0.30e1220a.4a8c.ffffddb9SMTPIN_ADDED@mx.google.com>
Message-ID: <3e5ed32f0807021429o4787104awfc537580c0053064@mail.gmail.com>

that has been my experience as well with tree rule rewrites.
the re-written node must be composed of pre-existing rule reference(no
parameters) or the construction of a new token.

-Bernardo


On Wed, Jul 2, 2008 at 2:06 PM, Gavin Lambert <antlr at mirality.co.nz> wrote:

> At 14:57 2/07/2008, Bernardo Elayda wrote:
>
>> >def : ^(DEF name expr) -> ^(DEF name $expr.value)
>> I tried some additional experiments.  I don['t think you can access the
>> attribute 'value' in the context of a tree rewrite.
>>
>
> Have you tried this:
>
> def : ^(DEF name expr) -> ^(DEF name {$expr.value}) ;
>
> (Not sure if that's right either, but I have seen some examples using
> something similar.)
>
> Having said that, AST nodes can usually only be tokens -- you can't add a
> raw string to it.  So you'll probably need to do something like this
> instead:
>
> def : ^(DEF name expr) -> ^(DEF name STRING[$expr.value]) ;
>
> (Not entirely sure about that syntax, but it's something like that.)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080702/8db23006/attachment.html 

From aegana at noao.edu  Wed Jul  2 14:43:50 2008
From: aegana at noao.edu (Alvaro Egana)
Date: Wed, 2 Jul 2008 17:43:50 -0400
Subject: [antlr-interest] AST rewriting
In-Reply-To: <486bede0.30e1220a.4a8c.ffffddb9SMTPIN_ADDED@mx.google.com>
References: <3e5ed32f0807011018x760300bbh1cf93c779ab8f94f@mail.gmail.com>
	<7bd1c1c70807011024v449495and82f294967ac6a94@mail.gmail.com>
	<3e5ed32f0807011445l288dfa00t36f99001adbaec30@mail.gmail.com>
	<3e5ed32f0807011957m1c6d4211y690674d5e8c85455@mail.gmail.com>
	<486bede0.30e1220a.4a8c.ffffddb9SMTPIN_ADDED@mx.google.com>
Message-ID: <7bd1c1c70807021443ka8f51a1q6ca706d9eb546a6c@mail.gmail.com>

> def : ^(DEF name expr) -> ^(DEF name STRING[$expr.value]) ;
>
> (Not entirely sure about that syntax, but it's something like that.)

Gavin,

This is exactly what I needed!!! (and it's nicely working with that syntax, :)).

Thanks Gavin (and Bernardo) for your great help.

Alvaro

From vbar at comp.cz  Wed Jul  2 14:51:37 2008
From: vbar at comp.cz (Vaclav Barta)
Date: Wed, 2 Jul 2008 23:51:37 +0200
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <200807022112.m62LChoj006025@vega.inec.cz>
References: <200807021128.40476.alex@thehandofagony.com>
	<200807022010.01140.vbar@comp.cz>
	<200807022112.m62LChoj006025@vega.inec.cz>
Message-ID: <200807022351.38575.vbar@comp.cz>

On Wednesday 02 July 2008 23:12:33 Gavin Lambert wrote:
> At 06:10 3/07/2008, Vaclav Barta wrote:
>  >On Wednesday 02 July 2008 16:50:00 Jim Idle wrote:
>  >> Though I am still unsure what this would give anyone over
>  >> having some C++ facades for the
>  >Exceptions?
> C++ exceptions aren't as useful as Java/C# ones, since you don't
> get a stack trace :(
True, but they're still useful, and in a non-trivial C++ project, it must be a 
real pain routing them around ANTLR-generated C...

	Bye
		Vasek

From liehannl at gmail.com  Wed Jul  2 15:03:25 2008
From: liehannl at gmail.com (Liehann Loots)
Date: Thu, 3 Jul 2008 00:03:25 +0200
Subject: [antlr-interest] Rewrite Rules (ANTLR v3)
Message-ID: <6c447dbc0807021503l7a224e83t216c3db0610b844b@mail.gmail.com>

Hi,

I'm relatively new to ANTLR and I was hoping I could get some help
with rewrite rules and tree construction.

I'm essentially building a simple scripting language grammar. I have a
rule for an expression, that can be dereferenced, and invoked.

expr	:	num_expr (((PERIOD)! id+=IDENT)+ ((LT_BRKT)! prm=param_list
(RT_BRKT)!)?)?;

I want the tree to be rooted at INVOKE if param_list is present, DEREF
if IDENT is present, and at num_expr if neither of param_list or IDENT
is present. I've tried sub rules with the ^ operator but then the
children nodes end up in the wrong order.

With conditional rewrite rules it would look something like this, but
I'm getting errors doing this:
	-> {$id == null && $prm == null} ^(num_expr)
	-> {$id == null && $prm != null} ^(INVOKE num_expr param_list?)
	-> {$id != null && $prm == null} ^(DEREF num_expr IDENT*)
	-> {$id != null && $prm != null} ^(INVOKE ^(DEREF num_expr IDENT*)
param_list?);

I have gone through what material I could find regarding tree
construction so either I didn't click something or I just didn't find
the right information.

Any help would be greatly appreciated.

Regards,
Liehann

From jaluber at gmx.de  Wed Jul  2 15:09:24 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 03 Jul 2008 00:09:24 +0200
Subject: [antlr-interest] Rewrite Rules (ANTLR v3)
In-Reply-To: <6c447dbc0807021503l7a224e83t216c3db0610b844b@mail.gmail.com>
References: <6c447dbc0807021503l7a224e83t216c3db0610b844b@mail.gmail.com>
Message-ID: <486BFC94.8090006@gmx.de>

Liehann Loots schrieb:
> Hi,
> 
> I'm relatively new to ANTLR and I was hoping I could get some help
> with rewrite rules and tree construction.
> 
> I'm essentially building a simple scripting language grammar. I have a
> rule for an expression, that can be dereferenced, and invoked.
> 
> expr	:	num_expr (((PERIOD)! id+=IDENT)+ ((LT_BRKT)! prm=param_list
> (RT_BRKT)!)?)?;
> 
> I want the tree to be rooted at INVOKE if param_list is present, DEREF
> if IDENT is present, and at num_expr if neither of param_list or IDENT
> is present. I've tried sub rules with the ^ operator but then the
> children nodes end up in the wrong order.
> 
> With conditional rewrite rules it would look something like this, but
> I'm getting errors doing this:
> 	-> {$id == null && $prm == null} ^(num_expr)
> 	-> {$id == null && $prm != null} ^(INVOKE num_expr param_list?)
> 	-> {$id != null && $prm == null} ^(DEREF num_expr IDENT*)
> 	-> {$id != null && $prm != null} ^(INVOKE ^(DEREF num_expr IDENT*)
> param_list?);
> 
> I have gone through what material I could find regarding tree
> construction so either I didn't click something or I just didn't find
> the right information.
> 
> Any help would be greatly appreciated.
> 
> Regards,
> Liehann
> 
It looks like you forgot to add '?' after the action blocks:

-> {$id == null && $prm == null}? ^(num_expr)
-> {$id == null && $prm != null}? ^(INVOKE num_expr param_list?)
-> {$id != null && $prm == null}? ^(DEREF num_expr IDENT*)
-> {$id != null && $prm != null}? ^(INVOKE ^(DEREF num_expr IDENT*)

Johannes

From liehannl at gmail.com  Wed Jul  2 15:24:40 2008
From: liehannl at gmail.com (Liehann Loots)
Date: Thu, 3 Jul 2008 00:24:40 +0200
Subject: [antlr-interest] Fwd:  Rewrite Rules (ANTLR v3)
In-Reply-To: <6c447dbc0807021513s7ebb5419l8c1e884da957f6b3@mail.gmail.com>
References: <6c447dbc0807021503l7a224e83t216c3db0610b844b@mail.gmail.com>
	<486BFC94.8090006@gmx.de>
	<6c447dbc0807021513s7ebb5419l8c1e884da957f6b3@mail.gmail.com>
Message-ID: <6c447dbc0807021524r5adfcf12o3cc268fb76eefd24@mail.gmail.com>

Sorry, should have kept this on the mailing list.

My second error was I needed to drop the '$'s in the conditional
statements. My guess is when you insert those conditions you're
actually inserting bits of Java code (anyone feel free to correct me
if I'm wrong). I'm particularly interested if these conditions are
portable over different platforms (Java / C++ / Ruby etc)

Also, if anyone else has a better solution on how to build this tree,
I'd love to hear it.

For posterity my final rule is as follows:

expr	:	
	num_expr (((PERIOD)! id+=IDENT)+ ((LT_BRKT)! prm=param_list (RT_BRKT)!)?)?
	-> {id == null && prm == null}? ^(num_expr)
	-> {id == null && prm != null}? ^(INVOKE num_expr $prm?)
	-> {id != null && prm == null}? ^(DEREF num_expr $id*)
	-> ^(INVOKE ^(DEREF num_expr $id*) $prm?);

Regards,
Liehann
---------- Forwarded message ----------
From: Liehann Loots <liehannl at gmail.com>
Date: Thu, Jul 3, 2008 at 12:13 AM
Subject: Re: [antlr-interest] Rewrite Rules (ANTLR v3)
To: Johannes Luber <jaluber at gmx.de>


Thanks,

I actually picked that up after posting the message. It also seems the
last rule may not have any conditionals, which makes sense as there
has to be a "default" rule.

I'm now getting a "missing attribute access on rule scope : prm" error.

On Thu, Jul 3, 2008 at 12:09 AM, Johannes Luber <jaluber at gmx.de> wrote:
> Liehann Loots schrieb:
>>
>> Hi,
>>
>> I'm relatively new to ANTLR and I was hoping I could get some help
>> with rewrite rules and tree construction.
>>
>> I'm essentially building a simple scripting language grammar. I have a
>> rule for an expression, that can be dereferenced, and invoked.
>>
>> expr    :       num_expr (((PERIOD)! id+=IDENT)+ ((LT_BRKT)!
>> prm=param_list
>> (RT_BRKT)!)?)?;
>>
>> I want the tree to be rooted at INVOKE if param_list is present, DEREF
>> if IDENT is present, and at num_expr if neither of param_list or IDENT
>> is present. I've tried sub rules with the ^ operator but then the
>> children nodes end up in the wrong order.
>>
>> With conditional rewrite rules it would look something like this, but
>> I'm getting errors doing this:
>>        -> {$id == null && $prm == null} ^(num_expr)
>>        -> {$id == null && $prm != null} ^(INVOKE num_expr param_list?)
>>        -> {$id != null && $prm == null} ^(DEREF num_expr IDENT*)
>>        -> {$id != null && $prm != null} ^(INVOKE ^(DEREF num_expr IDENT*)
>> param_list?);
>>
>> I have gone through what material I could find regarding tree
>> construction so either I didn't click something or I just didn't find
>> the right information.
>>
>> Any help would be greatly appreciated.
>>
>> Regards,
>> Liehann
>>
> It looks like you forgot to add '?' after the action blocks:
>
> -> {$id == null && $prm == null}? ^(num_expr)
> -> {$id == null && $prm != null}? ^(INVOKE num_expr param_list?)
> -> {$id != null && $prm == null}? ^(DEREF num_expr IDENT*)
> -> {$id != null && $prm != null}? ^(INVOKE ^(DEREF num_expr IDENT*)
>
> Johannes
>

From siva.kumar at loglogic.com  Wed Jul  2 15:49:46 2008
From: siva.kumar at loglogic.com (siva.kumar at loglogic.com)
Date: Wed, 2 Jul 2008 15:49:46 -0700
Subject: [antlr-interest] Does ANTLR read the entire file before parsing?
In-Reply-To: <L01SLCSMTP01NI4lQ5t0000f4fc@L01SLCSMTP01.calltower.com>
References: <117A6478DABB1D4E9509EA7F413AE78907567DF3@CTMAIL2.calltower.com>
	<L01SLCSMTP01zzmZ4pV0000a2fd@L01SLCSMTP01.calltower.com>
	<117A6478DABB1D4E9509EA7F413AE789075684FA@CTMAIL2.calltower.com>
	<117A6478DABB1D4E9509EA7F413AE789076DB8F2@CTMAIL2.calltower.com>
	<L01SLCSMTP01NI4lQ5t0000f4fc@L01SLCSMTP01.calltower.com>
Message-ID: <117A6478DABB1D4E9509EA7F413AE78907755050@CTMAIL2.calltower.com>

Thanks for your reply, Gavin.

-Siva

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Tuesday, July 01, 2008 2:13 PM
To: Siva Kumar (siva.kumar at loglogic.com); antlr-interest at antlr.org
Subject: Re: [antlr-interest] Does ANTLR read the entire file before
parsing?

At 08:48 2/07/2008, siva.kumar at loglogic.com wrote:
 >   Just wanted confirmation that ANTLR will generate code that 
will
 >read the entire file before it's passed to the lexer.

The timing is a little different (I think it actually slurps the 
file when the lexer is asked to produce the first token, which is 
when the token stream is created), but essentially yes.


From sunshine at public.kherson.ua  Wed Jul  2 22:17:29 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Thu, 03 Jul 2008 08:17:29 +0300
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <20080702211243.3B12D312961@www.antlr.org>
Message-ID: <C4923B99.9F16E%sunshine@public.kherson.ua>

On 7/3/08 12:12 AM, "Gavin Lambert" <antlr at mirality.co.nz> wrote:

> At 06:10 3/07/2008, Vaclav Barta wrote:
>> On Wednesday 02 July 2008 16:50:00 Jim Idle wrote:
>>> I am going to look properly at a pure C++ approach after we
>>> release 3.1 (shortly hopefully, it is all  waiting on me ;-).
>>> Though I am still unsure what this would give anyone over
>>> having some C++ facades for the
>> 
>> Exceptions?
> 
> C++ exceptions aren't as useful as Java/C# ones, since you don't
> get a stack trace :(

And what need in stack ?

For debugging purpose we can easy set breakpoint on exception as in XCODE
(GCC) so in MS Visual.

For release ... I do not see many sense.


-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From sunshine at public.kherson.ua  Wed Jul  2 22:24:58 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Thu, 03 Jul 2008 08:24:58 +0300
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <1215010200.5833.38.camel@jimi>
Message-ID: <C4923D5A.9F173%sunshine@public.kherson.ua>

On 7/2/08 5:50 PM, "Jim Idle" <jimi at temporal-wave.com> wrote:

> I am going to look properly at a pure C++ approach after we release 3.1
> (shortly hopefully, it is all  waiting on me ;-). Though I am still unsure
> what this would give anyone over having some C++ facades for the C runtime.
> Though, in theory, it should be no slower and not using pointers to functions
> might make the optimizer more effective. For this reason I am also
> contemplating one (or more) C-lite runtimes, as many people don't need to
> override anything but the error message handling.

Usually C++ facade around some C library make its usage more simple and
safe. Less lines of code to write.

Because e.g. we can hide in c++ constructor/destructor issues of correct
init/destroy.  

And yes, we must be able as in C-parser, so in C++ parser "convert"
last_err_code into real c++ exception to throw it through the rest part of
application.

As I know ANTLR3 internally do not use exceptions to do job, and this is
good. Btw, have not see yet how this was made, but I have see nice solution
in the IBM ICU library on this.

-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From jens.boeykens at gmail.com  Thu Jul  3 00:02:16 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Thu, 3 Jul 2008 09:02:16 +0200
Subject: [antlr-interest] error in antlrv3.g? missing suffixes in tree
In-Reply-To: <6ABF962E-7C15-4F03-8BB8-4A6B74A3AB59@cs.usfca.edu>
References: <53c4e43f0807020117h7e877eb2p446ae28c7241c447@mail.gmail.com>
	<6ABF962E-7C15-4F03-8BB8-4A6B74A3AB59@cs.usfca.edu>
Message-ID: <53c4e43f0807030002vfb4d3dbg874c246ff91a02c3@mail.gmail.com>

I fixed the error:

elementNoOptionSpec
    :    id (labelOp='='|labelOp='+=') atom
        (    ebnfSuffix    -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]
^($labelOp id atom) EOA["EOA"]) EOB["EOB"]))
        |                -> ^($labelOp id atom)
        )
    |    id (labelOp='='|labelOp='+=') block
        (    ebnfSuffix    -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]
^($labelOp id block) EOA["EOA"]) EOB["EOB"]))
        |                -> ^($labelOp id block)
        )
    |    atom
        (    ebnfSuffix    -> ^(*ebnfSuffix* ^(BLOCK["BLOCK"] ^(ALT["ALT"]
atom EOA["EOA"]) EOB["EOB"]))
        |                -> atom
        )
    |    ebnf
    |   ACTION
    |   SEMPRED ( '=>' -> GATED_SEMPRED | -> SEMPRED )
    |   treeSpec
    ;


EbnfSuffix was missing for the alternative beginning with atom.

Greetings,
Jens

2008/7/2 Terence Parr <parrt at cs.usfca.edu>:

> thereAre indeed some issues without as I have not done anything but an
> initial work on that. I have some graduate students that are looking into
> this as they build another project.
> Ter
>
> On Jul 2, 2008, at 1:17 AM, Jens Boeykens wrote:
>
>  Hi,
>>
>> I'm on a project where I need to parse grammars. Therefor I use antlrv3.g
>> which can be fount here:
>> http://www.antlr.org/grammar/ANTLR/
>>
>> The problem is this:
>> consider the example
>>
>> grammar T;
>>
>> a : p+;
>>
>> If I parse this grammar I get the following tree:
>>
>> (grammar T (RULE a (BLOCK (ALT (BLOCK (ALT p EOA) EOB) EOA) EOB) EOR))
>>
>> As you can see there is no '+' in the tree. I need the '+' so I can
>> regenerate the original grammar.
>> When using parentheses it works:
>>
>> grammar T;
>>
>> a : (p)+;
>>
>> (grammar T (RULE a (BLOCK (ALT (+ (BLOCK (ALT p EOA) EOB)) EOA) EOB) EOR))
>>
>> Now the '+' has been added to the tree.
>>
>> My question is: what is to be changed in antlrv3.g so that it also works
>> with the parentheses?
>>
>> Thanx!
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080703/306e156f/attachment.html 

From g.vandeglind at beinformed.nl  Thu Jul  3 01:04:09 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Thu, 3 Jul 2008 10:04:09 +0200
Subject: [antlr-interest] context information through rule parameters
In-Reply-To: <80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
	<18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D22A6@UTEX01.be-value.nl>
	<80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
Message-ID: <35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>

Hi Terence and all,

Coming back to my problem of passing down context information through
rule parameters. I think I have pinpointed the problem.
First let me provide some context about the grammar I am stuck with. The
language the grammar describes is ambiguous. It has been designed this
way in the past and can't be changed anymore. :-( Because of this, my
grammar contains two rules that use backtracking. This also implies that
it is impossible to replace these by syntactic predicates.

Here I present a simplified grammar that contains one of the
backtracking rules (relationalExpression). In this form ANTLR accepts
it. But if I change rule relationalExpression slightly I get ANTLR
errors. What I discovered is that when I use backtracking (which I need)
it is only allowed to pass parameters in the last branch of a rule, so I
can only pass the checkAmbiguity parameter along with booleanAtom. If I
pass it along with formula or dateAtom in the preceding branches then I
get the following error: attribute is not a token, parameter, or return
value: checkAmbiguity. I think this might have got something to do with
ANTLR (Java) code generation. So backtracking in combination with
passing along parameters (by reference) in branches that are not the
last, causes problems.

I hope this provides you with enough information to check if it is
indeed a problem with ANTLR.

Thanks a lot!

Cheers, Gerard


=====>
	grammar MyGrammar;

	options {
		output=AST;
		ASTLabelType=CommonTree;
	}

	expression : relationalExpression[true];

	relationalExpression[boolean checkAmbiguity]
	  options {backtrack=true;}
    		:	formula[true]	(LET^ | GET^ | LT^ | GT^)
formula[true]
	   	|	dateAtom[true]	(LET^ | GET^ | LT^ | GT^)
dateAtom[true]
	    	|	booleanAtom[$checkAmbiguity]
		;
	
	formula[boolean bool]
		: IDENTIFIER;

	dateAtom[boolean bool]
		: IDENTIFIER;
	
	booleanAtom[boolean bool]
		: IDENTIFIER;
	
	GT      :	'>'	;
	LT      :	'<'	;
	GET     :	'>='	;
	LET     :	'<='	;

	IDENTIFIER 	:	('a'..'z'|'A'..'Z')
('0'..'9'|'a'..'z'|'A'..'Z'|'_'|'.')*;
<=====


cool. PleaseNarrow it down to the smallest possible grammar that  
fails; I will be able to fix it quickly :)
Ter
On Jul 1, 2008, at 11:25 PM, Gerard van de Glind wrote:

>> Dear all,
>>
>> I want to pass context information along with the rules that are
>> parsed.
>>
>> Consider the following grammar:
>>
>> expression : rule1[false] | rule2[true];
>>
>> rule1[boolean bool]: rule3[true] | rule4[$bool];
>>
>> rule2[boolean bool]: rule3[false] | rule4[$bool];
>>
>> ...
>>
>> However, rule4[$bool] is not accepted. Is this an invalid construct?
>> If yes, is there a work-around?
>
> what is the error?  note rule4 is not defined in example.
> Ter
>
>
> Hi Terence and all
>
> I am afraid I over simplified my grammar to present my problem.
>
> However, I get the following message in my console: attribute is not a
> token, parameter, or return value: bool.
> And I thought it had something to do with passing the boolean  
> parameter
> along.
> I have to dig in it deeper to pinpoint my problem.
>
> Thanks!
>
> Gerard
>


From alex at thehandofagony.com  Thu Jul  3 01:39:57 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Thu, 3 Jul 2008 10:39:57 +0200
Subject: [antlr-interest] Parsing HTML pages
Message-ID: <200807031039.57797.alex@thehandofagony.com>

Hello,

Since I'm quite new parsing, I'd just like to ask if ANTLR is a good choice 
for extracting info out of HTML pages.  I greatly appreciate any feedback.



Alexander N. S?rnes

From nelson.ana at gmail.com  Thu Jul  3 02:32:43 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Thu, 3 Jul 2008 10:32:43 +0100
Subject: [antlr-interest] Parsing HTML pages
In-Reply-To: <200807031039.57797.alex@thehandofagony.com>
References: <200807031039.57797.alex@thehandofagony.com>
Message-ID: <a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>

Hi, Alexander,

It might be simpler to use an existing HTML parsing tool rather than
writing your own.

Here's one tool I really like, it's written in Ruby:
http://code.whytheluckystiff.net/hpricot/

If you are trying to parse web pages remember that lots of people
write very bad HTML which doesn't conform to the standard, so it can
be very difficult to parse.





2008/7/3 Alexander Nicolaysen S?rnes <alex at thehandofagony.com>:
> Hello,
>
> Since I'm quite new parsing, I'd just like to ask if ANTLR is a good choice
> for extracting info out of HTML pages.  I greatly appreciate any feedback.
>
>
>
> Alexander N. S?rnes
>

From alex at thehandofagony.com  Thu Jul  3 02:44:53 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Thu, 3 Jul 2008 11:44:53 +0200
Subject: [antlr-interest] Parsing HTML pages
In-Reply-To: <a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>
References: <200807031039.57797.alex@thehandofagony.com>
	<a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>
Message-ID: <200807031144.53937.alex@thehandofagony.com>

P? Torsdag 03 juli 2008 , 11:32:43 skrev Ana Nelson:
> Hi, Alexander,
>
> It might be simpler to use an existing HTML parsing tool rather than
> writing your own.
>
> Here's one tool I really like, it's written in Ruby:
> http://code.whytheluckystiff.net/hpricot/
>

Thanks, I'll check it out.

> If you are trying to parse web pages remember that lots of people
> write very bad HTML which doesn't conform to the standard, so it can
> be very difficult to parse.
>

Yes, that's why I thought something like ANTLR would be a good idea.



ALexander

> 2008/7/3 Alexander Nicolaysen S?rnes <alex at thehandofagony.com>:
> > Hello,
> >
> > Since I'm quite new parsing, I'd just like to ask if ANTLR is a good
> > choice for extracting info out of HTML pages.  I greatly appreciate any
> > feedback.
> >
> >
> >
> > Alexander N. S?rnes



From tilman.walter at gmx.de  Thu Jul  3 03:15:25 2008
From: tilman.walter at gmx.de (tilman walter)
Date: Thu, 03 Jul 2008 12:15:25 +0200
Subject: [antlr-interest] declare throws-clause for rule
Message-ID: <486CA6BD.3000104@gmx.de>

Hi List,

I am a newby to antlr.
Is there a possibility to let a rule throw a custom exception that can 
be catched by the class invoking the parser?
I think i could place this piece of code in the generated class, but i 
wonder if i can reach this through a grammar construct....

I would appreciate for any hint.
Thanks is advance.

Tilman

From sam.kuper at uclmail.net  Thu Jul  3 03:59:41 2008
From: sam.kuper at uclmail.net (Sam Kuper)
Date: Thu, 3 Jul 2008 11:59:41 +0100
Subject: [antlr-interest] Parsing HTML pages
In-Reply-To: <200807031144.53937.alex@thehandofagony.com>
References: <200807031039.57797.alex@thehandofagony.com>
	<a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>
	<200807031144.53937.alex@thehandofagony.com>
Message-ID: <4126b3450807030359s3afa99b2geb230921dd910cba@mail.gmail.com>

Alexander,

Most programming languages already have HTML parsing libraries available for
them. In most cases these are designed to handle even malformed HTML
reasonably gracefully.

If Python is a suitable language for you, have a look at Ian Bicking's
recent comparison of the available options:

http://blog.ianbicking.org/2008/03/30/python-html-parser-performance/

Best,

Sam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080703/9dd918bd/attachment.html 

From g.vandeglind at beinformed.nl  Thu Jul  3 04:24:02 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Thu, 3 Jul 2008 13:24:02 +0200
Subject: [antlr-interest] declare throws-clause for rule
In-Reply-To: <486CA6BD.3000104@gmx.de>
References: <486CA6BD.3000104@gmx.de>
Message-ID: <35AC19B502E98D42879AFA71FAD9CDCC2D2437@UTEX01.be-value.nl>

Hi,

Yes, you can throw an exception (a RuntTimeException to be precise,
because these are unchecked) from your grammar. And you can catch these
exceptions in the class that invokes the generated parser.

Example:
expression : ruleA | ruleB { if (condition) {throw new
RunTimeException("");} };

Also, code that you place in the @member action gets generated into your
parser.

Good luck!

Cheers, Gerard


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of tilman walter
Sent: donderdag 3 juli 2008 12:15
To: ANTLR List
Subject: [antlr-interest] declare throws-clause for rule

Hi List,

I am a newby to antlr.
Is there a possibility to let a rule throw a custom exception that can 
be catched by the class invoking the parser?
I think i could place this piece of code in the generated class, but i 
wonder if i can reach this through a grammar construct....

I would appreciate for any hint.
Thanks is advance.

Tilman

From AndrevdM at pyrogenesis.co.za  Thu Jul  3 04:44:33 2008
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Thu, 3 Jul 2008 13:44:33 +0200
Subject: [antlr-interest] += in a tree grammar
Message-ID: <E7035321714C624BA01ADCBA6F99CADF0102FF75E06D@mercury.pyrogenesis.co.za>

FWIW I found a simple solution to this problem...

Rather than use += I'm using code blocks in the group itself.


i.e. Instead of this
   call
   : ^(CALL IDENTIFIER (e+=INT)*)
   {
      $e ...
   };

I'm now doing this
   call
   : ^(
         CALL
         IDENTIFIER
         (
            e { list.Add( e ); }
         )*
      )

Its not as easy to read but it works.


-----Original Message-----
>From: Andr? van der Merwe

Hi,

I'm trying to build a heterogeneous AST from a tree grammar but I can't get a list of nodes using +=.

Firstly I building the AST in the tree grammar for two reasons
 1) Its easier as I'm working with a simplified/normalised tree (i.e. not a parse tree).
 2) My parser code can be reused for other purposes, i.e. I just create a new tree walker and leave the parser as is.


What I'm trying to do is create nodes for each parameter in a method call. Here is my (simplified) parser grammar
   program
      :   IDENTIFIER LPAREN parameters* RPAREN   -> ^(CALL IDENTIFIER parameters?)
      ;
   parameters
      :   INT (COMMA INT)* -> INT+
      ;

And my tree grammar
   program
      :   ^(CALL IDENTIFIER (e+=INT)*)
      {
         object obj1 = $e;
         object obj2 = e;
      };


I've tried everything but I can't get this to work.



Using 3.1 beta 1: I can't even parse this "someMethod( 1, 2 )" as I get an RewriteEarlyExitException. The same parser works in 3.0.1
   root_0 = (CommonTree)adaptor.GetNilNode();
   // 20:21: -> ( INT )+
   {
   if ( !(stream_INT.HasNext()) ) {
     throw new RewriteEarlyExitException();
----


Using 3.0.1 with the tree grammar's output = AST generates the correct code for the '+=' but the rest of the code does not compile as the generated tree is passing CommonTree objects to the adapter's Create() method not ITokens. [I know that 3.0.1 does not support tree to tree grammars so I'm not surprised]
----


Using 3.0.1 with the tree grammar's output = template compiles but then the '+=' is concatenating templates
   if (list_e == null)
      list_e = new ArrayList();

   list_e.Add(e.Template);
----



Any ideas? I don't want to have to move all my code into the parser but it is beginning to look like the only option :( Is there perhaps a later beta available or can I download the latest source somewhere?


Thanks

Andre

From mail at martin-probst.com  Thu Jul  3 06:32:46 2008
From: mail at martin-probst.com (Martin Probst)
Date: Thu, 3 Jul 2008 15:32:46 +0200
Subject: [antlr-interest] Parsing HTML pages
In-Reply-To: <200807031144.53937.alex@thehandofagony.com>
References: <200807031039.57797.alex@thehandofagony.com>
	<a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>
	<200807031144.53937.alex@thehandofagony.com>
Message-ID: <0EB59476-7E19-4113-8D84-0A23E859FCC1@martin-probst.com>

Hi,

if you're in Java-Land, you might want to check out TagSoup, JTidy and/ 
or HTMLParser:

http://ccil.org/~cowan/XML/tagsoup/
http://sourceforge.net/projects/jtidy
http://htmlparser.sourceforge.net/

Regards,
Martin

From parrt at cs.usfca.edu  Thu Jul  3 10:32:54 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 3 Jul 2008 10:32:54 -0700
Subject: [antlr-interest] error in antlrv3.g? missing suffixes in tree
In-Reply-To: <53c4e43f0807030002vfb4d3dbg874c246ff91a02c3@mail.gmail.com>
References: <53c4e43f0807020117h7e877eb2p446ae28c7241c447@mail.gmail.com>
	<6ABF962E-7C15-4F03-8BB8-4A6B74A3AB59@cs.usfca.edu>
	<53c4e43f0807030002vfb4d3dbg874c246ff91a02c3@mail.gmail.com>
Message-ID: <DFD94D14-626E-4239-8D53-0C552F6E8B96@cs.usfca.edu>

Thanks...Fixed in the examples directory.
Ter
On Jul 3, 2008, at 12:02 AM, Jens Boeykens wrote:

> I fixed the error:
>
> elementNoOptionSpec
>     :    id (labelOp='='|labelOp='+=') atom
>         (    ebnfSuffix    -> ^( ebnfSuffix ^(BLOCK["BLOCK"]  
> ^(ALT["ALT"] ^($labelOp id atom) EOA["EOA"]) EOB["EOB"]))
>         |                -> ^($labelOp id atom)
>         )
>     |    id (labelOp='='|labelOp='+=') block
>         (    ebnfSuffix    -> ^( ebnfSuffix ^(BLOCK["BLOCK"]  
> ^(ALT["ALT"] ^($labelOp id block) EOA["EOA"]) EOB["EOB"]))
>         |                -> ^($labelOp id block)
>         )
>     |    atom
>         (    ebnfSuffix    -> ^(ebnfSuffix ^(BLOCK["BLOCK"]  
> ^(ALT["ALT"] atom EOA["EOA"]) EOB["EOB"]))
>         |                -> atom
>         )
>     |    ebnf
>     |   ACTION
>     |   SEMPRED ( '=>' -> GATED_SEMPRED | -> SEMPRED )
>     |   treeSpec
>     ;
>
>
> EbnfSuffix was missing for the alternative beginning with atom.
>
> Greetings,
> Jens
>
> 2008/7/2 Terence Parr <parrt at cs.usfca.edu>:
> thereAre indeed some issues without as I have not done anything but  
> an initial work on that. I have some graduate students that are  
> looking into this as they build another project.
> Ter
>
> On Jul 2, 2008, at 1:17 AM, Jens Boeykens wrote:
>
> Hi,
>
> I'm on a project where I need to parse grammars. Therefor I use  
> antlrv3.g which can be fount here:
> http://www.antlr.org/grammar/ANTLR/
>
> The problem is this:
> consider the example
>
> grammar T;
>
> a : p+;
>
> If I parse this grammar I get the following tree:
>
> (grammar T (RULE a (BLOCK (ALT (BLOCK (ALT p EOA) EOB) EOA) EOB) EOR))
>
> As you can see there is no '+' in the tree. I need the '+' so I can  
> regenerate the original grammar.
> When using parentheses it works:
>
> grammar T;
>
> a : (p)+;
>
> (grammar T (RULE a (BLOCK (ALT (+ (BLOCK (ALT p EOA) EOB)) EOA) EOB)  
> EOR))
>
> Now the '+' has been added to the tree.
>
> My question is: what is to be changed in antlrv3.g so that it also  
> works with the parentheses?
>
> Thanx!
>
>


From vbar at comp.cz  Thu Jul  3 10:42:13 2008
From: vbar at comp.cz (Vaclav Barta)
Date: Thu, 3 Jul 2008 19:42:13 +0200
Subject: [antlr-interest] Parsing HTML pages
In-Reply-To: <200807031144.53937.alex@thehandofagony.com>
References: <200807031039.57797.alex@thehandofagony.com>
	<a7d6d2740807030232x3f9f4694r1dc96477484647fc@mail.gmail.com>
	<200807031144.53937.alex@thehandofagony.com>
Message-ID: <200807031942.13170.vbar@comp.cz>

On Thursday 03 July 2008 11:44:53 Alexander Nicolaysen S?rnes wrote:
> P? Torsdag 03 juli 2008 , 11:32:43 skrev Ana Nelson:
> > If you are trying to parse web pages remember that lots of people
> > write very bad HTML which doesn't conform to the standard, so it can
> > be very difficult to parse.
> Yes, that's why I thought something like ANTLR would be a good idea.
I'd say quite the opposite - ANTLR is designed to parse documents using 
complicated languages (e.g. programming languages) _exactly_ according to 
those language's specification. There are facilities to recover the generated  
parsers from errors, but most ANTLR-generated parsers do not ignore errors in 
ther input, while most HTML parsers do. I'd say forget ANTLR and use an 
existing HTML parser in your favorite language.

	Bye
		Vasek
--
http://www.mangrove.cz/
Open Source integration

From liehannl at gmail.com  Thu Jul  3 11:46:47 2008
From: liehannl at gmail.com (Liehann Loots)
Date: Thu, 3 Jul 2008 20:46:47 +0200
Subject: [antlr-interest] AST Generation - Order of Children
Message-ID: <6c447dbc0807031146o6e3835e4m827b88124b87b9@mail.gmail.com>

Hi,

I have three rules that look something like this:

expr : IDENT (deref^ | invoke^)*;
deref : (PERIOD)! IDENT -> ^(DEREF IDENT);
invoke : (PERIOD)! IDENT (LEFT_BRKT)! (RIGHT_BRKT)! -> ^(INVOKE IDENT);

That produce an AST like this:

INVOKE
|    |
c   DEREF
    |   |
    b   a

What I want to get is a tree like this:

   INVOKE
   |    |
DEREF   c
|   |
a   b

But I'm not sure how to specify a rewrite rule to make the current tree the
first child of the new parent, opposed to appending it to the end.
Any assistance would be appreciated.

Regards,
Liehann
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080703/88081965/attachment.html 

From liehannl at gmail.com  Thu Jul  3 12:24:10 2008
From: liehannl at gmail.com (Liehann Loots)
Date: Thu, 3 Jul 2008 21:24:10 +0200
Subject: [antlr-interest] AST Generation - Order of Children
In-Reply-To: <6c447dbc0807031146o6e3835e4m827b88124b87b9@mail.gmail.com>
References: <6c447dbc0807031146o6e3835e4m827b88124b87b9@mail.gmail.com>
Message-ID: <6c447dbc0807031224y67736875k52e61a0581728616@mail.gmail.com>

Ok, I think I figured it out. My solution looks like this:

expr
    :    (IDENT -> IDENT) // set return tree
        (    deref -> ^(DEREF $expr deref)
        |    invoke -> ^(INVOKE $expr invoke)
        )*
    ;

 - Liehann

On Thu, Jul 3, 2008 at 8:46 PM, Liehann Loots <liehannl at gmail.com> wrote:

> Hi,
>
> I have three rules that look something like this:
>
> expr : IDENT (deref^ | invoke^)*;
> deref : (PERIOD)! IDENT -> ^(DEREF IDENT);
> invoke : (PERIOD)! IDENT (LEFT_BRKT)! (RIGHT_BRKT)! -> ^(INVOKE IDENT);
>
> That produce an AST like this:
>
> INVOKE
> |    |
> c   DEREF
>     |   |
>      b   a
>
> What I want to get is a tree like this:
>
>    INVOKE
>     |    |
> DEREF   c
> |   |
> a   b
>
> But I'm not sure how to specify a rewrite rule to make the current tree the
> first child of the new parent, opposed to appending it to the end.
> Any assistance would be appreciated.
>
> Regards,
> Liehann
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080703/b224fbd1/attachment.html 

From r_reitzi at cs.uni-kl.de  Thu Jul  3 12:48:29 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Thu, 03 Jul 2008 21:48:29 +0200
Subject: [antlr-interest] AST Generation - Order of Children
In-Reply-To: <6c447dbc0807031146o6e3835e4m827b88124b87b9@mail.gmail.com>
References: <6c447dbc0807031146o6e3835e4m827b88124b87b9@mail.gmail.com>
Message-ID: <a1b44480d5043615e4d386c98393711e@mail.frhk.de>

Hi!

I had a similar problem; for me, replacing '*'/'+' by a recursive rule and
declare rewrite rules there helped to override ANTLRs default way to build
an AST from such subrules.

Regards

Raphael

On Thu, 3 Jul 2008 20:46:47 +0200, "Liehann Loots" <liehannl at gmail.com>
wrote:
> Hi,
> 
> I have three rules that look something like this:
> 
> expr : IDENT (deref^ | invoke^)*;
> deref : (PERIOD)! IDENT -> ^(DEREF IDENT);
> invoke : (PERIOD)! IDENT (LEFT_BRKT)! (RIGHT_BRKT)! -> ^(INVOKE IDENT);
> 
> That produce an AST like this:
> 
> INVOKE
> |    |
> c   DEREF
>     |   |
>     b   a
> 
> What I want to get is a tree like this:
> 
>    INVOKE
>    |    |
> DEREF   c
> |   |
> a   b
> 
> But I'm not sure how to specify a rewrite rule to make the current tree
> the
> first child of the new parent, opposed to appending it to the end.
> Any assistance would be appreciated.
> 
> Regards,
> Liehann


From Waverly.Edwards at genesys.com  Thu Jul  3 13:20:20 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Thu, 3 Jul 2008 16:20:20 -0400
Subject: [antlr-interest] Anyone running ANTLR with Netbeans?
Message-ID: <FF993752CB890B4EB591BE5450C37BF1012D7C2B@navamane001.ad.internal.corp>


Using Netbeans 5.5.1 and 6.0.1 I've added the lib folder to the
classpath.

The error message is "package org.antlr.runtime does not exist"

I've looked through the source code that I downloaded and I can find
the different folders/packages so I also tried adding the source folder
to just the project but this didn't work.

What IDE's are others using and is it as simple as adding the lib folder
to
the classpath as I read on the wiki?


Any ideas?


Thanks,


W.

From jimi at temporal-wave.com  Thu Jul  3 13:38:28 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 03 Jul 2008 13:38:28 -0700
Subject: [antlr-interest] Anyone running ANTLR with Netbeans?
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1012D7C2B@navamane001.ad.internal.corp>
References: <FF993752CB890B4EB591BE5450C37BF1012D7C2B@navamane001.ad.internal.corp>
Message-ID: <1215117508.5833.200.camel@jimi>

On Thu, 2008-07-03 at 16:20 -0400, Edwards, Waverly wrote:

> Using Netbeans 5.5.1 and 6.0.1 I've added the lib folder to the
> classpath.
> 
> The error message is "package org.antlr.runtime does not exist"
> 
> I've looked through the source code that I downloaded and I can find
> the different folders/packages so I also tried adding the source folder
> to just the project but this didn't work.
> 
> What IDE's are others using and is it as simple as adding the lib folder
> to
> the classpath as I read on the wiki?

I use Netbeans and have posted how to configure it on this list in the
past. You should be able to search and find it.

However, in a nutshell:

1) Install the antlr3 ant task (see downloads) in to the dir: C:\Program
Files\NetBeans 6.1\java2\ant\lib
2) Create a new project
3) Right click on libraries, add library, create, create a library
called ANTLR3 (or whatever), then add the Jars (and docs and source is
even better) to this library definition. In future you can just add the
library.
4) Add a .g file
5) Open the build.xml for your project
6) Add some property defs and a -pre-compile task (there are other ways
but this is easy), as per the antlr3 ant task docs.
7) Right click project and build


build.xml will look something like this:

 <property name="grammar.dir"
location="src/com/temporalwave/parsers/tsql/" />
    <property name="antlr.libdir" location="C:/antlrsrc/lib" />
    <property name="antlr.tooldir" location="C:/antlrsrc/lib" />
    <property name="antlr.runtimedir" location="C:/antlrsrc/lib" />
    
    
     <patternset id="antlr.libs">
        <include name="stringtemplate-3.1.jar" />
        <include name="antlr277.jar" />
    </patternset>

    <patternset id="antlr.tool">
        <include name="ANTLRTool.jar" />
    </patternset>

    <patternset id="antlr.runtime">
        <include name="ANTLRRuntime.jar" />
    </patternset>

    <path id="antlr.path">


        <fileset dir="${antlr.tooldir}" casesensitive="yes">
           <patternset refid="antlr.tool" />
        </fileset>
                
        <fileset dir="${antlr.runtimedir}" casesensitive="yes">
           <patternset refid="antlr.runtime" />
        </fileset>
        
        <fileset dir="${antlr.libdir}" casesensitive="yes">
           <patternset refid="antlr.libs" />
        </fileset>
    </path>
    
    <target name="-pre-compile">
                
        <antlr:antlr3 xmlns:antlr="antlib:org/apache/tools/ant/antlr" 

            target="${grammar.dir}/tsqllexer.g" 
               depend="true">

            <classpath>

                <path refid="antlr.path" />

            </classpath>

        </antlr:antlr3>
        
        <antlr:antlr3 xmlns:antlr="antlib:org/apache/tools/ant/antlr" 

            target="${grammar.dir}/tsql.g" 
               depend="true" >

            <classpath>

                <path refid="antlr.path" />

            </classpath>

        </antlr:antlr3>

                <antlr:antlr3
xmlns:antlr="antlib:org/apache/tools/ant/antlr" 

            target="${grammar.dir}/tsqlwalker.g" 
               depend="true" >

            <classpath>

                <path refid="antlr.path" />

            </classpath>

        </antlr:antlr3>
        
    </target>

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080703/db56d969/attachment.html 

From antlr at mirality.co.nz  Thu Jul  3 14:10:14 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 04 Jul 2008 09:10:14 +1200
Subject: [antlr-interest] ANTLR C++ target
In-Reply-To: <C4923B99.9F16E%sunshine@public.kherson.ua>
References: <20080702211243.3B12D312961@www.antlr.org>
	<C4923B99.9F16E%sunshine@public.kherson.ua>
Message-ID: <20080703211025.A761911ED4B@www.antlr.org>

At 17:17 3/07/2008, Ruslan Zasukhin wrote:
 >And what need in stack ?
 >
 >For debugging purpose we can easy set breakpoint on exception as 
in
 >XCODE (GCC) so in MS Visual.
 >
 >For release ... I do not see many sense.

Exceptions are intended for errors that you weren't really 
expecting (running out of memory, corrupted program state, etc), 
and as such they're much more likely to occur "in the field".  To 
be able to attach a debugger to it and get a stack trace you need 
to reproduce the problem case locally, which isn't always 
possible, especially when you're not entirely sure what it is.

(This is less likely to be a problem with ANTLR-generated 
exceptions, since they should be easily reproducible just by using 
the same input file.  I'm just saying that in general the above is 
true.)


From antlr at mirality.co.nz  Thu Jul  3 14:43:49 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 04 Jul 2008 09:43:49 +1200
Subject: [antlr-interest] context information through rule  parameters
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
	<18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D22A6@UTEX01.be-value.nl>
	<80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>
Message-ID: <20080703214359.AEA912F4312@www.antlr.org>

At 20:04 3/07/2008, Gerard van de Glind wrote:
 >Because of this, my grammar contains two rules that use
 >backtracking. This also implies that it is impossible to
 >replace these by syntactic predicates.

You're mistaken about that -- all backtracking does is to insert 
automatic syntactic predicates, so anything you can do with 
backtracking you can do by writing your own synpreds.  It might 
just be more work than what you want to do :)

 >	relationalExpression[boolean checkAmbiguity]
 >	  options {backtrack=true;}
 >    		:	formula[true]	(LET^ | GET^ | LT^ | GT^)
 >formula[true]
 >	   	|	dateAtom[true]	(LET^ | GET^ | LT^ | GT^)
 >dateAtom[true]
 >	    	|	booleanAtom[$checkAmbiguity]
 >		;
 >	
 >	formula[boolean bool]
 >		: IDENTIFIER;
 >
 >	dateAtom[boolean bool]
 >		: IDENTIFIER;

Even backtracking isn't going to help you disambiguate those first 
two alts of relationalExpression -- they're exactly identical.


From g.vandeglind at beinformed.nl  Fri Jul  4 00:53:31 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Fri, 4 Jul 2008 09:53:31 +0200
Subject: [antlr-interest] context information through rule  parameters
In-Reply-To: <20080703214400.73F24206E07B@spam.be-value.nl>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
	<18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D22A6@UTEX01.be-value.nl>
	<80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>
	<20080703214400.73F24206E07B@spam.be-value.nl>
Message-ID: <35AC19B502E98D42879AFA71FAD9CDCC2D24DC@UTEX01.be-value.nl>

Hi Gavin and all,

Thanks Gavin for your reply!

At 20:04 3/07/2008, Gerard van de Glind wrote:
 >Because of this, my grammar contains two rules that use
 >backtracking. This also implies that it is impossible to
 >replace these by syntactic predicates.

You're mistaken about that -- all backtracking does is to insert 
automatic syntactic predicates, so anything you can do with 
backtracking you can do by writing your own synpreds.

Yes, you are right about that. I know that backtracking inserts
syntactic predicates under the hood. But is this the only thing it does?
I have seen that ANTLR also generates the following statement: if (
backtracking==0 ) So is the behavior of ANTLR with the backtrack option
compared to ANTLR with my own syntactic predicates really the same? And
is it always possible to replace the backtrack option with my own
syntactic predicates in such a way that it accepts the same language?

It might just be more work than what you want to do :)

Please explain, can you give me a hint of what I should do? Sofar, I
didn't succeed in being able to make my grammar to accept the same
language with my own syntactic predicates compared to the backtrack
option.

The grammar I presented is over simplified...in the original grammar I
also use actions and interrule communication through parameter passing.
I just learnt that it is possible to run into a situation where method
arguments result in noncompilable code if you use backtracking and
parameter passing a lot (paragraph 14.7 of The Definitive ANTLR
Reference). A solution to this problem is to use dynamic scopes.

 >	relationalExpression[boolean checkAmbiguity]
 >	  options {backtrack=true;}
 >    		:	formula[true]	(LET^ | GET^ | LT^ | GT^)
 >formula[true]
 >	   	|	dateAtom[true]	(LET^ | GET^ | LT^ | GT^)
 >dateAtom[true]
 >	    	|	booleanAtom[$checkAmbiguity]
 >		;
 >	
 >	formula[boolean bool]
 >		: IDENTIFIER;
 >
 >	dateAtom[boolean bool]
 >		: IDENTIFIER;

Even backtracking isn't going to help you disambiguate those first 
two alts of relationalExpression -- they're exactly identical.

I am aware of the fact that my grammar is ambiguous, but that's
something I have to live with.
I don't want to resolve the ambiguity, I want to recognize it and give a
warning to the end users.

Thanks again!

Cheers, Gerard

From tilman.walter at gmx.de  Fri Jul  4 01:07:11 2008
From: tilman.walter at gmx.de (tilman walter)
Date: Fri, 04 Jul 2008 10:07:11 +0200
Subject: [antlr-interest] declare throws-clause for rule
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D2437@UTEX01.be-value.nl>
References: <486CA6BD.3000104@gmx.de>
	<35AC19B502E98D42879AFA71FAD9CDCC2D2437@UTEX01.be-value.nl>
Message-ID: <486DDA2F.1060201@gmx.de>

Many thanks Gerard for your reply.
Probably this is the way i have to go, although i hoped to be able to 
say something like:

rule throws MyException :
     //...
     ;

so that the compiler does not complain about not throwing or declaring 
the exception i am about to catch.

But i'll go for your solution.
Thanks a lot again.

Tilman
Gerard van de Glind schrieb:
> Hi,
>
> Yes, you can throw an exception (a RuntTimeException to be precise,
> because these are unchecked) from your grammar. And you can catch these
> exceptions in the class that invokes the generated parser.
>
> Example:
> expression : ruleA | ruleB { if (condition) {throw new
> RunTimeException("");} };
>
> Also, code that you place in the @member action gets generated into your
> parser.
>
> Good luck!
>
> Cheers, Gerard
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of tilman walter
> Sent: donderdag 3 juli 2008 12:15
> To: ANTLR List
> Subject: [antlr-interest] declare throws-clause for rule
>
> Hi List,
>
> I am a newby to antlr.
> Is there a possibility to let a rule throw a custom exception that can 
> be catched by the class invoking the parser?
> I think i could place this piece of code in the generated class, but i 
> wonder if i can reach this through a grammar construct....
>
> I would appreciate for any hint.
> Thanks is advance.
>
> Tilman
>
>   


From tbrandonau at gmail.com  Fri Jul  4 01:38:39 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Fri, 4 Jul 2008 18:38:39 +1000
Subject: [antlr-interest] context information through rule parameters
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D24DC@UTEX01.be-value.nl>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
	<18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D22A6@UTEX01.be-value.nl>
	<80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>
	<20080703214400.73F24206E07B@spam.be-value.nl>
	<35AC19B502E98D42879AFA71FAD9CDCC2D24DC@UTEX01.be-value.nl>
Message-ID: <ebc876d70807040138i3713cd9bi62b1add5f81c25ce@mail.gmail.com>

On Fri, Jul 4, 2008 at 5:53 PM, Gerard van de Glind
<g.vandeglind at beinformed.nl> wrote:
> Hi Gavin and all,
>
> Thanks Gavin for your reply!
>
> At 20:04 3/07/2008, Gerard van de Glind wrote:
>  >Because of this, my grammar contains two rules that use
>  >backtracking. This also implies that it is impossible to
>  >replace these by syntactic predicates.
>
> You're mistaken about that -- all backtracking does is to insert
> automatic syntactic predicates, so anything you can do with
> backtracking you can do by writing your own synpreds.
>
> Yes, you are right about that. I know that backtracking inserts
> syntactic predicates under the hood. But is this the only thing it does?
> I have seen that ANTLR also generates the following statement: if (
> backtracking==0 ) So is the behavior of ANTLR with the backtrack option
> compared to ANTLR with my own syntactic predicates really the same? And
> is it always possible to replace the backtrack option with my own
> syntactic predicates in such a way that it accepts the same language?
>
The backtracking==0 just means is the grammar in guessing mode while
processing syntactic predicates. It is not specific to grammars with
backtracking=true. It is always possible to duplicate the results of
backtracking with manual syntactic predicates.
> It might just be more work than what you want to do :)
>
> Please explain, can you give me a hint of what I should do? Sofar, I
> didn't succeed in being able to make my grammar to accept the same
> language with my own syntactic predicates compared to the backtrack
> option.
You may be able to look at the code generated with backtracking and
get ideas from there. I think that it should only insert predicates
where necessary and should have comments for them. Though I might be
wrong in those assumptions. Otherwise I'm not too sure of any
particular hints. One trick is to try and make sure you identify the
root cause of an ambiguity. Often an ambiguity will flow on and
produce further ambiguities in higher-level rules, you want to
identify and solve the lowest level problems. But based on your
example I think you may need to rethink your approach.
>
> The grammar I presented is over simplified...in the original grammar I
> also use actions and interrule communication through parameter passing.
> I just learnt that it is possible to run into a situation where method
> arguments result in noncompilable code if you use backtracking and
> parameter passing a lot (paragraph 14.7 of The Definitive ANTLR
> Reference). A solution to this problem is to use dynamic scopes.
>
>  >      relationalExpression[boolean checkAmbiguity]
>  >        options {backtrack=true;}
>  >              :       formula[true]   (LET^ | GET^ | LT^ | GT^)
>  >formula[true]
>  >              |       dateAtom[true]  (LET^ | GET^ | LT^ | GT^)
>  >dateAtom[true]
>  >              |       booleanAtom[$checkAmbiguity]
>  >              ;
>  >
>  >      formula[boolean bool]
>  >              : IDENTIFIER;
>  >
>  >      dateAtom[boolean bool]
>  >              : IDENTIFIER;
>
> Even backtracking isn't going to help you disambiguate those first
> two alts of relationalExpression -- they're exactly identical.
>
> I am aware of the fact that my grammar is ambiguous, but that's
> something I have to live with.
> I don't want to resolve the ambiguity, I want to recognize it and give a
> warning to the end users.
What is the purpose of seperate rules for formula and dateAtom? They
both match the same thing, how are they suppossed to be useful? Surely
they should be rolled into a single alternative. While semantically
distinct, these are syntactically identical, there is no way to deal
with them seperately at this point. You may be able to use semantic
information (e.g. declared types) to resolve the ambiguity in a later
stage but your current approach just isn't right.

Tom.
>
> Thanks again!
>
> Cheers, Gerard
>

From AndrevdM at pyrogenesis.co.za  Fri Jul  4 05:36:00 2008
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Fri, 4 Jul 2008 14:36:00 +0200
Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions
Message-ID: <E7035321714C624BA01ADCBA6F99CADF0102FF75E12A@mercury.pyrogenesis.co.za>

Hi,

I can't get ANTLR 3.1b1 to generate ASTs using C#. Am I doing something wrong or is the beta not generating valid C# yet?


Here is the very simplistic grammar I use. Parsing "1+1" will break with a RewriteEmptyStreamExceptions

   grammar Simple;

   options
   {
      output=AST;
      ASTLabelType=CommonTree;
      language=CSharp2;
   }

   expr : INT '+' INT -> ^('+' INT+);
   INT : ('0'..'9')+;
   WS : (' '|'\t'|'\u000C'|'\r'|'\n') {Skip();};



Any ideas?



Thanks

Andre

From jaluber at gmx.de  Fri Jul  4 06:13:36 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 04 Jul 2008 15:13:36 +0200
Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions
In-Reply-To: <E7035321714C624BA01ADCBA6F99CADF0102FF75E12A@mercury.pyrogenesis.co.za>
References: <E7035321714C624BA01ADCBA6F99CADF0102FF75E12A@mercury.pyrogenesis.co.za>
Message-ID: <486E2200.8010105@gmx.de>

Andr? van der Merwe schrieb:
> Hi,
> 
> I can't get ANTLR 3.1b1 to generate ASTs using C#. Am I doing something wrong or is the beta not generating valid C# yet?
> 
> 
> Here is the very simplistic grammar I use. Parsing "1+1" will break with a RewriteEmptyStreamExceptions
> 
>    grammar Simple;
> 
>    options
>    {
>       output=AST;
>       ASTLabelType=CommonTree;
>       language=CSharp2;
>    }
> 
>    expr : INT '+' INT -> ^('+' INT+);
>    INT : ('0'..'9')+;
>    WS : (' '|'\t'|'\u000C'|'\r'|'\n') {Skip();};
> 
> 
> 
> Any ideas?
> 
> 
> 
> Thanks
> 
> Andre
> 
Do you use the binaries supplied in the distribiution? Those are 
accidentally slightly stale and require recompilation. Or you can use a 
download from Fisheye instead - there are lots of bugfixes included, 
which hamper even the rebuilt binaries of 3.1b1. Unfortunately, Ter has 
not created a daily build with the improvements included.

Johannes

From tilman.walter at gmx.de  Fri Jul  4 06:50:26 2008
From: tilman.walter at gmx.de (tilman walter)
Date: Fri, 04 Jul 2008 15:50:26 +0200
Subject: [antlr-interest] antlr and stringtemplate
Message-ID: <486E2AA2.8070600@gmx.de>

hi list,

are there any major restriction for using stringtemplate with a tree 
grammar.
I am trying to emit a simple text and set my options to this:
    output=template;
    rewrite=true;
    ASTLabelType = CommonTree;

Then i created  a  GroupFile  test.stg  with  a single entry:
test(id,value) ::= <<
just a trial text
 >>

In my tree grammar exists a rule:
assign:
    IDENT '=' VALUE
        -> assign(id={$IDENT},value={$VALUE})
    ;


The main class that invokes my parser,etc contains the code to
    ...
            String templateFile = "test.stg";
            Reader reader = new FileReader(templateFile);
            StringTemplateGroup templates = new StringTemplateGroup(reader);
            treeParser.setTemplateLib(templates);
            reader.close();
            MyTreeParser.start_return result = treeparser.start();
            System.out.println(result.getTemplate());
    ...

Unfortunately result alway is null, even though the template is loaded 
as far as my debugger is concerned.
Does every rule needs a template rewrite?

Maybe anybody can help.
Thanks Tilman

From markwright at internode.on.net  Fri Jul  4 07:16:20 2008
From: markwright at internode.on.net (Mark Wright)
Date: Sat, 5 Jul 2008 00:16:20 +1000
Subject: [antlr-interest] antlr and stringtemplate
In-Reply-To: <486E2AA2.8070600@gmx.de>
References: <486E2AA2.8070600@gmx.de>
Message-ID: <20080705001620.00007a32@goanna>

On Fri, 04 Jul 2008 15:50:26 +0200
tilman walter <tilman.walter at gmx.de> wrote:

> Does every rule needs a template rewrite?

I think yes, every rule in my tree grammmar has a template rewrite.

Thanks, Mark

-- 

From uw.anon at gmail.com  Fri Jul  4 14:06:04 2008
From: uw.anon at gmail.com (UW Student)
Date: Fri, 04 Jul 2008 17:06:04 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
Message-ID: <486E90BC.7000901@gmail.com>

Hello,

I'm having some trouble understanding the behaviour of Antlr's lexer.  I 
am quite new to Antlr (having previously focussed on JFlex) so please 
excuse me if this is a naive question.

My grammar is as follows

grammar Test;

nonTerm : TERM1 TERM2;

TERM1 : '..'+;
TERM2 : '.';

However, when I try to recognize the string '...' (without the quotes), 
AntlrWorks indicates a MismatchedTokenException.  (Looking at the 
generated code, I believe this is because TERM1 is consuming the third 
DOT and then failing to find a fourth.)  I do not understand why this is 
happening.

The above example is a toy language that I created to try to isolate the 
problem I was having.  My actual lexer looks more like this:

TERM1 : (' ' | '...')+
TERM2 : '.'

And I would like ' .' to be lexed as [TERM1, TERM2].

Any suggestions would be greatly appreciated.

Thanks,
Andrew

From jaluber at gmx.de  Fri Jul  4 14:26:50 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 04 Jul 2008 23:26:50 +0200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486E90BC.7000901@gmail.com>
References: <486E90BC.7000901@gmail.com>
Message-ID: <486E959A.1040000@gmx.de>

UW Student schrieb:
> Hello,
> 
> I'm having some trouble understanding the behaviour of Antlr's lexer.  I 
> am quite new to Antlr (having previously focussed on JFlex) so please 
> excuse me if this is a naive question.
> 
> My grammar is as follows
> 
> grammar Test;
> 
> nonTerm : TERM1 TERM2;
> 
> TERM1 : '..'+;
> TERM2 : '.';
> 
> However, when I try to recognize the string '...' (without the quotes), 
> AntlrWorks indicates a MismatchedTokenException.  (Looking at the 
> generated code, I believe this is because TERM1 is consuming the third 
> DOT and then failing to find a fourth.)  I do not understand why this is 
> happening.
> 
> The above example is a toy language that I created to try to isolate the 
> problem I was having.  My actual lexer looks more like this:
> 
> TERM1 : (' ' | '...')+
> TERM2 : '.'
> 
> And I would like ' .' to be lexed as [TERM1, TERM2].
> 
> Any suggestions would be greatly appreciated.
> 
> Thanks,
> Andrew
> 

ANTLR doesn't try TERM2 once it decides to try TERM1. This is a 
limitation of the analysis algorithm. To get your result, you have to 
try something like:

grammar Test2;

tokens{
TERM2;
}

nonTerm : TERM1 TERM2;


TERM1: '.' ( ('.')=> '.' {$type = TERM2;} ) ;

Johannes

From uw.anon at gmail.com  Fri Jul  4 14:46:51 2008
From: uw.anon at gmail.com (UW Student)
Date: Fri, 04 Jul 2008 17:46:51 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486E959A.1040000@gmx.de>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
Message-ID: <486E9A4B.8050909@gmail.com>

Johannes Luber wrote:
> UW Student schrieb:
>> Hello,
>>
>> I'm having some trouble understanding the behaviour of Antlr's lexer.  
>> I am quite new to Antlr (having previously focussed on JFlex) so 
>> please excuse me if this is a naive question.
>>
>> My grammar is as follows
>>
>> grammar Test;
>>
>> nonTerm : TERM1 TERM2;
>>
>> TERM1 : '..'+;
>> TERM2 : '.';
>>
>> However, when I try to recognize the string '...' (without the 
>> quotes), AntlrWorks indicates a MismatchedTokenException.  (Looking at 
>> the generated code, I believe this is because TERM1 is consuming the 
>> third DOT and then failing to find a fourth.)  I do not understand why 
>> this is happening.
>>
>> The above example is a toy language that I created to try to isolate 
>> the problem I was having.  My actual lexer looks more like this:
>>
>> TERM1 : (' ' | '...')+
>> TERM2 : '.'
>>
>> And I would like ' .' to be lexed as [TERM1, TERM2].
>>
>> Any suggestions would be greatly appreciated.
>>
>> Thanks,
>> Andrew
>>
> 
> ANTLR doesn't try TERM2 once it decides to try TERM1. This is a 
> limitation of the analysis algorithm. To get your result, you have to 
> try something like:
> 
> grammar Test2;
> 
> tokens{
> TERM2;
> }
> 
> nonTerm : TERM1 TERM2;
> 
> 
> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} ) ;
> 
> Johannes
> 

Hi Johannes,

Thank you for your prompt response.

I still have a couple of questions:

1) In my original grammar, how did the lexer decide which rule to 
attempt first?  Did it just pick the one that would result in the longer 
match?

2) Can you please confirm my understanding of your use of a syntactic 
predicate?  On a single DOT, the lexer will return a TERM1 token.  On a 
double DOT, the lexer will return a TERM2 token.  If this is the case, 
won't a triple DOT be lexed as TERM2 TERM1 (rather than the reverse)?

Thanks,
Andrew

From cvrebert at gmail.com  Fri Jul  4 15:04:02 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Fri, 4 Jul 2008 15:04:02 -0700
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486E9A4B.8050909@gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
Message-ID: <47c890dc0807041504j2a1c8ce1n6a4f39ae3767a126@mail.gmail.com>

On Fri, Jul 4, 2008 at 2:46 PM, UW Student <uw.anon at gmail.com> wrote:
> Johannes Luber wrote:
>>
>> UW Student schrieb:
>>>
>>> Hello,
>>>
>>> I'm having some trouble understanding the behaviour of Antlr's lexer.  I
>>> am quite new to Antlr (having previously focussed on JFlex) so please excuse
>>> me if this is a naive question.
>>>
>>> My grammar is as follows
>>>
>>> grammar Test;
>>>
>>> nonTerm : TERM1 TERM2;
>>>
>>> TERM1 : '..'+;
>>> TERM2 : '.';
>>>
>>> However, when I try to recognize the string '...' (without the quotes),
>>> AntlrWorks indicates a MismatchedTokenException.  (Looking at the generated
>>> code, I believe this is because TERM1 is consuming the third DOT and then
>>> failing to find a fourth.)  I do not understand why this is happening.
>>>
>>> The above example is a toy language that I created to try to isolate the
>>> problem I was having.  My actual lexer looks more like this:
>>>
>>> TERM1 : (' ' | '...')+
>>> TERM2 : '.'
>>>
>>> And I would like ' .' to be lexed as [TERM1, TERM2].
>>>
>>> Any suggestions would be greatly appreciated.
>>>
>>> Thanks,
>>> Andrew
>>>
>>
>> ANTLR doesn't try TERM2 once it decides to try TERM1. This is a limitation
>> of the analysis algorithm. To get your result, you have to try something
>> like:
>>
>> grammar Test2;
>>
>> tokens{
>> TERM2;
>> }
>>
>> nonTerm : TERM1 TERM2;
>>
>>
>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} ) ;
>>
>> Johannes
>>
>
> Hi Johannes,
>
> Thank you for your prompt response.
>
> I still have a couple of questions:
>
> 1) In my original grammar, how did the lexer decide which rule to attempt
> first?  Did it just pick the one that would result in the longer match?

It chooses the one that comes first in the grammar file, IIRC.
- Chris

>
> 2) Can you please confirm my understanding of your use of a syntactic
> predicate?  On a single DOT, the lexer will return a TERM1 token.  On a
> double DOT, the lexer will return a TERM2 token.  If this is the case, won't
> a triple DOT be lexed as TERM2 TERM1 (rather than the reverse)?
>
> Thanks,
> Andrew
>

From uw.anon at gmail.com  Fri Jul  4 15:26:25 2008
From: uw.anon at gmail.com (UW Student)
Date: Fri, 04 Jul 2008 18:26:25 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <47c890dc0807041504j2a1c8ce1n6a4f39ae3767a126@mail.gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>	
	<486E9A4B.8050909@gmail.com>
	<47c890dc0807041504j2a1c8ce1n6a4f39ae3767a126@mail.gmail.com>
Message-ID: <486EA391.2030704@gmail.com>

Chris Rebert wrote:
> On Fri, Jul 4, 2008 at 2:46 PM, UW Student <uw.anon at gmail.com> wrote:
>> Johannes Luber wrote:
>>> UW Student schrieb:
>>>> Hello,
>>>>
>>>> I'm having some trouble understanding the behaviour of Antlr's lexer.  I
>>>> am quite new to Antlr (having previously focussed on JFlex) so please excuse
>>>> me if this is a naive question.
>>>>
>>>> My grammar is as follows
>>>>
>>>> grammar Test;
>>>>
>>>> nonTerm : TERM1 TERM2;
>>>>
>>>> TERM1 : '..'+;
>>>> TERM2 : '.';
>>>>
>>>> However, when I try to recognize the string '...' (without the quotes),
>>>> AntlrWorks indicates a MismatchedTokenException.  (Looking at the generated
>>>> code, I believe this is because TERM1 is consuming the third DOT and then
>>>> failing to find a fourth.)  I do not understand why this is happening.
>>>>
>>>> The above example is a toy language that I created to try to isolate the
>>>> problem I was having.  My actual lexer looks more like this:
>>>>
>>>> TERM1 : (' ' | '...')+
>>>> TERM2 : '.'
>>>>
>>>> And I would like ' .' to be lexed as [TERM1, TERM2].
>>>>
>>>> Any suggestions would be greatly appreciated.
>>>>
>>>> Thanks,
>>>> Andrew
>>>>
>>> ANTLR doesn't try TERM2 once it decides to try TERM1. This is a limitation
>>> of the analysis algorithm. To get your result, you have to try something
>>> like:
>>>
>>> grammar Test2;
>>>
>>> tokens{
>>> TERM2;
>>> }
>>>
>>> nonTerm : TERM1 TERM2;
>>>
>>>
>>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} ) ;
>>>
>>> Johannes
>>>
>> Hi Johannes,
>>
>> Thank you for your prompt response.
>>
>> I still have a couple of questions:
>>
>> 1) In my original grammar, how did the lexer decide which rule to attempt
>> first?  Did it just pick the one that would result in the longer match?
> 
> It chooses the one that comes first in the grammar file, IIRC.
> - Chris
> 
>> 2) Can you please confirm my understanding of your use of a syntactic
>> predicate?  On a single DOT, the lexer will return a TERM1 token.  On a
>> double DOT, the lexer will return a TERM2 token.  If this is the case, won't
>> a triple DOT be lexed as TERM2 TERM1 (rather than the reverse)?
>>
>> Thanks,
>> Andrew
>>
> 

Hi Chris,

As far as I know, unlike in many lexer tools, that is not the case in 
Antlr.  I recall reading that somewhere on antlr.org.  More to the 
point, reversing the order of TERM1 and TERM2 in my original grammar 
(and/or in the rule nonTerm) results in precisely the same error message.

-Andrew

From cvrebert at gmail.com  Fri Jul  4 15:30:09 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Fri, 4 Jul 2008 15:30:09 -0700
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486EA391.2030704@gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<47c890dc0807041504j2a1c8ce1n6a4f39ae3767a126@mail.gmail.com>
	<486EA391.2030704@gmail.com>
Message-ID: <47c890dc0807041530y73facfb0jb05e51944db4374b@mail.gmail.com>

Pay no attention to the newbie (me) in the corner... :)
- Chris

On Fri, Jul 4, 2008 at 3:26 PM, UW Student <uw.anon at gmail.com> wrote:
> Chris Rebert wrote:
>>
>> On Fri, Jul 4, 2008 at 2:46 PM, UW Student <uw.anon at gmail.com> wrote:
>>>
>>> Johannes Luber wrote:
>>>>
>>>> UW Student schrieb:
>>>>>
>>>>> Hello,
>>>>>
>>>>> I'm having some trouble understanding the behaviour of Antlr's lexer.
>>>>>  I
>>>>> am quite new to Antlr (having previously focussed on JFlex) so please
>>>>> excuse
>>>>> me if this is a naive question.
>>>>>
>>>>> My grammar is as follows
>>>>>
>>>>> grammar Test;
>>>>>
>>>>> nonTerm : TERM1 TERM2;
>>>>>
>>>>> TERM1 : '..'+;
>>>>> TERM2 : '.';
>>>>>
>>>>> However, when I try to recognize the string '...' (without the quotes),
>>>>> AntlrWorks indicates a MismatchedTokenException.  (Looking at the
>>>>> generated
>>>>> code, I believe this is because TERM1 is consuming the third DOT and
>>>>> then
>>>>> failing to find a fourth.)  I do not understand why this is happening.
>>>>>
>>>>> The above example is a toy language that I created to try to isolate
>>>>> the
>>>>> problem I was having.  My actual lexer looks more like this:
>>>>>
>>>>> TERM1 : (' ' | '...')+
>>>>> TERM2 : '.'
>>>>>
>>>>> And I would like ' .' to be lexed as [TERM1, TERM2].
>>>>>
>>>>> Any suggestions would be greatly appreciated.
>>>>>
>>>>> Thanks,
>>>>> Andrew
>>>>>
>>>> ANTLR doesn't try TERM2 once it decides to try TERM1. This is a
>>>> limitation
>>>> of the analysis algorithm. To get your result, you have to try something
>>>> like:
>>>>
>>>> grammar Test2;
>>>>
>>>> tokens{
>>>> TERM2;
>>>> }
>>>>
>>>> nonTerm : TERM1 TERM2;
>>>>
>>>>
>>>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} ) ;
>>>>
>>>> Johannes
>>>>
>>> Hi Johannes,
>>>
>>> Thank you for your prompt response.
>>>
>>> I still have a couple of questions:
>>>
>>> 1) In my original grammar, how did the lexer decide which rule to attempt
>>> first?  Did it just pick the one that would result in the longer match?
>>
>> It chooses the one that comes first in the grammar file, IIRC.
>> - Chris
>>
>>> 2) Can you please confirm my understanding of your use of a syntactic
>>> predicate?  On a single DOT, the lexer will return a TERM1 token.  On a
>>> double DOT, the lexer will return a TERM2 token.  If this is the case,
>>> won't
>>> a triple DOT be lexed as TERM2 TERM1 (rather than the reverse)?
>>>
>>> Thanks,
>>> Andrew
>>>
>>
>
> Hi Chris,
>
> As far as I know, unlike in many lexer tools, that is not the case in Antlr.
>  I recall reading that somewhere on antlr.org.  More to the point, reversing
> the order of TERM1 and TERM2 in my original grammar (and/or in the rule
> nonTerm) results in precisely the same error message.
>
> -Andrew
>

From antlr at mirality.co.nz  Fri Jul  4 18:37:13 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 05 Jul 2008 13:37:13 +1200
Subject: [antlr-interest] context information through rule   parameters
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D24DC@UTEX01.be-value.nl>
References: <35AC19B502E98D42879AFA71FAD9CDCC2D228D@UTEX01.be-value.nl>
	<18DC69EC-3C59-45D3-9FED-7F00A4A29E34@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D22A6@UTEX01.be-value.nl>
	<80B653A7-A657-4445-A9CE-31DB1303A57E@cs.usfca.edu>
	<35AC19B502E98D42879AFA71FAD9CDCC2D23E6@UTEX01.be-value.nl>
	<20080703214400.73F24206E07B@spam.be-value.nl>
	<35AC19B502E98D42879AFA71FAD9CDCC2D24DC@UTEX01.be-value.nl>
Message-ID: <20080705013722.DB6B935229D@www.antlr.org>

I'm not sure what happened with your reply but it didn't come up 
quoted properly on my system.  Anyhow:

At 19:53 4/07/2008, Gerard van de Glind wrote:
 >Yes, you are right about that. I know that backtracking inserts
 >syntactic predicates under the hood. But is this the only thing 
it
 >does?
 >I have seen that ANTLR also generates the following statement: 
if
 >(backtracking==0 ) So is the behavior of ANTLR with the 
backtrack
 >option compared to ANTLR with my own syntactic predicates really 

 >the same?

I haven't looked at the specifics in a while, but IIRC all this 
does is to prevent it from raising errors while in backtracking 
mode -- it simply backs out of the rule.  As long as you use 
left-edge synpreds or gated sempreds then it should have the same 
effect, since those will normally be hoisted to the parent rule 
anyway.

 >And is it always possible to replace the backtrack option with 
my own
 >syntactic predicates in such a way that it accepts the same 
language?

As far as I know, yes.

 >Please explain, can you give me a hint of what I should do? 
Sofar,
 >I didn't succeed in being able to make my grammar to accept the
 >same language with my own syntactic predicates compared to the
 >backtrack option.

Basically you'll need to work out the alternative paths that the 
parser could follow from any given point; where there's ambiguity, 
you need to insert a synpred or sempred to guide it to take the 
path you want it to follow.  Synpreds basically let you define 
exactly how far it needs to look ahead (which is critical to get 
it to look past loop constructs), while synpreds let you do more 
esoteric checks, perhaps based on some kind of semantic knowledge 
of the input state.

The predicates need to be inserted early enough in the recognition 
sequence such that ANTLR never commits itself to the "wrong" path.

 >I am aware of the fact that my grammar is ambiguous, but that's
 >something I have to live with.
 >I don't want to resolve the ambiguity, I want to recognize it 
and
 >give a warning to the end users.

I think you missed my point.

The first alt of relationalExpression is this:
   formula[true] (LET^ | GET^ | LT^ | GT^) formula[true]

The second alt is this:
   dateAtom[true] (LET^ | GET^ | LT^ | GT^) dateAtom[true]

Both formula and dateAtom are defined as a single IDENTIFIER, so 
this means that the first alt is:
   IDENTIFIER (LET | GET | LT | GT) IDENTIFIER
And the second alt is:
   IDENTIFIER (LET | GET | LT | GT) IDENTIFIER

There is absolutely no difference and thus no possible way that 
ANTLR can decide which alt to use.  This is an example of a case 
where you'd need to use a sempred to disambiguate (you can't use a 
synpred because the token sequences are identical).


From antlr at mirality.co.nz  Fri Jul  4 18:56:08 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 05 Jul 2008 13:56:08 +1200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486E9A4B.8050909@gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
Message-ID: <20080705015617.4F01111ECD8@www.antlr.org>

At 09:46 5/07/2008, UW Student wrote:
 >1) In my original grammar, how did the lexer decide which rule 
to
 >attempt first?  Did it just pick the one that would result in 
the
 >longer match?

My understanding is that it prefers the longest match first; if it 
can't decide on that basis then it chooses the first listed one.

 >2) Can you please confirm my understanding of your use of a
 >syntactic predicate?  On a single DOT, the lexer will return
 >a TERM1 token.  On a double DOT, the lexer will return a TERM2
 >token.  If this is the case, won't a triple DOT be lexed as
 >TERM2 TERM1 (rather than the reverse)?

That's correct.  But isn't that what you want anyway?  (One thing 
that is different between the two: your original rule would turn 
'....' into a single TERM2 token, while Johannes' version would 
turn it into two TERM2 tokens.)

An unfortunate quirk of the recognition engine at the moment 
(which Johannes alluded to) is that once it is already "inside" a 
token, ANTLR tends to use only single character lookahead, 
especially when loop constructs are involved as well.  This is 
generally undesirable, but it can be worked around by merging 
rules like Johannes did (since using synpreds lets you specify 
arbitrary lookahead).  Hopefully it'll get resolved at some point 
:)


From antlr-interest at antlr.org  Fri Jul  4 19:21:24 2008
From: antlr-interest at antlr.org (VIAGRA  Official Site)
Date: Fri,  4 Jul 2008 19:21:24 -0700 (PDT)
Subject: [antlr-interest] Dear antlr-interest@antlr.org SALE 86% 0FF on
	Pfizer
Message-ID: <20080705112130.2595.qmail@server>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080704/2e564e05/attachment.html 

From uw.anon at gmail.com  Fri Jul  4 19:29:29 2008
From: uw.anon at gmail.com (UW Student)
Date: Fri, 04 Jul 2008 22:29:29 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
Message-ID: <486EDC89.5020501@gmail.com>

 >  >2) Can you please confirm my understanding of your use of a
 >  >syntactic predicate?  On a single DOT, the lexer will return
 >  >a TERM1 token.  On a double DOT, the lexer will return a TERM2
 >  >token.  If this is the case, won't a triple DOT be lexed as
 >  >TERM2 TERM1 (rather than the reverse)?
 >
 > That's correct.  But isn't that what you want anyway?  (One thing that
 > is different between the two: your original rule would turn '....' into
 > a single TERM2 token, while Johannes' version would turn it into two
 > TERM2 tokens.)

I would really prefer to have a single token.  Is it possible to modify 
Johannes' version to handle that?

Thanks,
Andrew

From jaluber at gmx.de  Sat Jul  5 04:45:06 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 05 Jul 2008 13:45:06 +0200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486EDC89.5020501@gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
	<486EDC89.5020501@gmail.com>
Message-ID: <486F5EC2.7010201@gmx.de>

UW Student schrieb:
>  >  >2) Can you please confirm my understanding of your use of a
>  >  >syntactic predicate?  On a single DOT, the lexer will return
>  >  >a TERM1 token.  On a double DOT, the lexer will return a TERM2
>  >  >token.  If this is the case, won't a triple DOT be lexed as
>  >  >TERM2 TERM1 (rather than the reverse)?
>  >
>  > That's correct.  But isn't that what you want anyway?  (One thing that
>  > is different between the two: your original rule would turn '....' into
>  > a single TERM2 token, while Johannes' version would turn it into two
>  > TERM2 tokens.)
> 
> I would really prefer to have a single token.  Is it possible to modify 
> Johannes' version to handle that?
> 
> Thanks,
> Andrew
> 

Try this:

TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;

Johannes

P.S. to Gavin: I've seen that a book of an author named Gavin Lambert is 
turned into a movie. Any chance that you lead a double life? ;)

From uw.anon at gmail.com  Sat Jul  5 07:49:31 2008
From: uw.anon at gmail.com (UW Student)
Date: Sat, 05 Jul 2008 10:49:31 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F5EC2.7010201@gmx.de>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
	<486EDC89.5020501@gmail.com> <486F5EC2.7010201@gmx.de>
Message-ID: <486F89FB.1030709@gmail.com>

>> I would really prefer to have a single token.  Is it possible to 
>> modify Johannes' version to handle that?
 >
> Try this:
> 
> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;

Will that ensure that the number of DOTs consumed is even?  If I 
understand correctly, it will simply catch any sequence of more than one 
DOT.

-Andrew

From tvial at octo.com  Sat Jul  5 08:06:58 2008
From: tvial at octo.com (Thomas Vial)
Date: Sat, 5 Jul 2008 17:06:58 +0200
Subject: [antlr-interest] Match any node/subtree
Message-ID: <475086500807050806nedecf2fo820ca08babf578b5@mail.gmail.com>

Hi,

Is there a way to have a rule, in a tree grammar, match any node/subtree
whatever it is (like a wildcard)? Something like:

rule:
   ^(NODE child) { doSomething($child); }   // child is any subtree, no
subrule to match it explicitely


Thanks,

Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080705/b6d4502e/attachment.html 

From jaluber at gmx.de  Sat Jul  5 08:11:41 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 05 Jul 2008 17:11:41 +0200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F89FB.1030709@gmail.com>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
	<486EDC89.5020501@gmail.com> <486F5EC2.7010201@gmx.de>
	<486F89FB.1030709@gmail.com>
Message-ID: <486F8F2D.50006@gmx.de>

UW Student schrieb:
>>> I would really prefer to have a single token.  Is it possible to 
>>> modify Johannes' version to handle that?
>  >
>> Try this:
>>
>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;
> 
> Will that ensure that the number of DOTs consumed is even?  If I 
> understand correctly, it will simply catch any sequence of more than one 
> DOT.
> 
> -Andrew
> 

No, it won't. Try this:

TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;

But I wonder: Do you really need to create such a rule for a particular 
language? Doing some regex should be faster there anywhere.

Johannes

From jaluber at gmx.de  Sat Jul  5 08:13:08 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 05 Jul 2008 17:13:08 +0200
Subject: [antlr-interest] Match any node/subtree
In-Reply-To: <475086500807050806nedecf2fo820ca08babf578b5@mail.gmail.com>
References: <475086500807050806nedecf2fo820ca08babf578b5@mail.gmail.com>
Message-ID: <486F8F84.5090200@gmx.de>

Thomas Vial schrieb:
> Hi,
> 
> Is there a way to have a rule, in a tree grammar, match any node/subtree 
> whatever it is (like a wildcard)? Something like:
> 
> rule:
>    ^(NODE child) { doSomething($child); }   // child is any subtree, no 
> subrule to match it explicitely
> 
> 
> Thanks,
> 
> Thomas

rule:
     ^(NODE child=.) { doSomething($child); };

should work.

Johannes

From uw.anon at gmail.com  Sat Jul  5 08:16:44 2008
From: uw.anon at gmail.com (UW Student)
Date: Sat, 05 Jul 2008 11:16:44 -0400
Subject: [antlr-interest] Match any node/subtree
In-Reply-To: <486F8F84.5090200@gmx.de>
References: <475086500807050806nedecf2fo820ca08babf578b5@mail.gmail.com>
	<486F8F84.5090200@gmx.de>
Message-ID: <486F905C.1020304@gmail.com>

Johannes Luber wrote:
 > UW Student schrieb:
 >>>> I would really prefer to have a single token.  Is it possible to
 >>>> modify Johannes' version to handle that?
 >>  >
 >>> Try this:
 >>>
 >>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;
 >>
 >> Will that ensure that the number of DOTs consumed is even?  If I
 >> understand correctly, it will simply catch any sequence of more than
 >> one DOT.
 >>
 >> -Andrew
 >>
 >
 > No, it won't. Try this:
 >
 > TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;
 >
 > But I wonder: Do you really need to create such a rule for a particular
 > language? Doing some regex should be faster there anywhere.
 >
 > Johannes
 >

Doesn't that have the original problem?  If there are three DOTs, then 
it will fail with a mismatched token exception, won't it?

The '...'+ tokens are filler (like whitespace or comments) in the 
language I'm translating.  It would be much easier to look past them if 
they were lumped together.

I agree that a regex would be a good solution for matching this token. 
I was hoping the Antlr lexer provided that kind of regex support.

Thanks,
Andrew

p.s. Is this thread starting to clutter the mailing list?  At what point 
is it appropriate to take it offline?

From jaluber at gmx.de  Sat Jul  5 08:26:35 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 05 Jul 2008 17:26:35 +0200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F8F2D.50006@gmx.de>
References: <486E90BC.7000901@gmail.com>
	<486E959A.1040000@gmx.de>	<486E9A4B.8050909@gmail.com>	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>	<486EDC89.5020501@gmail.com>
	<486F5EC2.7010201@gmx.de>	<486F89FB.1030709@gmail.com>
	<486F8F2D.50006@gmx.de>
Message-ID: <486F92AB.9070404@gmx.de>

UW Student schrieb:
 > Johannes Luber wrote:
 >  > UW Student schrieb:
 >  >>>> I would really prefer to have a single token.  Is it possible to
 >  >>>> modify Johannes' version to handle that?
 >  >>  >
 >  >>> Try this:
 >  >>>
 >  >>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;
 >  >>
 >  >> Will that ensure that the number of DOTs consumed is even?  If I
 >  >> understand correctly, it will simply catch any sequence of more than
 >  >> one DOT.
 >  >>
 >  >> -Andrew
 >  >>
 >  >
 >  > No, it won't. Try this:
 >  >
 >  > TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;
 >  >
 >  > But I wonder: Do you really need to create such a rule for a 
particular
 >  > language? Doing some regex should be faster there anywhere.
 >  >
 >  > Johannes
 >  >
 >
 > Doesn't that have the original problem?  If there are three DOTs, then
 > it will fail with a mismatched token exception, won't it?
 >
 > The '...'+ tokens are filler (like whitespace or comments) in the
 > language I'm translating.  It would be much easier to look past them if
 > they were lumped together.
 >
 > I agree that a regex would be a good solution for matching this token. I
 > was hoping the Antlr lexer provided that kind of regex support.

If you want to treat '..' as filler, why don't you change the channel of 
the TERM1 and TERM2 tokens? That way the number of tokens is irrelevant 
(beyound some small increase of the memory footprint) and your grammar 
can ignore those tokens at later stage.
 >
 > Thanks,
 > Andrew
 >
 > p.s. Is this thread starting to clutter the mailing list?  At what point
 > is it appropriate to take it offline?
 >
As long it is about ANTLR you can use the mailing list.

Johannes

From rusinskystanislas at yahoo.fr  Sat Jul  5 09:09:42 2008
From: rusinskystanislas at yahoo.fr (Stanislas Rusinsky)
Date: Sat, 5 Jul 2008 16:09:42 +0000 (GMT)
Subject: [antlr-interest] gunit tree testsuite can't find the group template
	file
Message-ID: <464405.77191.qm@web26504.mail.ukl.yahoo.com>

Hello all, 

(I almost wrote "hello ANTLeRs"... happily babelfish saved me from my french ignorance of english subtleties)


The problem: I have a text grammar and a tree grammar. 

The tree grammar has its group template file loaded with these commands:
        FileReader groupFileR = new FileReader("treeKoRuGenClasses.stg"); 
        StringTemplateGroup templates = new StringTemplateGroup(groupFileR); 
        groupFileR.close(); 
        walker.setTemplateLib(templates); // where to find templates

Running the tree parser works like a charm with this code.

The gunit testsuite works fine with the text grammar, but the tree grammar gunit testsuite complains it can't "find template entity_modifiers.st; group hierarchy is [treeKoRuGenClassesTemplates]".
The path includes the directory containing the template group file.

I have tried renaming my .stg file to treeKoRuGenClassesTemplates.stg as suggested by the trace, changing also the first line to "group treeKoRuGenClassesTemplates;" but nothing helped, I still get the stacktrace (see below).

It seems the java class generated from the tree sets a default empty template group ( protected StringTemplateGroup templateLib = new StringTemplateGroup("treeKoRuGenClassesTemplates", AngleBracketTemplateLexer.class); ). Should I use a streamreader in my treeKoRuGenClasses.g to read the stg group file and set it with some sort of "this.setTemplateLib(myTemplateGroupFileStream)" ? 

Anyone could give me some advice, hint, or broaden my vision on this subject?

Thanks in advance,

Stanislas Herman Rusinsky.

test-tree:
     [java] java.lang.reflect.InvocationTargetException
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
     [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
     [java]     at java.lang.reflect.Method.invoke(Method.java:585)
     [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser(gUnitExecuter.java:392)
     [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser(gUnitExecuter.java:133)
     [java]     at org.antlr.gunit.gUnitExecuter.executeTests(gUnitExecuter.java:149)
     [java]     at org.antlr.gunit.gUnitExecuter.execTest(gUnitExecuter.java:92)
     [java]     at org.antlr.gunit.Interp.main(Interp.java:62)
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
     [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
     [java]     at java.lang.reflect.Method.invoke(Method.java:585)
     [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.run(ExecuteJava.java:217)
     [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.execute(ExecuteJava.java:152)
     [java]     at org.apache.tools.ant.taskdefs.Java.run(Java.java:747)
     [java]     at org.apache.tools.ant.taskdefs.Java.executeJava(Java.java:201)
     [java]     at org.apache.tools.ant.taskdefs.Java.execute(Java.java:104)
     [java]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
     [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
     [java]     at java.lang.reflect.Method.invoke(Method.java:585)
     [java]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)
     [java]     at org.apache.tools.ant.Task.perform(Task.java:348)
     [java]     at org.apache.tools.ant.Target.execute(Target.java:357)
     [java]     at org.apache.tools.ant.Target.performTasks(Target.java:385)
     [java]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)
     [java]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)
     [java]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
     [java]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)
     [java]     at org.apache.tools.ant.Main.runBuild(Main.java:698)
     [java]     at org.apache.tools.ant.Main.startAnt(Main.java:199)
     [java]     at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)
     [java]     at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)
     [java] Caused by: java.lang.IllegalArgumentException: Can't find template entity_modifiers.st; group hierarchy is [treeKoRuGenClassesTemplates]
     [java]     at org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:507)
     [java]     at org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
     [java]     at org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
     [java]     at org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:412)
     [java]     at com.mindspark.koru.treeKoRuGenClasses.entity_modifiers(Unknown Source)
     [java]     at com.mindspark.koru.treeKoRuGenClasses.entity(Unknown Source)
     [java]     at com.mindspark.koru.treeKoRuGenClasses.koru(Unknown Source)
     [java]     ... 35 more
     [java] org.apache.tools.ant.ExitException: Permission (java.lang.RuntimePermission exitVM) was not granted.
     [java]     at org.apache.tools.ant.types.Permissions$MySM.checkExit(Permissions.java:174)
     [java]     at java.lang.Runtime.exit(Runtime.java:88)
     [java]     at java.lang.System.exit(System.java:869)
     [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser(gUnitExecuter.java:460)
     [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser(gUnitExecuter.java:133)
     [java]     at org.antlr.gunit.gUnitExecuter.executeTests(gUnitExecuter.java:149)
     [java]     at org.antlr.gunit.gUnitExecuter.execTest(gUnitExecuter.java:92)
     [java]     at org.antlr.gunit.Interp.main(Interp.java:62)


      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr



      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From l0calh05t at gmx.net  Sat Jul  5 09:37:32 2008
From: l0calh05t at gmx.net (Joe)
Date: Sat, 05 Jul 2008 18:37:32 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And other Unicode
	properties)
Message-ID: <486FA34C.3070606@gmx.net>

Are Unicode properties supported by Antlr in any way? It would be nice 
to be able to simply lex unicode identifiers as ID : XID_Start 
XID_Continue*
Or would I have to write a script that creates the appropriate lexer 
fragments from 
http://unicode.org/Public/UNIDATA/DerivedCoreProperties.txt ?

-- 
Generally speaking, things have gone about as far
as they can possibly go, when things have gotten
about as bad as they can reasonably get.


From leon.antlr at mac.com  Sat Jul  5 11:23:54 2008
From: leon.antlr at mac.com (Leon Su)
Date: Sat, 05 Jul 2008 11:23:54 -0700
Subject: [antlr-interest] gunit tree testsuite can't find the group
 template file
In-Reply-To: <464405.77191.qm@web26504.mail.ukl.yahoo.com>
References: <464405.77191.qm@web26504.mail.ukl.yahoo.com>
Message-ID: <2B665E6C-F608-42FC-B396-E2F0B2BE810F@mac.com>

Hi Stanislas,

gUnit currently can only test on plain parser/tree grammar, and  
doesn't support loading group file(*.stg) or setting customized tree  
adaptor yet.
The functionality such as walker.etTemplateLib() and  
parser.setTreeAdaptor() will be added into the next release. Sorry  
for the inconvenience.

Leon

On Jul 5, 2008, at 9:09 AM, Stanislas Rusinsky wrote:

> Hello all,
>
> (I almost wrote "hello ANTLeRs"... happily babelfish saved me from  
> my french ignorance of english subtleties)
>
>
> The problem: I have a text grammar and a tree grammar.
>
> The tree grammar has its group template file loaded with these  
> commands:
>         FileReader groupFileR = new FileReader 
> ("treeKoRuGenClasses.stg");
>         StringTemplateGroup templates = new StringTemplateGroup 
> (groupFileR);
>         groupFileR.close();
>         walker.setTemplateLib(templates); // where to find templates
>
> Running the tree parser works like a charm with this code.
>
> The gunit testsuite works fine with the text grammar, but the tree  
> grammar gunit testsuite complains it can't "find template  
> entity_modifiers.st; group hierarchy is  
> [treeKoRuGenClassesTemplates]".
> The path includes the directory containing the template group file.
>
> I have tried renaming my .stg file to  
> treeKoRuGenClassesTemplates.stg as suggested by the trace, changing  
> also the first line to "group treeKoRuGenClassesTemplates;" but  
> nothing helped, I still get the stacktrace (see below).
>
> It seems the java class generated from the tree sets a default  
> empty template group ( protected StringTemplateGroup templateLib =  
> new StringTemplateGroup("treeKoRuGenClassesTemplates",  
> AngleBracketTemplateLexer.class); ). Should I use a streamreader in  
> my treeKoRuGenClasses.g to read the stg group file and set it with  
> some sort of "this.setTemplateLib(myTemplateGroupFileStream)" ?
>
> Anyone could give me some advice, hint, or broaden my vision on  
> this subject?
>
> Thanks in advance,
>
> Stanislas Herman Rusinsky.
>
> test-tree:
>      [java] java.lang.reflect.InvocationTargetException
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser 
> (gUnitExecuter.java:392)
>      [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser 
> (gUnitExecuter.java:133)
>      [java]     at org.antlr.gunit.gUnitExecuter.executeTests 
> (gUnitExecuter.java:149)
>      [java]     at org.antlr.gunit.gUnitExecuter.execTest 
> (gUnitExecuter.java:92)
>      [java]     at org.antlr.gunit.Interp.main(Interp.java:62)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.run 
> (ExecuteJava.java:217)
>      [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.execute 
> (ExecuteJava.java:152)
>      [java]     at org.apache.tools.ant.taskdefs.Java.run(Java.java: 
> 747)
>      [java]     at org.apache.tools.ant.taskdefs.Java.executeJava 
> (Java.java:201)
>      [java]     at org.apache.tools.ant.taskdefs.Java.execute 
> (Java.java:104)
>      [java]     at org.apache.tools.ant.UnknownElement.execute 
> (UnknownElement.java:288)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at  
> org.apache.tools.ant.dispatch.DispatchUtils.execute 
> (DispatchUtils.java:105)
>      [java]     at org.apache.tools.ant.Task.perform(Task.java:348)
>      [java]     at org.apache.tools.ant.Target.execute(Target.java: 
> 357)
>      [java]     at org.apache.tools.ant.Target.performTasks 
> (Target.java:385)
>      [java]     at org.apache.tools.ant.Project.executeSortedTargets 
> (Project.java:1329)
>      [java]     at org.apache.tools.ant.Project.executeTarget 
> (Project.java:1298)
>      [java]     at  
> org.apache.tools.ant.helper.DefaultExecutor.executeTargets 
> (DefaultExecutor.java:41)
>      [java]     at org.apache.tools.ant.Project.executeTargets 
> (Project.java:1181)
>      [java]     at org.apache.tools.ant.Main.runBuild(Main.java:698)
>      [java]     at org.apache.tools.ant.Main.startAnt(Main.java:199)
>      [java]     at org.apache.tools.ant.launch.Launcher.run 
> (Launcher.java:257)
>      [java]     at org.apache.tools.ant.launch.Launcher.main 
> (Launcher.java:104)
>      [java] Caused by: java.lang.IllegalArgumentException: Can't  
> find template entity_modifiers.st; group hierarchy is  
> [treeKoRuGenClassesTemplates]
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate 
> (StringTemplateGroup.java:507)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:392)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:404)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:412)
>      [java]     at  
> com.mindspark.koru.treeKoRuGenClasses.entity_modifiers(Unknown Source)
>      [java]     at com.mindspark.koru.treeKoRuGenClasses.entity 
> (Unknown Source)
>      [java]     at com.mindspark.koru.treeKoRuGenClasses.koru 
> (Unknown Source)
>      [java]     ... 35 more
>      [java] org.apache.tools.ant.ExitException: Permission  
> (java.lang.RuntimePermission exitVM) was not granted.
>      [java]     at org.apache.tools.ant.types.Permissions 
> $MySM.checkExit(Permissions.java:174)
>      [java]     at java.lang.Runtime.exit(Runtime.java:88)
>      [java]     at java.lang.System.exit(System.java:869)
>      [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser 
> (gUnitExecuter.java:460)
>      [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser 
> (gUnitExecuter.java:133)
>      [java]     at org.antlr.gunit.gUnitExecuter.executeTests 
> (gUnitExecuter.java:149)
>      [java]     at org.antlr.gunit.gUnitExecuter.execTest 
> (gUnitExecuter.java:92)
>      [java]     at org.antlr.gunit.Interp.main(Interp.java:62)
>
>
>        
> ______________________________________________________________________ 
> _______
> Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http:// 
> mail.yahoo.fr
>
>
>
>        
> ______________________________________________________________________ 
> _______
> Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http:// 
> mail.yahoo.fr


From uw.anon at gmail.com  Sat Jul  5 12:10:26 2008
From: uw.anon at gmail.com (UW Student)
Date: Sat, 05 Jul 2008 15:10:26 -0400
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F92AB.9070404@gmx.de>
References: <486E90BC.7000901@gmail.com>
	<486E959A.1040000@gmx.de>	<486E9A4B.8050909@gmail.com>	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>	<486EDC89.5020501@gmail.com>
	<486F5EC2.7010201@gmx.de>	<486F89FB.1030709@gmail.com>
	<486F8F2D.50006@gmx.de> <486F92AB.9070404@gmx.de>
Message-ID: <486FC722.9090808@gmail.com>

Johannes Luber wrote:
> UW Student schrieb:
>  > Johannes Luber wrote:
>  >  > UW Student schrieb:
>  >  >>>> I would really prefer to have a single token.  Is it possible to
>  >  >>>> modify Johannes' version to handle that?
>  >  >>  >
>  >  >>> Try this:
>  >  >>>
>  >  >>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;
>  >  >>
>  >  >> Will that ensure that the number of DOTs consumed is even?  If I
>  >  >> understand correctly, it will simply catch any sequence of more than
>  >  >> one DOT.
>  >  >>
>  >  >> -Andrew
>  >  >>
>  >  >
>  >  > No, it won't. Try this:
>  >  >
>  >  > TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;
>  >  >
>  >  > But I wonder: Do you really need to create such a rule for a 
> particular
>  >  > language? Doing some regex should be faster there anywhere.
>  >  >
>  >  > Johannes
>  >  >
>  >
>  > Doesn't that have the original problem?  If there are three DOTs, then
>  > it will fail with a mismatched token exception, won't it?
>  >
>  > The '...'+ tokens are filler (like whitespace or comments) in the
>  > language I'm translating.  It would be much easier to look past them if
>  > they were lumped together.
>  >
>  > I agree that a regex would be a good solution for matching this token. I
>  > was hoping the Antlr lexer provided that kind of regex support.
> 
> If you want to treat '..' as filler, why don't you change the channel of 
> the TERM1 and TERM2 tokens? That way the number of tokens is irrelevant 
> (beyound some small increase of the memory footprint) and your grammar 
> can ignore those tokens at later stage.
>  >
>  > Thanks,
>  > Andrew
>  >
>  > p.s. Is this thread starting to clutter the mailing list?  At what point
>  > is it appropriate to take it offline?
>  >
> As long it is about ANTLR you can use the mailing list.
> 
> Johannes
> 
UW Student wrote:
 > Johannes Luber wrote:
 >> UW Student schrieb:
 >>  > Johannes Luber wrote:
 >>  >  > UW Student schrieb:
 >>  >  >>>> I would really prefer to have a single token.  Is it 
possible to
 >>  >  >>>> modify Johannes' version to handle that?
 >>  >  >>  >
 >>  >  >>> Try this:
 >>  >  >>>
 >>  >  >>> TERM1: '.' ( ('.')=> '.' {$type = TERM2;} )* ;
 >>  >  >>
 >>  >  >> Will that ensure that the number of DOTs consumed is even?  If I
 >>  >  >> understand correctly, it will simply catch any sequence of more
 >> than
 >>  >  >> one DOT.
 >>  >  >>
 >>  >  >> -Andrew
 >>  >  >>
 >>  >  >
 >>  >  > No, it won't. Try this:
 >>  >  >
 >>  >  > TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;
 >>  >  >
 >>  >  > But I wonder: Do you really need to create such a rule for a
 >> particular
 >>  >  > language? Doing some regex should be faster there anywhere.
 >>  >  >
 >>  >  > Johannes
 >>  >  >
 >>  >
 >>  > Doesn't that have the original problem?  If there are three DOTs, 
then
 >>  > it will fail with a mismatched token exception, won't it?
 >>  >
 >>  > The '...'+ tokens are filler (like whitespace or comments) in the
 >>  > language I'm translating.  It would be much easier to look past
 >> them if
 >>  > they were lumped together.
 >>  >
 >>  > I agree that a regex would be a good solution for matching this
 >> token. I
 >>  > was hoping the Antlr lexer provided that kind of regex support.
 >>
 >> If you want to treat '..' as filler, why don't you change the channel
 >> of the TERM1 and TERM2 tokens? That way the number of tokens is
 >> irrelevant (beyound some small increase of the memory footprint) and
 >> your grammar can ignore those tokens at later stage.
 >>  >
 >>  > Thanks,
 >>  > Andrew
 >>  >
 >>  > p.s. Is this thread starting to clutter the mailing list?  At what
 >> point
 >>  > is it appropriate to take it offline?
 >>  >
 >> As long it is about ANTLR you can use the mailing list.
 >>
 >> Johannes
 >>
 >
 > Alright, time to be more explicit about the real problem.
 >
 > '...' serves as the line continuation character.  Usually, that means
 > that it can be ignored as long as it also hides the following newline.
 > Unfortunately, in this language, it is sometimes significant.
 >
 > Ex 1
 >
 > x = 1 + ...
 > 2;
 >
 > In this case, it can be ignored.
 >
 > Ex 2
 >
 > [x ...
 > y];
 >
 > In this case, I want to turn it into a comma separating x and y.
 >
 > Ex 3
 >
 > [x ...
 > ...
 > y];
 >
 > In this case, I want a single comma, not two.
 >
 > As far as I can tell, to be able to handle this sort of thing I need to
 > keep '...' on the default channel (rather than the hidden channel). This
 > means that in some cases I will need to account for it in predicates
 > that use lookahead.  It would be much easier if contiguous filler text
 > was treated as a single token so that it would occupy only one lookahead
 > position.
 >
 > Secondarily, if they are lumped together, it is easier to avoid
 > inserting duplicate commas.
 >
 > I'm pretty sure I've solved the parser problem, so I may just switch to
 > a separate JFlex lexer.  However, I'd prefer to keep everything in Antlr
 > if I can.
 >
 > -Andrew
 >

Hi Johannes,

Using the syntactic predicate solved my problem.  I had tried that 
before, but I didn't realize that I had to apply the predicate to the 
subrule calling the lexer fragment rather than to the fragment itself 
(sometimes you have to look at the generated code ;)).

I'm still a little surprised that Antlr doesn't handle this sort of 
thing automatically, but at least there's a way to do it manually.

Thanks for your help!

-Andrew

From dave at badgers-in-foil.co.uk  Sat Jul  5 12:28:37 2008
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Sat, 5 Jul 2008 20:28:37 +0100
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And other
	Unicode properties)
In-Reply-To: <486FA34C.3070606@gmx.net>
References: <486FA34C.3070606@gmx.net>
Message-ID: <20080705192836.GA10250@badgers-in-foil.co.uk>

On Sat, Jul 05, 2008 at 06:37:32PM +0200, Joe wrote:
> Are Unicode properties supported by Antlr in any way? It would be nice 
> to be able to simply lex unicode identifiers as ID : XID_Start 
> XID_Continue*
> Or would I have to write a script that creates the appropriate lexer 
> fragments from 
> http://unicode.org/Public/UNIDATA/DerivedCoreProperties.txt ?

Here's what I hacked up to do something like that, using ICU4J,

  http://lists.badgers-in-foil.co.uk/pipermail/metaas-dev/attachments/20070307/abfef6e7/UnicodeIdentifierGenerator.java

I think the ICU UCharacter[1] class would allow codepoints to be tested
against the XID* properties[2] in the same way, if the script doesn't
already do what you want.

[1] http://www.icu-project.org/apiref/icu4j/com/ibm/icu/lang/UCharacter.html
[2] http://www.icu-project.org/apiref/icu4j/com/ibm/icu/lang/UProperty.html#XID_CONTINUE


ta,
dave

-- 
http://david.holroyd.me.uk/

From parrt at cs.usfca.edu  Sat Jul  5 13:49:31 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 5 Jul 2008 13:49:31 -0700
Subject: [antlr-interest] antlr and stringtemplate
In-Reply-To: <20080705001620.00007a32@goanna>
References: <486E2AA2.8070600@gmx.de> <20080705001620.00007a32@goanna>
Message-ID: <5E5ED077-8A44-4518-A6FF-998FC3E39371@cs.usfca.edu>

But,By default no template is created unless you specifically say so.   
This is an awkward part of the template mechanism at this point.
Ter
On Jul 4, 2008, at 7:16 AM, Mark Wright wrote:

> On Fri, 04 Jul 2008 15:50:26 +0200
> tilman walter <tilman.walter at gmx.de> wrote:
>
>> Does every rule needs a template rewrite?
>
> I think yes, every rule in my tree grammmar has a template rewrite.
>
> Thanks, Mark
>
> -- 


From parrt at cs.usfca.edu  Sat Jul  5 13:49:51 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 5 Jul 2008 13:49:51 -0700
Subject: [antlr-interest] antlr and stringtemplate
In-Reply-To: <20080705001620.00007a32@goanna>
References: <486E2AA2.8070600@gmx.de> <20080705001620.00007a32@goanna>
Message-ID: <757C8C45-2716-47CC-8250-E665C1DD2673@cs.usfca.edu>

PS: try $ruleref.textFor rules that have no template created.
Ter
On Jul 4, 2008, at 7:16 AM, Mark Wright wrote:

> On Fri, 04 Jul 2008 15:50:26 +0200
> tilman walter <tilman.walter at gmx.de> wrote:
>
>> Does every rule needs a template rewrite?
>
> I think yes, every rule in my tree grammmar has a template rewrite.
>
> Thanks, Mark
>
> -- 


From sven at efftinge.de  Sat Jul  5 14:39:49 2008
From: sven at efftinge.de (Sven Efftinge)
Date: Sat, 5 Jul 2008 23:39:49 +0200
Subject: [antlr-interest] variables, alternatives and actions
Message-ID: <B12B40DA-FCCB-4887-B567-8BD763D01E70@efftinge.de>

Hi,

in the following example the token is not assigned to the variable  
because the alternative contains actions:

var=('+' { /* my action */} |'-' { /* my action */ })

Is this intended or is it a bug? If it's a bug, has it been fixed in  
the latest version?
I'm using 3.0.1 and the Java target.

thanks,
Sven
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080705/e54f9535/attachment.html 

From parrt at cs.usfca.edu  Sat Jul  5 15:02:00 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 5 Jul 2008 15:02:00 -0700
Subject: [antlr-interest] variables, alternatives and actions
In-Reply-To: <B12B40DA-FCCB-4887-B567-8BD763D01E70@efftinge.de>
References: <B12B40DA-FCCB-4887-B567-8BD763D01E70@efftinge.de>
Message-ID: <918D19E6-4CD3-4442-87F8-2976CD78F2DA@cs.usfca.edu>

Sorry about that...haven't implemented labels for subrules yet...sets  
(no actions) work as special case.
Ter
On Jul 5, 2008, at 2:39 PM, Sven Efftinge wrote:

> Hi,
>
> in the following example the token is not assigned to the variable  
> because the alternative contains actions:
>
> var=('+' { /* my action */} |'-' { /* my action */ })
>
> Is this intended or is it a bug? If it's a bug, has it been fixed in  
> the latest version?
> I'm using 3.0.1 and the Java target.
>
> thanks,
> Sven


From antlr at mirality.co.nz  Sat Jul  5 15:14:58 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 06 Jul 2008 10:14:58 +1200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F5EC2.7010201@gmx.de>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
	<486EDC89.5020501@gmail.com> <486F5EC2.7010201@gmx.de>
Message-ID: <20080705221505.8A41E11ED92@www.antlr.org>

At 23:45 5/07/2008, Johannes Luber wrote:
 >P.S. to Gavin: I've seen that a book of an author named
 >Gavin Lambert is turned into a movie. Any chance that you
 >lead a double life? ;)

Nope, sorry, different guy.  While I've written a few short 
stories I've never tried to get anything published ;)


From antlr at mirality.co.nz  Sat Jul  5 15:20:13 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 06 Jul 2008 10:20:13 +1200
Subject: [antlr-interest] [newbie] Lexer Confusion
In-Reply-To: <486F8F2D.50006@gmx.de>
References: <486E90BC.7000901@gmail.com> <486E959A.1040000@gmx.de>
	<486E9A4B.8050909@gmail.com>
	<486ed4c0.1ed6720a.61d0.ffffcaa2SMTPIN_ADDED@mx.google.com>
	<486EDC89.5020501@gmail.com> <486F5EC2.7010201@gmx.de>
	<486F89FB.1030709@gmail.com> <486F8F2D.50006@gmx.de>
Message-ID: <20080705222023.3488C11ED93@www.antlr.org>

At 03:11 6/07/2008, Johannes Luber wrote:
 >No, it won't. Try this:
 >
 >TERM1: '.' ( ('.')=> '.' {$type = TERM2;} '..'* ) ;

I think that one has the same ambiguity problem as the first 
(ANTLR will see the next character is a dot and then try to match 
a full '..' out of it).  And the second-dot alt needs to be made 
optional so that ANTLR can match a single dot.  This should work 
better:

TERM1
   : '.'
     ( ('.') => '.' { $type = TERM2; }
       ( ('..') => '..' )*
     )?
   ;


I hope this isn't homework, though.  If so, you should be working 
this stuff out yourself :P


From antlr at mirality.co.nz  Sat Jul  5 15:24:55 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 06 Jul 2008 10:24:55 +1200
Subject: [antlr-interest] variables, alternatives and actions
In-Reply-To: <B12B40DA-FCCB-4887-B567-8BD763D01E70@efftinge.de>
References: <B12B40DA-FCCB-4887-B567-8BD763D01E70@efftinge.de>
Message-ID: <20080705222506.4ADEA11EAB1@www.antlr.org>

At 09:39 6/07/2008, Sven Efftinge wrote:
>in the following example the token is not assigned to the 
>variable because the alternative contains actions:
>
>var=('+' { /* my action */} |'-' { /* my action */ })
>
>Is this intended or is it a bug? If it's a bug, has it been fixed 
>in the latest version?
>I'm using 3.0.1 and the Java target.

Just to expand on what Ter said a bit: it's not the fact that 
there's actions there that makes it not work, it's because you 
have "var=(...)".  Change this to:

(var='+' { /* stuff */} | var='-' { /* other stuff */ })

and it should work.


From l0calh05t at gmx.net  Sat Jul  5 15:47:47 2008
From: l0calh05t at gmx.net (Joe)
Date: Sun, 06 Jul 2008 00:47:47 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
Message-ID: <486FFA13.1020606@gmx.net>


>> Are Unicode properties supported by Antlr in any way? It would be nice 
>> to be able to simply lex unicode identifiers as ID : XID_Start 
>> XID_Continue*
>> Or would I have to write a script that creates the appropriate lexer 
>> fragments from 
>> http://unicode.org/Public/UNIDATA/DerivedCoreProperties.txt ?
>>     
>
> Here's what I hacked up to do something like that, using ICU4J,
>
>   http://lists.badgers-in-foil.co.uk/pipermail/metaas-dev/attachments/20070307/abfef6e7/UnicodeIdentifierGenerator.java
>
> I think the ICU UCharacter[1] class would allow codepoints to be tested
> against the XID* properties[2] in the same way, if the script doesn't
> already do what you want.
>
> [1] http://www.icu-project.org/apiref/icu4j/com/ibm/icu/lang/UCharacter.html
> [2] http://www.icu-project.org/apiref/icu4j/com/ibm/icu/lang/UProperty.html#XID_CONTINUE
>
>
> ta,
> dave
>   
So they are unsupported. And apparently UTF-16 isn't even really 
supported. Shouldn't this stuff be fairly easy to implement? The java 
version of LA already returns an int, so why not add UTF-16 decoding to 
it? And properties could be implemented via ICU

-- 
Generally speaking, things have gone about as far
as they can possibly go, when things have gotten
about as bad as they can reasonably get.


From antlr at mirality.co.nz  Sat Jul  5 15:59:48 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 06 Jul 2008 10:59:48 +1200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <486FFA13.1020606@gmx.net>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
	<486FFA13.1020606@gmx.net>
Message-ID: <20080705225958.0E74311EC82@www.antlr.org>

At 10:47 6/07/2008, Joe wrote:
 >So they are unsupported. And apparently UTF-16 isn't even really 

 >supported. Shouldn't this stuff be fairly easy to implement? The 

 >java version of LA already returns an int, so why not add UTF-16 

 >decoding to it? And properties could be implemented via ICU

While you cannot directly specify Unicode characters in an ANTLR 
grammar (because grammars are parsed by ANTLR 2, which doesn't 
understand Unicode), ANTLR 3 handles Unicode just fine.  So while 
you need to use Unicode escapes in your grammar you shouldn't have 
problems defining rules for any characters you want to recognise 
in your own lexers.


From camerons at microsoft.com  Sat Jul  5 16:07:17 2008
From: camerons at microsoft.com (Cameron Skinner)
Date: Sat, 5 Jul 2008 16:07:17 -0700
Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions
Message-ID: <E77E96B6A3DEE24CB77E4F7130C910DA6BE10C5952@NA-EXMSG-C117.redmond.corp.microsoft.com>

I think it might have something to do with the fact that you have the plus operator on the INT token in the rewrite rule, but not in the parser rule itself?

-----Original Message-----
From: Andr? van der Merwe <AndrevdM at pyrogenesis.co.za>
Sent: Friday, July 04, 2008 5:38 AM
To: antlr-interest at antlr.org <antlr-interest at antlr.org>
Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions


Hi,

I can't get ANTLR 3.1b1 to generate ASTs using C#. Am I doing something wrong or is the beta not generating valid C# yet?


Here is the very simplistic grammar I use. Parsing "1+1" will break with a RewriteEmptyStreamExceptions

   grammar Simple;

   options
   {
      output=AST;
      ASTLabelType=CommonTree;
      language=CSharp2;
   }

   expr : INT '+' INT -> ^('+' INT+);
   INT : ('0'..'9')+;
   WS : (' '|'\t'|'\u000C'|'\r'|'\n') {Skip();};



Any ideas?



Thanks

Andre


From jimi at temporal-wave.com  Sat Jul  5 18:00:01 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 05 Jul 2008 18:00:01 -0700
Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions
In-Reply-To: <E77E96B6A3DEE24CB77E4F7130C910DA6BE10C5952@NA-EXMSG-C117.redmond.corp.microsoft.com>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE10C5952@NA-EXMSG-C117.redmond.corp.microsoft.com>
Message-ID: <1215306001.7659.25.camel@jimi>

On Sat, 2008-07-05 at 16:07 -0700, Cameron Skinner wrote:

> I think it might have something to do with the fact that you have the plus operator on the INT token in the rewrite rule, but not in the parser rule itself?
> 
> -----Original Message-----
> From: Andr? van der Merwe <AndrevdM at pyrogenesis.co.za>
> Sent: Friday, July 04, 2008 5:38 AM
> To: antlr-interest at antlr.org <antlr-interest at antlr.org>
> Subject: [antlr-interest] 3.1b1 throwing RewriteEmptyStreamExceptions
> 
> 
> Hi,
> 
> I can't get ANTLR 3.1b1 to generate ASTs using C#. Am I doing something wrong or is the beta not generating valid C# yet?
> 
> 
> Here is the very simplistic grammar I use. Parsing "1+1" will break with a RewriteEmptyStreamExceptions
> 
>    grammar Simple;
> 
>    options
>    {
>       output=AST;
>       ASTLabelType=CommonTree;
>       language=CSharp2;
>    }
> 
>    expr : INT '+' INT -> ^('+' INT+);


This shoudl be:

expr: i+=INT '+' i+=INT -> ^('+' $i+);

Or:

expr : i1=INT '+' i2=INT -> ^('+' $i1 $i2) ;

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080705/f7ea2e66/attachment.html 

From antlr at mirality.co.nz  Sat Jul  5 20:21:07 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 06 Jul 2008 15:21:07 +1200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <487030F2.9020305@gmx.net>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
	<486FFA13.1020606@gmx.net> <20080705230000.18563gmx1@mx077.gmx.net>
	<487030F2.9020305@gmx.net>
Message-ID: <20080706032114.E96D311EBD2@www.antlr.org>

At 14:41 6/07/2008, Joe wrote:
 >But what about characters outside the BMP? For example how
 >would I match the CJK UNIFIED IDEOGRAPH range 
(U+20000..U+2A6D6)?
 >Indivdually splitting them into two 16-bit characters is not
 >a viable solution.

That one, I'm less sure about, and I think the answer depends on 
your target language.

For example, I think Java uses UTF-16, which means that you do 
indeed have to split them into two 16-bit characters (because 
that's how it encodes them).

Whereas the C target uses UTF-32, so I think you wouldn't need to 
do that.  I'm not sure how to express the character in the 
grammar, though -- I've never needed to do that.

(And you should try to keep responses on the list -- that way 
other people can chime in if they have a better answer.  Use your 
Reply All button.)


From l0calh05t at gmx.net  Sat Jul  5 20:35:10 2008
From: l0calh05t at gmx.net (Joe)
Date: Sun, 06 Jul 2008 05:35:10 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <20080706032115.2438gmx1@mx003.gmx.net>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
	<486FFA13.1020606@gmx.net> <20080705230000.18563gmx1@mx077.gmx.net>
	<487030F2.9020305@gmx.net> <20080706032115.2438gmx1@mx003.gmx.net>
Message-ID: <48703D6E.20908@gmx.net>

Gavin Lambert wrote:
> At 14:41 6/07/2008, Joe wrote:
> >But what about characters outside the BMP? For example how
> >would I match the CJK UNIFIED IDEOGRAPH range (U+20000..U+2A6D6)?
> >Indivdually splitting them into two 16-bit characters is not
> >a viable solution.
>
> That one, I'm less sure about, and I think the answer depends on your 
> target language.
>
> For example, I think Java uses UTF-16, which means that you do indeed 
> have to split them into two 16-bit characters (because that's how it 
> encodes them).
>
> Whereas the C target uses UTF-32, so I think you wouldn't need to do 
> that.  I'm not sure how to express the character in the grammar, 
> though -- I've never needed to do that.
>
> (And you should try to keep responses on the list -- that way other 
> people can chime in if they have a better answer.  Use your Reply All 
> button.)
>
Yes, UTF-16 characters may be 2x16 bit, but the decoding should not have 
to be in the grammar (which would be extremely impractical). It should 
be taken care of internally. As far as I can tell, this would require 
changing the LA method (which already returns an int) and adding another 
escape sequence for characters in the range from U+100000 to U+10FFFF (I 
may be wrong though).

-- 
Generally speaking, things have gone about as far
as they can possibly go, when things have gotten
about as bad as they can reasonably get.


From rusinskystanislas at yahoo.fr  Sun Jul  6 05:35:02 2008
From: rusinskystanislas at yahoo.fr (Stanislas Rusinsky)
Date: Sun, 6 Jul 2008 12:35:02 +0000 (GMT)
Subject: [antlr-interest] Re : gunit tree testsuite can't find the group
	template file
Message-ID: <997508.36013.qm@web26504.mail.ukl.yahoo.com>

Hi Leon,

thank you for your answer (and your work with gUnit), I have found a temporary workaround to be able to load the group and test the tree grammar for the moment.

The code loading the template group file is directly inserted in the tree grammar instead of inside the external class containing the main() method.

Looks like this:
@header {
    package com.foo.bar;
    import java.io.*;
    import org.antlr.stringtemplate.StringTemplateGroup;
}
...
myStartRuleInMyTreeGrammar
@init    {
    try {
        FileReader groupFileR = new FileReader("treeKoRuGenClasses.stg"); 
        StringTemplateGroup templates = new StringTemplateGroup(groupFileR); 
        groupFileR.close();
        this.setTemplateLib(templates);
    } catch (FileNotFoundException fnfe) {
        fnfe.printStackTrace();
    } catch (IOException ioe) {
        ioe.printStackTrace();
    }

Stanislas Herman.


----- Message d'origine ----
De : Leon Su <leon.antlr at mac.com>
? : Stanislas Rusinsky <rusinskystanislas at yahoo.fr>
Cc : antlr-interest <antlr-interest at antlr.org>
Envoy? le : Samedi, 5 Juillet 2008, 20h23mn 54s
Objet : Re: [antlr-interest] gunit tree testsuite can't find the group template file

Hi Stanislas,

gUnit currently can only test on plain parser/tree grammar, and  
doesn't support loading group file(*.stg) or setting customized tree  
adaptor yet.
The functionality such as walker.etTemplateLib() and  
parser.setTreeAdaptor() will be added into the next release. Sorry  
for the inconvenience.

Leon

On Jul 5, 2008, at 9:09 AM, Stanislas Rusinsky wrote:

> Hello all,
>
> (I almost wrote "hello ANTLeRs"... happily babelfish saved me from  
> my french ignorance of english subtleties)
>
>
> The problem: I have a text grammar and a tree grammar.
>
> The tree grammar has its group template file loaded with these  
> commands:
>         FileReader groupFileR = new FileReader 
> ("treeKoRuGenClasses.stg");
>         StringTemplateGroup templates = new StringTemplateGroup 
> (groupFileR);
>         groupFileR.close();
>         walker.setTemplateLib(templates); // where to find templates
>
> Running the tree parser works like a charm with this code.
>
> The gunit testsuite works fine with the text grammar, but the tree  
> grammar gunit testsuite complains it can't "find template  
> entity_modifiers.st; group hierarchy is  
> [treeKoRuGenClassesTemplates]".
> The path includes the directory containing the template group file.
>
> I have tried renaming my .stg file to  
> treeKoRuGenClassesTemplates.stg as suggested by the trace, changing  
> also the first line to "group treeKoRuGenClassesTemplates;" but  
> nothing helped, I still get the stacktrace (see below).
>
> It seems the java class generated from the tree sets a default  
> empty template group ( protected StringTemplateGroup templateLib =  
> new StringTemplateGroup("treeKoRuGenClassesTemplates",  
> AngleBracketTemplateLexer.class); ). Should I use a streamreader in  
> my treeKoRuGenClasses.g to read the stg group file and set it with  
> some sort of "this.setTemplateLib(myTemplateGroupFileStream)" ?
>
> Anyone could give me some advice, hint, or broaden my vision on  
> this subject?
>
> Thanks in advance,
>
> Stanislas Herman Rusinsky.
>
> test-tree:
>      [java] java.lang.reflect.InvocationTargetException
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser 
> (gUnitExecuter.java:392)
>      [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser 
> (gUnitExecuter.java:133)
>      [java]     at org.antlr.gunit.gUnitExecuter.executeTests 
> (gUnitExecuter.java:149)
>      [java]     at org.antlr.gunit.gUnitExecuter.execTest 
> (gUnitExecuter.java:92)
>      [java]     at org.antlr.gunit.Interp.main(Interp.java:62)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.run 
> (ExecuteJava.java:217)
>      [java]     at org.apache.tools.ant.taskdefs.ExecuteJava.execute 
> (ExecuteJava.java:152)
>      [java]     at org.apache.tools.ant.taskdefs.Java.run(Java.java: 
> 747)
>      [java]     at org.apache.tools.ant.taskdefs.Java.executeJava 
> (Java.java:201)
>      [java]     at org.apache.tools.ant.taskdefs.Java.execute 
> (Java.java:104)
>      [java]     at org.apache.tools.ant.UnknownElement.execute 
> (UnknownElement.java:288)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0 
> (Native Method)
>      [java]     at sun.reflect.NativeMethodAccessorImpl.invoke 
> (NativeMethodAccessorImpl.java:39)
>      [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke 
> (DelegatingMethodAccessorImpl.java:25)
>      [java]     at java.lang.reflect.Method.invoke(Method.java:585)
>      [java]     at  
> org.apache.tools.ant.dispatch.DispatchUtils.execute 
> (DispatchUtils.java:105)
>      [java]     at org.apache.tools.ant.Task.perform(Task.java:348)
>      [java]     at org.apache.tools.ant.Target.execute(Target.java: 
> 357)
>      [java]     at org.apache.tools.ant.Target.performTasks 
> (Target.java:385)
>      [java]     at org.apache.tools.ant.Project.executeSortedTargets 
> (Project.java:1329)
>      [java]     at org.apache.tools.ant.Project.executeTarget 
> (Project.java:1298)
>      [java]     at  
> org.apache.tools.ant.helper.DefaultExecutor.executeTargets 
> (DefaultExecutor.java:41)
>      [java]     at org.apache.tools.ant.Project.executeTargets 
> (Project.java:1181)
>      [java]     at org.apache.tools.ant.Main.runBuild(Main.java:698)
>      [java]     at org.apache.tools.ant.Main.startAnt(Main.java:199)
>      [java]     at org.apache.tools.ant.launch.Launcher.run 
> (Launcher.java:257)
>      [java]     at org.apache.tools.ant.launch.Launcher.main 
> (Launcher.java:104)
>      [java] Caused by: java.lang.IllegalArgumentException: Can't  
> find template entity_modifiers.st; group hierarchy is  
> [treeKoRuGenClassesTemplates]
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate 
> (StringTemplateGroup.java:507)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:392)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:404)
>      [java]     at  
> org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf 
> (StringTemplateGroup.java:412)
>      [java]     at  
> com.mindspark.koru.treeKoRuGenClasses.entity_modifiers(Unknown Source)
>      [java]     at com.mindspark.koru.treeKoRuGenClasses.entity 
> (Unknown Source)
>      [java]     at com.mindspark.koru.treeKoRuGenClasses.koru 
> (Unknown Source)
>      [java]     ... 35 more
>      [java] org.apache.tools.ant.ExitException: Permission  
> (java.lang.RuntimePermission exitVM) was not granted.
>      [java]     at org.apache.tools.ant.types.Permissions 
> $MySM.checkExit(Permissions.java:174)
>      [java]     at java.lang.Runtime.exit(Runtime.java:88)
>      [java]     at java.lang.System.exit(System.java:869)
>      [java]     at org.antlr.gunit.gUnitExecuter.runTreeParser 
> (gUnitExecuter.java:460)
>      [java]     at org.antlr.gunit.gUnitExecuter.runCorrectParser 
> (gUnitExecuter.java:133)
>      [java]     at org.antlr.gunit.gUnitExecuter.executeTests 
> (gUnitExecuter.java:149)
>      [java]     at org.antlr.gunit.gUnitExecuter.execTest 
> (gUnitExecuter.java:92)
>      [java]     at org.antlr.gunit.Interp.main(Interp.java:62)
>
>
>        
> ______________________________________________________________________ 
> _______
> Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http:// 
> mail.yahoo.fr
>
>
>
>        
> ______________________________________________________________________ 
> _______
> Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http:// 
> mail.yahoo.fr



      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From jaluber at gmx.de  Sun Jul  6 06:00:03 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 06 Jul 2008 15:00:03 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <48703D6E.20908@gmx.net>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>	<486FFA13.1020606@gmx.net>
	<20080705230000.18563gmx1@mx077.gmx.net>	<487030F2.9020305@gmx.net>
	<20080706032115.2438gmx1@mx003.gmx.net> <48703D6E.20908@gmx.net>
Message-ID: <4870C1D3.9080506@gmx.de>

Joe schrieb:
> Gavin Lambert wrote:
>> At 14:41 6/07/2008, Joe wrote:
>> >But what about characters outside the BMP? For example how
>> >would I match the CJK UNIFIED IDEOGRAPH range (U+20000..U+2A6D6)?
>> >Indivdually splitting them into two 16-bit characters is not
>> >a viable solution.
>>
>> That one, I'm less sure about, and I think the answer depends on your 
>> target language.
>>
>> For example, I think Java uses UTF-16, which means that you do indeed 
>> have to split them into two 16-bit characters (because that's how it 
>> encodes them).
>>
>> Whereas the C target uses UTF-32, so I think you wouldn't need to do 
>> that.  I'm not sure how to express the character in the grammar, 
>> though -- I've never needed to do that.
>>
>> (And you should try to keep responses on the list -- that way other 
>> people can chime in if they have a better answer.  Use your Reply All 
>> button.)
>>
> Yes, UTF-16 characters may be 2x16 bit, but the decoding should not have 
> to be in the grammar (which would be extremely impractical). It should 
> be taken care of internally. As far as I can tell, this would require 
> changing the LA method (which already returns an int) and adding another 
> escape sequence for characters in the range from U+100000 to U+10FFFF (I 
> may be wrong though).
> 

I have created a special rule to parse UTF-16 surrogate codepoints for 
my own C# lexer:

// This rule is supposed to catch all characters which may be used as a 
part of an identifier.
// Note that this rule is a superset which may not only include 
positional invalid characters,
// but always invalid characters.
// Sort the bad identifiers out in the parser where the symbol tables 
are build. Digits aren't
// included because allowing them at first place causes confusion with 
INTEGER_LITERAL
// and REAL_LITERAL. The way it is structured is to get the characters 
in the UTF-16 encoding.
//
// This is a hack to workaround the ANTLR 3 limitation that one can't 
choose unicode character
// classes directly. Also known characters required by other rules are 
excluded.
fragment ANY_UNUSED_CHARACTER
	:	'A'..'Z'	// Use only alphabet characters below U+0080
	|	'a'..'z'
	|	'\u0080'..'\u009F'	// NO NO_BREAK SPACE
	|	'\u00A1'..'\u167F'	// NO OGHAM SPACE MARK
	|	'\u1681'..'\u180D'	// NO MONGOLIAN VOWEL SEPARATOR
	|	'\u180F'..'\u1FFF'	// NO EN QUAD, EM QUAD, EN SPACE, THREE_PER_EM 
SPACE, FOUR_PER_EM SPACE, SIX_PER_EM SPACE
	|	'\u2007'		// NO PUNCTUATION SPACE, THIN SPACE, HAIR SPACE
	|	'\u200B'..'\u202E'	// NO NARROW NO_BREAK SPACE
	|	'\u2030'..'\u205E'	// NO MEDIUM MATHEMATICAL SPACE
	|	'\u2060'..'\u2FFF'	// NO IDEOGRAPHIC SPACE
	|	'\u3001'..'\uD7FF'
	|	'\uE000'..'\uFFFE'
	|	'\uD800'..'\uDBFF' '\uDC00'..'\uDFFF' // Surrogate code points
	;

I've attached the whole file in case you want to look at the other rules.

Johannes
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: CSharp3Lexer.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080706/e450fd31/attachment.pl 

From l0calh05t at gmx.net  Sun Jul  6 07:49:47 2008
From: l0calh05t at gmx.net (Joe)
Date: Sun, 06 Jul 2008 16:49:47 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
 other Unicode properties)
In-Reply-To: <4870C1D3.9080506@gmx.de>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>	<486FFA13.1020606@gmx.net>
	<20080705230000.18563gmx1@mx077.gmx.net>	<487030F2.9020305@gmx.net>
	<20080706032115.2438gmx1@mx003.gmx.net>
	<48703D6E.20908@gmx.net> <4870C1D3.9080506@gmx.de>
Message-ID: <4870DB8B.5030200@gmx.net>

Johannes Luber wrote:
> Joe schrieb:
>> Gavin Lambert wrote:
>>> At 14:41 6/07/2008, Joe wrote:
>>> >But what about characters outside the BMP? For example how
>>> >would I match the CJK UNIFIED IDEOGRAPH range (U+20000..U+2A6D6)?
>>> >Indivdually splitting them into two 16-bit characters is not
>>> >a viable solution.
>>>
>>> That one, I'm less sure about, and I think the answer depends on 
>>> your target language.
>>>
>>> For example, I think Java uses UTF-16, which means that you do 
>>> indeed have to split them into two 16-bit characters (because that's 
>>> how it encodes them).
>>>
>>> Whereas the C target uses UTF-32, so I think you wouldn't need to do 
>>> that.  I'm not sure how to express the character in the grammar, 
>>> though -- I've never needed to do that.
>>>
>>> (And you should try to keep responses on the list -- that way other 
>>> people can chime in if they have a better answer.  Use your Reply 
>>> All button.)
>>>
>> Yes, UTF-16 characters may be 2x16 bit, but the decoding should not 
>> have to be in the grammar (which would be extremely impractical). It 
>> should be taken care of internally. As far as I can tell, this would 
>> require changing the LA method (which already returns an int) and 
>> adding another escape sequence for characters in the range from 
>> U+100000 to U+10FFFF (I may be wrong though).
>>
>
> I have created a special rule to parse UTF-16 surrogate codepoints for 
> my own C# lexer:
>
> // This rule is supposed to catch all characters which may be used as 
> a part of an identifier.
> // Note that this rule is a superset which may not only include 
> positional invalid characters,
> // but always invalid characters.
> // Sort the bad identifiers out in the parser where the symbol tables 
> are build. Digits aren't
> // included because allowing them at first place causes confusion with 
> INTEGER_LITERAL
> // and REAL_LITERAL. The way it is structured is to get the characters 
> in the UTF-16 encoding.
> //
> // This is a hack to workaround the ANTLR 3 limitation that one can't 
> choose unicode character
> // classes directly. Also known characters required by other rules are 
> excluded.
> fragment ANY_UNUSED_CHARACTER
>     :    'A'..'Z'    // Use only alphabet characters below U+0080
>     |    'a'..'z'
>     |    '\u0080'..'\u009F'    // NO NO_BREAK SPACE
>     |    '\u00A1'..'\u167F'    // NO OGHAM SPACE MARK
>     |    '\u1681'..'\u180D'    // NO MONGOLIAN VOWEL SEPARATOR
>     |    '\u180F'..'\u1FFF'    // NO EN QUAD, EM QUAD, EN SPACE, 
> THREE_PER_EM SPACE, FOUR_PER_EM SPACE, SIX_PER_EM SPACE
>     |    '\u2007'        // NO PUNCTUATION SPACE, THIN SPACE, HAIR SPACE
>     |    '\u200B'..'\u202E'    // NO NARROW NO_BREAK SPACE
>     |    '\u2030'..'\u205E'    // NO MEDIUM MATHEMATICAL SPACE
>     |    '\u2060'..'\u2FFF'    // NO IDEOGRAPHIC SPACE
>     |    '\u3001'..'\uD7FF'
>     |    '\uE000'..'\uFFFE'
>     |    '\uD800'..'\uDBFF' '\uDC00'..'\uDFFF' // Surrogate code points
>     ;
>
> I've attached the whole file in case you want to look at the other rules.
>
> Johannes
That solves the problem of recognizing them as pairs that belong 
together. Too bad it can't really replace the uncicode categories. Do 
you think it would be possible to integrate a handwritten Lexer using 
ICU with ANTLR generated parser and tree parser? I couldn't find much 
info on the C interface (wish there was a working C++ interface), so I'm 
not sure if that is feasible.

From jimi at temporal-wave.com  Sun Jul  6 09:47:31 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Jul 2008 09:47:31 -0700
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And,
	other	Unicode properties)
In-Reply-To: <4870DB8B.5030200@gmx.net>
References: <mailman.6251.1215296706.2486.antlr-interest@antlr.org>
	<486FFA13.1020606@gmx.net> <20080705230000.18563gmx1@mx077.gmx.net>
	<487030F2.9020305@gmx.net> <20080706032115.2438gmx1@mx003.gmx.net>
	<48703D6E.20908@gmx.net> <4870C1D3.9080506@gmx.de>
	<4870DB8B.5030200@gmx.net>
Message-ID: <1215362851.7659.44.camel@jimi>

On Sun, 2008-07-06 at 16:49 +0200, Joe wrote:

> Johannes Luber wrote:
> > Joe schrieb:
> >> Gavin Lambert wrote:



> > Johannes
> That solves the problem of recognizing them as pairs that belong 
> together. Too bad it can't really replace the uncicode categories. Do 
> you think it would be possible to integrate a handwritten Lexer using 
> ICU with ANTLR generated parser and tree parser? I couldn't find much 
> info on the C interface 

For ICU or for ANTLR? The API documentation for the C interface is at:

http://www.antlr.org/api/C/index.html


However, it is much simpler than you think in ANTLR 3.1, unless you
don't want to pre-load the input. ANTLR 3.1 has an encoding conversion
library (from the Unicode standard). If your input is not UCS2 and you
must deal with surrogate pairs, then by far the easiest solution is to
make a copy of the file antlr3ucs2inputstream.c and call it
antlr3utf32inputstream, renaming the constructors accordingly. Then
change the few references to {p}ANTLR3_UINT16 to {p}ANTLR3_UINT32. 

As per the docs, the C runtime works internally with 32 bit characters,
hence the lexer is divorced from the input stream and doesn't care how
you produce it. If you don't convert the input to a fixed width
encoding, then your LA() and related functions have to cater for the
surrogate pair combinations, which is a pain, though you can do it, and
will be slower. In the source file antlr3convertutf.c you will see a
number of functions targeted for specific conversions, so, if your input
is utf8 and the input codepoints would require surrogate pairs even in
16 bit encodings, you can use ConvertUTF8toUTF32(), and then open the
result with your UTF32 input stream. Similarly, there is
ConvertUTF16toUTF32().

I do intend to rationalize this and provide an input stream that will do
this internally, but other than a bit of copying and eidting, it is easy
enough to create your own input encodings. Please read the numerous
comments and the API docs if you wnat to do more than make a copy of the
UCS2 input stream and have it process UTF32 characters. That should be
all you need as internally it is designed from the ground up to cater
for UTF32, as per the documentation.


> (wish there was a working C++ interface), so I'm 
> not sure if that is feasible.


See above and read the docs - you should be able to do this easily, and
you don't need ICU to do it. I do agree that we should look at having at
least a notation for  the Unicode character classes that at least know
the character ranges and so on, if not some special states that know
this internally. Easy enough for Java and C#, but a little more pain for
C as I don't want to rely on third party libraries such as ICU, even
though that is a very good library.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080706/914db01a/attachment-0001.html 

From sam.ellis at arm.com  Sun Jul  6 13:34:03 2008
From: sam.ellis at arm.com (Sam Ellis)
Date: Sun, 06 Jul 2008 21:34:03 +0100
Subject: [antlr-interest] Access to lexer warning/error messages after
	parsing
In-Reply-To: <200807022115.m62LFfOR009931@rly22e.srv.mailcontrol.com>
Message-ID: <C496EACB.34395%sam.ellis@arm.com>

On 2/7/08 22:15, "Gavin Lambert" <antlr at mirality.co.nz> wrote:
> At 19:30 2/07/2008, Sam Ellis wrote:
>> The approach I used in my grammar was to define an
>> IErrorReporter interface
> Any chance you could Wiki your solution for others to use?  And
> maybe even get it incorporated into a future version of the
> runtime?

I have added "Default Error Reporting Behavior" and "Custom Error Reporting"
sections to this wiki page:

http://www.antlr.org/wiki/display/ANTLR3/Error+reporting+and+recovery

Any comments?

-- 
Sam Ellis, Engineering Manager,
Product Engineering Group,                 Tel: +44 (0) 1223 400516
System Design Division,                    Fax: +44 (0) 1223 400887
ARM Ltd., 110 Fulbourn Road,               skype:armsamellis
Cambridge, CB1 9NJ                         mailto:sam.ellis at arm.com



-- 
IMPORTANT NOTICE: The contents of this email and any attachments are confidential and may also be privileged. If you are not the intended recipient, please notify the sender immediately and do not disclose the contents to any other person, use it for any purpose, or store or copy the information in any medium.  Thank you.



From l0calh05t at gmx.net  Sun Jul  6 15:10:30 2008
From: l0calh05t at gmx.net (Joe)
Date: Mon, 07 Jul 2008 00:10:30 +0200
Subject: [antlr-interest] Unicode XID_Start/XID_Continue? (And, ,
 other Unicode properties)
In-Reply-To: <mailman.6614.1215362839.2486.antlr-interest@antlr.org>
References: <mailman.6614.1215362839.2486.antlr-interest@antlr.org>
Message-ID: <487142D6.40602@gmx.net>


> On Sun, 2008-07-06 at 16:49 +0200, Joe wrote:
>
>   
>> Johannes Luber wrote:
>>     
>>> Joe schrieb:
>>>       
>>>> Gavin Lambert wrote:
>>>>         
>
>
>
>   
>>> Johannes
>>>       
>> That solves the problem of recognizing them as pairs that belong 
>> together. Too bad it can't really replace the uncicode categories. Do 
>> you think it would be possible to integrate a handwritten Lexer using 
>> ICU with ANTLR generated parser and tree parser? I couldn't find much 
>> info on the C interface 
>>     
>
> For ICU or for ANTLR? The API documentation for the C interface is at:
>
> http://www.antlr.org/api/C/index.html
>   

ANTLR. I did find that document but found it somewhat hard to 
understand. Partially because I'm used to C++ APIs, not C APIs, but also 
because some sections with 'detailed information' (Interacting with the 
Generated Code for example) don't appear to exist.

>
> However, it is much simpler than you think in ANTLR 3.1, unless you
> don't want to pre-load the input. ANTLR 3.1 has an encoding conversion
> library (from the Unicode standard). If your input is not UCS2 and you
> must deal with surrogate pairs, then by far the easiest solution is to
> make a copy of the file antlr3ucs2inputstream.c and call it
> antlr3utf32inputstream, renaming the constructors accordingly. Then
> change the few references to {p}ANTLR3_UINT16 to {p}ANTLR3_UINT32. 
>
> As per the docs, the C runtime works internally with 32 bit characters,
> hence the lexer is divorced from the input stream and doesn't care how
> you produce it. If you don't convert the input to a fixed width
> encoding, then your LA() and related functions have to cater for the
> surrogate pair combinations, which is a pain, though you can do it, and
> will be slower. In the source file antlr3convertutf.c you will see a
> number of functions targeted for specific conversions, so, if your input
> is utf8 and the input codepoints would require surrogate pairs even in
> 16 bit encodings, you can use ConvertUTF8toUTF32(), and then open the
> result with your UTF32 input stream. Similarly, there is
> ConvertUTF16toUTF32().
>
> I do intend to rationalize this and provide an input stream that will do
> this internally, but other than a bit of copying and eidting, it is easy
> enough to create your own input encodings. Please read the numerous
> comments and the API docs if you wnat to do more than make a copy of the
> UCS2 input stream and have it process UTF32 characters. That should be
> all you need as internally it is designed from the ground up to cater
> for UTF32, as per the documentation.
>
>   
So, you say I should make a antlr3utf32inputstream, convert my input via 
ConvertUTF16toUTF32 and use that. But does this actually help with the 
grammar itself? How can I describe characters in the U+10000 to U+10FFFF 
range since there are no appropriate escape sequences?
>   
>> (wish there was a working C++ interface), so I'm 
>> not sure if that is feasible.
>>     
>
>
> See above and read the docs - you should be able to do this easily, and
> you don't need ICU to do it. I do agree that we should look at having at
> least a notation for  the Unicode character classes that at least know
> the character ranges and so on, if not some special states that know
> this internally. Easy enough for Java and C#, but a little more pain for
> C as I don't want to rely on third party libraries such as ICU, even
> though that is a very good library.
>
> Jim
Why not? ICU even has a Java, a C and a C++ version (Python bindings are 
also in development). And checking for Unicode properties requires only 
a single line of code using ICU and *all* Unicode properties are 
supported, even the derived ones like XID_Start. Do you really want to 
double all that effort? Also, for XID_Start to make any sense in the 
first place, the input must be NFKC normalized. Do you also want to 
start implementing normalization in ANTLR to have usable Unicode 
support? What I mean to say is: Using ICU would make life a lot easier 
for ANTLR developers, and IMO the benefits outweigh the disadvantages of 
having to include a third party library.

From don_reba at inbox.ru  Sun Jul  6 19:28:34 2008
From: don_reba at inbox.ru (Don Reba)
Date: Mon, 07 Jul 2008 06:28:34 +0400
Subject: [antlr-interest] Lua long brackets
Message-ID: <E1KFgSw-000LLW-00.don_reba-inbox-ru@f188.mail.ru>

What would be a good approach to implementation of long brackets in Lua? Here is the definition:

Literal strings can also be defined using a long format enclosed by long brackets. We define an opening long bracket of level n as an opening square bracket followed by n equal signs followed by another opening square bracket. So, an opening long bracket of level 0 is written as [[, an opening long bracket of level 1 is written as [=[, and so on. A closing long bracket is defined similarly; for instance, a closing long bracket of level 4 is written as ]====]. A long string starts with an opening long bracket of any level and ends at the first closing long bracket of the same level. Literals in this bracketed form may run for several lines, do not interpret any escape sequences, and ignore long brackets of any other level. They may contain anything except a closing bracket of the proper level.

From belayda at gmail.com  Sun Jul  6 22:19:03 2008
From: belayda at gmail.com (Bernardo Elayda)
Date: Sun, 6 Jul 2008 22:19:03 -0700
Subject: [antlr-interest] Example JBurg specification with Antlr 3.1.x?
Message-ID: <3e5ed32f0807062219o5fcb988dw9fa9881b81561764@mail.gmail.com>

Hi!
Does anyone have an example JBurg specifcation that will work with Antlr
3.1.x?
I've been rumaging through the code and JBurg webpage with little success.

tia,
Bernardo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080706/dcda75be/attachment.html 

From o.b.fischer at gmx.de  Mon Jul  7 00:59:36 2008
From: o.b.fischer at gmx.de (Oliver B. Fischer)
Date: Mon, 07 Jul 2008 09:59:36 +0200
Subject: [antlr-interest] Embedding templates in itself
Message-ID: <4871CCE8.2010504@gmx.de>

Hello,

I have a tree parser to parse nested blocks like "{{}{}}". The generated 
tree looks fine: (PROGRAM (FUNC void function (BLOCK (BLOCK BLOCK)))).

Unfortunately it seems to be impossible to embed templates in itself as 
I try it:

block
   : ^(BLOCK (blo+=block)*)
     -> block(st={$blo})
   ;

Doing this, I always get IllegalArgumentException saying "cannot embed 
template block in itself". But who can I handle such structure with 
StringTemplate?

Best regards,

Oliver

-- 
Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
Tel. +49 30 44793251, Mobil: +49 178 7903538
Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net

From tvial at octo.com  Mon Jul  7 02:25:58 2008
From: tvial at octo.com (Thomas Vial)
Date: Mon, 7 Jul 2008 11:25:58 +0200
Subject: [antlr-interest] Match any node/subtree
In-Reply-To: <486F8F84.5090200@gmx.de>
References: <475086500807050806nedecf2fo820ca08babf578b5@mail.gmail.com>
	<486F8F84.5090200@gmx.de>
Message-ID: <475086500807070225w54c14d46pa9750f322f15d7c2@mail.gmail.com>

Thanks, that made it!

Thomas



On Sat, Jul 5, 2008 at 5:13 PM, Johannes Luber <jaluber at gmx.de> wrote:

> Thomas Vial schrieb:
>
>> Hi,
>>
>> Is there a way to have a rule, in a tree grammar, match any node/subtree
>> whatever it is (like a wildcard)? Something like:
>>
>> rule:
>>   ^(NODE child) { doSomething($child); }   // child is any subtree, no
>> subrule to match it explicitely
>>
>>
>> Thanks,
>>
>> Thomas
>>
>
> rule:
>    ^(NODE child=.) { doSomething($child); };
>
> should work.
>
> Johannes
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080707/bd2cb37f/attachment.html 

From jens.boeykens at gmail.com  Mon Jul  7 02:44:06 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 7 Jul 2008 11:44:06 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add separator
	when parallel iterating 2 lists in stringtemplate
Message-ID: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>

I think I found 2 more bugs in ANTLRv3.g http://www.antlr.org/grammar/ANTLR

Rule altlist:*

altList
@init {
    // must create root manually as it's used by invoked rules in real antlr
tool.
    // leave here to demonstrate use of {...} in rewrite rule
    // it's really BLOCK[firstToken,"BLOCK"]; set line/col to previous ( or
: token.
    CommonTree blkRoot =
(CommonTree)adaptor.create(BLOCK,input.LT(-1),"BLOCK");
}
    :   a1=alternative rewrite ( '|' a2=alternative rewrite )*
        -> ^( {blkRoot} (alternative rewrite)+ EOB["EOB"] )
    ;*

I removed the question mark after rewrite in the tree rewrite subrule. This
caused problems with parallel iteration of lists. (Only the first rewrite
appeared in the tree). Also see my post on the stringtemplate mailing list.


Rule block:

*block
    :   lp='('
        ( (opts=optionsSpec)? ':' )?
        a1=alternative rewrite ( '|' a2=alternative rewrite )*
        rp=')'
        -> ^( BLOCK[$lp,"BLOCK"] optionsSpec? (alternative rewrite)+
EOB[$rp,"EOB"] )
    ;*

I added "rewrite" to the tree rewrite subrule. Otherwise rewrite was missing
in the tree. Also changed block in ANTLRv3Tree.g

*block
    :   ^( BLOCK optOptionsSpec (a+=alternative r+=rewrite)+ EOB )
        -> block(blok={$BLOCK}, optionsSpec={$optOptionsSpec.st},
alternative={$a}, rewrite={$r},
        eob={$EOB})
    ;*

I now have a problem iterating parallel through 2 lists (alternative and
rewrite) in my stringtemplate:

*block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
<alternative,rewrite: {alt,rw | <alt> <rw> }>
>>*

This should regenerate a rule like  *r: a -> int | b -> char;*
My output however is:  *r: a -> int b -> char; *
Thus no separator.

If I use template (added a '|'):
*
block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
<alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>*

I have one '|' too many in my output:
*r: a -> int | b -> char |; *
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080707/f1fad01f/attachment.html 

From tilman.walter at gmx.de  Mon Jul  7 07:52:52 2008
From: tilman.walter at gmx.de (tilman walter)
Date: Mon, 07 Jul 2008 16:52:52 +0200
Subject: [antlr-interest] [Fwd: [stringtemplate-interest] antlr &
	stringtemplate rewrite=true]
Message-ID: <48722DC4.4030501@gmx.de>


-------------- next part --------------
An embedded message was scrubbed...
From: tilman walter <tilman.walter at gmx.de>
Subject: [stringtemplate-interest] antlr & stringtemplate rewrite=true
Date: Mon, 07 Jul 2008 11:51:21 +0200
Size: 3507
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080707/0ffbc8a4/attachment-0001.eml 

From don_reba at inbox.ru  Mon Jul  7 09:09:58 2008
From: don_reba at inbox.ru (Don Reba)
Date: Mon, 07 Jul 2008 20:09:58 +0400
Subject: [antlr-interest] =?windows-1251?q?Lua_long_brackets?=
In-Reply-To: <E1KFgSw-000LLW-00.don_reba-inbox-ru@f188.mail.ru>
References: <E1KFgSw-000LLW-00.don_reba-inbox-ru@f188.mail.ru>
Message-ID: <E1KFtHq-0005JZ-00.don_reba-inbox-ru@f161.mail.ru>

Alright. I did the following:

-------------
ANTLR grammar
-------------

LONGSTRING
        : LONG_BRACKET
        ;

COMMENT
        : '--' LONG_BRACKET {Skip();}
        ;

fragment
LONG_BRACKET
@init {int n = 0;}
        : ('['('=' {++n;})*'[') ({IsLongBracketOpen(n)}? => .)* {MatchLongBracketClose(n);}
        ;


-------
C# code
-------

public override bool IsLongBracketOpen(int length)
{
	if (input.LA(1) != ']')
		return true;
	for (int i = 0; i != length; ++i)
	{
		if (input.LA(i + 2) != '=')
			return true;
	}
	if (input.LA(length + 2) != ']')
		return true;
	return false;
}

public override void MatchLongBracketClose(int length)
{
	var builder = new StringBuilder();
	builder.Append(']');
	for (int i = 0; i != length; ++i)
		builder.Append('=');
	builder.Append(']');
	Match(builder.ToString());
}


-----Original Message-----

> 
> What would be a good approach to implementation of long brackets in Lua? Here is the definition:
> 
> Literal strings can also be defined using a long format enclosed by long brackets. We define an opening long bracket of level n as an opening square bracket followed by n equal signs followed by another opening square bracket. So, an opening long bracket of level 0 is written as [[, an opening long bracket of level 1 is written as [=[, and so on. A closing long bracket is defined similarly; for instance, a closing long bracket of level 4 is written as ]====]. A long string starts with an opening long bracket of any level and ends at the first closing long bracket of the same level. Literals in this bracketed form may run for several lines, do not interpret any escape sequences, and ignore long brackets of any other level. They may contain anything except a closing bracket of the proper level.
> 

From jens.boeykens at gmail.com  Mon Jul  7 12:02:19 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 07 Jul 2008 21:02:19 +0200
Subject: [antlr-interest] (no subject)
Message-ID: <4872683B.9070100@gmail.com>

Hello all,

I'm have an issue with parsing a particular input with ANTLRv3.g 
(http://www.antlr.org/grammar/ANTLR).
I'm trying to parse the following rule:

r : a -> template() "Some test";

This however doesn't parse, but I can't find a bug in ANTLRv3.g or a 
mistake in my input rule. Using ANTLRworks it seems to parse well until 
template() and than the match fails. Don't know what could be wrong with 
"..." though.

Greetings

From parrt at cs.usfca.edu  Mon Jul  7 12:23:58 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 12:23:58 -0700
Subject: [antlr-interest] Embedding templates in itself
In-Reply-To: <4871CCE8.2010504@gmx.de>
References: <4871CCE8.2010504@gmx.de>
Message-ID: <587B0340-B289-4949-BEF4-067767F0F1C9@cs.usfca.edu>

ST handles nested templates very well and can do recursive, unlike  
many other tools. I'm not sure why that error is occurring, but like  
it or not somehow you are embedding a block template in itself. what  
does block template look like?
Ter
On Jul 7, 2008, at 12:59 AM, Oliver B. Fischer wrote:

> Hello,
>
> I have a tree parser to parse nested blocks like "{{}{}}". The  
> generated tree looks fine: (PROGRAM (FUNC void function (BLOCK  
> (BLOCK BLOCK)))).
>
> Unfortunately it seems to be impossible to embed templates in itself  
> as I try it:
>
> block
>  : ^(BLOCK (blo+=block)*)
>    -> block(st={$blo})
>  ;
>
> Doing this, I always get IllegalArgumentException saying "cannot  
> embed template block in itself". But who can I handle such structure  
> with StringTemplate?
>
> Best regards,
>
> Oliver
>
> -- 
> Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
> Tel. +49 30 44793251, Mobil: +49 178 7903538
> Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net


From parrt at cs.usfca.edu  Mon Jul  7 12:42:31 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 12:42:31 -0700
Subject: [antlr-interest] (no subject)
In-Reply-To: <4872683B.9070100@gmail.com>
References: <4872683B.9070100@gmail.com>
Message-ID: <D5CE7A75-B69D-4883-A5E0-E3F10EE712D9@cs.usfca.edu>

Wow...  that freaked me out for a second... it turns out that there is  
a lexer error, which both of us fail to see; I clicked on the output  
tab and saw it. fix with this

DOUBLE_QUOTE_STRING_LITERAL
	:	'"' (ESC | ~('\\'|'"'))* '"'
	;


Ter

On Jul 7, 2008, at 12:02 PM, Jens Boeykens wrote:

> Hello all,
>
> I'm have an issue with parsing a particular input with ANTLRv3.g (http://www.antlr.org/grammar/ANTLR 
> ).
> I'm trying to parse the following rule:
>
> r : a -> template() "Some test";
>
> This however doesn't parse, but I can't find a bug in ANTLRv3.g or a  
> mistake in my input rule. Using ANTLRworks it seems to parse well  
> until template() and than the match fails. Don't know what could be  
> wrong with "..." though.
>
> Greetings


From parrt at cs.usfca.edu  Mon Jul  7 12:50:54 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 12:50:54 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
Message-ID: <FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>


On Jul 7, 2008, at 2:44 AM, Jens Boeykens wrote:

> I think I found 2 more bugs in ANTLRv3.g http://www.antlr.org/grammar/ANTLR
>
> Rule altlist:
>
> altList
> @init {
>     // must create root manually as it's used by invoked rules in  
> real antlr tool.
>     // leave here to demonstrate use of {...} in rewrite rule
>     // it's really BLOCK[firstToken,"BLOCK"]; set line/col to  
> previous ( or : token.
>     CommonTree blkRoot =  
> (CommonTree)adaptor.create(BLOCK,input.LT(-1),"BLOCK");
> }
>     :   a1=alternative rewrite ( '|' a2=alternative rewrite )*
>         -> ^( {blkRoot} (alternative rewrite)+ EOB["EOB"] )
>     ;
>
> I removed the question mark after rewrite in the tree rewrite  
> subrule. This caused problems with parallel iteration of lists.  
> (Only the first rewrite appeared in the tree).

Ah!  Correct.  Thanks.  Updated in the depot.

> Also see my post on the stringtemplate mailing list.
>
> Rule block:
>
> block
>     :   lp='('
>         ( (opts=optionsSpec)? ':' )?
>         a1=alternative rewrite ( '|' a2=alternative rewrite )*
>         rp=')'
>         -> ^( BLOCK[$lp,"BLOCK"] optionsSpec? (alternative rewrite)+  
> EOB[$rp,"EOB"] )
>     ;

Fixed.

> I added "rewrite" to the tree rewrite subrule. Otherwise rewrite was  
> missing in the tree. Also changed block in ANTLRv3Tree.g
>
> block
>     :   ^( BLOCK optOptionsSpec (a+=alternative r+=rewrite)+ EOB )
>         -> block(blok={$BLOCK}, optionsSpec={$optOptionsSpec.st},  
> alternative={$a}, rewrite={$r},
>         eob={$EOB})
>     ;

Fixed.

> I now have a problem iterating parallel through 2 lists (alternative  
> and rewrite) in my stringtemplate:
>
> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
> <alternative,rewrite: {alt,rw | <alt> <rw> }>
> >>
>
> This should regenerate a rule like  r: a -> int | b -> char;
> My output however is:  r: a -> int b -> char;
> Thus no separator.
>
> If I use template (added a '|'):
>
> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
> >>
>
> I have one '|' too many in my output:
> r: a -> int | b -> char |;

Use <...; separator="|">

Ter

From parrt at cs.usfca.edu  Mon Jul  7 12:57:16 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 12:57:16 -0700
Subject: [antlr-interest] updated ANTLRv3.g etc... at site
Message-ID: <647CF085-5451-4E38-A6B7-25D6CE4639FA@cs.usfca.edu>

Howdy...updated

http://www.antlr.org/grammar/ANTLR

To have the latest fixes. Also added parse tree construction stuff in  
addition to the AST stuff (Main.java)

Ter

From jens.boeykens at gmail.com  Mon Jul  7 14:23:43 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 07 Jul 2008 23:23:43 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
 separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
Message-ID: <4872895F.9010109@gmail.com>

Response at the bottem;)

Terence Parr schreef:
>
> On Jul 7, 2008, at 2:44 AM, Jens Boeykens wrote:
>
>> I think I found 2 more bugs in ANTLRv3.g 
>> http://www.antlr.org/grammar/ANTLR
>>
>> Rule altlist:
>>
>> altList
>> @init {
>>     // must create root manually as it's used by invoked rules in 
>> real antlr tool.
>>     // leave here to demonstrate use of {...} in rewrite rule
>>     // it's really BLOCK[firstToken,"BLOCK"]; set line/col to 
>> previous ( or : token.
>>     CommonTree blkRoot = 
>> (CommonTree)adaptor.create(BLOCK,input.LT(-1),"BLOCK");
>> }
>>     :   a1=alternative rewrite ( '|' a2=alternative rewrite )*
>>         -> ^( {blkRoot} (alternative rewrite)+ EOB["EOB"] )
>>     ;
>>
>> I removed the question mark after rewrite in the tree rewrite 
>> subrule. This caused problems with parallel iteration of lists. (Only 
>> the first rewrite appeared in the tree).
>
> Ah!  Correct.  Thanks.  Updated in the depot.
>
>> Also see my post on the stringtemplate mailing list.
>>
>> Rule block:
>>
>> block
>>     :   lp='('
>>         ( (opts=optionsSpec)? ':' )?
>>         a1=alternative rewrite ( '|' a2=alternative rewrite )*
>>         rp=')'
>>         -> ^( BLOCK[$lp,"BLOCK"] optionsSpec? (alternative rewrite)+ 
>> EOB[$rp,"EOB"] )
>>     ;
>
> Fixed.
>
>> I added "rewrite" to the tree rewrite subrule. Otherwise rewrite was 
>> missing in the tree. Also changed block in ANTLRv3Tree.g
>>
>> block
>>     :   ^( BLOCK optOptionsSpec (a+=alternative r+=rewrite)+ EOB )
>>         -> block(blok={$BLOCK}, optionsSpec={$optOptionsSpec.st}, 
>> alternative={$a}, rewrite={$r},
>>         eob={$EOB})
>>     ;
>
> Fixed.
>
>> I now have a problem iterating parallel through 2 lists (alternative 
>> and rewrite) in my stringtemplate:
>>
>> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>> <alternative,rewrite: {alt,rw | <alt> <rw> }>
>> >>
>>
>> This should regenerate a rule like  r: a -> int | b -> char;
>> My output however is:  r: a -> int b -> char;
>> Thus no separator.
>>
>> If I use template (added a '|'):
>>
>> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>> >>
>>
>> I have one '|' too many in my output:
>> r: a -> int | b -> char |;
>
> Use <...; separator="|">

Sorry I can't find the exact syntax to use here. Remember I need 2 lists 
here.
<alternative,rewrite; separator=" | ">  and <alternative rewrite; 
separator=" | "> give errors...

>
> Ter
>


From jens.boeykens at gmail.com  Mon Jul  7 14:28:28 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 07 Jul 2008 23:28:28 +0200
Subject: [antlr-interest] [stringtemplate-interest] howto set separator
 in parallel list iteration
In-Reply-To: <B553DCA7-B047-4D85-A903-E235CA5B53E3@cs.usfca.edu>
References: <53c4e43f0807070056q39a03b69l14879fd9a78c0c3@mail.gmail.com>
	<53c4e43f0807070128s57872145w4901cde2120edec5@mail.gmail.com>
	<53c4e43f0807070150w57cbfb59l990f3295395bc006@mail.gmail.com>
	<B553DCA7-B047-4D85-A903-E235CA5B53E3@cs.usfca.edu>
Message-ID: <48728A7C.4080207@gmail.com>

Hm I've writed a lot of unit tests and no exceptions occured even when 
no rewrites were used.
Can you give me an example input where you get exceptions?

What I am working on now is to build a generator which generates an 
antlrv3 grammar from a tree. This gives a grammar which is equivalent to 
the original grammar used to build that tree but can be tweaked by doing 
stuff with the tree like sorting rules.
I'll post it to the community when it is sort of finished.

Greetz

Terence Parr schreef:
>
> On Jul 7, 2008, at 1:50 AM, Jens Boeykens wrote:
>
>> I think I solved the bug. In ANTLRv3.g I changed the rule "altList" 
>> as follows:
>>
>> altList
>> @init {
>>     // must create root manually as it's used by invoked rules in 
>> real antlr tool.
>>     // leave here to demonstrate use of {...} in rewrite rule
>>     // it's really BLOCK[firstToken,"BLOCK"]; set line/col to 
>> previous ( or : token.
>>     CommonTree blkRoot = 
>> (CommonTree)adaptor.create(BLOCK,input.LT(-1),"BLOCK");
>> }
>>     :   a1=alternative rewrite ( '|' a2=alternative rewrite )*
>>         -> ^( {blkRoot} (alternative rewrite)+ EOB["EOB"] )
>>     ;
>>
>> I deleted the question mark after rewrite in the tree rewrite rule.
>
> Actually, that rewrite ? is necessary... if there is no rewrite, you 
> will get an exception.
> Ter
>


From jens.boeykens at gmail.com  Mon Jul  7 14:34:35 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 07 Jul 2008 23:34:35 +0200
Subject: [antlr-interest] [stringtemplate-interest] howto set separator
 in parallel list iteration
In-Reply-To: <48728A7C.4080207@gmail.com>
References: <53c4e43f0807070056q39a03b69l14879fd9a78c0c3@mail.gmail.com>
	<53c4e43f0807070128s57872145w4901cde2120edec5@mail.gmail.com>
	<53c4e43f0807070150w57cbfb59l990f3295395bc006@mail.gmail.com>
	<B553DCA7-B047-4D85-A903-E235CA5B53E3@cs.usfca.edu>
	<48728A7C.4080207@gmail.com>
Message-ID: <48728BEB.9020600@gmail.com>

And rewrite has an empty alternative, so doesn't this make the question 
mark unnecessary or am I overlooking something?

Jens Boeykens schreef:
> Hm I've writed a lot of unit tests and no exceptions occured even when 
> no rewrites were used.
> Can you give me an example input where you get exceptions?
>
> What I am working on now is to build a generator which generates an 
> antlrv3 grammar from a tree. This gives a grammar which is equivalent 
> to the original grammar used to build that tree but can be tweaked by 
> doing stuff with the tree like sorting rules.
> I'll post it to the community when it is sort of finished.
>
> Greetz
>
> Terence Parr schreef:
>>
>> On Jul 7, 2008, at 1:50 AM, Jens Boeykens wrote:
>>
>>> I think I solved the bug. In ANTLRv3.g I changed the rule "altList" 
>>> as follows:
>>>
>>> altList
>>> @init {
>>>     // must create root manually as it's used by invoked rules in 
>>> real antlr tool.
>>>     // leave here to demonstrate use of {...} in rewrite rule
>>>     // it's really BLOCK[firstToken,"BLOCK"]; set line/col to 
>>> previous ( or : token.
>>>     CommonTree blkRoot = 
>>> (CommonTree)adaptor.create(BLOCK,input.LT(-1),"BLOCK");
>>> }
>>>     :   a1=alternative rewrite ( '|' a2=alternative rewrite )*
>>>         -> ^( {blkRoot} (alternative rewrite)+ EOB["EOB"] )
>>>     ;
>>>
>>> I deleted the question mark after rewrite in the tree rewrite rule.
>>
>> Actually, that rewrite ? is necessary... if there is no rewrite, you 
>> will get an exception.
>> Ter
>>
>
>


From parrt at cs.usfca.edu  Mon Jul  7 14:57:47 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 14:57:47 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <4872895F.9010109@gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
Message-ID: <070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>


On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>>> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>> >>
>>>
>>> I have one '|' too many in my output:
>>> r: a -> int | b -> char |;
>>
>> Use <...; separator="|">
>
> Sorry I can't find the exact syntax to use here. Remember I need 2  
> lists here.
> <alternative,rewrite; separator=" | ">  and <alternative rewrite;  
> separator=" | "> give errors...

Oh, sorry.

>>> <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">

Should work
Ter

From parrt at cs.usfca.edu  Mon Jul  7 14:58:28 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 14:58:28 -0700
Subject: [antlr-interest] [stringtemplate-interest] howto set separator
	in parallel list iteration
In-Reply-To: <48728BEB.9020600@gmail.com>
References: <53c4e43f0807070056q39a03b69l14879fd9a78c0c3@mail.gmail.com>
	<53c4e43f0807070128s57872145w4901cde2120edec5@mail.gmail.com>
	<53c4e43f0807070150w57cbfb59l990f3295395bc006@mail.gmail.com>
	<B553DCA7-B047-4D85-A903-E235CA5B53E3@cs.usfca.edu>
	<48728A7C.4080207@gmail.com> <48728BEB.9020600@gmail.com>
Message-ID: <88BE2E41-7581-48E4-8131-5BDE42BBFB89@cs.usfca.edu>


On Jul 7, 2008, at 2:34 PM, Jens Boeykens wrote:

> And rewrite has an empty alternative, so doesn't this make the  
> question mark unnecessary or am I overlooking something?

the rule reference does not need the ? blood the rewrite does because  
there is nothing there to insert.

Ter

From parrt at cs.usfca.edu  Mon Jul  7 15:20:18 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 7 Jul 2008 15:20:18 -0700
Subject: [antlr-interest] Exception while trying to generate Java
	classes for lexer
In-Reply-To: <6c9aae640806271750q2bab1114ga1d155c29cf916a0@mail.gmail.com>
References: <6c9aae640806271750q2bab1114ga1d155c29cf916a0@mail.gmail.com>
Message-ID: <CDE26092-1C0C-4C3E-8AE0-6F15D124976F@cs.usfca.edu>

Fixed.
Thanks.
Ter
On Jun 27, 2008, at 5:50 PM, Sumanto Biswas wrote:

> Hi,
>
> I have a parser-lexer combination. I used to have it together, but
> separated them so that I could have better control over options and
> also for better readability.
>
> When the lexer was part of parser, it generated fine. However, I took
> the lexer out of the parser, and tried to generate them separately,
> the parser just generated the parser.java file. When I tried to
> generate from lexer, I got the exception stack trace pasted below.
>
> The lexer is pasted below the stack trace and also attached.
>
> Thanks in advance,
> Sumanto
>
> ================================================================
> ANTLR Parser Generator  Version 3.1b1 (May 20, 2008)  1989-2008
> error(100): soslLexerRules.g:0:0: syntax error: buildnfa: <AST>:0:0:
> unexpected AST node: synpred133_soslLexerRules
> error(100): soslLexerRules.g:0:0: syntax error: buildnfa:
> <AST>:184:10: expecting EOA, found '..'
> error(100): soslLexerRules.g:0:0: syntax error: buildnfa: <AST>:
> expecting EOA, found '<empty tree>'
> error(10):  internal error: soslLexerRules.g :  
> java.lang.NullPointerException
> org.antlr.tool.NFAFactory.build_Astar(NFAFactory.java:570)
> org.antlr.tool.TreeToNFAConverter.ebnf(TreeToNFAConverter.java:1937)
> org.antlr.tool.TreeToNFAConverter.element(TreeToNFAConverter.java: 
> 1261)
> org 
> .antlr.tool.TreeToNFAConverter.alternative(TreeToNFAConverter.java: 
> 1008)
> org.antlr.tool.TreeToNFAConverter.block(TreeToNFAConverter.java:803)
> org.antlr.tool.TreeToNFAConverter.ebnf(TreeToNFAConverter.java:1989)
> org.antlr.tool.TreeToNFAConverter.element(TreeToNFAConverter.java: 
> 1261)
> org 
> .antlr.tool.TreeToNFAConverter.alternative(TreeToNFAConverter.java: 
> 1008)
> org.antlr.tool.TreeToNFAConverter.block(TreeToNFAConverter.java:803)
> org.antlr.tool.TreeToNFAConverter.rule(TreeToNFAConverter.java:586)
> org.antlr.tool.TreeToNFAConverter.rules(TreeToNFAConverter.java:412)
> org 
> .antlr.tool.TreeToNFAConverter.grammarSpec(TreeToNFAConverter.java: 
> 366)
> org.antlr.tool.TreeToNFAConverter.grammar(TreeToNFAConverter.java:159)
> org.antlr.tool.Grammar.buildNFA(Grammar.java:858)
> org.antlr.tool.CompositeGrammar.createNFAs(CompositeGrammar.java:362)
> org.antlr.Tool.process(Tool.java:284)
> org.antlr.Tool.main(Tool.java:71)
> ================================================================
>
> ================================================================
> lexer grammar soslLexerRules;
>
>
> options {
> 	backtrack=true;
> 	memoize=true;
> 	filter=true;
> 	// k=2;
> 	// charVocabulary='\u0000'..'\uFFFE';  // support full unicode
> }
>
> @header {
> import java.util.HashMap;
> }
>
>
> @members {
>    private boolean _scanningQuery = false;
>
>    public boolean isScanningQuery() {
>        return _scanningQuery;
>    }
>
>    public void setScanningQuery(boolean scanningQuery) {
>        _scanningQuery = scanningQuery;
>    }
>
> }
>
>
>
>
> EQUAL 			: '=' ;
> NOT_EQUAL 		: '!=' ;
> LESS_THAN 		: '<' ;
> LESS_THAN_OR_EQUAL 	: '<=' ;
> GREATER_THAN 		: '>' ;
> GREATER_THAN_OR_EQUAL 	: '>=' ;
> LPAREN 			: '(' ;
> RPAREN 			: ')' ;
> COLON   		: ':' ;
> COMMA 			: ',' ;
>
>
> LITERAL : { isScanningQuery() }? '"'
>    (SEARCH_CHAR
>        | ' '
>        | '\t'
>        | '\n'
>        | '\r')*
>     '"'
>   ;
>
> SEARCH_TERM : { isScanningQuery() }? SEARCH_CHAR2 ( SEARCH_CHAR )*
>    ;
>
> LCURLY  : '{' { setScanningQuery(true); }
>    ;
>
> RCURLY  : '}' { setScanningQuery(false); }
>    ;
>
> // ----------------------------------------------------
> // Following are parser tokens
> // ----------------------------------------------------
> FIND 		: 	{ !isScanningQuery() }? ('f'|'F') ('i'|'I') ('n'|'N')  
> ('d'|'D') ;
> LIMIT 		 : 	{ !isScanningQuery() }? ('l'|'L') ('i'|'I') ('m'|'M')
> ('i'|'I') ('t'|'T') ;
> IN 		 : 	{ !isScanningQuery() }? ('i'|'I') ('n'|'N') ;
> CONVERTCURRENCY	 :	{ !isScanningQuery() }? 'convertCurrency' ;
> AMOUNT 		 : 	{ !isScanningQuery() }? 'Amount' ;
> TOLABEL 	 : 	{ !isScanningQuery() }? 'toLabel' ;
> ALL		 :	{ !isScanningQuery() }? 'ALL' ;
> FIELDS		 :	{ !isScanningQuery() }? 'FIELDS' ;
> NAME		 :	{ !isScanningQuery() }? 'NAME' ;
> EMAIL		 :	{ !isScanningQuery() }? 'EMAIL' ;
> PHONE		 :	{ !isScanningQuery() }? 'PHONE' ;
> RETURNING	 : 	{ !isScanningQuery() }? ('r'|'R') ('e'|'E') ('t'|'T')
> ('u'|'U') ('r'|'R') ('n'|'N') ('i'|'I') ('n'|'N') ('g'|'G') ;
> ORDER		 :	{ !isScanningQuery() }? ('o'|'O') ('r'|'R') ('d'|'D')
> ('e'|'E') ('r'|'R') ;
> BY		 :	{ !isScanningQuery() }? ('b'|'B') ('y'|'Y') ;
> ASC		 :	{ !isScanningQuery() }? 'ASC' ;
> DESC		 :	{ !isScanningQuery() }? 'DESC' ;
> NULLS		 :	{ !isScanningQuery() }? 'NULLS' ;
> FIRST		 :	{ !isScanningQuery() }? ('f'|'F') ('i'|'I') ('r'|'R')
> ('s'|'S') ('t'|'T') ;
> LAST		 :	{ !isScanningQuery() }? ('l'|'L') ('a'|'A') ('s'|'S')  
> ('t'|'T') ;
> WITH		 :	{ !isScanningQuery() }? ('w'|'W') ('i'|'I') ('t'|'T')  
> ('h'|'H') ;
> DIVISION	 :	{ !isScanningQuery() }? ('d'|'D') ('i'|'I') ('v'|'V')
> ('i'|'I') ('s'|'S') ('i'|'I') ('o'|'O') ('n'|'N') ;
> AND_SCAN	 :	{ isScanningQuery() }?  ('a'|'A') ('n'|'N') ('d'|'D') ;
> OR_SCAN 	 :	{ isScanningQuery() }?  ('o'|'O') ('r'|'R') ;
> NOT_SCAN	 :	{ isScanningQuery() }?  ('n'|'N') ('o'|'O') ('t'|'T') ;
> AND		 :	{ !isScanningQuery() }? ('a'|'A') ('n'|'N') ('d'|'D') ;
> OR 		 :	{ !isScanningQuery() }? ('o'|'O') ('r'|'R') ;
> NOT		 :	{ !isScanningQuery() }? ('n'|'N') ('o'|'O') ('t'|'T') ;
> WHERE		 :	{ !isScanningQuery() }? ('w'|'W') ('h'|'H') ('e'|'E')
> ('r'|'R') ('e'|'E') ;
> LIKE		 :	{ !isScanningQuery() }? ('l'|'L') ('i'|'I') ('k'|'K')  
> ('e'|'E') ;
> NULL		 :	{ !isScanningQuery() }? ('n'|'N') ('u'|'U') ('l'|'L')  
> ('l'|'L') ;
> TRUE		 :	{ !isScanningQuery() }? ('t'|'T') ('r'|'R') ('u'|'U')  
> ('e'|'E') ;
> FALSE		 :	{ !isScanningQuery() }? ('f'|'F') ('a'|'A') ('l'|'L')
> ('s'|'S') ('e'|'E') ;
> INCLUDES	 :	{ !isScanningQuery() }? ('i'|'I') ('n'|'N') ('c'|'C')
> ('l'|'L') ('u'|'U') ('d'|'D') ('e'|'E') ('s'|'S') ;
> EXCLUDES	 :	{ !isScanningQuery() }? ('e'|'E') ('x'|'X') ('c'|'C')
> ('l'|'L') ('u'|'U') ('d'|'D') ('e'|'E') ('s'|'S') ;
> YESTERDAY	 :	{ !isScanningQuery() }? 'YESTERDAY' ;
> TODAY 		 :	{ !isScanningQuery() }? 'TODAY' ;
> TOMORROW 	 :	{ !isScanningQuery() }? 'TOMORROW' ;
> LAST_WEEK 	 :	{ !isScanningQuery() }? 'LAST_WEEK' ;
> THIS_WEEK 	 :	{ !isScanningQuery() }? 'THIS_WEEK' ;
> NEXT_WEEK 	 :	{ !isScanningQuery() }? 'NEXT_WEEK' ;
> LAST_MONTH 	 :	{ !isScanningQuery() }? 'LAST_MONTH' ;
> THIS_MONTH 	 :	{ !isScanningQuery() }? 'THIS_MONTH' ;
> NEXT_MONTH 	 :	{ !isScanningQuery() }? 'NEXT_MONTH' ;
> LAST_90_DAYS 	 :	{ !isScanningQuery() }? 'LAST_90_DAYS' ;
> NEXT_90_DAYS 	 :	{ !isScanningQuery() }? 'NEXT_90_DAYS' ;
> LAST_N_DAYS 	 :	{ !isScanningQuery() }? 'LAST_N_DAYS' ;
> NEXT_N_DAYS 	 :	{ !isScanningQuery() }? 'NEXT_N_DAYS' ;
> THIS_QUARTER 	 :	{ !isScanningQuery() }? 'THIS_QUARTER' ;
> LAST_QUARTER 	 :	{ !isScanningQuery() }? 'LAST_QUARTER' ;
> NEXT_QUARTER 	 :	{ !isScanningQuery() }? 'NEXT_QUARTER' ;
> THIS_YEAR 	 :	{ !isScanningQuery() }? 'THIS_YEAR' ;
> LAST_YEAR 	 :	{ !isScanningQuery() }? 'LAST_YEAR' ;
> NEXT_YEAR 	 :	{ !isScanningQuery() }? 'NEXT_YEAR' ;
> NEXT_N_YEARS 	 :	{ !isScanningQuery() }? 'NEXT_N_YEARS' ;
> LAST_N_YEARS 	 :	{ !isScanningQuery() }? 'LAST_N_YEARS' ;
> THIS_FISCAL_QUARTER 	 :	{ !isScanningQuery() }?  
> 'THIS_FISCAL_QUARTER' ;
> LAST_FISCAL_QUARTER 	 :	{ !isScanningQuery() }?  
> 'LAST_FISCAL_QUARTER' ;
> NEXT_FISCAL_QUARTER 	 :	{ !isScanningQuery() }?  
> 'NEXT_FISCAL_QUARTER' ;
> NEXT_N_QUARTERS 	 :	{ !isScanningQuery() }? 'NEXT_N_QUARTERS' ;
> LAST_N_QUARTERS 	 :	{ !isScanningQuery() }? 'LAST_N_QUARTERS' ;
> THIS_FISCAL_YEAR 	 :	{ !isScanningQuery() }? 'THIS_FISCAL_YEAR' ;
> LAST_FISCAL_YEAR 	 :	{ !isScanningQuery() }? 'LAST_FISCAL_YEAR' ;
> NEXT_FISCAL_YEAR 	 :	{ !isScanningQuery() }? 'NEXT_FISCAL_YEAR' ;
> NEXT_N_FISCAL_YEARS 	 :	{ !isScanningQuery() }?  
> 'NEXT_N_FISCAL_YEARS' ;
> LAST_N_FISCAL_YEARS 	 :	{ !isScanningQuery() }?  
> 'LAST_N_FISCAL_YEARS' ;
> NEXT_N_FISCAL_QUARTERS	 :	{ !isScanningQuery() }?  
> 'NEXT_N_FISCAL_QUARTERS' ;
> LAST_N_FISCAL_QUARTERS 	 :	{ !isScanningQuery() }?  
> 'LAST_N_FISCAL_QUARTERS' ;
> // ----------------------------------------------------
> // ----------------------------------------------------
>
> WS	 :	(' '
> 	|	'\t'
> 	|	'\n'
> 	|	'\r')
> 		{ skip();   }
> 	;
> 	
>
>
> ID     : { !isScanningQuery() }? ( LETTER (LETTER | '_' | DIGIT)*);
>
> PARAM  : { isScanningQuery() }? '$' LETTER (LETTER | '_' | DIGIT)*;
>
> NUMBER  : { !isScanningQuery() }? DIGIT+ ;
>
>
> QUOTE_DATA  : '\'' ( SEARCH_CHAR )+ '\'' ;
>
>
> fragment
> DATETIME : DATE ('t'|'T') HOUR ':' MINUTE ':' SECOND (('z'|'Z') |
> (('+' |'-') HOUR ':' MINUTE))
>    ;
>
> fragment
> DATE : ( DIGIT DIGIT DIGIT DIGIT ) '-' ( '0' '1'..'9' | '1' ('0' | '1'
> | '2') ) '-'  ( '0' '1'..'9' | '1'..'2' DIGIT | '3' ('0' | '1') )
>    ;
>
> fragment
> HOUR : '0'..'1' DIGIT | '2' '0'..'3'
>    ;
>
> fragment
> MINUTE : '0'..'5' DIGIT
>    ;
>
> fragment
> SECOND : '0'..'5' DIGIT | '60'
>    ;
>
>
> POSINTEGER  : DIGIT+
>    ;
>
> fragment
> DIGIT : '0'..'9'
>    ;
>
> fragment
> LETTER : 'a'..'z' | 'A'..'Z'
>    ;
> 	
> // same as SEARCH_CHAR, but won't match a $
> fragment
> SEARCH_CHAR2 :
>    ( '\\&'
>    | '\\|'
>    | '\\!'
>    | '\\{'
>    | '\\}'
>    | '\\['
>    | '\\]'
>    | '\\('
>    | '\\)'
>    | '\\^'
>    | '\\~'
>    | '\\:'
>    | '\\\\'
>    | '\\\''
>    | '\\\"' //  asd
>    | '\\+'
>    | '\\-'
>    | '\\?'
>    | '\\*'
>    |
>   ~( ' '              // don't allow white space
>    | '\t'             // don't allow white space
>    | '\n'             // don't allow white space
>    | '\r'             // don't allow white space
>    | '&'              // reserved char per spec
>    | '|'              // reserved char per spec
>    | '!'              // reserved char per spec
>    | '{'              // reserved char per spec
>    | '}'              // reserved char per spec
>    | '['              // reserved char per spec
>    | ']'              // reserved char per spec
>    | '('              // reserved char per spec (from 10.0)
>    | ')'              // reserved char per spec (from 10.0)
>    | '?'              // reserved char per spec (from 10.0)
>    | '^'              // reserved char per spec
>    | '~'              // reserved char per spec
>    | ':'              // reserved char per spec
>    | '\\'             // reserved char per spec
>    | '\''             // reserved char per spec
>    | '\"'             // not reserved, but treating as reserved for
> better parsing behavior.
>    | '+'              // reserved char per spec
>    | '-'              // reserved char per spec
>    | '$'              // reserved for params
>    ) )
>    ;
>
> // FIND_VAL : 'f' 'i' 'n' 'd'
> //    ;
>
>
> fragment
> SEARCH_CHAR :
>    ( '\\&'
>    | '\\|'
>    | '\\!'
>    | '\\{'
>    | '\\}'
>    | '\\['
>    | '\\]'
>    | '\\('
>    | '\\)'
>    | '\\^'
>    | '\\~'
>    | '\\:'
>    | '\\\\'
>    | '\\\''
>    | '\\\"'
>    | '\\+'
>    | '\\-'
>    | '\\?'
> // --    | '\\*'
>    |
>   ~( ' '              // don't allow white space
>    | '\t'             // don't allow white space
>    | '\n'             // don't allow white space
>    | '\r'             // don't allow white space
>    | '&'              // reserved char per spec
>    | '|'              // reserved char per spec
>    | '!'              // reserved char per spec
>    | '{'              // reserved char per spec
>    | '}'              // reserved char per spec
>    | '['              // reserved char per spec
>    | ']'              // reserved char per spec
>    | '('              // reserved char per spec (from 10.0)
>    | ')'              // reserved char per spec (from 10.0)
>    | '?'              // reserved char per spec (from 10.0)
>    | '^'              // reserved char per spec
>    | '~'              // reserved char per spec
>    | ':'              // reserved char per spec
>    | '\\'             // reserved char per spec
>    | '\''             // reserved char per spec
>    | '\"'             // not reserved, but treating as reserved for
> better parsing behavior.
>    | '+'              // reserved char per spec
>    | '-'              // reserved char per spec
>    ) )
>    ;
> ================================================================
> <soslLexerRules.g>


From jens.boeykens at gmail.com  Mon Jul  7 23:51:23 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 08:51:23 +0200
Subject: [antlr-interest] (no subject)
In-Reply-To: <D5CE7A75-B69D-4883-A5E0-E3F10EE712D9@cs.usfca.edu>
References: <4872683B.9070100@gmail.com>
	<D5CE7A75-B69D-4883-A5E0-E3F10EE712D9@cs.usfca.edu>
Message-ID: <53c4e43f0807072351s4d145979qb48a60df9e91a750@mail.gmail.com>

Actually I still get an error whit this lexer rule, both in my project and
in antlrworks. It parses the quotes now, but at the end it throws an
exception as output:

Exception in thread "main"
org.antlr.runtime.tree.RewriteEmptyStreamException: token st
    at
org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
    at
org.antlr.runtime.tree.RewriteRuleTokenStream.next(RewriteRuleTokenStream.java:57)
    at
stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite_template(ANTLRv3Parser.java:10135)
    at
stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite_alternative(ANTLRv3Parser.java:8446)
    at
stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite(ANTLRv3Parser.java:8069)
    at
stage.antlr.regeneration.grammar.ANTLRv3Parser.altList(ANTLRv3Parser.java:3855)
    at
stage.antlr.regeneration.grammar.ANTLRv3Parser.rule(ANTLRv3Parser.java:2460)
    at __Test__.main(__Test__.java:16)

It doesn't specifically occurs with the quotes '"'. The angles '<<' '>>'
throw the same exception...

Is there something wrong with my input?

r : a -> template() "this is a temp";
r : a -> template() <<this is a temp>>;


Jens


2008/7/7 Terence Parr <parrt at cs.usfca.edu>:

> Wow...  that freaked me out for a second... it turns out that there is a
> lexer error, which both of us fail to see; I clicked on the output tab and
> saw it. fix with this
>
> DOUBLE_QUOTE_STRING_LITERAL
>        :       '"' (ESC | ~('\\'|'"'))* '"'
>        ;
>
>
> Ter
>
>
> On Jul 7, 2008, at 12:02 PM, Jens Boeykens wrote:
>
>  Hello all,
>>
>> I'm have an issue with parsing a particular input with ANTLRv3.g (
>> http://www.antlr.org/grammar/ANTLR).
>> I'm trying to parse the following rule:
>>
>> r : a -> template() "Some test";
>>
>> This however doesn't parse, but I can't find a bug in ANTLRv3.g or a
>> mistake in my input rule. Using ANTLRworks it seems to parse well until
>> template() and than the match fails. Don't know what could be wrong with
>> "..." though.
>>
>> Greetings
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/d324491b/attachment.html 

From jens.boeykens at gmail.com  Tue Jul  8 01:32:55 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 10:32:55 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
Message-ID: <53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>

Thanks it worked!!

I've encounterd another issue with ANTLRv3.g but it's not a very important
one. When you end your grammar with a single line comment like

// this is my comment<eof>

thus no '\n' at the end but directly end of file, the parser will complain
it is looking for a '\n'.

Jens

2008/7/7 Terence Parr <parrt at cs.usfca.edu>:

>
> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>
>> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>>>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>>> >>
>>>>
>>>> I have one '|' too many in my output:
>>>> r: a -> int | b -> char |;
>>>>
>>>
>>> Use <...; separator="|">
>>>
>>
>> Sorry I can't find the exact syntax to use here. Remember I need 2 lists
>> here.
>> <alternative,rewrite; separator=" | ">  and <alternative rewrite;
>> separator=" | "> give errors...
>>
>
> Oh, sorry.
>
>  <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>>>>
>>>
> Should work
> Ter
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/f3390887/attachment.html 

From kahina.bouarab at etu.upmc.fr  Tue Jul  8 02:09:24 2008
From: kahina.bouarab at etu.upmc.fr (Kahina BOUARAB)
Date: Tue, 08 Jul 2008 11:09:24 +0200
Subject: [antlr-interest] read from socket
Message-ID: <20080708110924.sybrkuy3kg80o88g@webmail.etu.upmc.fr>

First, excuse me for my bad english.
  I've a thread which reads commands from a socket. I would like these  
commands to be parsed by an ANTLR parser.
e.g: a part of grammar:
          DR()
          RQ()
          TQ()*
          FR()

the probleme is: i receive these commands separately from socket.
So if i parse DR, the parser tell me

BR.recoverFromMismatchedToken
line 0:-1 mismatched input '<EOF>' expecting 'RQ('

because the parser find EOF instead of RQ.

i can't accumulate these commands to give a complete block to the parser.
e.g      DR() RQ() TQ() FR()

How can i do to parse these commands properly?

thanks




From jens.boeykens at gmail.com  Tue Jul  8 02:33:21 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 11:33:21 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
Message-ID: <53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>

Another detail for rule rewrite_tree_atom that I am not sure if it is
correct:

In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)

The question mark dissapeared.  I added  it  in my code, but  not sure if it
is necessary...

Another thing I did not understand very well (probably my own fault ;) ) :
There is a rule called "rewrite_template_block" which is defined, but no
other rule seems to be using it. Does this make the rule obsolete? I noticed
this because I have not yet encountered a testcase where the rule was used,
so I am not sure wether I should write more tests or the rule is indeed
obsolete.

Kind regards

2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:

> Thanks it worked!!
>
> I've encounterd another issue with ANTLRv3.g but it's not a very important
> one. When you end your grammar with a single line comment like
>
> // this is my comment<eof>
>
> thus no '\n' at the end but directly end of file, the parser will complain
> it is looking for a '\n'.
>
> Jens
>
> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>
>
>> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>>
>>>  block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>>>>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>>>> >>
>>>>>
>>>>> I have one '|' too many in my output:
>>>>> r: a -> int | b -> char |;
>>>>>
>>>>
>>>> Use <...; separator="|">
>>>>
>>>
>>> Sorry I can't find the exact syntax to use here. Remember I need 2 lists
>>> here.
>>> <alternative,rewrite; separator=" | ">  and <alternative rewrite;
>>> separator=" | "> give errors...
>>>
>>
>> Oh, sorry.
>>
>>  <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>>>>>
>>>>
>> Should work
>> Ter
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/1cd3bcf9/attachment.html 

From jaluber at gmx.de  Tue Jul  8 02:51:31 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 08 Jul 2008 11:51:31 +0200
Subject: [antlr-interest] read from socket
In-Reply-To: <20080708110924.sybrkuy3kg80o88g@webmail.etu.upmc.fr>
References: <20080708110924.sybrkuy3kg80o88g@webmail.etu.upmc.fr>
Message-ID: <487338A3.9040800@gmx.de>

Kahina BOUARAB schrieb:
> First, excuse me for my bad english.
>  I've a thread which reads commands from a socket. I would like these 
> commands to be parsed by an ANTLR parser.
> e.g: a part of grammar:
>          DR()
>          RQ()
>          TQ()*
>          FR()
> 
> the probleme is: i receive these commands separately from socket.
> So if i parse DR, the parser tell me
> 
> BR.recoverFromMismatchedToken
> line 0:-1 mismatched input '<EOF>' expecting 'RQ('
> 
> because the parser find EOF instead of RQ.
> 
> i can't accumulate these commands to give a complete block to the parser.
> e.g      DR() RQ() TQ() FR()
> 
> How can i do to parse these commands properly?
> 
> thanks
> 
> 
> 
Currently the lexer requires the entire input upfront because all tokens 
are generated before the parser sees them. You have to create a new 
class which only generates tokens on a need-to-have basis. I believe the 
archives and maybe the wiki contain some further hints.

Johannes

From vsubscr at gmail.com  Tue Jul  8 03:10:23 2008
From: vsubscr at gmail.com (Tired Ofsubscriptions)
Date: Tue, 8 Jul 2008 12:10:23 +0200
Subject: [antlr-interest] ANSI C grammar for ANTLR v3: compilation problem
	with versions higer than 3.0.1
Message-ID: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>

Hi!

I am trying to compile *ANSI C grammar for ANTLR
v3<http://www.antlr.org/grammar/1153358328744/c.g>
* with newer versions (> 3.0.1) of ANTLR.
There is a problem in the generated lexer file when I compile my user
program:
=========================================
CParserLexer.java:2942: cannot find symbol
symbol  : variable channel
location: class CParserLexer
            channel=99;
            ^
CParserLexer.java:3003: cannot find symbol
symbol  : variable channel
location: class CParserLexer
            channel=99;
            ^
CParserLexer.java:3077: cannot find symbol
symbol  : variable channel
location: class CParserLexer
            channel=99;
            ^
CParserLexer.java:3150: cannot find symbol
symbol  : variable channel
location: class CParserLexer
            channel=99;
            ^
=========================================
I tried it with versions antlr-3.1b1 and antlr-2008-06-26.17.

Should I change something in the grammar file to adapt it to newer version
or is it a bug in the antlr code?

Thanks for help,
Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/ca673d6a/attachment-0001.html 

From jaluber at gmx.de  Tue Jul  8 03:18:21 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 08 Jul 2008 12:18:21 +0200
Subject: [antlr-interest] ANSI C grammar for ANTLR v3: compilation
 problem with versions higer than 3.0.1
In-Reply-To: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>
References: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>
Message-ID: <48733EED.7030402@gmx.de>

Tired Ofsubscriptions schrieb:
> Hi!
> 
> I am trying to compile **ANSI C grammar for ANTLR v3* 
> <http://www.antlr.org/grammar/1153358328744/c.g>* with newer versions (> 
> 3.0.1) of ANTLR.
> There is a problem in the generated lexer file when I compile my user 
> program:
> ==============================
> ===========
> CParserLexer.java:2942: cannot find symbol
> symbol  : variable channel
> location: class CParserLexer
>             channel=99;
>             ^
> CParserLexer.java:3003: cannot find symbol
> symbol  : variable channel
> location: class CParserLexer
>             channel=99;
>             ^
> CParserLexer.java:3077: cannot find symbol
> symbol  : variable channel
> location: class CParserLexer
>             channel=99;
>             ^
> CParserLexer.java:3150: cannot find symbol
> symbol  : variable channel
> location: class CParserLexer
>             channel=99;
>             ^
> =========================================
> I tried it with versions antlr-3.1b1 and antlr-2008-06-26.17.
> 
> Should I change something in the grammar file to adapt it to newer 
> version or is it a bug in the antlr code?
> 
> Thanks for help,
> Vlad

channel has been moved into a RecognizerSharedState object. I believe 
this object is called state, but I'm not sure about this. Effectively, 
you have change channel into state.channel.

Johannes

From vsubscr at gmail.com  Tue Jul  8 04:31:54 2008
From: vsubscr at gmail.com (Tired Ofsubscriptions)
Date: Tue, 8 Jul 2008 13:31:54 +0200
Subject: [antlr-interest] ANSI C grammar for ANTLR v3: compilation
	problem with versions higer than 3.0.1
In-Reply-To: <48733EED.7030402@gmx.de>
References: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>
	<48733EED.7030402@gmx.de>
Message-ID: <309ee5c90807080431k1232194aw94bfa2e0563de913@mail.gmail.com>

Ok, I found that channel should be change to $channel in the grammar, but
the main problem was caused by my mistake in Makefile, which add an old
version of ANTLR to classpath at later stages.

Thanks!
Vlad

2008/7/8 Johannes Luber <jaluber at gmx.de>:

> Tired Ofsubscriptions schrieb:
>
>> Hi!
>>
>> I am trying to compile **ANSI C grammar for ANTLR v3* <
>> http://www.antlr.org/grammar/1153358328744/c.g>* with newer versions (>
>> 3.0.1) of ANTLR.
>>
>> There is a problem in the generated lexer file when I compile my user
>> program:
>> ==============================
>> ===========
>> CParserLexer.java:2942: cannot find symbol
>> symbol  : variable channel
>> location: class CParserLexer
>>            channel=99;
>>            ^
>> CParserLexer.java:3003: cannot find symbol
>> symbol  : variable channel
>> location: class CParserLexer
>>            channel=99;
>>            ^
>> CParserLexer.java:3077: cannot find symbol
>> symbol  : variable channel
>> location: class CParserLexer
>>            channel=99;
>>            ^
>> CParserLexer.java:3150: cannot find symbol
>> symbol  : variable channel
>> location: class CParserLexer
>>            channel=99;
>>            ^
>> =========================================
>> I tried it with versions antlr-3.1b1 and antlr-2008-06-26.17.
>>
>> Should I change something in the grammar file to adapt it to newer version
>> or is it a bug in the antlr code?
>>
>> Thanks for help,
>> Vlad
>>
>
> channel has been moved into a RecognizerSharedState object. I believe this
> object is called state, but I'm not sure about this. Effectively, you have
> change channel into state.channel.
>
> Johannes
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/ddb4e03c/attachment.html 

From jens.boeykens at gmail.com  Tue Jul  8 04:38:17 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 13:38:17 +0200
Subject: [antlr-interest] (no subject)
In-Reply-To: <53c4e43f0807072351s4d145979qb48a60df9e91a750@mail.gmail.com>
References: <4872683B.9070100@gmail.com>
	<D5CE7A75-B69D-4883-A5E0-E3F10EE712D9@cs.usfca.edu>
	<53c4e43f0807072351s4d145979qb48a60df9e91a750@mail.gmail.com>
Message-ID: <53c4e43f0807080438m5fdc3b4fhfba0472dbde97041@mail.gmail.com>

I implemented a fix for this as follows:

*rewrite_template
    :   // -> template(a={...},...) "..."    inline template
        {input.LT(1).getText().equals("template")}?
        id lp='(' rewrite_template_args    ')'
        rewrite_template_quote
        -> ^(TEMPLATE[$lp,"TEMPLATE"] id rewrite_template_args
rewrite_template_quote)*
     | ...

And

*rewrite_template_quote: DOUBLE_QUOTE_STRING_LITERAL |
DOUBLE_ANGLE_STRING_LITERAL ;*


And a similar change in ANTLRv3Tree.g

No sure if this is 'the' correct way to do this, but for so far it seems to
work.

Jens

2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:

> Actually I still get an error whit this lexer rule, both in my project and
> in antlrworks. It parses the quotes now, but at the end it throws an
> exception as output:
>
> Exception in thread "main"
> org.antlr.runtime.tree.RewriteEmptyStreamException: token st
>     at
> org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
>     at
> org.antlr.runtime.tree.RewriteRuleTokenStream.next(RewriteRuleTokenStream.java:57)
>     at
> stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite_template(ANTLRv3Parser.java:10135)
>     at
> stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite_alternative(ANTLRv3Parser.java:8446)
>     at
> stage.antlr.regeneration.grammar.ANTLRv3Parser.rewrite(ANTLRv3Parser.java:8069)
>     at
> stage.antlr.regeneration.grammar.ANTLRv3Parser.altList(ANTLRv3Parser.java:3855)
>     at
> stage.antlr.regeneration.grammar.ANTLRv3Parser.rule(ANTLRv3Parser.java:2460)
>     at __Test__.main(__Test__.java:16)
>
> It doesn't specifically occurs with the quotes '"'. The angles '<<' '>>'
> throw the same exception...
>
> Is there something wrong with my input?
>
> r : a -> template() "this is a temp";
> r : a -> template() <<this is a temp>>;
>
>
> Jens
>
>
> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>
> Wow...  that freaked me out for a second... it turns out that there is a
>> lexer error, which both of us fail to see; I clicked on the output tab and
>> saw it. fix with this
>>
>> DOUBLE_QUOTE_STRING_LITERAL
>>        :       '"' (ESC | ~('\\'|'"'))* '"'
>>        ;
>>
>>
>> Ter
>>
>>
>> On Jul 7, 2008, at 12:02 PM, Jens Boeykens wrote:
>>
>>  Hello all,
>>>
>>> I'm have an issue with parsing a particular input with ANTLRv3.g (
>>> http://www.antlr.org/grammar/ANTLR).
>>> I'm trying to parse the following rule:
>>>
>>> r : a -> template() "Some test";
>>>
>>> This however doesn't parse, but I can't find a bug in ANTLRv3.g or a
>>> mistake in my input rule. Using ANTLRworks it seems to parse well until
>>> template() and than the match fails. Don't know what could be wrong with
>>> "..." though.
>>>
>>> Greetings
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/f46ad2c4/attachment.html 

From jens.boeykens at gmail.com  Tue Jul  8 05:51:59 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 14:51:59 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
Message-ID: <53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>

Another error in ANTLRv3.g:

*rewrite_tree_element
    :    rewrite_tree_atom
    |    rewrite_tree_atom ebnfSuffix
        -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"] rewrite_tree_atom
EOA["EOA"]) EOB["EOB"]))
    |   rewrite_tree
        (    ebnfSuffix
            -> ^(ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"] rewrite_tree
EOA["EOA"]) EOB["EOB"]))
        |    -> rewrite_tree
        )
    |   rewrite_tree_ebnf
    ;*


The 3rd alternative did not include the ebnfSuffix in the tree. It seems
nothing needs to be changed in ANTLRv3Tree.g but I don't fully understand
the transition of rewrite_tree_element from ANTLRv3.g to ANTLRv3Tree.g so I
could be mistaken here.

Jens

2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:

> Another detail for rule rewrite_tree_atom that I am not sure if it is
> correct:
>
> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>
> The question mark dissapeared.  I added  it  in my code, but  not sure if
> it is necessary...
>
> Another thing I did not understand very well (probably my own fault ;) ) :
> There is a rule called "rewrite_template_block" which is defined, but no
> other rule seems to be using it. Does this make the rule obsolete? I noticed
> this because I have not yet encountered a testcase where the rule was used,
> so I am not sure wether I should write more tests or the rule is indeed
> obsolete.
>
> Kind regards
>
> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>
> Thanks it worked!!
>>
>> I've encounterd another issue with ANTLRv3.g but it's not a very important
>> one. When you end your grammar with a single line comment like
>>
>> // this is my comment<eof>
>>
>> thus no '\n' at the end but directly end of file, the parser will complain
>> it is looking for a '\n'.
>>
>> Jens
>>
>> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>>
>>
>>> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>>>
>>>>  block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>>>>>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>>>>> >>
>>>>>>
>>>>>> I have one '|' too many in my output:
>>>>>> r: a -> int | b -> char |;
>>>>>>
>>>>>
>>>>> Use <...; separator="|">
>>>>>
>>>>
>>>> Sorry I can't find the exact syntax to use here. Remember I need 2 lists
>>>> here.
>>>> <alternative,rewrite; separator=" | ">  and <alternative rewrite;
>>>> separator=" | "> give errors...
>>>>
>>>
>>> Oh, sorry.
>>>
>>>  <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>>>>>>
>>>>>
>>> Should work
>>> Ter
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/b28e6099/attachment.html 

From jens.boeykens at gmail.com  Tue Jul  8 07:00:54 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Tue, 8 Jul 2008 16:00:54 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
Message-ID: <53c4e43f0807080700m310a2d3cn36448b548c91e79@mail.gmail.com>

Still one more;)

In treeSpec there is functionality missing to support suffixes. E.g.

r: ^(a b)+;

will not parse. Fixed it with this:

*treeSpec
    :    '^(' element ( element )+ ')' ebnfSuffix? -> ^(TREE_BEGIN element+
ebnfSuffix?)
    ;

*Best regards,
Jens

2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:

> Another error in ANTLRv3.g:
>
> *rewrite_tree_element
>     :    rewrite_tree_atom
>     |    rewrite_tree_atom ebnfSuffix
>         -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"] rewrite_tree_atom
> EOA["EOA"]) EOB["EOB"]))
>     |   rewrite_tree
>         (    ebnfSuffix
>             -> ^(ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"] rewrite_tree
> EOA["EOA"]) EOB["EOB"]))
>         |    -> rewrite_tree
>         )
>     |   rewrite_tree_ebnf
>     ;*
>
>
> The 3rd alternative did not include the ebnfSuffix in the tree. It seems
> nothing needs to be changed in ANTLRv3Tree.g but I don't fully understand
> the transition of rewrite_tree_element from ANTLRv3.g to ANTLRv3Tree.g so I
> could be mistaken here.
>
> Jens
>
>
> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>
>> Another detail for rule rewrite_tree_atom that I am not sure if it is
>> correct:
>>
>> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
>> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>>
>> The question mark dissapeared.  I added  it  in my code, but  not sure if
>> it is necessary...
>>
>> Another thing I did not understand very well (probably my own fault ;) ) :
>> There is a rule called "rewrite_template_block" which is defined, but no
>> other rule seems to be using it. Does this make the rule obsolete? I noticed
>> this because I have not yet encountered a testcase where the rule was used,
>> so I am not sure wether I should write more tests or the rule is indeed
>> obsolete.
>>
>> Kind regards
>>
>> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>>
>> Thanks it worked!!
>>>
>>> I've encounterd another issue with ANTLRv3.g but it's not a very
>>> important one. When you end your grammar with a single line comment like
>>>
>>> // this is my comment<eof>
>>>
>>> thus no '\n' at the end but directly end of file, the parser will
>>> complain it is looking for a '\n'.
>>>
>>> Jens
>>>
>>> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>>>
>>>
>>>> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>>>>
>>>>>  block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>>>>>>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>>>>>>> >>
>>>>>>>
>>>>>>> I have one '|' too many in my output:
>>>>>>> r: a -> int | b -> char |;
>>>>>>>
>>>>>>
>>>>>> Use <...; separator="|">
>>>>>>
>>>>>
>>>>> Sorry I can't find the exact syntax to use here. Remember I need 2
>>>>> lists here.
>>>>> <alternative,rewrite; separator=" | ">  and <alternative rewrite;
>>>>> separator=" | "> give errors...
>>>>>
>>>>
>>>> Oh, sorry.
>>>>
>>>>  <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>>>>>>>
>>>>>>
>>>> Should work
>>>> Ter
>>>>
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/38fb6dc4/attachment-0001.html 

From manoj_nitrkl at yahoo.co.in  Tue Jul  8 07:18:30 2008
From: manoj_nitrkl at yahoo.co.in (manoj bishwal)
Date: Tue, 8 Jul 2008 19:48:30 +0530 (IST)
Subject: [antlr-interest] memory leak foe lexer in antlr 2.7.7
Message-ID: <945092.5671.qm@web7910.mail.in.yahoo.com>

hi
?
i am manoj kumar bishwal completed MCA from NIT Rourkela. i am using antlr 2.7.7. for designing a grammar for SELECT quary . i found some memory leak while maching the token in lexical analysis 
match(TK_SELECT);
that is in my genereted file lexer and parser.cpp file 
can u give any suggesion for removing these memory leak.
My target language is CPP so i cant go for 3.X.X version as that is not support for CPP as a target language
Thanks 
Manoj Kumar Bishwal
?


      Share files, take polls, and make new friends - all under one roof. Go to http://in.promos.yahoo.com/groups/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/47c7e51b/attachment.html 

From robert.munteanu at gmail.com  Tue Jul  8 08:34:20 2008
From: robert.munteanu at gmail.com (Robert Munteanu)
Date: Tue, 8 Jul 2008 18:34:20 +0300
Subject: [antlr-interest] [newbie] Precedence of rules
Message-ID: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>

Hi,

I am trying to build a larger ANTLR grammar, but I have one single
point of error. It boils down to the following very simple grammar:

grammar Test;

options {
	language = Java;
	output = AST;
}

startup:
  first=STRING COMMA second=STRING
  {
    System.out.println($first.text + " and " + $second.text);
  }
;

COMMA : ',';
STRING : ('a'..'z'|'A'..'Z')+;
STRING_WITH_COMMA : STRING (COMMA STRING)+ ;

I would like the input

hello,world

to be treated as STRING COMMA STRING and to get the output

hello and world

However, all I get is

BR.recoverFromMismatchedToken
line 1:0 mismatched input 'hello,world' expecting STRING

I assume it's something very basic I have overlooked ( only possible
conclusion after staring for about 4 hours at it ).

Can someone please point it out ?

Thank you,

Robert

From dmzajic at umiacs.umd.edu  Tue Jul  8 10:19:56 2008
From: dmzajic at umiacs.umd.edu (David Zajic)
Date: Tue, 08 Jul 2008 13:19:56 -0400
Subject: [antlr-interest] Unexpected character conversions
Message-ID: <4873A1BC.9090908@umiacs.umd.edu>

I'm experiencing unexpected character conversions for upper-ascii 
characters at the level of the lexer (or possibly the character 
stream).  For example, the character octal 222 is converted to three 
characters: octal 357 octal 277 octal 275.  Can you point me to the 
documentation about why this happens?  Is it possible to configure ANTLR 
so that upper ascii characters are passed through as is?
    Thanks,
    David


From parrt at cs.usfca.edu  Tue Jul  8 10:50:30 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 8 Jul 2008 10:50:30 -0700
Subject: [antlr-interest] (no subject)
In-Reply-To: <53c4e43f0807080438m5fdc3b4fhfba0472dbde97041@mail.gmail.com>
References: <4872683B.9070100@gmail.com>
	<D5CE7A75-B69D-4883-A5E0-E3F10EE712D9@cs.usfca.edu>
	<53c4e43f0807072351s4d145979qb48a60df9e91a750@mail.gmail.com>
	<53c4e43f0807080438m5fdc3b4fhfba0472dbde97041@mail.gmail.com>
Message-ID: <EDDF5A7B-D0DC-4E2E-A1C7-492355D66E71@cs.usfca.edu>

I changed mine yesterday to be:

		( str=DOUBLE_QUOTE_STRING_LITERAL | str=DOUBLE_ANGLE_STRING_LITERAL )


does that work for you?

Ter


From parrt at cs.usfca.edu  Tue Jul  8 10:52:11 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 8 Jul 2008 10:52:11 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
Message-ID: <0874A804-6A9A-4523-841C-0FD7B16F183F@cs.usfca.edu>

fixed. thanks.
Ter
On Jul 8, 2008, at 5:51 AM, Jens Boeykens wrote:

> Another error in ANTLRv3.g:
>
> rewrite_tree_element
>     :    rewrite_tree_atom
>     |    rewrite_tree_atom ebnfSuffix
>         -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
> rewrite_tree_atom EOA["EOA"]) EOB["EOB"]))
>     |   rewrite_tree
>         (    ebnfSuffix
>             -> ^(ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
> rewrite_tree EOA["EOA"]) EOB["EOB"]))
>         |    -> rewrite_tree
>         )
>     |   rewrite_tree_ebnf
>     ;
>
>
> The 3rd alternative did not include the ebnfSuffix in the tree. It  
> seems nothing needs to be changed in ANTLRv3Tree.g but I don't fully  
> understand the transition of rewrite_tree_element from ANTLRv3.g to  
> ANTLRv3Tree.g so I could be mistaken here.
>
> Jens


From parrt at cs.usfca.edu  Tue Jul  8 10:53:14 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 8 Jul 2008 10:53:14 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080700m310a2d3cn36448b548c91e79@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
	<53c4e43f0807080700m310a2d3cn36448b548c91e79@mail.gmail.com>
Message-ID: <D314FBC3-D300-4C14-A914-5C2B8E9E0899@cs.usfca.edu>

Right...current parser doesn't handle but let's fix for v3 grammar.
Ter
On Jul 8, 2008, at 7:00 AM, Jens Boeykens wrote:

> Still one more;)
>
> In treeSpec there is functionality missing to support suffixes. E.g.
>
> r: ^(a b)+;
>
> will not parse. Fixed it with this:
>
> treeSpec
>     :    '^(' element ( element )+ ')' ebnfSuffix? -> ^(TREE_BEGIN  
> element+ ebnfSuffix?)
>     ;
>
> Best regards,
> Jens
>
> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
> Another error in ANTLRv3.g:
>
> rewrite_tree_element
>     :    rewrite_tree_atom
>     |    rewrite_tree_atom ebnfSuffix
>         -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
> rewrite_tree_atom EOA["EOA"]) EOB["EOB"]))
>     |   rewrite_tree
>         (    ebnfSuffix
>             -> ^(ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
> rewrite_tree EOA["EOA"]) EOB["EOB"]))
>         |    -> rewrite_tree
>         )
>     |   rewrite_tree_ebnf
>     ;
>
>
> The 3rd alternative did not include the ebnfSuffix in the tree. It  
> seems nothing needs to be changed in ANTLRv3Tree.g but I don't fully  
> understand the transition of rewrite_tree_element from ANTLRv3.g to  
> ANTLRv3Tree.g so I could be mistaken here.
>
> Jens
>
>
> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
> Another detail for rule rewrite_tree_atom that I am not sure if it  
> is correct:
>
> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>
> The question mark dissapeared.  I added  it  in my code, but  not  
> sure if it is necessary...
>
> Another thing I did not understand very well (probably my own  
> fault ;) ) :
> There is a rule called "rewrite_template_block" which is defined,  
> but no other rule seems to be using it. Does this make the rule  
> obsolete? I noticed this because I have not yet encountered a  
> testcase where the rule was used, so I am not sure wether I should  
> write more tests or the rule is indeed obsolete.
>
> Kind regards
>
> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>
> Thanks it worked!!
>
> I've encounterd another issue with ANTLRv3.g but it's not a very  
> important one. When you end your grammar with a single line comment  
> like
>
> // this is my comment<eof>
>
> thus no '\n' at the end but directly end of file, the parser will  
> complain it is looking for a '\n'.
>
> Jens
>
> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>
>
> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
> >>
>
> I have one '|' too many in my output:
> r: a -> int | b -> char |;
>
> Use <...; separator="|">
>
> Sorry I can't find the exact syntax to use here. Remember I need 2  
> lists here.
> <alternative,rewrite; separator=" | ">  and <alternative rewrite;  
> separator=" | "> give errors...
>
> Oh, sorry.
>
> <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>
> Should work
> Ter
>
>
>
>


From parrt at cs.usfca.edu  Tue Jul  8 10:55:09 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 8 Jul 2008 10:55:09 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <D314FBC3-D300-4C14-A914-5C2B8E9E0899@cs.usfca.edu>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<53c4e43f0807080551i76048430hd78b4f251b839aa@mail.gmail.com>
	<53c4e43f0807080700m310a2d3cn36448b548c91e79@mail.gmail.com>
	<D314FBC3-D300-4C14-A914-5C2B8E9E0899@cs.usfca.edu>
Message-ID: <3B52CDDD-503B-460D-B342-26F725CBF17C@cs.usfca.edu>

Actully, i left that and changed elementNoOption

	|   treeSpec
		(	ebnfSuffix	-> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"] treeSpec  
EOA["EOA"]) EOB["EOB"]) )
		|				-> treeSpec
		)
	;

On Jul 8, 2008, at 10:53 AM, Terence Parr wrote:

> Right...current parser doesn't handle but let's fix for v3 grammar.
> Ter
> On Jul 8, 2008, at 7:00 AM, Jens Boeykens wrote:
>
>> Still one more;)
>>
>> In treeSpec there is functionality missing to support suffixes. E.g.
>>
>> r: ^(a b)+;
>>
>> will not parse. Fixed it with this:
>>
>> treeSpec
>>    :    '^(' element ( element )+ ')' ebnfSuffix? -> ^(TREE_BEGIN  
>> element+ ebnfSuffix?)
>>    ;
>>
>> Best regards,
>> Jens
>>
>> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>> Another error in ANTLRv3.g:
>>
>> rewrite_tree_element
>>    :    rewrite_tree_atom
>>    |    rewrite_tree_atom ebnfSuffix
>>        -> ^( ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
>> rewrite_tree_atom EOA["EOA"]) EOB["EOB"]))
>>    |   rewrite_tree
>>        (    ebnfSuffix
>>            -> ^(ebnfSuffix ^(BLOCK["BLOCK"] ^(ALT["ALT"]  
>> rewrite_tree EOA["EOA"]) EOB["EOB"]))
>>        |    -> rewrite_tree
>>        )
>>    |   rewrite_tree_ebnf
>>    ;
>>
>>
>> The 3rd alternative did not include the ebnfSuffix in the tree. It  
>> seems nothing needs to be changed in ANTLRv3Tree.g but I don't  
>> fully understand the transition of rewrite_tree_element from  
>> ANTLRv3.g to ANTLRv3Tree.g so I could be mistaken here.
>>
>> Jens
>>
>>
>> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>> Another detail for rule rewrite_tree_atom that I am not sure if it  
>> is correct:
>>
>> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
>> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>>
>> The question mark dissapeared.  I added  it  in my code, but  not  
>> sure if it is necessary...
>>
>> Another thing I did not understand very well (probably my own  
>> fault ;) ) :
>> There is a rule called "rewrite_template_block" which is defined,  
>> but no other rule seems to be using it. Does this make the rule  
>> obsolete? I noticed this because I have not yet encountered a  
>> testcase where the rule was used, so I am not sure wether I should  
>> write more tests or the rule is indeed obsolete.
>>
>> Kind regards
>>
>> 2008/7/8 Jens Boeykens <jens.boeykens at gmail.com>:
>>
>> Thanks it worked!!
>>
>> I've encounterd another issue with ANTLRv3.g but it's not a very  
>> important one. When you end your grammar with a single line comment  
>> like
>>
>> // this is my comment<eof>
>>
>> thus no '\n' at the end but directly end of file, the parser will  
>> complain it is looking for a '\n'.
>>
>> Jens
>>
>> 2008/7/7 Terence Parr <parrt at cs.usfca.edu>:
>>
>>
>> On Jul 7, 2008, at 2:23 PM, Jens Boeykens wrote:
>> block(blok, optionsSpec, alternative, rewrite, eob) ::= <<
>> <alternative,rewrite: {alt,rw | <alt> <rw> | }>
>> >>
>>
>> I have one '|' too many in my output:
>> r: a -> int | b -> char |;
>>
>> Use <...; separator="|">
>>
>> Sorry I can't find the exact syntax to use here. Remember I need 2  
>> lists here.
>> <alternative,rewrite; separator=" | ">  and <alternative rewrite;  
>> separator=" | "> give errors...
>>
>> Oh, sorry.
>>
>> <alternative,rewrite: {alt,rw | <alt> <rw>}; separator="|">
>>
>> Should work
>> Ter
>>
>>
>>
>>
>


From parrt at cs.usfca.edu  Tue Jul  8 10:58:02 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 8 Jul 2008 10:58:02 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
Message-ID: <00C87112-F31C-423D-BD3A-BA1E71AAC058@cs.usfca.edu>


On Jul 8, 2008, at 2:33 AM, Jens Boeykens wrote:

> Another detail for rule rewrite_tree_atom that I am not sure if it  
> is correct:
>
> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>
> The question mark dissapeared.  I added  it  in my code, but  not  
> sure if it is necessary...

Nope. not needed.  alt above takes care of it:

	|   TOKEN_REF
	|   ^(TOKEN_REF ARG_ACTION) // for imaginary nodes

> Another thing I did not understand very well (probably my own  
> fault ;) ) :
> There is a rule called "rewrite_template_block" which is defined,  
> but no other rule seems to be using it. Does this make the rule  
> obsolete? I noticed this because I have not yet encountered a  
> testcase where the rule was used, so I am not sure wether I should  
> write more tests or the rule is indeed obsolete.


Used by rewrite_tree_element and ebnf.
Ter

From jaluber at gmx.de  Tue Jul  8 11:18:59 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 08 Jul 2008 20:18:59 +0200
Subject: [antlr-interest] [newbie] Precedence of rules
In-Reply-To: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
References: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
Message-ID: <4873AF93.3070106@gmx.de>

Robert Munteanu schrieb:
> Hi,
> 
> I am trying to build a larger ANTLR grammar, but I have one single
> point of error. It boils down to the following very simple grammar:
> 
> grammar Test;
> 
> options {
> 	language = Java;
> 	output = AST;
> }
> 
> startup:
>   first=STRING COMMA second=STRING
>   {
>     System.out.println($first.text + " and " + $second.text);
>   }
> ;
> 
> COMMA : ',';
> STRING : ('a'..'z'|'A'..'Z')+;
> STRING_WITH_COMMA : STRING (COMMA STRING)+ ;
> 
> I would like the input
> 
> hello,world
> 
> to be treated as STRING COMMA STRING and to get the output
> 
> hello and world
> 
> However, all I get is
> 
> BR.recoverFromMismatchedToken
> line 1:0 mismatched input 'hello,world' expecting STRING
> 
> I assume it's something very basic I have overlooked ( only possible
> conclusion after staring for about 4 hours at it ).
> 
> Can someone please point it out ?
> 
> Thank you,
> 
> Robert
> 

Instead STRING_WITH_COMMA write string_with_comma. Uppercase rules are 
lexer rules, lowercase rules parser rules.

Johannes

From everttigchelaar at gmail.com  Tue Jul  8 13:01:42 2008
From: everttigchelaar at gmail.com (Potje rode kool)
Date: Tue, 8 Jul 2008 22:01:42 +0200
Subject: [antlr-interest] ast rewrite
Message-ID: <7c35a13b0807081301u2be64657ide9ea9b722c89c5f@mail.gmail.com>

Hello,

I created a gramar and it works but I am parsing the following line:

import *javax*.swing.*;

The ast is created but it creates a CommonTree for every part of the import.
I use

importDeclaration
    :   'import' qualifiedName ('.' '*')? ';'
    -> ^('import' qualifiedName ('.' '*')? ';')
    ;

Is it posible to rewrite the ast so I get only one CommonTree?

Thanks,
Evert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/74e4b76f/attachment.html 

From ben.dotte at gmail.com  Tue Jul  8 15:04:03 2008
From: ben.dotte at gmail.com (Ben Dotte)
Date: Tue, 8 Jul 2008 17:04:03 -0500
Subject: [antlr-interest] Dot won't match forward slash
Message-ID: <8a29e7880807081504t1f377415rfee081987cfc1fd@mail.gmail.com>

Hi,

I have a parser rule in my ANTLR 3 grammar like this:

quotedSearch : '"'^ .+ '"'! ;

The strange thing is, forward slashes result in a "no viable
alternative at character'/'" exception and get thrown out of the
resultant tree. I don't seem to have any problems with other
characters like \()[]* etc.

Is there something special about forward slashes or could there be any
reason for this error?

Thanks,
Ben

From jimi at temporal-wave.com  Tue Jul  8 14:55:16 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 08 Jul 2008 14:55:16 -0700
Subject: [antlr-interest] ANSI C grammar for ANTLR v3:
	compilation	problem with versions higer than 3.0.1
In-Reply-To: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>
References: <309ee5c90807080310m6d2a3064q25fdd029052f191a@mail.gmail.com>
Message-ID: <1215554116.13470.89.camel@jimi>

On Tue, 2008-07-08 at 12:10 +0200, Tired Ofsubscriptions wrote:

> Hi!
> 
> I am trying to compile ANSI C grammar for ANTLR v3 with newer versions
> (> 3.0.1) of ANTLR.
> There is a problem in the generated lexer file when I compile my user
> program:
> ==============================
> 
> ===========
> CParserLexer.java:2942: cannot find symbol
> symbol  : variable channel
> location: class CParserLexer
>             channel=99;
>             ^



> =========================================
> I tried it with versions antlr-3.1b1 and antlr-2008-06-26.17.
> 
> Should I change something in the grammar file to adapt it to newer
> version or is it a bug in the antlr code?


In the source .g file, is this:

$channel = 99;

Or is it explicitly using channel?

These days this should be:

$channel = HIDDEN;

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080708/018ae8ce/attachment.html 

From jbb at acm.org  Tue Jul  8 15:35:14 2008
From: jbb at acm.org (John B. Brodie)
Date: Tue, 08 Jul 2008 18:35:14 -0400
Subject: [antlr-interest] Dot won't match forward slash
In-Reply-To: <8a29e7880807081504t1f377415rfee081987cfc1fd@mail.gmail.com>
	(ben.dotte@gmail.com)
References: <8a29e7880807081504t1f377415rfee081987cfc1fd@mail.gmail.com>
Message-ID: <E1KGLmE-00008c-2O@gecko.home.org>

Greetings!

Ben Dotte asked:
>I have a parser rule in my ANTLR 3 grammar like this:
>
>quotedSearch : '"'^ .+ '"'! ;
>
>The strange thing is, forward slashes result in a "no viable
>alternative at character'/'" exception and get thrown out of the
>resultant tree. I don't seem to have any problems with other
>characters like \()[]* etc.
>
>Is there something special about forward slashes 

No.

>or could there be any reason for this error?

Yes.

Your quotedSearch rule is a parser rule. thus the . inside it will
match any TOKEN produced by your LEXER.

Is your LEXER able to recognize the '/' as a token in the context of
the input sentence you are trying to match using the quotedString rule?

The `no viable alt` exception you are observing would strongly suggest
that your LEXER does not properly handle a '/' character in the input.

Hope this helps...
   -jbb

From coddbotherer at googlemail.com  Wed Jul  9 01:27:49 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Wed, 9 Jul 2008 09:27:49 +0100
Subject: [antlr-interest] Using C lexers/parsers built by ANTLR
Message-ID: <157c5c5c0807090127t61052db8w94c1845051b5ae6c@mail.gmail.com>

So far I've been generating Java from my grammar because it was easy
to get started, but I really want to use C as my target language.  No
problem getting ANTLR to generate C code, but can anyone give me a
quick steer as to how to invoke my lexer and parser from a C main?
I'm going to start reading the generated code, but it is sort of a
distraction, so if anyone can get me started I'd be hugely grateful.

Art

From felix_do at web.de  Wed Jul  9 04:01:08 2008
From: felix_do at web.de (Felix Dorner)
Date: Wed, 09 Jul 2008 13:01:08 +0200
Subject: [antlr-interest] [newbie] Precedence of rules
In-Reply-To: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
References: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
Message-ID: <48749A74.1030503@web.de>

Hi Robert.
>
> startup:
>   first=STRING COMMA second=STRING
>   {
>     System.out.println($first.text + " and " + $second.text);
>   }
> ;
>
> COMMA : ',';
> STRING : ('a'..'z'|'A'..'Z')+;
>   

> STRING_WITH_COMMA : STRING (COMMA STRING)+ ;
>
>   
I am pretty sure this rule bites with the "startup" rule. I am also 
pretty sure that you would not want this to be a Lexer but a Parser rule 
(i.e. should start with a lower Case.) Then you would have:

startup: STRING COMMA STRING {...};

string_with_comma: STRING (COMMA STRING)+;


Now it depends how those rules are invoked. If they have a common 
"superrule", then the grammar would be ambiguous.



Felix






From robert.munteanu at gmail.com  Wed Jul  9 07:44:24 2008
From: robert.munteanu at gmail.com (Robert Munteanu)
Date: Wed, 9 Jul 2008 17:44:24 +0300
Subject: [antlr-interest] [newbie] Precedence of rules
In-Reply-To: <48749A74.1030503@web.de>
References: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
	<48749A74.1030503@web.de>
Message-ID: <e60f3a6e0807090744j7858d257vdd0eb74e9b85790@mail.gmail.com>

Johannes, Felix - thank you for your help. That fixed it.

Robert

2008/7/9 Felix Dorner <felix_do at web.de>:
> Hi Robert.
>>
>> startup:
>>  first=STRING COMMA second=STRING
>>  {
>>    System.out.println($first.text + " and " + $second.text);
>>  }
>> ;
>>
>> COMMA : ',';
>> STRING : ('a'..'z'|'A'..'Z')+;
>>
>
>> STRING_WITH_COMMA : STRING (COMMA STRING)+ ;
>>
>>
>
> I am pretty sure this rule bites with the "startup" rule. I am also pretty
> sure that you would not want this to be a Lexer but a Parser rule (i.e.
> should start with a lower Case.) Then you would have:
>
> startup: STRING COMMA STRING {...};
>
> string_with_comma: STRING (COMMA STRING)+;
>
>
> Now it depends how those rules are invoked. If they have a common
> "superrule", then the grammar would be ambiguous.
>
>
>
> Felix
>
>
>
>
>
>

From jimi at temporal-wave.com  Wed Jul  9 08:17:21 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 09 Jul 2008 08:17:21 -0700
Subject: [antlr-interest] Using C lexers/parsers built by ANTLR
In-Reply-To: <157c5c5c0807090127t61052db8w94c1845051b5ae6c@mail.gmail.com>
References: <157c5c5c0807090127t61052db8w94c1845051b5ae6c@mail.gmail.com>
Message-ID: <1215616641.13470.103.camel@jimi>

On Wed, 2008-07-09 at 09:27 +0100, Artemus Ward wrote:

> So far I've been generating Java from my grammar because it was easy
> to get started, but I really want to use C as my target language.  No
> problem getting ANTLR to generate C code, but can anyone give me a
> quick steer as to how to invoke my lexer and parser from a C main?
> I'm going to start reading the generated code, but it is sort of a
> distraction, so if anyone can get me started I'd be hugely grateful.
> 


Please read the API docs. From the ANTLR front page, find the
documentation links, find the API doc, take the C API link. Not that
these are for ANTLR 3.1. Also, download the examples tar and look at all
the main.c programs.

Jim

> Art
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080709/cdbe5924/attachment.html 

From jimi at temporal-wave.com  Wed Jul  9 08:24:33 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 09 Jul 2008 08:24:33 -0700
Subject: [antlr-interest] Using C lexers/parsers built by ANTLR
In-Reply-To: <1215616641.13470.103.camel@jimi>
References: <157c5c5c0807090127t61052db8w94c1845051b5ae6c@mail.gmail.com>
	<1215616641.13470.103.camel@jimi>
Message-ID: <1215617073.13470.108.camel@jimi>

On Wed, 2008-07-09 at 08:17 -0700, Jim Idle wrote:

> On Wed, 2008-07-09 at 09:27 +0100, Artemus Ward wrote: 
> 
> > So far I've been generating Java from my grammar because it was easy
> > to get started, but I really want to use C as my target language.  No
> > problem getting ANTLR to generate C code, but can anyone give me a
> > quick steer as to how to invoke my lexer and parser from a C main?
> > I'm going to start reading the generated code, but it is sort of a
> > distraction, so if anyone can get me started I'd be hugely grateful.
> > 
> 
> 
> Please read the API docs. From the ANTLR front page, find the
> documentation links, find the API doc, take the C API link. 



> Not that these are for ANTLR 3.1. Also, download the examples tar and
> look at all the main.c programs.


that should be NOTE that. As in, these docs are for 3.1 not 3.0.1

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080709/4c3d9047/attachment.html 

From coddbotherer at googlemail.com  Wed Jul  9 08:29:11 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Wed, 9 Jul 2008 16:29:11 +0100
Subject: [antlr-interest] Using C lexers/parsers built by ANTLR
In-Reply-To: <1215616641.13470.103.camel@jimi>
References: <157c5c5c0807090127t61052db8w94c1845051b5ae6c@mail.gmail.com>
	<1215616641.13470.103.camel@jimi>
Message-ID: <157c5c5c0807090829u96ca9fm5590db1790fee900@mail.gmail.com>

2008/7/9 Jim Idle <jimi at temporal-wave.com>:

> Please read the API docs. From the ANTLR front page, find the documentation
> links, find the API doc, take the C API link. Not that these are for ANTLR
> 3.1. Also, download the examples tar and look at all the main.c programs.

Thanks Jim.  I feel a fool for not thinking to look there.  I guess
it's been so easy I've never had to bother reading the instructions.

Art

From sumanto at gmail.com  Wed Jul  9 15:54:30 2008
From: sumanto at gmail.com (Sumanto Biswas)
Date: Wed, 9 Jul 2008 15:54:30 -0700
Subject: [antlr-interest] NPE from
	org.antlr.runtime.Parser.getMissingSymbol(..) when trying to parse
Message-ID: <6c9aae640807091554j19d42d40j2a0d6aad982f2458@mail.gmail.com>

Hi,

I used the SimpleCalc.g grammar from
http://www.antlr.org/wiki/display/ANTLR3/Five+minute+introduction+to+ANTLR+3
and used antlr3.1b1 with Java and was trying it with various inputs. I
gave input "asd", and got a NPE. The stack trace along with other
output is pasted below.

Just for reference, I have also pasted grammar below.

Should the parser ever give NPE?

Regards,
Sumanto

------------------------------------------------------------
line 1:0 no viable alternative at character 'a'
line 1:1 no viable alternative at character 's'
line 1:2 no viable alternative at character 'd'
Exception in thread "main" java.lang.NullPointerException
	at org.antlr.runtime.Parser.getMissingSymbol(Parser.java:69)
	at org.antlr.runtime.BaseRecognizer.recoverFromMismatchedToken(BaseRecognizer.java:624)
	at org.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:117)
	at SimpleCalcParser.factor(SimpleCalcParser.java:189)
	at SimpleCalcParser.term(SimpleCalcParser.java:125)
	at SimpleCalcParser.expr(SimpleCalcParser.java:60)
	at Tester.main(Tester.java:24)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:90)
------------------------------------------------------------


Grammar pasted below:
------------------------------------------------------------
grammar SimpleCalc;

tokens {
	PLUS 	= '+' ;
	MINUS	= '-' ;
	MULT	= '*' ;
	DIV	= '/' ;
}



/*------------------------------------------------------------------
 * PARSER RULES
 *------------------------------------------------------------------*/

expr	: term ( ( PLUS | MINUS )  term )* ;

term	: factor ( ( MULT | DIV ) factor )* ;

factor	: NUMBER ;


/*------------------------------------------------------------------
 * LEXER RULES
 *------------------------------------------------------------------*/

NUMBER	: (DIGIT)+ ;

WHITESPACE : ( '\t' | ' ' | '\r' | '\n'| '\u000C' )+ 	{ $channel = HIDDEN; } ;

fragment DIGIT	: '0'..'9' ;
------------------------------------------------------------

From parrt at cs.usfca.edu  Wed Jul  9 15:59:00 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 9 Jul 2008 15:59:00 -0700
Subject: [antlr-interest] NPE from
	org.antlr.runtime.Parser.getMissingSymbol(..) when trying to parse
In-Reply-To: <6c9aae640807091554j19d42d40j2a0d6aad982f2458@mail.gmail.com>
References: <6c9aae640807091554j19d42d40j2a0d6aad982f2458@mail.gmail.com>
Message-ID: <6729D947-597E-49A9-8A82-DB2F0081BF55@cs.usfca.edu>

i think i fixed that just recently...it's when it finds eof or  
something upon mismatch.
Ter
On Jul 9, 2008, at 3:54 PM, Sumanto Biswas wrote:

> Hi,
>
> I used the SimpleCalc.g grammar from
> http://www.antlr.org/wiki/display/ANTLR3/Five+minute+introduction+to+ANTLR+3
> and used antlr3.1b1 with Java and was trying it with various inputs. I
> gave input "asd", and got a NPE. The stack trace along with other
> output is pasted below.
>
> Just for reference, I have also pasted grammar below.
>
> Should the parser ever give NPE?
>
> Regards,
> Sumanto
>
> ------------------------------------------------------------
> line 1:0 no viable alternative at character 'a'
> line 1:1 no viable alternative at character 's'
> line 1:2 no viable alternative at character 'd'
> Exception in thread "main" java.lang.NullPointerException
> 	at org.antlr.runtime.Parser.getMissingSymbol(Parser.java:69)
> 	at  
> org 
> .antlr 
> .runtime 
> .BaseRecognizer.recoverFromMismatchedToken(BaseRecognizer.java:624)
> 	at org.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:117)
> 	at SimpleCalcParser.factor(SimpleCalcParser.java:189)
> 	at SimpleCalcParser.term(SimpleCalcParser.java:125)
> 	at SimpleCalcParser.expr(SimpleCalcParser.java:60)
> 	at Tester.main(Tester.java:24)
> 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> 	at  
> sun 
> .reflect 
> .NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
> 	at  
> sun 
> .reflect 
> .DelegatingMethodAccessorImpl 
> .invoke(DelegatingMethodAccessorImpl.java:25)
> 	at java.lang.reflect.Method.invoke(Method.java:597)
> 	at com.intellij.rt.execution.application.AppMain.main(AppMain.java: 
> 90)
> ------------------------------------------------------------
>
>
> Grammar pasted below:
> ------------------------------------------------------------
> grammar SimpleCalc;
>
> tokens {
> 	PLUS 	= '+' ;
> 	MINUS	= '-' ;
> 	MULT	= '*' ;
> 	DIV	= '/' ;
> }
>
>
>
> /*------------------------------------------------------------------
> * PARSER RULES
> *------------------------------------------------------------------*/
>
> expr	: term ( ( PLUS | MINUS )  term )* ;
>
> term	: factor ( ( MULT | DIV ) factor )* ;
>
> factor	: NUMBER ;
>
>
> /*------------------------------------------------------------------
> * LEXER RULES
> *------------------------------------------------------------------*/
>
> NUMBER	: (DIGIT)+ ;
>
> WHITESPACE : ( '\t' | ' ' | '\r' | '\n'| '\u000C' )+ 	{ $channel =  
> HIDDEN; } ;
>
> fragment DIGIT	: '0'..'9' ;
> ------------------------------------------------------------


From asoka250 at gmail.com  Wed Jul  9 19:53:01 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Wed, 9 Jul 2008 21:53:01 -0500
Subject: [antlr-interest] error in tree grammar - regd.
Message-ID: <7b0a1e4b0807091953j4b90ceady7b9e168f23ed243b@mail.gmail.com>

Hello,

I am trying to debug the following tree grammar when I antlr complained with
the following message:-

Message in the console:-

[21:44:50] Checking Grammar...
[21:44:50] error(10):  internal error:
org.antlr.tool.Message.toString(Message.java:124): Assertion failed! Message
ID 138 created but is not present in errorMsgIDs or warningMsgIDs.

Message in the pop-up window:

(138): DOTTREE.g:0:0: grammar DOTTREE: no start rule (no rule can obviously
be followed by EOF)

Attached in the tree grammar file.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080709/3d854686/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DOTTree.g
Type: application/octet-stream
Size: 7133 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080709/3d854686/attachment.obj 

From jimi at temporal-wave.com  Wed Jul  9 20:39:48 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 09 Jul 2008 20:39:48 -0700
Subject: [antlr-interest] error in tree grammar - regd.
In-Reply-To: <7b0a1e4b0807091953j4b90ceady7b9e168f23ed243b@mail.gmail.com>
References: <7b0a1e4b0807091953j4b90ceady7b9e168f23ed243b@mail.gmail.com>
Message-ID: <1215661188.8615.24.camel@jimi>

On Wed, 2008-07-09 at 21:53 -0500, ASHOK REDDY wrote:

> Hello,
> 
> I am trying to debug the following tree grammar when I antlr
> complained with the following message:- 
> 
> Message in the console:- 
> 
> [21:44:50] Checking Grammar...
> [21:44:50] error(10):  internal error:
> org.antlr.tool.Message.toString(Message.java:124): Assertion failed!
> Message ID 138 created but is not present in errorMsgIDs or
> warningMsgIDs. 
> 
> Message in the pop-up window:
> 
> (138): DOTTREE.g:0:0: grammar DOTTREE: no start rule (no rule can
> obviously be followed by EOF)
> 
> Attached in the tree grammar file.


Ah, A dot grammar :-)

This is fairly simple to fix, if just using ANTLR 3.1 does not sort it
out. In the grammar that produces this tree, if you have not got a start
rule that ends in EOF, create one:

translationUnit
    : graph   EOF

        ->^(TRANSUNIT graph)
    :

Then make program be whatever your current start rule is (the one that
produces DIGRAPH or GRAPH).

In your tree grammar, have

translationUnit
    :    ^(TRANSUNIT
             graph
           )
   ;

basically it just cannot work out where your grammar is supposed to
start. That should do it.

Jim    



> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080709/64a45996/attachment.html 

From jens.boeykens at gmail.com  Thu Jul 10 01:53:34 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Thu, 10 Jul 2008 10:53:34 +0200
Subject: [antlr-interest] error in antlrv3tree.g: rule ebnf
Message-ID: <53c4e43f0807100153k6de24899u8731c1e17912c97a@mail.gmail.com>

Hello,

rule ebnf is missing two alternatives: ^(o='^' block) and ^(o='!' block).
These are defined in ebnf in ANTLRv3.g but nog 'caught' in ANTLRv3Tree.g
I've added them in my local version and now it works.

*ebnf
  : ^(SYNPRED block) -> ebnf_synpred(synpred={$SYNPRED}, block={$block.st})
  | ^(SYN_SEMPRED block) -> ebnf_synSempred(syn_sempred={$SYN_SEMPRED},
block={$block.st})
  | ^(ebnfSuffix block) -> ebnf_ebnfSuffixblock (ebnfSuffix
={$ebnfSuffix.st}, block = {$block.st})
  | ^(o='^' block) -> ebnf_treeblock(op={$o},block = {$block.st})
  | ^(o='!' block) -> ebnf_treeblock(op={$o},block = {$block.st})
  | block -> ebnf_block(block = {$block.st})
  ;*

Greetz,
Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/7e08d3f0/attachment-0001.html 

From jens.boeykens at gmail.com  Thu Jul 10 02:04:16 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Thu, 10 Jul 2008 11:04:16 +0200
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <00C87112-F31C-423D-BD3A-BA1E71AAC058@cs.usfca.edu>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<00C87112-F31C-423D-BD3A-BA1E71AAC058@cs.usfca.edu>
Message-ID: <53c4e43f0807100204pe0fea5aj7d3b2f84469c3078@mail.gmail.com>

2008/7/8 Terence Parr <parrt at cs.usfca.edu>:

>
> On Jul 8, 2008, at 2:33 AM, Jens Boeykens wrote:
>
>  Another detail for rule rewrite_tree_atom that I am not sure if it is
>> correct:
>>
>> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
>> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>>
>> The question mark dissapeared.  I added  it  in my code, but  not sure if
>> it is necessary...
>>
>
> Nope. not needed.  alt above takes care of it:
>
>        |   TOKEN_REF
>        |   ^(TOKEN_REF ARG_ACTION) // for imaginary nodes
>
>  Another thing I did not understand very well (probably my own fault ;) ) :
>> There is a rule called "rewrite_template_block" which is defined, but no
>> other rule seems to be using it. Does this make the rule obsolete? I noticed
>> this because I have not yet encountered a testcase where the rule was used,
>> so I am not sure wether I should write more tests or the rule is indeed
>> obsolete.
>>
>
>
> Used by rewrite_tree_element and ebnf.
> Ter
>

Hmm if I do a search for "rewrite_template_block" in the files on the site,
it is found only once. Thus it is not used in rewrite_tree_element and ebnf.
Is it possible that you have considered "rewrite_tree_block" instead of
"rewrite_template_block"?

Now a rule like: "r : a -> (template() <<this is a temp>>);" doesn't parse
because of the parentheses around template. I assume
"rewrite_template_block" was defined for this case, but since it is never
used...

Greetz,
Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/a23193a1/attachment.html 

From yotommy at gmail.com  Thu Jul 10 07:05:38 2008
From: yotommy at gmail.com (Tom Smith)
Date: Thu, 10 Jul 2008 10:05:38 -0400
Subject: [antlr-interest] NoViableAltException in tree grammar
Message-ID: <82dc0d190807100705u5da857e5hba7e45e344afbf55@mail.gmail.com>

Hello,

I'm stumped by the case below.  I had assumed the difficulties would begin
with ambiguities in my grammars, but I'm already stuck with a
NoViableAltException.

I need to be able to handle the following cases:
- a followed by b
- a only
- b only

My initial parser works OK on all three types of input, but my tree parser
yields a NoViableAltException when presented with the third case.  That is
surprising to me since the alternatives have the same form in both parsers.

Suggestions welcome!

Thanks,
Tom.
===
grammar Test;

options {
    output = AST;
}

top
    :    before after
    ->  before after
    |    before
    ->  before
    |    after
    ->  after
    ;

before
    :    'before'
    ;

after
    :    'after'
    ;

WS
    :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
    ;

===
tree grammar TestTree;

options {
    ASTLabelType = CommonTree;
}

top
    :    before after
    |    before
    |    after
    ;

before
    :    'before'
    ;

after
    :    'after'
    ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/9a73968e/attachment.html 

From jimi at temporal-wave.com  Thu Jul 10 08:41:34 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 10 Jul 2008 08:41:34 -0700
Subject: [antlr-interest] NoViableAltException in tree grammar
In-Reply-To: <82dc0d190807100705u5da857e5hba7e45e344afbf55@mail.gmail.com>
References: <82dc0d190807100705u5da857e5hba7e45e344afbf55@mail.gmail.com>
Message-ID: <1215704494.8615.54.camel@jimi>

On Thu, 2008-07-10 at 10:05 -0400, Tom Smith wrote:

> Hello,
> 
> I'm stumped by the case below.  I had assumed the difficulties would
> begin with ambiguities in my grammars, but I'm already stuck with a
> NoViableAltException.
> 
> I need to be able to handle the following cases:
> - a followed by b
> - a only
> - b only
> 
> My initial parser works OK on all three types of input, but my tree
> parser yields a NoViableAltException when presented with the third
> case.  That is surprising to me since the alternatives have the same
> form in both parsers.
> 
> Suggestions welcome!


AS you are new to ANTLR, I strongly suggest that you do not use quoted
strings in the parser, but create real rules for the lexer. This will
avoid confusion between your literal strings and where the tokens are
coming from etc. You are probably experimenting with tree rewrite rules,
but you don't need them in this case as you are not shaping the tree.
Then, while ANTLR will generally work things out for you, you should
really factor all your parser rules for common sequences, then rewrite
the token stream with different root nodes if you need to distinguish
between combinations. This will generally give you the most streamlined
parser and an AST with no ambiguities (which is what you want). So:


top
    : BEFORE AFTER?
    | AFTER
    ;

Will work for both parser and tree parser (assuming that this was in
fact your entire grammar) Your lexer is then:

BEFORE  : 'before'    ;
AFTER   : 'after'     ;
?WS      : (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;} ;

If you have not already done so, and can afford it, I suggest you buy
the ANTLR 3 book as it has a lot of good information. Stealing pieces of
grammar from the examples is also a good strategy.

Jim

> Thanks,
> Tom.
> ===
> grammar Test;
> 
> options {
>     output = AST;
> }
> 
> top
>     :    before after
>     ->  before after
>     |    before
>     ->  before
>     |    after
>     ->  after
>     ;
> 
> before
>     :    'before'
>     ;
>     
> after
>     :    'after'
>     ;
>     
> WS
>     :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>     ;
> 
> ===
> tree grammar TestTree;
> 
> options {
>     ASTLabelType = CommonTree;
> }
> 
> top
>     :    before after
>     |    before
>     |    after
>     ;
> 
> before
>     :    'before'
>     ;
>     
> after
>     :    'after'
>     ;
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/e5f26f89/attachment.html 

From yotommy at gmail.com  Thu Jul 10 09:40:53 2008
From: yotommy at gmail.com (Tom Smith)
Date: Thu, 10 Jul 2008 12:40:53 -0400
Subject: [antlr-interest] NoViableAltException in tree grammar
In-Reply-To: <1215704494.8615.54.camel@jimi>
References: <82dc0d190807100705u5da857e5hba7e45e344afbf55@mail.gmail.com>
	<1215704494.8615.54.camel@jimi>
Message-ID: <82dc0d190807100940x232953adn5bac23dca3c33a98@mail.gmail.com>

Jim:

Thanks for the helpful and speedy response.  By trying to craft the simplest
grammar I could that would replicate the problem I am having in a much
larger grammar, I made the (poor) choice to eliminate most of the lexer
rules.  As you point out, that was ill-advised.  I revised the grammar in my
example to include the lexer rules, but without changing the top rule, and
the problem disappeared.  (See below.)

Now I have to go back to my larger grammar and see if I can craft a more
representative test case to help me diagnose the NoViableAltException.
Also: I own and use the ANTLR 3 book, and also use ANTLRworks (though I am
sure not to full advantage). =;^)

Thanks,
Tom.

grammar Test;

options {
    output = AST;
}

top
    :    before after
    |    before
    |    after
    ;

before
    :    BEFORE
    ;

after
    :    AFTER
    ;

BEFORE
    :    'before'
    ;

AFTER
    :    'after'
    ;

WS
    :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
    ;


On Thu, Jul 10, 2008 at 11:41 AM, Jim Idle <jimi at temporal-wave.com> wrote:

>  On Thu, 2008-07-10 at 10:05 -0400, Tom Smith wrote:
>
> Hello,
>
> I'm stumped by the case below.  I had assumed the difficulties would begin
> with ambiguities in my grammars, but I'm already stuck with a
> NoViableAltException.
>
> I need to be able to handle the following cases:
> - a followed by b
> - a only
> - b only
>
> My initial parser works OK on all three types of input, but my tree parser
> yields a NoViableAltException when presented with the third case.  That is
> surprising to me since the alternatives have the same form in both parsers.
>
> Suggestions welcome!
>
>
> AS you are new to ANTLR, I strongly suggest that you do not use quoted
> strings in the parser, but create real rules for the lexer. This will avoid
> confusion between your literal strings and where the tokens are coming from
> etc. You are probably experimenting with tree rewrite rules, but you don't
> need them in this case as you are not shaping the tree. Then, while ANTLR
> will generally work things out for you, you should really factor all your
> parser rules for common sequences, then rewrite the token stream with
> different root nodes if you need to distinguish between combinations. This
> will generally give you the most streamlined parser and an AST with no
> ambiguities (which is what you want). So:
>
>
> top
>     : BEFORE AFTER?
>     | AFTER
>     ;
>
> Will work for both parser and tree parser (assuming that this was in fact
> your entire grammar) Your lexer is then:
>
> BEFORE  : 'before'    ;
> AFTER   : 'after'     ;
> ?WS      : (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;} ;
>
> If you have not already done so, and can afford it, I suggest you buy the
> ANTLR 3 book as it has a lot of good information. Stealing pieces of grammar
> from the examples is also a good strategy.
>
> Jim
>
>  Thanks,
> Tom.
> ===
> grammar Test;
>
> options {
>     output = AST;
> }
>
> top
>     :    before after
>     ->  before after
>     |    before
>     ->  before
>     |    after
>     ->  after
>     ;
>
> before
>     :    'before'
>     ;
>
> after
>     :    'after'
>     ;
>
> WS
>     :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>     ;
>
> ===
> tree grammar TestTree;
>
> options {
>     ASTLabelType = CommonTree;
> }
>
> top
>     :    before after
>     |    before
>     |    after
>     ;
>
> before
>     :    'before'
>     ;
>
> after
>     :    'after'
>     ;
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/1133af51/attachment-0001.html 

From yotommy at gmail.com  Thu Jul 10 10:01:47 2008
From: yotommy at gmail.com (Tom Smith)
Date: Thu, 10 Jul 2008 13:01:47 -0400
Subject: [antlr-interest] NoViableAltException in tree grammar
In-Reply-To: <1215704494.8615.54.camel@jimi>
References: <82dc0d190807100705u5da857e5hba7e45e344afbf55@mail.gmail.com>
	<1215704494.8615.54.camel@jimi>
Message-ID: <82dc0d190807101001l553df392u20b664bc95b2d6b3@mail.gmail.com>

On Thu, Jul 10, 2008 at 11:41 AM, Jim Idle <jimi at temporal-wave.com> wrote:

> ... Then, while ANTLR will generally work things out for you, you should
> really factor all your parser rules for common sequences, then rewrite the
> token stream with different root nodes if you need to distinguish between
> combinations. This will generally give you the most streamlined parser and
> an AST with no ambiguities (which is what you want). So:
>
>
> top
>     : BEFORE AFTER?
>     | AFTER
>     ;
>

After going back to my original (larger) grammar (complete with lexer
rules!) and factoring out the common part as Jim suggested, the
NoViableAltException went away. I don't yet understand why, but until my
understanding matures, I'll check for left-factoring opportunities when I
run into problems!

Thanks,
Tom.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/74cc45e2/attachment.html 

From rdclark at gmail.com  Thu Jul 10 10:11:04 2008
From: rdclark at gmail.com (Richard Clark)
Date: Thu, 10 Jul 2008 10:11:04 -0700
Subject: [antlr-interest] [newbie] Precedence of rules
In-Reply-To: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
References: <e60f3a6e0807080834g671b9c3end44ecba515dc5d2a@mail.gmail.com>
Message-ID: <d3992d900807101011h56ba3ebdica2ea747eff4facb@mail.gmail.com>

On Tue, Jul 8, 2008 at 8:34 AM, Robert Munteanu
<robert.munteanu at gmail.com> wrote:

> COMMA : ',';
> STRING : ('a'..'z'|'A'..'Z')+;
> STRING_WITH_COMMA : STRING (COMMA STRING)+ ;

In the Lexer, the first rule that matches wins. So "hello, world"
matches STRING, COMMA, STRING (3 tokens). If you wanted
STRING_COMMA_STRING to come out as a single token, you would have to
list it first.

Alternately, you could change the name to lowercase to make it a
parser rule (as suggested).

My rule of thumb is to keep the lexer rules simple and move sequences
such as "STRING (COMMA STRING)*" into the parser.

...Richard

From parrt at cs.usfca.edu  Thu Jul 10 11:16:07 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 10 Jul 2008 11:16:07 -0700
Subject: [antlr-interest] found more bugs in ANTLRv3.g + howto add
	separator when parallel iterating 2 lists in stringtemplate
In-Reply-To: <53c4e43f0807100204pe0fea5aj7d3b2f84469c3078@mail.gmail.com>
References: <53c4e43f0807070244he1e6f6apa696a45bf219a5c4@mail.gmail.com>
	<FE1C8C81-74D6-41C7-8812-BEB8E638EB25@cs.usfca.edu>
	<4872895F.9010109@gmail.com>
	<070AA3E1-4014-4F7A-B685-2295EB104BAD@cs.usfca.edu>
	<53c4e43f0807080132v30975b98ja2e78f9f486383c1@mail.gmail.com>
	<53c4e43f0807080233q1e08ecfbj7d5914568d948688@mail.gmail.com>
	<00C87112-F31C-423D-BD3A-BA1E71AAC058@cs.usfca.edu>
	<53c4e43f0807100204pe0fea5aj7d3b2f84469c3078@mail.gmail.com>
Message-ID: <126F1089-F741-48AD-9A70-E19161FBF426@cs.usfca.edu>

ah! you're right...ok, removing.
Ter
On Jul 10, 2008, at 2:04 AM, Jens Boeykens wrote:

>
>
> 2008/7/8 Terence Parr <parrt at cs.usfca.edu>:
>
> On Jul 8, 2008, at 2:33 AM, Jens Boeykens wrote:
>
> Another detail for rule rewrite_tree_atom that I am not sure if it  
> is correct:
>
> In ANTLRv3.g :               ^(TOKEN_REF ARG_ACTION?)
> In ANTLRv3Tree.g:         ^(TOKEN_REF ARG_ACTION)
>
> The question mark dissapeared.  I added  it  in my code, but  not  
> sure if it is necessary...
>
> Nope. not needed.  alt above takes care of it:
>
>        |   TOKEN_REF
>        |   ^(TOKEN_REF ARG_ACTION) // for imaginary nodes
>
>
> Another thing I did not understand very well (probably my own  
> fault ;) ) :
> There is a rule called "rewrite_template_block" which is defined,  
> but no other rule seems to be using it. Does this make the rule  
> obsolete? I noticed this because I have not yet encountered a  
> testcase where the rule was used, so I am not sure wether I should  
> write more tests or the rule is indeed obsolete.
>
>
> Used by rewrite_tree_element and ebnf.
> Ter
>
> Hmm if I do a search for "rewrite_template_block" in the files on  
> the site, it is found only once. Thus it is not used in  
> rewrite_tree_element and ebnf. Is it possible that you have  
> considered "rewrite_tree_block" instead of "rewrite_template_block"?
>
> Now a rule like: "r : a -> (template() <<this is a temp>>);" doesn't  
> parse because of the parentheses around template. I assume  
> "rewrite_template_block" was defined for this case, but since it is  
> never used...
>
> Greetz,
> Jens
>
>


From parrt at cs.usfca.edu  Thu Jul 10 11:19:17 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 10 Jul 2008 11:19:17 -0700
Subject: [antlr-interest] error in antlrv3tree.g: rule ebnf
In-Reply-To: <53c4e43f0807100153k6de24899u8731c1e17912c97a@mail.gmail.com>
References: <53c4e43f0807100153k6de24899u8731c1e17912c97a@mail.gmail.com>
Message-ID: <2B9C7633-88F5-45BF-988C-DA61F6802A9C@cs.usfca.edu>

Actually those don't make sense anymore...removing from v3.g
Thanks,
Ter
On Jul 10, 2008, at 1:53 AM, Jens Boeykens wrote:

> Hello,
>
> rule ebnf is missing two alternatives: ^(o='^' block) and ^(o='!'  
> block). These are defined in ebnf in ANTLRv3.g but nog 'caught' in  
> ANTLRv3Tree.g
> I've added them in my local version and now it works.
>
> ebnf
>   : ^(SYNPRED block) -> ebnf_synpred(synpred={$SYNPRED},  
> block={$block.st})
>   | ^(SYN_SEMPRED block) ->  
> ebnf_synSempred(syn_sempred={$SYN_SEMPRED}, block={$block.st})
>   | ^(ebnfSuffix block) -> ebnf_ebnfSuffixblock (ebnfSuffix  
> ={$ebnfSuffix.st}, block = {$block.st})
>   | ^(o='^' block) -> ebnf_treeblock(op={$o},block = {$block.st})
>   | ^(o='!' block) -> ebnf_treeblock(op={$o},block = {$block.st})
>   | block -> ebnf_block(block = {$block.st})
>   ;
>
> Greetz,
> Jens


From belayda at gmail.com  Thu Jul 10 13:44:00 2008
From: belayda at gmail.com (Bernardo Elayda)
Date: Thu, 10 Jul 2008 13:44:00 -0700
Subject: [antlr-interest] ast rewrite
Message-ID: <3e5ed32f0807101344o45075da2m4a93435c552d1028@mail.gmail.com>

importDeclaration
    :   'import' qualifiedName ('.' '*')? ';'
    -> ^('import' qualifiedName ('.' '*')? ';')
    ;

Hi!

Did you find a solution to your problem?  I suspect that one possible
solution may reside in the qualifiedName rule.
Make sure that it doesn't return a tree.  Another solution might
involve redoing the importDeclaration rule in your original
grammar that makes the AST.

In your grammar that defines importDeclaration as two rules:

tempRule : '.' '*' ;

importDeclaratrion : ('import' qualifiedName '.')=> 'import'
qualifiedName tempRule+ ';'
                     -> ^('import' qualifiedName tempRule+ ';')
                     | 'import' qualifiedName ';' -> ^('import'
qualifiedName ';')

You can then follow each branch with the tree you want.

hth,
Bernardo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080710/7621b257/attachment.html 

From asoka250 at gmail.com  Thu Jul 10 23:49:01 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Fri, 11 Jul 2008 01:49:01 -0500
Subject: [antlr-interest] query in tree grammar - regd.
Message-ID: <7b0a1e4b0807102349i1f7b838atcab395ae6c3840fc@mail.gmail.com>

Hello,

I am trying to migrate a 2.7.7 antlr tree grammar to 3.0.1. I ended up with
error in the following rule :-

node_edge_subgraph_stmt
    : edges
    | subgraph
    | node_id
    |! { boolean record = false; } ^(LBR n=node_id record = l:a_list_node )
        {
            if(record) {
                #node_edge_subgraph_stmt = #([RBR,"]"], n, l);
             }
            else{
                    #node_edge_subgraph_stmt = #([LBR], n, l);
             }

        }
    ;

Antlrworks doesn't recognize l in record = l:a_list_node. How to convert
this assignment statement to the latest syntax. Thank you. The whole tree
grammar is attached for reference.

-- 
Ashok R Varikuti
Graduate Research Assistant
CIS Dept, Kansas State University
785-304-2401.
ashokv at ksu.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/62535ecc/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DOTTreeTransformer.g
Type: application/octet-stream
Size: 1999 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/62535ecc/attachment.obj 

From atlan at gmx.li  Thu Jul 10 23:52:32 2008
From: atlan at gmx.li (Marc Bischof)
Date: Fri, 11 Jul 2008 08:52:32 +0200
Subject: [antlr-interest] similar constructs using '['  ']'
Message-ID: <200807110852.32403.atlan@gmx.li>

Hej List,

I'am confused about the following, may be you can give me a hint.

I have two similar constructs using '['  ']'.
One which represents an extended expression (using nongreedy wildcard) and one 
which contain some other stuff.

Now every time I want to use the sequence rule the EXT_EXPR is invoked.
Is it possible to keep that modelling?

sequence 
	:	('[' j+=join? s+=signal* ']')? b=body  ;

join
	:	'join' '(' k+=ID (',' k+=ID)* (',' expr)? ')' -> ^(JOIN $k+ expr?);

expr	
	:	s_expr | EXT_EXPR | funct_call;

EXT_EXPR
	:	'[' (options {greedy=false;} : .)* ']';

Cheers Marc

From r_reitzi at cs.uni-kl.de  Fri Jul 11 00:32:51 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Fri, 11 Jul 2008 09:32:51 +0200
Subject: [antlr-interest] similar constructs using '['  ']'
In-Reply-To: <200807110852.32403.atlan@gmx.li>
References: <200807110852.32403.atlan@gmx.li>
Message-ID: <c1501eb0ff5617dedc13628bbbe2e64b@mail.frhk.de>

Hi Marc!

EXT_EXPR is a lexer rule while sequence is a parser rule. Since lexer
output serves as parser input, lexer has to process your input first.
There, your rule EXT_EXPR will match anything with [, ] arouund it. Then,
your parser will receive an EXT_EXPR token, no arbitrary string. That is,
if I got ANTLR way of parsing right ;)

Greets

List.Raphael

On Fri, 11 Jul 2008 08:52:32 +0200, Marc Bischof <atlan at gmx.li> wrote:
> Hej List,
> 
> I'am confused about the following, may be you can give me a hint.
> 
> I have two similar constructs using '['  ']'.
> One which represents an extended expression (using nongreedy wildcard)
and
> one
> which contain some other stuff.
> 
> Now every time I want to use the sequence rule the EXT_EXPR is invoked.
> Is it possible to keep that modelling?
> 
> sequence
> 	:	('[' j+=join? s+=signal* ']')? b=body  ;
> 
> join
> 	:	'join' '(' k+=ID (',' k+=ID)* (',' expr)? ')' -> ^(JOIN $k+ expr?);
> 
> expr
> 	:	s_expr | EXT_EXPR | funct_call;
> 
> EXT_EXPR
> 	:	'[' (options {greedy=false;} : .)* ']';
> 
> Cheers Marc


From jens.boeykens at gmail.com  Fri Jul 11 00:33:15 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Fri, 11 Jul 2008 09:33:15 +0200
Subject: [antlr-interest] Converting Tree operands ('^' '!') to rewrite
	rules ( '-> ^(...)')
Message-ID: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>

Hello,

I'm a student in computer science and for the moment I'm doing internship
in a  company (Sigasi <http://www.sigasi.com/>) mainly working on hardware
refactoring.
So far, I have written a program which can read a .g grammar as input, parse
it into a tree and automatically regenerate the grammar by using a
stringtemplate I have written. This regeneration allows some useful things.
e.g. I have written something to sort the rules alphabetically using the
trees, and then  regenerate the  grammar from the tree resulting in a
grammar with sorted rules.

The next step is to convert tree operands to rewrite rules. Eg.

*rule : a b^ c d^ e;*
will be automatically converted to*
rule: a b c d e -> ^(d  ^(b a c) e);*

My question is: does there already exists something that I could reuse (and
where to find it) or can you give me some tips to achieve this? The
convertion will probably be done on the trees which are created with my
(slightly modified) ANTLRv3.g. Thus for the previous example:

*(RULE rule (BLOCK (ALT a (^ b) c (^ d) e EOA) EOB) EOR) *
needs to be converted somehow to
*(RULE rule (BLOCK (ALT a b c d e EOA) (-> (ALT (TREE_BEGIN d (TREE_BEGIN b
a c) e) EOA)) EOB) EOR)*

My regenerator will then read in the second tree and thus generate a grammar
with a tree rewrite rule.
The conversion itself is not very simple so any  help is appreciated.
Difficulties are rules with alternatives which have complex trees:
*rule : (a^ | b^) c ;*

Am I correct that rules like *rule : (a b)^ c ;   *and* **rule : (a b)! c ;
*are no longer allowed? It parses but doesn't really make sense in my
oppinion.

So why would I want to do all this? Well with the rewrite rules it is easier
to create the tree walker from a parser. This is the final goal: when you
have written a parser grammar for a language, you can give it to my tool,
and it will automatically generate a tree grammar from it. Thus no need to
do it manually or to create 2 grammars.

Best regards,
Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/ce338b5f/attachment.html 

From coddbotherer at googlemail.com  Fri Jul 11 00:56:54 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Fri, 11 Jul 2008 08:56:54 +0100
Subject: [antlr-interest] Unresolved externals building C executable
Message-ID: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>

I spent much of yesterday afternoon teasing out the C examples;
hassling with MS Visual Studio registration; building the ANTLR
libraries for my target machine, and just generally rediscovering why
I had started out using Java for this project--but I digress.

I'm getting a load of missing externals when I try to link my little
"hello antlr" program:

Microsoft (R) Incremental Linker Version 9.00.21022.08
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:GrantLexer.exe
/NODEFAULTLIB:MSVCRT
/LTCG
GrantLexer.obj
GrantParser.obj
Test.obj
C:\antlr-3.0.1\runtime\C\Release\antlr3c.lib
   Creating library GrantLexer.lib and object GrantLexer.exp
Test.obj : error LNK2001: unresolved external symbol _ANTLR3_FPRINTF
antlr3c.lib(antlr3lexer.obj) : error LNK2001: unresolved external
symbol __imp__fprintf
antlr3c.lib(antlr3filestream.obj) : error LNK2001: unresolved external
symbol __imp__fopen
antlr3c.lib(antlr3filestream.obj) : error LNK2001: unresolved external
symbol __imp__fread
antlr3c.lib(antlr3filestream.obj) : error LNK2001: unresolved external
symbol __imp___stat64i32
antlr3c.lib(antlr3inputstream.obj) : error LNK2001: unresolved
external symbol __imp__toupper
antlr3c.lib(antlr3exception.obj) : error LNK2001: unresolved external
symbol __imp__printf
antlr3c.lib(antlr3string.obj) : error LNK2001: unresolved external
symbol __imp__sprintf
GrantLexer.exe : fatal error LNK1120: 8 unresolved externals

Where should I be looking?

Art

From antlr at mirality.co.nz  Fri Jul 11 01:00:21 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 11 Jul 2008 20:00:21 +1200
Subject: [antlr-interest] query in tree grammar - regd.
In-Reply-To: <7b0a1e4b0807102349i1f7b838atcab395ae6c3840fc@mail.gmail.co
 m>
References: <7b0a1e4b0807102349i1f7b838atcab395ae6c3840fc@mail.gmail.com>
Message-ID: <20080711080028.BA8243522A0@www.antlr.org>

At 18:49 11/07/2008, ASHOK REDDY wrote:
>     |! { boolean record = false; } ^(LBR n=node_id record = 
> l:a_list_node )
>         {
>             if(record) {
>                 #node_edge_subgraph_stmt = #([RBR,"]"], n, l);
>              }
>             else{
>                     #node_edge_subgraph_stmt = #([LBR], n, l);
>              }
[...]
>Antlrworks doesn't recognize l in record = l:a_list_node. How to 
>convert this assignment statement to the latest syntax. Thank 
>you. The whole tree grammar is attached for reference.

Have you tried using the semi-automatic v2 -> v3 conversion 
utility?

To answer your specific question, ANTLR v3 uses '=' instead of ':' 
for labels now, so swap that over and it should fix that.  But 
there are other problems there too -- the |! syntax isn't 
recognised AFAIK (what does that even do?), and the #s seem wrong 
as well.


From antlr at mirality.co.nz  Fri Jul 11 01:58:00 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 11 Jul 2008 20:58:00 +1200
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.co
 m>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
Message-ID: <20080711085808.9FEAB11ED9B@www.antlr.org>

At 19:56 11/07/2008, Artemus Ward wrote:
 >I spent much of yesterday afternoon teasing out the C examples;
 >hassling with MS Visual Studio registration; building the ANTLR
 >libraries for my target machine, and just generally 
rediscovering
 >why I had started out using Java for this project--but I 
digress.
 >
 >I'm getting a load of missing externals when I try to link my
 >little "hello antlr" program:
[...]
 >/NODEFAULTLIB:MSVCRT
[...]
 >C:\antlr-3.0.1\runtime\C\Release\antlr3c.lib
 >   Creating library GrantLexer.lib and object GrantLexer.exp
 >Test.obj : error LNK2001: unresolved external symbol
 >_ANTLR3_FPRINTF
 >antlr3c.lib(antlr3lexer.obj) : error LNK2001: unresolved 
external
 >symbol __imp__fprintf
 >antlr3c.lib(antlr3filestream.obj) : error LNK2001: unresolved
 >external

Well, it looks like you've compiled the ANTLR library with 
settings expecting the CRT to be loaded as a DLL, and then refused 
to link your application against the CRT import library.


From jens.boeykens at gmail.com  Fri Jul 11 02:34:03 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Fri, 11 Jul 2008 11:34:03 +0200
Subject: [antlr-interest] Converting Tree operands ('^' '!') to rewrite
	rules ( '-> ^(...)')
In-Reply-To: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>
References: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>
Message-ID: <53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.com>

Bounced on a problem:

What should be the rewrite rule for this operand rule:
*rule   :    id ('+'^ id)*;

*I can't even find one. Tried several things, and I assume you are forced to
use recursion, or are there other (as simple as possible) ways?

*rule :  id | (id '+' rule) -> ^('+' id rule);
**rule :  | id rule | ('+' id rule);

*But these rules don't parse because the first alternative is unreachable in
both cases. I don't understand why though... id doesn't have an empty
alternative or a '+'.

Jens

2008/7/11 Jens Boeykens <jens.boeykens at gmail.com>:

> Hello,
>
> I'm a student in computer science and for the moment I'm doing internship
> in a  company (Sigasi <http://www.sigasi.com/>) mainly working on hardware
> refactoring.
> So far, I have written a program which can read a .g grammar as input,
> parse it into a tree and automatically regenerate the grammar by using a
> stringtemplate I have written. This regeneration allows some useful things.
> e.g. I have written something to sort the rules alphabetically using the
> trees, and then  regenerate the  grammar from the tree resulting in a
> grammar with sorted rules.
>
> The next step is to convert tree operands to rewrite rules. Eg.
>
> *rule : a b^ c d^ e;*
> will be automatically converted to*
> rule: a b c d e -> ^(d  ^(b a c) e);*
>
> My question is: does there already exists something that I could reuse (and
> where to find it) or can you give me some tips to achieve this? The
> convertion will probably be done on the trees which are created with my
> (slightly modified) ANTLRv3.g. Thus for the previous example:
>
> *(RULE rule (BLOCK (ALT a (^ b) c (^ d) e EOA) EOB) EOR) *
> needs to be converted somehow to
> *(RULE rule (BLOCK (ALT a b c d e EOA) (-> (ALT (TREE_BEGIN d (TREE_BEGIN
> b a c) e) EOA)) EOB) EOR)*
>
> My regenerator will then read in the second tree and thus generate a
> grammar with a tree rewrite rule.
> The conversion itself is not very simple so any  help is appreciated.
> Difficulties are rules with alternatives which have complex trees:
> *rule : (a^ | b^) c ;*
>
> Am I correct that rules like *rule : (a b)^ c ;   *and* **rule : (a b)! c
> ; *are no longer allowed? It parses but doesn't really make sense in my
> oppinion.
>
> So why would I want to do all this? Well with the rewrite rules it is
> easier to create the tree walker from a parser. This is the final goal: when
> you have written a parser grammar for a language, you can give it to my
> tool, and it will automatically generate a tree grammar from it. Thus no
> need to do it manually or to create 2 grammars.
>
> Best regards,
> Jens
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/8dedbe2b/attachment.html 

From coddbotherer at googlemail.com  Fri Jul 11 02:37:48 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Fri, 11 Jul 2008 10:37:48 +0100
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
Message-ID: <157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.com>

2008/7/11 Gavin Lambert <antlr at mirality.co.nz>:
> At 19:56 11/07/2008, Artemus Ward wrote:
>>I spent much of yesterday afternoon teasing out the C examples;
>>hassling with MS Visual Studio registration; building the ANTLR
>>libraries for my target machine, and just generally rediscovering
>>why I had started out using Java for this project--but I digress.
>>
>>I'm getting a load of missing externals when I try to link my
>>little "hello antlr" program:
> [...]
>>/NODEFAULTLIB:MSVCRT
> [...]
>>C:\antlr-3.0.1\runtime\C\Release\antlr3c.lib
>>   Creating library GrantLexer.lib and object GrantLexer.exp
>>Test.obj : error LNK2001: unresolved external symbol
>>_ANTLR3_FPRINTF
>>antlr3c.lib(antlr3lexer.obj) : error LNK2001: unresolved external
>>symbol __imp__fprintf
>>antlr3c.lib(antlr3filestream.obj) : error LNK2001: unresolved
>>external
>
> Well, it looks like you've compiled the ANTLR library with settings
> expecting the CRT to be loaded as a DLL, and then refused to link your
> application against the CRT import library.

If I don't use /NODEFAULTLIB:MSVCRT then I get these errors instead:

Microsoft (R) Incremental Linker Version 9.00.21022.08
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:GrantLexer.exe
/LTCG
GrantLexer.obj
GrantParser.obj
Test.obj
C:\antlr-3.0.1\runtime\C\Release\antlr3c.lib
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _free already defined in
LIBCMT.lib(free.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _calloc already defined in
LIBCMT.lib(calloc.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: ___iob_func already defined
in LIBCMT.lib(_file.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _isprint already defined in
LIBCMT.lib(_ctype.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _memmove already defined in
LIBCMT.lib(memmove.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _fclose already defined in
LIBCMT.lib(fclose.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _realloc already defined in
LIBCMT.lib(realloc.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _atoi already defined in
LIBCMT.lib(atox.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: _isdigit already defined in
LIBCMT.lib(_ctype.obj)
MSVCRT.lib(MSVCR90.dll) : error LNK2005: __strdup already defined in
LIBCMT.lib(strdup.obj)
   Creating library GrantLexer.lib and object GrantLexer.exp
LINK : warning LNK4098: defaultlib 'MSVCRT' conflicts with use of
other libs; use /NODEFAULTLIB:library
Test.obj : error LNK2001: unresolved external symbol _ANTLR3_FPRINTF
GrantLexer.exe : fatal error LNK1120: 1 unresolved externals

Art

From jaluber at gmx.de  Fri Jul 11 03:05:26 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 11 Jul 2008 12:05:26 +0200
Subject: [antlr-interest] Converting Tree operands ('^' '!') to rewrite
 rules ( '-> ^(...)')
In-Reply-To: <53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.com>
References: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>
	<53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.com>
Message-ID: <48773066.1060007@gmx.de>

Jens Boeykens schrieb:
> Bounced on a problem:
> 
> What should be the rewrite rule for this operand rule:
> rule   :    id ('+'^ id)*;

Try this:

rule : (i1=id -> $i1) ( '+' i2=id -> ^('+' $rule $i2))*;

BTW, is your tool to create tree grammars slated to become open source?

Johannes
> 
> I can't even find one. Tried several things, and I assume you are 
> forced to use recursion, or are there other (as simple as possible) ways?
> 
> rule :  id | (id '+' rule) -> ^('+' id rule);
> rule :  | id rule | ('+' id rule);
> 
> But these rules don't parse because the first alternative is 
> unreachable in both cases. I don't understand why though... id doesn't 
> have an empty alternative or a '+'.
> 
> Jens
> 
> 2008/7/11 Jens Boeykens <jens.boeykens at gmail.com 
> <mailto:jens.boeykens at gmail.com>>:
> 
>     Hello,
> 
>     I'm a student in computer science and for the moment I'm doing
>     internship  in a  company (Sigasi <http://www.sigasi.com/>) mainly
>     working on hardware refactoring.
>     So far, I have written a program which can read a .g grammar as
>     input, parse it into a tree and automatically regenerate the grammar
>     by using a stringtemplate I have written. This regeneration allows
>     some useful things. e.g. I have written something to sort the rules
>     alphabetically using the  trees, and then  regenerate the  grammar
>     from the tree resulting in a grammar with sorted rules.
> 
>     The next step is to convert tree operands to rewrite rules. Eg.
> 
>     /rule : a b^ c d^ e;/  
>     will be automatically converted to/
>     rule: a b c d e -> ^(d  ^(b a c) e);/
> 
>     My question is: does there already exists something that I could
>     reuse (and where to find it) or can you give me some tips to achieve
>     this? The convertion will probably be done on the trees which are
>     created with my (slightly modified) ANTLRv3.g. Thus for the previous
>     example:
> 
>     /(RULE rule (BLOCK (ALT a (^ b) c (^ d) e EOA) EOB) EOR) /
>     needs to be converted somehow to
>     /(RULE rule (BLOCK (ALT a b c d e EOA) (-> (ALT (TREE_BEGIN d
>     (TREE_BEGIN b a c) e) EOA)) EOB) EOR)/
> 
>     My regenerator will then read in the second tree and thus generate a
>     grammar with a tree rewrite rule.
>     The conversion itself is not very simple so any  help is appreciated.
>     Difficulties are rules with alternatives which have complex trees:
>     /rule : (a^ | b^) c ;/
> 
>     Am I correct that rules like /rule : (a b)^ c ;   /and/ //rule : (a
>     b)! c ; /are no longer allowed? It parses but doesn't really make
>     sense in my oppinion.
> 
>     So why would I want to do all this? Well with the rewrite rules it
>     is easier to create the tree walker from a parser. This is the final
>     goal: when you have written a parser grammar for a language, you can
>     give it to my tool, and it will automatically generate a tree
>     grammar from it. Thus no need to do it manually or to create 2 grammars.
> 
>     Best regards,
>     Jens
> 
> 


From antlr at mirality.co.nz  Fri Jul 11 03:06:30 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 11 Jul 2008 22:06:30 +1200
Subject: [antlr-interest] Converting Tree operands ('^' '!') to rewrite
 rules ( '-> ^(...)')
In-Reply-To: <53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.co
 m>
References: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>
	<53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.com>
Message-ID: <20080711100641.8752411ECE2@www.antlr.org>

At 21:34 11/07/2008, Jens Boeykens wrote:
>Bounced on a problem:
>
>What should be the rewrite rule for this operand rule:
>rule   :    id ('+'^ id)*;

IIRC:

rule
   :  (a=id -> $a)
      ('+' b=id -> ^('+' $rule $b))*
   ;


From antlr at mirality.co.nz  Fri Jul 11 03:08:29 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 11 Jul 2008 22:08:29 +1200
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.co
 m>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
	<157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.com>
Message-ID: <20080711100835.D047E11ED10@www.antlr.org>

At 21:37 11/07/2008, Artemus Ward wrote:
 >If I don't use /NODEFAULTLIB:MSVCRT then I get these errors
 >instead:
[...]
 >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _free already defined 
in
 >LIBCMT.lib(free.obj)
 >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _calloc already defined 

 >in LIBCMT.lib(calloc.obj)

Which means that you've probably set the ANTLR library to use the 
CRT DLL and the application to use the CRT statically.  They must 
agree with each other exactly if you're going to statically link 
them.


From jens.boeykens at gmail.com  Fri Jul 11 04:15:30 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Fri, 11 Jul 2008 13:15:30 +0200
Subject: [antlr-interest] Converting Tree operands ('^' '!') to rewrite
	rules ( '-> ^(...)')
In-Reply-To: <487730b2.39e9220a.4c9b.086dSMTPIN_ADDED@mx.google.com>
References: <53c4e43f0807110033hd87dcb5xe697c0623d50a940@mail.gmail.com>
	<53c4e43f0807110234i364780fbjed7eff82144a6745@mail.gmail.com>
	<487730b2.39e9220a.4c9b.086dSMTPIN_ADDED@mx.google.com>
Message-ID: <53c4e43f0807110415u6e664173ua0800a71d286321a@mail.gmail.com>

Thanks Johannes and Gavin. It works and it seems to me that it can even be
simplified to this:

rule : (id -> id) ( '+' id -> ^('+' $rule id))*;

Correct me if I'm wrong. The simpler the rewrite the easier it is to
reconstruct...

Oh and an anwser to Johannes' question: I will work on the tool until the
end of July and then it will probably be released under BSD license (like
ANTLR). We don't know yet how to donate it to the community (sourceforge
project, via ANTLR website if it is approved and allowed, a simple archive
through the mailing list, ...).

Jens

2008/7/11 Gavin Lambert <antlr at mirality.co.nz>:

> At 21:34 11/07/2008, Jens Boeykens wrote:
>
>> Bounced on a problem:
>>
>> What should be the rewrite rule for this operand rule:
>> rule   :    id ('+'^ id)*;
>>
>
> IIRC:
>
> rule
>  :  (a=id -> $a)
>     ('+' b=id -> ^('+' $rule $b))*
>  ;
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/6adc2d0f/attachment.html 

From sunshine at public.kherson.ua  Fri Jul 11 04:58:07 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Fri, 11 Jul 2008 14:58:07 +0300
Subject: [antlr-interest] Help on /*empty command*/     ; ; ; ;
Message-ID: <C49D257F.A002D%sunshine@public.kherson.ua>

Hi All,

I try implement on ANTLR 2.7 the empty command for SQL.
So parser will eat something as

CREATE TABLE T(f1 int);
;
;


Can somebody show quick draft of such rule?

This my attempt not works as expected.


sql
    :  (sql_single)*  EOF
    ;

sql_single
    : sql_staement  (SEMI)?
    | SEMI



-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]




From tautges at engr.wisc.edu  Fri Jul 11 07:39:44 2008
From: tautges at engr.wisc.edu (Tim Tautges)
Date: Fri, 11 Jul 2008 09:39:44 -0500
Subject: [antlr-interest] Inputs for grammar composition
Message-ID: <487770B0.9020007@engr.wisc.edu>

Hi all,
   I'm investigating creating a domain-specific language (for working 
with mesh-based data for scientific computing).  Ideally this language 
would include both domain-specific stuff, as well as pre-packaged sets 
of rules for common sets of operations, e.g. arithmetic or set-theoretic 
expressions.  This looks a lot like what Terrance Parr describes in his 
article on grammar reuse, where in his terms, I'm "cobbling together" my 
domain-specific grammar from these pieces.  So, question is, are there 
any repositories of these small sets of operations?  (I think of them as 
sub-grammars, though this term is used differently in Parr's article.) 
The grammars listed on the ANTLR web site all seem to be much 
higher-level.  I suspect I could find most of what I needed by cutting 
and pasting out of one or more of those, but a finer-grained packaging 
of these sets would be easier (read Parr's article, which IMO describes 
the benefits pretty clearly).

- tim

-- 
================================================================
"You will keep in perfect peace him whose mind is
  steadfast, because he trusts in you."               Isaiah 26:3

             Tim Tautges            Argonne National Laboratory
         (tjtautges at wisc.edu)       (telecommuting from UW-Madison)
         phone: (608) 263-8485      1500 Engineering Dr.
           fax: (608) 263-4499      Madison, WI 53706

From andy at doddington.net  Fri Jul 11 07:48:59 2008
From: andy at doddington.net (Andy Doddington)
Date: Fri, 11 Jul 2008 15:48:59 +0100
Subject: [antlr-interest] Error: "Message ID 100 created but is not present
	in errorMsgIDs"
Message-ID: <487772DB.6020404@doddington.net>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/fd1b3319/attachment.html 

From jaluber at gmx.de  Fri Jul 11 07:53:38 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 11 Jul 2008 16:53:38 +0200
Subject: [antlr-interest] Inputs for grammar composition
In-Reply-To: <487770B0.9020007@engr.wisc.edu>
References: <487770B0.9020007@engr.wisc.edu>
Message-ID: <487773F2.3000307@gmx.de>

Tim Tautges schrieb:
> Hi all,
>   I'm investigating creating a domain-specific language (for working 
> with mesh-based data for scientific computing).  Ideally this language 
> would include both domain-specific stuff, as well as pre-packaged sets 
> of rules for common sets of operations, e.g. arithmetic or set-theoretic 
> expressions.  This looks a lot like what Terrance Parr describes in his 
> article on grammar reuse, where in his terms, I'm "cobbling together" my 
> domain-specific grammar from these pieces.  So, question is, are there 
> any repositories of these small sets of operations?  (I think of them as 
> sub-grammars, though this term is used differently in Parr's article.) 
> The grammars listed on the ANTLR web site all seem to be much 
> higher-level.  I suspect I could find most of what I needed by cutting 
> and pasting out of one or more of those, but a finer-grained packaging 
> of these sets would be easier (read Parr's article, which IMO describes 
> the benefits pretty clearly).
> 
> - tim
> 

The capability you describe is introduced in ANTLR 3.1 which is only in 
beta now. So not many people are actually using this feature yet and 
obviously the people posting grammars didn't. This means that you are 
the first to create/use grammars for the described purpose.

Johannes

From jaluber at gmx.de  Fri Jul 11 07:57:03 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 11 Jul 2008 16:57:03 +0200
Subject: [antlr-interest] Error: "Message ID 100 created but is not
 present in errorMsgIDs"
In-Reply-To: <487772DB.6020404@doddington.net>
References: <487772DB.6020404@doddington.net>
Message-ID: <487774BF.50209@gmx.de>

Andy Doddington schrieb:
> I have written a very simple grammar, that supports single line 
> comments, and a primitive 'DEFINE name' statement.
> 
> Processing this inside AntlrWorks seems to be reasonably OK< e.g. 
> generating the parse tree. However, when I try
> to debug or generate code I get the following error:
> 
>     error(100): 
> U:\Development\NomadSchemaAnalyser\grammar\NomadSchema.g:0:0: syntax 
> error: codegen: <AST>:0:0: unexpected end of subtree
>     error(10):  internal error: 
> org.antlr.tool.Message.toString(Message.java:124): Assertion failed! 
> Message ID 100 created but is not present in errorMsgIDs or warningMsgIDs.
> 
> This looks like an internal Antlr bug - referring to a non-existent 
> 'Message ID 100' am I correct in this supposition? If so,
> when is it due to be fixed; if not, what am I doing wrong?
> 
> My grammar is as given below:
> 
>     grammar TestGrammar;
> 
>     DefList: (CommentLine | Def | WS)*;
> 
>     fragment Def: 'DEFINE' WS Name;   
>     fragment CommentLine:    '!' ~('\n'|'\r')* '\r'? '\n' { $channel =
>     HIDDEN; };
>     fragment Name:    Letter AlphaNum*;
>     fragment AlphaNum:    Letter | Digit;
>     fragment Digit:    '0'..'9';
>     fragment Letter    : 'A'..'Z' | 'a'..'z';
>     fragment WS: ( ' ' | '\t' | '\r' | '\n')+    { $channel = HIDDEN; };
> 
> Thanks,
> 
>     Andy D
> 

There are some bugs indeed - ANTLR doesn't deal correctly with your 
input. Considering your grammar it may have some bugs, too. Try this:

     grammar TestGrammar2;

     defList: (CommentLine | Def | WS)*;

     Def: 'DEFINE' WS Name;
     CommentLine:    '!' ~('\n'|'\r')* '\r'? '\n' { $channel = HIDDEN; };
     fragment Name:    Letter AlphaNum*;
     fragment AlphaNum:    Letter | Digit;
     fragment Digit:    '0'..'9';
     fragment Letter    : 'A'..'Z' | 'a'..'z';
     WS: ( ' ' | '\t' | '\r' | '\n')+    { $channel = HIDDEN; };

I've changed DefList into a parser rule and removed fragment to create 
tokens to scan for.

Johannes

From tilman.walter at gmx.de  Fri Jul 11 08:20:54 2008
From: tilman.walter at gmx.de (tilman walter)
Date: Fri, 11 Jul 2008 17:20:54 +0200
Subject: [antlr-interest] stringtemplate and antlr
Message-ID: <48777A56.9020705@gmx.de>

hi list,

I try to emit text through stringtemplate in a treegrammar.
when not using "rewrite=true" and defining rewrite-rules for all rules I 
get a fairly correct result.

However the output only slightly differs from the input, so I'd like to 
define just rewrite rules for the parts that differ.
Unfortunately Iturning on rewrite=true results in several warnings of 
type: 
    [java] ANTLR Parser Generator  Version 3.1b1 (May 20, 2008)  1989-2008
    [java] warning(153): MyTree.g:287:4: with rewrite=true, alt 1 not 
simple node or obvious tree element; text attribute for rule not 
guaranteed to be              correct

And by trying to run it leads to a java.lang.ClassCastException: 
org.antlr.runtime.CommonTokenStream

Anybody an idea what i am doing wrong?

Is it not possible to only define a template-rule for special parts of 
my grammar or is it restricted to simple grammar-constructs?

Thanks in advance
Tilman


From jimi at temporal-wave.com  Fri Jul 11 09:56:40 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 09:56:40 -0700
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
Message-ID: <1215795400.8615.167.camel@jimi>

On Fri, 2008-07-11 at 08:56 +0100, Artemus Ward wrote:

> I spent much of yesterday afternoon teasing out the C examples;
> hassling with MS Visual Studio registration; building the ANTLR
> libraries for my target machine, and just generally rediscovering why
> I had started out using Java for this project--but I digress.


Mostly, C programmers have the same issues with CLASSPATH, -jar and so
on, none of which were designed to solve these kind of things, but you
get used to it. It's just a matter of having the information stored in
your head ;-) Starting out your question by saying you don't want to use
something generally tends to put off the people that wrote it, but I
understand your frustration, so...

> 
> I'm getting a load of missing externals when I try to link my little
> "hello antlr" program:
> 
> Microsoft (R) Incremental Linker Version 9.00.21022.08
> Copyright (C) Microsoft Corporation.  All rights reserved.
> 
> /out:GrantLexer.exe
> /NODEFAULTLIB:MSVCRT
> /LTCG
> GrantLexer.obj
> GrantParser.obj
> Test.obj
> C:\antlr-3.0.1\runtime\C\Release\antlr3c.lib
>    Creating library GrantLexer.lib and object GrantLexer.exp
> Test.obj : error LNK2001: unresolved external symbol _ANTLR3_FPRINTF
> antlr3c.lib(antlr3lexer.obj) : error LNK2001: unresolved external
> symbol __imp__fprintf


You are linking with the wrong libraries or have set up the project
incorrectly in some way. If you have the examples working, then copy the
settings from there. HOwever:

1) Create a new project and don't change the library settings;
2) Get a test to work;
3) Then add your existing things;
4) You have turned off MSVCRT, which is the C runtime - you won't get
very far without that ;-)

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/6961a3ad/attachment.html 

From jimi at temporal-wave.com  Fri Jul 11 09:59:20 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 09:59:20 -0700
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <20080711100835.D047E11ED10@www.antlr.org>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
	<157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.com>
	<20080711100835.D047E11ED10@www.antlr.org>
Message-ID: <1215795560.8615.170.camel@jimi>

On Fri, 2008-07-11 at 22:08 +1200, Gavin Lambert wrote:

> At 21:37 11/07/2008, Artemus Ward wrote:
>  >If I don't use /NODEFAULTLIB:MSVCRT then I get these errors
>  >instead:
> [...]
>  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _free already defined 
> in
>  >LIBCMT.lib(free.obj)
>  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _calloc already defined 
> 
>  >in LIBCMT.lib(calloc.obj)
> 
> Which means that you've probably set the ANTLR library to use the 
> CRT DLL and the application to use the CRT statically.  They must 
> agree with each other exactly if you're going to statically link 
> them.
> 

There really is not any reason to use the static versions of the
libraries - you should abandon your current MS project and create a new
one. This time don't change the default settings until you know what
they all mean.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/443d008c/attachment.html 

From jimi at temporal-wave.com  Fri Jul 11 10:03:55 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 10:03:55 -0700
Subject: [antlr-interest] Error: "Message ID 100 created but is
	not	present in errorMsgIDs"
In-Reply-To: <487772DB.6020404@doddington.net>
References: <487772DB.6020404@doddington.net>
Message-ID: <1215795835.8615.174.camel@jimi>

On Fri, 2008-07-11 at 15:48 +0100, Andy Doddington wrote:

> I have written a very simple grammar, that supports single line
> comments, and a primitive 'DEFINE name' statement.
> 
> Processing this inside AntlrWorks seems to be reasonably OK< e.g.
> generating the parse tree. However, when I try
> to debug or generate code I get the following error:
> 
>     error(100): U:\Development\NomadSchemaAnalyser\grammar
> \NomadSchema.g:0:0: syntax error: codegen: <AST>:0:0: unexpected end
> of subtree
>     error(10):  internal error:
> org.antlr.tool.Message.toString(Message.java:124): Assertion failed!
> Message ID 100 created but is not present in errorMsgIDs or
> warningMsgIDs. 


The message could be a bit clearer, but you have specified a combined
lexer/parser grammar but all your rules start with UPPER CASE, hence you
have created a "lexer grammar". Parser rules start with lower case
letters, lexer rules start with UpperCase letters. Hence your DefList
should be defList, as per the documentation.

> 
> This looks like an internal Antlr bug - referring to a non-existent
> 'Message ID 100' am I correct in this supposition? If so,
> when is it due to be fixed; if not, what am I doing wrong?
> 
> My grammar is as given below:
> 
>         grammar TestGrammar;
>         
>         DefList: (CommentLine | Def | WS)*;


defList : .... EOF ;


Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/63652bd9/attachment.html 

From lucazd at gmail.com  Fri Jul 11 10:17:19 2008
From: lucazd at gmail.com (Lucaz)
Date: Fri, 11 Jul 2008 14:17:19 -0300
Subject: [antlr-interest] Navigate through the parsed Tree
Message-ID: <8070e9c20807111017y224c7e83ve465651e7fe1fa85@mail.gmail.com>

Hello, I am very new with ANTRL and I would like to try something simple:
I am using ANTRLWork and the Java 1.5 grammar file (
http://www.antlr.org/grammar/1152141644268/Java.g).
My question is; how can I access the parsed tree?.

I tried getTree(), but it returns null. The adapter (getAdapter()) works but
I don't understand what should I pass to its methods (like
getParent(Object)).
(I've checked the docs here ->
http://www.antlr.org/api/Java/interfaceorg_1_1antlr_1_1runtime_1_1tree_1_1_tree_adaptor.html#01954069ab7d2c2eb78d328572110725
)

I tried these options also: output=AST; ASTLabelType=CommonTree;

Thanks a lot for this awesome tool!,
Lucaz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/644f2af6/attachment-0001.html 

From coddbotherer at googlemail.com  Fri Jul 11 10:24:18 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Fri, 11 Jul 2008 18:24:18 +0100
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <1215795400.8615.167.camel@jimi>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<1215795400.8615.167.camel@jimi>
Message-ID: <157c5c5c0807111024h2636b5d2id4895ece56e76939@mail.gmail.com>

2008/7/11 Jim Idle <jimi at temporal-wave.com>:
> On Fri, 2008-07-11 at 08:56 +0100, Artemus Ward wrote:
>
> I spent much of yesterday afternoon teasing out the C examples;
> hassling with MS Visual Studio registration; building the ANTLR
> libraries for my target machine, and just generally rediscovering why
> I had started out using Java for this project--but I digress.
>
> Mostly, C programmers have the same issues with CLASSPATH, -jar and so on,
> none of which were designed to solve these kind of things, but you get used
> to it. It's just a matter of having the information stored in your head ;-)

> Starting out your question by saying you don't want to use something
> generally tends to put off the people that wrote it, but I understand your
> frustration, so...

I expressed myself extremely poorly.  I am a long-time, hard-core C
programmer but with a Unix background.  I merely dabbled with the Java
because it was easy to get started with ANTLR by using it.  I take
your point and will take more care how I express myself.  Still, the
Microsoft way of doing C is presenting me with a whole extra learning
curve.

Art

From coddbotherer at googlemail.com  Fri Jul 11 10:35:38 2008
From: coddbotherer at googlemail.com (Artemus Ward)
Date: Fri, 11 Jul 2008 18:35:38 +0100
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <1215795560.8615.170.camel@jimi>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
	<157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.com>
	<20080711100835.D047E11ED10@www.antlr.org>
	<1215795560.8615.170.camel@jimi>
Message-ID: <157c5c5c0807111035q774f0a6o19f079f5232635b3@mail.gmail.com>

2008/7/11 Jim Idle <jimi at temporal-wave.com>:
> On Fri, 2008-07-11 at 22:08 +1200, Gavin Lambert wrote:
>
> At 21:37 11/07/2008, Artemus Ward wrote:
>  >If I don't use /NODEFAULTLIB:MSVCRT then I get these errors
>  >instead:
> [...]
>  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _free already defined
> in
>  >LIBCMT.lib(free.obj)
>  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _calloc already defined
>
>  >in LIBCMT.lib(calloc.obj)
>
> Which means that you've probably set the ANTLR library to use the
> CRT DLL and the application to use the CRT statically.  They must
> agree with each other exactly if you're going to statically link
> them.
>
> There really is not any reason to use the static versions of the libraries -
> you should abandon your current MS project and create a new one. This time
> don't change the default settings until you know what they all mean.

I didn't start changing them off until the MS compiler and linker
started displaying messages suggesting that was the thing to do.
Clearly one could spend a long time reading the copious documentation,
but one could also seek the advice of those who've done it already.

I shall do as you suggest, although that means I now have to go back
and figure out why I was able to compile the static libraries
successfully but the DLL is somehow corrupt.  I didn't knowingly mess
with any flags when I built it.

Art

From barabucc at cs.unibo.it  Fri Jul 11 10:57:49 2008
From: barabucc at cs.unibo.it (Gioele Barabucci)
Date: Fri, 11 Jul 2008 19:57:49 +0200
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
Message-ID: <g586u7$kpa$1@ger.gmane.org>

This simple grammar

> grammar Tok1;
> 
> stmt:     'id' S id_name S ('#IMP'|'#FIX') EOF; 
> id_name:  '#' NAME;
> 
> NAME: ('A'..'Z')+;
> S: (' '|'\n')+;

parses "id #AAA #FIX" correctly but fails on "id #III #FIX" with a
MismatchedTokenException(5!=9).

I think the exception is raised because as soon as the lexer sees "#I"
(in "#III") it expects the token to be equal to the literal "#IMP".

Is there a way to work around this problem?

-- 
Gioele Barabucci <barabucc at cs.unibo.it>


From jimi at temporal-wave.com  Fri Jul 11 11:37:33 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 11:37:33 -0700
Subject: [antlr-interest] Unresolved externals building C executable
In-Reply-To: <157c5c5c0807111035q774f0a6o19f079f5232635b3@mail.gmail.com>
References: <157c5c5c0807110056g35b3748ah96a7ed2b80c4d7fe@mail.gmail.com>
	<487720a0.40e2220a.26a6.ffffcfecSMTPIN_ADDED@mx.google.com>
	<157c5c5c0807110237x655fc773y2b2033f4d909115c@mail.gmail.com>
	<20080711100835.D047E11ED10@www.antlr.org>
	<1215795560.8615.170.camel@jimi>
	<157c5c5c0807111035q774f0a6o19f079f5232635b3@mail.gmail.com>
Message-ID: <1215801453.8615.185.camel@jimi>

On Fri, 2008-07-11 at 18:35 +0100, Artemus Ward wrote:

> 2008/7/11 Jim Idle <jimi at temporal-wave.com>:
> > On Fri, 2008-07-11 at 22:08 +1200, Gavin Lambert wrote:
> >
> > At 21:37 11/07/2008, Artemus Ward wrote:
> >  >If I don't use /NODEFAULTLIB:MSVCRT then I get these errors
> >  >instead:
> > [...]
> >  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _free already defined
> > in
> >  >LIBCMT.lib(free.obj)
> >  >MSVCRT.lib(MSVCR90.dll) : error LNK2005: _calloc already defined
> >
> >  >in LIBCMT.lib(calloc.obj)
> >
> > Which means that you've probably set the ANTLR library to use the
> > CRT DLL and the application to use the CRT statically.  They must
> > agree with each other exactly if you're going to statically link
> > them.
> >
> > There really is not any reason to use the static versions of the libraries -
> > you should abandon your current MS project and create a new one. This time
> > don't change the default settings until you know what they all mean.
> 
> I didn't start changing them off until the MS compiler and linker
> started displaying messages suggesting that was the thing to do.
> Clearly one could spend a long time reading the copious documentation,
> but one could also seek the advice of those who've done it already.
> 
> I shall do as you suggest, although that means I now have to go back
> and figure out why I was able to compile the static libraries
> successfully but the DLL is somehow corrupt.  I didn't knowingly mess
> with any flags when I built it.


It is unfortunately, all too easy to do. If you don't want to start
again with the project, then the easiest thing to do is to start two VS
sessions, one with your project, one with the C demo solution (which I
put together so that  people had a start point, for exactly this reason
- Visual Studio 2008 is by far the best C IDE I have ever used, but the
project config takes a bit of leanring, though I suppose so does
autoconf and gmake ;-). Go through the General settings and the C/C++
and Linker settings and make sure you have the library configurations
set the same way as the demo projects do. That should fix it all up for
you. Any minute now you will be saying "AhhhhhhH!" and not
"Arrrrrgh!" :-)

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/ef097568/attachment.html 

From jimi at temporal-wave.com  Fri Jul 11 11:54:15 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 11:54:15 -0700
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
In-Reply-To: <g586u7$kpa$1@ger.gmane.org>
References: <g586u7$kpa$1@ger.gmane.org>
Message-ID: <1215802455.8615.203.camel@jimi>

On Fri, 2008-07-11 at 19:57 +0200, Gioele Barabucci wrote:

> This simple grammar
> 
> > grammar Tok1;
> > 
> > stmt:     'id' S id_name S ('#IMP'|'#FIX') EOF; 
> > id_name:  '#' NAME;
> > 
> > NAME: ('A'..'Z')+;
> > S: (' '|'\n')+;
> 
> parses "id #AAA #FIX" correctly but fails on "id #III #FIX" with a
> MismatchedTokenException(5!=9).
> 
> I think the exception is raised because as soon as the lexer sees "#I"
> (in "#III") it expects the token to be equal to the literal "#IMP".
> 
> Is there a way to work around this problem?


I really , once again, cannot stress too much the fact that new users
should not use the inline 'quote' rules in the parser. They really send
you down the wrong streets until you are completely familiar with the
parser/lexer process. I look at your grammar and see the obvious
problems, but I just don't see how new users would.

So (and htis goes for all new users):

1) Don't use quoted strings in the parser;
2) Write your token rules fo rhte lexer. You shoudl immediately see that
your token specs are not consistent.
3) Think of the decisions that the lexer might have to make, and write
your rules that way. ANTLR is pretty good at workig nthings out, but
when you come back to tweak somethign in 12 months time, you will forget
why it works, so being explicit means your code is maintainable.

IN this case then, you have some keywords that begin with '#' and you
also want identifiers taht start with '#'. There are quite a few ways to
write this, but the following will keep it clea. First some fragment
rules to lay out the tokens and document them:

fragment IMP : 'IMP';
fragment FIX : 'FIX' ;

Now a token rule or two that will actually return something to the
lexer:

ID    : 'ID' ;
?IDENT : ('a'..'z' | 'A'..'Z')+ ;
HASH  : '#'   // Many things prefix with HASH, differentiate them here
               (  (FIX)=>FIX  { $type = FIX; }
                  | (IMP)=>IMP {$type = IMP; }
                  | // Neither keyword, sometimes HASH is just HASH and
not pounds    
               )
            ;

Now, in the parser use teh token names:

stmt: ID S idName S (IMP|FIX) EOF ;
idName : HASH IDENT;

Also, if you use:
S : (' '| '\t')+ {$type = HIDDEN; }

Then you can leave teh S tokens out of the parser.

Of course, you only need to do that if you specifically want to eat the
'#' with FIX and IMP. It would be more obvious still if you did:

ID : 'id' ;
FIX : 'FIX' ;
IMP : 'IMP' ;
HASH : '#' ;
IDENT : ('a'..'z'|'A'..'Z')+;

... (impOrFix)
impOrFix : HASH (IMP|FIX) ;


Jim

> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/54991b79/attachment.html 

From laurent.caillette at gmail.com  Fri Jul 11 13:04:57 2008
From: laurent.caillette at gmail.com (Laurent Caillette)
Date: Fri, 11 Jul 2008 22:04:57 +0200
Subject: [antlr-interest] ANTLR-3.1b1 + ANTLRWorks-1.2b5 feedback
Message-ID: <3b7c64070807111304m550ac0e3jc993d4eb013b9153@mail.gmail.com>

Hi,

First off, thanks for ANTLR3 and AntlrWorks. It's an amazing piece of work.

I just had a try with ANTLR-3.1.0b1 and I hit following issues.

ANTLR-3.1.0b1: No CommonErrorTreeAdaptor
The new mechanism for reporting errors seems to return a
CommonErrorTree. It's not documented and I cannot specify an
implementation of my own (as I can with CommonTreeAdaptor) so I have
to do ugly things. I guess it's about reporting errors through a tree,
handling multiple errors. I like it but lack of documentation left me
in the dark for now.

File encoding with ANTLRWorks-1.2b5 on MacOSX
My grammar defines tokens like '\u00e0' ('?') and I'm trying to read a
file encoded as ISO-8859-1. Even adding -Dfile.encoding=ISO-8859-1 as
a VMOptions in info.plist file of the ANTLRWorks package, ANTLRWorks
doesn't recognize characters with accents. This also occurs with
ANTLRWorks-1.1.7 but not inside my tests which rely on ANTLR-3.0.1.jar
directly (the Ant script sets the file.encoding system property).

Hope you'll find this useful in some way.


Regards,

Laurent Caillette
Software architect
http://novelang.sf.net

From rkevinburton at charter.net  Fri Jul 11 13:12:20 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Fri, 11 Jul 2008 13:12:20 -0700
Subject: [antlr-interest] Getting started.
Message-ID: <20080711161220.XO7IT.280110.root@fepweb08>

I have read the web pages and several "how-to" steps but I always get stuck on installation. For example to integrate ANTLRWorks with Visual Studio it is suggested that I download both ANTLR and ANTLRWorks and extract the files to a directory of my choosing. I choose C:/Program Files/ANTLR. So far so good. Next it states that I should "double-click on the jar file". First, I was unable to locate a jar file anywhere within the antlrworks-1.1.7.zip file. How is this created?

Thank you.

Kevin

From jaluber at gmx.de  Fri Jul 11 13:42:39 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 11 Jul 2008 22:42:39 +0200
Subject: [antlr-interest] Getting started.
In-Reply-To: <20080711161220.XO7IT.280110.root@fepweb08>
References: <20080711161220.XO7IT.280110.root@fepweb08>
Message-ID: <4877C5BF.8010701@gmx.de>

rkevinburton at charter.net schrieb:
> I have read the web pages and several "how-to" steps but I always get stuck on installation. For example to integrate ANTLRWorks with Visual Studio it is suggested that I download both ANTLR and ANTLRWorks and extract the files to a directory of my choosing. I choose C:/Program Files/ANTLR. So far so good. Next it states that I should "double-click on the jar file". First, I was unable to locate a jar file anywhere within the antlrworks-1.1.7.zip file. How is this created?
> 
> Thank you.
> 
> Kevin
> 
Probably you have the file ending wrong. Try antlrworks-1.1.7.jar instead.

Johannes

From cvrebert at gmail.com  Fri Jul 11 14:37:32 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Fri, 11 Jul 2008 14:37:32 -0700
Subject: [antlr-interest] Help on /*empty command*/ ; ; ; ;
In-Reply-To: <C49D257F.A002D%sunshine@public.kherson.ua>
References: <C49D257F.A002D%sunshine@public.kherson.ua>
Message-ID: <47c890dc0807111437h19f0f437i131899bad5530305@mail.gmail.com>

I'm a newbie, but i think the possible lookahead through sql_statement
might be the problem.
Have you tried:

sql_single
   : sql_statement? SEMI
   ;


Best of luck,
Chris

On Fri, Jul 11, 2008 at 4:58 AM, Ruslan Zasukhin
<sunshine at public.kherson.ua> wrote:
> Hi All,
>
> I try implement on ANTLR 2.7 the empty command for SQL.
> So parser will eat something as
>
> CREATE TABLE T(f1 int);
> ;
> ;
>
>
> Can somebody show quick draft of such rule?
>
> This my attempt not works as expected.
>
>
> sql
>    :  (sql_single)*  EOF
>    ;
>
> sql_single
>    : sql_staement  (SEMI)?
>    | SEMI
>
>
>
> --
> Best regards,
>
> Ruslan Zasukhin
> VP Engineering and New Technology
> Paradigma Software, Inc
>
> Valentina - Joining Worlds of Information
> http://www.paradigmasoft.com
>
> [I feel the need: the need for speed]
>
>
>
>

From jimi at temporal-wave.com  Fri Jul 11 14:51:13 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Jul 2008 14:51:13 -0700
Subject: [antlr-interest] Getting started.
In-Reply-To: <20080711161220.XO7IT.280110.root@fepweb08>
References: <20080711161220.XO7IT.280110.root@fepweb08>
Message-ID: <1215813073.8615.213.camel@jimi>

On Fri, 2008-07-11 at 13:12 -0700, rkevinburton at charter.net wrote:

> I have read the web pages and several "how-to" steps but I always get stuck on installation. For example to integrate ANTLRWorks with Visual Studio it is suggested that I download both ANTLR and ANTLRWorks and extract the files to a directory of my choosing. I choose C:/Program Files/ANTLR. So far so good. Next it states that I should "double-click on the jar file". First, I was unable to locate a jar file anywhere within the antlrworks-1.1.7.zip file. How is this created?
> 


When you download on Windows, it (IE I think) insists on changing the
file ending from .jar to .zip. The ANTLRWorks download has everything
you need in the one jar and you don't need to expand it. Download the
antlrworks jar and rename it back to .jar. Then create a windows
shortcut that does this:

%windir%\system32\java.exe -Xmx750M -jar c:\antlr\antlrworks-1.2b5.jar

...adapting the names as required. You can use the version of ANTLR
inside ANTLRWorks to generate the code, but it is probably best to
download the ANTLR runtime and tool jars and use those when you want to
run outside ANTLRWorks.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/65fcac43/attachment.html 

From antlr at mirality.co.nz  Fri Jul 11 15:29:19 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 12 Jul 2008 10:29:19 +1200
Subject: [antlr-interest] Error: "Message ID 100 created but is not
 present in errorMsgIDs"
In-Reply-To: <487774BF.50209@gmx.de>
References: <487772DB.6020404@doddington.net>
 <487774BF.50209@gmx.de>
Message-ID: <20080711222928.9493111ED69@www.antlr.org>

At 02:57 12/07/2008, Johannes Luber wrote:
 >     grammar TestGrammar2;
 >
 >     defList: (CommentLine | Def | WS)*;
 >
 >     Def: 'DEFINE' WS Name;
 >     CommentLine:    '!' ~('\n'|'\r')* '\r'? '\n' { $channel =
 >HIDDEN; };
 >     fragment Name:    Letter AlphaNum*;
 >     fragment AlphaNum:    Letter | Digit;
 >     fragment Digit:    '0'..'9';
 >     fragment Letter    : 'A'..'Z' | 'a'..'z';
 >     WS: ( ' ' | '\t' | '\r' | '\n')+    { $channel = HIDDEN; };

Note that defList will never actually see CommentLine or WS 
tokens, since they're hidden.  So you might as well just render it 
like so:

   defList: Def*;


From lucazd at gmail.com  Fri Jul 11 16:43:06 2008
From: lucazd at gmail.com (Lucaz)
Date: Fri, 11 Jul 2008 20:43:06 -0300
Subject: [antlr-interest] Navigate through the parsed Tree
In-Reply-To: <8070e9c20807111017y224c7e83ve465651e7fe1fa85@mail.gmail.com>
References: <8070e9c20807111017y224c7e83ve465651e7fe1fa85@mail.gmail.com>
Message-ID: <8070e9c20807111643m6c30300an50b3c5b7dad0e058@mail.gmail.com>

I guess this is a solution for the people interested in traversing the
ANTLRWork parsed tree:

*your start rule*
@after {
    Tree root = retval.getTree();
}
:
...
;

Tree API:
http://www.antlr.org/api/Java/interfaceorg_1_1antlr_1_1runtime_1_1tree_1_1_tree.html


On Fri, Jul 11, 2008 at 2:17 PM, Lucaz <lucazd at gmail.com> wrote:

> Hello, I am very new with ANTRL and I would like to try something simple:
> I am using ANTRLWork and the Java 1.5 grammar file (
> http://www.antlr.org/grammar/1152141644268/Java.g).
> My question is; how can I access the parsed tree?.
>
> I tried getTree(), but it returns null. The adapter (getAdapter()) works
> but I don't understand what should I pass to its methods (like
> getParent(Object)).
> (I've checked the docs here ->
> http://www.antlr.org/api/Java/interfaceorg_1_1antlr_1_1runtime_1_1tree_1_1_tree_adaptor.html#01954069ab7d2c2eb78d328572110725
> )
>
> I tried these options also: output=AST; ASTLabelType=CommonTree;
>
> Thanks a lot for this awesome tool!,
> Lucaz
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080711/b17673cd/attachment.html 

From sunshine at public.kherson.ua  Fri Jul 11 21:54:13 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Sat, 12 Jul 2008 07:54:13 +0300
Subject: [antlr-interest] Help on /*empty command*/ ; ; ; ;
In-Reply-To: <47c890dc0807111437h19f0f437i131899bad5530305@mail.gmail.com>
Message-ID: <C49E13A5.A01DD%sunshine@public.kherson.ua>

On 7/12/08 12:37 AM, "Chris Rebert" <cvrebert at gmail.com> wrote:

Hi Chris,

> I'm a newbie, but i think the possible lookahead through sql_statement
> might be the problem.
> Have you tried:
> 
> sql_single
>    : sql_statement? SEMI
>    ;
 
Not yet, and I think this will bring performance troubles.

I know that such empty commands are allowed e.g. In C++.
I have take C++ grammars, and later realize why in SQL I have problems.

* because in C++ SEMI must present.
* but in SQL it MAY present.

So in SQL I need something as

sql_single
    :    SEMI
    |    statement (SEMI)?

But  this not works also...

I think because ANTLR cannot differ when add SEMI to second branch, and when
it is really just SEMI.

Still playing.

 
> Best of luck,
> Chris
> 
> On Fri, Jul 11, 2008 at 4:58 AM, Ruslan Zasukhin
> <sunshine at public.kherson.ua> wrote:
>> Hi All,
>> 
>> I try implement on ANTLR 2.7 the empty command for SQL.
>> So parser will eat something as
>> 
>> CREATE TABLE T(f1 int);
>> ;
>> ;
>> 
>> 
>> Can somebody show quick draft of such rule?
>> 
>> This my attempt not works as expected.
>> 
>> 
>> sql
>>    :  (sql_single)*  EOF
>>    ;
>> 
>> sql_single
>>    : sql_staement  (SEMI)?
>>    | SEMI


-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From tbrandonau at gmail.com  Fri Jul 11 22:06:03 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Sat, 12 Jul 2008 15:06:03 +1000
Subject: [antlr-interest] Help on /*empty command*/ ; ; ; ;
In-Reply-To: <C49E13A5.A01DD%sunshine@public.kherson.ua>
References: <47c890dc0807111437h19f0f437i131899bad5530305@mail.gmail.com>
	<C49E13A5.A01DD%sunshine@public.kherson.ua>
Message-ID: <ebc876d70807112206pc747f51mf547d1769feb6840@mail.gmail.com>

On Sat, Jul 12, 2008 at 2:54 PM, Ruslan Zasukhin
<sunshine at public.kherson.ua> wrote:
> On 7/12/08 12:37 AM, "Chris Rebert" <cvrebert at gmail.com> wrote:
>
> Hi Chris,
>
>> I'm a newbie, but i think the possible lookahead through sql_statement
>> might be the problem.
>> Have you tried:
>>
>> sql_single
>>    : sql_statement? SEMI
>>    ;
>
> Not yet, and I think this will bring performance troubles.
>
> I know that such empty commands are allowed e.g. In C++.
> I have take C++ grammars, and later realize why in SQL I have problems.
>
> * because in C++ SEMI must present.
> * but in SQL it MAY present.
>
> So in SQL I need something as
>
> sql_single
>    :    SEMI
>    |    statement (SEMI)?
>
> But  this not works also...
>
> I think because ANTLR cannot differ when add SEMI to second branch, and when
> it is really just SEMI.
Is this a problem? ANTLR3 will issue a warning but it should work as
desired matching the optional SEMI if possible. I thought ANTLR2 would
do the same but it's been awhile.
Otherwise you could do:
sql_single
    :    SEMI
    |    statement
Assuming you don't need to include the SEMI in the tree this should be ok.
Otherwise you would need to add a predicate to the optional SEMI or
(maybe) make it greedy.

Tom.
>
> Still playing.
>
>
>> Best of luck,
>> Chris
>>
>> On Fri, Jul 11, 2008 at 4:58 AM, Ruslan Zasukhin
>> <sunshine at public.kherson.ua> wrote:
>>> Hi All,
>>>
>>> I try implement on ANTLR 2.7 the empty command for SQL.
>>> So parser will eat something as
>>>
>>> CREATE TABLE T(f1 int);
>>> ;
>>> ;
>>>
>>>
>>> Can somebody show quick draft of such rule?
>>>
>>> This my attempt not works as expected.
>>>
>>>
>>> sql
>>>    :  (sql_single)*  EOF
>>>    ;
>>>
>>> sql_single
>>>    : sql_staement  (SEMI)?
>>>    | SEMI
>
>
> --
> Best regards,
>
> Ruslan Zasukhin
> VP Engineering and New Technology
> Paradigma Software, Inc
>
> Valentina - Joining Worlds of Information
> http://www.paradigmasoft.com
>
> [I feel the need: the need for speed]
>
>
>

From rkevinburton at charter.net  Fri Jul 11 23:10:01 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Fri, 11 Jul 2008 23:10:01 -0700
Subject: [antlr-interest] Install Java on Windows 2008 Server
Message-ID: <20080712021001.BIGFJ.126106.root@fepweb14>

This question isn't specifically about ANTLR but it is preventing me from running ANTLR and that is the only reason I want to install Java. 

Basically when I try to install Java from Sun's Web site (since Java 1.5 or higher is required for ANTLR) I get a warning that the security settings will not allow me to install ActiveX. The suggestion is to go to Internet Options -> Custom Settings and allow ActiveX. But, when I look at the Internet Options the "Custom Settings" button is greyed out and I cannot seem to get it to be enabled. Anyone else been down this path? It seems specific to Windows 2008 Server (maybe Vista also) as I have had no trouble installing with Windows 2003.

Thank you.

Kevin

From rkevinburton at charter.net  Fri Jul 11 23:52:40 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Fri, 11 Jul 2008 23:52:40 -0700
Subject: [antlr-interest] Reserved words
Message-ID: <20080712025240.R0B8M.126238.root@fepweb14>

I am trying to build a simple script language that mimics C#. As such there are dome identifiers that are reserved. For example 'int a;' is legal but 'int int' or 'int bool' doesnt make much sense. As such I would like to make a list of some reserved words. My fiirst attempt failed miserably. 

RESERVED : 'class' | 'struct' | 'int' | 'bool';

When I check this grammer I get an error that 'class' is unreachable. Further on in the grammar I have:

CLASS : 'class';

class: SCOPE CLASS IDENT '{' body '}';

It seems that even before I get around to defining IDENT to be all the legal characters for an identifier minus the reserved words, I get an error even listing the reserved words. I am obviously looking at this wrong. Any ideas?

Thank you.

Kevin

From jaluber at gmx.de  Sat Jul 12 02:41:13 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 12 Jul 2008 11:41:13 +0200
Subject: [antlr-interest] Reserved words
In-Reply-To: <20080712025240.R0B8M.126238.root@fepweb14>
References: <20080712025240.R0B8M.126238.root@fepweb14>
Message-ID: <48787C39.9000205@gmx.de>

rkevinburton at charter.net schrieb:
> I am trying to build a simple script language that mimics C#. As such there are dome identifiers that are reserved. For example 'int a;' is legal but 'int int' or 'int bool' doesnt make much sense. As such I would like to make a list of some reserved words. My fiirst attempt failed miserably. 
> 
> RESERVED : 'class' | 'struct' | 'int' | 'bool';
> 
> When I check this grammer I get an error that 'class' is unreachable. Further on in the grammar I have:
> 
> CLASS : 'class';
> 
> class: SCOPE CLASS IDENT '{' body '}';
> 
> It seems that even before I get around to defining IDENT to be all the legal characters for an identifier minus the reserved words, I get an error even listing the reserved words. I am obviously looking at this wrong. Any ideas?
> 
> Thank you.
> 
> Kevin
> 
Remove RESERVED and define CLASS, STRUCT, etc. before the ident rule. If 
you truly need RESERVED elsewhere, turn it into

reserved : CLASS | STRUCT | etc. ;

Don't use embedded string literals in parser rules as those just give 
problems. And in tree grammars they aren't allowed anyway.

Johannes

From r_reitzi at cs.uni-kl.de  Sat Jul 12 03:20:14 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Sat, 12 Jul 2008 12:20:14 +0200
Subject: [antlr-interest] Help on /*empty command*/ ; ; ; ;
In-Reply-To: <ebc876d70807112206pc747f51mf547d1769feb6840@mail.gmail.com>
References: <47c890dc0807111437h19f0f437i131899bad5530305@mail.gmail.com>
	<C49E13A5.A01DD%sunshine@public.kherson.ua>
	<ebc876d70807112206pc747f51mf547d1769feb6840@mail.gmail.com>
Message-ID: <d67c6c74815872ab21d0a849ab215a8b@mail.frhk.de>

Hi!

If you do not need semicolons at all and do not want to process empty
statements in any way either, something like

sql_single : sql_statement (SEMI)*;

should also do the job. I assume you already ignore \n and comrades in your
lexer rules so those should come in your way.

Regards

Raphael

On Sat, 12 Jul 2008 15:06:03 +1000, "Thomas Brandon" <tbrandonau at gmail.com>
wrote:
> On Sat, Jul 12, 2008 at 2:54 PM, Ruslan Zasukhin
> <sunshine at public.kherson.ua> wrote:
>> On 7/12/08 12:37 AM, "Chris Rebert" <cvrebert at gmail.com> wrote:
>>
>> Hi Chris,
>>
>>> I'm a newbie, but i think the possible lookahead through sql_statement
>>> might be the problem.
>>> Have you tried:
>>>
>>> sql_single
>>>    : sql_statement? SEMI
>>>    ;
>>
>> Not yet, and I think this will bring performance troubles.
>>
>> I know that such empty commands are allowed e.g. In C++.
>> I have take C++ grammars, and later realize why in SQL I have problems.
>>
>> * because in C++ SEMI must present.
>> * but in SQL it MAY present.
>>
>> So in SQL I need something as
>>
>> sql_single
>>    :    SEMI
>>    |    statement (SEMI)?
>>
>> But  this not works also...
>>
>> I think because ANTLR cannot differ when add SEMI to second branch, and
> when
>> it is really just SEMI.
> Is this a problem? ANTLR3 will issue a warning but it should work as
> desired matching the optional SEMI if possible. I thought ANTLR2 would
> do the same but it's been awhile.
> Otherwise you could do:
> sql_single
>     :    SEMI
>     |    statement
> Assuming you don't need to include the SEMI in the tree this should be
ok.
> Otherwise you would need to add a predicate to the optional SEMI or
> (maybe) make it greedy.
> 
> Tom.
>>
>> Still playing.
>>
>>
>>> Best of luck,
>>> Chris
>>>
>>> On Fri, Jul 11, 2008 at 4:58 AM, Ruslan Zasukhin
>>> <sunshine at public.kherson.ua> wrote:
>>>> Hi All,
>>>>
>>>> I try implement on ANTLR 2.7 the empty command for SQL.
>>>> So parser will eat something as
>>>>
>>>> CREATE TABLE T(f1 int);
>>>> ;
>>>> ;
>>>>
>>>>
>>>> Can somebody show quick draft of such rule?
>>>>
>>>> This my attempt not works as expected.
>>>>
>>>>
>>>> sql
>>>>    :  (sql_single)*  EOF
>>>>    ;
>>>>
>>>> sql_single
>>>>    : sql_staement  (SEMI)?
>>>>    | SEMI
>>
>>
>> --
>> Best regards,
>>
>> Ruslan Zasukhin
>> VP Engineering and New Technology
>> Paradigma Software, Inc
>>
>> Valentina - Joining Worlds of Information
>> http://www.paradigmasoft.com
>>
>> [I feel the need: the need for speed]
>>
>>
>>


From r_reitzi at cs.uni-kl.de  Sat Jul 12 03:27:07 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Sat, 12 Jul 2008 12:27:07 +0200
Subject: [antlr-interest] Reserved words
In-Reply-To: <48787C39.9000205@gmx.de>
References: <20080712025240.R0B8M.126238.root@fepweb14>
	<48787C39.9000205@gmx.de>
Message-ID: <da4d924f1d389e29b4bcdae557c5ece7@mail.frhk.de>

Hi Kevin!

Things like keywords are kind of static semantics. I do not feel you can
solve those matters elegantly whith syntactical means.
In my opinion, you should parse _all_ (syntactically correct) identifiers
as such and check later (that means, in the action according to this rule)
if any keyword is used. You can easily throw an exception then. In
particular, you can provide a much better error message than "No viable alt
found" or "error matching ..." - for what you really want to say is "You
may not use keyword XY as identifier!".

Regards

Raphael

On Sat, 12 Jul 2008 11:41:13 +0200, Johannes Luber <jaluber at gmx.de> wrote:
> rkevinburton at charter.net schrieb:
>> I am trying to build a simple script language that mimics C#. As such
> there are dome identifiers that are reserved. For example 'int a;' is
legal
> but 'int int' or 'int bool' doesnt make much sense. As such I would like
to
> make a list of some reserved words. My fiirst attempt failed miserably.
>>
>> RESERVED : 'class' | 'struct' | 'int' | 'bool';
>>
>> When I check this grammer I get an error that 'class' is unreachable.
> Further on in the grammar I have:
>>
>> CLASS : 'class';
>>
>> class: SCOPE CLASS IDENT '{' body '}';
>>
>> It seems that even before I get around to defining IDENT to be all the
> legal characters for an identifier minus the reserved words, I get an
error
> even listing the reserved words. I am obviously looking at this wrong.
Any
> ideas?
>>
>> Thank you.
>>
>> Kevin
>>
> Remove RESERVED and define CLASS, STRUCT, etc. before the ident rule. If
> you truly need RESERVED elsewhere, turn it into
> 
> reserved : CLASS | STRUCT | etc. ;
> 
> Don't use embedded string literals in parser rules as those just give
> problems. And in tree grammars they aren't allowed anyway.
> 
> Johannes


From r_reitzi at cs.uni-kl.de  Sat Jul 12 03:34:45 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Sat, 12 Jul 2008 12:34:45 +0200
Subject: [antlr-interest] declare throws-clause for rule
In-Reply-To: <35AC19B502E98D42879AFA71FAD9CDCC2D2437@UTEX01.be-value.nl>
References: <486CA6BD.3000104@gmx.de>
	<35AC19B502E98D42879AFA71FAD9CDCC2D2437@UTEX01.be-value.nl>
Message-ID: <b10b9b9a40ecf1786b44f7434359eb44@mail.frhk.de>

Hi!

Throwing custom exceptions from generated code was something I also wished
to do. I do not feel that throwing a RuntimeException is a clean way to
solve that problem.
Is there any particular reason for generated parsers "swallowing" all
Exceptions (and providing no means of changing that behaviour) or is it
just a thing no one ever got disturbed by?

Regards

Raphael

On Thu, 3 Jul 2008 13:24:02 +0200, "Gerard van de Glind"
<g.vandeglind at beinformed.nl> wrote:
> Hi,
> 
> Yes, you can throw an exception (a RuntTimeException to be precise,
> because these are unchecked) from your grammar. And you can catch these
> exceptions in the class that invokes the generated parser.
> 
> Example:
> expression : ruleA | ruleB { if (condition) {throw new
> RunTimeException("");} };
> 
> Also, code that you place in the @member action gets generated into your
> parser.
> 
> Good luck!
> 
> Cheers, Gerard
> 
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of tilman walter
> Sent: donderdag 3 juli 2008 12:15
> To: ANTLR List
> Subject: [antlr-interest] declare throws-clause for rule
> 
> Hi List,
> 
> I am a newby to antlr.
> Is there a possibility to let a rule throw a custom exception that can 
> be catched by the class invoking the parser?
> I think i could place this piece of code in the generated class, but i 
> wonder if i can reach this through a grammar construct....
> 
> I would appreciate for any hint.
> Thanks is advance.
> 
> Tilman


From sunshine at public.kherson.ua  Sat Jul 12 03:50:03 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Sat, 12 Jul 2008 13:50:03 +0300
Subject: [antlr-interest] Help on /*empty command*/ ; ; ; ;
In-Reply-To: <ebc876d70807112206pc747f51mf547d1769feb6840@mail.gmail.com>
Message-ID: <C49E670B.A021A%sunshine@public.kherson.ua>

On 7/12/08 8:06 AM, "Thomas Brandon" <tbrandonau at gmail.com> wrote:

>>> I'm a newbie, but i think the possible lookahead through sql_statement
>>> might be the problem.
>>> Have you tried:
>>> 
>>> sql_single
>>>    : sql_statement? SEMI
>>>    ;
>> 
>> Not yet, and I think this will bring performance troubles.
>> 
>> I know that such empty commands are allowed e.g. In C++.
>> I have take C++ grammars, and later realize why in SQL I have problems.
>> 
>> * because in C++ SEMI must present.
>> * but in SQL it MAY present.
>> 
>> So in SQL I need something as
>> 
>> sql_single
>>    :    SEMI
>>    |    statement (SEMI)?
>> 
>> But  this not works also...
>> 
>> I think because ANTLR cannot differ when add SEMI to second branch, and when
>> it is really just SEMI.
> Is this a problem? ANTLR3 will issue a warning but it should work as
> desired matching the optional SEMI if possible. I thought ANTLR2 would
> do the same but it's been awhile.
> Otherwise you could do:
> sql_single
>     :    SEMI
>     |    statement
> Assuming you don't need to include the SEMI in the tree this should be ok.
> Otherwise you would need to add a predicate to the optional SEMI or
> (maybe) make it greedy.

1) I am using yet 2.7.2

2) greedy will eat all following SEMI, but we also need extract EXACTLY one
command from start to its end, because e.g. VIEWs, TRIGGERs and Stored
Procedures should remember original string


-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From r_reitzi at cs.uni-kl.de  Sat Jul 12 04:25:35 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Sat, 12 Jul 2008 13:25:35 +0200
Subject: [antlr-interest]
 =?utf-8?q?Identifiers_are_not_local_to_alternati?=
 =?utf-8?q?_ves=3F?=
In-Reply-To: <200806292132.m5TLUXpB001225@mailgw3.uni-kl.de>
References: <157c5c5c0806281343u7a8bf5cdx1981bc34a507c5b7@mail.gmail.com>
	<473f88a4c839c1e123f159f0a217baff@mail.frhk.de>
	<157c5c5c0806290331l1d05b867i1a4b4fb679601146@mail.gmail.com>
	<f31bf7430e646ee41d810b3646443a24@mail.frhk.de>
	<7808B71F-BED0-4E12-AB60-481BAF9AC4DE@cs.usfca.edu>
	<7d0c0edaa35749c5075f5118f61d2b9c@mail.frhk.de>
	<200806292132.m5TLUXpB001225@mailgw3.uni-kl.de>
Message-ID: <6e9ba9928bf0ad1d60fbfeacd85c6986@mail.frhk.de>

Hi!

I did not have such examples in mind. Given something like that is and
should be possible, perhaps enhanced static analysis of the input grammar
would be a good solution to avoid confusion. 
It would be a matter of style wether you would like to use more powerful
analysis to create the most fitting piece of code or to print the most
accurate error message (if you want to be restrictive with the use of
variables in grammars).

(Naturally, if you know the tool well, you will not be confused. But
hopefully, there will always be people getting to know ANTLR just then,
like me today, and getting confused.)

Regards

Raphael

On Mon, 30 Jun 2008 09:30:02 +1200, Gavin Lambert <antlr at mirality.co.nz>
wrote:
> At 09:12 30/06/2008, Raphael Reitzig wrote:
>  >*** error(116): Test.g:4:8: unknown attribute for rule b: s
>  >
>  >4.8 does not point to any sensible location, at least not if you
> do
>  >not know what to look for. Or am I counting in the wrong way? ?(
> 
> Line 4 column 8 is just after the opening { in the "v=a" line, so
> it's certainly *close* to the error.
> 
>  >* move declaration of those variable inside the "case"-Blocks,
>  >rendering them kind of alternative-local.
> 
> There is a reason why this is done that way.  You might want to
> have code like this:
> 
> test
>    :  (v=a | v=b) { DoSomething($v.x); }
>    ;
> 
> (Where both 'a' and 'b' return the same type.)
> 
> Having said that, the way the internal code generation works tends
> to make the types incompatible anyway (the actual return from 'a'
> will be an 'a_return_struct' and the return from 'b' will be a
> 'b_return_struct', which aren't compatible), so the above isn't
> always feasible either.  Another example (which does work
> currently):
> 
> test
>    :  (v=a b c | d v=a c) { DoSomething($v.x); }
>    ;


From jimi at temporal-wave.com  Sat Jul 12 08:37:12 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 12 Jul 2008 08:37:12 -0700
Subject: [antlr-interest] Install Java on Windows 2008 Server
In-Reply-To: <20080712021001.BIGFJ.126106.root@fepweb14>
References: <20080712021001.BIGFJ.126106.root@fepweb14>
Message-ID: <1215877032.8615.244.camel@jimi>

On Fri, 2008-07-11 at 23:10 -0700, rkevinburton at charter.net wrote:

> This question isn't specifically about ANTLR but it is preventing me from running ANTLR and that is the only reason I want to install Java. 
> 
> Basically when I try to install Java from Sun's Web site (since Java 1.5 or higher is required for ANTLR) I get a warning that the security settings will not allow me to install ActiveX. The suggestion is to go to Internet Options -> Custom Settings and allow ActiveX. But, when I look at the Internet Options the "Custom Settings" button is greyed out and I cannot seem to get it to be enabled. Anyone else been down this path? It seems specific to Windows 2008 Server (maybe Vista also) as I have had no trouble installing with Windows 2003.


It is likely that the security settings for the domain account you are
using do not allow you to change those settings in IE. However, I would
be very surprised if Sun required Windows users to use an ActiveX
control to download - are you sure it isn't disabling dynamic
content/scripts of some sort instead?

Some solutions:

1) Just download the offline installation;
2) Download the offline installation on another system and just copy it
using Windows networking;
3) Load firefox;

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080712/5edb7a43/attachment-0001.html 

From csanders at hoovers.com  Sat Jul 12 08:48:32 2008
From: csanders at hoovers.com (Sanders, Charles)
Date: Sat, 12 Jul 2008 10:48:32 -0500
Subject: [antlr-interest] Building 3.1b1
Message-ID: <0C3AEA555EC5E14EB9A3756D74D46B4204DDF840@mercury.ad.austin.hoovers.com>

After hunting down the antlr ant task I got it to build but its giving me these errors:

 [myjavac] /home/qbert/downloads/antlr-3.1b1/codegen/ANTLRLexer.java:61: duplicate class: org.antlr.tool.ANTLRLexer
  [myjavac] public class ANTLRLexer extends antlr.CharScanner implements ANTLRTokenTypes, TokenStream
  [myjavac]        ^
  [myjavac] /home/qbert/downloads/antlr-3.1b1/codegen/ANTLRParser.java:72: duplicate class: org.antlr.tool.ANTLRParser
  [myjavac] public class ANTLRParser extends antlr.LLkParser       implements ANTLRTokenTypes
  [myjavac]        ^
  [myjavac] /home/qbert/downloads/antlr-3.1b1/codegen/ANTLRTokenTypes.java:37: duplicate class: org.antlr.tool.ANTLRTokenTypes
  [myjavac] public interface ANTLRTokenTypes {

[ snip more of the same ]

Just running the default ant target, any ideas ?

Thanks,
Charles Sanders
512.380.4730
Hoovers.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080712/d282ca9c/attachment.html 

From csanders at hoovers.com  Sat Jul 12 08:54:12 2008
From: csanders at hoovers.com (Sanders, Charles)
Date: Sat, 12 Jul 2008 10:54:12 -0500
Subject: [antlr-interest] Tree Grammar
Message-ID: <0C3AEA555EC5E14EB9A3756D74D46B4204DDF841@mercury.ad.austin.hoovers.com>

I have a simple tree walker grammar that I've inlined, which corresponds to the attachment which builds the tree,but Im getting this error from Antlr:

[java] error(100): grammar/Entitlements_tree_walker.g:48:5: syntax error: antlr: grammar/Entitlements_tree_walker.g:48:5: unexpected token: ASSIGN

I've looked compared it to the examples and cant find any differences, any ideas ?

-- Entitlements_tree_walker.g


tree grammar Entitlements_tree_walker;

options {
  tokenVocab=Entitlements_ast; // import tokens from Entitlements_ast.g
  ASTLabelType=CommonTree;
}





program	:	
	(statement) +
 
	;
	

statement
	:
	   expression  
	 | ifStatement 
	 | blockStatement
	 | foreachStatement

	    ;
	    

ifStatement
	:	
	  'if'  e=expression 
	  s1=statement
	  
	   ( 'else'  s2=statement ) ?  
	     
	  ;

foreachStatement
	:	
	'foreach' '(' expression 'in' expression ')' statement;

blockStatement
	:	
	'{' (statement)+ '}'
	;

expression  
	: 
	 ^(ASSIGN $e) 
	; 


assignmentExpression  
	:
	t=orExpression ( 
	
	  '=' e=expression
	 | '+=' e=expression
	 | '-='  e=expression
	 |'*='  e=expression
	 |'/='  e=expression
	 | '.='  e=expression
	)*
		
	;



orExpression 
	:
	e1=andExpression 
	( '||' e2=andExpression 
	)*
	;
	
andExpression   
	:
	e1=relationalExpression 
	('&&' e2=relationalExpression 
	
	
	)*

	;

relationalExpression 
	:
	e1=addSubtractExpression (
	('=='  e2=addSubtractExpression 
	| '!='  e2=addSubtractExpression 
	| '<='  e2=addSubtractExpression 
	| '>='  e2=addSubtractExpression
	| '<' e2=addSubtractExpression
	| '>' e2=addSubtractExpression
	)
	 )*

	;

	

addSubtractExpression 
	:
	e=multiplyDivideExpression 
	( 
	 '+' e=multiplyDivideExpression 
	 | '-' e=multiplyDivideExpression 
	 | '.' e=multiplyDivideExpression
	 )*
	;


	 

multiplyDivideExpression 
	:
	e=unaryExpression  (
	 '*' e=unaryExpression 
	 | '/' e=unaryExpression 
	 )*
	;



unaryExpression 
	: 
	t=atom 

	;
	

	
atom 
	:	
	StringLiteral 
	| IntegerLiteral  
	| FloatingPointLiteral  
	| Identifier 
	| TruthLiteral 
	| '(' e=expression ')' 
	| f=functionCall 
	| 'null' 
	;
	


functionCall  
	:	
	'max' '(' e1=expression ',' e2=expression ')' 
	| 'min' '(' e1=expression ',' e2=expression ')' 
	| 'contains' '(' id1=Identifier ',' e2=expression  ')' 
	| 'exists' '(' id1=Identifier ')' 
	| 'print' '(' e1=expression ')'
	| 'append' '(' e1=expression ',' e2=expression ')' 
	| 'delete' '(' id1=Identifier ')'

	;



-- 




Thanks!
Charlie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080712/76eb7740/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Entitlements_ast.g
Type: application/octet-stream
Size: 3195 bytes
Desc: Entitlements_ast.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080712/76eb7740/attachment.obj 

From jimi at temporal-wave.com  Sat Jul 12 10:49:02 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 12 Jul 2008 10:49:02 -0700
Subject: [antlr-interest] Tree Grammar
In-Reply-To: <0C3AEA555EC5E14EB9A3756D74D46B4204DDF841@mercury.ad.austin.hoovers.com>
References: <0C3AEA555EC5E14EB9A3756D74D46B4204DDF841@mercury.ad.austin.hoovers.com>
Message-ID: <1215884942.8615.258.camel@jimi>

On Sat, 2008-07-12 at 10:54 -0500, Sanders, Charles wrote:

> I have a simple tree walker grammar that I've inlined, which
> corresponds to the attachment which builds the tree,but Im getting
> this error from Antlr:
> 
> [java] error(100): grammar/Entitlements_tree_walker.g:48:5: syntax
> error: antlr: grammar/Entitlements_tree_walker.g:48:5: unexpected
> token: ASSIGN
> 
> I've looked compared it to the examples and cant find any differences,
> any ideas ?
> expression 
>         :
>          ^(ASSIGN $e)


The problem is this $e. What is it supposed to be? ;-) You have copied
the rule from the parser and instead of $e, you want to name the rule or
token that you assigned to $e in the parser, or a tree parser rule that
corresponds the tree stucture it produces.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080712/f3b2f1ed/attachment.html 

From rkevinburton at charter.net  Sun Jul 13 15:17:12 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Sun, 13 Jul 2008 15:17:12 -0700
Subject: [antlr-interest] JScript .NET grammar
Message-ID: <20080713181712.WQHXD.150172.root@fepweb14>

Before I do too much work I would like to know if anyone has developed a Jscript .NET grammar. I see numerous ECMAScript grammars on the ANTLR site and I see that a few people a long time ago have started building a grammar for Jscript .NET. I was wondering if anyone has completed a version that they would not mind sharing.

Thank you.

Kevin

From nilesh.kapile at tcs.com  Mon Jul 14 00:13:34 2008
From: nilesh.kapile at tcs.com (nilesh.kapile at tcs.com)
Date: Mon, 14 Jul 2008 12:43:34 +0530
Subject: [antlr-interest] Preserving Comments
Message-ID: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>

Hello,

I need to preserve comments and want to collect it in some data structure. 
 How can we do that in ANTLR?

Currently, I've following rule for comments:

LINE_COMMENT
    :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;}
    ;


Best Regards,
Nilesh Sudhakar Kapile
Tata Consultancy Services
Mailto: nilesh.kapile at tcs.com
Website: http://www.tcs.com
____________________________________________
Experience certainty.   IT Services
                        Business Solutions
                        Outsourcing
____________________________________________
=====-----=====-----=====
Notice: The information contained in this e-mail
message and/or attachments to it may contain 
confidential or privileged information. If you are 
not the intended recipient, any dissemination, use, 
review, distribution, printing or copying of the 
information contained in this e-mail message 
and/or attachments to it are strictly prohibited. If 
you have received this communication in error, 
please notify us by reply e-mail or telephone and 
immediately and permanently delete the message 
and any attachments. Thank you


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/0670da8f/attachment.html 

From laurent.caillette at gmail.com  Mon Jul 14 00:40:50 2008
From: laurent.caillette at gmail.com (Laurent Caillette)
Date: Mon, 14 Jul 2008 09:40:50 +0200
Subject: [antlr-interest] Preserving Comments
In-Reply-To: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
References: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
Message-ID: <3b7c64070807140040i660442adi58972dd2aca11ebc@mail.gmail.com>

You'll have to define a rule making the comment a "first-class person"
in your grammar. By now comments are silently swallowed by your
parser.
I've no idea of how your grammar looks like but you may have to define
the whitespace as a rule itself, and include the comments inside the
whitespace rule.

Regards,

c.
http://novelang.sf.net

On Mon, Jul 14, 2008 at 9:13 AM,  <nilesh.kapile at tcs.com> wrote:
>
> Hello,
>
> I need to preserve comments and want to collect it in some data structure.
>  How can we do that in ANTLR?
>
> Currently, I've following rule for comments:
>
> LINE_COMMENT
>     :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;}
>     ;

From kroizguy at gmail.com  Mon Jul 14 04:37:16 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Mon, 14 Jul 2008 14:37:16 +0300
Subject: [antlr-interest] Can't find template ruleRefBang.st
Message-ID: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>

Hi,
I am trying to convert the Fortran77 grammar so I could use it with ANTLR 3.
I get the following error:

kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool Fortran77.g
error(10):  internal error: Fortran77.g :
java.lang.IllegalArgumentException: Can't find template ruleRefBang.st
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:485)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:372)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:384)
org.antlr.codegen.CodeGenTreeWalker.getRuleElementST(CodeGenTreeWalker.java:135)
org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:1901)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1641)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1490)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1517)
org.antlr.codegen.CodeGenTreeWalker.alternative(CodeGenTreeWalker.java:1252)
org.antlr.codegen.CodeGenTreeWalker.block(CodeGenTreeWalker.java:1037)
org.antlr.codegen.CodeGenTreeWalker.rule(CodeGenTreeWalker.java:753)
org.antlr.codegen.CodeGenTreeWalker.rules(CodeGenTreeWalker.java:544)
org.antlr.codegen.CodeGenTreeWalker.grammarSpec(CodeGenTreeWalker.java:486)
org.antlr.codegen.CodeGenTreeWalker.grammar(CodeGenTreeWalker.java:333)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:406)
org.antlr.Tool.processGrammar(Tool.java:347)
org.antlr.Tool.process(Tool.java:268)
org.antlr.Tool.main(Tool.java:70)

Please help, I am new to java and to language recognition.
I am reading Parr's book parallel to this project that I need to do but I
only finished the third chapter.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/e60beaba/attachment.html 

From antlr at mirality.co.nz  Mon Jul 14 05:27:31 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 15 Jul 2008 00:27:31 +1200
Subject: [antlr-interest] Can't find template ruleRefBang.st
In-Reply-To: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.co
 m>
References: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>
Message-ID: <20080714122736.AB86B11ECC5@www.antlr.org>

At 23:37 14/07/2008, Guy Kroizman wrote:
>I am trying to convert the Fortran77 grammar so I could use it 
>with ANTLR 3.
>I get the following error:
>
>kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool 
>Fortran77.g
>error(10):  internal error: Fortran77.g : 
>java.lang.IllegalArgumentException: Can't find template 
>ruleRefBang.st

IIRC, this has something to do with mixing tree construction 
syntax illegally, most likely trying to use a ! in a rule that 
already has a -> rewrite.

(Yeah, I know, it's not the best error message in the world.)


From gavilancomun at gmail.com  Mon Jul 14 06:34:31 2008
From: gavilancomun at gmail.com (Gavilan)
Date: Mon, 14 Jul 2008 14:34:31 +0100
Subject: [antlr-interest] Passing list of tokens to StringTemplate
Message-ID: <487B55E7.8010404@googlemail.com>

Hi,

I am learning antlr with version 3.1b1.

I would like to pass a list of tokens to a template.

Here is a simplified example:

toks.stg
========

group toks;

toks(v) ::= <<

\<toks><v; separator=", ">\</toks>
 >>


toks.g
======

grammar toks;

options { output=template; }

INT: ('+'|'-')? ('0'..'9')+;
WS: (' '|'\t'|'\r'|'\n')+ { skip(); };

toks: t+=INT t+=INT t+=INT -> toks(v={$t});


On input:
-1 0 23

I get:
<toks>[@0,0:1='-1',<4>,1:0], [@1,3:3='0',<4>,1:3], 
[@2,5:6='23',<4>,1:5]</toks>



If I add a new rule:

int_rule: INT -> template(v={$INT.text}) "<v>";

and modify the toks rule to use it:

toks: t+=int_rule t+=int_rule t+=int_rule -> toks(v={$t});

I get the expected output:
<toks>-1, 0, 23</toks>


Is this the best way to do it?

Best Wishes,
James

--
"Be excellent to each other", Bill & Ted

From jimi at temporal-wave.com  Mon Jul 14 07:54:30 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Jul 2008 07:54:30 -0700
Subject: [antlr-interest] Preserving Comments
In-Reply-To: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
References: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
Message-ID: <1216047270.26749.4.camel@jimi>

On Mon, 2008-07-14 at 12:43 +0530, nilesh.kapile at tcs.com wrote:

> 
> Hello, 
> 
> I need to preserve comments and want to collect it in some data
> structure.  How can we do that in ANTLR? 
> 
> Currently, I've following rule for comments: 
> 
> LINE_COMMENT 
>     :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;} 
>     ; 

The easiest way os to use your own channel, say 2, which means the
parser will ignore them but they are preserved in the input stream
(actually they are when HIDDEN but that really means 'anything you want
to hide' and you specifically want to inspect comments. Then, when you
walk your tree (assuming you are using a tree but that is best), at any
point where the comments are required, you can search within the start
and stop tokens for the AST rule and find anything on channel 2, doing
with it as you will. You can also do this from the parser of course.

The other option is to pass the COMMENT token through as a normal token,
and create parser rules to assemble them at various points. The problem
here comes when the COMMENT can be anywhere, such as in the middle of
expressions, so the parser ends up having the COMMENT token everywhere
and complicates your grammar enormously.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/2b80d3c4/attachment.html 

From jimi at temporal-wave.com  Mon Jul 14 07:55:35 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Jul 2008 07:55:35 -0700
Subject: [antlr-interest] Can't find template ruleRefBang.st
In-Reply-To: <20080714122736.AB86B11ECC5@www.antlr.org>
References: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>
	<20080714122736.AB86B11ECC5@www.antlr.org>
Message-ID: <1216047335.26749.6.camel@jimi>

On Tue, 2008-07-15 at 00:27 +1200, Gavin Lambert wrote:

> At 23:37 14/07/2008, Guy Kroizman wrote:
> >I am trying to convert the Fortran77 grammar so I could use it 
> >with ANTLR 3.
> >I get the following error:
> >
> >kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool 
> >Fortran77.g
> >error(10):  internal error: Fortran77.g : 
> >java.lang.IllegalArgumentException: Can't find template 
> >ruleRefBang.st
> 
> IIRC, this has something to do with mixing tree construction 
> syntax illegally, most likely trying to use a ! in a rule that 
> already has a -> rewrite.
> 
> (Yeah, I know, it's not the best error message in the world.)
> 

It is much better in ANTLR 3.1 :-)

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/5c39067e/attachment.html 

From jens.boeykens at gmail.com  Mon Jul 14 08:27:26 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 14 Jul 2008 17:27:26 +0200
Subject: [antlr-interest] Don't know some tree walker rules for specific
	parser rules
Message-ID: <53c4e43f0807140827v78ae3628mb05b562edb42f56a@mail.gmail.com>

Hi,

What should be the walker rules for:

*A) r: (id -> id) ('+' id -> ^('+' r id))*;
B) r: (id -> ^(ARG id)) ('+' id -> ^('+' $r id))*;
C) r: (id -> ^(ARG id)) ('+' id -> ^('+' BLOCK id));*
*
*My suggestions:
A) r: id | ^('+' r id)*;
B) r: ^(ARG id) | ^('+' r id)*;
C) r: ^(ARG id) ^('+' BLOCK id);

Are these correct? Note that first 2 rules are using recursion and the third
does not.

Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/0276bd8e/attachment-0001.html 

From rkevinburton at charter.net  Mon Jul 14 09:40:35 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 14 Jul 2008 9:40:35 -0700
Subject: [antlr-interest] Invalid grammar name, translate to 3.0 Grammar.
Message-ID: <20080714124035.AJWCB.189658.root@fepweb13>

I have two problems. The first is related to the ECMA Script grammar submitted to the ANTLR Grammar page. I tried to load it into ANTLRWorks and several errors were generated:

The first is with:

grammar JavaScript;

ANTLRWorks indicates that this is not a valid grammar name. Why not? Where is a list of the "valid" grammar names?

The second question is resulting from trying to load several of the grammars from the ANTLR grammar page into ANTLRWorks (KCSParse is one example CSharpParser.g) and I get an error indicating that this grammar is not recognized as an ANTLR 3.x grammar. Is there a specification somewhere that can tell me how to translate "earlier" grammars to 3.x?

Thank you.

Kevin


From jimi at temporal-wave.com  Mon Jul 14 10:10:58 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Jul 2008 10:10:58 -0700
Subject: [antlr-interest] Invalid grammar name, translate to 3.0	Grammar.
In-Reply-To: <20080714124035.AJWCB.189658.root@fepweb13>
References: <20080714124035.AJWCB.189658.root@fepweb13>
Message-ID: <1216055458.26749.35.camel@jimi>

On Mon, 2008-07-14 at 09:40 -0700, rkevinburton at charter.net wrote:

> I have two problems. The first is related to the ECMA Script grammar submitted to the ANTLR Grammar page. I tried to load it into ANTLRWorks and several errors were generated:
> 
> The first is with:
> 
> grammar JavaScript;
> 
> ANTLRWorks indicates that this is not a valid grammar name. Why not? Where is a list of the "valid" grammar names?


Undoubtedly, you have used teh name JavaScript in your grammar statement
but have not used the same name when naming your source file, which
should be JavaScript.g

> 
> The second question is resulting from trying to load several of the grammars from the ANTLR grammar page into ANTLRWorks



>  (KCSParse is one example CSharpParser.g) and I get an error indicating that this grammar is not recognized as an ANTLR 3.x grammar. 



> Is there a specification somewhere that can tell me how to translate "earlier" grammars to 3.x?
> 


There is a conversion tool on the downloads page, but it is very
experimental right now, so the best thing is to do this by hand. Start
with the 3.x example downloads though, then you won't need to do this.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/f67c179b/attachment.html 

From jaluber at gmx.de  Mon Jul 14 10:19:41 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 14 Jul 2008 19:19:41 +0200
Subject: [antlr-interest] Invalid grammar name, translate to 3.0 Grammar.
In-Reply-To: <20080714124035.AJWCB.189658.root@fepweb13>
References: <20080714124035.AJWCB.189658.root@fepweb13>
Message-ID: <487B8AAD.9030603@gmx.de>

rkevinburton at charter.net schrieb:
> I have two problems. The first is related to the ECMA Script grammar submitted to the ANTLR Grammar page. I tried to load it into ANTLRWorks and several errors were generated:
> 
> The first is with:
> 
> grammar JavaScript;
> 
> ANTLRWorks indicates that this is not a valid grammar name. Why not? Where is a list of the "valid" grammar names?

The file name must be the same as the grammar name.
> 
> The second question is resulting from trying to load several of the grammars from the ANTLR grammar page into ANTLRWorks (KCSParse is one example CSharpParser.g) and I get an error indicating that this grammar is not recognized as an ANTLR 3.x grammar. Is there a specification somewhere that can tell me how to translate "earlier" grammars to 3.x?

There is a tool named v2Tov3 or something like that. It does most of the 
grunt work but it's not perfect.

Johannes
> 
> Thank you.
> 
> Kevin
> 


From vincedupuis at hotmail.com  Mon Jul 14 10:35:06 2008
From: vincedupuis at hotmail.com (Vincent Dupuis)
Date: Mon, 14 Jul 2008 13:35:06 -0400
Subject: [antlr-interest] Question about using antlr with stringtemplate
Message-ID: <BAY132-W1590C6678A691DEBD05EFAB68D0@phx.gbl>


Hello,

I'm using antlr with stringtemplate to generate the output.

with

options
{
    output=template;
}

The first rule doesn't create a stringtemplate and of course the getTemplate() function of the parser returns null.

I was wondering if it is possible to obtain the generated templates created by the other rules.

Thanks,
Vince


_________________________________________________________________

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/efc9b3a5/attachment.html 

From kroizguy at gmail.com  Mon Jul 14 11:37:46 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Mon, 14 Jul 2008 21:37:46 +0300
Subject: [antlr-interest] Can't find template ruleRefBang.st
In-Reply-To: <487b4638.0661220a.3257.4f4fSMTPIN_ADDED@mx.google.com>
References: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>
	<487b4638.0661220a.3257.4f4fSMTPIN_ADDED@mx.google.com>
Message-ID: <f5c59b030807141137y1161eeedsfef91cdcfbcfeb1b@mail.gmail.com>

I tried with 3.1b1
and got:

kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool Fortran77.g
Exception in thread "main" java.lang.NoClassDefFoundError:
org/antlr/stringtemplate/StringTemplateErrorListener
    at org.antlr.Tool.main(Tool.java:68)
Caused by: java.lang.ClassNotFoundException:
org.antlr.stringtemplate.StringTemplateErrorListener
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:323)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:268)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:336)
    ... 1 more

Does this makes more sense?

On Mon, Jul 14, 2008 at 3:27 PM, Gavin Lambert <antlr at mirality.co.nz> wrote:

> At 23:37 14/07/2008, Guy Kroizman wrote:
>
>> I am trying to convert the Fortran77 grammar so I could use it with ANTLR
>> 3.
>> I get the following error:
>>
>> kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool Fortran77.g
>> error(10):  internal error: Fortran77.g :
>> java.lang.IllegalArgumentException: Can't find template ruleRefBang.st
>>
>
> IIRC, this has something to do with mixing tree construction syntax
> illegally, most likely trying to use a ! in a rule that already has a ->
> rewrite.
>
> (Yeah, I know, it's not the best error message in the world.)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/5a0ed04b/attachment.html 

From jaluber at gmx.de  Mon Jul 14 12:00:55 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 14 Jul 2008 21:00:55 +0200
Subject: [antlr-interest] Can't find template ruleRefBang.st
In-Reply-To: <f5c59b030807141137y1161eeedsfef91cdcfbcfeb1b@mail.gmail.com>
References: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>	<487b4638.0661220a.3257.4f4fSMTPIN_ADDED@mx.google.com>
	<f5c59b030807141137y1161eeedsfef91cdcfbcfeb1b@mail.gmail.com>
Message-ID: <487BA267.8000804@gmx.de>

Guy Kroizman schrieb:
> I tried with 3.1b1
> and got:
> 
> kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool Fortran77.g
> Exception in thread "main" java.lang.NoClassDefFoundError: 
> org/antlr/stringtemplate/StringTemplateErrorListener
>     at org.antlr.Tool.main(Tool.java:68)
> Caused by: java.lang.ClassNotFoundException: 
> org.antlr.stringtemplate.StringTemplateErrorListener
>     at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
>     at java.security.AccessController.doPrivileged(Native Method)
>     at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
>     at java.lang.ClassLoader.loadClass(ClassLoader.java:323)
>     at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
>     at java.lang.ClassLoader.loadClass(ClassLoader.java:268)
>     at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:336)
>     ... 1 more
> 
> Does this makes more sense?

Look for ! mixed with ->, as Gavin said. Remove those ! in these rules.

Johannes
> 
> On Mon, Jul 14, 2008 at 3:27 PM, Gavin Lambert <antlr at mirality.co.nz 
> <mailto:antlr at mirality.co.nz>> wrote:
> 
>     At 23:37 14/07/2008, Guy Kroizman wrote:
> 
>         I am trying to convert the Fortran77 grammar so I could use it
>         with ANTLR 3.
>         I get the following error:
> 
>         kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool
>         Fortran77.g
>         error(10):  internal error: Fortran77.g :
>         java.lang.IllegalArgumentException: Can't find template
>         ruleRefBang.st
> 
> 
>     IIRC, this has something to do with mixing tree construction syntax
>     illegally, most likely trying to use a ! in a rule that already has
>     a -> rewrite.
> 
>     (Yeah, I know, it's not the best error message in the world.)
> 
> 


From jens.boeykens at gmail.com  Mon Jul 14 12:00:25 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 14 Jul 2008 21:00:25 +0200
Subject: [antlr-interest] Don't know some tree walker rules for specific
 parser rules
Message-ID: <487BA249.6060500@gmail.com>

Since I got a delivery notification mail I resend it once more just to 
be sure. Sorry if you did get the mail twice.
-------------- next part --------------
An embedded message was scrubbed...
From: "Jens Boeykens" <jens.boeykens at gmail.com>
Subject: Don't know some tree walker rules for specific parser rules
Date: Mon, 14 Jul 2008 17:27:26 +0200
Size: 1840
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/91685d10/attachment.eml 

From antlr at mirality.co.nz  Mon Jul 14 13:20:44 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 15 Jul 2008 08:20:44 +1200
Subject: [antlr-interest] Don't know some tree walker rules for specific
 parser rules
In-Reply-To: <53c4e43f0807140827v78ae3628mb05b562edb42f56a@mail.gmail.co
 m>
References: <53c4e43f0807140827v78ae3628mb05b562edb42f56a@mail.gmail.com>
Message-ID: <20080714202053.248B811EA9C@www.antlr.org>

At 03:27 15/07/2008, Jens Boeykens wrote:
>What should be the walker rules for:
>
>A) r: (id -> id) ('+' id -> ^('+' r id))*;
>B) r: (id -> ^(ARG id)) ('+' id -> ^('+' $r id))*;
>C) r: (id -> ^(ARG id)) ('+' id -> ^('+' BLOCK id));
>
>My suggestions:
>A) r: id | ^('+' r id)*;
>B) r: ^(ARG id) | ^('+' r id)*;
>C) r: ^(ARG id) ^('+' BLOCK id);
>
>Are these correct? Note that first 2 rules are using recursion 
>and the third does not.

Those look ok to me; except that the * probably ought to be a +, 
since you don't want to match nothing at all.  (The parser rule 
can't generate an empty tree, after all.)


From antlr at mirality.co.nz  Mon Jul 14 13:22:21 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 15 Jul 2008 08:22:21 +1200
Subject: [antlr-interest] Can't find template ruleRefBang.st
In-Reply-To: <f5c59b030807141137y1161eeedsfef91cdcfbcfeb1b@mail.gmail.co
 m>
References: <f5c59b030807140437q4f4f72aah21216b94ca6d880c@mail.gmail.com>
	<487b4638.0661220a.3257.4f4fSMTPIN_ADDED@mx.google.com>
	<f5c59b030807141137y1161eeedsfef91cdcfbcfeb1b@mail.gmail.com>
Message-ID: <20080714202227.C8E5E11EAEA@www.antlr.org>

At 06:37 15/07/2008, Guy Kroizman wrote:
>I tried with 3.1b1
>and got:
>
>kroiz at kroiz-desktop:~/Desktop/Fortran$ java org.antlr.Tool 
>Fortran77.g
>Exception in thread "main" java.lang.NoClassDefFoundError: 
>org/antlr/stringtemplate/StringTemplateErrorListener
>     at org.antlr.Tool.main(Tool.java:68)
>Caused by: java.lang.ClassNotFoundException: 
>org.antlr.stringtemplate.StringTemplateErrorListener
>     at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
>     at java.security.AccessController.doPrivileged(Native 
> Method)
>     at 
> java.net.URLClassLoader.findClass(URLClassLoader.java:205)
>     at java.lang.ClassLoader.loadClass(ClassLoader.java:323)
>     at 
> sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
>     at java.lang.ClassLoader.loadClass(ClassLoader.java:268)
>     at 
> java.lang.ClassLoader.loadClassInternal(ClassLoader.java:336)
>     ... 1 more

ANTLR 3.1 requires a different version of StringTemplate than 
3.0.1, so your CLASSPATH is probably wrong.

But as I said before, the original mistake was in your grammar, 
and is really simple to fix.


From rkevinburton at charter.net  Mon Jul 14 14:38:10 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 14 Jul 2008 14:38:10 -0700
Subject: [antlr-interest] Invalid grammar name, translate to 3.0 Grammar.
In-Reply-To: <487B8AAD.9030603@gmx.de>
Message-ID: <20080714173810.W8I5J.123247.root@fepweb02>

Thank you for the first tip.

Where do I get vTov3? I could not find anything like it on the ANTLR site.

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I have two problems. The first is related to the ECMA Script grammar submitted to the ANTLR Grammar page. I tried to load it into ANTLRWorks and several errors were generated:
> > 
> > The first is with:
> > 
> > grammar JavaScript;
> > 
> > ANTLRWorks indicates that this is not a valid grammar name. Why not? Where is a list of the "valid" grammar names?
> 
> The file name must be the same as the grammar name.
> > 
> > The second question is resulting from trying to load several of the grammars from the ANTLR grammar page into ANTLRWorks (KCSParse is one example CSharpParser.g) and I get an error indicating that this grammar is not recognized as an ANTLR 3.x grammar. Is there a specification somewhere that can tell me how to translate "earlier" grammars to 3.x?
> 
> There is a tool named v2Tov3 or something like that. It does most of the 
> grunt work but it's not perfect.
> 
> Johannes
> > 
> > Thank you.
> > 
> > Kevin
> > 
> 


From jimi at temporal-wave.com  Mon Jul 14 15:02:20 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Jul 2008 15:02:20 -0700
Subject: [antlr-interest] Invalid grammar name, translate to 3.0	Grammar.
In-Reply-To: <20080714174006.6NOMN.123291.root@fepweb02>
References: <20080714174006.6NOMN.123291.root@fepweb02>
Message-ID: <1216072940.26749.54.camel@jimi>

On Mon, 2008-07-14 at 14:40 -0700, rkevinburton at charter.net wrote:

> I could not find the tool on the download page. Would you mind giving me an exact URL?
> 
> Where are the v3 grammars? It seems that there is a page dedicated to contributed brammars but they are not separated out by v2 or v3.
> 
> Thank you.


1) Go to www.antlr.org
2) Click the "Download" link at the top of the page next to "home"
3) Read the page.

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080714/d666e051/attachment.html 

From kroizguy at gmail.com  Mon Jul 14 22:21:24 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Tue, 15 Jul 2008 08:21:24 +0300
Subject: [antlr-interest] Fwd:  Invalid grammar name,
	translate to 3.0 Grammar.
In-Reply-To: <20080714173810.W8I5J.123247.root@fepweb02>
References: <487B8AAD.9030603@gmx.de>
	<20080714173810.W8I5J.123247.root@fepweb02>
Message-ID: <f5c59b030807142221lfa49be4r740859f3460f617e@mail.gmail.com>

http://www.antlr.org/wiki/display/ANTLR3/Migrating+from+ANTLR+2+to+ANTLR+3

---------- Forwarded message ----------
From: <rkevinburton at charter.net>
Date: Tue, Jul 15, 2008 at 12:38 AM
Subject: Re: [antlr-interest] Invalid grammar name, translate to 3.0
Grammar.
To: Johannes Luber <jaluber at gmx.de>
Cc: antlr-interest at antlr.org


Thank you for the first tip.

Where do I get vTov3? I could not find anything like it on the ANTLR site.

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote:
> rkevinburton at charter.net schrieb:
> > I have two problems. The first is related to the ECMA Script grammar
submitted to the ANTLR Grammar page. I tried to load it into ANTLRWorks and
several errors were generated:
> >
> > The first is with:
> >
> > grammar JavaScript;
> >
> > ANTLRWorks indicates that this is not a valid grammar name. Why not?
Where is a list of the "valid" grammar names?
>
> The file name must be the same as the grammar name.
> >
> > The second question is resulting from trying to load several of the
grammars from the ANTLR grammar page into ANTLRWorks (KCSParse is one
example CSharpParser.g) and I get an error indicating that this grammar is
not recognized as an ANTLR 3.x grammar. Is there a specification somewhere
that can tell me how to translate "earlier" grammars to 3.x?
>
> There is a tool named v2Tov3 or something like that. It does most of the
> grunt work but it's not perfect.
>
> Johannes
> >
> > Thank you.
> >
> > Kevin
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080715/13ea69f0/attachment.html 

From barabucc at cs.unibo.it  Tue Jul 15 08:09:05 2008
From: barabucc at cs.unibo.it (Gioele Barabucci)
Date: Tue, 15 Jul 2008 17:09:05 +0200
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
References: <g586u7$kpa$1@ger.gmane.org> <1215802455.8615.203.camel@jimi>
Message-ID: <g5ieho$gbm$1@ger.gmane.org>

Jim Idle wrote:
> I really , once again, cannot stress too much the fact that new users
> should not use the inline 'quote' rules in the parser. They really send
> you down the wrong streets until you are completely familiar with the
> parser/lexer process. I look at your grammar and see the obvious
> problems, but I just don't see how new users would.
Could you please point me to guides or tutorials about the ANTLR lexer and
the correct "style" I should use to write token rules? I could not find
anything on the net.

> ID    : 'ID' ;
> ?IDENT : ('a'..'z' | 'A'..'Z')+ ;
> HASH  : '#'   // Many things prefix with HASH, differentiate them here
>                (  (FIX)=>FIX  { $type = FIX; }
>                   | (IMP)=>IMP {$type = IMP; }
>                   | // Neither keyword, sometimes HASH is just HASH and
> not pounds
>                )
>             ;
> 
> Now, in the parser use teh token names:
> 
> stmt: ID S idName S (IMP|FIX) EOF ;
> idName : HASH IDENT;

Thank you for this solution: I'll use in many similar cases I have in my
grammar.

Sadly, this solution solves the problem only where there is a precise char
that one can use to discriminate. What about this example where the text of
a keyword can be used in other rules:

stmt: ID S simple_name S ('#IMP'|'#FIX') EOF;

simple_name: NAME;
ID: 'id';
NAME: ('a'..'z')+
S: (' '|'\n')+

This grammar will recognise 'id ix #FIX' but will fail on 'id id #FIX' with
the usual MismatchedTokenException. They keyword 'id' cannot be recognized
as a NAME token.

Is there a way to tell ANTLR "look for the characters 'id' only when in the
ID token, in all the other cases classify it as NAME (or whatever fits
it)"?

This happens quite often in my grammar (obviously this is just a simple
test-case for my problems): I have many keywords that lose their special
meaning once they are not in a certain position.

-- 
Gioele Barabucci <barabucc at cs.unibo.it>


From jaluber at gmx.de  Tue Jul 15 08:41:39 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 15 Jul 2008 17:41:39 +0200
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
In-Reply-To: <g5ieho$gbm$1@ger.gmane.org>
References: <g586u7$kpa$1@ger.gmane.org> <1215802455.8615.203.camel@jimi>
	<g5ieho$gbm$1@ger.gmane.org>
Message-ID: <487CC533.7040306@gmx.de>

Gioele Barabucci schrieb:
> Jim Idle wrote:
>> I really , once again, cannot stress too much the fact that new users
>> should not use the inline 'quote' rules in the parser. They really send
>> you down the wrong streets until you are completely familiar with the
>> parser/lexer process. I look at your grammar and see the obvious
>> problems, but I just don't see how new users would.
> Could you please point me to guides or tutorials about the ANTLR lexer and
> the correct "style" I should use to write token rules? I could not find
> anything on the net.
> 
>> ID    : 'ID' ;
>> ?IDENT : ('a'..'z' | 'A'..'Z')+ ;
>> HASH  : '#'   // Many things prefix with HASH, differentiate them here
>>                (  (FIX)=>FIX  { $type = FIX; }
>>                   | (IMP)=>IMP {$type = IMP; }
>>                   | // Neither keyword, sometimes HASH is just HASH and
>> not pounds
>>                )
>>             ;
>>
>> Now, in the parser use teh token names:
>>
>> stmt: ID S idName S (IMP|FIX) EOF ;
>> idName : HASH IDENT;
> 
> Thank you for this solution: I'll use in many similar cases I have in my
> grammar.
> 
> Sadly, this solution solves the problem only where there is a precise char
> that one can use to discriminate. What about this example where the text of
> a keyword can be used in other rules:
> 
> stmt: ID S simple_name S ('#IMP'|'#FIX') EOF;
> 
> simple_name: NAME;
> ID: 'id';
> NAME: ('a'..'z')+
> S: (' '|'\n')+
> 
> This grammar will recognise 'id ix #FIX' but will fail on 'id id #FIX' with
> the usual MismatchedTokenException. They keyword 'id' cannot be recognized
> as a NAME token.
> 
> Is there a way to tell ANTLR "look for the characters 'id' only when in the
> ID token, in all the other cases classify it as NAME (or whatever fits
> it)"?
> 
> This happens quite often in my grammar (obviously this is just a simple
> test-case for my problems): I have many keywords that lose their special
> meaning once they are not in a certain position.
> 

It is not possible (yet?) to do context-dependent lexing. The solution 
is to add ID as possible alternative in those special positions.

Johannes

From barabucc at cs.unibo.it  Tue Jul 15 09:36:47 2008
From: barabucc at cs.unibo.it (Gioele Barabucci)
Date: Tue, 15 Jul 2008 18:36:47 +0200
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
References: <g586u7$kpa$1@ger.gmane.org> <1215802455.8615.203.camel@jimi>
	<g5ieho$gbm$1@ger.gmane.org> <487CC533.7040306@gmx.de>
Message-ID: <g5ijm6$588$1@ger.gmane.org>

Johannes Luber wrote:
>> Is there a way to tell ANTLR "look for the characters 'id' only when in
>> the ID token, in all the other cases classify it as NAME (or whatever
>> fits it)"?
>> 
>> This happens quite often in my grammar (obviously this is just a simple
>> test-case for my problems): I have many keywords that lose their special
>> meaning once they are not in a certain position.
>> 
> 
> It is not possible (yet?) to do context-dependent lexing. The solution
> is to add ID as possible alternative in those special positions.

That is a quite cumbersome workaround. What about comments? Suppose that I
add something like

comment: '/*' comment_text '*/' //I want to get the text inside the comment

then, regardless of what I write in the comment_text rules (like .*), it
will always match tokens and fails on things like '#III' in the previous
rule.

-- 
Gioele Barabucci <barabucc at cs.unibo.it>


From jaluber at gmx.de  Tue Jul 15 10:08:27 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 15 Jul 2008 19:08:27 +0200
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
In-Reply-To: <g5ijm6$588$1@ger.gmane.org>
References: <g586u7$kpa$1@ger.gmane.org>
	<1215802455.8615.203.camel@jimi>	<g5ieho$gbm$1@ger.gmane.org>
	<487CC533.7040306@gmx.de> <g5ijm6$588$1@ger.gmane.org>
Message-ID: <487CD98B.3040406@gmx.de>

Gioele Barabucci schrieb:
> Johannes Luber wrote:
>>> Is there a way to tell ANTLR "look for the characters 'id' only when in
>>> the ID token, in all the other cases classify it as NAME (or whatever
>>> fits it)"?
>>>
>>> This happens quite often in my grammar (obviously this is just a simple
>>> test-case for my problems): I have many keywords that lose their special
>>> meaning once they are not in a certain position.
>>>
>> It is not possible (yet?) to do context-dependent lexing. The solution
>> is to add ID as possible alternative in those special positions.
> 
> That is a quite cumbersome workaround. What about comments? Suppose that I
> add something like
> 
> comment: '/*' comment_text '*/' //I want to get the text inside the comment
> 
> then, regardless of what I write in the comment_text rules (like .*), it
> will always match tokens and fails on things like '#III' in the previous
> rule.
> 

You could try:

COMMENT: '/*' ( options{greedy=false;}: . )* '*/' {String txt = 
getText(); setText(txt.substring(2, txt.length() -2));} ;

Johannes

From andy at doddington.net  Tue Jul 15 10:45:27 2008
From: andy at doddington.net (Andy Doddington)
Date: Tue, 15 Jul 2008 18:45:27 +0100
Subject: [antlr-interest] Grammar for block comments?
Message-ID: <487CE237.1010302@doddington.net>

I am trying to write a grammar that includes support for C-style block
comments - i.e. bracketed by '/*' and '*/'.

I have taken the example in the cpp.g grammar on the antlr web site, which
appears as shown below:

	COMMENT: '/*'  ( options {greedy=false;} : . )*  '*/' { _channel=99; };

Unfortunately, when this encounters a comment containing asterisks, I get the error:

        line <line>:<column> mismatched character '*' expecting '/'

Is there any better solution, that avoids this problem?

Thanks,

    Andy D.




From jimi at temporal-wave.com  Tue Jul 15 11:11:24 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 15 Jul 2008 11:11:24 -0700
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
In-Reply-To: <g5ieho$gbm$1@ger.gmane.org>
References: <g586u7$kpa$1@ger.gmane.org> <1215802455.8615.203.camel@jimi>
	<g5ieho$gbm$1@ger.gmane.org>
Message-ID: <1216145484.26749.202.camel@jimi>

On Tue, 2008-07-15 at 17:09 +0200, Gioele Barabucci wrote:

> Jim Idle wrote:
> > I really , once again, cannot stress too much the fact that new users
> > should not use the inline 'quote' rules in the parser. They really send
> > you down the wrong streets until you are completely familiar with the
> > parser/lexer process. I look at your grammar and see the obvious
> > problems, but I just don't see how new users would.
> Could you please point me to guides or tutorials about the ANTLR lexer and
> the correct "style" I should use to write token rules? I could not find
> anything on the net.


You are probably best buying the book, but read the WIki articles that
come up if you search for 'lexer' and find an example grammar that dopes
something close to what you want - these will all help you.

> 
> > ID    : 'ID' ;
> > ?IDENT : ('a'..'z' | 'A'..'Z')+ ;
> > HASH  : '#'   // Many things prefix with HASH, differentiate them here
> >                (  (FIX)=>FIX  { $type = FIX; }
> >                   | (IMP)=>IMP {$type = IMP; }
> >                   | // Neither keyword, sometimes HASH is just HASH and
> > not pounds
> >                )
> >             ;
> > 
> > Now, in the parser use teh token names:
> > 
> > stmt: ID S idName S (IMP|FIX) EOF ;
> > idName : HASH IDENT;
> 
> Thank you for this solution: I'll use in many similar cases I have in my
> grammar.
> 
> Sadly, this solution solves the problem only where there is a precise char
> that one can use to discriminate. What about this example where the text of
> a keyword can be used in other rules:
> 
> stmt: ID S simple_name S ('#IMP'|'#FIX') EOF;
> 
> simple_name: NAME;
> ID: 'id';
> NAME: ('a'..'z')+
> S: (' '|'\n')+
> 
> This grammar will recognise 'id ix #FIX' but will fail on 'id id #FIX' with
> the usual MismatchedTokenException. They keyword 'id' cannot be recognized
> as a NAME token.


simple_name: NAME
 | ID // keyword as ID

    ->IDENT[$ID]            // If you want to rewrite it in a tree
;

Sometimes you can use hoisted predicates (see the example in the
downloadable example grammars). Sometimes you might need a predicate in
a rule that calls it, to say "definately see this as a variable", such
as:

... something ((simple_name)=>simple_name)? ID ID ID

> 
> Is there a way to tell ANTLR "look for the characters 'id' only when in the
> ID token, in all the other cases classify it as NAME (or whatever fits
> it)"?


Only if you can determine this fact from the lexer context. Remember
that the lexer runs first, then the parser runs afterwards.


> 
> This happens quite often in my grammar (obviously this is just a simple
> test-case for my problems): I have many keywords that lose their special
> meaning once they are not in a certain position.
> 

Just list them all in your simple name  (tip: don't add lots a t once,
add a few, build the grammar, resolve any ambiguities it causes, add a
few more etc). Build everything in small steps so you can identify
errors you introduce, as they happen.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080715/02e8dd04/attachment.html 

From jimi at temporal-wave.com  Tue Jul 15 12:31:49 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 15 Jul 2008 12:31:49 -0700
Subject: [antlr-interest] Tokens and literals: how to avoid conflics?
In-Reply-To: <g5ijm6$588$1@ger.gmane.org>
References: <g586u7$kpa$1@ger.gmane.org> <1215802455.8615.203.camel@jimi>
	<g5ieho$gbm$1@ger.gmane.org> <487CC533.7040306@gmx.de>
	<g5ijm6$588$1@ger.gmane.org>
Message-ID: <1216150309.26749.217.camel@jimi>

On Tue, 2008-07-15 at 18:36 +0200, Gioele Barabucci wrote:

> Johannes Luber wrote:
> >> Is there a way to tell ANTLR "look for the characters 'id' only when in
> >> the ID token, in all the other cases classify it as NAME (or whatever
> >> fits it)"?
> >> 
> >> This happens quite often in my grammar (obviously this is just a simple
> >> test-case for my problems): I have many keywords that lose their special
> >> meaning once they are not in a certain position.
> >> 
> > 
> > It is not possible (yet?) to do context-dependent lexing. The solution
> > is to add ID as possible alternative in those special positions.
> 
> That is a quite cumbersome workaround. What about comments? Suppose that I
> add something like
> 
> comment: '/*' comment_text '*/' //I want to get the text inside the comment


COMMENT: '/*' ( options {greedy=false; } : . )* '*/' ;

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080715/34a64f6c/attachment.html 

From jimi at temporal-wave.com  Tue Jul 15 12:35:46 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 15 Jul 2008 12:35:46 -0700
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <487CE237.1010302@doddington.net>
References: <487CE237.1010302@doddington.net>
Message-ID: <1216150546.26749.219.camel@jimi>

On Tue, 2008-07-15 at 18:45 +0100, Andy Doddington wrote:

> I am trying to write a grammar that includes support for C-style block
> comments - i.e. bracketed by '/*' and '*/'.
> 
> I have taken the example in the cpp.g grammar on the antlr web site, which
> appears as shown below:
> 
> 	COMMENT: '/*'  ( options {greedy=false;} : . )*  '*/' { _channel=99; };
> 
> Unfortunately, when this encounters a comment containing asterisks, I get the error:
> 
>         line <line>:<column> mismatched character '*' expecting '/'
> 
> Is there any better solution, that avoids this problem?


What version of ANTLR are you using here?

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080715/bdb140bc/attachment.html 

From andy at doddington.net  Tue Jul 15 12:54:18 2008
From: andy at doddington.net (Andy Doddington)
Date: Tue, 15 Jul 2008 20:54:18 +0100
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <1216150546.26749.219.camel@jimi>
References: <487CE237.1010302@doddington.net> <1216150546.26749.219.camel@jimi>
Message-ID: <487D006A.303@doddington.net>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080715/1560d9ba/attachment.html 

From antlr at mirality.co.nz  Tue Jul 15 13:40:58 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 16 Jul 2008 08:40:58 +1200
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <487CE237.1010302@doddington.net>
References: <487CE237.1010302@doddington.net>
Message-ID: <20080715204103.60D0E312964@www.antlr.org>

At 05:45 16/07/2008, Andy Doddington wrote:
 >	COMMENT: '/*'  ( options {greedy=false;} : . )*  '*/' {
 >_channel=99; };

That's a little out of date -- the "_channel=99" bit should 
actually be "$channel=HIDDEN", and the "greedy=false" option is 
unnecessary -- ".*" matching is always nongreedy by default.

 >Unfortunately, when this encounters a comment containing 
asterisks,
 >I get the error:
 >
 >        line <line>:<column> mismatched character '*' expecting
 >'/'
 >
 >Is there any better solution, that avoids this problem?

You could be more explicit about it:

COMMENT: '/*' (~'*' | '*' ~'/')* '*/' { $channel = HIDDEN; };


From rkevinburton at charter.net  Tue Jul 15 15:05:30 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Tue, 15 Jul 2008 15:05:30 -0700
Subject: [antlr-interest] ASTNode and ASTNodeFactory
Message-ID: <20080715180530.LYTYT.199704.root@fepweb14>

I couldn't find these mentioned anywhere on the site but apparently there used to be objects ASTNode and ASTNodeFactory (along with ASTFrame). I am using C#. Where did they go? What namespace should I look under?

Thank you.

Kevin

From jaluber at gmx.de  Tue Jul 15 15:19:21 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 16 Jul 2008 00:19:21 +0200
Subject: [antlr-interest] ASTNode and ASTNodeFactory
In-Reply-To: <20080715180530.LYTYT.199704.root@fepweb14>
References: <20080715180530.LYTYT.199704.root@fepweb14>
Message-ID: <487D2269.5070501@gmx.de>

rkevinburton at charter.net schrieb:
> I couldn't find these mentioned anywhere on the site but apparently there used to be objects ASTNode and ASTNodeFactory (along with ASTFrame). I am using C#. Where did they go? What namespace should I look under?

Could you mean class names in ANTLR 2.7.7? In 3.1 there are only 
CommonTreeAdapter and CommonTree.

Johannes
> 
> Thank you.
> 
> Kevin
> 


From passionist_81 at yahoo.co.uk  Wed Jul 16 07:14:43 2008
From: passionist_81 at yahoo.co.uk (faraz ahmed)
Date: Wed, 16 Jul 2008 14:14:43 +0000 (GMT)
Subject: [antlr-interest] help in antlr
Message-ID: <390245.40715.qm@web25905.mail.ukl.yahoo.com>

hi,
i m new user to antlr and beginer java programmer.I have spended almost a week in running and installing antlr tool.Then i used antlr with eclipse but to no avail .even i couldnt run my first programme using anltr.Using eclipse i have compiled my grammer file it makes a token file along with lexer.java and parser.java files.after that according to first tutorial i made Test java file but when i run these files 
ANTLR Parser Generator? Version 3.1b1 (May 20, 2008)? 1989-2008
error(100): Test.java:2:1: syntax error: antlr: Test.java:2:1: unexpected token: import
error(150):? grammar file Test.java has no rules
error(100): Test.java:0:0: syntax error: assign.types: <AST>:0:0: unexpected end of subtree
error(100): Test.java:0:0: syntax error: define: <AST>:0:0: unexpected end of subtree
errors r coming i dont know where things have gone wrong.
One thing more as i am beginner if there is any possibilty if example given should be easy like "hello world.java"? so that it will be easier for the beginners.
thanking you ,
phil




      __________________________________________________________
Not happy with your email address?.
Get the one you really want - millions of new email addresses available now at Yahoo! http://uk.docs.yahoo.com/ymail/new.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080716/cb44eab5/attachment.html 

From jens.boeykens at gmail.com  Wed Jul 16 07:41:59 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Wed, 16 Jul 2008 16:41:59 +0200
Subject: [antlr-interest] rule modifiers (private, public, protected,
	fragment) in tree walker
Message-ID: <53c4e43f0807160741t4a79d2dfyf6e1ea1fd3516c15@mail.gmail.com>

Hi,

If a modifier like private, public,... is defined for a rule in a parser,
should it be added to the corresponding walker? Or should it be removed?

Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080716/3b141e60/attachment.html 

From jens.boeykens at gmail.com  Wed Jul 16 08:18:55 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Wed, 16 Jul 2008 17:18:55 +0200
Subject: [antlr-interest] bug in ANTLRv3.g + bang after rule id in walker?
Message-ID: <53c4e43f0807160818q51030a4ahb1e1674ba033703c@mail.gmail.com>

Hi,

Is a bang ('!') in a parser rule (like "r! : b -> ^(...) ;") needed in the
corresponding walker rule "r!: ^(...)"  ? Or can it be removed?

Btw the bang was never added to the AST tree in "rule" in ANTLRv3.g. I added
it to the tree in order to be able to regenerate the bang.

Jens
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080716/0ff66435/attachment.html 

From craig at palantir.co.za  Wed Jul 16 06:56:13 2008
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Wed, 16 Jul 2008 15:56:13 +0200
Subject: [antlr-interest] Struggling with RewriteEmptyStreamException
Message-ID: <20080716155613.iyjn66mke8oc8sgo@webmail.palantir.co.za>

Hi,

I have scaled back to the following simple grammar.
I am trying to parse 'declare namespace ns1=...'

I cannot even get that simple part to work. I am not sure what I am doing wrong
in the rewrite rule. The C# target is throwing a RewriteEmptyStreamException
(token DECLARE) when I make a new token, and rewrite to a new empty token it
complains about the $i as the symbol and so on.

What am I missing?
Version 3.1b1.


grammar XQuery;

options {
   language=CSharp2;
   output=AST; }
tokens {
  DECLARE='declare';
  NAMESPACE='namespace';
  ROOT='//';
  SEPARATOR='/';
}

// parser rules.
query: declaration+ ;
declaration: DECLARE NAMESPACE i=IDENTIFIER '=' l=LITERAL ';' -> ^(DECLARE $i
$l) ;

// token section.
IDENTIFIER:			('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')* ;
INTEGER:			'0'..'9'+ ;
NEWLINE:			'\r'? '\n' ;
COMPARATOR:			'>'|'<'|'>='|'<='|'=';
LITERAL:			'"' LITERAL_CHAR* '"';
WS:					(' '|'\t'|'\n'|'\r')+ { $channel = HIDDEN; } ;
fragment
LITERAL_CHAR:		~('\"'|'\\') ;



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From parrt at cs.usfca.edu  Wed Jul 16 10:19:04 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 16 Jul 2008 10:19:04 -0700
Subject: [antlr-interest] bug in ANTLRv3.g + bang after rule id in
	walker?
In-Reply-To: <53c4e43f0807160818q51030a4ahb1e1674ba033703c@mail.gmail.com>
References: <53c4e43f0807160818q51030a4ahb1e1674ba033703c@mail.gmail.com>
Message-ID: <DD259F90-F588-4F17-95ED-2240E09439A8@cs.usfca.edu>

can remove for now.
T
On Jul 16, 2008, at 8:18 AM, Jens Boeykens wrote:

> Hi,
>
> Is a bang ('!') in a parser rule (like "r! : b -> ^(...) ;") needed  
> in the corresponding walker rule "r!: ^(...)"  ? Or can it be removed?
>
> Btw the bang was never added to the AST tree in "rule" in ANTLRv3.g.  
> I added it to the tree in order to be able to regenerate the bang.
>
> Jens


From parrt at cs.usfca.edu  Wed Jul 16 10:19:17 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 16 Jul 2008 10:19:17 -0700
Subject: [antlr-interest] rule modifiers (private, public, protected,
	fragment) in tree walker
In-Reply-To: <53c4e43f0807160741t4a79d2dfyf6e1ea1fd3516c15@mail.gmail.com>
References: <53c4e43f0807160741t4a79d2dfyf6e1ea1fd3516c15@mail.gmail.com>
Message-ID: <E2253B23-A6D8-4C9D-AC72-2CF4279E7DA6@cs.usfca.edu>

added.
T
On Jul 16, 2008, at 7:41 AM, Jens Boeykens wrote:

> Hi,
>
> If a modifier like private, public,... is defined for a rule in a  
> parser, should it be added to the corresponding walker? Or should it  
> be removed?
>
> Jens


From andy at doddington.net  Wed Jul 16 10:53:22 2008
From: andy at doddington.net (Andy Doddington)
Date: Wed, 16 Jul 2008 18:53:22 +0100
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
Message-ID: <487E3592.2010301@doddington.net>

Gavin Lambert wrote:
> At 05:45 16/07/2008, Andy Doddington wrote:
> >    COMMENT: '/*'  ( options {greedy=false;} : . )*  '*/' {
> >_channel=99; };
>
> That's a little out of date -- the "_channel=99" bit should actually 
> be "$channel=HIDDEN", and the "greedy=false" option is unnecessary -- 
> ".*" matching is always nongreedy by default.
>
> >Unfortunately, when this encounters a comment containing asterisks,
> >I get the error:
> >
> >        line <line>:<column> mismatched character '*' expecting
> >'/'
> >
> >Is there any better solution, that avoids this problem?
>
> You could be more explicit about it:
>
> COMMENT: '/*' (~'*' | '*' ~'/')* '*/' { $channel = HIDDEN; };
>
>
Your suggestion made a lot of sense - however, it doesn't seem to have 
had any effect on my problem, which seems
strange - even the error message is identical :-(

AD


From jaluber at gmx.de  Wed Jul 16 11:40:13 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 16 Jul 2008 20:40:13 +0200
Subject: [antlr-interest] Struggling with RewriteEmptyStreamException
In-Reply-To: <20080716155613.iyjn66mke8oc8sgo@webmail.palantir.co.za>
References: <20080716155613.iyjn66mke8oc8sgo@webmail.palantir.co.za>
Message-ID: <487E408D.5080306@gmx.de>

craig at palantir.co.za schrieb:
> Hi,
> 
> I have scaled back to the following simple grammar.
> I am trying to parse 'declare namespace ns1=...'
> 
> I cannot even get that simple part to work. I am not sure what I am doing wrong
> in the rewrite rule. The C# target is throwing a RewriteEmptyStreamException
> (token DECLARE) when I make a new token, and rewrite to a new empty token it
> complains about the $i as the symbol and so on.
> 
> What am I missing?
> Version 3.1b1.

Please rebuild the runtime - unfortunately the one included is slightly 
stale.

Johannes

> 
> grammar XQuery;
> 
> options {
>    language=CSharp2;
>    output=AST; }
> tokens {
>   DECLARE='declare';
>   NAMESPACE='namespace';
>   ROOT='//';
>   SEPARATOR='/';
> }
> 
> // parser rules.
> query: declaration+ ;
> declaration: DECLARE NAMESPACE i=IDENTIFIER '=' l=LITERAL ';' -> ^(DECLARE $i
> $l) ;
> 
> // token section.
> IDENTIFIER:			('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')* ;
> INTEGER:			'0'..'9'+ ;
> NEWLINE:			'\r'? '\n' ;
> COMPARATOR:			'>'|'<'|'>='|'<='|'=';
> LITERAL:			'"' LITERAL_CHAR* '"';
> WS:					(' '|'\t'|'\n'|'\r')+ { $channel = HIDDEN; } ;
> fragment
> LITERAL_CHAR:		~('\"'|'\\') ;
> 
> 
> 
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
> 
> 


From antlr at mirality.co.nz  Wed Jul 16 14:19:19 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 17 Jul 2008 09:19:19 +1200
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <487E3592.2010301@doddington.net>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
Message-ID: <20080716211932.76E9411ED8E@www.antlr.org>

At 05:53 17/07/2008, Andy Doddington wrote:
 >> COMMENT: '/*' (~'*' | '*' ~'/')* '*/' { $channel = HIDDEN; };
 >>
 >Your suggestion made a lot of sense - however, it doesn't seem 
to
 >have had any effect on my problem, which seems strange - even 
the
 >error message is identical :-(

Very strange; something like that has always worked for me.

Well, I suppose one more thing you could try is to force the 
lookahead with a synpred:

COMMENT
   : '/*'
     ( ~'*'
     | ('*' ~'/') => '*' ~'/'
     )*
     '*/'
   { $channel = HIDDEN; }
   ;


From camerons at microsoft.com  Wed Jul 16 22:36:51 2008
From: camerons at microsoft.com (Cameron Skinner)
Date: Wed, 16 Jul 2008 22:36:51 -0700
Subject: [antlr-interest] Bug in Generated Parser?
Message-ID: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>

Hello,

I'm using the 3.1 beta release, CSharp2 target grammar.

I'm seeing different behavior running my parser with a syntax error the second time run. I've tracked it down to where I believe the problem is, located in BaseRecognizer.cs. The "follow.Remove( Token.EOR_TOKEN_TYPE )" logic is being called, which modifies the state of the static readonly BitSet object found on the parser. The problem with that is that even though I am creating a completely different parser instance, the static variable has been altered for as long as the assembly is in memory. I've copied a simple program to illustrate the problem at the bottom of this mail.

Is this a known problem?

Regards,

Cameron

public bool MismatchIsMissingToken(IIntStream input, BitSet follow) {
                  if (follow == null) {
                        // we have no information about the follow; we can only consume
                        // a single token and hope for the best
                        return false;
                  }

                  // compute what can follow this grammar element reference
                  if (follow.Member(Token.EOR_TOKEN_TYPE)) {
                        if (state.followingStackPointer >= 0) { // remove EOR if we're not the start symbol
                              follow.Remove(Token.EOR_TOKEN_TYPE); <<<<<<<<< THIS IS THE PROBLEM, modifies static variable
                        }
                        BitSet viableTokensFollowingThisRule = ComputeContextSensitiveRuleFOLLOW();
                        follow = follow.Or(viableTokensFollowingThisRule);
                  }

                  // if current token is consistent with what could come after set
                  // then we know we're missing a token; error recovery is free to
                  // "insert" the missing token

                  // BitSet cannot handle negative numbers like -1 (EOF) so I leave EOR
                  // in follow set to indicate that the fall of the start symbol is
                  // in the set (EOF can follow).
                  if ( follow.Member(input.LA(1)) || follow.Member(Token.EOR_TOKEN_TYPE) ) {
                        return true;
                  }
                  return false;
            }

Simple program that exhibits the fundamental problem of trying to use a static  readonly member. The state of that member can change, just not the instance itself:

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
   class Program
   {
      static void Main( string[] args )
      {
         Testing t = new Testing();
         Console.WriteLine( Testing.test.isSet );

         Testing.test.isSet = true;
         Testing x = new Testing();

         Console.WriteLine( Testing.test.isSet );
      }
   }

   public class Testing
   {
      public static readonly Test test = new Test();
   }

   public class Test
   {
      public bool isSet = false;
   }
}


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080716/14a49ac1/attachment.html 

From davyd at fugro-fsi.com.au  Thu Jul 17 00:53:18 2008
From: davyd at fugro-fsi.com.au (Davyd Madeley)
Date: Thu, 17 Jul 2008 15:53:18 +0800
Subject: [antlr-interest] funny things with the generated C target
Message-ID: <1216281198.3033.26.camel@tc35>

Hi all,

I'm just getting started with using ANTLR. I wrote a grammar and knocked
together a quick tree walker in Python and everything looked good. Now
I'm looking to use the C target to build upon this parser.

I changed the language to C, generated and compiled the grammar. My
first problem was that I was unable to have a lexer rule named LT (?),
so I renamed it. Now it's segfaulting inside the generated code...

(gdb) r ../antlr-parse-1.def 
Starting program: /home/davyd/src/uniseis2/c/test ../antlr-parse-1.def

Program received signal SIGSEGV, Segmentation fault.
0x00fd6e42 in fillBuffer () from /home/davyd/install/lib/libantlr3c.so
(gdb) bt
#0  0x00fd6e42 in fillBuffer ()
from /home/davyd/install/lib/libantlr3c.so
#1  0x00fd721a in tokLT () from /home/davyd/install/lib/libantlr3c.so
#2  0x0804ac04 in phaseBlock (ctx=0x8fc19e8) at UniseisPhaseParser.c:527
#3  0x080489a0 in main (argc=1457883477, argv=0xb0ec8153)
    at SemanticChecker.c:56

I've attached my file, SemanticChecker.c, which currently does nothing
more than load and parse the file. I've also attached the grammar.

What might I be doing wrong?

Regards,
--davyd

-- 
Davyd Madeley        Software Engineer
Fugro Seismic Imaging, Perth Australia
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SemanticChecker.c
Type: text/x-csrc
Size: 1296 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/79a3f310/attachment-0001.bin 
-------------- next part --------------
grammar UniseisPhase;

options
{
	output=AST;
	language=C;
}

tokens
{
	PHASE;
	CARD;
	PARAMETER;
	MANUAL;
}

// the definition for a phase block
//     phase NAME { properties }
// phases can accept
//    - properties
//    - manual entries
//    - card definitions
phaseBlock
	: 'phase' UNISEIS_NAME LINE_TERMINATOR? '{' LINE_TERMINATOR* (phaseDefinition LINE_TERMINATOR*)* '}'
	-> ^(PHASE UNISEIS_NAME phaseDefinition*)
	;

phaseDefinition
	: propertyAssignment
	| cardBlock
	| MANUAL_XML
	;

// the definition for a card block
//     card NAME { properties }
// cards can accept:
//    - properties
//    - manual entries
//    - parameter definitions
cardBlock
	: 'card' UNISEIS_NAME LINE_TERMINATOR? '{' LINE_TERMINATOR* (cardDefinition LINE_TERMINATOR*)* '}'
	-> ^(CARD UNISEIS_NAME cardDefinition*)
	;

cardDefinition
	: propertyAssignment
	| parameterBlock
	| MANUAL_XML
	;

// the definition for a parameter block:
//     parameter NAME { properties }
// parameters can accept:
//    - properties
//    - manual entries
parameterBlock
	: 'parameter' UNISEIS_NAME LINE_TERMINATOR? '{' LINE_TERMINATOR* (parameterDefinition LINE_TERMINATOR*)* '}'
	-> ^(PARAMETER UNISEIS_NAME parameterDefinition*)
	;

parameterDefinition
	: propertyAssignment
	| MANUAL_XML
	;

// rule for a property assignment
// properties are assigned using the syntax:
//    property: value
propertyAssignment
	: PROPERTY ':' values LINE_TERMINATOR
	-> ^(PROPERTY values)
	;

// these are the different types of values a property can take
fragment
values
	: STRING
	| DATE
	| BOOLEAN
	;

// These are the lexer rules
// Note that ORDER MATTERS, that is to say, the top-most rule will be matched first
// specific rules should go before generic rules
STRING
	: '"' ~('"')* '"'
	;

MANUAL_XML
	: '<manual>' .* '</manual>'
	;

BOOLEAN
	: 'true'
	| 'false'
	;

DATE
	: DIGIT DIGIT DIGIT DIGIT '-' DIGIT DIGIT '-' DIGIT DIGIT
	;

UNISEIS_NAME
	: ('A'..'Z')('A'..'Z'|DIGIT)+
	;

PROPERTY
	: ('a'..'z')('a'..'z'|'-')*
	;

fragment
DIGIT
	: '0'..'9'
	;

WS // Tab, vertical tab, form feed, space, non-breaking space and any other unicode "space separator".
	: ('\t' | '\v' | '\f' | ' ' | '\u00A0') {$channel=HIDDEN;}
	;

COMMENT
	: '/*' (options {greedy=false;} : . )* '*/' {$channel=HIDDEN;}
	;

LINE_COMMENT
	: '//' ~('\n'|'\r')* LINE_TERMINATOR {$channel=HIDDEN;}
	;

LINE_TERMINATOR
	: '\n'		// Line feed
	| '\r'		// Carriage return
	| '\u2028'	// Line separator
	| '\u2029'	// Paragraph separator
	;

From andy at doddington.net  Thu Jul 17 00:56:32 2008
From: andy at doddington.net (Andy Doddington)
Date: Thu, 17 Jul 2008 08:56:32 +0100
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
Message-ID: <487EFB30.8070308@doddington.net>

Gavin Lambert wrote:
> At 05:53 17/07/2008, Andy Doddington wrote:
> >> COMMENT: '/*' (~'*' | '*' ~'/')* '*/' { $channel = HIDDEN; };
> >>
> >Your suggestion made a lot of sense - however, it doesn't seem to
> >have had any effect on my problem, which seems strange - even the
> >error message is identical :-(
>
> Very strange; something like that has always worked for me.
>
> Well, I suppose one more thing you could try is to force the lookahead 
> with a synpred:
>
> COMMENT
>   : '/*'
>     ( ~'*'
>     | ('*' ~'/') => '*' ~'/'
>     )*
>     '*/'
>   { $channel = HIDDEN; }
>   ;
>
>
I haven't had a chance to test this in my app, but when I run it inside 
AntlrWorks I get a:

            FailedPredicateException(COMMENT, {synpred1}?)

As an aside, doesn't the fact that this relatively simple case seems so 
hard to crack indicate that Antlr may have
a problem? I offer this as a humble suggestion from a complete newbie - 
it seems like a great tool otherwise! :-)

AD

From antlr at mirality.co.nz  Thu Jul 17 01:23:43 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 17 Jul 2008 20:23:43 +1200
Subject: [antlr-interest] funny things with the generated C target
In-Reply-To: <1216281198.3033.26.camel@tc35>
References: <1216281198.3033.26.camel@tc35>
Message-ID: <20080717082355.5EB5711ED49@www.antlr.org>

At 19:53 17/07/2008, Davyd Madeley wrote:
 >My first problem was that I was unable to have a lexer rule
 >named LT (?), so I renamed it.

This is because "LT" is the name of an internal function 
(specifically, one that gets a specific Lookahead token Type).

 >Program received signal SIGSEGV, Segmentation fault.
 >0x00fd6e42 in fillBuffer () from
 >/home/davyd/install/lib/libantlr3c.so

Problems in there are probably either due to recursive or 
zero-consuming token definitions, although I didn't spot any of 
those in the grammar you attached.

 >#0  0x00fd6e42 in fillBuffer ()
 >from /home/davyd/install/lib/libantlr3c.so
 >#1  0x00fd721a in tokLT () from
 >/home/davyd/install/lib/libantlr3c.so
 >#2  0x0804ac04 in phaseBlock (ctx=0x8fc19e8) at
 >UniseisPhaseParser.c:527
 >#3  0x080489a0 in main (argc=1457883477, argv=0xb0ec8153)
 >    at SemanticChecker.c:56

I'm not sure what the problem would be here.  Have you tried 
compiling the library in debug mode so that you can step through 
the code and work out what it's doing?

And which version of ANTLR and the runtime are you using?  Are you 
sure the versions match?


From jimi at temporal-wave.com  Thu Jul 17 01:24:31 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 01:24:31 -0700
Subject: [antlr-interest] funny things with the generated C target
In-Reply-To: <1216281198.3033.26.camel@tc35>
References: <1216281198.3033.26.camel@tc35>
Message-ID: <1216283071.7476.4.camel@jimi>

On Thu, 2008-07-17 at 15:53 +0800, Davyd Madeley wrote:

>         tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
>                         lexer);
>         if (!tokens)
>         {
>                 fprintf (stderr, "ERROR: could not generate token
> stream\n");
>                 exit (1);
>         }


Please consult the examples and API documentation and turn up the
warning levels on your compiler. The input to the token stream is not
the lexer, but the lexer token set.

tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
TOKENSOURCE(lexer));

(Note that TOKENSOURCE is for Antlr 3.1 and above, which you should
probably use now.

I am really surprised that your C compiler didn't give you a warning
about this - what compiler is it?

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/3f9d5b89/attachment.html 

From davyd at fugro-fsi.com.au  Thu Jul 17 01:33:36 2008
From: davyd at fugro-fsi.com.au (Davyd Madeley)
Date: Thu, 17 Jul 2008 16:33:36 +0800
Subject: [antlr-interest] funny things with the generated C target
In-Reply-To: <1216283071.7476.4.camel@jimi>
References: <1216281198.3033.26.camel@tc35>  <1216283071.7476.4.camel@jimi>
Message-ID: <1216283616.3033.33.camel@tc35>

On Thu, 2008-07-17 at 01:24 -0700, Jim Idle wrote:
> On Thu, 2008-07-17 at 15:53 +0800, Davyd Madeley wrote:
> >         tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
> >                         lexer);
> >         if (!tokens)
> >         {
> >                 fprintf (stderr, "ERROR: could not generate token
> > stream\n");
> >                 exit (1);
> >         }
> 
> Please consult the examples and API documentation and turn up the
> warning levels on your compiler. The input to the token stream is not
> the lexer, but the lexer token set.
> 
> tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
> TOKENSOURCE(lexer));
> 
> (Note that TOKENSOURCE is for Antlr 3.1 and above, which you should
> probably use now.

Aah, I'm using version 3.0.1 of the C runtime, which explains why this
symbol wasn't present. I thought that was strange, but took it out and
then forgot to chase up what I should be using instead.

I can't locate the 3.1 runtime. Where should I be looking?

> I am really surprised that your C compiler didn't give you a warning
> about this - what compiler is it?

GCC. Actually now I look, I did get a warning for that. I'm clearly
still jetlagged.

Thanks for your help so far.

--d

-- 
Davyd Madeley        Software Engineer
Fugro Seismic Imaging, Perth Australia


From antlr at mirality.co.nz  Thu Jul 17 01:38:22 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 17 Jul 2008 20:38:22 +1200
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <487EFB30.8070308@doddington.net>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
	<487EFB30.8070308@doddington.net>
Message-ID: <20080717083830.4BB20352294@www.antlr.org>

At 19:56 17/07/2008, Andy Doddington wrote:
 >I haven't had a chance to test this in my app, but when I run it 

 >inside AntlrWorks I get a:
 >
 >            FailedPredicateException(COMMENT, {synpred1}?)

ANTLRworks reacts strangely to predicates sometimes, so it could 
just be that.  But another thing you could try is to reverse the 
order of the alts within the * block.

 >As an aside, doesn't the fact that this relatively simple case
 >seems so hard to crack indicate that Antlr may have a problem?

Yes, ANTLR does indeed have a problem :)  And it's probably this 
one:

   http://www.antlr.org:8888/browse/ANTLR-189

(This issue has been one of my pet peeves for a 
while.  Fortunately I've managed to work around it in most cases 
by doing the sorts of things I've been suggesting to you: merging 
lexer rules, avoiding .s, and introducing explicit syntactic 
predicates.)


From alatif at handson.com  Thu Jul 17 03:25:08 2008
From: alatif at handson.com (Amir Latif)
Date: Thu, 17 Jul 2008 03:25:08 -0700
Subject: [antlr-interest] [ANTLR] Translating from one language to another
Message-ID: <A93350664326264C931D3A835A1DC54706C7FFE6@att-corpexch03.mforma.com>

Hello,

I've been doing some reading on how to write a translator to take code
from say, Java -> C++ and Java -> Actionscript etc.

My reading has led me to the really nifty looking ANTLR.  I was assuming
that code translation between languages was a more commonly tackled
problem but there doesn't appear to be much literature out there
covering the topic.

Is this something that is easily accomplished using ANTLR, as I suspect?
If so, could someone please point me in the right direction for reading
material if there is any?

many thanks,
amir.

From jaluber at gmx.de  Thu Jul 17 05:51:15 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 17 Jul 2008 14:51:15 +0200
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
Message-ID: <487F4043.5000801@gmx.de>

Cameron Skinner schrieb:
> Hello,
> 
>  
> 
> I?m using the 3.1 beta release, CSharp2 target grammar.
> 
>  
> 
> I?m seeing different behavior running my parser with a syntax error the 
> second time run. I?ve tracked it down to where I believe the problem is, 
> located in BaseRecognizer.cs. The ?follow.Remove( Token.EOR_TOKEN_TYPE 
> )? logic is being called, which modifies the state of the static 
> readonly BitSet object found on the parser. The problem with that is 
> that even though I am creating a completely different parser instance, 
> the static variable has been altered for as long as the assembly is in 
> memory. I?ve copied a simple program to illustrate the problem at the 
> bottom of this mail.
> 
>  
> 
> Is this a known problem?

I haven't heard of it yet, but it's a Java target problem, too, so Ter 
has to say, if removing the static modifier for the BitSet variables in 
the parser is enough and doesn't affect anything else.

Johannes

>  
> 
> Regards,
> 
>  
> 
> Cameron
> 
>  
> 
> public bool MismatchIsMissingToken(IIntStream input, BitSet follow) {
> 
>                   if (follow == null) {
> 
>                         // we have no information about the follow; we 
> can only consume
> 
>                         // a single token and hope for the best
> 
>                         return false;
> 
>                   }
> 
>  
> 
>                   // compute what can follow this grammar element reference
> 
>                   if (follow.Member(Token.EOR_TOKEN_TYPE)) {
> 
>                         if (state.followingStackPointer >= 0) { // 
> remove EOR if we're not the start symbol
> 
>                               follow.Remove(Token.EOR_TOKEN_TYPE); 
> *<<<<<<<<< THIS IS THE PROBLEM, modifies static variable*
> 
>                         }
> 
>                         BitSet viableTokensFollowingThisRule = 
> ComputeContextSensitiveRuleFOLLOW();
> 
>                         follow = follow.Or(viableTokensFollowingThisRule);
> 
>                   }
> 
>  
> 
>                   // if current token is consistent with what could come 
> after set
> 
>                   // then we know we're missing a token; error recovery 
> is free to
> 
>                   // "insert" the missing token
> 
>  
> 
>                   // BitSet cannot handle negative numbers like -1 (EOF) 
> so I leave EOR
> 
>                   // in follow set to indicate that the fall of the 
> start symbol is
> 
>                   // in the set (EOF can follow).
> 
>                   if ( follow.Member(input.LA(1)) || 
> follow.Member(Token.EOR_TOKEN_TYPE) ) {
> 
>                         return true;
> 
>                   }
> 
>                   return false;
> 
>             }
> 
>  
> 
> Simple program that exhibits the fundamental problem of trying to use a 
> static  readonly member. The state of that member can change, just not 
> the instance itself:
> 
>  
> 
> using System;
> 
> using System.Collections.Generic;
> 
> using System.Linq;
> 
> using System.Text;
> 
>  
> 
> namespace ConsoleApplication2
> 
> {
> 
>    class Program
> 
>    {
> 
>       static void Main( string[] args )
> 
>       {
> 
>          Testing t = new Testing();
> 
>          Console.WriteLine( Testing.test.isSet );
> 
>  
> 
>          Testing.test.isSet = true;
> 
>          Testing x = new Testing();
> 
>  
> 
>          Console.WriteLine( Testing.test.isSet );
> 
>       }
> 
>    }
> 
>  
> 
>    public class Testing
> 
>    {
> 
>       public static readonly Test test = new Test();
> 
>    }
> 
>  
> 
>    public class Test
> 
>    {
> 
>       public bool isSet = false;
> 
>    }
> 
> }
> 
>  
> 
>  
> 


From jimi at temporal-wave.com  Thu Jul 17 09:30:01 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 09:30:01 -0700
Subject: [antlr-interest] funny things with the generated C target
In-Reply-To: <1216283616.3033.33.camel@tc35>
References: <1216281198.3033.26.camel@tc35>  <1216283071.7476.4.camel@jimi>
	<1216283616.3033.33.camel@tc35>
Message-ID: <1216312201.7476.9.camel@jimi>

On Thu, 2008-07-17 at 16:33 +0800, Davyd Madeley wrote:

> On Thu, 2008-07-17 at 01:24 -0700, Jim Idle wrote:
> > On Thu, 2008-07-17 at 15:53 +0800, Davyd Madeley wrote:
> > >         tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
> > >                         lexer);
> > >         if (!tokens)
> > >         {
> > >                 fprintf (stderr, "ERROR: could not generate token
> > > stream\n");
> > >                 exit (1);
> > >         }
> > 
> > Please consult the examples and API documentation and turn up the
> > warning levels on your compiler. The input to the token stream is not
> > the lexer, but the lexer token set.
> > 
> > tokens = antlr3CommonTokenStreamSourceNew (ANTLR3_SIZE_HINT,
> > TOKENSOURCE(lexer));
> > 
> > (Note that TOKENSOURCE is for Antlr 3.1 and above, which you should
> > probably use now.
> 
> Aah, I'm using version 3.0.1 of the C runtime, which explains why this
> symbol wasn't present. I thought that was strange, but took it out and
> then forgot to chase up what I should be using instead.
> 
> I can't locate the 3.1 runtime. Where should I be looking?


I would make this an FAQ but one of the main FAQ's seems to be "how do I
find the FAQ" as it is all over the Wiki ;-):

On the main ANTLR web page, you will see the section "Documentation".
There you will find "ANTLR API Documentation", under that link you will
find "C API". On the front page of this, you will see "Building from
Source"

To get the distribution, either download the source package from the
ANTLR Downloads page - linked from ANTLR main page (look for Snapshot
releases if you want the latest beta). Or if you want to use Fisheye go
to:

http://fisheye2.atlassian.com/browse/antlr/runtime/C/dist/

The link to the name is the link to the revision history, not the
download, to download, click on the, err, Download icon. This is
admittedly tiny and I think a lot of people have a problem spotting it,
but under the REV column, there is a downward pointing arrow ICON. Hover
over it and it says "Download".

Also, take note of the Search box in the middle of the main ANTLR page,
where typing "C download" yields this page in the WIki as the first
link:

http://www.antlr.org/wiki/display/ANTLR3/Using+the+ANTLR3+C+Target

There, there is a heading "Finding the source code", where it gives all
of this information in excruciating detail.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/509aa0c0/attachment-0001.html 

From jimi at temporal-wave.com  Thu Jul 17 09:37:41 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 09:37:41 -0700
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <20080717083830.4BB20352294@www.antlr.org>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
	<487EFB30.8070308@doddington.net>
	<20080717083830.4BB20352294@www.antlr.org>
Message-ID: <1216312661.7476.13.camel@jimi>

On Thu, 2008-07-17 at 20:38 +1200, Gavin Lambert wrote:

> At 19:56 17/07/2008, Andy Doddington wrote:
>  >I haven't had a chance to test this in my app, but when I run it 
> 
>  >inside AntlrWorks I get a:
>  >
>  >            FailedPredicateException(COMMENT, {synpred1}?)
> 
> ANTLRworks reacts strangely to predicates sometimes, so it could 
> just be that.  But another thing you could try is to reverse the 
> order of the alts within the * block.
> 

Well, with ANTLR Works 1.2b5, the following grammar works perfectly:

grammar test;

prog:	(COMMENT | OTHER)+ ;

COMMENT
	:	 '/*' (options {greedy = false;} : .)* '*/' ;
	
OTHER 
	:	 .
	;
	
Using input:

/* XYZ * */
SOME OTHER STUF F*/

What version of ANTLR are you using again? I use this same construct in
quite a number of grammars and have not had problems with it. Perhaps
there is something else in your lexer spec that is interfering?

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/5a8abb89/attachment.html 

From parrt at cs.usfca.edu  Thu Jul 17 11:20:35 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 17 Jul 2008 11:20:35 -0700
Subject: [antlr-interest] announcing new OpenJDK project: ANTLR grammar for
	javac
Message-ID: <044803F8-6F81-430A-8554-D44FDA1785C1@cs.usfca.edu>

Hi,

http://openjdk.java.net/projects/compiler-grammar/

"The goal of this Project is to develop an experimental version of the  
javac compiler based upon a grammar written in ANTLR."

My graduate student Yang Jiang is currently building a version of  
javac the uses and ANTLR Java grammar instead of the handbuilt parser  
in there now. He has made amazing progress.

Terence

From yotommy at gmail.com  Thu Jul 17 12:33:44 2008
From: yotommy at gmail.com (Tom Smith)
Date: Thu, 17 Jul 2008 15:33:44 -0400
Subject: [antlr-interest] ANTLRWorks with output=template
Message-ID: <82dc0d190807171233x145908d4n812419527db896f@mail.gmail.com>

Hello,

I am trying to use ANTLRWorks (1.1.7 or 1.2b5) to debug a tree grammar that
generates output via StringTemplate.  However when I use Remote Debugging,
as soon as I encounter a rule that generates a template via a rewrite rule,
the Java process running the tree parser exits with a NullPointerException.

I have ensured that the driver program does indeed have a valid instance of
a StringTemplateGroup.  Is there something else I must do to be able to
debug this tree grammar in ANTLRWorks (short of commenting out all the
rewrite rules)?

Thanks,
Tom.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/8e176828/attachment.html 

From jimi at temporal-wave.com  Thu Jul 17 12:35:46 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 12:35:46 -0700
Subject: [antlr-interest] Bug fixes in C target for ANTLR 3.1b2
Message-ID: <1216323346.7476.164.camel@jimi>

C Target Update for ANTLR 3.1 Beta 2

For ANTLR 3.1 beta 2, the following bugs have been address in the C
target, as well as other minor bugs without JIRA entries. If you feel
that you have reported an error that is not shown as fixed here, then
please let me know as soon as you can and I will try to include fixes
for all outstanding bugs, at the very least before we release 3.1. 

Once again, I will make a rather futile request for someone to write
unit tests for the C runtime. It is rarely a good idea for the
programmer to write their own unit tests, though I will try to put some
regression tests in place, if there are no volunteers.

Please see general announcement for Beta 2 for downloading instructions.
Hint: Try the download link from the main ANTLR page - look for the
snapshot/interim releases if you want bug fixes AFTER the official Beta
2.

Bug fixes - reported by users


ANTLR-277, ANTLR-290 - Template incorrectly referred to <name> rather
than <rule> causing incorrect code gen.
ANTLR-289 - Casting of rewrite exception message was missing, causing C
++ compilers to complain.
ANTLR-278 - Pop of a stacked input stream that was sitting at EOF would
cause premature end of input stream.
ANTLR-280 - Potentially, a token without any associated text could cause
the default error display function to de-reference NULL.
ANTLR-281 - Code generation template missing from all targets added.
ANTLR-282 - Ensure that NULL guards are removed from attribute/label
access - causes  parsing failures in all targets
ANTLR-283 - Invalid options for lexer only grammar cause incorrect code
generation. (Note that an ANTLR fix is also required for this to work,
but that this fix might be to reject the grammar because it has invalid
options for lexer grammar).
ANTLR-284 - Change error recovery to reflect Java runtime improvements
ANTLR-308 - #ifdef __cplusplus } #endif #endif generated in wrong order.


Bug fixes - not reported by users

ANTLR-285 - Ensure that all examples are up to date with ANTLR 3.1b2
[No JIRA bug] - Debugger did not send all signals correctly to ANTLR
Works


Still outstanding

ANTLR-275 - Memory free of rewrite streams can cause double release
Tree walkers encountering syntax errors in the tree inadvertently
release the wrong memory pointer
Other minor bugs as per C Target Bug List
ANTLR-276 - Finish ANTLRWorks debugger testing - volunteers?

Improvements/Enhancements

Configure uses more stringent checks for headers (compile vs
pre-process)

ANTLR debugger code only included in debug version by default unless
configure is told to include it anyway. This removes the dependency on
socket libraries for released versions of the runtime library. Use
option --enable-antlrdebug/--disable-antlrdebug on UNIX, use #define
ANTLR3_NODEBUGGER on Windows (though this is less relevant).

All initialization of follow sets (bit maps) is removed from parser
startup, which reduces generated code size and startup times
substantially for large grammars. Bitsets are loaded dynamically from
static bit list declarations during error recovery.

AST building performance improvements. AST rewrite nodes were being
created with a description string to say where they came from. These
were all constructing pANTLR3_STRINGs, which is a huge overhead given
that a user would virtually never use these strings. These nodes now
just store the pointer to the static string in the generated code. Need
to consider an option to not generate things like these description
strings unless -debug mode is turned on. This will potentially reduce
code size for all targets.


Improvements Scheduled for Next Beta/Release Version

A number of things are too important to leave until 3.2.

ANTLR-279 - Building and rewriting of ASTs via abstract interfaces got
lost along the way somewhere int he previous release. For final release
of 3.1, this will all be corrected such that you can once again build
trees of any node type and so on. At least one user is waiting for this
- apologies that this did not make it in to this beta, it is important.

In relation the tree building via rewrite stream improvement already
completed, there are often a lot of createTokenText() calls. For
instance all the imaginary nodes and tree root nodes can be subject to
this. At the moment such nodes create pANTLR3_STRING which is quite
expensive considering that in general, only ANTLRWorks wants to know
about the text values. Hence tokens will be changed to use unions and
either store just a pointer to static strings OR a pointer to
pANTLR3_STRING (but this will only be present it setText is called on
the token by the user actions in lexers). For large trees, such as
complete translation units for programming languages, this should
provide significant performance improvements for AST building parsers
and tree parsers.

Memory allocation policy. This will change to malloc rather than calloc,
with specific initializations when necessary. Prior to recent
performance improvements the implied memset() for calloc was a minor
overhead. However, this has now moved to be about 11% of all parse time.
Experiments show that a lot of the memory is then initialized with
function pointers anyway and so it will be a worthwhile improvement to
abandon calloc in favor of malloc. Not sure why I did that in the first
place - there must have been some reason - I better check my
comments ;-)

AST node memory allocations. Though almost all elements of the C runtime
are allocated via factories, certain vectors used for rewriting AST node
children are not allocated from a vector factory. Once memset overhead
is removed, this is the single biggest performance overhead for building
ASTs, although by this point there is almost nothing left to optimize
and it really just appears to be an overhead when considered as part of
relative execution times. Worth improving upon though.

Much better C++ integration via supplied C++ class facades for the more
the most frequently used parts of a C parser and probably generated
class facades for the lexer/parser/etc themselves.

Code clean up, comment review and API docs. These will all be verified
and made complete, as well as applying consistent formatting across all
source codes. 


ANTLR 3.2 (C runtime)


I feel, but have not verified, that the overhead in being able to
override every method of every construct in the C runtime is not worth
the performance penalty for many applications, hence I am going to
experiment with a C-lite runtime, that is much closer to the metal and
abandons any concept of reflecting the Java runtime. If you are happy
with the AST structures and walkers that it would produce, and do not
need custom tokens, nodes and LA/LT etc, then this will be both smaller
and faster. For instance input streams will run directly against memory
pointers, trees will be simpler memory structures and so on. It won't
manage memory for you very automatically, but you will be as close to
the metal as can be. I will produce this runtime if experiments show any
significant performance benefits.


C++ Target news

As soon as this release is complete, I will put some major effort into a
true C++ target. Though I may abandon this idea after playing, I am
going to look into producing an ANTLR runtime target generator for
object oriented languages. The idea being that by specifying some
general policies for code generation you could produce say a C++ runtime
directly from the Java runtime source. Such things are fraught with
difficulty so this would not be a general converter of Java to X, and
will probably not be template driven in general (as much as I like that
idea) - consider it an experiment that may not come off if I cannot make
it generate a runtime that is close to one I would write myself. Either
way, I will produce a fully functional C++ target.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/de96c182/attachment.html 

From parrt at cs.usfca.edu  Thu Jul 17 12:37:36 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 17 Jul 2008 12:37:36 -0700
Subject: [antlr-interest] ANTLR v3.1b2 released
Message-ID: <B0D96823-006D-49EA-96D0-F03CFAAFA197@cs.usfca.edu>

Hi,

ANTLR v3.1b2 available...

http://www.antlr.org/download.html

Shooting for a much quicker b3 then full 3.1 (early August?).

Release notes:

http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.1+Release+Notes

Ter

From craig at palantir.co.za  Thu Jul 17 13:15:20 2008
From: craig at palantir.co.za (Craig Main)
Date: Thu, 17 Jul 2008 22:15:20 +0200
Subject: [antlr-interest] Lexer error handling,
Message-ID: <007901c8e849$d643e6d0$82cbb470$@co.za>

Hi,

 

I have made the necessary override and @rulecatch changes to ensure that my
parser throws the first error it encounters out to my catch block.

I followed the instructions in the book "Exiting the recogniser upon first
error".

 

I am struggling to achieve the same thing with the lexer. I am using the C#
target (3.0.1, though I have also tried 3.1).

I still get the four or five error messages printed, the lexer attempts to
recover and I cannot seem to override the default behaviour.

 

I have added the lexer members

@lexer::members{

    protected override void Mismatch(IIntStream input, int ttype, BitSet
follow) {

        throw new MismatchedTokenException(ttype, input);

    }

 

    public override object RecoverFromMismatchedSet(IIntStream input,
RecognitionException e, BitSet follow) {

        throw e;

    }

    

}

 

>From examining the source it would appear that @lexer::rulecatch is not
supported?

How do I get the lexer to bail on first error?

 

Regards

Craig.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/5fe6721b/attachment-0001.html 

From jimi at temporal-wave.com  Thu Jul 17 13:37:34 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 13:37:34 -0700
Subject: [antlr-interest] Lexer error handling,
In-Reply-To: <007901c8e849$d643e6d0$82cbb470$@co.za>
References: <007901c8e849$d643e6d0$82cbb470$@co.za>
Message-ID: <1216327054.7476.197.camel@jimi>

On Thu, 2008-07-17 at 22:15 +0200, Craig Main wrote:
> Hi,
> 
>  
> 
> I have made the necessary override and @rulecatch changes to ensure
> that my parser throws the first error it encounters out to my catch
> block.
> 
> I followed the instructions in the book ?Exiting the recogniser upon
> first error?.



>  
> 
> From examining the source it would appear that @lexer::rulecatch is
> not supported?
> 
> How do I get the lexer to bail on first error?


It is probably better to construct a lexer that cannot fail. Get all
your real rules working then as the last rule add:

ERRCHAR : . { throw somethignAntlrDoesntCatch; } ;

However are you sure you want to do that, or bail out on the first
parser error? Usually a developer likes to see as many errors as
possible in one hit, so you can fix as many as make sense before an
other compile. This is the same for things like batch submissions -
there is nothing more frustrating than submitting something, getting an
error back, fixing that, and resubmitting to find that the next line is
in error too - only beaten by early lisp compilers saying Yes or
No ;-). 

The only time it seems to be useful to bail out early is because the
program isn't using a tree parser, so it is trying to do all the work in
the parser and a syntax error causes later action code to fail badly,
which points to a design flaw really. If your parser does the minimum it
needs to check syntax, then it will be pretty quick and would normally
be better design. That said, there are probably situations where it
makes sense.

Rather than error out, your lexer can say:

ERRCHAR : . {Console.Writeline("Invalid character at....");  $channel =
HIDDEN; } ;

And this will give the parser a reasonable chance of being able to
ignore that character and verify the syntax.

Anyway, that should be the info you need. You could also override the
display error message in the lexer and throw your exception there, but
that is probably less obvious to the eye.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/a290c636/attachment.html 

From antlr at mirality.co.nz  Thu Jul 17 14:05:59 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 18 Jul 2008 09:05:59 +1200
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <487F4043.5000801@gmx.de>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
	<487F4043.5000801@gmx.de>
Message-ID: <20080717210610.9893D11ECCB@www.antlr.org>

At 00:51 18/07/2008, Johannes Luber wrote:
 >> I'm seeing different behavior running my parser with a syntax
 >> error the second time run. I've tracked it down to where I
 >> believe the problem is, located in BaseRecognizer.cs. The
 >> "follow.Remove( Token.EOR_TOKEN_TYPE )" logic is being
 >> called, which modifies the state of the static readonly
 >> BitSet object found on the parser. The problem with that
 >> is that even though I am creating a completely different
 >> parser instance, the static variable has been altered for
 >> as long as the assembly is in memory. I've copied a simple
 >> program to illustrate the problem at the bottom of this mail.
 >
 >I haven't heard of it yet, but it's a Java target problem, too,
 >so Ter has to say, if removing the static modifier for the
 >BitSet variables in the parser is enough and doesn't affect
 >anything else.

I don't think that's sufficient -- after all, a single instance 
might be re-used, or the rule-path followed might query that 
structure again (expecting it to be in its unmodified state).

Read-only variables should never be modified.  Any code that is 
doing so is clearly erroneous.  (Perhaps it should be modifying a 
clone of the object instead of the original?)


From antlr at mirality.co.nz  Thu Jul 17 14:08:41 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 18 Jul 2008 09:08:41 +1200
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <1216312661.7476.13.camel@jimi>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
	<487EFB30.8070308@doddington.net>
	<20080717083830.4BB20352294@www.antlr.org>
	<1216312661.7476.13.camel@jimi>
Message-ID: <20080717210849.78D5E11ED49@www.antlr.org>

At 04:37 18/07/2008, Jim Idle wrote:
>Using input:
>
>/* XYZ * */
>SOME OTHER STUF F*/

My interpretation of what the OP has been saying is that the 
problem input involves a group of adjacent asterisks within the 
comment -- eg. something like this:

/*  **  */

or this:

/********/


From parrt at cs.usfca.edu  Thu Jul 17 14:10:08 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 17 Jul 2008 14:10:08 -0700
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <20080717210610.9893D11ECCB@www.antlr.org>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
	<487F4043.5000801@gmx.de>
	<20080717210610.9893D11ECCB@www.antlr.org>
Message-ID: <11B2F920-6CB9-4771-998A-E069A27B82C4@cs.usfca.edu>


On Jul 17, 2008, at 2:05 PM, Gavin Lambert wrote:

> At 00:51 18/07/2008, Johannes Luber wrote:
> >> I'm seeing different behavior running my parser with a syntax
> >> error the second time run. I've tracked it down to where I
> >> believe the problem is, located in BaseRecognizer.cs. The
> >> "follow.Remove( Token.EOR_TOKEN_TYPE )" logic is being
> >> called, which modifies the state of the static readonly
> >> BitSet object found on the parser. The problem with that
> >> is that even though I am creating a completely different
> >> parser instance, the static variable has been altered for
> >> as long as the assembly is in memory. I've copied a simple
> >> program to illustrate the problem at the bottom of this mail.
> >
> >I haven't heard of it yet, but it's a Java target problem, too,
> >so Ter has to say, if removing the static modifier for the
> >BitSet variables in the parser is enough and doesn't affect
> >anything else.
>
> I don't think that's sufficient -- after all, a single instance  
> might be re-used, or the rule-path followed might query that  
> structure again (expecting it to be in its unmodified state).

I think i saw this...seems I forced it to dup after I found this...

> Read-only variables should never be modified.  Any code that is  
> doing so is clearly erroneous.  (Perhaps it should be modifying a  
> clone of the object instead of the original?)
>

yes, a clone.  Ok, looks like mine is ok:

     protected BitSet combineFollows(boolean exact) {
         int top = state._fsp;
         BitSet followSet = new BitSet();
         for (int i=top; i>=0; i--) {
             BitSet localFollowSet = (BitSet)state.following[i];
             /*
             System.out.println("local follow depth "+i+"="+
                                 
localFollowSet.toString(getTokenNames())+")");
              */
             followSet.orInPlace(localFollowSet);
             if ( exact ) {
                 // can we see end of rule?
                 if ( localFollowSet.member(Token.EOR_TOKEN_TYPE) ) {
                     // Only leave EOR in set if at top (start rule);  
this lets
                     // us know if have to include follow(start rule);  
i.e., EOF
                     if ( i>0 ) {
                         followSet.remove(Token.EOR_TOKEN_TYPE);
                     }
                 }
                 else { // can't see end of rule, quit
                     break;
                 }
             }
         }
         return followSet;
     }

Note that it is creating a new BitSet at the start...it is removing  
only from that set.

Ter

From jaluber at gmx.de  Thu Jul 17 14:26:49 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 17 Jul 2008 23:26:49 +0200
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <11B2F920-6CB9-4771-998A-E069A27B82C4@cs.usfca.edu>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
	<487F4043.5000801@gmx.de>
	<20080717210610.9893D11ECCB@www.antlr.org>
	<11B2F920-6CB9-4771-998A-E069A27B82C4@cs.usfca.edu>
Message-ID: <487FB919.9040102@gmx.de>

Terence Parr schrieb:
> 
> On Jul 17, 2008, at 2:05 PM, Gavin Lambert wrote:
> 
>> At 00:51 18/07/2008, Johannes Luber wrote:
>> >> I'm seeing different behavior running my parser with a syntax
>> >> error the second time run. I've tracked it down to where I
>> >> believe the problem is, located in BaseRecognizer.cs. The
>> >> "follow.Remove( Token.EOR_TOKEN_TYPE )" logic is being
>> >> called, which modifies the state of the static readonly
>> >> BitSet object found on the parser. The problem with that
>> >> is that even though I am creating a completely different
>> >> parser instance, the static variable has been altered for
>> >> as long as the assembly is in memory. I've copied a simple
>> >> program to illustrate the problem at the bottom of this mail.
>> >
>> >I haven't heard of it yet, but it's a Java target problem, too,
>> >so Ter has to say, if removing the static modifier for the
>> >BitSet variables in the parser is enough and doesn't affect
>> >anything else.
>>
>> I don't think that's sufficient -- after all, a single instance might 
>> be re-used, or the rule-path followed might query that structure again 
>> (expecting it to be in its unmodified state).
> 
> I think i saw this...seems I forced it to dup after I found this...
> 
>> Read-only variables should never be modified.  Any code that is doing 
>> so is clearly erroneous.  (Perhaps it should be modifying a clone of 
>> the object instead of the original?)
>>
> 
> yes, a clone.  Ok, looks like mine is ok:
> 
>     protected BitSet combineFollows(boolean exact) {
>         int top = state._fsp;
>         BitSet followSet = new BitSet();
>         for (int i=top; i>=0; i--) {
>             BitSet localFollowSet = (BitSet)state.following[i];
>             /*
>             System.out.println("local follow depth "+i+"="+
>                                
> localFollowSet.toString(getTokenNames())+")");
>              */
>             followSet.orInPlace(localFollowSet);
>             if ( exact ) {
>                 // can we see end of rule?
>                 if ( localFollowSet.member(Token.EOR_TOKEN_TYPE) ) {
>                     // Only leave EOR in set if at top (start rule); 
> this lets
>                     // us know if have to include follow(start rule); 
> i.e., EOF
>                     if ( i>0 ) {
>                         followSet.remove(Token.EOR_TOKEN_TYPE);
>                     }
>                 }
>                 else { // can't see end of rule, quit
>                     break;
>                 }
>             }
>         }
>         return followSet;
>     }
> 
> Note that it is creating a new BitSet at the start...it is removing only 
> from that set.
> 
> Ter
> 
BaseRecognizer.cs has the same function. Whatever the reason is, it's 
not there.

Johannes

From antlr at mirality.co.nz  Thu Jul 17 14:23:39 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 18 Jul 2008 09:23:39 +1200
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <11B2F920-6CB9-4771-998A-E069A27B82C4@cs.usfca.edu>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
	<487F4043.5000801@gmx.de>
	<20080717210610.9893D11ECCB@www.antlr.org>
	<11B2F920-6CB9-4771-998A-E069A27B82C4@cs.usfca.edu>
Message-ID: <20080717212352.8F43B11EDEB@www.antlr.org>

At 09:10 18/07/2008, Terence Parr wrote:
 >         BitSet followSet = new BitSet();
[...]
 >             BitSet localFollowSet = (BitSet)state.following[i];
[...]
 >             followSet.orInPlace(localFollowSet);
[...]
 >                         followSet.remove(Token.EOR_TOKEN_TYPE);
[...]
 >Note that it is creating a new BitSet at the start...it is
 >removing only from that set.

Yes, the logic looks correct, but I think the variable names are 
backwards -- "localFollowSet" contains the shared follow set and 
"followSet" contains the local clone :)


From jimi at temporal-wave.com  Thu Jul 17 14:27:46 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 14:27:46 -0700
Subject: [antlr-interest] Bug in Generated Parser?
In-Reply-To: <20080717210610.9893D11ECCB@www.antlr.org>
References: <E77E96B6A3DEE24CB77E4F7130C910DA6BE1816888@NA-EXMSG-C117.redmond.corp.microsoft.com>
	<487F4043.5000801@gmx.de>  <20080717210610.9893D11ECCB@www.antlr.org>
Message-ID: <1216330066.7476.201.camel@jimi>

On Fri, 2008-07-18 at 09:05 +1200, Gavin Lambert wrote:

> At 00:51 18/07/2008, Johannes Luber wrote:
> n't heard of it yet, but it's a Java target problem, too,
>  >so Ter has to say, if removing the static modifier for the
>  >BitSet variables in the parser is enough and doesn't affect
>  >anything else.
> 
> I don't think that's sufficient -- after all, a single instance 
> might be re-used, or the rule-path followed might query that 
> structure again (expecting it to be in its unmodified state).
> 
> Read-only variables should never be modified.  Any code that is 
> doing so is clearly erroneous.  (Perhaps it should be modifying a 
> clone of the object instead of the original?)


That's what the C runtime does, certainly, however this has now changed
to construct a bitset from the statically allocated bit list in the
parser. If yo udon't then you get a memory access error and the bug is
obvious. Perhaps this is a downside to not managing your own memory ;-)

Jim

> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/30f70f68/attachment.html 

From jimi at temporal-wave.com  Thu Jul 17 14:30:01 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 14:30:01 -0700
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <20080717210735.28E0A1156ACB@msf1.dnsmadeeasy.com>
References: <487CE237.1010302@doddington.net>
	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>
	<487E3592.2010301@doddington.net>
	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>
	<487EFB30.8070308@doddington.net>
	<20080717083830.4BB20352294@www.antlr.org>
	<1216312661.7476.13.camel@jimi>
	<20080717210735.28E0A1156ACB@msf1.dnsmadeeasy.com>
Message-ID: <1216330201.7476.203.camel@jimi>

On Fri, 2008-07-18 at 09:08 +1200, Gavin Lambert wrote:

> At 04:37 18/07/2008, Jim Idle wrote:
> >Using input:
> >
> >/* XYZ * */
> >SOME OTHER STUF F*/
> 
> My interpretation of what the OP has been saying is that the 
> problem input involves a group of adjacent asterisks within the 
> comment -- eg. something like this:
> 
> /*  **  */
> 
> or this:
> 
> /********/


Which also works perfectly with the same grammar i posted earlier.

jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/eaf5d319/attachment-0001.html 

From roshanj at google.com  Thu Jul 17 16:22:19 2008
From: roshanj at google.com (Roshan James)
Date: Thu, 17 Jul 2008 16:22:19 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <76c728610807171622t2d500326mc1480ce4a9de164@mail.gmail.com>

Hello,

I am trying to parse a language where there are words that have keyword
status in only some contexts/rules. In any other context those words can be
used as identifiers. However the default behavior of the lexer is that it
will generate special tokens for these always. Is there some way to work
around this?

As an example consider the rule called options below:
*options: 'format' INTEGER
*
I define identifiers as:
*ID : LETTER (LETTER | DIGIT)*;
*
However when I do this, the lexer generates a special token that has type
'format'. Thus, in any other part of the grammar where I expect to parse the
input string 'format' as an identifier the parser complains.

The solution that comes to mind is to change the above rule to be
options: ID INTEGER
and then inserting an appropriate semantic check.

Is there a better way to do this?

regards,
Roshan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/3c8d9afc/attachment.html 

From jimi at temporal-wave.com  Thu Jul 17 16:32:42 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 16:32:42 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <76c728610807171622t2d500326mc1480ce4a9de164@mail.gmail.com>
References: <76c728610807171622t2d500326mc1480ce4a9de164@mail.gmail.com>
Message-ID: <1216337562.17704.34.camel@jimi>

On Thu, 2008-07-17 at 16:22 -0700, Roshan James wrote:
> Hello,
> 
> I am trying to parse a language where there are words that have
> keyword status in only some contexts/rules. In any other context those
> words can be used as identifiers. However the default behavior of the
> lexer is that it will generate special tokens for these always. Is
> there some way to work around this? 
> 
> As an example consider the rule called options below:
> options: 'format' INTEGER
> 
> I define identifiers as:
> ID : LETTER (LETTER | DIGIT)*;
> 
> However when I do this, the lexer generates a special token that has
> type 'format'. Thus, in any other part of the grammar where I expect
> to parse the input string 'format' as an identifier the parser
> complains. 
> 
> The solution that comes to mind is to change the above rule to be
> options: ID INTEGER
> and then inserting an appropriate semantic check. 


Always generate the keywords, then use parser rules to allow them as
variables in specific contexts:


For instance, when compiling LINQ in VB.Net, you can't sue the LINQ
keywords as variables, but you can everywhere else, so you have;


linq_id 
  : ID
  ;

id: ID
  | linq_keywords
 ;

linq_keywords
    : SELECT -> ID[SELECT]
    | WHERE -> ID[WHERE]
    | etc
   ;

Then you use the appropriate parser rule as context requires.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/b0645f6a/attachment.html 

From lgcraymer at yahoo.com  Thu Jul 17 16:49:52 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Thu, 17 Jul 2008 16:49:52 -0700 (PDT)
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <545811.57444.qm@web55915.mail.re3.yahoo.com>

That is one solution; however, semantic predicates-- { input.LT(1).getText().equals("foo") }? ID --are much to be preferred when there are lots of potential keywords and cost less in terms of performance since they avoid the id method call for the general case.? (Or should cost less:? ANTLR 3 currently does not reduce the generated?conditionals.)
--Loring



----- Original Message ----
From: Jim Idle <jimi at temporal-wave.com>
To: antlr-interest <antlr-interest at antlr.org>
Sent: Thursday, July 17, 2008 4:32:42 PM
Subject: Re: [antlr-interest] Tokenising for context specific reserved words

On Thu, 2008-07-17 at 16:22 -0700, Roshan James wrote: 
Hello,

I am trying to parse a language where there are words that have keyword status in only some contexts/rules. In any other context those words can be used as identifiers. However the default behavior of the lexer is that it will generate special tokens for these always. Is there some way to work around this? 

As an example consider the rule called options below:
options: 'format' INTEGER

I define identifiers as:
ID : LETTER (LETTER | DIGIT)*;

However when I do this, the lexer generates a special token that has type 'format'. Thus, in any other part of the grammar where I expect to parse the input string 'format' as an identifier the parser complains. 

The solution that comes to mind is to change the above rule to be
options: ID INTEGER
and then inserting an appropriate semantic check. 

Always generate the keywords, then use parser rules to allow them as variables in specific contexts:


For instance, when compiling LINQ in VB.Net, you can't sue the LINQ keywords as variables, but you can everywhere else, so you have;


linq_id 
? : ID
? ;

id: ID
? | linq_keywords
;

linq_keywords
??? : SELECT -> ID[SELECT]
??? | WHERE -> ID[WHERE]
??? | etc
?? ;

Then you use the appropriate parser rule as context requires.

Jim 


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/7b87c55c/attachment.html 

From jimi at temporal-wave.com  Thu Jul 17 17:22:55 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 17:22:55 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <545811.57444.qm@web55915.mail.re3.yahoo.com>
References: <545811.57444.qm@web55915.mail.re3.yahoo.com>
Message-ID: <1216340575.17704.47.camel@jimi>

On Thu, 2008-07-17 at 16:49 -0700, Loring Craymer wrote:
> That is one solution; however, semantic predicates--
> { input.LT(1).getText().equals("foo") }? ID --are much to be preferred
> when there are lots of potential keywords and cost less in terms of
> performance since they avoid the id method call for the general case.
> (Or should cost less:  ANTLR 3 currently does not reduce the generated
> conditionals.)


Personally I think that that construct is almost unreadable and it
involves invoking LT(), getText() - which means creating the string out
of the input stream, then a string comparison, which is another method
call in itself. I can't see how that will cost less than looking for a
token value as it invokes three method calls. Java doesn't seem to do a
great job of optimizing conditionals, but it should be able to do better
than two method calls, constructing a string via substring and a string
comparison I should think? I would also think that the DFA is faster
than that construct. 

My preference is based upon the observed performance of C I admit, where
the keywords rule is a much better performer (though I might go recheck
that to make sure ;-). Maybe the opposite is indeed true for Java.

Jim
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/1be1e413/attachment.html 

From lgcraymer at yahoo.com  Thu Jul 17 17:36:14 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Thu, 17 Jul 2008 17:36:14 -0700 (PDT)
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <938829.72578.qm@web55911.mail.re3.yahoo.com>

For Yggdrasil, I hide the sempred?behind doubly-quoted keywords.? As to performance:? the sempred is called less often than id (as a rule--YMMV) and usually much less often.? The issue is aggregate performance, not local performance; the general principle for performance tweaking?is to worry less about the cost of infrequent calls than the cost of frequent calls.? Basically, the id approach adds a method call and bitset inclusion test for every ID, while the sempred costs the three calls per keyword test.
--Loring



----- Original Message ----
From: Jim Idle <jimi at temporal-wave.com>
To: Loring Craymer <lgcraymer at yahoo.com>
Cc: antlr-interest <antlr-interest at antlr.org>
Sent: Thursday, July 17, 2008 5:22:55 PM
Subject: Re: [antlr-interest] Tokenising for context specific reserved words

On Thu, 2008-07-17 at 16:49 -0700, Loring Craymer wrote: 
That is one solution; however, semantic predicates-- { input.LT(1).getText().equals("foo") }? ID --are much to be preferred when there are lots of potential keywords and cost less in terms of performance since they avoid the id method call for the general case.? (Or should cost less:? ANTLR 3 currently does not reduce the generated conditionals.)

Personally I think that that construct is almost unreadable and it involves invoking LT(), getText() - which means creating the string out of the input stream, then a string comparison, which is another method call in itself. I can't see how that will cost less than looking for a token value as it invokes three method calls. Java doesn't seem to do a great job of optimizing conditionals, but it should be able to do better than two method calls, constructing a string via substring and a string comparison I should think? I would also think that the DFA is faster than that construct. 

My preference is based upon the observed performance of C I admit, where the keywords rule is a much better performer (though I might go recheck that to make sure ;-). Maybe the opposite is indeed true for Java.

Jim 



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/95a8bff8/attachment.html 

From roshanj at google.com  Thu Jul 17 18:18:59 2008
From: roshanj at google.com (Roshan James)
Date: Thu, 17 Jul 2008 18:18:59 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <938829.72578.qm@web55911.mail.re3.yahoo.com>
References: <938829.72578.qm@web55911.mail.re3.yahoo.com>
Message-ID: <76c728610807171818s6fe40403kc52e38feb1c09ddf@mail.gmail.com>

Thank you for your responses. I am biased against using semantics predicates
for the reason that I want to keep out the target language as much as
possible from the parser that generates the AST.

Are there any other approaches other than Jims?

The downside I see to this approach is that one always needs to keep a
global list of keywords under the 'id' production. This becomes a bit of a
nightmare for maintenance.

Roshan



On Thu, Jul 17, 2008 at 5:36 PM, Loring Craymer <lgcraymer at yahoo.com> wrote:

> For Yggdrasil, I hide the sempred behind doubly-quoted keywords.  As to
> performance:  the sempred is called less often than id (as a rule--YMMV) and
> usually much less often.  The issue is aggregate performance, not local
> performance; the general principle for performance tweaking is to worry less
> about the cost of infrequent calls than the cost of frequent calls.
> Basically, the id approach adds a method call and bitset inclusion test for
> every ID, while the sempred costs the three calls per keyword test.
>
>
>
> --Loring
>
>
> ----- Original Message ----
> From: Jim Idle <jimi at temporal-wave.com>
> To: Loring Craymer <lgcraymer at yahoo.com>
> Cc: antlr-interest <antlr-interest at antlr.org>
> Sent: Thursday, July 17, 2008 5:22:55 PM
> Subject: Re: [antlr-interest] Tokenising for context specific reserved
> words
>
> On Thu, 2008-07-17 at 16:49 -0700, Loring Craymer wrote:
>
> That is one solution; however, semantic predicates-- {
> input.LT(1).getText().equals("foo") }? ID --are much to be preferred when
> there are lots of potential keywords and cost less in terms of performance
> since they avoid the id method call for the general case.  (Or should cost
> less:  ANTLR 3 currently does not reduce the generated conditionals.)
>
>
> Personally I think that that construct is almost unreadable and it involves
> invoking LT(), getText() - which means creating the string out of the input
> stream, then a string comparison, which is another method call in itself. I
> can't see how that will cost less than looking for a token value as it
> invokes three method calls. Java doesn't seem to do a great job of
> optimizing conditionals, but it should be able to do better than two method
> calls, constructing a string via substring and a string comparison I should
> think? I would also think that the DFA is faster than that construct.
>
> My preference is based upon the observed performance of C I admit, where
> the keywords rule is a much better performer (though I might go recheck that
> to make sure ;-). Maybe the opposite is indeed true for Java.
>
> Jim
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/dcd5e1fb/attachment-0001.html 

From jimi at temporal-wave.com  Thu Jul 17 18:19:24 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 18:19:24 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <938829.72578.qm@web55911.mail.re3.yahoo.com>
References: <938829.72578.qm@web55911.mail.re3.yahoo.com>
Message-ID: <1216343964.17704.70.camel@jimi>

On Thu, 2008-07-17 at 17:36 -0700, Loring Craymer wrote:
> For Yggdrasil, I hide the sempred behind doubly-quoted keywords.  As
> to performance:  the sempred is called less often than id (as a
> rule--YMMV) and usually much less often.  The issue is aggregate
> performance, not local performance; the general principle for
> performance tweaking is to worry less about the cost of infrequent
> calls than the cost of frequent calls.  Basically, the id approach
> adds a method call and bitset inclusion test for every ID, while the
> sempred costs the three calls per keyword test.


OK - I see where you are going. However, most of the cases I come across
mean that you would be doing those 3 calls for every keyword and I think
it would be quickly unreadable. Most languages where this happens allow
almost all keywords to be used as identifiers when they are not in fact
the actual keyword. The lesson then is probably to step back from the
solution before implementing either one and see which makes sense for
your particular situation. I can imagine that cases where a few new
keywords are introduced in a new version of the language but for
backward compatibility reasons they are allowed to be identifiers, may
well qualify as a sempred candidate for instance. 

There are probably better generic solutions for the whole keyword vs ID
issue. Double quoting keywords seems like a reasonable way to flag
something as also being available as in identifier, but then it forces
the sempred route unless it is further adorned with constructs that may
well then inextricably link the parser and lexer, which is
probably/possibly best avoided. 

Jim

> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/658b029c/attachment.html 

From lgcraymer at yahoo.com  Thu Jul 17 18:58:32 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Thu, 17 Jul 2008 18:58:32 -0700 (PDT)
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <683151.1488.qm@web55908.mail.re3.yahoo.com>





----- Original Message ----
From: Jim Idle <jimi at temporal-wave.com>
To: Loring Craymer <lgcraymer at yahoo.com>
Cc: antlr-interest <antlr-interest at antlr.org>
Sent: Thursday, July 17, 2008 6:19:24 PM
Subject: Re: [antlr-interest] Tokenising for context specific reserved words

On Thu, 2008-07-17 at 17:36 -0700, Loring Craymer wrote: 
For Yggdrasil, I hide the sempred behind doubly-quoted keywords.? As to performance:? the sempred is called less often than id (as a rule--YMMV) and usually much less often.? The issue is aggregate performance, not local performance; the general principle for performance tweaking is to worry less about the cost of infrequent calls than the cost of frequent calls.? Basically, the id approach adds a method call and bitset inclusion test for every ID, while the sempred costs the three calls per keyword test.


OK - I see where you are going. However, most of the cases I come across mean that you would be doing those 3 calls for every keyword and I think it would be quickly unreadable. Most languages where this happens allow almost all keywords to be used as identifiers when they are not in fact the actual keyword. The lesson then is probably to step back from the solution before implementing either one and see which makes 
True, but keyword invocations?are less common than user-defined identifiers, and only conditional keywords (like "if") appear at high frequency in code.? The disadvantage of the simple sempred is that you really want to "hoist and negate" because of the equality test (!= is faster than == for strings), but that is an implementation detail.
sense for your particular situation. I can imagine that cases where a few new keywords are introduced in a new version of the language but for backward compatibility reasons they are allowed to be identifiers, may well qualify as a sempred candidate for instance. 

There are probably better generic solutions for the whole keyword vs ID issue. Double quoting keywords seems like a reasonable way to flag something as also being available as in identifier, but then it forces the sempred route unless it is further adorned with constructs that may well then inextricably link the parser and lexer, which is probably/possibly best avoided. 
I do tag doubly quoted keywords with unique token types for tree walking as they are identified by the parser; that effectively decreases the frequency of identifier versus keyword conflicts over the translation cycle.? The converse (have id set non-IDs to ID in the conglomeration approach you described) is also useful.
--Loring


Jim


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/27ac79dc/attachment.html 

From jimi at temporal-wave.com  Thu Jul 17 19:24:32 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Jul 2008 19:24:32 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <76c728610807171818s6fe40403kc52e38feb1c09ddf@mail.gmail.com>
References: <938829.72578.qm@web55911.mail.re3.yahoo.com>
	<76c728610807171818s6fe40403kc52e38feb1c09ddf@mail.gmail.com>
Message-ID: <1216347872.17704.74.camel@jimi>

On Thu, 2008-07-17 at 18:18 -0700, Roshan James wrote:
> Thank you for your responses. I am biased against using semantics
> predicates for the reason that I want to keep out the target language
> as much as possible from the parser that generates the AST. 
> 
> Are there any other approaches other than Jims? 
> 
> The downside I see to this approach is that one always needs to keep a
> global list of keywords under the 'id' production. This becomes a bit
> of a nightmare for maintenance.

Well, one way or another you have to identify the keywords, so I am not
sure that either solution is better or worse than anything else for
that. Also, unless you are adding keywords to your language every two
minutes, I wouldn't worry about it too much ;-) Just keep as many
regression tests as you can.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080717/02d4e094/attachment.html 

From jaluber at gmx.de  Fri Jul 18 01:12:18 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 18 Jul 2008 10:12:18 +0200
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <1216343964.17704.70.camel@jimi>
References: <938829.72578.qm@web55911.mail.re3.yahoo.com>
	<1216343964.17704.70.camel@jimi>
Message-ID: <48805062.3040008@gmx.de>

Jim Idle schrieb:
> On Thu, 2008-07-17 at 17:36 -0700, Loring Craymer wrote:
>> For Yggdrasil, I hide the sempred behind doubly-quoted keywords.  As 
>> to performance:  the sempred is called less often than id (as a 
>> rule--YMMV) and usually much less often.  The issue is aggregate 
>> performance, not local performance; the general principle for 
>> performance tweaking is to worry less about the cost of infrequent 
>> calls than the cost of frequent calls.  Basically, the id approach 
>> adds a method call and bitset inclusion test for every ID, while the 
>> sempred costs the three calls per keyword test.
> 
> OK - I see where you are going. However, most of the cases I come across 
> mean that you would be doing those 3 calls for every keyword and I think 
> it would be quickly unreadable.

One should create a special rule to test a certain ID as keyword, as 
this strategy removes code duplication. It may add another method call, 
but for this kind of methods most compilers should do an inlining as 
optimization.

Johannes

> Most languages where this happens allow 
> almost all keywords to be used as identifiers when they are not in fact 
> the actual keyword. The lesson then is probably to step back from the 
> solution before implementing either one and see which makes sense for 
> your particular situation. I can imagine that cases where a few new 
> keywords are introduced in a new version of the language but for 
> backward compatibility reasons they are allowed to be identifiers, may 
> well qualify as a sempred candidate for instance.
> 
> There are probably better generic solutions for the whole keyword vs ID 
> issue. Double quoting keywords seems like a reasonable way to flag 
> something as also being available as in identifier, but then it forces 
> the sempred route unless it is further adorned with constructs that may 
> well then inextricably link the parser and lexer, which is 
> probably/possibly best avoided.
> 
> Jim
> 
>>


From lgcraymer at yahoo.com  Fri Jul 18 01:59:23 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Fri, 18 Jul 2008 01:59:23 -0700 (PDT)
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <461631.90410.qm@web55907.mail.re3.yahoo.com>

Actually, I just thought of a hybrid approach:  support subtypes for double-quoted literals and have the subtype field set by the lexer.  Then, a doubly quoted literal reference in a grammar is handled by looking at the subtype field, while an ID reference looks at the type field.  Except for the extra field (which probably costs nothing--minimum allocation sizes are usually larger than tokens), the only added runtime overhead would be in the lexer to set the subtype field.

--Loring




----- Original Message ----
> From: Johannes Luber <jaluber at gmx.de>
> To: Jim Idle <jimi at temporal-wave.com>
> Cc: Loring Craymer <lgcraymer at yahoo.com>; antlr-interest <antlr-interest at antlr.org>
> Sent: Friday, July 18, 2008 1:12:18 AM
> Subject: Re: [antlr-interest] Tokenising for context specific reserved words
> 
> Jim Idle schrieb:
> > On Thu, 2008-07-17 at 17:36 -0700, Loring Craymer wrote:
> >> For Yggdrasil, I hide the sempred behind doubly-quoted keywords.  As 
> >> to performance:  the sempred is called less often than id (as a 
> >> rule--YMMV) and usually much less often.  The issue is aggregate 
> >> performance, not local performance; the general principle for 
> >> performance tweaking is to worry less about the cost of infrequent 
> >> calls than the cost of frequent calls.  Basically, the id approach 
> >> adds a method call and bitset inclusion test for every ID, while the 
> >> sempred costs the three calls per keyword test.
> > 
> > OK - I see where you are going. However, most of the cases I come across 
> > mean that you would be doing those 3 calls for every keyword and I think 
> > it would be quickly unreadable.
> 
> One should create a special rule to test a certain ID as keyword, as 
> this strategy removes code duplication. It may add another method call, 
> but for this kind of methods most compilers should do an inlining as 
> optimization.
> 
> Johannes
> 
> > Most languages where this happens allow 
> > almost all keywords to be used as identifiers when they are not in fact 
> > the actual keyword. The lesson then is probably to step back from the 
> > solution before implementing either one and see which makes sense for 
> > your particular situation. I can imagine that cases where a few new 
> > keywords are introduced in a new version of the language but for 
> > backward compatibility reasons they are allowed to be identifiers, may 
> > well qualify as a sempred candidate for instance.
> > 
> > There are probably better generic solutions for the whole keyword vs ID 
> > issue. Double quoting keywords seems like a reasonable way to flag 
> > something as also being available as in identifier, but then it forces 
> > the sempred route unless it is further adorned with constructs that may 
> > well then inextricably link the parser and lexer, which is 
> > probably/possibly best avoided.
> > 
> > Jim
> > 
> >>



      


From janvanmansum at gmail.com  Fri Jul 18 02:34:44 2008
From: janvanmansum at gmail.com (Jan van Mansum)
Date: Fri, 18 Jul 2008 11:34:44 +0200
Subject: [antlr-interest] Overlapping token definitions
Message-ID: <ddda310e0807180234p6446b7c1v4d24fcea265f2b5a@mail.gmail.com>

Hello group,

I am parsing the structure file export of a DataPerfect database. Strings
are exported between tildes, like this:

~This is a string~

There are also strings that specify the format of a database field, with
some special
codes, like this:

~A25~ (alphanumeric field, 25 chars long)

Now I created a token rule for the general string and one for the
formatstring:

DP_STRING
    :     '~' ('a'..'z'|'A'..'Z'|'0'..'9'|' '|'-')*  '~';

FORMAT
    :    '~' (ALPHANUM|NUM)'~'
    ;

fragment
ALPHANUM
    :    ('A'|'U') NUMBER ('A' NUMBER)
    ;

fragment
NUM
    :    ('G'|'H'|'N') ('9'|'Z'|'*'|'-'|'+'|'.'|','|'('|'$'|'F')+
    ;

However the lexer mostly emits DP_STRING token if it encounters a format
string.
The problem is that the formatstrings are a subset of the general strings.

My question: is there a way to have the lexer match the format strings
correctly and
only emit the DP_STRING in the remaining cases (i.e. when the string is not
compatible
with the FORMAT token definition)?

Thanks for any help, best regards,

-- 
Jan van Mansum
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080718/9ef740d6/attachment-0001.html 

From janvanmansum at gmail.com  Fri Jul 18 04:48:13 2008
From: janvanmansum at gmail.com (Jan van Mansum)
Date: Fri, 18 Jul 2008 13:48:13 +0200
Subject: [antlr-interest] Overlapping token definitions
In-Reply-To: <E1KJnXJ-0001bh-Bx@www17.emo.freenet-rz.de>
References: <E1KJnXJ-0001bh-Bx@www17.emo.freenet-rz.de>
Message-ID: <ddda310e0807180448q45f5413dp69c3a2759607daa@mail.gmail.com>

Thanks Raphael! Actually I tried that but had concluded that the order of
the token definitions did not matter.
However, you are right, it does matter. One FORMAT wasn't matched because I
forgot to make the
second part of it optional (left out the question mark):

fragment
ALPHANUM
    :    ('A'|'U') NUMBER ('A' NUMBER)?
    ;

Good point about keywords inside strings. I hadn't considered that and it
did break my parser. I now
fixed that by changing the order of the lexer rules as well. The order is
now:

FORMAT
DP_STRING
<keywords>

Thanks again,

regards,

Jan.


2008/7/18 <r_reitzi at cs.uni-kl.de>:

> Hi Jan!
>
> The problem is that your "special"  keywords are perfectly matched by rule
> DP_STRING (as well as FORMAT). But, obviously, lexer cannot _know_ which
> rule you want it to match in which case.
> If you want to interpret strings matching FORMAT _always_ as FORMAT, place
> that rule above DP_STRING. ANTLR's lexer chooses the first rule that
> matches.
> However, you should perhaps not assume that nobody enters a string in a
> field looking the same as your keywords. To see if this does disturb your
> parsing, the parser gramar must be taken into account. It depends on how you
> take context into account.
> Can you choose another symbol as keyword delimiter?
>
> Regards
>
> Raphael
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080718/f7e90481/attachment.html 

From antlr at jazillian.com  Fri Jul 18 08:26:03 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Fri, 18 Jul 2008 11:26:03 -0400
Subject: [antlr-interest] [ANTLR] Translating from one language to
	another
In-Reply-To: <A93350664326264C931D3A835A1DC54706C7FFE6@att-corpexch03.mforma.com>
References: <A93350664326264C931D3A835A1DC54706C7FFE6@att-corpexch03.mforma.com>
Message-ID: <4880B60B.9030305@jazillian.com>


Jazillian is a product that translates C and C++ to Java.
See http://www.jazillian.com for info.

I know a couple of people have done some simple Java-to-other-language
translators. They start with the java.g and then either modify
the treewalker java.tree.g or modify my "hand-coded-treewalker" approach
at http://www.jazillian.com/antlr/emitter.html.

Translating the core language is fairly straightforward, especially
when you start with Java because it's the "less feature rich" language.
The hard part is translating the library calls.

Andy


Amir Latif wrote:
> Hello,
> 
> I've been doing some reading on how to write a translator to take code
> from say, Java -> C++ and Java -> Actionscript etc.
> 
> My reading has led me to the really nifty looking ANTLR.  I was assuming
> that code translation between languages was a more commonly tackled
> problem but there doesn't appear to be much literature out there
> covering the topic.
> 
> Is this something that is easily accomplished using ANTLR, as I suspect?
> If so, could someone please point me in the right direction for reading
> material if there is any?
> 
> many thanks,
> amir.
> 


From antlr at jazillian.com  Fri Jul 18 08:33:56 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Fri, 18 Jul 2008 11:33:56 -0400
Subject: [antlr-interest] announcing new OpenJDK project: ANTLR grammar
 for	javac
In-Reply-To: <044803F8-6F81-430A-8554-D44FDA1785C1@cs.usfca.edu>
References: <044803F8-6F81-430A-8554-D44FDA1785C1@cs.usfca.edu>
Message-ID: <4880B7E4.2030806@jazillian.com>

Hi Terence,
I've been meaning to ask you about this.

Is there going to be any "public access" to this code?
Is there anything I or others can do to help?
Is there a purpose, other than to make things cleaner and easier
to maintain and enhance?
What does Sun think of this? Are they encouraging it?
Do you know why they hand-wrote their parser rather than using a tool?
Maybe you could apply (next year) to get some cash from Sun for this work:
http://www.sun.com/aboutsun/pr/2007-12/sunflash.20071205.1.xml

Andy

Terence Parr wrote:
> Hi,
> 
> http://openjdk.java.net/projects/compiler-grammar/
> 
> "The goal of this Project is to develop an experimental version of the 
> javac compiler based upon a grammar written in ANTLR."
> 
> My graduate student Yang Jiang is currently building a version of javac 
> the uses and ANTLR Java grammar instead of the handbuilt parser in there 
> now. He has made amazing progress.
> 
> Terence
> 


From rkevinburton at charter.net  Fri Jul 18 09:26:34 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Fri, 18 Jul 2008 12:26:34 -0400
Subject: [antlr-interest] Five minute introduction to ANTLR 3
Message-ID: <20080718122634.GIHA4.59221.root@fepweb08>

I am new to ANTLR so I was reading the 'Five minute introduction to ANTLR 3' and it contains the following:

parser.expr();

Which when I try to compile C# indicates that expr is not a member of the parser object. What method should I use?

Thank you.

Kevin

From jaluber at gmx.de  Fri Jul 18 09:48:30 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 18 Jul 2008 18:48:30 +0200
Subject: [antlr-interest] Five minute introduction to ANTLR 3
In-Reply-To: <20080718122634.GIHA4.59221.root@fepweb08>
References: <20080718122634.GIHA4.59221.root@fepweb08>
Message-ID: <4880C95E.5090405@gmx.de>

rkevinburton at charter.net schrieb:
> I am new to ANTLR so I was reading the 'Five minute introduction to ANTLR 3' and it contains the following:
> 
> parser.expr();
> 
> Which when I try to compile C# indicates that expr is not a member of the parser object. What method should I use?
> 
> Thank you.
> 
> Kevin
> 

Did you copy the right grammar from the introduction? Do you use 3.1b2? 
Did you generate the grammar,too? What's your driver program?

Johannes

From ladam at vbi.vt.edu  Fri Jul 18 09:51:56 2008
From: ladam at vbi.vt.edu (Laura Adam)
Date: Fri, 18 Jul 2008 12:51:56 -0400 (EDT)
Subject: [antlr-interest] java : code too large for try statement => use
	another language?
In-Reply-To: <806321474.1124061216399038722.JavaMail.root@zimbra>
Message-ID: <634779546.1124631216399916871.JavaMail.root@zimbra>

Hello,

I am implementing in Anltr through Java, a program that takes a DNA sequence as input and recognizes the different parts such as promoters, linkers...

Those parts are thousands letters long.
I used rules like :

E0020 :
        ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagtaataa");

E0022 :
        ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagaggcctgctgcaaacgacgaaaactacgctttagtagcttaataa");

>If I want a 1000 lookahead characters the file.g is ok. I have no lexical nondeterminism. But when I want to use the file.g with my test_lexer.java I have that error from java: "code too large for try statement".
>If I put a 200 lookahead characters I have lexical nondeterminism but I can compile and run the java program (I don't get the result I want of course).

--> What can I do?
I think I could add intermediates in my rules but it would be long (I thought to make packs of 4 or 5 letters), non general, and not friendly to user. I don't really like that solution.
Maybe I should turn to another language such as C. Will I have the same problem? 

(That possible I misunderstood how Antlr works and how to use it. I've never worked on parsers before.)

Laura Adam


From jaluber at gmx.de  Fri Jul 18 10:02:38 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 18 Jul 2008 19:02:38 +0200
Subject: [antlr-interest] java : code too large for try statement => use
 another language?
In-Reply-To: <634779546.1124631216399916871.JavaMail.root@zimbra>
References: <634779546.1124631216399916871.JavaMail.root@zimbra>
Message-ID: <4880CCAE.7000701@gmx.de>

Laura Adam schrieb:
> Hello,
> 
> I am implementing in Anltr through Java, a program that takes a DNA sequence as input and recognizes the different parts such as promoters, linkers...
> 
> Those parts are thousands letters long.
> I used rules like :
> 
> E0020 :
>         ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagtaataa");
> 
> E0022 :
>         ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagaggcctgctgcaaacgacgaaaactacgctttagtagcttaataa");
> 
>> If I want a 1000 lookahead characters the file.g is ok. I have no lexical nondeterminism. But when I want to use the file.g with my test_lexer.java I have that error from java: "code too large for try statement".
>> If I put a 200 lookahead characters I have lexical nondeterminism but I can compile and run the java program (I don't get the result I want of course).
> 
> --> What can I do?
> I think I could add intermediates in my rules but it would be long (I thought to make packs of 4 or 5 letters), non general, and not friendly to user. I don't really like that solution.
> Maybe I should turn to another language such as C. Will I have the same problem? 
> 
> (That possible I misunderstood how Antlr works and how to use it. I've never worked on parsers before.)
> 
> Laura Adam
> 
I'm not sure if there is a good solution to your problem while still 
staying in Java (I leave that to others) I wonder why you want to switch 
from Java to C. If performance doesn't seem to be an issue, why don't 
you go to C# (which doesn't have this problem)? It's my impression that 
using C has an extra learning curve and may be more labarious than 
Java/C#. (Jim may correct on that. :) Besides, C# is also 
object-orientated and more similar to Java to C.

Johannes

From jimi at temporal-wave.com  Fri Jul 18 10:19:27 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 18 Jul 2008 10:19:27 -0700
Subject: [antlr-interest] java : code too large for try statement =>	use
	another language?
In-Reply-To: <634779546.1124631216399916871.JavaMail.root@zimbra>
References: <634779546.1124631216399916871.JavaMail.root@zimbra>
Message-ID: <1216401567.17704.117.camel@jimi>

On Fri, 2008-07-18 at 12:51 -0400, Laura Adam wrote:

> Hello,
> 
> I am implementing in Anltr through Java, a program that takes a DNA sequence as input and recognizes the different parts such as promoters, linkers...
> 
> Those parts are thousands letters long.
> I used rules like :
> 
> E0020 :
>         ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagtaataa");
> 
> E0022 :
>         ("atggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtgaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccctgacctggggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacatcagccacaacgtctatatcaccgccgacaagcagaagaacggcatcaaggccaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactctcggcatggacgagctgtacaagaggcctgctgcaaacgacgaaaactacgctttagtagcttaataa");
> 
> >If I want a 1000 lookahead characters the file.g is ok. I have no lexical nondeterminism. But when I want to use the file.g with my test_lexer.java I have that error from java: "code too large for try statement".
> >If I put a 200 lookahead characters I have lexical nondeterminism but I can compile and run the java program (I don't get the result I want of course).
> 
> --> What can I do?
> I think I could add intermediates in my rules but it would be long (I thought to make packs of 4 or 5 letters), non general, and not friendly to user. I don't really like that solution.
> Maybe I should turn to another language such as C. Will I have the same problem? 


C will just use whatever memory it has and generally the compilers will
will compile as large a program as you give it, although it might take
some time. At a guess from what you are trying to do, ANTLR isn't the
right program, or you would need to break down the logical sequences
lexically and contruct them in a parser from all the common prefixes and
so on, but the combinatorial possibilities are probably too huge.

Basically, while the algorithms can process your very long sequences, it
will generate huge amounts of code to do this. Ironically, you might be
better with flex for the lexer, as this will just go down the listed
possibilities in order and try each one to see if it works. But  unless
you are combining these tokens in to complicated syntax then you are
probably better off using awk or possibly even sed.

Finally through you could write a program to generate the lexer rules,
factoring out all the common sequences. Left factoring will reduce the
code size a lot. IN your two example tokens above, there is a large
common start sequence. Rather than clutter the examples, lets say the
common start sequence is : atggtgag" and then it differs after that,
then you can do:

fragment E0020 : 'x' ; // Place holder
E0022 : 'atggtgag'  // Common left sequence

                (
                      'cag'  // E0022
                    | 'ggta' { $type = E0020; }
                )
;

But I still think that you will end up with something fairly unworkable
unless you really can take all the input sequences and generate this
left factoring automatically, but if you are going to do that, you might
as well write a program for the recognition perhaps. 

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080718/391feeaa/attachment-0001.html 

From rkevinburton at charter.net  Fri Jul 18 11:22:53 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Fri, 18 Jul 2008 11:22:53 -0700
Subject: [antlr-interest] Bad grammar?
Message-ID: <20080718142253.Q7UNW.11516.root@fepweb12>

I am relatively new to ANTLR so as suggested I am starting with one of the "known" grammars. I decided to start with the JavaScript grammar by Chris Lambrou. It failed to parse what I think is valid JavaScript. So I decided to try to debug the problem and I found (in ANTLRWorks) that the following rule is not right:

formalParameterList
	: '(' (LT!* Identifier ( ',' LT!* Identifier)*)?  ')'
	;

If in ANTLRWorks I start at that rule and with the interpreter try '(a,b)' I get:

'(' FailedPredicateException(formalParameterList, {synpred16}?)

I am not able right now to debug it further. What is wrong with this rule?

Thank you.

Kevin

From jaluber at gmx.de  Fri Jul 18 11:33:22 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 18 Jul 2008 20:33:22 +0200
Subject: [antlr-interest] Five minute introduction to ANTLR 3
In-Reply-To: <20080718141525.P3GZP.11324.root@fepweb12>
References: <20080718141525.P3GZP.11324.root@fepweb12>
Message-ID: <4880E1F2.4010409@gmx.de>

rkevinburton at charter.net schrieb:
> No, I didn't generate the grammar. Is expr() a method of the Parser class or specific to this grammar? In general what starts the parser.

You need to use the grammar to generate source code files - this is how 
ANTLR works. Each grammar has a start rule - in the example's case it is 
expr(). expr() is defined in the parser class generated by ANTLR. In 
case you don't use the beta but 3.0.1 change the language option from 
CSharp2 to CSharp. You might want to pick up the ANTLR book to really 
get in depth with it - as well a book about C#. Apress has some nice C# 
books available.
> 
> My "driver" is a C# program that passes a file name to the action specified. I renamed Main to Parse and I passed the argument (the file name) to that function.

Each and every program requires a Main method, or it won't compile. It 
is also not enough to pass a string containing the file name to the 
expr()-method (which doesn't take parameters anyway). I suggest to look 
for the examples on the download page and study how they work. Then copy 
the appropriate code into your project. If you are still stuck then 
write again!

Johannes

P.S.: Please be aware that you have to use the "Reply All" button in 
your email program or you will send emails directly to me and not to the 
list.
> 
> Kevin
> 
> ---- Johannes Luber <jaluber at gmx.de> wrote: 
>> rkevinburton at charter.net schrieb:
>>> I am new to ANTLR so I was reading the 'Five minute introduction to ANTLR 3' and it contains the following:
>>>
>>> parser.expr();
>>>
>>> Which when I try to compile C# indicates that expr is not a member of the parser object. What method should I use?
>>>
>>> Thank you.
>>>
>>> Kevin
>>>
>> Did you copy the right grammar from the introduction? Do you use 3.1b2? 
>> Did you generate the grammar,too? What's your driver program?
>>
>> Johannes
> 


From jimi at temporal-wave.com  Fri Jul 18 11:36:50 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 18 Jul 2008 11:36:50 -0700
Subject: [antlr-interest] Bad grammar?
In-Reply-To: <20080718142253.Q7UNW.11516.root@fepweb12>
References: <20080718142253.Q7UNW.11516.root@fepweb12>
Message-ID: <1216406210.17704.134.camel@jimi>

On Fri, 2008-07-18 at 11:22 -0700, rkevinburton at charter.net wrote:

> I am relatively new to ANTLR so as suggested I am starting with one of the "known" grammars. I decided to start with the JavaScript grammar by Chris Lambrou. It failed to parse what I think is valid JavaScript. So I decided to try to debug the problem and I found (in ANTLRWorks) that the following rule is not right:
> 
> formalParameterList
> 	: '(' (LT!* Identifier ( ',' LT!* Identifier)*)?  ')'
> 	;
> 
> If in ANTLRWorks I start at that rule and with the interpreter try '(a,b)' I get:
> 
> '(' FailedPredicateException(formalParameterList, {synpred16}?)
> 
> I am not able right now to debug it further. What is wrong with this rule?


I am afraid that that grammar isn't very complete (trying to be
respectful here). I think it would be better for you to start with the
Java one or the C one to be honest.

JIm
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080718/93fdb048/attachment.html 

From parrt at cs.usfca.edu  Fri Jul 18 13:58:00 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 18 Jul 2008 13:58:00 -0700
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <461631.90410.qm@web55907.mail.re3.yahoo.com>
References: <461631.90410.qm@web55907.mail.re3.yahoo.com>
Message-ID: <81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>


On Jul 18, 2008, at 1:59 AM, Loring Craymer wrote:

> Actually, I just thought of a hybrid approach:  support subtypes for  
> double-quoted literals and have the subtype field set by the lexer.   
> Then, a doubly quoted literal reference in a grammar is handled by  
> looking at the subtype field, while an ID reference looks at the  
> type field.  Except for the extra field (which probably costs  
> nothing--minimum allocation sizes are usually larger than tokens),  
> the only added runtime overhead would be in the lexer to set the  
> subtype field.

There was an interesting paper called "Schrodinger's tokens"... if you  
are a physics or quantum physics buff, you get the reference ;)

Ter

From parrt at cs.usfca.edu  Fri Jul 18 14:01:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 18 Jul 2008 14:01:26 -0700
Subject: [antlr-interest] announcing new OpenJDK project: ANTLR grammar
	for	javac
In-Reply-To: <4880B7E4.2030806@jazillian.com>
References: <044803F8-6F81-430A-8554-D44FDA1785C1@cs.usfca.edu>
	<4880B7E4.2030806@jazillian.com>
Message-ID: <69E7581E-B553-4FA3-A5AD-78A18E0624CE@cs.usfca.edu>


On Jul 18, 2008, at 8:33 AM, Andy Tripp wrote:

> Hi Terence,
> I've been meaning to ask you about this.
>
> Is there going to be any "public access" to this code?

Presumably, yes.  The Java.g will have the appropriate updates from  
that work.

> Is there anything I or others can do to help?

Not sure at the moment.

> Is there a purpose, other than to make things cleaner and easier
> to maintain and enhance?

Well, A grammar has lots of it uses. For example, it can help build a  
better job of  language specification book.

> What does Sun think of this? Are they encouraging it?

Yep

> Do you know why they hand-wrote their parser rather than using a tool?

Speed most likely. Neal Gafter, the primary developer, is a freaking  
genius. He did very nice work, but with closures and other things it  
is becoming more and more difficult to maintain.

> Maybe you could apply (next year) to get some cash from Sun for this  
> work:
> http://www.sun.com/aboutsun/pr/2007-12/sunflash.20071205.1.xml

  interesting and I will look into it
Ter

From lgcraymer at yahoo.com  Fri Jul 18 14:22:16 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Fri, 18 Jul 2008 14:22:16 -0700 (PDT)
Subject: [antlr-interest] Tokenising for context specific reserved words
Message-ID: <100962.13442.qm@web55909.mail.re3.yahoo.com>

Cute--I found it on citeseer.? They are solving a slightly different problem--multi-valued types, not just binary alternatives--and having the parser do a table lookup.? I think that the binary approach is probably sufficient--either you want the generic answer, or you are in a context where you want the specific answer (a keyword--possibly one of a set of possible keywords)--and can be fitted into ANTLR without having to go to a GLR parser.
--Loring



----- Original Message ----
> From: Terence Parr <parrt at cs.usfca.edu>
> To: Loring Craymer <lgcraymer at yahoo.com>
> Cc: Johannes Luber <jaluber at gmx.de>; Jim Idle <jimi at temporal-wave.com>; antlr-interest <antlr-interest at antlr.org>
> Sent: Friday, July 18, 2008 1:58:00 PM
> Subject: Re: [antlr-interest] Tokenising for context specific reserved words
> 
> 
> On Jul 18, 2008, at 1:59 AM, Loring Craymer wrote:
> 
> > Actually, I just thought of a hybrid approach:? support subtypes for? 
> > double-quoted literals and have the subtype field set by the lexer.? 
> > Then, a doubly quoted literal reference in a grammar is handled by? 
> > looking at the subtype field, while an ID reference looks at the? 
> > type field.? Except for the extra field (which probably costs? 
> > nothing--minimum allocation sizes are usually larger than tokens),? 
> > the only added runtime overhead would be in the lexer to set the? 
> > subtype field.
> 
> There was an interesting paper called "Schrodinger's tokens"... if you? 
> are a physics or quantum physics buff, you get the reference ;)
> 
> Ter



      


From amax at redsymbol.net  Fri Jul 18 14:55:52 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Fri, 18 Jul 2008 14:55:52 -0700
Subject: [antlr-interest] python-lang parser to python target
Message-ID: <200807181455.52897.amax@redsymbol.net>

Hi all,

I'm using antlr 3.1b2 to generate a python-language parser, using Frank 
Wierzbicki's python 2.5 grammar [0].  I'm generating it to the Python target.  
The lexer has some java code interspersed - for example, the PythonLexer 
constructor sports this at the end:
{{{
    /** Handles context-sensitive lexing of implicit line joining such as
     *  the case where newline is ignored in cases like this:
     *  a = [3,
     *       4]
     */
    int implicitLineJoiningLevel = 0;
    int startPos=-1;
}}}

This snippet is identical to what is in the corresponding spot in the java 
target lexer.  There are other small places where one or two lines of java 
code exist, i.e. it will say "implicitLineJoiningLevel++;" instead 
of "self.implicitLineJoiningLevel += 1".  In MOST of these, the java code is 
wrapped by Python comment lines saying "#action start" and "#action stop".

What can I do about this?  I'm happy to contribute code, and would love to 
decipher the bug and contribute a fix.  I'm not fluent in Java and very new 
to Antlr, though, so I'm not sure how likely that is.  Any pointers 
appreciated.

As for what I'm using this for, I have a semi-immediate need for it to "just 
work", and as a fallback I'm planning to just hand-convert the inline java 
code to python.  This looks pretty straightforward, except for the emit() 
function - e.g.:
{{{
                #action start
                emit(new ClassicToken(NEWLINE,nl.getText()));
                #action end
}}}

What would the Python equivalent of emit() be?

Thanks,
Aaron

[0] http://www.antlr.org/grammar/1200715779785/Python.g

-- 
Aaron Maxwell
http://redsymbol.net

From amax at redsymbol.net  Fri Jul 18 15:11:31 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Fri, 18 Jul 2008 15:11:31 -0700
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <200807181455.52897.amax@redsymbol.net>
References: <200807181455.52897.amax@redsymbol.net>
Message-ID: <200807181511.31763.amax@redsymbol.net>

On Friday 18 July 2008 02:55:52 pm Aaron Maxwell wrote:
> What would the Python equivalent of emit() be?

Whoops, sorry for the silly question - it's a method of Lexer.


-- 
Aaron Maxwell
http://redsymbol.net

From andy at doddington.net  Sat Jul 19 04:59:07 2008
From: andy at doddington.net (Andy Doddington)
Date: Sat, 19 Jul 2008 12:59:07 +0100
Subject: [antlr-interest] Grammar for block comments?
In-Reply-To: <1216312661.7476.13.camel@jimi>
References: <487CE237.1010302@doddington.net>	<20080715204106.E3B93358261@spf6-6.us4.outblaze.com>	<487E3592.2010301@doddington.net>	<20080716211942.6834110D72D@spf6-3.us4.outblaze.com>	<487EFB30.8070308@doddington.net>	<20080717083830.4BB20352294@www.antlr.org>
	<1216312661.7476.13.camel@jimi>
Message-ID: <4881D70B.5070204@doddington.net>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080719/8ae83815/attachment.html 

From amax at redsymbol.net  Sat Jul 19 08:21:11 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Sat, 19 Jul 2008 08:21:11 -0700
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <200807181455.52897.amax@redsymbol.net>
References: <200807181455.52897.amax@redsymbol.net>
Message-ID: <200807190821.11687.amax@redsymbol.net>

Hey all,

Please disregard my question.  I realize I mainly need to have read to manuals 
more.  For the record, the mentioned python grammar is tailored to the Java 
target.  I'll work at converting it to the python target, which I believe is 
the right approach (someone please correct me if I'm mistaken).

Aaron

On Friday 18 July 2008 02:55:52 pm Aaron Maxwell wrote:
> Hi all,
>
> I'm using antlr 3.1b2 to generate a python-language parser, using Frank
> Wierzbicki's python 2.5 grammar [0].  I'm generating it to the Python
> target. The lexer has some java code interspersed - for example, the
> PythonLexer constructor sports this at the end:



-- 
Aaron Maxwell
http://redsymbol.net

From brent.yates at gmail.com  Sat Jul 19 14:58:09 2008
From: brent.yates at gmail.com (Brent Yates)
Date: Sat, 19 Jul 2008 17:58:09 -0400
Subject: [antlr-interest] Error recovery during list assembly
Message-ID: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.com>

For the following rule:

list
    :   BEGIN item* END
    ;

I would like to be able to recovery from tokens which are not valid items
and not the END literal in such a way that the item list assembly keeps
going.  From inspection of the currently generated code (3.1b2, C target)
the parser will check to see if the next token matches one of the expected
tokens for item.  If it does, it calls the item rule, if not, it drops out
of the item loop and tries to match the END literal.  If the end match fails
then a normal single token delete/insert recovery is tried.  The parser is
expecting the END literal though, not more items, and I don't
see a way to get back into the items loop.

It seems that I need the recovery to happen in the item rule function, but
the error is not detected in the item rule - it is detected in the check for
END.

Is there a way to structure the rule to help this situation or is there a
manual way to code via actions or overrides a way to recover from these
sorts of input errors?

Thanks!

Brent Yates
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080719/f97f3ac2/attachment.html 

From jaluber at gmx.de  Sat Jul 19 15:25:08 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 20 Jul 2008 00:25:08 +0200
Subject: [antlr-interest] Error recovery during list assembly
In-Reply-To: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.com>
References: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.com>
Message-ID: <488269C4.6050301@gmx.de>

Brent Yates schrieb:
> For the following rule:
> 
> list
>     :   BEGIN item* END
>     ;
>    
> I would like to be able to recovery from tokens which are not valid 
> items and not the END literal in such a way that the item list assembly 
> keeps going.  From inspection of the currently generated code (3.1b2, C 
> target) the parser will check to see if the next token matches one of 
> the expected tokens for item.  If it does, it calls the item rule, if 
> not, it drops out of the item loop and tries to match the END literal.  
> If the end match fails then a normal single token delete/insert recovery 
> is tried.  The parser is expecting the END literal though, not more 
> items, and I don't
> see a way to get back into the items loop.
> 
> It seems that I need the recovery to happen in the item rule function, 
> but the error is not detected in the item rule - it is detected in the 
> check for END.
> 
> Is there a way to structure the rule to help this situation or is there 
> a manual way to code via actions or overrides a way to recover from 
> these sorts of input errors?
> 
> Thanks!
> 
> Brent Yates

You are describing a situation which mention Ter on his blog once. IIRC 
then ANTLR doesn't handle this situation itself. I don't know if you can 
overwrite this behaviour yourself. :(

Johannes

From antlr at mirality.co.nz  Sat Jul 19 18:16:05 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 20 Jul 2008 13:16:05 +1200
Subject: [antlr-interest] Tokenising for context specific reserved words
In-Reply-To: <81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>
References: <461631.90410.qm@web55907.mail.re3.yahoo.com>
	<81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>
Message-ID: <20080720011644.D442B11EAE9@www.antlr.org>

At 08:58 19/07/2008, Terence Parr wrote:
 >There was an interesting paper called "Schrodinger's tokens"...
 >if you are a physics or quantum physics buff, you get the
 >reference ;)

I haven't looked up the paper, but the mental images that the 
title alone conjures up sound quite cool :)

All sorts of useful things could be done if the lexer could 
generate a token that was simultaneously a member of multiple 
types -- eg. on seeing the input "10", it could generate a token 
that could be used as either a INT_LITERAL or FLOAT_LITERAL, as 
parser context demanded (or even BINARY_LITERAL, depending on 
domain).  And on seeing "if", it could be used as either 
IF_KEYWORD or IDENTIFIER.

Of course that's doable in ANTLR at the moment via helper parser 
rules, but it'd be cool if this were a first-party construct.  I 
guess it could be implemented either as multiple types stored 
against a particular instance of a token (which is the most 
flexible, but will slow down token comparisons somewhat), or as 
hierarchies of tokens (eg. in the examples above, any INT_LITERAL 
can be used in place of a FLOAT_LITERAL, but not the reverse; 
similarly, any IF_KEYWORD can be used as an IDENTIFIER, but not 
the reverse).  The second option is less flexible but it's 
probably sufficient for most scenarios I can think of at the 
moment, and I suspect it'd end up generating faster code (since 
most of it can be dealt with statically).


From antlr at mirality.co.nz  Sat Jul 19 18:25:30 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 20 Jul 2008 13:25:30 +1200
Subject: [antlr-interest] Error recovery during list assembly
In-Reply-To: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.co
 m>
References: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.com>
Message-ID: <20080720012536.56DB811EC74@www.antlr.org>

At 09:58 20/07/2008, Brent Yates wrote:
>For the following rule:
>
>list
>     :   BEGIN item* END
>     ;
>
>I would like to be able to recovery from tokens which are not 
>valid items and not the END literal in such a way that the item 
>list assembly keeps going.  From inspection of the currently 
>generated code (3.1b2, C target) the parser will check to see if 
>the next token matches one of the expected tokens for item.  If 
>it does, it calls the item rule, if not, it drops out of the item 
>loop and tries to match the END literal.  If the end match fails 
>then a normal single token delete/insert recovery is tried.  The 
>parser is expecting the END literal though, not more items, and I 
>don't see a way to get back into the items loop.

This is just off the cuff; I'm not entirely sure if it'll work or 
if it'll do what you want, but it could be worth trying :)

list
   :  BEGIN
      ( item
      | (~END) => . { /* report an error */ }
      )* END
   ;

In theory, this will produce one "error" for each token that can't 
be interpreted as an item, and will exit the loop only when it 
sees the END.

If 'item' is particularly long or contains loops, you might need 
to add a synpred to it as well to let it backtrack and generate an 
error:

list
   :  BEGIN
      ( (item) => item
      | (~END) => . { /* report an error */ }
      )* END
   ;

Actually, you can probably even get away with just this, now that 
I think about it:
   list : BEGIN ( item | ~END { /* error */ } )* END;


From brent.yates at gmail.com  Sat Jul 19 18:35:59 2008
From: brent.yates at gmail.com (Brent Yates)
Date: Sat, 19 Jul 2008 21:35:59 -0400
Subject: [antlr-interest] Error recovery during list assembly
In-Reply-To: <48829410.26e3220a.25bb.1014SMTPIN_ADDED@mx.google.com>
References: <6edc6c380807191458l131e11fctb66b631f088aabab@mail.gmail.com>
	<48829410.26e3220a.25bb.1014SMTPIN_ADDED@mx.google.com>
Message-ID: <6edc6c380807191835h2ea9a00bh707748c76bdc27b9@mail.gmail.com>

Gavin,

I have tried your suggestions and several variants but I can't seem to get a
version that doesn't have a million ambiguities.  Adding synpred's didn't
help.   I will keep trying...

Brent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080719/79830bcc/attachment.html 

From pink at odahoda.de  Sun Jul 20 01:33:32 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Sun, 20 Jul 2008 10:33:32 +0200
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <200807190821.11687.amax@redsymbol.net>
References: <200807181455.52897.amax@redsymbol.net>
	<200807190821.11687.amax@redsymbol.net>
Message-ID: <543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>

Hi Aaron,

there is a Python grammar in examples package. It's the 2.3 grammar,
but you may use parts of both to get a working Python2.5 grammar.
Please note that I haven't tested, if the python target of beta 2 is
fully operational, you may have to use b1 (which is tested and IIRC
there were no bugs reported for it), if you run into problems.

Ter: The download page says "ANTLR v3 sample grammars (C, C#, Java
targets). " Can you add ActionScript and Python? Thanks.

-Ben

On Sat, Jul 19, 2008 at 5:21 PM, Aaron Maxwell <amax at redsymbol.net> wrote:
> Hey all,
>
> Please disregard my question.  I realize I mainly need to have read to manuals
> more.  For the record, the mentioned python grammar is tailored to the Java
> target.  I'll work at converting it to the python target, which I believe is
> the right approach (someone please correct me if I'm mistaken).
>
> Aaron
>
> On Friday 18 July 2008 02:55:52 pm Aaron Maxwell wrote:
>> Hi all,
>>
>> I'm using antlr 3.1b2 to generate a python-language parser, using Frank
>> Wierzbicki's python 2.5 grammar [0].  I'm generating it to the Python
>> target. The lexer has some java code interspersed - for example, the
>> PythonLexer constructor sports this at the end:
>
>
>
> --
> Aaron Maxwell
> http://redsymbol.net
>

From jaluber at gmx.de  Sun Jul 20 02:35:16 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 20 Jul 2008 11:35:16 +0200
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>
References: <200807181455.52897.amax@redsymbol.net>	<200807190821.11687.amax@redsymbol.net>
	<543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>
Message-ID: <488306D4.4020108@gmx.de>

Benjamin Niemann schrieb:
> Hi Aaron,
> 
> there is a Python grammar in examples package. It's the 2.3 grammar,
> but you may use parts of both to get a working Python2.5 grammar.
> Please note that I haven't tested, if the python target of beta 2 is
> fully operational, you may have to use b1 (which is tested and IIRC
> there were no bugs reported for it), if you run into problems.
> 
> Ter: The download page says "ANTLR v3 sample grammars (C, C#, Java
> targets). " Can you add ActionScript and Python? Thanks.
> 
> -Ben

Regarding the sample grammars: In the repository there are sample 
grammars for these languages as well. Ter is probably planning to update 
the download once 3.1 is released, but in the meantime try fisheye or 
get read-access to the repo.

Johannes
> 
> On Sat, Jul 19, 2008 at 5:21 PM, Aaron Maxwell <amax at redsymbol.net> wrote:
>> Hey all,
>>
>> Please disregard my question.  I realize I mainly need to have read to manuals
>> more.  For the record, the mentioned python grammar is tailored to the Java
>> target.  I'll work at converting it to the python target, which I believe is
>> the right approach (someone please correct me if I'm mistaken).
>>
>> Aaron
>>
>> On Friday 18 July 2008 02:55:52 pm Aaron Maxwell wrote:
>>> Hi all,
>>>
>>> I'm using antlr 3.1b2 to generate a python-language parser, using Frank
>>> Wierzbicki's python 2.5 grammar [0].  I'm generating it to the Python
>>> target. The lexer has some java code interspersed - for example, the
>>> PythonLexer constructor sports this at the end:
>>
>>
>> --
>> Aaron Maxwell
>> http://redsymbol.net
>>
> 


From r_reitzi at cs.uni-kl.de  Sun Jul 20 09:03:56 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Sun, 20 Jul 2008 18:03:56 +0200
Subject: [antlr-interest] Tokenising for context specific reserved	words
In-Reply-To: <20080720011644.D442B11EAE9@www.antlr.org>
References: <461631.90410.qm@web55907.mail.re3.yahoo.com>
	<81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>
	<20080720011644.D442B11EAE9@www.antlr.org>
Message-ID: <20080720180356.mn2wdhzaqs0cs4kc@webmail.verrech.net>

To be consequent, one could generate one class per token type.  
Subtyping would give you what you want, I suppose.

Anyway, what about predefining often used tokens like  
(DOUBLE|SINGLE)_QUOTED_STRING, INT, FLOAT, WHITESPACE, LINEBREAK, ...?  
With the option to overwrite them, of course.

Regards

Raphael

----- Message from antlr at mirality.co.nz ---------
     Date: Sun, 20 Jul 2008 13:16:05 +1200
     From: Gavin Lambert <antlr at mirality.co.nz>
Reply-To: Gavin Lambert <antlr at mirality.co.nz>
  Subject: Re: [antlr-interest] Tokenising for context specific reserved words
       To: Terence Parr <parrt at cs.usfca.edu>, Loring Craymer  
<lgcraymer at yahoo.com>
       Cc: antlr-interest <antlr-interest at antlr.org>


> At 08:58 19/07/2008, Terence Parr wrote:
>> There was an interesting paper called "Schrodinger's tokens"...
>> if you are a physics or quantum physics buff, you get the
>> reference ;)
>
> I haven't looked up the paper, but the mental images that the title
> alone conjures up sound quite cool :)
>
> All sorts of useful things could be done if the lexer could generate a
> token that was simultaneously a member of multiple types -- eg. on
> seeing the input "10", it could generate a token that could be used as
> either a INT_LITERAL or FLOAT_LITERAL, as parser context demanded (or
> even BINARY_LITERAL, depending on domain).  And on seeing "if", it
> could be used as either IF_KEYWORD or IDENTIFIER.
>
> Of course that's doable in ANTLR at the moment via helper parser rules,
> but it'd be cool if this were a first-party construct.  I guess it
> could be implemented either as multiple types stored against a
> particular instance of a token (which is the most flexible, but will
> slow down token comparisons somewhat), or as hierarchies of tokens (eg.
> in the examples above, any INT_LITERAL can be used in place of a
> FLOAT_LITERAL, but not the reverse; similarly, any IF_KEYWORD can be
> used as an IDENTIFIER, but not the reverse).  The second option is less
> flexible but it's probably sufficient for most scenarios I can think of
> at the moment, and I suspect it'd end up generating faster code (since
> most of it can be dealt with statically).


----- End message from antlr at mirality.co.nz -----


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080720/4d6ab436/attachment-0002.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-keys
Size: 1690 bytes
Desc: PGP Public Key
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080720/4d6ab436/attachment-0003.bin 

From antlr at mirality.co.nz  Sun Jul 20 13:23:46 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 21 Jul 2008 08:23:46 +1200
Subject: [antlr-interest] Tokenising for context specific reserved	words
In-Reply-To: <20080720180356.mn2wdhzaqs0cs4kc@webmail.verrech.net>
References: <461631.90410.qm@web55907.mail.re3.yahoo.com>
	<81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>
	<20080720011644.D442B11EAE9@www.antlr.org>
	<20080720180356.mn2wdhzaqs0cs4kc@webmail.verrech.net>
Message-ID: <20080720202356.11D6811ED13@www.antlr.org>

At 04:03 21/07/2008, Raphael Reitzig wrote:
 >To be consequent, one could generate one class per token type.
 >Subtyping would give you what you want, I suppose.

Well, yeah, you *could* do it that way, but that seems far too 
heavyweight (and wouldn't work for the C target anyway).

 >Anyway, what about predefining often used tokens like
 >(DOUBLE|SINGLE)_QUOTED_STRING, INT, FLOAT, WHITESPACE, 
LINEBREAK,
 >...?
 >With the option to overwrite them, of course.

No, I don't think that's a good idea.  Although having them as 
easily-insertable templates in ANTLRworks could be useful.


From jklumpp0 at vt.edu  Sun Jul 20 17:18:33 2008
From: jklumpp0 at vt.edu (Joseph Klumpp)
Date: Sun, 20 Jul 2008 20:18:33 -0400
Subject: [antlr-interest] Ada Grammar Question
Message-ID: <dccad1de0807201718g240497c7jf06a87ea2761e4c@mail.gmail.com>

I have recently been updating the Ada grammar from
http://antlr.org/grammar/ada/ada.g to Antlr v3.  In testing this
grammar against the Ada Compiler test suite, I found that this grammar
fails for very specific constructs - all related with the Ada TIC mark
becoming confused with the CHARACHTER_LITERAL (or vice-versa).  The
rules are duplicated here:

TIC    : { LA(3)!='\'' }?  '\''    ;
        // condition needed to disambiguate from CHARACTER_LITERAL


CHARACTER_LITERAL    : { LA(3)=='\'' }? // condition needed to
disambiguate from TIC
       "'" . "'"


I rewrote these as:
TIC: {LA(3) != '\''} => "\'";
CHARACTER_LITERAL: {LA(3) == '\''}? => "\'" . "\'";

This works fine except for in constructs such as:
VAR_1 := ArrayType'('a','b','c' => X, others => Y);

In these situations the open parenthesis would be considered a
character literal and not a TIC mark, as it should be.  Any help in
how I could differentiate between this mark and character literals
would be greatly appreciated.

From parrt at cs.usfca.edu  Sun Jul 20 17:37:57 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 20 Jul 2008 17:37:57 -0700
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <488306D4.4020108@gmx.de>
References: <200807181455.52897.amax@redsymbol.net>	<200807190821.11687.amax@redsymbol.net>
	<543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>
	<488306D4.4020108@gmx.de>
Message-ID: <4CA6118B-B426-43FA-99D0-30296BBA0ACE@cs.usfca.edu>


On Jul 20, 2008, at 2:35 AM, Johannes Luber wrote:

> Benjamin Niemann schrieb:
>> there were no bugs reported for it), if you run into problems.
>> Ter: The download page says "ANTLR v3 sample grammars (C, C#, Java
>> targets). " Can you add ActionScript and Python? Thanks.
>>
Fixed
Ter

From dermot_1 at astrodrive.com  Mon Jul 21 06:46:33 2008
From: dermot_1 at astrodrive.com (dermot_1 at astrodrive.com)
Date: Mon, 21 Jul 2008 14:46:33 +0100
Subject: [antlr-interest] Problem/bug in overriding ErrorNode in C# target
	(3.1b2)
Message-ID: <000101c8eb38$30a36650$91ea32f0$@com>

I need to override the ErrorNode method defined in BaseTreeAdapter.cs.

 

However, this is not marked as virtual - so I can't.

 

>From the comments in the method, it looks like it should be virtual - and
when I modify the source code to do this everything works fine for me. 

 

So I would guess that it's a small bug in the C# target?

 

 

Dermot

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/08bd8b61/attachment.html 

From markwright at internode.on.net  Mon Jul 21 06:49:22 2008
From: markwright at internode.on.net (Mark Wright)
Date: Mon, 21 Jul 2008 23:49:22 +1000
Subject: [antlr-interest] Ada Grammar Question
In-Reply-To: <dccad1de0807201718g240497c7jf06a87ea2761e4c@mail.gmail.com>
References: <dccad1de0807201718g240497c7jf06a87ea2761e4c@mail.gmail.com>
Message-ID: <20080721234922.00005de3@goanna>

Hello Joseph,

One idea to write disambiguating semantic predicates in the
target language that figure out the answer, and call them
in the lexer something like:

TIC: {isTIC(input)}? "\'";
CHARACTER_LITERAL: {isCharacterLiteral(input)}? "\'" . "\'";

I have never tried calling disambiguating semantic predicates in
a lexer.  I guess they work in the lexer, I am not sure.
It certainly seems different in the lexer, as I guess then you
are looking at individual characters (instead of tokens for
a dis-ambiguating semantic predicate used in the parser).

Then the disambiguating semantic predicates can do things like
the following to figure out the answers.  I don't know exactly
what you need to do as I am not familar enough with the ADA grammar.

- scan ahead matching parentheses and ' chars looking for dis-ambiguating
characters, like maybe the ; or I am not sure.

- if necessary it can call other functions, which possibly call themselves.
Dis-ambiguating semantic predicates can be implemented as little hand coded
recursive descent compilers, hopefully you don't need to do that in
a lexer.

On Sun, 20 Jul 2008 20:18:33 -0400
"Joseph Klumpp" <jklumpp0 at vt.edu> wrote:

> I have recently been updating the Ada grammar from
> http://antlr.org/grammar/ada/ada.g to Antlr v3.  In testing this
> grammar against the Ada Compiler test suite, I found that this grammar
> fails for very specific constructs - all related with the Ada TIC mark
> becoming confused with the CHARACHTER_LITERAL (or vice-versa).  The
> rules are duplicated here:
> 
> TIC    : { LA(3)!='\'' }?  '\''    ;
>         // condition needed to disambiguate from CHARACTER_LITERAL
> 
> 
> CHARACTER_LITERAL    : { LA(3)=='\'' }? // condition needed to
> disambiguate from TIC
>        "'" . "'"
> 
> 
> I rewrote these as:
> TIC: {LA(3) != '\''} => "\'";
> CHARACTER_LITERAL: {LA(3) == '\''}? => "\'" . "\'";
> 
> This works fine except for in constructs such as:
> VAR_1 := ArrayType'('a','b','c' => X, others => Y);
> 
> In these situations the open parenthesis would be considered a
> character literal and not a TIC mark, as it should be.  Any help in
> how I could differentiate between this mark and character literals
> would be greatly appreciated.


-- 

From jaluber at gmx.de  Mon Jul 21 08:15:44 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 21 Jul 2008 17:15:44 +0200
Subject: [antlr-interest] Problem/bug in overriding ErrorNode in C#
 target (3.1b2)
In-Reply-To: <000101c8eb38$30a36650$91ea32f0$@com>
References: <000101c8eb38$30a36650$91ea32f0$@com>
Message-ID: <4884A820.2010106@gmx.de>

dermot_1 at astrodrive.com schrieb:
> I need to override the ErrorNode method defined in BaseTreeAdapter.cs.
> 
>  
> 
> However, this is not marked as virtual ? so I can?t.
> 
>  
> 
>  From the comments in the method, it looks like it should be virtual ? 
> and when I modify the source code to do this everything works fine for me.
> 
>  
> 
> So I would guess that it?s a small bug in the C# target?
>

Looks like it - thanks for headup! Fixed for next beta.

Johannes

>  
> 
>  
> 
> Dermot
> 


From rkevinburton at charter.net  Mon Jul 21 10:17:44 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 21 Jul 2008 13:17:44 -0400
Subject: [antlr-interest] Debug using ANTLRWorks
Message-ID: <20080721131744.AJN4W.58438.root@fepweb15>

I am trying to use the debug feature of ANTLRWorks but the "debugger" claims that it cannot find javac. I am on a Windows platform and ANTLRWorks runs so I know that Java is installed. Where is javac?

Thank you.

Kevin


From jaluber at gmx.de  Mon Jul 21 10:26:09 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 21 Jul 2008 19:26:09 +0200
Subject: [antlr-interest] Debug using ANTLRWorks
In-Reply-To: <20080721131744.AJN4W.58438.root@fepweb15>
References: <20080721131744.AJN4W.58438.root@fepweb15>
Message-ID: <4884C6B1.2060103@gmx.de>

rkevinburton at charter.net schrieb:
> I am trying to use the debug feature of ANTLRWorks but the "debugger" claims that it cannot find javac. I am on a Windows platform and ANTLRWorks runs so I know that Java is installed. Where is javac?
> 
> Thank you.
> 
> Kevin
> 

There is a difference between the Java Runtime Environment (JRE) and the 
Java Software Development Kit (SDK). Only the latter contains the 
compiler. Please download and install the SDK first before using the 
debug feature. You can test the presence of javac by running it in a 
command line, if you are convinced to have the SDK installed already. If 
it doesn't find javac then do instal the SDK. If it does find javac then 
try changing the preferences of ANTLRworks.

Johannes

From johan.grande at crans.org  Mon Jul 21 11:07:39 2008
From: johan.grande at crans.org (Johan Grande)
Date: Mon, 21 Jul 2008 20:07:39 +0200
Subject: [antlr-interest] lexer doesn't see super constructor & inherited
	variable
Message-ID: <4884D06B.1040105@crans.org>

Hello,


I'm working on generating ASTs for the Java (v1.5) language using ANTLR 
(v3.1b2) and the grammar written by Terence Parr (v1.0.6).

I get a strange error during the compilation of the generated lexer. 
(ANTLR itself gives no error). Javac outputs a lot of errors.

The first is :
| [...]/JavaLexer.java:325: cannot find symbol
| symbol  : constructor 
Lexer(org.antlr.runtime.CharStream,org.antlr.runtime.RecognizerSharedState)
| location: class org.antlr.runtime.Lexer
|         super(input,state);
|         ^

And all the following look like the second :
| [...]/JavaLexer.java:343: cannot find symbol
| symbol  : variable state
| location: class parser.JavaLexer
|             state.type = _type;
|             ^

I think my CLASSPATH is good : it contains the JARs of ANTLR v3.1b2 and 
of no other ANTLR version.

I verified : the generated lexer imports org.antlr.runtime.* .
I even verified : constructor and the "state" variable do exist in the 
inherited classes.

I'm not an expert in Java programming, and I don't see from where the 
problem can come. Any idea ?


Sorry for English mistakes (I'm French),
Thank you for your help,
Johan Grande


From r_reitzi at cs.uni-kl.de  Mon Jul 21 12:44:20 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Mon, 21 Jul 2008 21:44:20 +0200
Subject: [antlr-interest] lexer doesn't see super constructor
	&	inherited variable
In-Reply-To: <4884D06B.1040105@crans.org>
References: <4884D06B.1040105@crans.org>
Message-ID: <20080721214420.65331lsreb5k0sas@horde.verrech.net>

Hi Johan!

Do you use Java 6 for compilation? I do not know if it makes a  
difference here, but one never knows. I experienced some strange  
behaviour trying to compile code with 1.5 that worked perfectly with 6.

Regards

Raphael

PS: Being a Frenchman is no excuse for bad English ;P
PPS: Your English is, at least, good enough for a German *giggle*

"Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 20:07:39 2008):

> Hello,
>
>
> I'm working on generating ASTs for the Java (v1.5) language using  
> ANTLR (v3.1b2) and the grammar written by Terence Parr (v1.0.6).
>
> I get a strange error during the compilation of the generated lexer.  
> (ANTLR itself gives no error). Javac outputs a lot of errors.
>
> The first is :
> | [...]/JavaLexer.java:325: cannot find symbol
> | symbol  : constructor  
> Lexer(org.antlr.runtime.CharStream,org.antlr.runtime.RecognizerSharedState)
> | location: class org.antlr.runtime.Lexer
> |         super(input,state);
> |         ^
>
> And all the following look like the second :
> | [...]/JavaLexer.java:343: cannot find symbol
> | symbol  : variable state
> | location: class parser.JavaLexer
> |             state.type = _type;
> |             ^
>
> I think my CLASSPATH is good : it contains the JARs of ANTLR v3.1b2  
> and of no other ANTLR version.
>
> I verified : the generated lexer imports org.antlr.runtime.* .
> I even verified : constructor and the "state" variable do exist in  
> the inherited classes.
>
> I'm not an expert in Java programming, and I don't see from where  
> the problem can come. Any idea ?
>
>
> Sorry for English mistakes (I'm French),
> Thank you for your help,
> Johan Grande
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/d6f18b90/attachment.bin 

From dave at tauzell.org  Mon Jul 21 12:54:01 2008
From: dave at tauzell.org (David Tauzell)
Date: Mon, 21 Jul 2008 14:54:01 -0500
Subject: [antlr-interest] Translating from one language to another
Message-ID: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>

I'd like to translate from language A to java.  I've written a grammar that
parses language A and generates an AST.   The language is mostly like java,
except there are a few cases where I'll need to change the input.  For
example, something like:

    a.b.c.d = foo

will be converted to

    a.get("b").get("c").get("d").setValue(foo)

Other stuff like:

   if( foo == "bar") {
      ...
   }

can stay like it is.

I'm not sure what is the best way to proceed.  Should I somehow use
StringTemplate?  Should I walk the AST and generate output? Is this question
to vague? Do I just need to buy the ANTLR book and learn more about ANTLR?

Thanks,
    Dave
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/5efd4e8e/attachment.html 

From johan.grande at crans.org  Mon Jul 21 12:52:53 2008
From: johan.grande at crans.org (Johan Grande)
Date: Mon, 21 Jul 2008 21:52:53 +0200
Subject: [antlr-interest] lexer doesn't see super
 constructor	&	inherited variable
In-Reply-To: <20080721214420.65331lsreb5k0sas@horde.verrech.net>
References: <4884D06B.1040105@crans.org>
	<20080721214420.65331lsreb5k0sas@horde.verrech.net>
Message-ID: <4884E915.3040009@crans.org>

Raphael Reitzig wrote:
> Do you use Java 6 for compilation?
Yes.
> I do not know if it makes a 
> difference here, but one never knows. I experienced some strange 
> behaviour trying to compile code with 1.5 that worked perfectly with 6.
> 

-- 
Johan

From r_reitzi at cs.uni-kl.de  Mon Jul 21 13:10:53 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Mon, 21 Jul 2008 22:10:53 +0200
Subject: [antlr-interest] lexer doesn't see
	super	constructor	&	inherited variable
In-Reply-To: <4884E915.3040009@crans.org>
References: <4884D06B.1040105@crans.org>
	<20080721214420.65331lsreb5k0sas@horde.verrech.net>
	<4884E915.3040009@crans.org>
Message-ID: <20080721221053.9423349djoc1z3gg@horde.verrech.net>

"Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 21:52:53 2008):

> Raphael Reitzig wrote:
>> Do you use Java 6 for compilation?
> Yes.

Interesting. I just successfully compiled the generated code for the  
same gramar. No errors, with only antlr-3.0.1 (added to standard lib)  
in classpath. So, you may have found a bug in the beta you used. *shrug*

# javac -version
javac 1.6.0_06

Regards

Raphael

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/81690728/attachment.bin 

From r_reitzi at cs.uni-kl.de  Mon Jul 21 13:18:09 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Mon, 21 Jul 2008 22:18:09 +0200
Subject: [antlr-interest] Tokenising for context specific	reserved	words
In-Reply-To: <200807202025.m6KKNsLD030216@mailgw3.uni-kl.de>
References: <461631.90410.qm@web55907.mail.re3.yahoo.com>
	<81A8918B-96BB-470E-96EF-A5304CF6A7A1@cs.usfca.edu>
	<20080720011644.D442B11EAE9@www.antlr.org>
	<20080720180356.mn2wdhzaqs0cs4kc@webmail.verrech.net>
	<200807202025.m6KKNsLD030216@mailgw3.uni-kl.de>
Message-ID: <20080721221809.632756rxgsipmjwo@horde.verrech.net>

"Gavin Lambert" <antlr at mirality.co.nz> wrote (Sun Jul 20 22:23:46 2008):

> Well, yeah, you *could* do it that way, but that seems far too  
> heavyweight (and wouldn't work for the C target anyway).

Who cares about the C target? :D

One would have to analyse runtime behaviour of a class based token  
model. I think it would loose because the easy use of switch-case (in  
java) would no longer be possible. But, then, perhaps you could wrap  
an enum around it... *phantasize*

> No, I don't think that's a good idea.  Although having them as  
> easily-insertable templates in ANTLRworks could be useful.

Hm, ack.

Regards

Raphael



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/87599d4e/attachment.bin 

From amax at redsymbol.net  Mon Jul 21 15:04:35 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Mon, 21 Jul 2008 15:04:35 -0700
Subject: [antlr-interest] Translating from one language to another
In-Reply-To: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
References: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
Message-ID: <200807211504.35905.amax@redsymbol.net>

On Monday 21 July 2008 12:54:01 pm David Tauzell wrote:
> I'm not sure what is the best way to proceed.  Should I somehow use
> StringTemplate?  Should I walk the AST and generate output? Is this
> question to vague? Do I just need to buy the ANTLR book and learn more
> about ANTLR?

I'm pretty new at using parser generators in general and antlr in particular, 
and you may want to listen if someone more experienced responds.  But for 
what it's worth, I recommend buying the new "Definitive ANTLR reference" 
book, which I have been reading the past week.  

ANTLR is a complex enough tool that it takes time to learn to use it well.  
It's pretty clear that the book has saved me a lot of time by teaching the 
essential theory and practical information much more quickly than I could 
figure it out from the online docs, trial and error, etc.

Your question is a good example: it's not really a short answer question, but 
the book is good at relatively quickly helping you decide what the best 
approach is and how to go about implementing the solution.

-- 
Aaron Maxwell
http://redsymbol.net

From johan.grande at crans.org  Mon Jul 21 14:35:35 2008
From: johan.grande at crans.org (Johan Grande)
Date: Mon, 21 Jul 2008 23:35:35 +0200
Subject: [antlr-interest] lexer doesn't
 see	super	constructor	&	inherited variable
In-Reply-To: <20080721221053.9423349djoc1z3gg@horde.verrech.net>
References: <4884D06B.1040105@crans.org>	<20080721214420.65331lsreb5k0sas@horde.verrech.net>	<4884E915.3040009@crans.org>
	<20080721221053.9423349djoc1z3gg@horde.verrech.net>
Message-ID: <48850127.3060908@crans.org>

Raphael Reitzig wrote:
> "Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 21:52:53 2008):
> 
>> Raphael Reitzig wrote:
>>> Do you use Java 6 for compilation?
>> Yes.
> 
> Interesting. I just successfully compiled the generated code for the 
> same gramar. No errors, with only antlr-3.0.1 (added to standard lib) in 
> classpath. So, you may have found a bug in the beta you used. *shrug*
> 
I first tried antlr-3.0.1 . But I found a bug in it : in some cases, in 
the generated parser, too many commas are written between arguments 
which correspond to rule parameters, and in my case the generated parser 
didn't compile.
This bug seem to be fixed in antlr-3.1b2, bug now there is that other 
one :-(

But actually, I don't see how there can even be a problem : there is a 
class, org.antlr.runtime.Lexer, which is in the classpath (seen by 
java), which contains a public constructor, and another class, 
JavaLexer, which extends it.
| public class JavaLexer extends Lexer {
|   [...]
|   public JavaLexer(CharStream input, RecognizerSharedState state) {
|     super(input,state);
|     }
|   [...]
| }
How can javac see a class but not a constructor in it ?
I think I can assume the .class included in antlr correspond to the 
.java provided ...

I don't know all the subtleties of Java, but it would be great if you 
could explain me how the bug can just exist.

> # javac -version
> javac 1.6.0_06
> 
Exactly.


Regards,
Johan


From rkevinburton at charter.net  Mon Jul 21 14:34:53 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 21 Jul 2008 14:34:53 -0700
Subject: [antlr-interest] Printing AST tree
Message-ID: <20080721173453.XN2AR.115096.root@fepweb09>

I am using CSharp and am starting my tour through ANTLR using the ANTLR book and the first road block that I came up with is printing out the AST tree. In the book there is a statement:

prog: ( stat {System.out.println($stat.tree.toStringTree());} )+ ;

I am try the following action:

program
	: (sourceElement { Console.WriteLine((CommonTree)$sourceElement.Tree); })*
	;



But from ANTLRWorks I am unable to generate code because 'Tree' is undefined. What is the equivalent C# statement for converting an AST tree to a string for pinrtout.

Thank you.

Kevin

From yotommy at gmail.com  Mon Jul 21 13:38:46 2008
From: yotommy at gmail.com (Tom Smith)
Date: Mon, 21 Jul 2008 16:38:46 -0400
Subject: [antlr-interest] Translating from one language to another
In-Reply-To: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
References: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
Message-ID: <82dc0d190807211338v7ef09461s8862c645e12b7cbd@mail.gmail.com>

In your case, I'd definitely say "buy the book," because there is a fine
example of a "rewriter," covered in detail over several subsections of
Chapter 9 (Generating Structured Text with Templates and Grammars).  There
is one version that rewrites straight from the parser grammar, and another
version using AST generation with a tree walker.

Hope this helps,
Tom.

On Mon, Jul 21, 2008 at 3:54 PM, David Tauzell <dave at tauzell.org> wrote:

> I'd like to translate from language A to java.  I've written a grammar that
> parses language A and generates an AST.   The language is mostly like java,
> except there are a few cases where I'll need to change the input.  For
> example, something like:
>
>     a.b.c.d = foo
>
> will be converted to
>
>     a.get("b").get("c").get("d").setValue(foo)
>
> Other stuff like:
>
>    if( foo == "bar") {
>       ...
>    }
>
> can stay like it is.
>
> I'm not sure what is the best way to proceed.  Should I somehow use
> StringTemplate?  Should I walk the AST and generate output? Is this question
> to vague? Do I just need to buy the ANTLR book and learn more about ANTLR?
>
> Thanks,
>     Dave
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/3572601a/attachment.html 

From rkevinburton at charter.net  Mon Jul 21 15:26:30 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 21 Jul 2008 15:26:30 -0700
Subject: [antlr-interest] AST tree print out.
Message-ID: <20080721182630.ZMSJN.116242.root@fepweb09>

I have been reading the ANTLR book and thinking that I hade "learned" enough I decided to tackle modifying an exisiting grammar. I picked a JavaScript.g grammar that was on the ANTLR grammar page. In this grammar I find:

functionDeclaration
	: FUNCTION name=functionName formalParameterList functionBody
	-> ^( FUNCTION $name formalParameterList functionBody )
	;

functionExpression
	: FUNCTION name=functionName? formalParameterList functionBody
	-> ^( FUNCTION $name? formalParameterList functionBody )
	;

functionName
	: Identifier
	;

formalParameterList
	: LPAREN ( args+=Identifier (COLON types+=Identifier)? ( COMMA args+=Identifier (COLON types+=Identifier)? )* )? RPAREN
	-> ^( ARGS $args* $types*)
	;
	
functionBody
	: lb=LBRACE sourceElement* RBRACE
	-> ^( BLOCK[$lb, "BLOCK"] sourceElement* )
	;

// $>
	
// $<	Program (14)

program
	: (sourceElement { Console.WriteLine((CommonTree)$sourceElement.tree); })*
	;

/*
By setting k  to 1 for this rule and adding the semantical predicate ANTRL will generate code that will always prefer functionDeclararion over functionExpression
here and therefor remove the ambiguity between these to production.
This will result in the same behaviour that is described in the specification under 12.4 on the expressionStatement rule.
*/
sourceElement
options
{
	k = 1 ;
}
	: { input.LA(1) == FUNCTION }? functionDeclaration
	| statement
	;

Basically I modifed the grammar to allow the function to take types for the arguments to the function. I also made this generate CSharp code and print out the AST list. But it is not producing the output that I would expect. I only get a long list of the string 'function' on the output. I don't see any tree or the arguments to the function. Have I misplaced '^' somehow? I don't see where else I could go.

Thank you.

Kevin

From Larry.Jones at aspentech.com  Mon Jul 21 14:08:43 2008
From: Larry.Jones at aspentech.com (Jones, Larry)
Date: Mon, 21 Jul 2008 16:08:43 -0500
Subject: [antlr-interest] Syntax for C# Namespaces
Message-ID: <690A62A322DBE24FAD5208C158E5DF2E013A6F69@houmail3.corp.aspentech.com>

I recently downloaded 3.1b2 and am implementing the tour/trees examples
for _The Definitive ANTLR Reference_.
 
I successfully built the examples using Java; however, I eventually want
to target C#.
 
My driver program uses a namespace. The wiki article on the CSharp
target describes the syntax to add a namespace; however, when I add
"@parser::namespace { Expr }" to my grammar file, ANTLR generates the
following error:

	ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)  1989-2008
	error(100): Expr.g:17:1: syntax error: antlr: Expr.g:17:1:
unexpected token: @
	error(100): Expr.g:17:20: syntax error: antlr: Expr.g:17:20:
unexpected token:  Expr 
	error(100): Expr.g:18:19: syntax error: antlr: Expr.g:18:19:
unexpected token:  Expr 
	 

The preceeding grammar lines are:
 

	grammar Expr;
	 
	options {
	 language=CSharp2;
	 
	 output=AST;
	 
	 // ANTLR can literally handle any tree node type.
	 // For convenience, specify the Java type.
	 ASTLabelType=CommonTree;   // type of $stat.tree ref etc.
	 
	}
	 
	/**
	 * Put both the parser and lexer in the same namespace as the
driver.
	 */
	@parser::namespace { Expr }
	@lexer::namespace { Expr }

What is the syntax for adding a C# namespace?
 
Thanks.
 
 
--

Lawrence Allan Jones
Senior Developer / Technical Advisor
Aspen Technology, Inc.
2500 CityWest Blvd. Suite 1500
Houston, Texas 77042
USA
281-504-3324 (work)
281-504-3395 (fax)
larry.jones at aspentech.com
www.aspentech.com <http://www.aspentech.com/> 

 
 	
 

This e-mail and any attachments are intended only for use by the addressee(s) named herein and may contain legally privileged and/or confidential information. If you are not the intended recipient of this e-mail, you are hereby notified any dissemination, distribution or copying of this email, and any attachments thereto, is strictly prohibited. If you receive this email in error please immediately notify the sender and permanently delete the original copy and any copy of any e-mail, and any printout thereof.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/028ae7b5/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 2078 bytes
Desc: email_2_03.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/028ae7b5/attachment.gif 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 200 bytes
Desc: email_2_04.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/028ae7b5/attachment-0001.gif 

From jaluber at gmx.de  Mon Jul 21 16:12:14 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 22 Jul 2008 01:12:14 +0200
Subject: [antlr-interest] Printing AST tree
In-Reply-To: <20080721173453.XN2AR.115096.root@fepweb09>
References: <20080721173453.XN2AR.115096.root@fepweb09>
Message-ID: <488517CE.40305@gmx.de>

rkevinburton at charter.net schrieb:
> I am using CSharp and am starting my tour through ANTLR using the ANTLR book and the first road block that I came up with is printing out the AST tree. In the book there is a statement:
> 
> prog: ( stat {System.out.println($stat.tree.toStringTree());} )+ ;
> 
> I am try the following action:
> 
> program
> 	: (sourceElement { Console.WriteLine((CommonTree)$sourceElement.Tree); })*
> 	;
> 
> 
> 
> But from ANTLRWorks I am unable to generate code because 'Tree' is undefined. What is the equivalent C# statement for converting an AST tree to a string for pinrtout.
> 
> Thank you.
> 
> Kevin
> 
Try "tree". ANTLR grammars follow Java and not C# conventions, and 
changing targets doesn't influence that.

Johannes

From jaluber at gmx.de  Mon Jul 21 16:15:46 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 22 Jul 2008 01:15:46 +0200
Subject: [antlr-interest] Syntax for C# Namespaces
In-Reply-To: <690A62A322DBE24FAD5208C158E5DF2E013A6F69@houmail3.corp.aspentech.com>
References: <690A62A322DBE24FAD5208C158E5DF2E013A6F69@houmail3.corp.aspentech.com>
Message-ID: <488518A2.8000203@gmx.de>

Jones, Larry schrieb:
> I recently downloaded 3.1b2 and am implementing the tour/trees examples 
> for _The Definitive ANTLR Reference_.
>  
> I successfully built the examples using Java; however, I eventually want 
> to target C#.
>  
> My driver program uses a namespace. The wiki article on the CSharp 
> target describes the syntax to add a namespace; however, when I add 
> "@parser::namespace { Expr }" to my grammar file, ANTLR generates the 
> following error:
> 
>     ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)  1989-2008
>     error(100): Expr.g:17:1: syntax error: antlr: Expr.g:17:1:
>     unexpected token: @
>     error(100): Expr.g:17:20: syntax error: antlr: Expr.g:17:20:
>     unexpected token:  Expr
>     error(100): Expr.g:18:19: syntax error: antlr: Expr.g:18:19:
>     unexpected token:  Expr
>      
> 
> The preceeding grammar lines are:
>  
> 
>     grammar Expr;
>      
>     options {
>      language=CSharp2;
>      
>      output=AST;
>      
>      // ANTLR can literally handle any tree node type.
>      // For convenience, specify the Java type.
>      ASTLabelType=CommonTree;   // type of $stat.tree ref etc.
>      
>     }
>      
>     /**
>      * Put both the parser and lexer in the same namespace as the driver.
>      */
>     @parser::namespace { Expr }
>     @lexer::namespace { Expr }
> 
> What is the syntax for adding a C# namespace?
>  
> Thanks.

I believe the problem is that you are using a Javadoc-style comment 
before @parser and ANTLR doesn't recognize this correctly. You can 
either remove one * in the first line or try if an empty line between 
comment and @parser helps.

Johannes
>  
>  
> 
> *--*
> 
> *Lawrence Allan Jones*
> *Senior Developer / Technical Advisor*
> Aspen Technology, Inc.
> 2500 CityWest Blvd. Suite 1500
> Houston, Texas 77042
> USA
> 281-504-3324 (work)
> 281-504-3395 (fax)
> larry.jones at aspentech.com <mailto:larry.jones at aspentech.com>
> www.aspentech.com <http://www.aspentech.com/>
> 
> 	
> 
>  
> 
> This e-mail and any attachments are intended only for use by the 
> addressee(s) named herein and may contain legally privileged and/or 
> confidential information. If you are not the intended recipient of this 
> e-mail, you are hereby notified any dissemination, distribution or 
> copying of this email, and any attachments thereto, is strictly 
> prohibited. If you receive this email in error please immediately notify 
> the sender and permanently delete the original copy and any copy of any 
> e-mail, and any printout thereof.


From Larry.Jones at aspentech.com  Mon Jul 21 14:36:36 2008
From: Larry.Jones at aspentech.com (Jones, Larry)
Date: Mon, 21 Jul 2008 16:36:36 -0500
Subject: [antlr-interest] Sequential Javadoc Comments in Grammar Files
Message-ID: <690A62A322DBE24FAD5208C158E5DF2E013A6F6B@houmail3.corp.aspentech.com>

To my surprise, I discovered that ANTLR produces an error if a grammer
file contains two consecutive Javadoc comments.
 
For example, the following grammar:

	grammar T;
	 
	/**
	 * Does Java accept two consecutive comments?
	 */
	 
	/** Match things like 'call foo;' */
	r  : 'call' ID ';' {System.out.println("invoke " + $ID.text);} ;
	ID : 'a'..'z'+ ;
	WS : ( ' ' | '\n' | '\r' )+ { $channel=HIDDEN; } ; // ignore
whitespace
	

Produces the following errors (built using Ant):
 

	generate:
	     [java] ANTLR Parser Generator  Version 3.1b2 (July 17,
2008)  1989-2008
	     [java] error(100): T.g:7:1: syntax error: antlr: T.g:7:1:
unexpected token: /** Match things like 'call foo;' */
	     [java] Java Result: 1
	

I did notice that if the first comment block is not a Javadoc style
comment, it compiles correctly.
 
What am I missing?
 
Thanks.
 
--

Lawrence Allan Jones
Senior Developer / Technical Advisor
Aspen Technology, Inc.
2500 CityWest Blvd. Suite 1500
Houston, Texas 77042
USA
281-504-3324 (work)
281-504-3395 (fax)
larry.jones at aspentech.com
www.aspentech.com <http://www.aspentech.com/> 

 
 	
 

This e-mail and any attachments are intended only for use by the addressee(s) named herein and may contain legally privileged and/or confidential information. If you are not the intended recipient of this e-mail, you are hereby notified any dissemination, distribution or copying of this email, and any attachments thereto, is strictly prohibited. If you receive this email in error please immediately notify the sender and permanently delete the original copy and any copy of any e-mail, and any printout thereof.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/12dcd4b8/attachment-0001.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 2078 bytes
Desc: email_2_03.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/12dcd4b8/attachment-0002.gif 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 200 bytes
Desc: email_2_04.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/12dcd4b8/attachment-0003.gif 

From parrt at cs.usfca.edu  Mon Jul 21 16:25:58 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 21 Jul 2008 16:25:58 -0700
Subject: [antlr-interest] Sequential Javadoc Comments in Grammar Files
In-Reply-To: <690A62A322DBE24FAD5208C158E5DF2E013A6F6B@houmail3.corp.aspentech.com>
References: <690A62A322DBE24FAD5208C158E5DF2E013A6F6B@houmail3.corp.aspentech.com>
Message-ID: <3A657AFD-E4F7-4D8F-8E24-A289DE381CAB@cs.usfca.edu>

the syntax only allows Java doc comments in front of a rule and just  
one :)
Ter
On Jul 21, 2008, at 2:36 PM, Jones, Larry wrote:

> To my surprise, I discovered that ANTLR produces an error if a  
> grammer file contains two consecutive Javadoc comments.
>
> For example, the following grammar:
> grammar T;
>
> /**
>  * Does Java accept two consecutive comments?
>  */
>
> /** Match things like 'call foo;' */
> r  : 'call' ID ';' {System.out.println("invoke " + $ID.text);} ;
> ID : 'a'..'z'+ ;
> WS : ( ' ' | '\n' | '\r' )+ { $channel=HIDDEN; } ; // ignore  
> whitespace
> Produces the following errors (built using Ant):
>
> generate:
>      [java] ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)   
> 1989-2008
>      [java] error(100): T.g:7:1: syntax error: antlr: T.g:7:1:  
> unexpected token: /** Match things like 'call foo;' */
>      [java] Java Result: 1
> I did notice that if the first comment block is not a Javadoc style  
> comment, it compiles correctly.
>
> What am I missing?
>
> Thanks.
>
> --
>
> Lawrence Allan Jones
> Senior Developer / Technical Advisor
> Aspen Technology, Inc.
> 2500 CityWest Blvd. Suite 1500
> Houston, Texas 77042
> USA
> 281-504-3324 (work)
> 281-504-3395 (fax)
> larry.jones at aspentech.com
> www.aspentech.com
>
>
>
>
>
> This e-mail and any attachments are intended only for use by the  
> addressee(s) named herein and may contain legally privileged and/or  
> confidential information. If you are not the intended recipient of  
> this e-mail, you are hereby notified any dissemination, distribution  
> or copying of this email, and any attachments thereto, is strictly  
> prohibited. If you receive this email in error please immediately  
> notify the sender and permanently delete the original copy and any  
> copy of any e-mail, and any printout thereof.


From lgcraymer at yahoo.com  Mon Jul 21 18:11:39 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 21 Jul 2008 18:11:39 -0700 (PDT)
Subject: [antlr-interest] Sequential Javadoc Comments in Grammar Files
Message-ID: <89431.50139.qm@web55911.mail.re3.yahoo.com>

Javadoc comments are recognized by the ANTLR parser grammar; non-Javadoc comments are filtered out by the lexer.  The grammar allows one Javadoc comment for the grammar after an optional action block but before the grammar declaration and one javadoc comment before each rule.  They are also passed on to the generated target code (which is why they are recognized by the parser in the first place).

--Loring



----- Original Message ----
From: "Jones, Larry" <Larry.Jones at aspentech.com>
To: antlr-interest at antlr.org
Sent: Monday, July 21, 2008 2:36:36 PM
Subject: [antlr-interest] Sequential Javadoc Comments in Grammar Files

Message 
To my surprise, I 
discovered that ANTLR produces an error if a grammer file contains two 
consecutive Javadoc comments.
 
For example, the 
following grammar:
grammar T;
 
/**
 * Does Java accept two  consecutive comments?
 */
 
/** Match things like 'call foo;'  */
r  : 'call' ID ';' {System.out.println("invoke " +  $ID.text);} ;
ID : 'a'..'z'+ ;
WS : ( ' ' | '\n' | '\r' )+ {  $channel=HIDDEN; } ; // ignore whitespace

Produces the 
following errors (built using Ant):
 
generate:
     [java] ANTLR Parser  Generator  Version 3.1b2 (July 17, 2008)   1989-2008
     [java] error(100): T.g:7:1: syntax  error: antlr: T.g:7:1: unexpected token: /** Match things like 'call foo;'  */
     [java] Java Result: 
1

I did notice that if the first comment block is not a 
Javadoc style comment, it compiles correctly.
 
What am I missing?
 
Thanks.
 
--
Lawrence Allan Jones
Senior Developer /  Technical Advisor
Aspen Technology, Inc.
2500 CityWest  Blvd. Suite 1500
Houston, Texas 77042
USA
281-504-3324  (work)
281-504-3395 (fax)
larry.jones at aspentech.com
www.aspentech.com   
 
This e-mail and any attachments are intended only for use by the addressee(s) named herein and may contain legally privileged and/or confidential information. If you are not the intended recipient of this e-mail, you are hereby notified any dissemination, distribution or copying of this email, and any attachments thereto, is strictly prohibited. If you receive this email in error please immediately notify the sender and permanently delete the original copy and any copy of any e-mail, and any printout thereof.



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/00559fc0/attachment.html 

From asoka250 at gmail.com  Mon Jul 21 19:11:44 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Mon, 21 Jul 2008 21:11:44 -0500
Subject: [antlr-interest] query in tree grammar - regd.
In-Reply-To: <7b0a1e4b0807110229j60741154h6b341359e64b3363@mail.gmail.com>
References: <7b0a1e4b0807102349i1f7b838atcab395ae6c3840fc@mail.gmail.com>
	<4877131c.39e9220a.4c9b.ffffc9b7SMTPIN_ADDED@mx.google.com>
	<7b0a1e4b0807110229j60741154h6b341359e64b3363@mail.gmail.com>
Message-ID: <7b0a1e4b0807211911r3f6b99e5t3da1dac0b41e3845@mail.gmail.com>

Hi,

I am stuck with the following error during conversion of dot grammar from
antlr 2.7.7 to antlr 3.0.1. I request the list to help me out.

On Fri, Jul 11, 2008 at 4:29 AM, ASHOK REDDY <asoka250 at gmail.com> wrote:

> Hi Gavin,
>
> I used the conversion utility and generated the attached tree grammar. I am
> not sure about the # and |! symbols too. What does the # symbol mean when it
> is included in actions. The actions are encoded in Java language.
>
>
> On Fri, Jul 11, 2008 at 3:00 AM, Gavin Lambert <antlr at mirality.co.nz>
> wrote:
>
>> At 18:49 11/07/2008, ASHOK REDDY wrote:
>>
>>>    |! { boolean record = false; } ^(LBR n=node_id record = l:a_list_node
>>> )
>>>        {
>>>            if(record) {
>>>                #node_edge_subgraph_stmt = #([RBR,"]"], n, l);
>>>             }
>>>            else{
>>>                    #node_edge_subgraph_stmt = #([LBR], n, l);
>>>             }
>>>
>> [...]
>>
>>> Antlrworks doesn't recognize l in record = l:a_list_node. How to convert
>>> this assignment statement to the latest syntax. Thank you. The whole tree
>>> grammar is attached for reference.
>>>
>>
>> Have you tried using the semi-automatic v2 -> v3 conversion utility?
>>
>> To answer your specific question, ANTLR v3 uses '=' instead of ':' for
>> labels now, so swap that over and it should fix that.  But there are other
>> problems there too -- the |! syntax isn't recognised AFAIK (what does that
>> even do?), and the #s seem wrong as well.
>>
>>
>
>
> --
> Ashok R Varikuti
> Graduate Research Assistant
> CIS Dept, Kansas State University
> 785-304-2401.
> ashokv at ksu.edu
>



-- 
Regards,
Ashok R Varikuti
Graduate Research Assistant
CIS Dept, Kansas State University
785-304-2401.
ashokv at ksu.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080721/28aec2c2/attachment.html 

From r_reitzi at cs.uni-kl.de  Tue Jul 22 00:31:52 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Tue, 22 Jul 2008 09:31:52 +0200
Subject: [antlr-interest] lexer
	doesn't	see	super	constructor	&	inherited variable
In-Reply-To: <48850127.3060908@crans.org>
References: <4884D06B.1040105@crans.org>
	<20080721214420.65331lsreb5k0sas@horde.verrech.net>
	<4884E915.3040009@crans.org>
	<20080721221053.9423349djoc1z3gg@horde.verrech.net>
	<48850127.3060908@crans.org>
Message-ID: <20080722093152.10411l4ktgbw35y8@horde.verrech.net>

"Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 23:35:35 2008):

> I first tried antlr-3.0.1 . But I found a bug in it [...] and in my  
> case the generated parser didn't compile.
Uh, so why did 3.0.1 work for me? That bugs _me_ o.o

> How can javac see a class but not a constructor in it ?
Usually, if there is no such construcor or it is hidden.

Wait. What package is the superclass in and which modifier got the  
constructor in question? Your parser will for sure be in another  
package. Thus, if constructors are package local, you may get those  
errors.

> I think I can assume the .class included in antlr correspond to the  
> .java provided ...
You should. However, if the distributor if the package did something  
wrong, weird stuff can happen. But since we both downloaded from  
antlr.org, I suppose, that cannot be the case.

> I don't know all the subtleties of Java, but it would be great if  
> you could explain me how the bug can just exist.
I can only think of Classpath and compatibility issues.

Do you run a MAC? Do you use some JDK _not_ from SUN? (I suppose both  
questions will be answered with 'no', for javac -version should have  
looked somehow different (?), but just to be sure)

Please send me both the gramar file and the jar you use. I want to try  
exactly this combination here...

Regards

Raphael


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/d0eeaee6/attachment.bin 

From jean-claude.durand at imag.fr  Tue Jul 22 02:26:14 2008
From: jean-claude.durand at imag.fr (Jean-Claude Durand)
Date: Tue, 22 Jul 2008 11:26:14 +0200
Subject: [antlr-interest] problem with composing grammars
Message-ID: <9DB7E157-5A99-47AD-B075-33FE22B27ABF@imag.fr>

   I try to compose grammars via the import instruction. The example  
'composite-java' works well, but mine
not: 'lexer' files are not generated.
   I use the Version 3.1b2 of ANTLR with the C target option.
   Here is a very simplified example from my grammars:

// file TRACOMPL.g:
grammar TRACOMPL;
options {language=C; }
import Dv, Dproc, Lex;

tracompl:
	dv
	dproc
	;

// file Lex.g
lexer grammar Lex;
DECVAR:	'-DECVAR-'	;
DPROC:		'-DPROC-'	;

LITTERAL:	('a'..'z' | 'A'..'Z' | '0'..'9')+	;
POINT:	'.'	;

// file Dv.g:
parser grammar Dv;

dv	:	
	DECVAR
	LITTERAL
	POINT		
	;

// and file Dproc.g:
parser grammar Dproc;

dproc:
	PROC
	dprocet
	;

dprocet:
	(
		LITTERAL POINT
	)*
	;



"java org.antlr.Tool TRACOMPL.g" only generates the .h and .c files  
TRACOMPLParser, TRACOMPL_Dv
and TRACOMPL_Dproc.
By calling directly the same command on Lex.g, it is possible to get  
the Lex.h
and Lex.c files (I added the 'language=C' in the Lex.g file). I  
should not have to do it.

I don't know how to get the 'TRACOMPLLexer'
.h and .c files (the equivalent of 'JavaLexer' in the composite-java  
example).

The example:

?


Another question I submitted a long time ago: it is always impossible to
use '?' ( a accent grave) even in comments of .g files, and in french  
we need it ! ;-)

Thanks a lot,

Jean-Claude Durand

LIG, ?quipe GETALP
385, rue de la Biblioth?que
BP 53
38041 Grenoble cedex 9
FRANCE

Jean-Claude.Durand at imag.fr
t?l: +33 (0)4 76 51 43 81
fax: +33 (0)4 76 51 44 05



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/5d88df2f/attachment-0002.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: simple.tar
Type: application/x-tar
Size: 10240 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/5d88df2f/attachment-0001.tar 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/5d88df2f/attachment-0003.html 

From dermot_1 at astrodrive.com  Tue Jul 22 02:42:22 2008
From: dermot_1 at astrodrive.com (dermot_1 at astrodrive.com)
Date: Tue, 22 Jul 2008 10:42:22 +0100
Subject: [antlr-interest] Token sorting in C# target (3.1b2)
Message-ID: <000301c8ebdf$3e32f360$ba98da20$@com>

Just working through the latest beta ... one thing that I would find very
useful if to have the tokens sorted in the generated files. For example, I
get this:

 

    public const int MOD = 143;

    public const int LETTER = 198;

    public const int CONST = 69;

 

it would make debugging a lot easier if the tokens were sorted numerically
like this:

 

    public const int MOD = 143;

    public const int INC = 144;

    public const int DEC = 145;

 

Currently, I have to do a search for (say) 144 to find out that it's a DEC
token - and with several hundred tokens it can be time consuming. This is
most noticeable in debugging tree grammars where I typically just have a
list of tokens to stare at.

 

Note that in Antlr 2.7 the tokens were sorted numerically.

 

 

Dermot

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/8f60ff6e/attachment.html 

From jaluber at gmx.de  Tue Jul 22 05:55:37 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 22 Jul 2008 14:55:37 +0200
Subject: [antlr-interest] Token sorting in C# target (3.1b2)
In-Reply-To: <000301c8ebdf$3e32f360$ba98da20$@com>
References: <000301c8ebdf$3e32f360$ba98da20$@com>
Message-ID: <4885D8C9.7080407@gmx.de>

dermot_1 at astrodrive.com schrieb:
> Just working through the latest beta ... one thing that I would find 
> very useful if to have the tokens sorted in the generated files. For 
> example, I get this:
> 
>     public const int MOD = 143;
>     public const int LETTER = 198;
>     public const int CONST = 69;
> 
> it would make debugging a lot easier if the tokens were sorted 
> numerically like this:
> 
>     public const int MOD = 143;
>     public const int INC = 144;
>     public const int DEC = 145;
> 
> Currently, I have to do a search for (say) 144 to find out that it?s a 
> DEC token ? and with several hundred tokens it can be time consuming. 
> This is most noticeable in debugging tree grammars where I typically 
> just have a list of tokens to stare at.
> 
> Note that in Antlr 2.7 the tokens were sorted numerically.
> 
> Dermot
> 

That's an ANTLR issue itself. The C# target has no way to influence 
this. Ter has to change this himself in the ANTLR tool.

Johannes

From craig at palantir.co.za  Tue Jul 22 06:31:16 2008
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Tue, 22 Jul 2008 15:31:16 +0200
Subject: [antlr-interest] table's in template from rule.
Message-ID: <20080722153116.q14ldvgg00gkww4g@webmail.palantir.co.za>

Hi,

Given the following production:
rule
scope 			{Dictionary<XNamespace, string> xnamespaces; }
@init			{$rule::xnamespaces = new Dictionary<XNamespace, string>(); }
:				path condition
				-> rule(path={$path.st}, condition={$condition.st}, xnamespaces={new
Hashtable($rule::xnamespaces)})
                ;

I am creating a hashtable (one of the supported template parameters).
Unfortunately I cannot seem to get access to the set of keys.

The template
<xnamespaces:{ x | K:<x> V:<xnamespaces.(x)> }>

Gives me the values not the keys. I understand the M/V separation issues, but
surely there is some way to iterate a set of name value pairs. Must I change
the dictionary to a list of instances of a class with a specific name and
value, surely there is a simple shortcut for iterating a dictionary or finding
a dictinoary value in a template?

I am using 3.1 (C# target).

Cheers
Regards
Craig.

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From vasanthi.ak at gmail.com  Tue Jul 22 07:53:56 2008
From: vasanthi.ak at gmail.com (vasanthi a)
Date: Tue, 22 Jul 2008 20:23:56 +0530
Subject: [antlr-interest] pls provide Grammar rule for __extension__
	and__gnuc_va_list
Message-ID: <307cfdc90807220753i4958c2fcr2339d70345de76ae@mail.gmail.com>

HI

Can anyone provide me C grammar rule for  __extension__ and typedef
__gnuc_va_list.

I have a stdc.g file,where all the rules for C grammar has been defined. But
the latest version of GCC compiler has
even typdef __extension  ....   and typdef __gnuc_va_list ..... defined with
it.
But I dont have the rules rules defined for __extension and __gnuc_valist.
Hence when ever while instrumenting the code..
I get an error "unexpected token: __gnuc_va_list" and error "unexpected
token: __extension__

This kind of error occurs when it encounters some line in my code like
" __extension__ typedef signed long long int __int64_t";


and


"typedef _builtin_Va_list  __gnuc_va_list;"

"typedef __gnuc_va_list va_list";

Kindly provide me rules code for this. This is needed urgently.

Kindly provide me the same asap.

Thanks and regards

Vasanthi.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/e265b5b6/attachment.html 

From antlr at jazillian.com  Tue Jul 22 08:38:15 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 22 Jul 2008 11:38:15 -0400
Subject: [antlr-interest] Translating from one language to another
In-Reply-To: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
References: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
Message-ID: <4885FEE7.9000805@jazillian.com>

A "quick and dirty" alternative approach to StringTemplate is
to write some code that just walks your AST, printing out code.
This: http://www.jazillian.com/antlr/emitter.html
just walks a Java AST and prints Java code.

David Tauzell wrote:
> I'd like to translate from language A to java.  I've written a grammar 
> that parses language A and generates an AST.   The language is mostly 
> like java, except there are a few cases where I'll need to change the 
> input.  For example, something like:
> 
>     a.b.c.d = foo
> 
> will be converted to
> 
>     a.get("b").get("c").get("d").setValue(foo)
> 
> Other stuff like:
> 
>    if( foo == "bar") {
>       ...
>    }
> 
> can stay like it is.
> 
> I'm not sure what is the best way to proceed.  Should I somehow use 
> StringTemplate?  Should I walk the AST and generate output? Is this 
> question to vague? Do I just need to buy the ANTLR book and learn more 
> about ANTLR?
> 
> Thanks,
>     Dave
> 
> 


From dav1dr at eml.cc  Tue Jul 22 09:14:47 2008
From: dav1dr at eml.cc (dav1dr at eml.cc)
Date: Tue, 22 Jul 2008 17:14:47 +0100
Subject: [antlr-interest] error recovery
Message-ID: <1216743287.15801.1264783053@webmail.messagingengine.com>

Hi,

it's my understanding that antlr will skip tokens in the input / insert
tokens if it comes across
input that it can't parse in an effort to end up with a string that is
parsable. How can I turn this
off? My parser is recognising strings that are not in my language, and I
don't want it to.

(specifically, I'm writing a C-like expression parser, which currently
accepts a string like
"(1 2)" by skipping the 2; this should be an error.

thanks

Dave
-- 
  
  dave_rodgman at fastmail.co.uk


From markwright at internode.on.net  Tue Jul 22 09:55:23 2008
From: markwright at internode.on.net (Mark Wright)
Date: Wed, 23 Jul 2008 02:55:23 +1000
Subject: [antlr-interest] Translating from one language to another
In-Reply-To: <4885FEE7.9000805@jazillian.com>
References: <9c8cbbc40807211254p66bc6ea2k9e9d87845a7a3048@mail.gmail.com>
	<4885FEE7.9000805@jazillian.com>
Message-ID: <20080723025523.00005c2b@goanna>

Of course the ANTLR book is essential.

The syntax directed translation approach (generate code from the
AST) would be easy if you are lucky that your generated code is
in a very similar structure to the source language.

This article by Andy is brilliant:

http://jazillian.com/articles/treewalkers.html

In my situation, which is different to yours, I thought
my AST was not in the right form to generate the code using
string template, Andy's article just reinforced this for me, which
really helped.

I think string template is great.  What I did was I generated
a completely new tree with all the information I need in the
right places to generate the code, then used string template to
generate it.  So basically, I used Andy's approach (I manually
walked the AST looking for stuff for the new tree which I entered
into some data structures), manually walked parts of the symbol table
(while looking up more stuff in the  symbol table and other data
structures), generated a new tree, and used string template.

If AST is not in the right format to generate the code, then
one approach is to figure out some way to transform and
augment it, possibly with new subtrees, or generate a new tree.

On Tue, 22 Jul 2008 11:38:15 -0400
Andy Tripp <antlr at jazillian.com> wrote:

> A "quick and dirty" alternative approach to StringTemplate is
> to write some code that just walks your AST, printing out code.
> This: http://www.jazillian.com/antlr/emitter.html
> just walks a Java AST and prints Java code.
> 
> David Tauzell wrote:
> > I'd like to translate from language A to java.  I've written a
> > grammar that parses language A and generates an AST.   The language
> > is mostly like java, except there are a few cases where I'll need
> > to change the input.  For example, something like:
> > 
> >     a.b.c.d = foo
> > 
> > will be converted to
> > 
> >     a.get("b").get("c").get("d").setValue(foo)
> > 
> > Other stuff like:
> > 
> >    if( foo == "bar") {
> >       ...
> >    }
> > 
> > can stay like it is.
> > 
> > I'm not sure what is the best way to proceed.  Should I somehow use 
> > StringTemplate?  Should I walk the AST and generate output? Is this 
> > question to vague? Do I just need to buy the ANTLR book and learn
> > more about ANTLR?
> > 
> > Thanks,
> >     Dave
> > 
> > 
> 


-- 

From johan.grande at crans.org  Tue Jul 22 10:23:29 2008
From: johan.grande at crans.org (johan.grande at crans.org)
Date: Tue, 22 Jul 2008 19:23:29 +0200
Subject: [antlr-interest] lexer doesn't see super constructor
	&	inherited variable
In-Reply-To: <20080722093152.10411l4ktgbw35y8@horde.verrech.net>
References: <4884D06B.1040105@crans.org>
	<20080721214420.65331lsreb5k0sas@horde.verrech.net>
	<4884E915.3040009@crans.org>
	<20080721221053.9423349djoc1z3gg@horde.verrech.net>
	<48850127.3060908@crans.org>
	<20080722093152.10411l4ktgbw35y8@horde.verrech.net>
Message-ID: <20080722192329.hnzwocid8g84g4oc@webmail.crans.org>

Raphael Reitzig <r_reitzi at cs.uni-kl.de> a ??crit??:

> "Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 23:35:35 2008):
>
>> I first tried antlr-3.0.1 . But I found a bug in it [...] and in my  
>>   case the generated parser didn't compile.
> Uh, so why did 3.0.1 work for me? That bugs _me_ o.o
In the original grammar there is no rule parameter. But I need some,  
and they lead to a bug. I typically writes things like :

foo : modifiers bar[$modifiers.tree] -> bar
bar[Tree modifiers] : 'bar' sth -> ^(Bar modifiers sth)

Where foo and bar already exist, I add the parameters and the tree  
construction.

>
>> How can javac see a class but not a constructor in it ?
> Usually, if there is no such construcor or it is hidden.
>
> Wait. What package is the superclass in and which modifier got the
> constructor in question? Your parser will for sure be in another
> package. Thus, if constructors are package local, you may get those
> errors.
>
The superclass of the generated lexer is org.antlr.runtime.Lexer :

public abstract class Lexer extends BaseRecognizer implements TokenSource

and it contains the _public_ Lexer constructor.



>> I think I can assume the .class included in antlr correspond to the  
>>   .java provided ...
> You should. However, if the distributor if the package did something
> wrong, weird stuff can happen. But since we both downloaded from
> antlr.org, I suppose, that cannot be the case.
>
>> I don't know all the subtleties of Java, but it would be great if    
>> you could explain me how the bug can just exist.
> I can only think of Classpath and compatibility issues.

The .jar is in the classpath; I see it by echo.

The class Lexer is in the classpath, because "java  
org.antlr.runtime.Lexer" raises "NoSuchMethodError: main" and not  
"NoClassDefFound"

>
> Do you run a MAC? Do you use some JDK _not_ from SUN? (I suppose both
> questions will be answered with 'no', for javac -version should have
> looked somehow different (?), but just to be sure)
>
I use the Sun JDK on GNU/Linux.

> Please send me both the gramar file and the jar you use. I want to try
> exactly this combination here...
>
The .jar is he ne of the one of antlr v3.1b2 .

I will send my grammar as soon as possible, I can't yet, sorry.

Regards,
Johan

From ladam at vbi.vt.edu  Tue Jul 22 10:57:44 2008
From: ladam at vbi.vt.edu (Laura Adam)
Date: Tue, 22 Jul 2008 13:57:44 -0400 (EDT)
Subject: [antlr-interest] Invalid option: backtrack
In-Reply-To: <594681699.1204571216748952099.JavaMail.root@zimbra>
Message-ID: <1465464073.1205471216749464499.JavaMail.root@zimbra>

Hello,

I'd like to make a try with the backtrack option.I want to turn on the backtrack option at the grammar level.
I made a lexer.g file like that :


class lexer extends Lexer;
options {
    k=100;
    backtrack = true;
    } 
 rules.............



I had an "Invalid option: backtrack".
(Moreover, if I try to change the first line into a "grammar T;", trying to do exactly what I read in the book, that doesn't work, I don't understand why)

I reinstall the latest version of Antlr to be sure that I am using one that contains that option.
I also add to the classpath the .jar file such as that :

export CLASSPATH="$CLASSPATH:/home/ladam.local/antlr-3.1b2/lib/antlr-3.1b2.jar:\
/home/ladam.local/antlr-3.1b2/lib/stringtemplate-3.2.jar:\
/home/ladam.local/antlr-3.1b2/lib/antlr-2.7.7.jar:\
/home/ladam.local/antlr-3.1b2/lib/antlr-runtime-3.1b2.jar:\
/home/ladam.local/antlr-3.1b2/lib/gunit-1.0.2.jar"


Even if I want to use the backtrack option at a rule level, I can't. Backtrack doesn't even appear in emacs ANTLR menu.

What can I do?

Laura Adam

From parrt at cs.usfca.edu  Tue Jul 22 11:02:54 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Jul 2008 11:02:54 -0700
Subject: [antlr-interest] Invalid option: backtrack
In-Reply-To: <1465464073.1205471216749464499.JavaMail.root@zimbra>
References: <1465464073.1205471216749464499.JavaMail.root@zimbra>
Message-ID: <CB9F771C-CEE8-4B88-B97A-DEEC8A7B7331@cs.usfca.edu>

Hi class lexer... is v2 notation.
Ter
On Jul 22, 2008, at 10:57 AM, Laura Adam wrote:

> Hello,
>
> I'd like to make a try with the backtrack option.I want to turn on  
> the backtrack option at the grammar level.
> I made a lexer.g file like that :
>
>
> class lexer extends Lexer;
> options {
>    k=100;
>    backtrack = true;
>    }
> rules.............
>
>
>
> I had an "Invalid option: backtrack".
> (Moreover, if I try to change the first line into a "grammar T;",  
> trying to do exactly what I read in the book, that doesn't work, I  
> don't understand why)
>
> I reinstall the latest version of Antlr to be sure that I am using  
> one that contains that option.
> I also add to the classpath the .jar file such as that :
>
> export CLASSPATH="$CLASSPATH:/home/ladam.local/antlr-3.1b2/lib/ 
> antlr-3.1b2.jar:\
> /home/ladam.local/antlr-3.1b2/lib/stringtemplate-3.2.jar:\
> /home/ladam.local/antlr-3.1b2/lib/antlr-2.7.7.jar:\
> /home/ladam.local/antlr-3.1b2/lib/antlr-runtime-3.1b2.jar:\
> /home/ladam.local/antlr-3.1b2/lib/gunit-1.0.2.jar"
>
>
> Even if I want to use the backtrack option at a rule level, I can't.  
> Backtrack doesn't even appear in emacs ANTLR menu.
>
> What can I do?
>
> Laura Adam


From dcaton at spamarrest.com  Tue Jul 22 11:10:30 2008
From: dcaton at spamarrest.com (Don Caton)
Date: Tue, 22 Jul 2008 14:10:30 -0400
Subject: [antlr-interest] Any more info on the 'Sun-tuned ANTLR v2'
	website link-share?
In-Reply-To: <19147537.1213179181307.JavaMail.root@m03>
References: <19147537.1213179181307.JavaMail.root@m03>
Message-ID: <00b101c8ec26$3a4b60b0$aee22210$@com>

Egor:

Any tips on how to get the source?  I downloaded the Mercurial client, which I
presume is necessary to get the files but I don't have a clue where to start.

Thanks.

--
Don

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Egor Ushakov
> Sent: Wednesday, June 11, 2008 6:12 AM
> To: Micheal J
> Cc: antlr-interest at antlr.org
> Subject: [antlr-interest] [Fwd: Re: Any more info on the 'Sun-tuned ANTLR
> v2' website link-share?]
> 
> Michael,
> 
> Sun-tuned ANTLR v2 is used in C/C++ Netbeans pack for source parsing:
> http://www.netbeans.org/features/cpp/index.html
> We implemented several performance fixes in it to improve the
> performance of generated parser and lexer.
> Our tests with C/C++ grammar shown ~x3 performance improvement.
> 
> Netbeans is fully opensource and so does Sun-tuned ANTLR and grammars.
> We just asked Terence to put links on his website. (Thanks!)
> 
> Feel free to use it in your projects :)
> 
> Egor
> Sun Microsystems
> 
> Micheal J wrote:
> > Hi All,
> >
> > Just saw this in the sharing section of the ANTLR website. Does anyone
> have
> > more info about this work by Sun (or is it the Netbeans project)?
> >
> > Micheal
> >
> > -----------------------
> > The best way to contact me is via the list/forum. My time is very
> limited.
> >
> >
> 
> 
> 



From sean.bridges at gmail.com  Tue Jul 22 11:30:47 2008
From: sean.bridges at gmail.com (Sean Bridges)
Date: Tue, 22 Jul 2008 11:30:47 -0700
Subject: [antlr-interest] unrelated rule causing warnings
Message-ID: <e188854c0807221130x7558857fy53e44e9e31728b6a@mail.gmail.com>

Hello,

This is a simplified version of the grammar I am working on.

grammar Test;

//comment out from_clause
//and warning in qualified_name
//goes away
from_clause
       :       'FROM' qualified_name ;

column_reference
       :       (qualified_name PERIOD)? 'a';

qualified_name
       :       ('a' PERIOD)? 'a';

PERIOD  :       '.';

WS
   : (' '|'\t'|'\n'|'\r')+ {channel=HIDDEN;};



When I compile this with antlr 3 (or 3.1 beta) I get a warning for the
qualified_name rule,

 warning(202): Test.g:13:4: the decision cannot distinguish between
alternative(s) 1,2 for at least one input sequence

If I comment out the from_clause rule, the grammar compiles without warning.

Is my grammar ambiguous?  How does adding/removing the from_clause
rule change the ambiguity of the qualified_name rule?

Thanks,

Sean

From parrt at cs.usfca.edu  Tue Jul 22 13:09:00 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Jul 2008 13:09:00 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
Message-ID: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>

Hi, Leon Su, the maniac that brings you gUnit is currently working  
with me on a rewrite system similar to other rewrite engines such as  
ASF+SDF, Stratego, TXL etc...  I believe the tool is in line with the  
strategy championed by Andy Tripp.

You'll be able to say things like "whenever you see x+0 in an IF  
expression, rewrite it to x":

---------------------
rewrite Java; // applies rewrite rules to external java grammar
tokens {
	x=ID;
}

[ifstat ... expr]:
	"x+0" -> "x"
	"0+x" -> "x"
	...
---------------------

It is going to be extremely cool and will also work for tree rewrites.

The only problem we have is that we don't know what to call it. I  
originally had a nice tree rewriting system called Sorcerer (14 years  
ago) but now there are things like sourcerer and so on. can anybody  
help us name this tool?

THesaurus entries:

rewrite: revise, recast,reword, rephrase, redraft.

transform: change, alter,convert, metamorphose, transfigure,  
transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,  
reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,  
remake, retool, transmogrify, morph

rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.

Do any of those words help us?

I think "morph" is actually not bad.  Morpheme sounds cooler but makes  
less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that  
one is funny.

How about metamorph? I like that one! google search only reveals a  
molecular device and some stupid school has taken metamorph.org. I  
guess that is no big deal because we will be using the antlr.org  
website for that.

Ter

From cvrebert at gmail.com  Tue Jul 22 13:20:05 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Tue, 22 Jul 2008 13:20:05 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <47c890dc0807221320n4407ae53x99f9fa28b0d69fd0@mail.gmail.com>

On Tue, Jul 22, 2008 at 1:09 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi, Leon Su, the maniac that brings you gUnit is currently working with me
> on a rewrite system similar to other rewrite engines such as ASF+SDF,
> Stratego, TXL etc...  I believe the tool is in line with the strategy
> championed by Andy Tripp.
>
> You'll be able to say things like "whenever you see x+0 in an IF expression,
> rewrite it to x":
>
> ---------------------
> rewrite Java; // applies rewrite rules to external java grammar
> tokens {
>        x=ID;
> }
>
> [ifstat ... expr]:
>        "x+0" -> "x"
>        "0+x" -> "x"
>        ...
> ---------------------
>
> It is going to be extremely cool and will also work for tree rewrites.
>
> The only problem we have is that we don't know what to call it. I originally
> had a nice tree rewriting system called Sorcerer (14 years ago) but now
> there are things like sourcerer and so on. can anybody help us name this
> tool?
>
> THesaurus entries:
>
> rewrite: revise, recast,reword, rephrase, redraft.
>
> transform: change, alter,convert, metamorphose, transfigure, transmute,
> mutate; revolutionize,overhaul; remodel, reshape, redo, reconstruct,
> rebuild, reorganize, rearrange,rework, renew, revamp, remake, retool,
> transmogrify, morph
>
> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>
> Do any of those words help us?
>
> I think "morph" is actually not bad.  Morpheme sounds cooler but makes less
> sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that one is
> funny.
>
> How about metamorph? I like that one! google search only reveals a molecular
> device and some stupid school has taken metamorph.org. I guess that is no
> big deal because we will be using the antlr.org website for that.

It's also a kind of Star Trek alien --
http://www.memory-alpha.org/en/wiki/Empathic_metamorph  ;)
- Chris

>
> Ter
>

From carl.crowder at gmail.com  Tue Jul 22 13:35:24 2008
From: carl.crowder at gmail.com (Carl Crowder)
Date: Tue, 22 Jul 2008 21:35:24 +0100
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <4886448C.2080305@gmail.com>

"Valmorphanizer" :O

Terence Parr wrote:
> Hi, Leon Su, the maniac that brings you gUnit is currently working with
> me on a rewrite system similar to other rewrite engines such as ASF+SDF,
> Stratego, TXL etc...  I believe the tool is in line with the strategy
> championed by Andy Tripp.
> 
> You'll be able to say things like "whenever you see x+0 in an IF
> expression, rewrite it to x":
> 
> ---------------------
> rewrite Java; // applies rewrite rules to external java grammar
> tokens {
>     x=ID;
> }
> 
> [ifstat ... expr]:
>     "x+0" -> "x"
>     "0+x" -> "x"
>     ...
> ---------------------
> 
> It is going to be extremely cool and will also work for tree rewrites.
> 
> The only problem we have is that we don't know what to call it. I
> originally had a nice tree rewriting system called Sorcerer (14 years
> ago) but now there are things like sourcerer and so on. can anybody help
> us name this tool?
> 
> THesaurus entries:
> 
> rewrite: revise, recast,reword, rephrase, redraft.
> 
> transform: change, alter,convert, metamorphose, transfigure, transmute,
> mutate; revolutionize,overhaul; remodel, reshape, redo, reconstruct,
> rebuild, reorganize, rearrange,rework, renew, revamp, remake, retool,
> transmogrify, morph
> 
> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
> 
> Do any of those words help us?
> 
> I think "morph" is actually not bad.  Morpheme sounds cooler but makes
> less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that one
> is funny.
> 
> How about metamorph? I like that one! google search only reveals a
> molecular device and some stupid school has taken metamorph.org. I guess
> that is no big deal because we will be using the antlr.org website for
> that.
> 
> Ter


From rschulz at sonic.net  Tue Jul 22 13:38:33 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Tue, 22 Jul 2008 13:38:33 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <200807221338.33342.rschulz@sonic.net>

On Tuesday 22 July 2008 13:09, Terence Parr wrote:
> ...
>
> The only problem we have is that we don't know what to call it. I
> originally had a nice tree rewriting system called Sorcerer (14 years
> ago) but now there are things like sourcerer and so on. can anybody
> help us name this tool?

TransDendral
MetaDendral
TransMetaDendral

The only problem is the now rather archaic Dendral and Meta-Dendral 
expert systems from Stanford: <http://en.wikipedia.org/wiki/Dendral>


> ...
>
> Ter


Randall Schulz

From rschulz at sonic.net  Tue Jul 22 13:44:31 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Tue, 22 Jul 2008 13:44:31 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <200807221344.31523.rschulz@sonic.net>

On Tuesday 22 July 2008 13:09, Terence Parr wrote:
> Hi, Leon Su, the maniac that brings you gUnit is currently working
> with me on a rewrite system similar to other rewrite engines such as
> ASF+SDF, Stratego, TXL etc...  I believe the tool is in line with the
> strategy championed by Andy Tripp.

And Tom? (<http://tom.loria.fr/>)


> You'll be able to say things like "whenever you see x+0 in an IF
> expression, rewrite it to x":
>
> ---------------------
> rewrite Java; // applies rewrite rules to external java grammar
> tokens {
> 	x=ID;
> }
>
> [ifstat ... expr]:
> 	"x+0" -> "x"
> 	"0+x" -> "x"
> 	...
> ---------------------
>
> It is going to be extremely cool and will also work for tree
> rewrites.

Where might one learn more about the details of what you're planning?

Rewriting (the need to support it in my current project) is something 
between a hobby-horse and bug-bear with me these days. I've not been 
able to find anyting compelling and the need has never been quite 
pressing enough for me to embark on an effort to develop a sufficiently 
sophisticated system of my own.

So I'm intrigued at the possibility that what you'll be working on might 
fill a long-standing (if not pressing) need of mine. If so, I might be 
able to lend a hand in some way.


> ...
>
> Ter


Randall Schulz

From parrt at cs.usfca.edu  Tue Jul 22 13:52:27 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Jul 2008 13:52:27 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <200807221344.31523.rschulz@sonic.net>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<200807221344.31523.rschulz@sonic.net>
Message-ID: <47574FEA-747D-417A-824B-0C79EB822E3E@cs.usfca.edu>


On Jul 22, 2008, at 1:44 PM, Randall R Schulz wrote:

> On Tuesday 22 July 2008 13:09, Terence Parr wrote:
>> Hi, Leon Su, the maniac that brings you gUnit is currently working
>> with me on a rewrite system similar to other rewrite engines such as
>> ASF+SDF, Stratego, TXL etc...  I believe the tool is in line with the
>> strategy championed by Andy Tripp.
>
> And Tom? (<http://tom.loria.fr/>)
>

Ah. right! Forgot, Tom Is a nice term rewriting tool that uses ANTLR :)

Ter

From aheller at gmx.at  Tue Jul 22 13:58:19 2008
From: aheller at gmx.at (Arnulf Heller)
Date: Tue, 22 Jul 2008 22:58:19 +0200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>

I'd call it "Brian" because the romans forced him to re-write 
"Romans, go home" a hundred times :-)

http://www.mwscomp.com/movies/brian/brian-08.htm

Maybe it could also serve as an acronym:

"Because Rewriting Is Amazingly Neat" or so :-)



>The only problem we have is that we don't know what to call it. I
>originally had a nice tree rewriting system called Sorcerer (14 years
>ago) but now there are things like sourcerer and so on. can anybody
>help us name this tool?
>
>THesaurus entries:
>
>rewrite: revise, recast,reword, rephrase, redraft.
>
>transform: change, alter,convert, metamorphose, transfigure,
>transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,
>reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,
>remake, retool, transmogrify, morph
>
>rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>
>Do any of those words help us?
>
>I think "morph" is actually not bad.  Morpheme sounds cooler but makes
>less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that
>one is funny.
>
>How about metamorph? I like that one! google search only reveals a
>molecular device and some stupid school has taken metamorph.org. I
>guess that is no big deal because we will be using the antlr.org
>website for that.
>
>Ter


From lgcraymer at yahoo.com  Tue Jul 22 14:10:44 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Tue, 22 Jul 2008 14:10:44 -0700 (PDT)
Subject: [antlr-interest] Translating from one language to another
Message-ID: <990793.43257.qm@web55909.mail.re3.yahoo.com>

If the structure of the AST you print from is determined by luck, then you have serious design problems.  For complex translation problems, the "art of ANTLR" is in transforming ASTs (possibly across several passes) to capture the semantics of the input language into tree syntax and thence to output semantics.  If you have any desire to build auxilliary tools for the language you are translating from, then you really want to take the effort to build a usable AST:  you will find that that makes a big difference in both maintainability and flexibility for other applications.

--Loring



----- Original Message ----
> From: Mark Wright <markwright at internode.on.net>
> To: David Tauzell <dave at tauzell.org>
> Cc: antlr-interest at antlr.org
> Sent: Tuesday, July 22, 2008 9:55:23 AM
> Subject: Re: [antlr-interest] Translating from one language to another
> 
> Of course the ANTLR book is essential.
> 
> The syntax directed translation approach (generate code from the
> AST) would be easy if you are lucky that your generated code is
> in a very similar structure to the source language.
> 
> This article by Andy is brilliant:
> 
> http://jazillian.com/articles/treewalkers.html
> 
> In my situation, which is different to yours, I thought
> my AST was not in the right form to generate the code using
> string template, Andy's article just reinforced this for me, which
> really helped.
> 
> I think string template is great.  What I did was I generated
> a completely new tree with all the information I need in the
> right places to generate the code, then used string template to
> generate it.  So basically, I used Andy's approach (I manually
> walked the AST looking for stuff for the new tree which I entered
> into some data structures), manually walked parts of the symbol table
> (while looking up more stuff in the  symbol table and other data
> structures), generated a new tree, and used string template.
> 
> If AST is not in the right format to generate the code, then
> one approach is to figure out some way to transform and
> augment it, possibly with new subtrees, or generate a new tree.
> 
> On Tue, 22 Jul 2008 11:38:15 -0400
> Andy Tripp wrote:
> 
> > A "quick and dirty" alternative approach to StringTemplate is
> > to write some code that just walks your AST, printing out code.
> > This: http://www.jazillian.com/antlr/emitter.html
> > just walks a Java AST and prints Java code.
> > 
> > David Tauzell wrote:
> > > I'd like to translate from language A to java.  I've written a
> > > grammar that parses language A and generates an AST.   The language
> > > is mostly like java, except there are a few cases where I'll need
> > > to change the input.  For example, something like:
> > > 
> > >     a.b.c.d = foo
> > > 
> > > will be converted to
> > > 
> > >     a.get("b").get("c").get("d").setValue(foo)
> > > 
> > > Other stuff like:
> > > 
> > >    if( foo == "bar") {
> > >       ...
> > >    }
> > > 
> > > can stay like it is.
> > > 
> > > I'm not sure what is the best way to proceed.  Should I somehow use 
> > > StringTemplate?  Should I walk the AST and generate output? Is this 
> > > question to vague? Do I just need to buy the ANTLR book and learn
> > > more about ANTLR?
> > > 
> > > Thanks,
> > >     Dave
> > > 
> > > 
> > 
> 
> 
> -- 



      


From sharwell at pixelminegames.com  Tue Jul 22 14:57:02 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 22 Jul 2008 16:57:02 -0500
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <86403CA0939415448BCCB83855EFE09A64DDF4@Bloodymary.ironwillgames.com>

I believe 'transform' is a common term for this action in other circles.

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Tuesday, July 22, 2008 3:09 PM
To: antlr mailing list
Cc: stringtemplate-interest
Subject: [antlr-interest] we need a name for a new rewriting tool

Hi, Leon Su, the maniac that brings you gUnit is currently working  
with me on a rewrite system similar to other rewrite engines such as  
ASF+SDF, Stratego, TXL etc...  I believe the tool is in line with the  
strategy championed by Andy Tripp.

You'll be able to say things like "whenever you see x+0 in an IF  
expression, rewrite it to x":

---------------------
rewrite Java; // applies rewrite rules to external java grammar
tokens {
	x=ID;
}

[ifstat ... expr]:
	"x+0" -> "x"
	"0+x" -> "x"
	...
---------------------

It is going to be extremely cool and will also work for tree rewrites.

The only problem we have is that we don't know what to call it. I  
originally had a nice tree rewriting system called Sorcerer (14 years  
ago) but now there are things like sourcerer and so on. can anybody  
help us name this tool?

THesaurus entries:

rewrite: revise, recast,reword, rephrase, redraft.

transform: change, alter,convert, metamorphose, transfigure,  
transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,  
reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,  
remake, retool, transmogrify, morph

rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.

Do any of those words help us?

I think "morph" is actually not bad.  Morpheme sounds cooler but makes  
less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that  
one is funny.

How about metamorph? I like that one! google search only reveals a  
molecular device and some stupid school has taken metamorph.org. I  
guess that is no big deal because we will be using the antlr.org  
website for that.

Ter

From parrt at cs.usfca.edu  Tue Jul 22 16:02:39 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Jul 2008 16:02:39 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64DDF4@Bloodymary.ironwillgames.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<86403CA0939415448BCCB83855EFE09A64DDF4@Bloodymary.ironwillgames.com>
Message-ID: <FF129186-E8DB-4513-B642-0E64AE0163DF@cs.usfca.edu>


On Jul 22, 2008, at 2:57 PM, Sam Harwell wrote:

> I believe 'transform' is a common term for this action in other  
> circles.

yup.

Also polymorph would work.  So far I like metamorph for "meaning" and  
morphic for "the sound of it".

Ter

From rkevinburton at charter.net  Tue Jul 22 16:34:04 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Tue, 22 Jul 2008 16:34:04 -0700
Subject: [antlr-interest] ANTLRWorks windows
Message-ID: <20080722193404.K3UZS.19694.root@fepweb04>

Somehow I have gotten ANTLRWorks into a state that is very undesirable. I only see the right portion of the grammar and the left portion that usually displays a tree of options is completely gone. How can I reset the ANTLRWorks view and get my old ANTLRWorks windows back?

Thank you.

Kevin

From parrt at cs.usfca.edu  Tue Jul 22 16:40:08 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Jul 2008 16:40:08 -0700
Subject: [antlr-interest] ANTLRWorks windows
In-Reply-To: <20080722193404.K3UZS.19694.root@fepweb04>
References: <20080722193404.K3UZS.19694.root@fepweb04>
Message-ID: <661546D9-044F-471C-BB48-6269B65A006A@cs.usfca.edu>

thereShould be a directory in your home directory like antlrworks or  
whatever is in your preferences that holds some properties. Blast  
those files I guess.
Ter
On Jul 22, 2008, at 4:34 PM, <rkevinburton at charter.net> <rkevinburton at charter.net 
 > wrote:

> Somehow I have gotten ANTLRWorks into a state that is very  
> undesirable. I only see the right portion of the grammar and the  
> left portion that usually displays a tree of options is completely  
> gone. How can I reset the ANTLRWorks view and get my old ANTLRWorks  
> windows back?
>
> Thank you.
>
> Kevin


From ger.hobbelt at bermuda-holding.com  Tue Jul 22 19:16:13 2008
From: ger.hobbelt at bermuda-holding.com (Ger Hobbelt)
Date: Wed, 23 Jul 2008 04:16:13 +0200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <561cc61d0807221903g5422bfc5i9bfcef01fbfa4ede@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
	<561cc61d0807221903g5422bfc5i9bfcef01fbfa4ede@mail.gmail.com>
Message-ID: <561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>

On Tue, Jul 22, 2008 at 10:58 PM, Arnulf Heller <aheller at gmx.at> wrote:
> I'd call it "Brian" because the romans forced him to re-write "Romans, go
> home" a hundred times :-)

After reminding him of his education. Probably a disgruntled
ex-teacher, that centurion.  :-)

>
> http://www.mwscomp.com/movies/brian/brian-08.htm
>
> Maybe it could also serve as an acronym:
>
> "Because Rewriting Is Amazingly Neat" or so :-)



+1 for Brian.


Why? Oh, about 101 reasons. In no particular order:

001) Not to put too fine a point on it, but 'morph*', 'transform*' and
all that has way too much association [for me] with something that
could have crawled out of some Thunderpuss X caped-hero-in-80's-tights
DC comic on a bad-hair day (yep, I'm 'Old Country' and I like my
comics to have a wee bitty of a story line, thank you very much. You
can flame me off list if you feel that primal urge.)

010) giving the spelling ability these days, you'd quickly get 'Brain'
which, well, seems suitably ironic to me for something at the dawn of
the 21st century. Now a typo in (morph|transform|rewrite).* would,
well, I'd rather not think about it. r3wr8? Yuck.

011) Name != product description. If VIM started as a brand name and
ended up as a type name for all related products; if a gnu from Africa
can get some Gates to rattle and worry about his future, and a bison
has all but eliminated the yacc by proxy, well, then I'm sure a Brian
(maybe assisted by Tom) can inherit the world. Right?

100) I kinda dig Antler. It's a visual. (okay, okay, it's ANTLR, but
what the heck) At least you can 'feel' it. Like a bit of bison trophy,
but much less endangered, so if you got a gun and the money, you may
still shoot one in the wild and bring it home. No import restrictions
either. Now 'Morph' does absolutely nothing here, nor would
Transformer (I don't get excited over magnetic alternating current
devices in /that/ way) or any other of the 'technically appropriate
terms'.

101) Please, have a bit of compassion with us white collar criminal
types who have to suffer pointy haired bosses. Imagine he wants to
know what the heck you're doing and you say: "I have applied Brian to
the problem and if I guide things well, we may have it fixed by
Monday." Now that's some career-advancing opportunity talk right
there. You're a made man, son. ... Now contrast this with the
scientifically correct version of same: "Yes sir, I'm trying to
dewrinkle the bugs in the Metamorph Rotoplooker 114, but it's been
crapping up on me all day, dang it!" and the boss goes: "WHAT?!" Can
you say: "pink slip"?


Besides, think about your kids. And ours.  Your legacy!  It's way
better to find out you've been named after something scientific and
cool than after your silly-joke exhorting, youth-bashing, filthy
cigar-puffing right-wing republican granddaddy (named Morph). ;-)


It's just a thought. Brand name doesn't have to 'describe' the
product. It's got to 'be' the product.

My 0.02 EUR.

Back to lurking...

Cheers,

Ger



PS: since ANTLR was borne out of PCCTS, the new one might as well be
borne out of Sorcerer in some odd way, say, Gandalf, Rincewind, Esme
(after all, tree rewriting may be considered headology), Eskarina, ...
(if you care about matching .com and/or .org domains: all the
Pratchett ones are taken, I believe.) Still, I like Brian better.

--
Met vriendelijke groeten / Best regards,

Ger Hobbelt

--------------------------------------------------
web: http://www.hobbelt.com/
 http://www.hebbut.net/
mail: ger at hobbelt.com
mobile: +31-6-11 120 978
--------------------------------------------------

From mdanielov at sendwordnow.com  Tue Jul 22 20:00:14 2008
From: mdanielov at sendwordnow.com (Mordechai Danielov)
Date: Tue, 22 Jul 2008 23:00:14 -0400
Subject: [antlr-interest]  most efficient grammar pasing
Message-ID: <8C509380F5C1E64686251D030FA286E0040A01D1@LATSVIVEX01.sendwordnow.local>

Hi,

 

I found your email in an old message thread. I am trying to develop an
app to parse programmable objects in the MS SQL database, with the
eventual intent of producing a work flow diagram with a list of
dependencies. I thought that Microsoft would have an API to access the
parsing engine, but no such luck. There is supposed to be sqlparse.dll
but I can't seem to register in the Visual Studio. ANTLR may be the next
stop. If you can give me some direction I would appreciate it. Thanks in
advance.

 

Mordechai Danielov

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080722/5b45cbdc/attachment.html 

From cvrebert at gmail.com  Tue Jul 22 20:39:35 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Tue, 22 Jul 2008 20:39:35 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
Message-ID: <47c890dc0807222039j6afe88b0j8645e0259fcc7040@mail.gmail.com>

On Tue, Jul 22, 2008 at 1:58 PM, Arnulf Heller <aheller at gmx.at> wrote:
> I'd call it "Brian" because the romans forced him to re-write "Romans, go
> home" a hundred times :-)
>
> http://www.mwscomp.com/movies/brian/brian-08.htm
>
> Maybe it could also serve as an acronym:
>
> "Because Rewriting Is Amazingly Neat" or so :-)
>

+1 for being a Monty Python reference!
- Chris

>
>
>> The only problem we have is that we don't know what to call it. I
>> originally had a nice tree rewriting system called Sorcerer (14 years
>> ago) but now there are things like sourcerer and so on. can anybody
>> help us name this tool?
>>
>> THesaurus entries:
>>
>> rewrite: revise, recast,reword, rephrase, redraft.
>>
>> transform: change, alter,convert, metamorphose, transfigure,
>> transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,
>> reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,
>> remake, retool, transmogrify, morph
>>
>> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>>
>> Do any of those words help us?
>>
>> I think "morph" is actually not bad.  Morpheme sounds cooler but makes
>> less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that
>> one is funny.
>>
>> How about metamorph? I like that one! google search only reveals a
>> molecular device and some stupid school has taken metamorph.org. I
>> guess that is no big deal because we will be using the antlr.org
>> website for that.
>>
>> Ter
>
>

From vasanthi.ak at gmail.com  Tue Jul 22 21:45:22 2008
From: vasanthi.ak at gmail.com (vasanthi a)
Date: Wed, 23 Jul 2008 10:15:22 +0530
Subject: [antlr-interest] pls provide Grammar rule for __extension__
	and__gnuc_va_list
In-Reply-To: <307cfdc90807220753i4958c2fcr2339d70345de76ae@mail.gmail.com>
References: <307cfdc90807220753i4958c2fcr2339d70345de76ae@mail.gmail.com>
Message-ID: <307cfdc90807222145y7e144125rcebba685096c7e25@mail.gmail.com>

 HI

Can anyone provide me C grammar rule for  __extension__ and typedef
__gnuc_va_list.

I have a stdc.g file,where all the rules for C grammar has been defined. But
the latest version of GCC compiler has
even typdef __extension  ....   and typdef __gnuc_va_list ..... defined with
it.
But I dont have the rules rules defined for __extension and __gnuc_valist.
Hence when ever while instrumenting the code..
I get an error "unexpected token: __gnuc_va_list" and error "unexpected
token: __extension__

This kind of error occurs when it encounters some line in my code like
" __extension__ typedef signed long long int __int64_t";


and


"typedef _builtin_Va_list  __gnuc_va_list;"

"typedef __gnuc_va_list va_list";

Kindly provide me rules code for this. This is needed urgently.

Kindly provide me the same asap.

Thanks and regards

Vasanthi.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/e6887d63/attachment.html 

From amax at redsymbol.net  Tue Jul 22 19:32:02 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Tue, 22 Jul 2008 19:32:02 -0700
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <488306D4.4020108@gmx.de>
References: <200807181455.52897.amax@redsymbol.net>
	<543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>
	<488306D4.4020108@gmx.de>
Message-ID: <200807221932.02185.amax@redsymbol.net>

On Sunday 20 July 2008 02:35:16 am Johannes Luber wrote:
> Benjamin Niemann schrieb:
> > there is a Python grammar in examples package. It's the 2.3 grammar,
> > but you may use parts of both to get a working Python2.5 grammar.

> Regarding the sample grammars: In the repository there are sample
> grammars for these languages as well. Ter is probably planning to update

Hi all,

Benjamin, Johannes, thanks for the advice.  Using it, I have a
partial port of the python 2.5 grammar to python language target, for
antlr 3.1:

http://redsymbol.net/files/antlr/Python-python-2.5-2008-07-22.tgz

I'd like to get this in a state where other people can use it.  Please
advise of any needed changes you see.  I have just tested the parsing,
and not any code generation based on it yet - exactly what I did is
described in the tarball's README.

I tested the resulting parser on the 2034 python files in a recent jython ASM 
branch checkout.  The README goes into detail - basically, two of those
files triggered errors; all the others parsed without errors, though
at least a few percent had one or more warning.

One big problem I see is that the generated PythonLexer.py has a
dangling elif clause - it prints this:

{{{
            elif alt28 == 2:
                # Python.g:615:10: 
<that's it - no statements in the block>
}}}

Due to Python's block structure by indentation, this is not correct
python syntax - there needs to be a "pass" statement, or the elif
clause needs to be omitted altogether.  The offending rule in the
grammar is:

{{{
CONTINUED_LINE
    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
         ( nl=NEWLINE 
{self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
         |
         )
    ;
}}}

I tried removing the emtpy "|" line, like this:

{{{
CONTINUED_LINE
    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
         ( nl=NEWLINE 
{self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
         )
    ;
}}}

Then the lexer code's syntax is correct.  However, the parser then
cannot correctly parse lines that are broken by a backslash (i.e., one
logical line split over two lines) -- for example:
{{{
** ./CPythonLib/plat-sunos5/STROPTS.py
line 836:8 required (...)+ loop did not match anything at character u'('
line 1396:24 required (...)+ loop did not match anything at character u'A'
line 1397:24 required (...)+ loop did not match anything at character u'A'

}}}

Can someone suggest a fix?  I tried just putting { pass;} in there,
but it is not placed at the correct indentation level.  Plus that is just 
hackish.

Any other feedback appreciated.

Thanks,
Aaron

-- 
Aaron Maxwell
http://redsymbol.net

From rkevinburton at charter.net  Wed Jul 23 00:14:38 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 23 Jul 2008 0:14:38 -0700
Subject: [antlr-interest] ANTLRWorks windows
In-Reply-To: <661546D9-044F-471C-BB48-6269B65A006A@cs.usfca.edu>
Message-ID: <20080723031438.97ORP.25619.root@fepweb05>

I am using Windows. I was unable to find the preferences file. Can you give me another hint where it is?

Thank you.

Kevin
---- Terence Parr <parrt at cs.usfca.edu> wrote: 
> thereShould be a directory in your home directory like antlrworks or  
> whatever is in your preferences that holds some properties. Blast  
> those files I guess.
> Ter
> On Jul 22, 2008, at 4:34 PM, <rkevinburton at charter.net> <rkevinburton at charter.net 
>  > wrote:
> 
> > Somehow I have gotten ANTLRWorks into a state that is very  
> > undesirable. I only see the right portion of the grammar and the  
> > left portion that usually displays a tree of options is completely  
> > gone. How can I reset the ANTLRWorks view and get my old ANTLRWorks  
> > windows back?
> >
> > Thank you.
> >
> > Kevin
> 


From cokey5614 at sina.com  Wed Jul 23 00:51:30 2008
From: cokey5614 at sina.com (cokey5614 at sina.com)
Date: Wed, 23 Jul 2008 15:51:30 +0800 
Subject: [antlr-interest] how to run gunit in antlrwork ?
Message-ID: <20080723075130.E2A713D7942@mail3-147.sinamail.sina.com.cn>

&nbsp;hi, 
&nbsp;&nbsp; it's my first time to use antlr's gunit tool,
it confused me so much, even, I don't know how to run gunit in antlrwork or with antlrV3IDE,
I also referenced to [gUnit - Grammar Unit Testing ],but...
&nbsp;
shall anybody tell me how to run gunit?
&nbsp;
OS:winXP
jdk:1.5.0_15
antlr:3.0.1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
thanks
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cokey

-------------------------------------------------------------------
????2G????(http://mail.sina.com.cn/)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/ebe493b1/attachment.html 

From leon.antlr at mac.com  Wed Jul 23 01:49:27 2008
From: leon.antlr at mac.com (Leon Su)
Date: Wed, 23 Jul 2008 01:49:27 -0700
Subject: [antlr-interest] how to run gunit in antlrwork ?
In-Reply-To: <20080723075130.E2A713D7942@mail3-147.sinamail.sina.com.cn>
References: <20080723075130.E2A713D7942@mail3-147.sinamail.sina.com.cn>
Message-ID: <77513E00-8FBF-4641-A92D-7899F66FAC52@mac.com>

Hi,

gUnit currently is not integrated into ANTLRWorks, so you have to run  
it separately.
If you're using ANTLR 3.0.1, download gunit-1.0.1.jar on wiki page  
and make sure it resides in your classpath.
Then, you could the follow examples on the wiki and build a simple  
gUnit test script for a simple grammar.
Here is the command line you'll need to use:  java  
org.antlr.gunit.Interp filename

Leon

On Jul 23, 2008, at 12:51 AM, cokey5614 at sina.com wrote:

>  hi,
>    it's my first time to use antlr's gunit tool,
> it confused me so much, even, I don't know how to run gunit in  
> antlrwork or with antlrV3IDE,
> I also referenced to [gUnit - Grammar Unit Testing ],but...
>
> shall anybody tell me how to run gunit?
>
> OS:winXP
> jdk:1.5.0_15
> antlr:3.0.1
>
> thanks
>                           cokey
>
> ????2G????

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/ed45a27e/attachment.html 

From iwm at doc.ic.ac.uk  Wed Jul 23 02:51:44 2008
From: iwm at doc.ic.ac.uk (Ian Moor)
Date: Wed, 23 Jul 2008 10:51:44 +0100 (BST)
Subject: [antlr-interest] unrelated rule causing warnings
In-Reply-To: <e188854c0807221130x7558857fy53e44e9e31728b6a@mail.gmail.com>
Message-ID: <11926085.181216806704945.JavaMail.ICEMail@snegopad>

>Hello,
>
>This is a simplified version of the grammar I am working on.
>
>grammar Test;
>
>//comment out from_clause
>//and warning in qualified_name
>//goes away
>from_clause
>       :       'FROM' qualified_name ;
>
>column_reference
>       :       (qualified_name PERIOD)? 'a';
>
>qualified_name
>       :       ('a' PERIOD)? 'a';
>
>PERIOD  :       '.';
>
>WS
>   : (' '|'\t'|'\n'|'\r')+ {channel=HIDDEN;};
>
>
>
>When I compile this with antlr 3 (or 3.1 beta) I get a warning for the
>qualified_name rule,
>
> warning(202): Test.g:13:4: the decision cannot distinguish between
>alternative(s) 1,2 for at least one input sequence
>
>If I comment out the from_clause rule, the grammar compiles without warning.
>
>Is my grammar ambiguous?  How does adding/removing the from_clause
>rule change the ambiguity of the qualified_name rule?
>
>Thanks,
>
>Sean
>
The problem is that 'a'  is either  a column_reference or a qualified_name
   Ian Moor


From jaluber at gmx.de  Wed Jul 23 03:50:12 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 23 Jul 2008 12:50:12 +0200
Subject: [antlr-interest] ANTLRWorks windows
In-Reply-To: <20080723031438.97ORP.25619.root@fepweb05>
References: <20080723031438.97ORP.25619.root@fepweb05>
Message-ID: <48870CE4.9010509@gmx.de>

rkevinburton at charter.net schrieb:
> I am using Windows. I was unable to find the preferences file. Can you give me another hint where it is?
> 
> Thank you.
> 
> Kevin

Did you look into your user directory? It may be also a hidden file, so 
change your options to show those also.

Johannes
> ---- Terence Parr <parrt at cs.usfca.edu> wrote: 
>> thereShould be a directory in your home directory like antlrworks or  
>> whatever is in your preferences that holds some properties. Blast  
>> those files I guess.
>> Ter
>> On Jul 22, 2008, at 4:34 PM, <rkevinburton at charter.net> <rkevinburton at charter.net 
>>  > wrote:
>>
>>> Somehow I have gotten ANTLRWorks into a state that is very  
>>> undesirable. I only see the right portion of the grammar and the  
>>> left portion that usually displays a tree of options is completely  
>>> gone. How can I reset the ANTLRWorks view and get my old ANTLRWorks  
>>> windows back?
>>>
>>> Thank you.
>>>
>>> Kevin
> 


From vasanthi.ak at gmail.com  Wed Jul 23 05:49:09 2008
From: vasanthi.ak at gmail.com (vasanthi a)
Date: Wed, 23 Jul 2008 18:19:09 +0530
Subject: [antlr-interest] Need grammar rule for __attribute__ and
	__extension__
Message-ID: <307cfdc90807230549n493ff56bt15252ba705d111b8@mail.gmail.com>

 Hi all

I am getting the below two errors while I am trying to parse my code.

unexpected token: __extension__

unexpected token: __attritube__

My STDC.g doesn't recognize this.

It gives error... when ever it encounters something like



__extension__ typedef signed long long int __int64_t;
__extension__ typedef unsigned long long int __uint64_t;



and with __attribute__ I get this error, when something like

extern void gen_die(
    int isAssert, char const* fileName, int line, char const* format, ...
) __attribute__ ((noreturn));



Can you pls let me know the grammar for this.



I need this asap.



Regards

Vasanthi.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/b0580aeb/attachment.html 

From trossbach at gmail.com  Wed Jul 23 06:29:58 2008
From: trossbach at gmail.com (=?ISO-8859-1?Q?Florian_Tro=DFbach?=)
Date: Wed, 23 Jul 2008 15:29:58 +0200
Subject: [antlr-interest] ANTLRWorks windows
In-Reply-To: <48870CE4.9010509@gmx.de>
References: <20080723031438.97ORP.25619.root@fepweb05>
	<48870CE4.9010509@gmx.de>
Message-ID: <6c488be60807230629j3725245dtf0eadeceb66fa34b@mail.gmail.com>

I also once put my ANTLRworks in a state where it did not work properly
(freeze on "Open File"...). I resolved it by deleting ANTLRworks related
entries in my registry (HKEY_CURRENT_USER\Software\*JavaSoft*
\Prefs\org\antlr\works).

Greetings,
Florian

2008/7/23 Johannes Luber <jaluber at gmx.de>:

> rkevinburton at charter.net schrieb:
>
>> I am using Windows. I was unable to find the preferences file. Can you
>> give me another hint where it is?
>>
>> Thank you.
>>
>> Kevin
>>
>
> Did you look into your user directory? It may be also a hidden file, so
> change your options to show those also.
>
> Johannes
>
>  ---- Terence Parr <parrt at cs.usfca.edu> wrote:
>>
>>> thereShould be a directory in your home directory like antlrworks or
>>>  whatever is in your preferences that holds some properties. Blast  those
>>> files I guess.
>>> Ter
>>> On Jul 22, 2008, at 4:34 PM, <rkevinburton at charter.net> <
>>> rkevinburton at charter.net  > wrote:
>>>
>>>  Somehow I have gotten ANTLRWorks into a state that is very  undesirable.
>>>> I only see the right portion of the grammar and the  left portion that
>>>> usually displays a tree of options is completely  gone. How can I reset the
>>>> ANTLRWorks view and get my old ANTLRWorks  windows back?
>>>>
>>>> Thank you.
>>>>
>>>> Kevin
>>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/145b44b5/attachment.html 

From r_reitzi at cs.uni-kl.de  Wed Jul 23 06:57:40 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Wed, 23 Jul 2008 15:57:40 +0200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
Message-ID: <20080723155740.171669qsmzxy86ko@horde.verrech.net>

That's cool. The longish version needed rework, though ;)

"Arnulf Heller" <aheller at gmx.at> wrote (Tue Jul 22 22:58:19 2008):

> I'd call it "Brian" because the romans forced him to re-write  
> "Romans, go home" a hundred times :-)
>
> http://www.mwscomp.com/movies/brian/brian-08.htm
>
> Maybe it could also serve as an acronym:
>
> "Because Rewriting Is Amazingly Neat" or so :-)
>
>
>
>> The only problem we have is that we don't know what to call it. I
>> originally had a nice tree rewriting system called Sorcerer (14 years
>> ago) but now there are things like sourcerer and so on. can anybody
>> help us name this tool?
>>
>> THesaurus entries:
>>
>> rewrite: revise, recast,reword, rephrase, redraft.
>>
>> transform: change, alter,convert, metamorphose, transfigure,
>> transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,
>> reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,
>> remake, retool, transmogrify, morph
>>
>> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>>
>> Do any of those words help us?
>>
>> I think "morph" is actually not bad.  Morpheme sounds cooler but makes
>> less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that
>> one is funny.
>>
>> How about metamorph? I like that one! google search only reveals a
>> molecular device and some stupid school has taken metamorph.org. I
>> guess that is no big deal because we will be using the antlr.org
>> website for that.
>>
>> Ter
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/6461a5b6/attachment.bin 

From tt.slot at mail.ru  Wed Jul 23 08:09:35 2008
From: tt.slot at mail.ru (Tom MacEllen)
Date: Wed, 23 Jul 2008 19:09:35 +0400
Subject: [antlr-interest] =?windows-1251?q?How_do_I_use_a_custom_token_obj?=
	=?windows-1251?q?ect=3F?=
Message-ID: <E1KLfyB-000Ncb-00.tt-slot-mail-ru@f177.mail.ru>

Hi there,

I have got a question about the wiki entry "How do I use a custom token object?" (found under http://www.antlr.org/wiki/pages/viewpage.action?pageId=1844).

In the example the custom token class is extended with the integer x.
But the setting of the value of the field x is hard-coded in the emit method.

Is there a way to alter this value from the action in the grammar.
Something like:
ID : 'a'..'z'+  {/* set the integer x from here */};
INT : '0'..'9'+ {/* and here */};

I am just curious if that is possible?

Thanks in advance
Tom

From sean.bridges at gmail.com  Wed Jul 23 09:26:08 2008
From: sean.bridges at gmail.com (Sean Bridges)
Date: Wed, 23 Jul 2008 09:26:08 -0700
Subject: [antlr-interest] unrelated rule causing warnings
In-Reply-To: <11926085.181216806704945.JavaMail.ICEMail@snegopad>
References: <e188854c0807221130x7558857fy53e44e9e31728b6a@mail.gmail.com>
	<11926085.181216806704945.JavaMail.ICEMail@snegopad>
Message-ID: <e188854c0807230926h21f79abei449f59d732c9aad7@mail.gmail.com>

'a' may match two rules, but given a start rule, isn't there always
only one way to parse 'a'?

The grammar also compiles without warning if I remove the from_clause
rule, which confuses me since from_clause does not refer to
column_reference.

Thanks,

Sean

On Wed, Jul 23, 2008 at 2:51 AM, Ian Moor <iwm at doc.ic.ac.uk> wrote:
>>Hello,
>>
>>This is a simplified version of the grammar I am working on.
>>
>>grammar Test;
>>
>>//comment out from_clause
>>//and warning in qualified_name
>>//goes away
>>from_clause
>>       :       'FROM' qualified_name ;
>>
>>column_reference
>>       :       (qualified_name PERIOD)? 'a';
>>
>>qualified_name
>>       :       ('a' PERIOD)? 'a';
>>
>>PERIOD  :       '.';
>>
>>WS
>>   : (' '|'\t'|'\n'|'\r')+ {channel=HIDDEN;};
>>
>>
>>
>>When I compile this with antlr 3 (or 3.1 beta) I get a warning for the
>>qualified_name rule,
>>
>> warning(202): Test.g:13:4: the decision cannot distinguish between
>>alternative(s) 1,2 for at least one input sequence
>>
>>If I comment out the from_clause rule, the grammar compiles without warning.
>>
>>Is my grammar ambiguous?  How does adding/removing the from_clause
>>rule change the ambiguity of the qualified_name rule?
>>
>>Thanks,
>>
>>Sean
>>
> The problem is that 'a'  is either  a column_reference or a qualified_name
>   Ian Moor
>
>

From parrt at cs.usfca.edu  Wed Jul 23 09:50:43 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 09:50:43 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<20080722205821.SAQB9538.viefep32-int.chello.at@schnuftikus.gmx.at>
	<561cc61d0807221903g5422bfc5i9bfcef01fbfa4ede@mail.gmail.com>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
Message-ID: <D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>

Ha! Hilarious, Ger!

True, it does not have to describe what it does I guess, but sometimes  
it works well.  Microsoft Word is a pretty good name you have to  
admit.   By analogy, we should call this tool "token". :)

I'm also concerned that metamorph has three syllables. I think it has  
to have one or two.  StringTemplate fails this test for example but  
ANTLR is good.

Ter

From parrt at cs.usfca.edu  Wed Jul 23 09:57:30 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 09:57:30 -0700
Subject: [antlr-interest] [stringtemplate-interest] we need a name for a
	new rewriting tool
In-Reply-To: <b38f063f0807230212s76a49085j39a1ef98b68f6d52@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<b38f063f0807230212s76a49085j39a1ef98b68f6d52@mail.gmail.com>
Message-ID: <C60EBAF5-C2B8-4708-8BD5-CA62337D8E18@cs.usfca.edu>

  and
On Jul 23, 2008, at 2:12 AM, Swapnil Kashikar wrote:

> How about "Morpheze" -- eze shows meaning and rhyming with trapeze
> brings to mind a picture of doing mental acrobatics on a bar suspended
> on two ropes (say, antlr & stringtemplate :-)

Interesting...Actually,Something related to a stag or antlers would be  
cool.  What about horn, buck, rhino, or stag?  Heh, i really like  
those...

Perhaps stag says it all ;) although buck is nice because it is easy  
to mispronounce ;) horn is nice because the adjective is horny ;)   
Ah... so many names, so little time.

Ter

From parrt at cs.usfca.edu  Wed Jul 23 10:03:38 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 10:03:38 -0700
Subject: [antlr-interest] [stringtemplate-interest] we need a name for a
	new rewriting tool
In-Reply-To: <b38f063f0807230212s76a49085j39a1ef98b68f6d52@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<b38f063f0807230212s76a49085j39a1ef98b68f6d52@mail.gmail.com>
Message-ID: <669C694A-6A64-4C4C-8102-5DC978ECCA06@cs.usfca.edu>

actually,What about antelope or pronghorn? a guess that one is too  
close to the failed Longhorn.  moose? gazelle!  i like that.

Gazelle...yes, that's good! it's the nickname i gave to an old friend  
of mine Jonell Gazelle.  Awesome. i see no name collision.

Ter

On Jul 23, 2008, at 2:12 AM, Swapnil Kashikar wrote:

> How about "Morpheze" -- eze shows meaning and rhyming with trapeze
> brings to mind a picture of doing mental acrobatics on a bar suspended
> on two ropes (say, antlr & stringtemplate :-)
>
> Swapnil
>
> On Tue, Jul 22, 2008 at 4:09 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
>> Hi, Leon Su, the maniac that brings you gUnit is currently working
>> with me on a rewrite system similar to other rewrite engines such as
>> ASF+SDF, Stratego, TXL etc...  I believe the tool is in line with the
>> strategy championed by Andy Tripp.
>>
>> You'll be able to say things like "whenever you see x+0 in an IF
>> expression, rewrite it to x":
>>
>> ---------------------
>> rewrite Java; // applies rewrite rules to external java grammar
>> tokens {
>>       x=ID;
>> }
>>
>> [ifstat ... expr]:
>>       "x+0" -> "x"
>>       "0+x" -> "x"
>>       ...
>> ---------------------
>>
>> It is going to be extremely cool and will also work for tree  
>> rewrites.
>>
>> The only problem we have is that we don't know what to call it. I
>> originally had a nice tree rewriting system called Sorcerer (14 years
>> ago) but now there are things like sourcerer and so on. can anybody
>> help us name this tool?
>>
>> THesaurus entries:
>>
>> rewrite: revise, recast,reword, rephrase, redraft.
>>
>> transform: change, alter,convert, metamorphose, transfigure,
>> transmute, mutate; revolutionize,overhaul; remodel, reshape, redo,
>> reconstruct, rebuild, reorganize, rearrange,rework, renew, revamp,
>> remake, retool, transmogrify, morph
>>
>> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>>
>> Do any of those words help us?
>>
>> I think "morph" is actually not bad.  Morpheme sounds cooler but  
>> makes
>> less sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that
>> one is funny.
>>
>> How about metamorph? I like that one! google search only reveals a
>> molecular device and some stupid school has taken metamorph.org. I
>> guess that is no big deal because we will be using the antlr.org
>> website for that.
>>
>> Ter
>> _______________________________________________
>> stringtemplate-interest mailing list
>> stringtemplate-interest at antlr.org
>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From rschulz at sonic.net  Wed Jul 23 10:04:20 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Wed, 23 Jul 2008 10:04:20 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
Message-ID: <200807231004.20200.rschulz@sonic.net>

On Wednesday 23 July 2008 09:50, Terence Parr wrote:
> Ha! Hilarious, Ger!
>
> True, it does not have to describe what it does I guess, but
> sometimes it works well.  Microsoft Word is a pretty good name you
> have to admit.   By analogy, we should call this tool "token". :)
>
> I'm also concerned that metamorph has three syllables. I think it has
> to have one or two.  StringTemplate fails this test for example but
> ANTLR is good.

An important factor to consider about naming projects in this age is how 
it interacts with today's dumb but far-reaching Web indexers. 
Specifically, using an real word, let alone a common one, can make it 
very hard for people to find you. If you really want to use a real 
English word, it's advisable to create a variant spelling.

ANTLR works very well in this regard, since it's not even an English 
word.

From this perspective, "Brian" would be a singularly bad choice.


> Ter


Randall Schulz

From jaluber at gmx.de  Wed Jul 23 10:09:24 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 23 Jul 2008 19:09:24 +0200
Subject: [antlr-interest] How do I use a custom token object?
In-Reply-To: <E1KLfyB-000Ncb-00.tt-slot-mail-ru@f177.mail.ru>
References: <E1KLfyB-000Ncb-00.tt-slot-mail-ru@f177.mail.ru>
Message-ID: <488765C4.2000604@gmx.de>

Tom MacEllen schrieb:
> Hi there,
> 
> I have got a question about the wiki entry "How do I use a custom token object?" (found under http://www.antlr.org/wiki/pages/viewpage.action?pageId=1844).
> 
> In the example the custom token class is extended with the integer x.
> But the setting of the value of the field x is hard-coded in the emit method.
> 
> Is there a way to alter this value from the action in the grammar.
> Something like:
> ID : 'a'..'z'+  {/* set the integer x from here */};
> INT : '0'..'9'+ {/* and here */};
> 
> I am just curious if that is possible?

Doesn't ID.x or INT.x work?

Johannes
> 
> Thanks in advance
> Tom
> 


From parrt at cs.usfca.edu  Wed Jul 23 10:11:04 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 10:11:04 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <200807231004.20200.rschulz@sonic.net>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
Message-ID: <58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>


On Jul 23, 2008, at 10:04 AM, Randall R Schulz wrote:
> From this perspective, "Brian" would be a singularly bad choice.


I agree. Yep, gazelle would be difficult also...perhaps gzelle ;)   
Hmm...of course django is a pretty bad name for a tool by that measure  
because of the popular musician; people can still find the tool  
though. Most people will know that if they type in gazelle or brian  
they would also have to say "language" or "tool" etc....

Ter

From pink at odahoda.de  Wed Jul 23 10:18:23 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Wed, 23 Jul 2008 19:18:23 +0200
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <200807221932.02185.amax@redsymbol.net>
References: <200807181455.52897.amax@redsymbol.net>
	<543531490807200133n1805d42bp593079d61260d283@mail.gmail.com>
	<488306D4.4020108@gmx.de> <200807221932.02185.amax@redsymbol.net>
Message-ID: <543531490807231018q26025a77pf163d0152c9a695c@mail.gmail.com>

Hi Aaron,

On Wed, Jul 23, 2008 at 4:32 AM, Aaron Maxwell <amax at redsymbol.net> wrote:
> On Sunday 20 July 2008 02:35:16 am Johannes Luber wrote:
>> Benjamin Niemann schrieb:
>> > there is a Python grammar in examples package. It's the 2.3 grammar,
>> > but you may use parts of both to get a working Python2.5 grammar.
>
>> Regarding the sample grammars: In the repository there are sample
>> grammars for these languages as well. Ter is probably planning to update
>
> Hi all,
>
> Benjamin, Johannes, thanks for the advice.  Using it, I have a
> partial port of the python 2.5 grammar to python language target, for
> antlr 3.1:
>
> http://redsymbol.net/files/antlr/Python-python-2.5-2008-07-22.tgz

Cool! I'll have a look at it later.

> One big problem I see is that the generated PythonLexer.py has a
> dangling elif clause - it prints this:
>
> {{{
>            elif alt28 == 2:
>                # Python.g:615:10:
> <that's it - no statements in the block>
> }}}
>
> Due to Python's block structure by indentation, this is not correct
> python syntax - there needs to be a "pass" statement, or the elif
> clause needs to be omitted altogether.  The offending rule in the
> grammar is:
>
> {{{
> CONTINUED_LINE
>    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
>         ( nl=NEWLINE
> {self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
>         |
>         )
>    ;
> }}}
>
> I tried removing the emtpy "|" line, like this:
>
> {{{
> CONTINUED_LINE
>    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
>         ( nl=NEWLINE
> {self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
>         )
>    ;
> }}}
>
> Then the lexer code's syntax is correct.  However, the parser then
> cannot correctly parse lines that are broken by a backslash (i.e., one
> logical line split over two lines) -- for example:
> {{{
> ** ./CPythonLib/plat-sunos5/STROPTS.py
> line 836:8 required (...)+ loop did not match anything at character u'('
> line 1396:24 required (...)+ loop did not match anything at character u'A'
> line 1397:24 required (...)+ loop did not match anything at character u'A'
>
> }}}
>
> Can someone suggest a fix?  I tried just putting { pass;} in there,
> but it is not placed at the correct indentation level.  Plus that is just
> hackish.

Mmm.. that should work. This is the only way to get empty alternatives
to work right now, and I've used it several times without problems.
I'll have a look at the code and checkout why it doesn't work in this
case - but probably not before the weekend.

-Ben

From monty at codetransform.com  Wed Jul 23 10:31:27 2008
From: monty at codetransform.com (Monty Zukowski)
Date: Wed, 23 Jul 2008 10:31:27 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
	<58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>
Message-ID: <73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>

Not to detract from the excellent ruminant names or other great
suggestions, but how about "CodeTransform"?  I'll even donate my
domain codetransform.com, since I'm not really using it.

Monty

From monty at codetransform.com  Wed Jul 23 10:33:23 2008
From: monty at codetransform.com (Monty Zukowski)
Date: Wed, 23 Jul 2008 10:33:23 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
	<58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>
	<73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>
Message-ID: <73e8e3430807231033y63d4dcbam9eb761a8110a570e@mail.gmail.com>

By the way, the new tool sounds most excellent!

Monty

On Wed, Jul 23, 2008 at 10:31 AM, Monty Zukowski
<monty at codetransform.com> wrote:
> Not to detract from the excellent ruminant names or other great
> suggestions, but how about "CodeTransform"?  I'll even donate my
> domain codetransform.com, since I'm not really using it.
>
> Monty
>

From parrt at cs.usfca.edu  Wed Jul 23 10:36:13 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 10:36:13 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
	<58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>
	<73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>
Message-ID: <9C871B6D-07D3-41FC-BB19-93A87C63EB32@cs.usfca.edu>


On Jul 23, 2008, at 10:31 AM, Monty Zukowski wrote:

> Not to detract from the excellent ruminant names or other great
> suggestions, but how about "CodeTransform"?  I'll even donate my
> domain codetransform.com, since I'm not really using it.

Intersting...might be a bit long and also it will transform lots of  
things other than code.

Yep, this tool is shaping up extremely well.  Leon is doing an  
excellent job.
Ter

From objectxtreme+antlr at gmail.com  Wed Jul 23 10:51:47 2008
From: objectxtreme+antlr at gmail.com (Masashi Fujita)
Date: Thu, 24 Jul 2008 02:51:47 +0900
Subject: [antlr-interest] Q: Multiple global dynamic attribute scopes
Message-ID: <a57e62770807231051h6c708754p8dc96f921be327ee@mail.gmail.com>

Hi!

Placing multiple global dynamic attribute scopes to a rule is allowed
or not ?  I've tried following grammar:

{{{

grammar ScopeTest ;

scope Scope1 {
    int	field_ ;
}
scope Scope2 {
    int	field_ ;
}

rule
    scope {
        int	s_ ;
    }
    scope Scope1 ;
    scope Scope2 ;
    : subrule
    ;

subrule
    : ID
    ;

ID
    : 'a'..'z' | 'A'..'Z'
    ;
}}}

ANTLR 3.1b2 generates codes without errors, but seems to forget
pushing "Scope1". Generated code fragment is following:

{{{
    public final void rule() throws RecognitionException {
        Scope2_stack.push(new Scope2_scope());
        rule_stack.push(new rule_scope());
        try {
}}}

Regards.

From amax at redsymbol.net  Wed Jul 23 10:55:35 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Wed, 23 Jul 2008 10:55:35 -0700
Subject: [antlr-interest] python-lang parser to python target
Message-ID: <200807231055.35877.amax@redsymbol.net>

On Wednesday 23 July 2008 10:18:23 am you wrote:
[regarding empty elif clause in lexer]
> > Can someone suggest a fix?  I tried just putting { pass;} in there,
> > but it is not placed at the correct indentation level.  Plus that is just
> > hackish.
>
> Mmm.. that should work. This is the only way to get empty alternatives
> to work right now, and I've used it several times without problems.
> I'll have a look at the code and checkout why it doesn't work in this
> case - but probably not before the weekend.

I wrote it like this:

{{{
CONTINUED_LINE
    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
         ( nl=NEWLINE 
{self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
         | {pass;}
         )
    ;
}}}

I also tried "{    pass;}", i.e. manually placing four spaces in there - both 
produced the same lexer code.  Is that the right syntax?

-- 
Aaron Maxwell
http://redsymbol.net

From parrt at cs.usfca.edu  Wed Jul 23 10:59:44 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 10:59:44 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <9C871B6D-07D3-41FC-BB19-93A87C63EB32@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
	<58BB7DF8-7380-478D-8774-7BCBDCB964C0@cs.usfca.edu>
	<73e8e3430807231031r7931d605tdc8dfff2f491a471@mail.gmail.com>
	<9C871B6D-07D3-41FC-BB19-93A87C63EB32@cs.usfca.edu>
Message-ID: <46284756-A70A-47FD-9E07-66E8EF8881A6@cs.usfca.edu>

What about the ANTLR Morph tool?  Morph is a great name but needs  
something...we just call it morph for short, but it's real name is  
ANTLR Morph or whatever.

Ter

From r_reitzi at cs.uni-kl.de  Wed Jul 23 12:21:56 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Wed, 23 Jul 2008 21:21:56 +0200
Subject: [antlr-interest] [stringtemplate-interest] we need a name for	a
	new rewriting tool
In-Reply-To: <C60EBAF5-C2B8-4708-8BD5-CA62337D8E18@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<b38f063f0807230212s76a49085j39a1ef98b68f6d52@mail.gmail.com>
	<C60EBAF5-C2B8-4708-8BD5-CA62337D8E18@cs.usfca.edu>
Message-ID: <20080723212156.14693kzcsyejihmo@horde.verrech.net>

Stags shed their antler each year, only to see it returned bigger and  
thus, more powerful.
So, what do you think of Shedr? Shed the old, busted code (or  
whatever) and get new, better one. I think it continues the story of  
antlr and stores the function of the tool as well. Man, I'm getting  
epic here :>

Regards

Raphael

PS: Another word with a similar meaning would do as well, but those'd  
be better for a native to find :)

"Terence Parr" <parrt at cs.usfca.edu> wrote (Wed Jul 23 18:57:30 2008):

>  and
> On Jul 23, 2008, at 2:12 AM, Swapnil Kashikar wrote:
>
>> How about "Morpheze" -- eze shows meaning and rhyming with trapeze
>> brings to mind a picture of doing mental acrobatics on a bar suspended
>> on two ropes (say, antlr & stringtemplate :-)
>
> Interesting...Actually,Something related to a stag or antlers would  
> be cool.  What about horn, buck, rhino, or stag?  Heh, i really like  
> those...
>
> Perhaps stag says it all ;) although buck is nice because it is easy  
> to mispronounce ;) horn is nice because the adjective is horny ;)   
> Ah... so many names, so little time.
>
> Ter
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/45b60508/attachment.bin 

From rusinskystanislas at yahoo.fr  Wed Jul 23 12:42:17 2008
From: rusinskystanislas at yahoo.fr (Stan)
Date: Wed, 23 Jul 2008 19:42:17 +0000 (GMT)
Subject: [antlr-interest] we need a name for a new rewriting tool
Message-ID: <952750.75564.qm@web26507.mail.ukl.yahoo.com>

What about "TRANSFORMR" or "MORPHy"?

Stanislas Herman Rusinsky.
Sent from my iPhone

On 23 Jul 2008, at 19:36, Terence Parr <parrt at cs.usfca.edu> wrote:


On Jul 23, 2008, at 10:31 AM, Monty Zukowski wrote:

Not to detract from the excellent ruminant names or other great
suggestions, but how about "CodeTransform"?  I'll even donate my
domain codetransform.com, since I'm not really using it.

Intersting...might be a bit long and also it will transform lots of things other than code.

Yep, this tool is shaping up extremely well.  Leon is doing an excellent job.
Ter



      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From namit.setia at lehman.com  Wed Jul 23 13:28:50 2008
From: namit.setia at lehman.com (Setia, Namit)
Date: Wed, 23 Jul 2008 16:28:50 -0400
Subject: [antlr-interest] Antlr missing getTree() method? C#
Message-ID: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.leh.lbcorp.lehman.com>

I'm sure there is something I'm doing wrong, but I can't figure it out.
I created a grammar (see below) and exported it to C#, then tried the
following code as a test:

Antlr.Runtime.ICharStream str = new
Antlr.Runtime.ANTLRStringStream("a=5;");
qss_grammarLexer qlex = new qss_grammarLexer(str);
Antlr.Runtime.CommonTokenStream tokens = new
Antlr.Runtime.CommonTokenStream(qlex);
qss_grammarParser qpar = new qss_grammarParser(tokens);

For some reason, I don't see any methods to extract the AST tree from
the parser (i.e., from the "qpar" variable).  I've seen in other posts
people calling qpar.getTree() or qpar.program().  Am I missing something
critical from my grammar?  Is it missing badly?  Or, am I supposed to
get the tree some other way?  I am using the daily build of antlr from
6/26/08 and antlworks 1.2b5.  I tried reverting to the older version,
and I get the same result.

Thanks,

namit

------------------------------------------------------------------------
--------------------------------------
grammar qss_grammar;

options
{
	language=CSharp2;
	output=AST;
}

qexprlist
  : ( qassignment_statement )* EOF!
  ;

qassignment_statement
  : qassignment SEMI { Console.Write("hello"); }
  ;

qassignment
  : (qname ASSIGN )? qexpr
  ;

qprimary_expr
  : qint
  | qvname
  | (LPAREN qexpr RPAREN ) 
  | qfunction
  | qarray
  | qstring
  ;

qsign_expr
  : qprimary_expr
  ;

qmul_expr
  : qsign_expr (( MUL | DIV | MOD ) qsign_expr)*
  ;
  
qexpr
  	:	 qmul_expr (( PLUS | MINUS ) qmul_expr)*
  ;



PLUS	:	'+';
MINUS	:	'-';
DIV	:	'/';
MUL	:	'*';
MOD	:	'%';
POW	:	'^';
LETTER	:	'a'..'z'|'A'..'Z';
DIGIT	:	'0'..'9';
PER	:	'.';
SEMI	:	';';
ASSIGN	:	'=';
EQ	:	'=''=';
NQ	:	'!''=';
LEQ	:	'<''=';
GEQ	:	'>''=';
LPAREN	:	'(';
RPAREN	:	')';

qint	:	(DIGIT)*;
qname	:	LETTER(LETTER|DIGIT)*;
qstr	:	(LETTER|DIGIT)*;
qstring	:	'"' (LETTER|DIGIT)* '"';
qinputval:	(LETTER|DIGIT)*;
qvname	:	(LETTER(LETTER|DIGIT)*)(':'qinputval('.'qinputval)*)?;
qarray	:	'{' (qstring|qvname)(','(qstring|qvname))* '}';
qfunction:	(LETTER(LETTER|DIGIT)*)'('
qprimary_expr(','qprimary_expr)* ')';


- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

This message is intended only for the personal and confidential use of the designated recipient(s) named above.  If you are not the intended recipient of this message you are hereby notified that any review, dissemination, distribution or copying of this message is strictly prohibited.  This communication is for information purposes only and should not be regarded as an offer to sell or as a solicitation of an offer to buy any financial product, an official confirmation of any transaction, or as an official statement of Lehman Brothers.  Email transmission cannot be guaranteed to be secure or error-free.  Therefore, we do not represent that this information is complete or accurate and it should not be relied upon as such.  All information is subject to change without notice.

--------
IRS Circular 230 Disclosure:
Please be advised that any discussion of U.S. tax matters contained within this communication (including any attachments) is not intended or written to be used and cannot be used for the purpose of (i) avoiding U.S. tax related penalties or (ii) promoting, marketing or recommending to another party any transaction or matter addressed herein.

From johan.grande at crans.org  Wed Jul 23 14:03:53 2008
From: johan.grande at crans.org (Johan Grande)
Date: Wed, 23 Jul 2008 23:03:53 +0200
Subject: [antlr-interest]
 lexer	doesn't	see	super	constructor	&	inherited variable
In-Reply-To: <20080722093152.10411l4ktgbw35y8@horde.verrech.net>
References: <4884D06B.1040105@crans.org>	<20080721214420.65331lsreb5k0sas@horde.verrech.net>	<4884E915.3040009@crans.org>	<20080721221053.9423349djoc1z3gg@horde.verrech.net>	<48850127.3060908@crans.org>
	<20080722093152.10411l4ktgbw35y8@horde.verrech.net>
Message-ID: <48879CB9.9020700@crans.org>

Raphael Reitzig wrote:
> "Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 23:35:35 2008):
>> I don't know all the subtleties of Java, but it would be great if you 
>> could explain me how the bug can just exist.
> I can only think of Classpath and compatibility issues.
> 
> Please send me both the gramar file and the jar you use. I want to try 
> exactly this combination here...
> 
Recently I had troubles with Ant : things witch worked before I 
installed Antlr 3.1b2 don't any more. I have to compile and test "by 
hand". I'm not sure it's the direct cause of my problems, but it is 
highly possible.

Nevertheless, I give you in attachment a grammar extracted from the real 
one which shows the bug due to Antlr v3.0.1 .
I use the real grammar for tree construction as here in comments.

Regards,
Johan

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Toto.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/edee4cde/attachment.pl 

From johan.grande at crans.org  Wed Jul 23 14:06:22 2008
From: johan.grande at crans.org (Johan Grande)
Date: Wed, 23 Jul 2008 23:06:22 +0200
Subject: [antlr-interest]
 lexer	doesn't	see	super	constructor	&	inherited variable
In-Reply-To: <20080722093152.10411l4ktgbw35y8@horde.verrech.net>
References: <4884D06B.1040105@crans.org>	<20080721214420.65331lsreb5k0sas@horde.verrech.net>	<4884E915.3040009@crans.org>	<20080721221053.9423349djoc1z3gg@horde.verrech.net>	<48850127.3060908@crans.org>
	<20080722093152.10411l4ktgbw35y8@horde.verrech.net>
Message-ID: <48879D4E.7020700@crans.org>

Raphael Reitzig wrote:
> "Johan Grande" <johan.grande at crans.org> wrote (Mon Jul 21 23:35:35 2008):
>> I don't know all the subtleties of Java, but it would be great if you 
>> could explain me how the bug can just exist.
> I can only think of Classpath and compatibility issues.
> 
> Please send me both the gramar file and the jar you use. I want to try 
> exactly this combination here...
> 
Recently I had troubles with Ant : things witch worked before I 
installed Antlr 3.1b2 don't any more. I have to compile and test "by 
hand". I'm not sure it's the direct cause of my problems, but it is 
highly possible.

Nevertheless, I give you in attachment a grammar extracted from the real 
one which shows the bug due to Antlr v3.0.1 .
I use the real grammar for tree construction as here in comments.

Regards,
Johan

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Toto.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/482627eb/attachment.pl 

From simos.lists at googlemail.com  Wed Jul 23 14:25:01 2008
From: simos.lists at googlemail.com (Simos Xenitellis)
Date: Wed, 23 Jul 2008 22:25:01 +0100
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
Message-ID: <598e9210807231425y4d781af3u80d4d70fee507e74@mail.gmail.com>

Hi,

An option is "anamorph".

The following is from a modern Greek dictionary, translated to English,

anamorph: (v) 1. give a new, enhanced form. For example, when you make
the educational system better. 2. when you make better the behaviour
of someone, such as a young person.

Simos

On Tue, Jul 22, 2008 at 9:09 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi, Leon Su, the maniac that brings you gUnit is currently working with me
> on a rewrite system similar to other rewrite engines such as ASF+SDF,
> Stratego, TXL etc...  I believe the tool is in line with the strategy
> championed by Andy Tripp.
>
> You'll be able to say things like "whenever you see x+0 in an IF expression,
> rewrite it to x":
>
> ---------------------
> rewrite Java; // applies rewrite rules to external java grammar
> tokens {
>        x=ID;
> }
>
> [ifstat ... expr]:
>        "x+0" -> "x"
>        "0+x" -> "x"
>        ...
> ---------------------
>
> It is going to be extremely cool and will also work for tree rewrites.
>
> The only problem we have is that we don't know what to call it. I originally
> had a nice tree rewriting system called Sorcerer (14 years ago) but now
> there are things like sourcerer and so on. can anybody help us name this
> tool?
>
> THesaurus entries:
>
> rewrite: revise, recast,reword, rephrase, redraft.
>
> transform: change, alter,convert, metamorphose, transfigure, transmute,
> mutate; revolutionize,overhaul; remodel, reshape, redo, reconstruct,
> rebuild, reorganize, rearrange,rework, renew, revamp, remake, retool,
> transmogrify, morph
>
> rebuild: reconstruct, renovate, restore, remodel, remake,reassemble.
>
> Do any of those words help us?
>
> I think "morph" is actually not bad.  Morpheme sounds cooler but makes less
> sense.  Morphica?  Morphic?  Morphologic? Morphomatic? ha! that one is
> funny.
>
> How about metamorph? I like that one! google search only reveals a molecular
> device and some stupid school has taken metamorph.org. I guess that is no
> big deal because we will be using the antlr.org website for that.
>
> Ter
>

From antlr at mirality.co.nz  Wed Jul 23 15:00:57 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Jul 2008 10:00:57 +1200
Subject: [antlr-interest] Antlr missing getTree() method? C#
In-Reply-To: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.le
	h.lbcorp.lehman.com>
References: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.leh.lbcorp.lehman.com>
Message-ID: <20080723220104.E97FB11EB84@www.antlr.org>

At 08:28 24/07/2008, Setia, Namit wrote:
 >For some reason, I don't see any methods to extract the AST
 >tree from the parser (i.e., from the "qpar" variable).  I've
 >seen in other posts people calling qpar.getTree() or
 >qpar.program().  Am I missing something critical from my 
grammar?

You need to call the top-level rule in your parser.  Which in your 
case appears to be 'qexprlist'.  So call qpar.qexprlist() and 
it'll either return the tree directly or the tree will be one of 
the members of the structure it returns.  (Things vary a little 
depending on target and grammar structure, but it's not hard to 
work out.)


From antlr at mirality.co.nz  Wed Jul 23 15:06:02 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Jul 2008 10:06:02 +1200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <598e9210807231425y4d781af3u80d4d70fee507e74@mail.gmail.com
 >
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<598e9210807231425y4d781af3u80d4d70fee507e74@mail.gmail.com>
Message-ID: <20080723220610.1A1CB352293@www.antlr.org>

At 09:25 24/07/2008, Simos Xenitellis wrote:
 >An option is "anamorph".
[...]
 >anamorph: (v) 1. give a new, enhanced form. For example, when 
you
 >make the educational system better. 2. when you make better the
 >behaviour of someone, such as a young person.

"Antlrmorph" or even "Antlamorph" sounds good to me.

Or maybe, to get the "rewrite" term in there, something like 
"ANTLRewrite" or "ANTLRwrite"?


From jaluber at gmx.de  Wed Jul 23 16:05:00 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 24 Jul 2008 01:05:00 +0200
Subject: [antlr-interest] Antlr missing getTree() method? C#
In-Reply-To: <20080723220104.E97FB11EB84@www.antlr.org>
References: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.leh.lbcorp.lehman.com>
	<20080723220104.E97FB11EB84@www.antlr.org>
Message-ID: <4887B91C.1010600@gmx.de>

Gavin Lambert schrieb:
> At 08:28 24/07/2008, Setia, Namit wrote:
>  >For some reason, I don't see any methods to extract the AST
>  >tree from the parser (i.e., from the "qpar" variable).  I've
>  >seen in other posts people calling qpar.getTree() or
>  >qpar.program().  Am I missing something critical from my grammar?
> 
> You need to call the top-level rule in your parser.  Which in your case 
> appears to be 'qexprlist'.  So call qpar.qexprlist() and it'll either 
> return the tree directly or the tree will be one of the members of the 
> structure it returns.  (Things vary a little depending on target and 
> grammar structure, but it's not hard to work out.)
> 

And unless I missed it the name of getTree() is simply Tree in the C# 
target.

Johannes

From parrt at cs.usfca.edu  Wed Jul 23 16:10:43 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Jul 2008 16:10:43 -0700
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <20080723220610.1A1CB352293@www.antlr.org>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<598e9210807231425y4d781af3u80d4d70fee507e74@mail.gmail.com>
	<20080723220610.1A1CB352293@www.antlr.org>
Message-ID: <1AECD02C-E2AD-4801-B50D-A40B3CE51910@cs.usfca.edu>

Yep, I'm thinking ANTLR Morph, or morph for short in we know what  
we're talking about otherwise fully ANTLR Morph :)  Gotta use the  
brand awareness.  Leon like Morph also.

Ter
On Jul 23, 2008, at 3:06 PM, Gavin Lambert wrote:

> At 09:25 24/07/2008, Simos Xenitellis wrote:
> >An option is "anamorph".
> [...]
> >anamorph: (v) 1. give a new, enhanced form. For example, when you
> >make the educational system better. 2. when you make better the
> >behaviour of someone, such as a young person.
>
> "Antlrmorph" or even "Antlamorph" sounds good to me.
>
> Or maybe, to get the "rewrite" term in there, something like  
> "ANTLRewrite" or "ANTLRwrite"?
>


From antlr at mirality.co.nz  Wed Jul 23 17:29:38 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Jul 2008 12:29:38 +1200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <1AECD02C-E2AD-4801-B50D-A40B3CE51910@cs.usfca.edu>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<598e9210807231425y4d781af3u80d4d70fee507e74@mail.gmail.com>
	<20080723220610.1A1CB352293@www.antlr.org>
	<1AECD02C-E2AD-4801-B50D-A40B3CE51910@cs.usfca.edu>
Message-ID: <20080724002946.BFAAC3D148A@www.antlr.org>

At 11:10 24/07/2008, Terence Parr wrote:
 >Yep, I'm thinking ANTLR Morph, or morph for short in we
 >know what we're talking about otherwise fully ANTLR Morph :)
 >Gotta use the  brand awareness.  Leon like Morph also.

Mighty Morphin' Power ANTLRs!

(cough)

:)


From ame01 at gmx.net  Wed Jul 23 17:35:48 2008
From: ame01 at gmx.net (Aurelian Melinte)
Date: Thu, 24 Jul 2008 02:35:48 +0200
Subject: [antlr-interest] ANTLR 3.0.1 -debug?
Message-ID: <20080724003548.223040@gmx.net>

Hello,

I am trying to have ANTLR generate a parser with debugging. When I try the -debug option, I get the output pasted below.  I am using a C target and the ANTLR 3.0.1 binaries from the source distribution kit.  

Please advise,
a.
 

ANTLR Parser Generator  Version 3.0.1 (August 13, 2007)  1989-2007
error(10):  internal error: group CDbg line 33: template outputFile has no region called imports 
error(10):  internal error: group CDbg line 78: template genericParser has no region called superClassName 
error(10):  internal error: group CDbg line 160: template dfaState has no region called noViableAltException 
error(10):  internal error: group CDbg line 162: template dfaStateSwitch has no region called noViableAltException 
...
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
 at java.util.LinkedList.<init>(Unknown Source)
 at org.antlr.stringtemplate.StringTemplate.addEmbeddedInstance(StringTemplate.java:389)
 at org.antlr.stringtemplate.StringTemplate.setEnclosingInstance(StringTemplate.java:383)
 at org.antlr.stringtemplate.StringTemplateGroup.getEmbeddedInstanceOf(StringTemplateGroup.java:421)
 at org.antlr.stringtemplate.language.ASTExpr.getTemplateInclude(ASTExpr.java:637)
 at org.antlr.stringtemplate.language.ActionEvaluator.templateInclude(ActionEvaluator.java:465)
 at org.antlr.stringtemplate.language.ActionEvaluator.expr(ActionEvaluator.java:137)
 at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:79)
 at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:152)
 at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
 at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:722)
 at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:742)
 at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:659)
 at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:81)
 at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:152)
 at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
 at org.antlr.codegen.CodeGenerator.write(CodeGenerator.java:1132)
 at org.antlr.codegen.CTarget.genRecognizerHeaderFile(CTarget.java:63)
 at org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:442)
 at org.antlr.Tool.processGrammar(Tool.java:347)
 at org.antlr.Tool.process(Tool.java:311)
 at org.antlr.Tool.main(Tool.java:70)
Could Not Find c:\Documents and Settings\amelinte\Desktop\newparser\CPP*.gif
Build log was saved at "file://c:\Documents and Settings\amelinte\Desktop\newparser\Debug\BuildLog.htm"
cppparser - 4 error(s), 0 warning(s)
========== Rebuild All: 0 succeeded, 1 failed, 0 skipped ==========

-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer

From cokey5614 at sina.com  Wed Jul 23 21:25:35 2008
From: cokey5614 at sina.com (cokey5614 at sina.com)
Date: Thu, 24 Jul 2008 12:25:35 +0800 
Subject: [antlr-interest] error in running Antlr  [a simple problem,
	but.. help me please! ]
Message-ID: <20080724042535.D18423D7998@mail3-147.sinamail.sina.com.cn>

&nbsp;hi, 
&nbsp;&nbsp; According to wiki's article [gUnit - Grammar Unit Testing ],
I tried the SimpleC, and I use:&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; java org.antlr.Tool SimpleC.g
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; java org.antlr.gunit.Interp SimpleC.testSuite
but, error has always happen:
Exception in thread "main" java.lang.NoClassDefFoundError:antlr/TokenStream
shall anybody tell me why does it happen?
OS:winXP
jdk:1.5.0_15
antlr:3.0.1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
thanks
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cokey

-------------------------------------------------------------------
????2G????(http://mail.sina.com.cn/)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/05892f97/attachment.html 

From leon.antlr at mac.com  Wed Jul 23 22:34:35 2008
From: leon.antlr at mac.com (Leon Su)
Date: Wed, 23 Jul 2008 22:34:35 -0700
Subject: [antlr-interest] error in running Antlr  [a simple problem,
 but.. help me please! ]
In-Reply-To: <20080724042535.D18423D7998@mail3-147.sinamail.sina.com.cn>
References: <20080724042535.D18423D7998@mail3-147.sinamail.sina.com.cn>
Message-ID: <4F16F41A-CD06-4466-97B4-CBF4B96A85CB@mac.com>

To correctly run ANTLR application, you have to not only add  
antlr-3.0.1.jar (or antlr-3.1b2.jar) but also antlr-2.7.7.jar into  
your classpath.
In addition, don't forget stringtemplate-3.x.jar.

Leon

On Jul 23, 2008, at 9:25 PM, cokey5614 at sina.com wrote:
>  hi,
>    According to wiki's article [gUnit - Grammar Unit Testing ],
> I tried the SimpleC, and I use:
>       java org.antlr.Tool SimpleC.g
>       java org.antlr.gunit.Interp SimpleC.testSuite
> but, error has always happen:
> Exception in thread "main" java.lang.NoClassDefFoundError:antlr/ 
> TokenStream
>
> shall anybody tell me why does it happen?
>
> OS:winXP
> jdk:1.5.0_15
> antlr:3.0.1
>
> thanks
>                           cokey
>
>
> ????2G????

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080723/edfdb227/attachment.html 

From craig at palantir.co.za  Wed Jul 23 22:36:03 2008
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Thu, 24 Jul 2008 07:36:03 +0200
Subject: [antlr-interest] Repeating Tree Nodes, help.
Message-ID: <20080724073603.86uv6ae40swk0kwc@webmail.palantir.co.za>

Hi,

I know this probably a very elementary question, but I have tried quite a few
combinations. I have a working template grammar that I am trying to convert to
using trees.

I have a production that looks like this:
rule: ROOT id+=IDENTIFIER (SEP id+=IDENTIFIER)+
      -> ^(ROOT $id)

I want to match something in the tree, and get out all the identifier(s) in a
list.

In the tree I have
rule: ^(ROOT xn+=IDENTIFIER+)

I only manage to ever get one identifer out. The above is a list with one token.
I don't really want to make a tree root with each identifer because then getting
them out into a list is a mission.

What should I do?

Thanks
Regards
Craig.


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From rusinskystanislas at yahoo.fr  Thu Jul 24 00:32:55 2008
From: rusinskystanislas at yahoo.fr (Stan)
Date: Thu, 24 Jul 2008 07:32:55 +0000 (GMT)
Subject: [antlr-interest] we need a name for a new rewriting tool
Message-ID: <147859.12924.qm@web26502.mail.ukl.yahoo.com>

A last one perhaps, to keep aligned with ANTLR: MORPHR

Stanislas.

On 24 Jul 2008, at 01:10, Terence Parr <parrt at cs.usfca.edu> wrote:

Yep, I'm thinking ANTLR Morph, or morph for short in we know what we're talking about otherwise fully ANTLR Morph :)  Gotta use the brand awareness.  Leon like Morph also.

Ter
On Jul 23, 2008, at 3:06 PM, Gavin Lambert wrote:

At 09:25 24/07/2008, Simos Xenitellis wrote:
>An option is "anamorph".
[...]
>anamorph: (v) 1. give a new, enhanced form. For example, when you
>make the educational system better. 2. when you make better the
>behaviour of someone, such as a young person.

"Antlrmorph" or even "Antlamorph" sounds good to me.

Or maybe, to get the "rewrite" term in there, something like "ANTLRewrite" or "ANTLRwrite"?





      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From r_reitzi at cs.uni-kl.de  Thu Jul 24 00:49:23 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Thu, 24 Jul 2008 09:49:23 +0200
Subject: [antlr-interest] Repeating Tree Nodes, help.
In-Reply-To: <20080724073603.86uv6ae40swk0kwc@webmail.palantir.co.za>
References: <20080724073603.86uv6ae40swk0kwc@webmail.palantir.co.za>
Message-ID: <20080724094923.69782bsxdpz4r8kk@horde.verrech.net>

Hi Craig!

Fallback Hack: Declare your own AST node class with a list attribute.

But I think there was a way to iterate children in ANTLR, just can't remember.

Regards

Raphael

craig at palantir.co.za wrote (Thu Jul 24 07:36:03 2008):

> Hi,
>
> I know this probably a very elementary question, but I have tried quite a few
> combinations. I have a working template grammar that I am trying to  
> convert to
> using trees.
>
> I have a production that looks like this:
> rule: ROOT id+=IDENTIFIER (SEP id+=IDENTIFIER)+
>       -> ^(ROOT $id)
>
> I want to match something in the tree, and get out all the identifier(s) in a
> list.
>
> In the tree I have
> rule: ^(ROOT xn+=IDENTIFIER+)
>
> I only manage to ever get one identifer out. The above is a list  
> with one token.
> I don't really want to make a tree root with each identifer because  
> then getting
> them out into a list is a mission.
>
> What should I do?
>
> Thanks
> Regards
> Craig.
>
>
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
>
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

From antlr at mirality.co.nz  Thu Jul 24 01:00:17 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Jul 2008 20:00:17 +1200
Subject: [antlr-interest] Repeating Tree Nodes, help.
In-Reply-To: <20080724073603.86uv6ae40swk0kwc@webmail.palantir.co.za>
References: <20080724073603.86uv6ae40swk0kwc@webmail.palantir.co.za>
Message-ID: <20080724080025.6304C312963@www.antlr.org>

At 17:36 24/07/2008, craig at palantir.co.za wrote:
 >In the tree I have
 >rule: ^(ROOT xn+=IDENTIFIER+)
 >
 >I only manage to ever get one identifer out. The above is a list 

 >with one token.
 >I don't really want to make a tree root with each identifer 
because
 >then getting them out into a list is a mission.

I think you're getting bitten by precedence there.  Try this 
instead:

rule: ^(ROOT (xn+=IDENTIFIER)+);


From Jean-Claude.Durand at imag.fr  Thu Jul 24 02:42:07 2008
From: Jean-Claude.Durand at imag.fr (Jean-Claude Durand)
Date: Thu, 24 Jul 2008 11:42:07 +0200
Subject: [antlr-interest] =?utf-8?q?_problem_with_composing_grammars=3A_th?=
 =?utf-8?q?anks_and_comments__=EF=BF=BC?=
Message-ID: <C21DAC30-38E1-4255-828D-24FFE39BC340@imag.fr>

Thanks for your  answer, I succeeded in compiling and running a small  
example.

Here are my comments:
- putting the lex grammar as the first import does not help;
- So, as you said, I declared the the 'lexer grammar' as 'grammar'  
and run ANTLR on it, and also on the "composed grammar". Thus I got  
all the files
(even one parser more, I do not use in compiling);
- the remaining problem, is that the definitions of the tokens  
( #define ...) are not the same in the different .h files (see my  
example below) and
some are missing. I just have to modify the files with the  
definitions given by LexLexer.h or LexParser.h, and it works !

?


Have a nice day,

Jean-Claude Durand

LIG, ?quipe GETALP
385, rue de la Biblioth?que
BP 53
38041 Grenoble cedex 9
FRANCE
Jean-Claude.Durand at imag.fr
t?l: +33 (0)4 76 51 43 81
fax: +33 (0)4 76 51 44 05

Le 22 juil. 08 ? 15:45, Jim Idle a ?crit :
Try putting the lex grammar as the first import. Not sure it will  
help but worth a try. Also you have lexer grammar and maybe just need  
grammar! But I also discovered some similar issues and terence is  
aware of them. For now use the lexer grammar stand alone and make the  
others parser grammars. There is no difference at run time.

ANTLR grammars are parsed with ANTLR 2 so you cannot use diacritics  
directly. You must use the equivalent \unnnn and then it is fine.
Sent via BlackBerry from T-Mobile



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/a09149c6/attachment-0002.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: composedGrammarsExample.tar.gz
Type: application/x-gzip
Size: 16664 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/a09149c6/attachment-0001.gz 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/a09149c6/attachment-0003.html 

From antlr at mirality.co.nz  Thu Jul 24 04:56:00 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Jul 2008 23:56:00 +1200
Subject: [antlr-interest] =?iso-8859-1?q?_Re=3A___problem_with_composing_g?=
 =?iso-8859-1?q?rammars=3A_th_anks_and__comments___=EF=BF=BC?=
In-Reply-To: <C21DAC30-38E1-4255-828D-24FFE39BC340@imag.fr>
References: <C21DAC30-38E1-4255-828D-24FFE39BC340@imag.fr>
Message-ID: <20080724115613.D2A9611EA9C@www.antlr.org>

At 21:42 24/07/2008, Jean-Claude Durand wrote:
>Here are my comments:
>- putting the lex grammar as the first import does not help;
>- So, as you said, I declared the the 'lexer grammar' as 
>'grammar'
>and run ANTLR on it, and also on the "composed grammar". Thus I 
>got
>all the files (even one parser more, I do not use in compiling);

It makes sense that you can't compose lexer and parser grammars 
together; they're quite different animals.

Instead of trying to do that, keep your lexers and parsers 
separate.  I guess you could still compose multiple lexers 
together and compose multiple parsers together, but don't try to 
mix lexers with parsers.

>- the remaining problem, is that the definitions of the tokens
>( #define ...) are not the same in the different .h files (see 
>my
>example below) and
>some are missing. I just have to modify the files with the
>definitions given by LexLexer.h or LexParser.h, and it works !

You need to use the importVocab option in your parser to load the 
.tokens file generated by the lexer.  Then the definitions will 
match.


From raymi at gmx.ch  Thu Jul 24 05:29:01 2008
From: raymi at gmx.ch (Dominik Raymann)
Date: Thu, 24 Jul 2008 14:29:01 +0200
Subject: [antlr-interest] Parsing Snippets of Code
Message-ID: <20080724122901.25900@gmx.net>

Hi there,

it is possible to parse Snippets of Code for a known languagewith ANTLR? In the FAQ example (http://www.antlr.org/wiki/pages/viewpage.action?pageId=789) for example what would I have to do to actually parse the given input (that represents a Java method), if I don't know whether it is a method, a method body, a class, a variable declaration or what else. Is this possible with ANTLR?

Cheers,

raymi
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer

From r.a.niemeijer at tue.nl  Thu Jul 24 06:31:21 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Thu, 24 Jul 2008 15:31:21 +0200
Subject: [antlr-interest] Trying to get started with ANTLR; two problems
Message-ID: <A8F615EE446C9B4D837FB67447C0D9970246CBF9@EXCHANGE3.campus.tue.nl>

Hello everyone,

 

I'm trying to get started with ANTLR but I'm having two slight problems.
I'm undoubtedly doing something wrong but I can't figure out what.

 

Let's start with the program code:

 

static void Main(string[] args)

{

    var input = new ANTLRStringStream("2*3=1+5");

    var lexer = new TestLexer(input);

    var tokens = new CommonTokenStream(lexer);

 

    var parser = new TestParser(tokens);

    var tree = parser.stat().Tree as CommonTree;

 

    Console.WriteLine(tree.ToStringTree());

 

    var val = parser.stat().val;

    Console.WriteLine(val);

}

 

Nothing too complex. First I create the tree and print it, then I print
the evaluated result.

 

The generated output:

(= (* 2 3) (+ 1 5))

line 0:-1 no viable alternative at input '<EOF>'

False

 

The tree generation and printing goes without a hitch, but the
evaluation gives an error message and the wrong result. Time for the
grammar code:

 

grammar Test;

 

options

{

 language = CSharp;

 output = AST;

}

 

// LEXER --------------------------------------

INT    :    '0'..'9'+ ;

PLUS    :    '+';

MINUS    :    '-';

TIMES    :    '*';

DIV    :    '/';

EQ    :    '=';

 

// PARSER--------------------------------------

stat returns [bool val]

    :    a=exprL3 EOF!

         { $val = $a.val; }

    ;

exprL3 returns [bool val]

    :    a=exprL2 EQ^ b=exprL2

         { $val = true; }

    ;

exprL2 returns [int result]

    :    a=exprL1

         (

          (TIMES^ b=exprL1)

          |

          (DIV^ b=exprL1)

         )*

    ;

 

exprL1 returns [int result]

    :    a=atom

         (

          (PLUS^ b=atom)

          |

          (MINUS^ b=atom)

         )*

    ;

atom returns [int result]

    :    a=INT

    |    '(' exprL2 ')'

    ;

 

Since I have defined stat as "exprL3 EOF!", which seems to be the common
method in the examples I could find, I don't quite understand why it's
complaining about the lack of a viable alternative.

As for the evaluation value: if I change stat to say "$val = true" it
indeed returns true. If however I defer this to exprL3 it doesn't work
anymore.

 

Can anyone tell me what I'm doing wrong?

Thanks in advance.

 

Regards,

                 R.A. Niemeijer

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/50cca34f/attachment.html 

From Jean-Claude.Durand at imag.fr  Thu Jul 24 06:47:55 2008
From: Jean-Claude.Durand at imag.fr (Jean-Claude Durand)
Date: Thu, 24 Jul 2008 15:47:55 +0200
Subject: [antlr-interest] NO MORE problem with composing grammars:
In-Reply-To: <200807241239.m6OCddQ2001012@harmonie.imag.fr>
References: <C21DAC30-38E1-4255-828D-24FFE39BC340@imag.fr>
	<200807241239.m6OCddQ2001012@harmonie.imag.fr>
Message-ID: <AD653A76-497D-4697-8169-CBC7D5583008@imag.fr>

Le 24 juil. 08 ? 13:56, Gavin Lambert a ?crit :

> importVocab

Just note that the antlr3 equivalent is 'tokenVocab'.

Thanks again,

Jean-Claude Durand

LIG, ?quipe GETALP
385, rue de la Biblioth?que
BP 53
38041 Grenoble cedex 9
F.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/fa33bd9e/attachment.html 

From Waverly.Edwards at genesys.com  Thu Jul 24 07:05:36 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Thu, 24 Jul 2008 10:05:36 -0400
Subject: [antlr-interest] Parsing Snippets of Code
In-Reply-To: <20080724122901.25900@gmx.net>
References: <20080724122901.25900@gmx.net>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1013607DE@navamane001.ad.internal.corp>


Let me start by saying, I don't know but...

I would think the surrounding information is needed in order to make a parse.
You would have to make assumptions based on context of the identifiers.  Basically, you would end
up with a best guess but not necessarily a verifiable parse.

I've desired to write a tool to translate snippets from one language to another.  It requires an
intimate knowledge of the source language and the tendencies of use.  If something like this does
exist using ANTLR I'd like to study it.  I've always found this type of tool fascinating.


W.
-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Dominik Raymann
Sent: Thursday, July 24, 2008 8:29 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Parsing Snippets of Code

Hi there,

it is possible to parse Snippets of Code for a known languagewith ANTLR? In the FAQ example (http://www.antlr.org/wiki/pages/viewpage.action?pageId=789) for example what would I have to do to actually parse the given input (that represents a Java method), if I don't know whether it is a method, a method body, a class, a variable declaration or what else. Is this possible with ANTLR?

Cheers,

raymi
--
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer

From namit.setia at lehman.com  Thu Jul 24 07:21:51 2008
From: namit.setia at lehman.com (Setia, Namit)
Date: Thu, 24 Jul 2008 10:21:51 -0400
Subject: [antlr-interest] Antlr missing getTree() method? C#
In-Reply-To: <20080723220106.304832F42E8@extrelay8.lehman.com>
References: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.leh.lbcorp.lehman.com>
	<20080723220106.304832F42E8@extrelay8.lehman.com>
Message-ID: <2F1B8FDE049F404B88F58578562FA77E0D66C64C@njpcmg1exms305.leh.lbcorp.lehman.com>

Thanks for the help.

Does anyone know of any good tutorials on how to build an AST with c#?
When I get the top level tree, it's children are the individual
characters of the string I passed in.  I'm not quite sure what the
approach should be to get it to parse into an AST (Maybe my
understanding is wrong, but I'm trying to get a tree like what you see
in the antlrworks interpreter).

I've been trying to find some good examples for the latest version of
antlr, but none of the csharp samples I could find work.

namit

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Wednesday, July 23, 2008 6:01 PM
To: Setia, Namit; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Antlr missing getTree() method? C#

At 08:28 24/07/2008, Setia, Namit wrote:
 >For some reason, I don't see any methods to extract the AST  >tree
from the parser (i.e., from the "qpar" variable).  I've  >seen in other
posts people calling qpar.getTree() or  >qpar.program().  Am I missing
something critical from my grammar?

You need to call the top-level rule in your parser.  Which in your case
appears to be 'qexprlist'.  So call qpar.qexprlist() and it'll either
return the tree directly or the tree will be one of the members of the
structure it returns.  (Things vary a little depending on target and
grammar structure, but it's not hard to work out.)

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

This message is intended only for the personal and confidential use of the designated recipient(s) named above.  If you are not the intended recipient of this message you are hereby notified that any review, dissemination, distribution or copying of this message is strictly prohibited.  This communication is for information purposes only and should not be regarded as an offer to sell or as a solicitation of an offer to buy any financial product, an official confirmation of any transaction, or as an official statement of Lehman Brothers.  Email transmission cannot be guaranteed to be secure or error-free.  Therefore, we do not represent that this information is complete or accurate and it should not be relied upon as such.  All information is subject to change without notice.

--------
IRS Circular 230 Disclosure:
Please be advised that any discussion of U.S. tax matters contained within this communication (including any attachments) is not intended or written to be used and cannot be used for the purpose of (i) avoiding U.S. tax related penalties or (ii) promoting, marketing or recommending to another party any transaction or matter addressed herein.

From raymi at gmx.ch  Thu Jul 24 07:31:16 2008
From: raymi at gmx.ch (Raymi)
Date: Thu, 24 Jul 2008 16:31:16 +0200
Subject: [antlr-interest] Parsing Snippets of Code
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1013607DE@navamane001.ad.internal.corp>
References: <20080724122901.25900@gmx.net>
	<FF993752CB890B4EB591BE5450C37BF1013607DE@navamane001.ad.internal.corp>
Message-ID: <48889234.9080306@gmx.ch>

Hi,

thanks for your reply. My intention is to build a kind of versatile 
syntax highlighing. It should be able to highlight code snippets as 
well. I am not very pleased with the syntax highlighting toolboxes that 
are available, either they are too restricted to some languages or to 
the output they generate (usually HTML). Usually they are also not able 
to properly format the output (e.g. indentation). I think that ANTLR 
could help me with this task.

Since performance is not really that important in this kind of 
application, probably one could just try a brute force approach and test 
all rules until one matches?

Greets,

Raymi

Edwards, Waverly schrieb:
> Let me start by saying, I don't know but...
> 
> I would think the surrounding information is needed in order to make a parse.
> You would have to make assumptions based on context of the identifiers.  Basically, you would end
> up with a best guess but not necessarily a verifiable parse.
> 
> I've desired to write a tool to translate snippets from one language to another.  It requires an
> intimate knowledge of the source language and the tendencies of use.  If something like this does
> exist using ANTLR I'd like to study it.  I've always found this type of tool fascinating.
> 
> 
> W.
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Dominik Raymann
> Sent: Thursday, July 24, 2008 8:29 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Parsing Snippets of Code
> 
> Hi there,
> 
> it is possible to parse Snippets of Code for a known languagewith ANTLR? In the FAQ example (http://www.antlr.org/wiki/pages/viewpage.action?pageId=789) for example what would I have to do to actually parse the given input (that represents a Java method), if I don't know whether it is a method, a method body, a class, a variable declaration or what else. Is this possible with ANTLR?
> 
> Cheers,
> 
> raymi
> --
> Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
> Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer
> 
> 

From tt.slot at mail.ru  Thu Jul 24 07:42:36 2008
From: tt.slot at mail.ru (Tom MacEllen)
Date: Thu, 24 Jul 2008 18:42:36 +0400
Subject: [antlr-interest]
	=?windows-1251?q?How_do_I_use_a_custom_token_obj?=
	=?windows-1251?q?ect=3F?=
In-Reply-To: <488765C4.2000604@gmx.de>
References: <488765C4.2000604@gmx.de>
Message-ID: <E1KM21c-000LtV-00.tt-slot-mail-ru@f89.mail.ru>

Hi Johannes,

thank you for your answer. I just tried what you suggested.
Unfortunately "INT.x" doesn't work.

I looked at the generated source code and found out that the variable(s) which are named after the rule-names are public final integers. 
So the expression "INT.x" results in an compiler error: "int cannot be dereferenced".

Tom

> > Is there a way to alter this value from the action in the grammar.
> > Something like:
> > ID : 'a'..'z'+  {/* set the integer x from here */};
> > INT : '0'..'9'+ {/* and here */};
> > 
> > I am just curious if that is possible?
> 
> Doesn't ID.x or INT.x work?
> 
> Johannes


From Fred.Brisard at ca.com  Thu Jul 24 10:33:46 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Thu, 24 Jul 2008 13:33:46 -0400
Subject: [antlr-interest] Token Mismatch
Message-ID: <7D50572C73BC634F92EE211BFF16F4A10641B7F4@USILMS12.ca.com>

I'm sure this is a novice question but I can't seem to find an answer
that I feel comfortable with.

It seems like any literal specified in the parser rules becomes an
implied token.

Using the basic example T.g -

grammar T;
/** Match things like "call foo;" */
r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
ID: 'a'..'z'+ ;
WS: (' '|'\n'|'\r')+ {$channel=HIDDEN;} ;

I get a MismatchedTokenException I run this in the ANTLRWorks debugger
for the input

call call;

I would like the second call to be identified as a token of type ID.

Any help is appreciated

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/a5871231/attachment.html 

From jaluber at gmx.de  Thu Jul 24 10:50:07 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 24 Jul 2008 19:50:07 +0200
Subject: [antlr-interest] ANTLR 3.0.1 -debug?
In-Reply-To: <20080724003548.223040@gmx.net>
References: <20080724003548.223040@gmx.net>
Message-ID: <4888C0CF.4070902@gmx.de>

Aurelian Melinte schrieb:
> Hello,
> 
> I am trying to have ANTLR generate a parser with debugging. When I try the -debug option, I get the output pasted below.  I am using a C target and the ANTLR 3.0.1 binaries from the source distribution kit.  
> 
> Please advise,
> a.
>  

It looks like as if the 3.0.1 C target doesn't support debugging. Try 
the newest beta of 3.1 instead.

Johannes
> 
> ANTLR Parser Generator  Version 3.0.1 (August 13, 2007)  1989-2007
> error(10):  internal error: group CDbg line 33: template outputFile has no region called imports 
> error(10):  internal error: group CDbg line 78: template genericParser has no region called superClassName 
> error(10):  internal error: group CDbg line 160: template dfaState has no region called noViableAltException 
> error(10):  internal error: group CDbg line 162: template dfaStateSwitch has no region called noViableAltException 
> ...
> Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
>  at java.util.LinkedList.<init>(Unknown Source)
>  at org.antlr.stringtemplate.StringTemplate.addEmbeddedInstance(StringTemplate.java:389)
>  at org.antlr.stringtemplate.StringTemplate.setEnclosingInstance(StringTemplate.java:383)
>  at org.antlr.stringtemplate.StringTemplateGroup.getEmbeddedInstanceOf(StringTemplateGroup.java:421)
>  at org.antlr.stringtemplate.language.ASTExpr.getTemplateInclude(ASTExpr.java:637)
>  at org.antlr.stringtemplate.language.ActionEvaluator.templateInclude(ActionEvaluator.java:465)
>  at org.antlr.stringtemplate.language.ActionEvaluator.expr(ActionEvaluator.java:137)
>  at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:79)
>  at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:152)
>  at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
>  at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:722)
>  at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:742)
>  at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:659)
>  at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:81)
>  at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:152)
>  at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
>  at org.antlr.codegen.CodeGenerator.write(CodeGenerator.java:1132)
>  at org.antlr.codegen.CTarget.genRecognizerHeaderFile(CTarget.java:63)
>  at org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:442)
>  at org.antlr.Tool.processGrammar(Tool.java:347)
>  at org.antlr.Tool.process(Tool.java:311)
>  at org.antlr.Tool.main(Tool.java:70)
> Could Not Find c:\Documents and Settings\amelinte\Desktop\newparser\CPP*.gif
> Build log was saved at "file://c:\Documents and Settings\amelinte\Desktop\newparser\Debug\BuildLog.htm"
> cppparser - 4 error(s), 0 warning(s)
> ========== Rebuild All: 0 succeeded, 1 failed, 0 skipped ==========
> 


From nelson.ana at gmail.com  Thu Jul 24 10:54:55 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Thu, 24 Jul 2008 18:54:55 +0100
Subject: [antlr-interest] Parsing Snippets of Code
In-Reply-To: <48889234.9080306@gmx.ch>
References: <20080724122901.25900@gmx.net>
	<FF993752CB890B4EB591BE5450C37BF1013607DE@navamane001.ad.internal.corp>
	<48889234.9080306@gmx.ch>
Message-ID: <a7d6d2740807241054g7a3a48b7ua777f797765c903b@mail.gmail.com>

Have you looked at Pygments? It's a flexible and powerful option. It has
support for several formats besides HTML and you can write your own
formatters as well as lexers for new languages. (It even highlights ANTLR)

Even if you decide Pygments isn't for you, looking at the (python) source
code would give you a very good idea of what's involved with writing your
own syntax highlighter and you could then implement this in ANTLR. Looking
at one of the lexer files for a language you are familiar with will give you
an idea of what sort of parsing granularity is required for good, robust
syntax highlighting.




2008/7/24 Raymi <raymi at gmx.ch>:

> Hi,
>
> thanks for your reply. My intention is to build a kind of versatile syntax
> highlighing. It should be able to highlight code snippets as well. I am not
> very pleased with the syntax highlighting toolboxes that are available,
> either they are too restricted to some languages or to the output they
> generate (usually HTML). Usually they are also not able to properly format
> the output (e.g. indentation). I think that ANTLR could help me with this
> task.
>
> Since performance is not really that important in this kind of application,
> probably one could just try a brute force approach and test all rules until
> one matches?
>
> Greets,
>
> Raymi
>
> Edwards, Waverly schrieb:
>
>  Let me start by saying, I don't know but...
>>
>> I would think the surrounding information is needed in order to make a
>> parse.
>> You would have to make assumptions based on context of the identifiers.
>>  Basically, you would end
>> up with a best guess but not necessarily a verifiable parse.
>>
>> I've desired to write a tool to translate snippets from one language to
>> another.  It requires an
>> intimate knowledge of the source language and the tendencies of use.  If
>> something like this does
>> exist using ANTLR I'd like to study it.  I've always found this type of
>> tool fascinating.
>>
>>
>> W.
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] On Behalf Of Dominik Raymann
>> Sent: Thursday, July 24, 2008 8:29 AM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Parsing Snippets of Code
>>
>> Hi there,
>>
>> it is possible to parse Snippets of Code for a known languagewith ANTLR?
>> In the FAQ example (
>> http://www.antlr.org/wiki/pages/viewpage.action?pageId=789) for example
>> what would I have to do to actually parse the given input (that represents a
>> Java method), if I don't know whether it is a method, a method body, a
>> class, a variable declaration or what else. Is this possible with ANTLR?
>>
>> Cheers,
>>
>> raymi
>> --
>> Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! Ideal
>> f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer
>>
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/cb445861/attachment.html 

From jaluber at gmx.de  Thu Jul 24 11:23:56 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 24 Jul 2008 20:23:56 +0200
Subject: [antlr-interest] How do I use a custom token object?
In-Reply-To: <E1KM21c-000LtV-00.tt-slot-mail-ru@f89.mail.ru>
References: <488765C4.2000604@gmx.de>
	<E1KM21c-000LtV-00.tt-slot-mail-ru@f89.mail.ru>
Message-ID: <4888C8BC.1080300@gmx.de>

Tom MacEllen schrieb:
> Hi Johannes,
> 
> thank you for your answer. I just tried what you suggested.
> Unfortunately "INT.x" doesn't work.
> 
> I looked at the generated source code and found out that the variable(s) which are named after the rule-names are public final integers. 
> So the expression "INT.x" results in an compiler error: "int cannot be dereferenced".
> 
> Tom

Then you could try to add a member variable which you set in the action 
and refer in Emit():

@members{
int x;

public override Emit() {
     return new MyToken(x);
}
}

ID : 'a'..'z'+ {this.x = 2; }

You may have to change the source code a bit to get it working.

Johannes
> 
>>> Is there a way to alter this value from the action in the grammar.
>>> Something like:
>>> ID : 'a'..'z'+  {/* set the integer x from here */};
>>> INT : '0'..'9'+ {/* and here */};
>>>
>>> I am just curious if that is possible?
>> Doesn't ID.x or INT.x work?
>>
>> Johannes
> 


From kroizguy at gmail.com  Thu Jul 24 12:35:53 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Thu, 24 Jul 2008 22:35:53 +0300
Subject: [antlr-interest] recognizing a function
Message-ID: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>

Howdy,
I have written a grammar that I hoped would find a function definition in a
Fortran file.
Running it produces nothing. s-:

I played with it a lot and debugged it with jdb and ANTLRWorks but to avail.
I wonder if anybody would be so kind to point me to the problem with the
grammar.

grammar fun;
>
> root     :
>     (functionStatement)*
>     ;
>
> functionStatement :
>     (type)?    FUNCTION NAME '(' (namelist)? ')'
>     {
>     System.out.println( "func: " + $NAME.text );
>     };
>
>
> namelist:
>     identifier ( ',' identifier )* ;
>
> identifier :
>     NAME
>     ;
>
> type :
>     (
>     ('r'|'R')('e'|'E')('a'|'A')('l'|'L') |
>      ('c'|'C')('o'|'O')('m'|'M')('p'|'P')('l'|'L')('e'|'E')('x'|'X')|
>      ('D'|'d')('O'|'o')('U'|'u')('B'|'b')('L'|'l')('E'|'e')
> ('C'|'c')('O'|'o')('M'|'m')('P'|'p')('L'|'l')('E'|'e')('X'|'x') |
>      ('D'|'d')('O'|'o')('U'|'u')('B'|'b')('L'|'l')('E'|'e')
> ('P'|'p')('R'|'r')('E'|'e')('C'|'c')('I'|'i')('S'|'s')('I'|'i')('O'|'o')('N'|'n')
> |
>      ('i'|'I')('N'|'n')('T'|'t')('E'|'e')('G'|'g')('E'|'e')('R'|'r') |
>      ('L'|'l')('O'|'o')('G'|'g')('I'|'i')('C'|'c')('A'|'a')('L'|'l')
>     )
>     ;
>
> FUNCTION:
> ('f'|'F')('u'|'U')('n'|'N')('c'|'C')('t'|'T')('i'|'I')('o'|'O')('n'|'N');
>
> WHITE: (' ' | '\t' | '\n' | '\r')+ {skip();} ;
>
> // identifier (keyword or variable)
> NAME  :   ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'0'..'9')*
>     ;
>
> ANY    :    . ;
>


I have tested it with the following input:

      PROGRAM TSTFAC
>
>       INTEGER N
>       REAL FAC
>
>  10   WRITE(*,*) 'ENTER THE VALUE N (CNTRL-C TO END):'
>       READ(*,*) N
>
>       IF (N .GE. 0) THEN
>          WRITE(*,*) N, '! = ',FAC(N)
>          GOTO 10
>       ELSE
>          WRITE(*,*) 'INVALID VALUE FOR N.'
>          GOTO 10
>       ENDIF
>
>       STOP
>       END
>
>       REAL FUNCTION FAC(N)
>       INTEGER N
>       N = 7
>       RETURN
>       END
>

with the following test rig:

import org.antlr.runtime.*;
> import java.io.*;
>
> public class Test {
>     public static void main(String[] args) throws Exception {
>         try{
>             FileInputStream f = new FileInputStream( "tstfac.f" );
>             ANTLRInputStream input = new ANTLRInputStream( f );
>             funLexer lexer = new funLexer(input);
>             CommonTokenStream tokens = new CommonTokenStream(lexer);
>             funParser parser = new funParser(tokens);
>             parser.root();
>         }
>         catch(FileNotFoundException e)
>         {
>             System.out.println("file not found");
>         }
>
>     }
> }
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/adece0bd/attachment.html 

From antlr at jazillian.com  Thu Jul 24 13:18:51 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Thu, 24 Jul 2008 16:18:51 -0400
Subject: [antlr-interest] AST rewrite "requirements"
Message-ID: <4888E3AB.20806@jazillian.com>

AST-rewrite fans,

As Terence and Leon Su are working on a new term-rewriting system, I'd
like to approach the same problem from the other end. I want to define
what features I think are needed for a term-rewrite system to be
useful for certain translation projects. By "certain", I mean 
translators that do things like C-to-Java, C++-to-Java, and COBOL-to-Java.

So I've started by taking one of my current "translation rules", and
writing down pseudocode (actually, fairly reasonable Java code) that
does what needs to be done. If people find this useful, then I'll repeat this
for the many other "rules".

Each "rule" modifies an AST in some way.
The "rule" that I chose modifies a C++/Java AST to change the
 access modifiers ("public", "private", "protected") from being "C++ - like"
to "Java like". For example, this C++ code... 

class C {
    int a;
    public:
        int b;
        int c;
    private:
        int d;
}

...might produce a "C++-ish" AST that looks like this...

CLASS_SPECIFIER "C"
    DECL
        TYPE
            LITERAL_int 
        NAME
            ID "a"
    DECL 
        MODIFIERS
            LITERAL_public 
        TYPE
            LITERAL_int 
        NAME
            ID "b"
    DECL 
        TYPE
            LITERAL_int 
        NAME
            ID "c"
    DECL 
        MODIFIERS
            LITERAL_private 
        TYPE
            LITERAL_int 
        NAME
            ID "d"

...and we want to transform that AST to this "Java-ish" AST...

CLASS_SPECIFIER "C"
    DECL
        MODIFIERS
            LITERAL_private
        TYPE 
            LITERAL_int 
        NAME
            ID "a"
    DECL 
        MODIFIERS
            LITERAL_public 
        TYPE
            LITERAL_int 
        NAME
            ID "b"
    DECL 
        MODIFIERS
            LITERAL_public 
        TYPE
            LITERAL_int 
        NAME
            ID "c"
    DECL 
        MODIFIERS
            LITERAL_private 
        TYPE
            LITERAL_int 
        NAME
            ID "d"

...which will produce this Java code...
class C {
    private int a;
    public int b;
    public int c;
    private int d;
}


I won't cover the "big picture" here, all I want to do is to
outline what logic is needed to make the AST transformation that
we see above.

So here is some rough Java code that would do what needs to be done:

    private final static List<Integer> ALL_C_MODIFIERS = ASTFactory.createList(
        LITERAL_private, LITERAL_public, LITERAL_protected);
 
    AST currentModifier = ASTFactory.create(LITERAL_private);

    // Loop through each of the CLASS_SPECIFIER ASTs, checking
    // each of its children to see if it has any access modifier
    // ("public", "private", or "protected").
    for (AST classSpecifier: root.getASTs(CLASS_SPECIFIER)) {
        // If there is any "friend" keyword in this class, we'll need
        // to just make everything "public".
        boolean hasFriend = classSpecifier.contains(LITERAL_friend);
        if (hasFriend) {
            currentModifier = ASTFactory.create(LITERAL_public);
        }
        for (AST child: classSpecifier.getChildren()) {
            AST foundModifier = child.findAny(ALL_C_MODIFIERS);
            if (foundModifier != AST.NOT_FOUND) {
                // Once we've found an access modifier, that's the one
                // we'll use until we find another (unless we have a friend,
                // in which case leave it "public".
                if (!hasFriend) {
                    currentModifier = foundModifier;
                }
            } else {
                // This child does not yet have an access modifier,
                // as required by Java. Insert a COPY of the last modifier 
                // that we encountered, as the first child
                child.insert(0, currentModifier);
            }
        }
    }

>From that code, we see the following features being used:    
    ASTFactory class:
        create() static method that creates a single AST
    
    AST class:
        getASTs() method which gets a List of ancestor ASTs of the given type
        contains() method which returns true iff there is any ancestor AST of the given type
        getChildren() method returns the direct children of the AST
        findAny() method returns any one ancestor AST that has one of the given types
        NOT_FOUND final static AST flag that indicates no AST was found 
        insert() method that inserts a copy of the given AST as a child.
      
Obviously, I haven't shown a "real term-rewrite system", I've just shown some
Java code with an AST class that has some reasonable tree-data-structure functionality.
For any term-rewrite-system to be useful to me, it's got to be easier to
develop and maintain that what I show here. I'm doubtful that that can be done,
but I'd love to be proven wrong.

My point here is not to start a long "Which is better for AST transformation:
a DSL or plain Java code?" debate (although I'd be happy to have that
debate, too). Instead, what I want to know is:
Is it worth my time to write up perhaps a couple hundred more examples of
this sort of Java code that does tree transformations? Would you guys 
who are buildinga currently-unnamed-rewrite-system actually be willing 
to go through such "requirements" and make sure your system provides 
that functionality?

The reason I ask is that a long time ago when I did look into the various tools 
(SF+SDF, Stratego, TXL, and later Tom), it seemed to me that they got to
be a real mess to do anything non-trivial. Maybe I'm wrong, but I think
if you implemented the same logic shown above in any of these systems,
it would be harder to write and maintain than the "vanilla Java" shown above.

Andy

From aheller at gmx.at  Thu Jul 24 13:22:01 2008
From: aheller at gmx.at (Arnulf Heller)
Date: Thu, 24 Jul 2008 22:22:01 +0200
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <200807231004.20200.rschulz@sonic.net>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
Message-ID: <20080724202204.YUFP20560.viefep18-int.chello.at@edge04.upc.biz>


>
>An important factor to consider about naming projects in this age is how
>it interacts with today's dumb but far-reaching Web indexers.
>Specifically, using an real word, let alone a common one, can make it
>very hard for people to find you. If you really want to use a real
>English word, it's advisable to create a variant spelling.
>
>ANTLR works very well in this regard, since it's not even an English
>word.
>
> From this perspective, "Brian" would be a singularly bad choice.

Well, then call it "Prian" :-)
[another monty python insider]

ok, I will hush now

@Ger: Brilliant posting :-) 


From Fred.Brisard at ca.com  Thu Jul 24 13:28:18 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Thu, 24 Jul 2008 16:28:18 -0400
Subject: [antlr-interest] Token Mismatch
In-Reply-To: <36c8729e0807241302l29adb369rdb064e129e733f2b@mail.gmail.com>
References: <7D50572C73BC634F92EE211BFF16F4A10641B7F4@USILMS12.ca.com>
	<36c8729e0807241302l29adb369rdb064e129e733f2b@mail.gmail.com>
Message-ID: <7D50572C73BC634F92EE211BFF16F4A10641B92A@USILMS12.ca.com>

Thanks Matt,

 

I better go reread that section.  

 

Fred Brisard 



________________________________

From: Matt Palmer [mailto:mattpalms at gmail.com] 
Sent: Thursday, July 24, 2008 4:02 PM
To: Brisard, Fred D
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Token Mismatch

 

Hi Fred,

I am also a novice, but I have a copy of the antlr reference to hand,
and this situation is mentioned.  The suggestion is to use semantic
predicates to resolve whether the rule is an ID or a keyword.

e.g.

r : keyCALL ID ';' {System.out.println("invoke "+$ID.text);} ;

keyCALL : {input.LT(1).getText().equals("call")}? ID ;

ID: 'a'..'z'+ ;

WS: (' '|'\n'|'\r')+ {$channel=HIDDEN;} ;


The idea is that the keyCALL rule is also just an ID token (so both
match as IDs), but with a semantic predicate that only matches if the
text is explicitly "call".  Note: I haven't tested this grammar - I just
modified the example in the book to match your example.

Regards,

Matt Palmer.

On Thu, Jul 24, 2008 at 6:33 PM, Brisard, Fred D <Fred.Brisard at ca.com>
wrote:

I'm sure this is a novice question but I can't seem to find an answer
that I feel comfortable with.

It seems like any literal specified in the parser rules becomes an
implied token.

Using the basic example T.g -

grammar T;

/** Match things like "call foo;" */

r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;

ID: 'a'..'z'+ ;

WS: (' '|'\n'|'\r')+ {$channel=HIDDEN;} ;

I get a MismatchedTokenException I run this in the ANTLRWorks debugger
for the input

call call;

I would like the second call to be identified as a token of type ID.

Any help is appreciated

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/f59d0e31/attachment-0001.html 

From nelson.ana at gmail.com  Thu Jul 24 13:30:19 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Thu, 24 Jul 2008 21:30:19 +0100
Subject: [antlr-interest] we need a name for a new rewriting tool
In-Reply-To: <20080724202204.YUFP20560.viefep18-int.chello.at@edge04.upc.biz>
References: <ECE20B0C-3AFE-4603-BE73-87CE794DF3BA@cs.usfca.edu>
	<561cc61d0807221916lec695dfk5b9b553c1f62422c@mail.gmail.com>
	<D47B34DE-422C-49D6-A70A-1CF550AEE2DD@cs.usfca.edu>
	<200807231004.20200.rschulz@sonic.net>
	<20080724202204.YUFP20560.viefep18-int.chello.at@edge04.upc.biz>
Message-ID: <84D125FC-3E5F-4630-8C1C-8CA4FD8AC0B9@gmail.com>

or "Bwian" :-)

I think this is less of a problem for open source software projects  
which tend to have very high relative search engine rankings even with  
common word names.



On 24 Jul 2008, at 21:22, Arnulf Heller wrote:

>
>>
>> An important factor to consider about naming projects in this age  
>> is how
>> it interacts with today's dumb but far-reaching Web indexers.
>> Specifically, using an real word, let alone a common one, can make it
>> very hard for people to find you. If you really want to use a real
>> English word, it's advisable to create a variant spelling.
>>
>> ANTLR works very well in this regard, since it's not even an English
>> word.
>>
>> From this perspective, "Brian" would be a singularly bad choice.
>
> Well, then call it "Prian" :-)
> [another monty python insider]
>
> ok, I will hush now
>
> @Ger: Brilliant posting :-)


From raymi at gmx.ch  Thu Jul 24 13:45:02 2008
From: raymi at gmx.ch (Raymi)
Date: Thu, 24 Jul 2008 22:45:02 +0200
Subject: [antlr-interest] Parsing Snippets of Code
In-Reply-To: <a7d6d2740807241054g7a3a48b7ua777f797765c903b@mail.gmail.com>
References: <20080724122901.25900@gmx.net>	<FF993752CB890B4EB591BE5450C37BF1013607DE@navamane001.ad.internal.corp>	<48889234.9080306@gmx.ch>
	<a7d6d2740807241054g7a3a48b7ua777f797765c903b@mail.gmail.com>
Message-ID: <4888E9CE.5060904@gmx.ch>

Hi Ana,

thank you for the hint with Pygments. Looks really promising. I'll 
certainly give it a try. And: wow, looks like you get your answers quite 
fast in this mailing list! I really appreciate all your help.

Nevertheless it still interests me whether it is possible to parse 
codesnippets with ANTLR.

Thanks again,

raymi

Ana Nelson schrieb:
> Have you looked at Pygments? It's a flexible and powerful option. It 
> has support for several formats besides HTML and you can write your 
> own formatters as well as lexers for new languages. (It even 
> highlights ANTLR)
>
> Even if you decide Pygments isn't for you, looking at the (python) 
> source code would give you a very good idea of what's involved with 
> writing your own syntax highlighter and you could then implement this 
> in ANTLR. Looking at one of the lexer files for a language you are 
> familiar with will give you an idea of what sort of parsing 
> granularity is required for good, robust syntax highlighting.
>
>
>
>
> 2008/7/24 Raymi <raymi at gmx.ch>:
>
>     Hi,
>
>     thanks for your reply. My intention is to build a kind of
>     versatile syntax highlighing. It should be able to highlight code
>     snippets as well. I am not very pleased with the syntax
>     highlighting toolboxes that are available, either they are too
>     restricted to some languages or to the output they generate
>     (usually HTML). Usually they are also not able to properly format
>     the output (e.g. indentation). I think that ANTLR could help me
>     with this task.
>
>     Since performance is not really that important in this kind of
>     application, probably one could just try a brute force approach
>     and test all rules until one matches?
>
>     Greets,
>
>     Raymi
>
>     Edwards, Waverly schrieb:
>
>         Let me start by saying, I don't know but...
>
>         I would think the surrounding information is needed in order
>         to make a parse.
>         You would have to make assumptions based on context of the
>         identifiers.  Basically, you would end
>         up with a best guess but not necessarily a verifiable parse.
>
>         I've desired to write a tool to translate snippets from one
>         language to another.  It requires an
>         intimate knowledge of the source language and the tendencies
>         of use.  If something like this does
>         exist using ANTLR I'd like to study it.  I've always found
>         this type of tool fascinating.
>
>
>         W.
>         -----Original Message-----
>         From: antlr-interest-bounces at antlr.org
>         <mailto:antlr-interest-bounces at antlr.org>
>         [mailto:antlr-interest-bounces at antlr.org
>         <mailto:antlr-interest-bounces at antlr.org>] On Behalf Of
>         Dominik Raymann
>         Sent: Thursday, July 24, 2008 8:29 AM
>         To: antlr-interest at antlr.org <mailto:antlr-interest at antlr.org>
>         Subject: [antlr-interest] Parsing Snippets of Code
>
>         Hi there,
>
>         it is possible to parse Snippets of Code for a known
>         languagewith ANTLR? In the FAQ example
>         (http://www.antlr.org/wiki/pages/viewpage.action?pageId=789)
>         for example what would I have to do to actually parse the
>         given input (that represents a Java method), if I don't know
>         whether it is a method, a method body, a class, a variable
>         declaration or what else. Is this possible with ANTLR?
>
>         Cheers,
>
>         raymi
>         --
>         Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu
>         sparen! Ideal f?r Modem und ISDN:
>         http://www.gmx.net/de/go/smartsurfer
>
>
>


From namit.setia at lehman.com  Thu Jul 24 13:57:04 2008
From: namit.setia at lehman.com (Setia, Namit)
Date: Thu, 24 Jul 2008 16:57:04 -0400
Subject: [antlr-interest] Building an AST Tree?
Message-ID: <2F1B8FDE049F404B88F58578562FA77E0D66C64F@njpcmg1exms305.leh.lbcorp.lehman.com>

Thanks for the help.

Does anyone know of any good tutorials/examples on how to build an AST
with c#?  When I get the top level tree, it's children are the
individual characters of the string I passed in.  I'm not quite sure
what the approach should be to get it to parse into an AST (Maybe my
understanding is wrong, but I'm trying to get a tree like what you see
in the antlrworks interpreter).

I've been trying to find some good examples for the latest version of
antlr, but none of the csharp samples I could find work.

Antlr.Runtime.ICharStream str = new
Antlr.Runtime.ANTLRStringStream("ap=function(\"hello\",4,5);");
qss_grammarLexer qlex = new qss_grammarLexer(str);
Antlr.Runtime.CommonTokenStream tokens = new
Antlr.Runtime.CommonTokenStream(qlex);
qss_grammarParser grammar = new qss_grammarParser(tokens);
qss_grammarParser.qexprlist_return ret = grammar.qexprlist();
CommonTree t = (CommonTree)ret.Tree;

--> t.Children is an array  of tokens [ {a},{p},{=},{f},{u},{n}....]  

------------------------------------------------------------------------
---

grammar qss_grammar;

options
{
	language=CSharp2;
	output=AST;
}

qexprlist
  : ( qassignment_statement )* EOF
  ;

qassignment_statement
  : qassignment SEMI { Console.Write("hello"); }
  ;

qassignment
  : (qname ASSIGN )? qexpr
  ;

qprimary_expr
  : qint
  | qvname
  | (LPAREN qexpr RPAREN ) 
  | qfunction
  | qarray
  | qstring
  ;

qsign_expr
  : qprimary_expr
  ;

qmul_expr
  : qsign_expr (( MUL | DIV | MOD ) qsign_expr)*
  ;
  
qexpr
  	:	 qmul_expr (( PLUS | MINUS ) qmul_expr)*
  ;



PLUS	:	'+';
MINUS	:	'-';
DIV	:	'/';
MUL	:	'*';
MOD	:	'%';
POW	:	'^';
LETTER	:	'a'..'z'|'A'..'Z';
DIGIT	:	'0'..'9';
PER	:	'.';
SEMI	:	';';
ASSIGN	:	'=';
EQ	:	'=''=';
NQ	:	'!''=';
LEQ	:	'<''=';
GEQ	:	'>''=';
LPAREN	:	'(';
RPAREN	:	')';

qint	:	(DIGIT)*;
qname	:	LETTER(LETTER|DIGIT)*;
qstr	:	(LETTER|DIGIT)*;
qstring	:	'"' (LETTER|DIGIT)* '"';
qinputval:	(LETTER|DIGIT)*;
qvname	:	(LETTER(LETTER|DIGIT)*)(':'qinputval('.'qinputval)*)?;
qarray	:	'{' (qstring|qvname)(','(qstring|qvname))* '}';
qfunction:	(LETTER(LETTER|DIGIT)*)'('
qprimary_expr(','qprimary_expr)* ')';


- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

This message is intended only for the personal and confidential use of the designated recipient(s) named above.  If you are not the intended recipient of this message you are hereby notified that any review, dissemination, distribution or copying of this message is strictly prohibited.  This communication is for information purposes only and should not be regarded as an offer to sell or as a solicitation of an offer to buy any financial product, an official confirmation of any transaction, or as an official statement of Lehman Brothers.  Email transmission cannot be guaranteed to be secure or error-free.  Therefore, we do not represent that this information is complete or accurate and it should not be relied upon as such.  All information is subject to change without notice.

--------
IRS Circular 230 Disclosure:
Please be advised that any discussion of U.S. tax matters contained within this communication (including any attachments) is not intended or written to be used and cannot be used for the purpose of (i) avoiding U.S. tax related penalties or (ii) promoting, marketing or recommending to another party any transaction or matter addressed herein.

From jaluber at gmx.de  Thu Jul 24 14:10:46 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 24 Jul 2008 23:10:46 +0200
Subject: [antlr-interest] Building an AST Tree?
In-Reply-To: <2F1B8FDE049F404B88F58578562FA77E0D66C64F@njpcmg1exms305.leh.lbcorp.lehman.com>
References: <2F1B8FDE049F404B88F58578562FA77E0D66C64F@njpcmg1exms305.leh.lbcorp.lehman.com>
Message-ID: <4888EFD6.2080900@gmx.de>

Setia, Namit schrieb:
> Thanks for the help.
> 
> Does anyone know of any good tutorials/examples on how to build an AST
> with c#?  When I get the top level tree, it's children are the
> individual characters of the string I passed in.  I'm not quite sure
> what the approach should be to get it to parse into an AST (Maybe my
> understanding is wrong, but I'm trying to get a tree like what you see
> in the antlrworks interpreter).
> 
> I've been trying to find some good examples for the latest version of
> antlr, but none of the csharp samples I could find work.
> 
> Antlr.Runtime.ICharStream str = new
> Antlr.Runtime.ANTLRStringStream("ap=function(\"hello\",4,5);");
> qss_grammarLexer qlex = new qss_grammarLexer(str);
> Antlr.Runtime.CommonTokenStream tokens = new
> Antlr.Runtime.CommonTokenStream(qlex);
> qss_grammarParser grammar = new qss_grammarParser(tokens);
> qss_grammarParser.qexprlist_return ret = grammar.qexprlist();
> CommonTree t = (CommonTree)ret.Tree;
> 
> --> t.Children is an array  of tokens [ {a},{p},{=},{f},{u},{n}....]  

Actually, your grammar below works as expected. You haven't put any 
rewrite rules into the grammar so get always a flat list. I annotate a 
few rules as examples. Those new all uppercase symbols are imaginary 
tokens defined in the tokens section.

tokens {
QEXPR_LIST;
etc.
}

Johannes
> 
> ------------------------------------------------------------------------
> ---
> 
> grammar qss_grammar;
> 
> options
> {
> 	language=CSharp2;
> 	output=AST;
> }
> 
> qexprlist
>   : ( qassignment_statement )* EOF
>   ;
qexprlist
   : ( qassignment_statement )* EOF -> ^(QEXPR_LIST qassignment_statement)
   ;

> 
> qassignment_statement
>   : qassignment SEMI { Console.Write("hello"); }
>   ;

qassignment_statement
   : qassignment SEMI { Console.Write("hello"); } -> qassignment
   ;

> 
> qassignment
>   : (qname ASSIGN )? qexpr
>   ;
qassignment
   : (qname ASSIGN )? qexpr -> ^(QASSIGNMENT ^(OPTIONAL (qname ASSIGN)?) 
qexpr)
   ;
> 
> qprimary_expr
>   : qint
>   | qvname
>   | (LPAREN qexpr RPAREN ) 
>   | qfunction
>   | qarray
>   | qstring
>   ;
> 
> qsign_expr
>   : qprimary_expr
>   ;
> 
> qmul_expr
>   : qsign_expr (( MUL | DIV | MOD ) qsign_expr)*
>   ;
>   
> qexpr
>   	:	 qmul_expr (( PLUS | MINUS ) qmul_expr)*
>   ;
> 
> 
> 
> PLUS	:	'+';
> MINUS	:	'-';
> DIV	:	'/';
> MUL	:	'*';
> MOD	:	'%';
> POW	:	'^';
> LETTER	:	'a'..'z'|'A'..'Z';
> DIGIT	:	'0'..'9';
> PER	:	'.';
> SEMI	:	';';
> ASSIGN	:	'=';
> EQ	:	'=''=';
> NQ	:	'!''=';
> LEQ	:	'<''=';
> GEQ	:	'>''=';
> LPAREN	:	'(';
> RPAREN	:	')';
> 
> qint	:	(DIGIT)*;
> qname	:	LETTER(LETTER|DIGIT)*;
> qstr	:	(LETTER|DIGIT)*;
> qstring	:	'"' (LETTER|DIGIT)* '"';
> qinputval:	(LETTER|DIGIT)*;
> qvname	:	(LETTER(LETTER|DIGIT)*)(':'qinputval('.'qinputval)*)?;
> qarray	:	'{' (qstring|qvname)(','(qstring|qvname))* '}';
> qfunction:	(LETTER(LETTER|DIGIT)*)'('
> qprimary_expr(','qprimary_expr)* ')';
> 
> 
> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> 
> This message is intended only for the personal and confidential use of the designated recipient(s) named above.  If you are not the intended recipient of this message you are hereby notified that any review, dissemination, distribution or copying of this message is strictly prohibited.  This communication is for information purposes only and should not be regarded as an offer to sell or as a solicitation of an offer to buy any financial product, an official confirmation of any transaction, or as an official statement of Lehman Brothers.  Email transmission cannot be guaranteed to be secure or error-free.  Therefore, we do not represent that this information is complete or accurate and it should not be relied upon as such.  All information is subject to change without notice.
> 
> --------
> IRS Circular 230 Disclosure:
> Please be advised that any discussion of U.S. tax matters contained within this communication (including any attachments) is not intended or written to be used and cannot be used for the purpose of (i) avoiding U.S. tax related penalties or (ii) promoting, marketing or recommending to another party any transaction or matter addressed herein.
> 


From antlr at mirality.co.nz  Thu Jul 24 14:40:30 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 25 Jul 2008 09:40:30 +1200
Subject: [antlr-interest] Antlr missing getTree() method? C#
In-Reply-To: <2F1B8FDE049F404B88F58578562FA77E0D66C64C@njpcmg1exms305.le
	h.lbcorp.lehman.com>
References: <2F1B8FDE049F404B88F58578562FA77E0D66C649@njpcmg1exms305.leh.lbcorp.lehman.com>
	<20080723220106.304832F42E8@extrelay8.lehman.com>
	<2F1B8FDE049F404B88F58578562FA77E0D66C64C@njpcmg1exms305.leh.lbcorp.lehman.com>
Message-ID: <20080724214039.258B211EDDF@www.antlr.org>

At 02:21 25/07/2008, Setia, Namit wrote:
 >Does anyone know of any good tutorials on how to build an AST 
with
 >c#?

It's not really any different than building an AST for any other 
target language.  There are several examples in the examples 
download, and no doubt there are several in the ANTLR book as well 
(I don't have it myself, so I can't confirm that though).

 >When I get the top level tree, it's children are the individual
 >characters of the string I passed in.  I'm not quite sure what 
the
 >approach should be to get it to parse into an AST (Maybe my
 >understanding is wrong, but I'm trying to get a tree like what 
you
 >see in the antlrworks interpreter).

An ANTLR AST is always composed of tokens.  If you are getting 
individual characters, it can only be because your lexer is 
generating individual tokens for characters and not generating 
"full" tokens.


From antlr at mirality.co.nz  Thu Jul 24 14:44:01 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 25 Jul 2008 09:44:01 +1200
Subject: [antlr-interest] How do I use a custom token obj ect?
In-Reply-To: <E1KM21c-000LtV-00.tt-slot-mail-ru@f89.mail.ru>
References: <488765C4.2000604@gmx.de>
	<E1KM21c-000LtV-00.tt-slot-mail-ru@f89.mail.ru>
Message-ID: <20080724214408.39E8111EDEC@www.antlr.org>

At 02:42 25/07/2008, Tom MacEllen wrote:
 >thank you for your answer. I just tried what you suggested.
 >Unfortunately "INT.x" doesn't work.

Try $INT.x.  Or assign it a label (eg. 'a=INT') and use $a.x.

Also have a look at scopes.  Note though that you cannot pass 
additional information this way between lexer and parser (unless 
you create a custom token type, or use the additional data fields 
built into the C runtime's token); only between rules in the same 
recogniser.


From nelson.ana at gmail.com  Thu Jul 24 14:51:33 2008
From: nelson.ana at gmail.com (Ana Nelson)
Date: Thu, 24 Jul 2008 22:51:33 +0100
Subject: [antlr-interest] recognizing a function
In-Reply-To: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>
References: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>
Message-ID: <a7d6d2740807241451q6bb8743an86a43faddb42ac0a@mail.gmail.com>

Guy,

I have looked at your grammar and have a few suggestions, but in general I
think you are making a very common mistake (which I myself have made many
times) which is to try to write a complete grammar from scratch. I've been
using ANTLR for about a year now, and I have learned (the hard way) to start
my grammars very simply with just 1 or 2 rules and build them up from there,
with the help of a good testing framework (such as gUnit). In this case, I
would first write a grammar which just matches "FUNCTION" then extend it to
match "FUNCTION FAC" then "REAL FUNCTION FAC" then "REAL FUNCTION FAC(N)"
etc. It's just so easy and painless to build grammars up from very small
pieces which you understand and so frustrating and painful to do it the
other way around. :-)

Now, to get your grammar working, try these 2 things:
1) change your input text file to JUST have the text REAL FUNCTION FAC(N)
2) change your rule "type" into a token "TYPE"

If you do this, your code should work as you expect.

However, the main problem with your grammar is that it's not able to parse
anything that doesn't look like REAL FUNCTION FAC(N), so if you try to parse
your full example text, it's never going to get past "PROGRAM TSTFAC" since
this doesn't match the functionStatement rule.

If you are only interested in fetching function names and want to ignore
everything else, then you probably want something like...

root
  : statement+
  ;

statement
  : functionStatement NEWLINE
  | otherStatement NEWLINE
  ;

I'm implying here that you should have a separate NEWLINE token, and take
newline characters out of your WHITE token since you probably want a
line-based parser (for now anyway). Also you'll have to figure out what
should go in otherStatement (or whatever you want to call it)

Hope this makes sense. There is a full FORTRAN grammar on the ANTLR website
which you might also want to look at.

Regards,
Ana Nelson
--
http://ananelson.com



2008/7/24 Guy Kroizman <kroizguy at gmail.com>:

> Howdy,
> I have written a grammar that I hoped would find a function definition in a
> Fortran file.
> Running it produces nothing. s-:
>
> I played with it a lot and debugged it with jdb and ANTLRWorks but to
> avail.
> I wonder if anybody would be so kind to point me to the problem with the
> grammar.
>
> grammar fun;
>>
>> root     :
>>     (functionStatement)*
>>     ;
>>
>> functionStatement :
>>     (type)?    FUNCTION NAME '(' (namelist)? ')'
>>     {
>>     System.out.println( "func: " + $NAME.text );
>>     };
>>
>>
>> namelist:
>>     identifier ( ',' identifier )* ;
>>
>> identifier :
>>     NAME
>>     ;
>>
>> type :
>>     (
>>     ('r'|'R')('e'|'E')('a'|'A')('l'|'L') |
>>      ('c'|'C')('o'|'O')('m'|'M')('p'|'P')('l'|'L')('e'|'E')('x'|'X')|
>>      ('D'|'d')('O'|'o')('U'|'u')('B'|'b')('L'|'l')('E'|'e')
>> ('C'|'c')('O'|'o')('M'|'m')('P'|'p')('L'|'l')('E'|'e')('X'|'x') |
>>      ('D'|'d')('O'|'o')('U'|'u')('B'|'b')('L'|'l')('E'|'e')
>> ('P'|'p')('R'|'r')('E'|'e')('C'|'c')('I'|'i')('S'|'s')('I'|'i')('O'|'o')('N'|'n')
>> |
>>      ('i'|'I')('N'|'n')('T'|'t')('E'|'e')('G'|'g')('E'|'e')('R'|'r') |
>>      ('L'|'l')('O'|'o')('G'|'g')('I'|'i')('C'|'c')('A'|'a')('L'|'l')
>>     )
>>     ;
>>
>> FUNCTION:
>> ('f'|'F')('u'|'U')('n'|'N')('c'|'C')('t'|'T')('i'|'I')('o'|'O')('n'|'N');
>>
>> WHITE: (' ' | '\t' | '\n' | '\r')+ {skip();} ;
>>
>> // identifier (keyword or variable)
>> NAME  :   ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'0'..'9')*
>>     ;
>>
>> ANY    :    . ;
>>
>
>
> I have tested it with the following input:
>
>       PROGRAM TSTFAC
>>
>>       INTEGER N
>>       REAL FAC
>>
>>  10   WRITE(*,*) 'ENTER THE VALUE N (CNTRL-C TO END):'
>>       READ(*,*) N
>>
>>       IF (N .GE. 0) THEN
>>          WRITE(*,*) N, '! = ',FAC(N)
>>          GOTO 10
>>       ELSE
>>          WRITE(*,*) 'INVALID VALUE FOR N.'
>>          GOTO 10
>>       ENDIF
>>
>>       STOP
>>       END
>>
>>       REAL FUNCTION FAC(N)
>>       INTEGER N
>>       N = 7
>>       RETURN
>>       END
>>
>
> with the following test rig:
>
> import org.antlr.runtime.*;
>> import java.io.*;
>>
>> public class Test {
>>     public static void main(String[] args) throws Exception {
>>         try{
>>             FileInputStream f = new FileInputStream( "tstfac.f" );
>>             ANTLRInputStream input = new ANTLRInputStream( f );
>>             funLexer lexer = new funLexer(input);
>>             CommonTokenStream tokens = new CommonTokenStream(lexer);
>>             funParser parser = new funParser(tokens);
>>             parser.root();
>>         }
>>         catch(FileNotFoundException e)
>>         {
>>             System.out.println("file not found");
>>         }
>>
>>     }
>> }
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/18ff7df0/attachment-0001.html 

From antlr at mirality.co.nz  Thu Jul 24 14:53:07 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 25 Jul 2008 09:53:07 +1200
Subject: [antlr-interest] Token Mismatch
In-Reply-To: <7D50572C73BC634F92EE211BFF16F4A10641B7F4@USILMS12.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A10641B7F4@USILMS12.ca.com>
Message-ID: <20080724215315.78A1311EDFD@www.antlr.org>

At 05:33 25/07/2008, Brisard, Fred D wrote:
>It seems like any literal specified in the parser rules becomes 
>an implied token.

In a combined grammar, yes.  Personally I dislike this behaviour 
since it leads to specifying the same literal more than once 
(making it open to typos), erodes the logical separation of lexer 
and parser, and gives the token an annoying typename.  But some 
people seem to like them.

>/** Match things like "call foo;" */
>
>r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
>
>ID: 'a'..'z'+ ;
>
>WS: (' '|'\n'|'\r')+ {$channel=HIDDEN;} ;
>
>I get a MismatchedTokenException I run this in the ANTLRWorks 
>debugger for the input
>
>call call;
>
>I would like the second call to be identified as a token of type 
>ID.

You cannot do this directly, but you can specify that the literal 
'call' can be recognised in the context of an identifier:

r : 'call' id ';';
id : ID | 'call';
...

If you're generating an AST, you can also change the type of AST 
node emitted so that the tree walker will indeed see an ID token 
there:

id : ID | a='call' -> ID[$a];

(I'm not 100% certain about this last one's syntax, but I think it 
goes something like that.)


From jbb at acm.org  Thu Jul 24 15:28:26 2008
From: jbb at acm.org (John B. Brodie)
Date: Thu, 24 Jul 2008 18:28:26 -0400
Subject: [antlr-interest] recognizing a function
In-Reply-To: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>
	(kroizguy@gmail.com)
References: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>
Message-ID: <E1KM9IQ-00034x-B9@gecko.home.org>

Greetings!

Guy Kroizman wrote (in part):
>I have written a grammar that I hoped would find a function definition in a
>Fortran file.
>Running it produces nothing. s-:
>
>I played with it a lot and debugged it with jdb and ANTLRWorks but to avail.
>I wonder if anybody would be so kind to point me to the problem with the
>grammar.
>
>grammar fun;
>
> root     :
>     (functionStatement)*
>     ;

It is that pesky * on your start rule.

You have said that a valid program (e.g. any parsable derivation starting
from your root rule) may contain ZERO or more functionStatement's.

So when you run your parser against the input you supplied in the previous
message.  The parser sees the keyword - er I mean the NAME - PROGRAM as the
first token it encounters.  PROGRAM is not a valid starting token for the
functionStatement rule. So the parser just silently quits, without parsing
anything because it found ZERO functionStatement's and you have said that
is an okay thing.


Suggestions:

1) I would suggest that you explicitly require an EOF token at the end of
   any valid input - this will immediately show problems like the one
   discussed above.  So I would suggest that you change your root rule to:

root : ( functionStatement )* EOF ;

   running your parser with this version of the root rule should produce a
   syntax error - something similar to "found PROGRAM, expecting FUNCTION"

2) I would suggest not trying to deal with case insensitivity in your
   lexer. Rather I would suggest using the case insensitive input file
   stream posted to the antlr-interest mailing list back in december of
   2006. ask about it again if you can't find it in the list's archives.

3) I would not try to recognize keywords using a Parser rule - such as your
   type rule. Your type rule expects to see each individual letter of the
   various keywords. However, ANTLR lexers are very greedy, they will
   consume the longest possible sequence of characters that matches some
   lexer rule. So your type rule will never see any individual letter
   because all of the letters will be greedily gobbled up by the NAME
   rule. Make the type rule be a lexer rule, and see the next suggestion...

4) You are going to experience a devil of a time trying to deal with
   keywords that also may be identifiers.  I believe there are lots of
   messages about this in the mailing list archives.

Hope this helps.
   -jbb

From anders at globe-trotter.us  Thu Jul 24 20:25:25 2008
From: anders at globe-trotter.us (=?iso-8859-1?Q?Anders=20Karlsson?=)
Date: Fri, 25 Jul 2008 11:25:25 +0800
Subject: [antlr-interest] =?iso-8859-1?q?Generation_of_CPP?=
Message-ID: <20080725032525.28437.qmail@station198.com>

Hi all,

I am new to this list because I have a problem generating CPP files from within AntlrWorks 1.1.7 and was hoping somebody could help me.

I get the error "Cannot generate the grammar because: error(10): internal error: no such group file cpp.stg"

however both CSharp and C work seem to work but when specifying cpp (see below)

#######################################
grammar expeval;

options { language = cpp; }

prog 	:	stat+;

stat 	:	expr NEWLINE*
	;

expr 	:	INT unary_operator expr
	|	INT 
	|	'(' expr ')'
	;

unary_operator
    : '*'
    | '+'
    | '-'
    ;    
	
NEWLINE :	 '\r'? '\n'? ;
INT	:	('0' | '1'..'9' '0'..'9'*);
#######################################
I get the error.

What am I doing wrong? I found the cpp.stg inside the .jar but seems not to be found.

I start AntlrWorks with

java -jar antlrworks-1.1.7.jar

Would be grateful for any help.  

Note: I don't know that much about Java, just the basics

Thank you
Anders.




From brent.yates at gmail.com  Thu Jul 24 20:30:17 2008
From: brent.yates at gmail.com (Brent Yates)
Date: Thu, 24 Jul 2008 23:30:17 -0400
Subject: [antlr-interest] Generation of CPP
In-Reply-To: <20080725032525.28437.qmail@station198.com>
References: <20080725032525.28437.qmail@station198.com>
Message-ID: <6edc6c380807242030u7dc0e8c8q3ca40dd1033ea8d8@mail.gmail.com>

Anders,

The CPP target is not currently supported.  The best solution (which I use)
is to use the C target.  The generated C code will compile under C++.  There
is some talk of reviving the C++ target, but it is a ways off.

Brent Yates
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080724/9d5227d8/attachment.html 

From anders at globe-trotter.us  Thu Jul 24 21:52:10 2008
From: anders at globe-trotter.us (=?iso-8859-1?Q?Anders=20Karlsson?=)
Date: Fri, 25 Jul 2008 12:52:10 +0800
Subject: [antlr-interest] =?iso-8859-1?q?Generation_of_CPP?=
Message-ID: <20080725045210.30664.qmail@station198.com>


Hi Brent,

Thanks for the information! OK will try the C code instead.

Many thanks
Anders.

>  -------Original Message-------
>  From: Brent Yates <brent.yates at gmail.com>
>  Subject: Re: [antlr-interest] Generation of CPP
>  Sent: 25 Jul '08 11:30
>  
>  Anders,
>  
>  The CPP target is not currently supported.  The best solution (which I
>  use) is to use the C target.  The generated C code will compile under C++.
>  There is some talk of reviving the C++ target, but it is a ways off.
>  
>  Brent Yates

From janvanmansum at gmail.com  Fri Jul 25 02:24:35 2008
From: janvanmansum at gmail.com (Jan van Mansum)
Date: Fri, 25 Jul 2008 11:24:35 +0200
Subject: [antlr-interest] Can a lexer rule have user defined attributes?
Message-ID: <ddda310e0807250224o16047968hebadf0d59ae059b3@mail.gmail.com>

Hello group,

I am afraid I already now the answer: no. I tried the following grammar:

grammar TestAttributes;

r returns [int x, int y]    :    ID {System.out.println($ID.rv);}
    ;

ID returns [int rv]
    :    'a'..'z'+ {$rv = 3;}

    ;

If I check the grammar in AntlrWorks it accepts it, but the generated lexer
code cannot be compiled because ID is a Token and not an ID_return instance.
In fact there is not ID_return class generated.

My questions:
- Why does the grammar check out as correct?
- Why can lexer rules not have user defined attributes?

Thanks for any help,

regards,


-- 
Jan van Mansum
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080725/3ef9a775/attachment.html 

From antlr at mirality.co.nz  Fri Jul 25 02:49:45 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 25 Jul 2008 21:49:45 +1200
Subject: [antlr-interest] Can a lexer rule have user defined attributes?
In-Reply-To: <ddda310e0807250224o16047968hebadf0d59ae059b3@mail.gmail.co
 m>
References: <ddda310e0807250224o16047968hebadf0d59ae059b3@mail.gmail.com>
Message-ID: <20080725094953.9EB7D3522A3@www.antlr.org>

At 21:24 25/07/2008, Jan van Mansum wrote:
>ID returns [int rv]
>     :    'a'..'z'+ {$rv = 3;}
>     ;
[...]
>- Why does the grammar check out as correct?

Because ANTLR's error-checking can be a little crude at 
times.  Basically the grammar check is mostly just checking 
syntax; you've made a semantic error there, and it's not so good 
at catching those.

>- Why can lexer rules not have user defined attributes?

Because there's nowhere to put them.  All lexer rules (top level 
ones, at least) are required to return a Token, and (except in the 
C target) the standard token doesn't have any "spare" 
storage.  You can, however, subclass either Token or CommonToken 
and add your own fields.  Then you can store whatever additional 
data you want.

However it's not quite as simple as the above; to get extra data 
in there you'll need to override the emit method and pass it in 
that way.  (Johannes recently posted an example of this for C# 
just today, in fact.  I'm sure the Java version is similar.)


From markwright at internode.on.net  Fri Jul 25 03:04:01 2008
From: markwright at internode.on.net (Mark Wright)
Date: Fri, 25 Jul 2008 20:04:01 +1000
Subject: [antlr-interest] Can a lexer rule have user defined attributes?
In-Reply-To: <20080725094953.9EB7D3522A3@www.antlr.org>
References: <ddda310e0807250224o16047968hebadf0d59ae059b3@mail.gmail.com>
	<20080725094953.9EB7D3522A3@www.antlr.org>
Message-ID: <20080725200401.000060d8@goanna>

On Fri, 25 Jul 2008 21:49:45 +1200
Gavin Lambert <antlr at mirality.co.nz> wrote:

> >- Why can lexer rules not have user defined attributes?
> 
> Because there's nowhere to put them.  All lexer rules (top level 
> ones, at least) are required to return a Token, and (except in the 
> C target) the standard token doesn't have any "spare" 
> storage.  You can, however, subclass either Token or CommonToken 
> and add your own fields.  Then you can store whatever additional 
> data you want.
> 
> However it's not quite as simple as the above; to get extra data 
> in there you'll need to override the emit method and pass it in 
> that way.  (Johannes recently posted an example of this for C# 
> just today, in fact.  I'm sure the Java version is similar.)

Something like this:

MyToken.java:

import org.antlr.runtime.CommonToken;
import org.antlr.runtime.CharStream;

public class MyToken extends CommonToken {
  protected Symbol symbol;

  public MyToken(CharStream input, int type, int channel, int start, int stop) {
    super(input, type, channel, start, stop);
    symbol = (Symbol)null;
  }

  public MyToken(int type, String text) {
    super(type, text);
    symbol = (Symbol)null;
  }

  public final Symbol getSymbol() {
    return symbol;
  }

  public void setSymbol(Symbol value) {
    symbol = value;
  }
}

ANTLR 3.1 beta grammar:

@lexer::members {
    public Token emit() {
        Token t = new MyToken(input, state.type, state.channel, state.tokenStartCharIndex, getCharIndex()-1);
        t.setLine(state.tokenStartLine);
        t.setText(state.text);
        t.setCharPositionInLine(state.tokenStartCharPositionInLine);
        emit(t);
        return t;
    }
}


-- 

From jens.boeykens at gmail.com  Fri Jul 25 03:07:56 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Fri, 25 Jul 2008 12:07:56 +0200
Subject: [antlr-interest] Preserving Comments
In-Reply-To: <1216047270.26749.4.camel@jimi>
References: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
	<1216047270.26749.4.camel@jimi>
Message-ID: <53c4e43f0807250307u772ca826l7bf81b33451d09b9@mail.gmail.com>

I want to do a similar thing. I'm using slightly adapted versions of
ANTLRv3.g <http://www.antlr.org/grammar/ANTLR/ANTLRv3.g> and
ANTLRv3Tree.g<http://www.antlr.org/grammar/ANTLR/ANTLRv3Tree.g>to
regenerate ANTLRv3 grammars. I have extended the walker (ANTLRv3Tree)
with template rewrite rules to regenerate the original antlr grammar, parsed
with antlrv3.g. It works great, except for the comments. These are placed in
a hidden channel and are not seen by the walker and thus not given to a
template rewrite rule. I realize it is not appropriate to place the comments
in the tree, because comments can be put everywhere and this would make the
parser to complex. But how exactly do I tell my walker to look for tokens in
the hidden channel or a self defined channel. Can someone give an example,
because I really don't know where to begin or what syntax to use?

"you can search within the start and stop tokens for the AST rule and find
anything on channel 2, doing with it as you will."

How and where exactly do I need to do this? In ANTLRv3Tree.g itself and if
so with what syntax? Or is it done somewhere else in java code? I thought an
AST rule didn't have a stop token, only start?

An example what I'm trying to do:
parsing of a grammar:             * r: INTEGER ; //comments*
ANTLRv3.g makes a tree:       * (RULE r (BLOCK (ALT INTEGER EOA) EOB) EOR)*
Now from this tree I reconstruct the grammar but I get      *  r: INTEGER
;     *thus the comments are gone.
When I walk this tree in ANTLRv3Tree.g the rule "rule" is used. Should I add
something to "rule" in ANTLRv3Tree.g?

Sorry if this is a basic question, but an example would make things much
clearer.

Jens

2008/7/14 Jim Idle <jimi at temporal-wave.com>:

>  On Mon, 2008-07-14 at 12:43 +0530, nilesh.kapile at tcs.com wrote:
>
>
> Hello,
>
> I need to preserve comments and want to collect it in some data structure.
>  How can we do that in ANTLR?
>
> Currently, I've following rule for comments:
>
> LINE_COMMENT
>     :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;}
>     ;
>
> The easiest way os to use your own channel, say 2, which means the parser
> will ignore them but they are preserved in the input stream (actually they
> are when HIDDEN but that really means 'anything you want to hide' and you
> specifically want to inspect comments. Then, when you walk your tree
> (assuming you are using a tree but that is best), at any point where the
> comments are required, you can search within the start and stop tokens for
> the AST rule and find anything on channel 2, doing with it as you will. You
> can also do this from the parser of course.
>
> The other option is to pass the COMMENT token through as a normal token,
> and create parser rules to assemble them at various points. The problem here
> comes when the COMMENT can be anywhere, such as in the middle of
> expressions, so the parser ends up having the COMMENT token everywhere and
> complicates your grammar enormously.
>
> Jim
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080725/09f296ad/attachment-0001.html 

From gavilancomun at gmail.com  Fri Jul 25 05:10:18 2008
From: gavilancomun at gmail.com (James)
Date: Fri, 25 Jul 2008 13:10:18 +0100
Subject: [antlr-interest] Passing list of tokens to StringTemplate
In-Reply-To: <487B55E7.8010404@googlemail.com>
References: <487B55E7.8010404@googlemail.com>
Message-ID: <e44e365f0807250510v67e674f1p954bc3cbb4a5fb64@mail.gmail.com>

2008/7/14 Gavilan <gavilancomun at gmail.com>:
> I would like to pass a list of tokens to a template.
>
> grammar toks;
>
> options { output=template; }
>
> INT: ('+'|'-')? ('0'..'9')+;
> WS: (' '|'\t'|'\r'|'\n')+ { skip(); };
>
> toks: t+=INT t+=INT t+=INT -> toks(v={$t});
>
>
> On input:
> -1 0 23
>
> I get:
> <toks>[@0,0:1='-1',<4>,1:0], [@1,3:3='0',<4>,1:3],
> [@2,5:6='23',<4>,1:5]</toks>

I have fixed this by adding an attribute renderer:

public class TokenRenderer implements AttributeRenderer {

public String toString(Object o) {
	Token t = (Token) o;
	return t.getText();
}

public String toString(Object o, String formatName) {
	return toString(o);
}

Best Wishes,
James

From ladam at vbi.vt.edu  Fri Jul 25 07:37:15 2008
From: ladam at vbi.vt.edu (Laura Adam)
Date: Fri, 25 Jul 2008 10:37:15 -0400 (EDT)
Subject: [antlr-interest] Redirect error message to a file
In-Reply-To: <1347698588.1310841216995811186.JavaMail.root@zimbra>
Message-ID: <1792514746.1311301216996635531.JavaMail.root@zimbra>

Hello,

I'd like to thank people that helped me previously. It has been very useful. 
I am now using anltr-3.1b2, and taking informations mostly from the book because else it can be anltr v2 tutorials talking about things such as defaultErrorHandler...

I am working on redirecting the error message to a file.

I wrote (see bellow) in my file.g file the functions I want to redefine. 
File.g and file.java compile but it seems that file.java is still using the default functions (error messages are printed on the shell).
It seems (by compiling) existing functions cannot have a different return type or throw any exception if before it does not, that's why my code is quite strange.

I also tried with the given examples in the book, the same happen. I may forget to do something...

What should I change?

Laura Adam



**************************************************************************
grammar G;

options{...}

@member{
 private String Errormsg=""; 
    
    public void emitErrorMessage(String msg) {
	Errormsg= msg;
    }
    
    public void displayRecognitionError(String[] tokenNames, RecognitionException e){
	String hdr = getErrorHeader(e);
	String msg = getErrorMessage(e, tokenNames);
	emitErrorMessage(hdr+" "+msg);
	repportErrormsg();
    }
    
    public void repportErrormsg(){
	try{
	PrintWriter file = new PrintWriter("Error.txt");
	file.println(Errormsg);
	file.close();}
	catch(Exception e){System.out.println("problem while writing in the Error.txt file");}
    }
}

rules....

From r_reitzi at cs.uni-kl.de  Fri Jul 25 08:00:20 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Fri, 25 Jul 2008 17:00:20 +0200
Subject: [antlr-interest] Can a lexer rule have user defined	attributes?
In-Reply-To: <20080725200401.000060d8@goanna>
References: <ddda310e0807250224o16047968hebadf0d59ae059b3@mail.gmail.com>
	<20080725094953.9EB7D3522A3@www.antlr.org>
	<20080725200401.000060d8@goanna>
Message-ID: <20080725170020.10902r2h30tdoq04@horde.verrech.net>

Hi!

You could expect ANTLR to recognize such use of a token rule ('wow, my  
user wants to have extra data in his tokens!') and automatically  
create a subclass of Token with the required attributes and methods.  
Do I overlook something that makes this task extraordinary hard?

Regards

Raphael

"Mark Wright" <markwright at internode.on.net> wrote (Fri Jul 25 12:04:01 2008):

> On Fri, 25 Jul 2008 21:49:45 +1200
> Gavin Lambert <antlr at mirality.co.nz> wrote:
>
>> >- Why can lexer rules not have user defined attributes?
>>
>> Because there's nowhere to put them.  All lexer rules (top level
>> ones, at least) are required to return a Token, and (except in the
>> C target) the standard token doesn't have any "spare"
>> storage.  You can, however, subclass either Token or CommonToken
>> and add your own fields.  Then you can store whatever additional
>> data you want.
>>
>> However it's not quite as simple as the above; to get extra data
>> in there you'll need to override the emit method and pass it in
>> that way.  (Johannes recently posted an example of this for C#
>> just today, in fact.  I'm sure the Java version is similar.)
>
> Something like this:
>
> MyToken.java:
>
> import org.antlr.runtime.CommonToken;
> import org.antlr.runtime.CharStream;
>
> public class MyToken extends CommonToken {
>   protected Symbol symbol;
>
>   public MyToken(CharStream input, int type, int channel, int start,  
> int stop) {
>     super(input, type, channel, start, stop);
>     symbol = (Symbol)null;
>   }
>
>   public MyToken(int type, String text) {
>     super(type, text);
>     symbol = (Symbol)null;
>   }
>
>   public final Symbol getSymbol() {
>     return symbol;
>   }
>
>   public void setSymbol(Symbol value) {
>     symbol = value;
>   }
> }
>
> ANTLR 3.1 beta grammar:
>
> @lexer::members {
>     public Token emit() {
>         Token t = new MyToken(input, state.type, state.channel,  
> state.tokenStartCharIndex, getCharIndex()-1);
>         t.setLine(state.tokenStartLine);
>         t.setText(state.text);
>         t.setCharPositionInLine(state.tokenStartCharPositionInLine);
>         emit(t);
>         return t;
>     }
> }
>
>
> --
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080725/c37320a2/attachment.bin 

From sharwell at pixelminegames.com  Fri Jul 25 09:33:31 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 25 Jul 2008 11:33:31 -0500
Subject: [antlr-interest] Trouble with syntactic predicates that reference
	semantic predicates that rely on a current dynamic attribute scope
Message-ID: <86403CA0939415448BCCB83855EFE09A64DE53@Bloodymary.ironwillgames.com>

Wow that's a big statement!

 

Consider the following setup:

 

rule2

scope

{

    int a;

}

@init

{

    a = -1;

}

: { (a < 0) }? rule3 { ((a=1) >= 0) /* intentional assignment */ }?

;

 

rule1

: ((rule2) => rule2)+

;

 

rule0

: (rule1) => rule1

| rule4

;

 

In evaluating the syntactic predicate in rule0, the semantic predicate
at the beginning of rule2 is evaluated without pushing a new dynamic
attribute scope. I can detect the lack of a dynamic scope
(rule2_stack.Count == 0), but there is a path for rule0 to be reached
inside rule2, in which case the semantic predicate is checking the value
of a in the wrong scope. Is this a bug?

 

Sam

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080725/969b7154/attachment.html 

From parrt at cs.usfca.edu  Fri Jul 25 10:28:22 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 25 Jul 2008 10:28:22 -0700
Subject: [antlr-interest] Passing list of tokens to StringTemplate
In-Reply-To: <e44e365f0807250510v67e674f1p954bc3cbb4a5fb64@mail.gmail.com>
References: <487B55E7.8010404@googlemail.com>
	<e44e365f0807250510v67e674f1p954bc3cbb4a5fb64@mail.gmail.com>
Message-ID: <A39EFB2D-398C-4FE1-97C5-442DC0CF4C7A@cs.usfca.edu>

Easier is to use propertyOf the token.

toks(v) ::= "<v:{x | <x.text>}>"

  for example.

Ter
On Jul 25, 2008, at 5:10 AM, James wrote:

> 2008/7/14 Gavilan <gavilancomun at gmail.com>:
>> I would like to pass a list of tokens to a template.
>>
>> grammar toks;
>>
>> options { output=template; }
>>
>> INT: ('+'|'-')? ('0'..'9')+;
>> WS: (' '|'\t'|'\r'|'\n')+ { skip(); };
>>
>> toks: t+=INT t+=INT t+=INT -> toks(v={$t});
>>
>>
>> On input:
>> -1 0 23
>>
>> I get:
>> <toks>[@0,0:1='-1',<4>,1:0], [@1,3:3='0',<4>,1:3],
>> [@2,5:6='23',<4>,1:5]</toks>
>
> I have fixed this by adding an attribute renderer:
>
> public class TokenRenderer implements AttributeRenderer {
>
> public String toString(Object o) {
> 	Token t = (Token) o;
> 	return t.getText();
> }
>
> public String toString(Object o, String formatName) {
> 	return toString(o);
> }
>
> Best Wishes,
> James


From parrt at cs.usfca.edu  Fri Jul 25 10:31:51 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 25 Jul 2008 10:31:51 -0700
Subject: [antlr-interest] Trouble with syntactic predicates that
	reference semantic predicates that rely on a current dynamic
	attribute scope
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64DE53@Bloodymary.ironwillgames.com>
References: <86403CA0939415448BCCB83855EFE09A64DE53@Bloodymary.ironwillgames.com>
Message-ID: <EABFF6BB-1A67-42AF-BCB1-D0412AEA32E7@cs.usfca.edu>

Hi Sam,

Wow!I had not thought of this. The problem is that the predicate gets  
hoisted out of rule2 and is evaluated before entry into rule2. The  
code to push the new scope is not executed. crap...yeah, there are  
general issues with predicates to get hoisted out of context... I  
cannot really look inside to see your actions to know what to do. I  
will say, however, that you are not using proper syntax to access the  
scope. it must be $rule2::a not a. In fact, I am surprised that works  
at all! is that really compile?  int a will be inside of a class.  'a'  
all by itself should not compile.
Ter

On Jul 25, 2008, at 9:33 AM, Sam Harwell wrote:

> Wow that?s a big statement!
>
> Consider the following setup:
>
> rule2
> scope
> {
>     int a;
> }
> @init
> {
>     a = -1;
> }
> : { (a < 0) }? rule3 { ((a=1) >= 0) /* intentional assignment */ }?
> ;
>
> rule1
> : ((rule2) => rule2)+
> ;
>
> rule0
> : (rule1) => rule1
> | rule4
> ;
>
> In evaluating the syntactic predicate in rule0, the semantic  
> predicate at the beginning of rule2 is evaluated without pushing a  
> new dynamic attribute scope. I can detect the lack of a dynamic  
> scope (rule2_stack.Count == 0), but there is a path for rule0 to be  
> reached inside rule2, in which case the semantic predicate is  
> checking the value of a in the wrong scope. Is this a bug?
>
> Sam
>


From sharwell at pixelminegames.com  Fri Jul 25 11:51:24 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 25 Jul 2008 13:51:24 -0500
Subject: [antlr-interest] Trouble with syntactic predicates that
	reference semantic predicates that rely on a current dynamic
	attribute scope
In-Reply-To: <EABFF6BB-1A67-42AF-BCB1-D0412AEA32E7@cs.usfca.edu>
References: <86403CA0939415448BCCB83855EFE09A64DE53@Bloodymary.ironwillgames.com>
	<EABFF6BB-1A67-42AF-BCB1-D0412AEA32E7@cs.usfca.edu>
Message-ID: <86403CA0939415448BCCB83855EFE09A64DE5A@Bloodymary.ironwillgames.com>

Sorry for the confusion.

My grammar has 100+ rules. I wrote this example quickly to illustrate
the issue. In the actual grammar, the scope access syntax is correct. (I
bet it only takes 1 guess to figure out what language I'm parsing...)

I got around the issue by adding an auto-incrementing id in scope with
the syntactic predicate, then checking in the semantic predicate to see
if the id matches a reference id in the top level scope containing the
variable I need ('a' in this example). I placed the id check in a
function called HaveValidDeclSpecifierSeqScope() so it's somewhat easy
to reference, but it's still rather "unfriendly".

Sam

-----Original Message-----
From: Terence Parr [mailto:parrt at cs.usfca.edu] 
Sent: Friday, July 25, 2008 12:32 PM
To: Sam Harwell
Cc: antlr mailing list
Subject: Re: [antlr-interest] Trouble with syntactic predicates that
reference semantic predicates that rely on a current dynamic attribute
scope

Hi Sam,

Wow!I had not thought of this. The problem is that the predicate gets  
hoisted out of rule2 and is evaluated before entry into rule2. The  
code to push the new scope is not executed. crap...yeah, there are  
general issues with predicates to get hoisted out of context... I  
cannot really look inside to see your actions to know what to do. I  
will say, however, that you are not using proper syntax to access the  
scope. it must be $rule2::a not a. In fact, I am surprised that works  
at all! is that really compile?  int a will be inside of a class.  'a'  
all by itself should not compile.
Ter

On Jul 25, 2008, at 9:33 AM, Sam Harwell wrote:

> Wow that's a big statement!
>
> Consider the following setup:
>
> rule2
> scope
> {
>     int a;
> }
> @init
> {
>     a = -1;
> }
> : { (a < 0) }? rule3 { ((a=1) >= 0) /* intentional assignment */ }?
> ;
>
> rule1
> : ((rule2) => rule2)+
> ;
>
> rule0
> : (rule1) => rule1
> | rule4
> ;
>
> In evaluating the syntactic predicate in rule0, the semantic  
> predicate at the beginning of rule2 is evaluated without pushing a  
> new dynamic attribute scope. I can detect the lack of a dynamic  
> scope (rule2_stack.Count == 0), but there is a path for rule0 to be  
> reached inside rule2, in which case the semantic predicate is  
> checking the value of a in the wrong scope. Is this a bug?
>
> Sam
>


From kroizguy at gmail.com  Sat Jul 26 06:09:43 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Sat, 26 Jul 2008 16:09:43 +0300
Subject: [antlr-interest] recognizing a function
In-Reply-To: <E1KM9IQ-00034x-B9@gecko.home.org>
References: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>
	<E1KM9IQ-00034x-B9@gecko.home.org>
Message-ID: <f5c59b030807260609k55d22babi11f53948bfbfddfd@mail.gmail.com>

Thank you Ana Nelson and John B Brodie, I have learned much from your
assiduous responses.

My goal is to write a program that gets a valid Fortran code and output the
locations of the functions ( later subroutines and function calls too ).

I am still having a hard time figuring out how can I a grammar that will
only match a certain rule and ignore all other input.

Must I define a full Fortran grammar for that?

On Fri, Jul 25, 2008 at 1:28 AM, John B. Brodie <jbb at acm.org> wrote:

> Greetings!
>
> Guy Kroizman wrote (in part):
> >I have written a grammar that I hoped would find a function definition in
> a
> >Fortran file.
> >Running it produces nothing. s-:
> >
> >I played with it a lot and debugged it with jdb and ANTLRWorks but to
> avail.
> >I wonder if anybody would be so kind to point me to the problem with the
> >grammar.
> >
> >grammar fun;
> >
> > root     :
> >     (functionStatement)*
> >     ;
>
> It is that pesky * on your start rule.
>
> You have said that a valid program (e.g. any parsable derivation starting
> from your root rule) may contain ZERO or more functionStatement's.
>
> So when you run your parser against the input you supplied in the previous
> message.  The parser sees the keyword - er I mean the NAME - PROGRAM as the
> first token it encounters.  PROGRAM is not a valid starting token for the
> functionStatement rule. So the parser just silently quits, without parsing
> anything because it found ZERO functionStatement's and you have said that
> is an okay thing.
>
>
> Suggestions:
>
> 1) I would suggest that you explicitly require an EOF token at the end of
>   any valid input - this will immediately show problems like the one
>   discussed above.  So I would suggest that you change your root rule to:
>
> root : ( functionStatement )* EOF ;
>
>   running your parser with this version of the root rule should produce a
>   syntax error - something similar to "found PROGRAM, expecting FUNCTION"
>
> 2) I would suggest not trying to deal with case insensitivity in your
>   lexer. Rather I would suggest using the case insensitive input file
>   stream posted to the antlr-interest mailing list back in december of
>   2006. ask about it again if you can't find it in the list's archives.
>
> 3) I would not try to recognize keywords using a Parser rule - such as your
>   type rule. Your type rule expects to see each individual letter of the
>   various keywords. However, ANTLR lexers are very greedy, they will
>   consume the longest possible sequence of characters that matches some
>   lexer rule. So your type rule will never see any individual letter
>   because all of the letters will be greedily gobbled up by the NAME
>   rule. Make the type rule be a lexer rule, and see the next suggestion...
>
> 4) You are going to experience a devil of a time trying to deal with
>   keywords that also may be identifiers.  I believe there are lots of
>   messages about this in the mailing list archives.
>
> Hope this helps.
>    -jbb
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080726/bdb0199e/attachment.html 

From jaluber at gmx.de  Sat Jul 26 06:38:25 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 26 Jul 2008 15:38:25 +0200
Subject: [antlr-interest] recognizing a function
In-Reply-To: <f5c59b030807260609k55d22babi11f53948bfbfddfd@mail.gmail.com>
References: <f5c59b030807241235tcc25fa2pf5603198dd911f01@mail.gmail.com>	<E1KM9IQ-00034x-B9@gecko.home.org>
	<f5c59b030807260609k55d22babi11f53948bfbfddfd@mail.gmail.com>
Message-ID: <488B28D1.3030908@gmx.de>

Guy Kroizman schrieb:
> Thank you Ana Nelson and John B Brodie, I have learned much from your 
> assiduous responses.
> 
> My goal is to write a program that gets a valid Fortran code and output 
> the locations of the functions ( later subroutines and function calls too ).
> 
> I am still having a hard time figuring out how can I a grammar that will 
> only match a certain rule and ignore all other input.
> 
> Must I define a full Fortran grammar for that?

It depends on if you can get away with fuzzy recognition. If there is a 
way to recognize functions without having to look at other parts then 
you have just to skip the unneeded parts. There is a lexer option named 
"filter=true;" which ignores any input which isn't recognized (requires 
a lexer grammar).

In case operating on the lexer level is too low, you can define parser 
rules in such a way to skip any input you aren't interested in. ".*" 
(maybe with the greedy=false; option) along with a end marker like 
~FUNCTION let you skip lexer input. Otherwise you have to go the full 
grammar route.

Johannes
> 
> On Fri, Jul 25, 2008 at 1:28 AM, John B. Brodie <jbb at acm.org 
> <mailto:jbb at acm.org>> wrote:
> 
>     Greetings!
> 
>     Guy Kroizman wrote (in part):
>      >I have written a grammar that I hoped would find a function
>     definition in a
>      >Fortran file.
>      >Running it produces nothing. s-:
>      >
>      >I played with it a lot and debugged it with jdb and ANTLRWorks but
>     to avail.
>      >I wonder if anybody would be so kind to point me to the problem
>     with the
>      >grammar.
>      >
>      >grammar fun;
>      >
>      > root     :
>      >     (functionStatement)*
>      >     ;
> 
>     It is that pesky * on your start rule.
> 
>     You have said that a valid program (e.g. any parsable derivation
>     starting
>     from your root rule) may contain ZERO or more functionStatement's.
> 
>     So when you run your parser against the input you supplied in the
>     previous
>     message.  The parser sees the keyword - er I mean the NAME - PROGRAM
>     as the
>     first token it encounters.  PROGRAM is not a valid starting token
>     for the
>     functionStatement rule. So the parser just silently quits, without
>     parsing
>     anything because it found ZERO functionStatement's and you have said
>     that
>     is an okay thing.
> 
> 
>     Suggestions:
> 
>     1) I would suggest that you explicitly require an EOF token at the
>     end of
>       any valid input - this will immediately show problems like the one
>       discussed above.  So I would suggest that you change your root
>     rule to:
> 
>     root : ( functionStatement )* EOF ;
> 
>       running your parser with this version of the root rule should
>     produce a
>       syntax error - something similar to "found PROGRAM, expecting
>     FUNCTION"
> 
>     2) I would suggest not trying to deal with case insensitivity in your
>       lexer. Rather I would suggest using the case insensitive input file
>       stream posted to the antlr-interest mailing list back in december of
>       2006. ask about it again if you can't find it in the list's archives.
> 
>     3) I would not try to recognize keywords using a Parser rule - such
>     as your
>       type rule. Your type rule expects to see each individual letter of the
>       various keywords. However, ANTLR lexers are very greedy, they will
>       consume the longest possible sequence of characters that matches some
>       lexer rule. So your type rule will never see any individual letter
>       because all of the letters will be greedily gobbled up by the NAME
>       rule. Make the type rule be a lexer rule, and see the next
>     suggestion...
> 
>     4) You are going to experience a devil of a time trying to deal with
>       keywords that also may be identifiers.  I believe there are lots of
>       messages about this in the mailing list archives.
> 
>     Hope this helps.
>       -jbb
> 
> 


From lgcraymer at yahoo.com  Sat Jul 26 16:06:35 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Sat, 26 Jul 2008 16:06:35 -0700 (PDT)
Subject: [antlr-interest] recognizing a function
Message-ID: <728184.83524.qm@web55905.mail.re3.yahoo.com>

If you ignore the "( later subroutines and function calls too )", then the answer to your last I define a full Fortran grammar for that?" is no and Johannes describes the path to follow.  Once you need to look inside functions and subroutines, though, you pretty much need a full grammar.  The good news is that a full grammar is easier to "steal" and debug--there is plenty of code to run against a full parser.  Also, the full grammar enables capabilities that you have not yet thought of developing--it's amazing how often the more general grammar solution ends up being a common part of one's toolchest.

--Loring



----- Original Message ----
From: Guy Kroizman <kroizguy at gmail.com>
To: antlr-interest at antlr.org
Sent: Saturday, July 26, 2008 6:09:43 AM
Subject: Re: [antlr-interest] recognizing a function


Thank you Ana Nelson and John B Brodie, I have learned much from your assiduous responses.

My goal is to write a program that gets a valid Fortran code and output the locations of the functions ( later subroutines and function calls too ).

I am still having a hard time figuring out how can I a grammar that will only match a certain rule and ignore all other input.

Must I define a full Fortran grammar for that?


On Fri, Jul 25, 2008 at 1:28 AM, John B. Brodie <jbb at acm.org> wrote:

Greetings!

Guy Kroizman wrote (in part):

>I have written a grammar that I hoped would find a function definition in a
>Fortran file.
>Running it produces nothing. s-:
>
>I played with it a lot and debugged it with jdb and ANTLRWorks but to avail.
>I wonder if anybody would be so kind to point me to the problem with the
>grammar.
>
>grammar fun;
>
> root     :
>     (functionStatement)*
>     ;

It is that pesky * on your start rule.

You have said that a valid program (e.g. any parsable derivation starting
from your root rule) may contain ZERO or more functionStatement's.

So when you run your parser against the input you supplied in the previous
message.  The parser sees the keyword - er I mean the NAME - PROGRAM as the
first token it encounters.  PROGRAM is not a valid starting token for the
functionStatement rule. So the parser just silently quits, without parsing
anything because it found ZERO functionStatement's and you have said that
is an okay thing.


Suggestions:

1) I would suggest that you explicitly require an EOF token at the end of
  any valid input - this will immediately show problems like the one
  discussed above.  So I would suggest that you change your root rule to:

root : ( functionStatement )* EOF ;

  running your parser with this version of the root rule should produce a
  syntax error - something similar to "found PROGRAM, expecting FUNCTION"

2) I would suggest not trying to deal with case insensitivity in your
  lexer. Rather I would suggest using the case insensitive input file
  stream posted to the antlr-interest mailing list back in december of
  2006. ask about it again if you can't find it in the list's archives.

3) I would not try to recognize keywords using a Parser rule - such as your
  type rule. Your type rule expects to see each individual letter of the
  various keywords. However, ANTLR lexers are very greedy, they will
  consume the longest possible sequence of characters that matches some
  lexer rule. So your type rule will never see any individual letter
  because all of the letters will be greedily gobbled up by the NAME
  rule. Make the type rule be a lexer rule, and see the next suggestion...

4) You are going to experience a devil of a time trying to deal with
  keywords that also may be identifiers.  I believe there are lots of
  messages about this in the mailing list archives.

Hope this helps.
  -jbb


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080726/acedc506/attachment.html 

From pink at odahoda.de  Sun Jul 27 03:25:58 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Sun, 27 Jul 2008 12:25:58 +0200
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <200807231041.37962.amax@redsymbol.net>
References: <200807181455.52897.amax@redsymbol.net>
	<200807221932.02185.amax@redsymbol.net>
	<543531490807231018q26025a77pf163d0152c9a695c@mail.gmail.com>
	<200807231041.37962.amax@redsymbol.net>
Message-ID: <543531490807270325m7cd1306dx1a298be65169bcd0@mail.gmail.com>

Hi Aaron,

I checked your grammar, but for me the { pass } "hack" works correctly.
Can you send me the generated PythonLexer.py that contains the bug?

-Ben

On Wed, Jul 23, 2008 at 7:41 PM, Aaron Maxwell <amax at redsymbol.net> wrote:
> On Wednesday 23 July 2008 10:18:23 am you wrote:
> [regarding empty elif clause in lexer]
>> > Can someone suggest a fix?  I tried just putting { pass;} in there,
>> > but it is not placed at the correct indentation level.  Plus that is just
>> > hackish.
>>
>> Mmm.. that should work. This is the only way to get empty alternatives
>> to work right now, and I've used it several times without problems.
>> I'll have a look at the code and checkout why it doesn't work in this
>> case - but probably not before the weekend.
>
> I wrote it like this:
>
> {{{
> CONTINUED_LINE
>    :    '\\' ('\r')? '\n' (' '|'\t')*  { $channel=HIDDEN; }
>         ( nl=NEWLINE
> {self.emit(ClassicToken(type=NEWLINE,text=nl.getText()))}
>         | {pass;}
>         )
>    ;
> }}}
>
> I also tried "{    pass;}", i.e. manually placing four spaces in there - both
> produced the same lexer code.  Is that the right syntax?
>
> --
> Aaron Maxwell
> http://redsymbol.net
>

From amax at redsymbol.net  Sun Jul 27 12:39:58 2008
From: amax at redsymbol.net (Aaron Maxwell)
Date: Sun, 27 Jul 2008 12:39:58 -0700
Subject: [antlr-interest] python-lang parser to python target
In-Reply-To: <543531490807270325m7cd1306dx1a298be65169bcd0@mail.gmail.com>
References: <200807181455.52897.amax@redsymbol.net>
	<200807231041.37962.amax@redsymbol.net>
	<543531490807270325m7cd1306dx1a298be65169bcd0@mail.gmail.com>
Message-ID: <200807271239.58517.amax@redsymbol.net>

On Sunday 27 July 2008 03:25:58 am Benjamin Niemann wrote:
> Hi Aaron,
>
> I checked your grammar, but for me the { pass } "hack" works correctly.
> Can you send me the generated PythonLexer.py that contains the bug?

Actually you are correct - putting in that {pass} statement does work 
correctly.  I just rebuilt and verified it.  My mistake - I think I 
mistakenly was editing one grammar and building via another copy before.

-- 
Aaron Maxwell
http://redsymbol.net

From cokey5614 at sina.com  Sun Jul 27 22:36:26 2008
From: cokey5614 at sina.com (cokey5614 at sina.com)
Date: Mon, 28 Jul 2008 13:36:26 +0800 
Subject: [antlr-interest] How to generate code files for
	treeGrammarFileName.g?
Message-ID: <20080728053626.89B473D7464@mail3-147.sinamail.sina.com.cn>

&nbsp;Hi,
I created treeGrammarFileName.g file(it is started with [tree grammar fileName]) and treeGrammarFileNameWalker.testSuite file in source folder, and then
tried the command :
&nbsp;&nbsp;&nbsp; org.antlr.gunit.Interp treeGrammarFileNameWalker.testSuite
but,error{
&nbsp;&nbsp;&nbsp; java.lang.ClassNOtFoundException:treeGrammarFileNameLexer
&nbsp;&nbsp;&nbsp; at java.net.URLClassLoader$1.run(Unknown Source)
} always happen.
in fact, in source folder, there are only treeGrammarFileName.java and treeGrammarFileName.class , 
there is no treeGrammarFileNameLexer.java file.
but, It seems that treeGrammarFileNameLexer.java and treeGrammarFileNameParser.java are necessary too.
Q:How to generate [ treeGrammarFileNameLexer.java and treeGrammarFileNameParser.java] code files for treeGrammarFileName.g?

thanks 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cokey

-------------------------------------------------------------------
????2G????(http://mail.sina.com.cn/)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080728/4d9ef474/attachment.html 

From davyd at fugro-fsi.com.au  Mon Jul 28 01:03:15 2008
From: davyd at fugro-fsi.com.au (Davyd Madeley)
Date: Mon, 28 Jul 2008 16:03:15 +0800
Subject: [antlr-interest] recombining tokens
Message-ID: <1217232195.3131.7.camel@tc35>

Hi all,

I'm currently writing a grammar in which '/' is used to append a
qualifier to a token. Unfortunately it is also used in path parameters.

I am trying to figure out how I can recombine tokens in the case where I
determine I'm reading a path.

e.g.

// these are my token delimiters
TOKEN
	: ~(','|'>'|'*'|'/'|'('|')'|LINE_TERMINATOR)+
	;

At one point in the state machine, I expect to be able to start reading
parameters ('LINE' is a special token at the start of the file, but
after that is just a regular token):

parameter
	: a=TOKEN	-> PARAMETER[$a]
	| a='LINE'	-> PARAMETER[$a]
	| path		-> ^(PATH path)
	;

path
	: ('/' TOKEN)+
	;

Every so often, a path will be provided. Currently this will be
tokenised around the '/', which is undesirable.

e.g.
      PATH (9) .......................... PATH
        '/' (20) ........................ /
        TOKEN (11) ...................... path
        '/' (20) ........................ /
        TOKEN (11) ...................... to
        '/' (20) ........................ /
        TOKEN (11) ...................... my.file

What I want to do is be able to recombine this into a
PARAMETER["/path/to/my.file"].

Someone spoke about a concatenation operator, but I can't find any info
about it.

Regards,
--davyd

-- 
Davyd Madeley        Software Engineer
Fugro Seismic Imaging, Perth Australia


From jens.boeykens at gmail.com  Mon Jul 28 01:40:31 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 28 Jul 2008 10:40:31 +0200
Subject: [antlr-interest] Preserving Comments
In-Reply-To: <1225236951-1217097635-cardhu_decombobulator_blackberry.rim.net-965110274-@bxe008.bisx.prod.on.blackberry>
References: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
	<1216047270.26749.4.camel@jimi>
	<53c4e43f0807250307u772ca826l7bf81b33451d09b9@mail.gmail.com>
	<1225236951-1217097635-cardhu_decombobulator_blackberry.rim.net-965110274-@bxe008.bisx.prod.on.blackberry>
Message-ID: <53c4e43f0807280140r3a0203d8y86f7b238b559d5c8@mail.gmail.com>

I managed to print out some of the comments with this changed code in
ANTLRv3Tree.g:

alternative
@after {
  CommonTree t = $alternative.start;
  int stop = t.getTokenStopIndex();
  CommonTokenStream tokens = (CommonTokenStream) input.getTokenStream();
  while(stop + 1 < tokens.size() && tokens.get(stop + 1).getLine() ==
tokens.get(t.getTokenStopIndex()).getLine())
        stop++;
  List<Token> comments = tokens.getTokens(t.getTokenStopIndex(), stop,
ANTLRv3Parser.SL_COMMENT);
  for(Token i : comments)
     System.out.println(i.getText());
}
    :   ^(ALT (e+=element)+ EOA) -> alternative_elements(alt={$ALT},
element={$e}, eoa = {$EOA})
    |   ^(ALT EPSILON EOA)  -> alternative_epsilon(alt={$ALT},
epsilon={$EPSILON}, eoa = {$EOA})
    ;

This code looks for a comment after each alternative and prints it out. eg
for input:

grammar T;
r : b // comm 1\n ;
r1 : b // comm 2\n ;

It prints out:

// comm 1

// comm 2

But now I want to put these comments back in the outputgrammar. I assume
this would imply adding some template code to insert the comment. But how
exactly is this done?

   - Do  I  need to  add  something  to the template rules
   alternative_elements(alt={$ALT}, element={$e}, eoa = {$EOA}) and
   alternative_epsilon(alt={$ALT}, epsilon={$EPSILON}, eoa = {$EOA})?
   - If so will this work if the code is put in an @after action?
   - Doing it this way implies that I have to change a lot of template
   rules, which is not very handy.
   - To recover all the comments this way, I have to put code in almost
   every rule in ANTLRv3Tree.g to look for the tokens near the rule and check
   if it is a comment. This kind of undoes the advantage of the hidden channel
   that you do not have to include comments in the tree in order to keep the
   parser simple. In fact now we would be moving all the complexity towards the
   walker instead of the parser.
   - Of course I could be looking at it the wrong way and I should recover
   the comments a different way. If so can someone tell me how?

Jens

2008/7/26 Jim Idle <jimi at temporal-wave.com>

> Each node of the tree has start and stop tokens. If you getRange or get tui
> can retrieve any token, on channel or not so use this at strategic points in
> your tree grammar to get at comments.
>
> Jim
>
> Sent via BlackBerry from T-Mobile
>
> ------------------------------
> *From*: "Jens Boeykens" <jens.boeykens at gmail.com>
> *Date*: Fri, 25 Jul 2008 12:07:56 +0200
> *To*: <antlr-interest at antlr.org>
> *Subject*: Re: [antlr-interest] Preserving Comments
> I want to do a similar thing. I'm using slightly adapted versions of
> ANTLRv3.g <http://www.antlr.org/grammar/ANTLR/ANTLRv3.g> and ANTLRv3Tree.g<http://www.antlr.org/grammar/ANTLR/ANTLRv3Tree.g>to regenerate ANTLRv3 grammars. I have extended the walker (ANTLRv3Tree)
> with template rewrite rules to regenerate the original antlr grammar, parsed
> with antlrv3.g. It works great, except for the comments. These are placed in
> a hidden channel and are not seen by the walker and thus not given to a
> template rewrite rule. I realize it is not appropriate to place the comments
> in the tree, because comments can be put everywhere and this would make the
> parser to complex. But how exactly do I tell my walker to look for tokens in
> the hidden channel or a self defined channel. Can someone give an example,
> because I really don't know where to begin or what syntax to use?
>
> "you can search within the start and stop tokens for the AST rule and find
> anything on channel 2, doing with it as you will."
>
> How and where exactly do I need to do this? In ANTLRv3Tree.g itself and if
> so with what syntax? Or is it done somewhere else in java code? I thought an
> AST rule didn't have a stop token, only start?
>
> An example what I'm trying to do:
> parsing of a grammar:             * r: INTEGER ; //comments*
> ANTLRv3.g makes a tree:       * (RULE r (BLOCK (ALT INTEGER EOA) EOB) EOR)
> *
> Now from this tree I reconstruct the grammar but I get      *  r: INTEGER
> ;     *thus the comments are gone.
> When I walk this tree in ANTLRv3Tree.g the rule "rule" is used. Should I
> add something to "rule" in ANTLRv3Tree.g?
>
> Sorry if this is a basic question, but an example would make things much
> clearer.
>
> Jens
>
> 2008/7/14 Jim Idle <jimi at temporal-wave.com>:
>
>>  On Mon, 2008-07-14 at 12:43 +0530, nilesh.kapile at tcs.com wrote:
>>
>>
>> Hello,
>>
>> I need to preserve comments and want to collect it in some data structure.
>>  How can we do that in ANTLR?
>>
>> Currently, I've following rule for comments:
>>
>> LINE_COMMENT
>>     :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;}
>>     ;
>>
>> The easiest way os to use your own channel, say 2, which means the parser
>> will ignore them but they are preserved in the input stream (actually they
>> are when HIDDEN but that really means 'anything you want to hide' and you
>> specifically want to inspect comments. Then, when you walk your tree
>> (assuming you are using a tree but that is best), at any point where the
>> comments are required, you can search within the start and stop tokens for
>> the AST rule and find anything on channel 2, doing with it as you will. You
>> can also do this from the parser of course.
>>
>> The other option is to pass the COMMENT token through as a normal token,
>> and create parser rules to assemble them at various points. The problem here
>> comes when the COMMENT can be anywhere, such as in the middle of
>> expressions, so the parser ends up having the COMMENT token everywhere and
>> complicates your grammar enormously.
>>
>> Jim
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080728/e80f09fd/attachment.html 

From thomas.woelfle at interactive-objects.com  Mon Jul 28 02:18:28 2008
From: thomas.woelfle at interactive-objects.com (Thomas Woelfle)
Date: Mon, 28 Jul 2008 11:18:28 +0200
Subject: [antlr-interest] Problem with semantic predicates
Message-ID: <488D8EE4.2070906@interactive-objects.com>

Hi,

I have to write a grammar for an existing language that allows keywords 
to be used as variables. I've been able to write most of the grammar 
using semantic predicates. But now I've been running into a problem 
where I don't know whether I'm using semantic predicates the wrong way 
or whether it is a bug in ANTLR. I have reduced the problem to the 
following grammar:


grammar foo;

options
{
    ASTLabelType = CommonTree;
    output = AST;
    language = Java;
}

master   
    :    foo
    |    bar
    |    blup
    ;
  
foo     :    {input.LT(1).getText().equals("FOO")}? IDENTIFIER LBRACE 
IDENTIFIER RBRACE
    ;
  
bar     :    {input.LT(1).getText().equals("BAR")}? IDENTIFIER (LBRACE 
IDENTIFIER RBRACE)?
    ;
  
blup     :    {input.LT(1).getText().equals("BLUP")}? IDENTIFIER
    ;

LBRACE     :    '(';
RBRACE    :    ')';
  
IDENTIFIER
    :    'A'..'Z'*;

The rules 'foo' and 'bar' are almost identical. The only differences are 
the semantic predicates and the fact that in the rule 'bar' the braced 
identifier is optional.
Evaluating a string "BAR(HI)" using this grammar starting with the rule 
'master' leads to an error since the rule 'foo' is chosen instead of 
rule 'bar'. Having a look at the generated JAVA code shows following logic:


    // $ANTLR start master
    // C:\\Temp\\foo.g:10:1: master : ( foo | bar | blup );
    public final master_return master() throws RecognitionException {
        master_return retval = new master_return();
        retval.start = input.LT(1);

        CommonTree root_0 = null;

        foo_return foo1 = null;

        bar_return bar2 = null;

        blup_return blup3 = null;

        try {
            // C:\\Temp\\foo.g:11:5: ( foo | bar | blup )
            int alt1=3;
            int LA1_0 = input.LA(1);

            if ( (LA1_0==IDENTIFIER) ) {
                int LA1_1 = input.LA(2);

                if ( (LA1_1==LBRACE) ) {
                    alt1=1;
                }
                else if ( (input.LT(1).getText().equals("BAR")) ) {
                    alt1=2;
                }
                else if ( (input.LT(1).getText().equals("BLUP")) ) {
                    alt1=3;
                }
                else {
                    NoViableAltException nvae =
                        new NoViableAltException("10:1: master : ( foo | 
bar | blup );", 1, 1, input);

                    throw nvae;
                }
            }
           ......


The first "if" checks whether the current token is an identifier. This 
is ok. But the next "if" statement checks whether the next token is a 
left brace. If true it decides for the sub rule "foo" without evaluating 
the semantic predicates. Is this a bug in ANTLR or am I using semantic 
predicates the wrong way?

Any help appreciated.

Regards,
Thomas

-- 
Interactive Objects Software GmbH
Basler Strasse 61
79100 Freiburg, Germany

Phone:  +49 761 400 73 0
mailto:thomas.woelfle at interactive-objects.com


------------------------------------------------------------------------

Interactive Objects' Legacy Modernization Solutions 

Get Your Applications SOA-Ready!

See http://www.interactive-objects.com/ for more information.

------------------------------------------------------------------------
 

Interactive Objects Software GmbH - Freiburg - Gesch?ftsf?hrer: Thomas Wager - AG Frbg. HRB 5810 - USt-IdNr. DE197983057


From jens.boeykens at gmail.com  Mon Jul 28 02:44:08 2008
From: jens.boeykens at gmail.com (Jens Boeykens)
Date: Mon, 28 Jul 2008 11:44:08 +0200
Subject: [antlr-interest] Preserving Comments
In-Reply-To: <53c4e43f0807280140r3a0203d8y86f7b238b559d5c8@mail.gmail.com>
References: <OFE700200C.48B49650-ON65257486.00274EA6-65257486.0027D9A0@tcs.com>
	<1216047270.26749.4.camel@jimi>
	<53c4e43f0807250307u772ca826l7bf81b33451d09b9@mail.gmail.com>
	<1225236951-1217097635-cardhu_decombobulator_blackberry.rim.net-965110274-@bxe008.bisx.prod.on.blackberry>
	<53c4e43f0807280140r3a0203d8y86f7b238b559d5c8@mail.gmail.com>
Message-ID: <53c4e43f0807280244r4dafc7a3mef9da48bf96dbcc5@mail.gmail.com>

Found a solution to get the comments in the template, but I'm not sure if it
is the recommended way.

alternative
@after {
  CommonTree t = $alternative.start;
  if(t.getTokenStopIndex() >= 0){
      int stop = t.getTokenStopIndex();
      CommonTokenStream tokens = (CommonTokenStream) input.getTokenStream();
      while(stop + 1 < tokens.size() && tokens.get(stop + 1).getLine() ==
tokens.get(t.getTokenStopIndex()).getLine())
          stop++;
      List<Token> comments = tokens.getTokens(t.getTokenStopIndex(), stop,
ANTLRv3Parser.SL_COMMENT);
      if(comments != null){
          retval.st.setAttribute("comment", comments.get(0).getText());
      }
  }
}
    :   ^(ALT (e+=element)+ EOA) -> alternative_elements(alt={$ALT},
element={$e}, eoa = {$EOA})
    |   ^(ALT EPSILON EOA)  -> alternative_epsilon(alt={$ALT},
epsilon={$EPSILON}, eoa = {$EOA})
    ;

2008/7/28 Jens Boeykens <jens.boeykens at gmail.com>

> I managed to print out some of the comments with this changed code in
> ANTLRv3Tree.g:
>
> alternative
> @after {
>   CommonTree t = $alternative.start;
>   int stop = t.getTokenStopIndex();
>   CommonTokenStream tokens = (CommonTokenStream) input.getTokenStream();
>   while(stop + 1 < tokens.size() && tokens.get(stop + 1).getLine() ==
> tokens.get(t.getTokenStopIndex()).getLine())
>         stop++;
>   List<Token> comments = tokens.getTokens(t.getTokenStopIndex(), stop,
> ANTLRv3Parser.SL_COMMENT);
>   for(Token i : comments)
>      System.out.println(i.getText());
> }
>     :   ^(ALT (e+=element)+ EOA) -> alternative_elements(alt={$ALT},
> element={$e}, eoa = {$EOA})
>     |   ^(ALT EPSILON EOA)  -> alternative_epsilon(alt={$ALT},
> epsilon={$EPSILON}, eoa = {$EOA})
>     ;
>
> This code looks for a comment after each alternative and prints it out. eg
> for input:
>
> grammar T;
> r : b // comm 1\n ;
> r1 : b // comm 2\n ;
>
> It prints out:
>
> // comm 1
>
> // comm 2
>
> But now I want to put these comments back in the outputgrammar. I assume
> this would imply adding some template code to insert the comment. But how
> exactly is this done?
>
>    - Do  I  need to  add  something  to the template rules
>    alternative_elements(alt={$ALT}, element={$e}, eoa = {$EOA}) and
>    alternative_epsilon(alt={$ALT}, epsilon={$EPSILON}, eoa = {$EOA})?
>    - If so will this work if the code is put in an @after action?
>    - Doing it this way implies that I have to change a lot of template
>    rules, which is not very handy.
>    - To recover all the comments this way, I have to put code in almost
>    every rule in ANTLRv3Tree.g to look for the tokens near the rule and check
>    if it is a comment. This kind of undoes the advantage of the hidden channel
>    that you do not have to include comments in the tree in order to keep the
>    parser simple. In fact now we would be moving all the complexity towards the
>    walker instead of the parser.
>    - Of course I could be looking at it the wrong way and I should recover
>    the comments a different way. If so can someone tell me how?
>
> Jens
>
> 2008/7/26 Jim Idle <jimi at temporal-wave.com>
>
>  Each node of the tree has start and stop tokens. If you getRange or get
>> tui can retrieve any token, on channel or not so use this at strategic
>> points in your tree grammar to get at comments.
>>
>> Jim
>>
>> Sent via BlackBerry from T-Mobile
>>
>> ------------------------------
>> *From*: "Jens Boeykens" <jens.boeykens at gmail.com>
>> *Date*: Fri, 25 Jul 2008 12:07:56 +0200
>> *To*: <antlr-interest at antlr.org>
>> *Subject*: Re: [antlr-interest] Preserving Comments
>> I want to do a similar thing. I'm using slightly adapted versions of
>> ANTLRv3.g <http://www.antlr.org/grammar/ANTLR/ANTLRv3.g> and
>> ANTLRv3Tree.g <http://www.antlr.org/grammar/ANTLR/ANTLRv3Tree.g> to
>> regenerate ANTLRv3 grammars. I have extended the walker (ANTLRv3Tree) with
>> template rewrite rules to regenerate the original antlr grammar, parsed with
>> antlrv3.g. It works great, except for the comments. These are placed in a
>> hidden channel and are not seen by the walker and thus not given to a
>> template rewrite rule. I realize it is not appropriate to place the comments
>> in the tree, because comments can be put everywhere and this would make the
>> parser to complex. But how exactly do I tell my walker to look for tokens in
>> the hidden channel or a self defined channel. Can someone give an example,
>> because I really don't know where to begin or what syntax to use?
>>
>> "you can search within the start and stop tokens for the AST rule and find
>> anything on channel 2, doing with it as you will."
>>
>> How and where exactly do I need to do this? In ANTLRv3Tree.g itself and if
>> so with what syntax? Or is it done somewhere else in java code? I thought an
>> AST rule didn't have a stop token, only start?
>>
>> An example what I'm trying to do:
>> parsing of a grammar:             * r: INTEGER ; //comments*
>> ANTLRv3.g makes a tree:       * (RULE r (BLOCK (ALT INTEGER EOA) EOB)
>> EOR)*
>> Now from this tree I reconstruct the grammar but I get      *  r: INTEGER
>> ;     *thus the comments are gone.
>> When I walk this tree in ANTLRv3Tree.g the rule "rule" is used. Should I
>> add something to "rule" in ANTLRv3Tree.g?
>>
>> Sorry if this is a basic question, but an example would make things much
>> clearer.
>>
>> Jens
>>
>> 2008/7/14 Jim Idle <jimi at temporal-wave.com>:
>>
>>>  On Mon, 2008-07-14 at 12:43 +0530, nilesh.kapile at tcs.com wrote:
>>>
>>>
>>> Hello,
>>>
>>> I need to preserve comments and want to collect it in some data
>>> structure.  How can we do that in ANTLR?
>>>
>>> Currently, I've following rule for comments:
>>>
>>> LINE_COMMENT
>>>     :  '//' ~('\n'|'\r')* '\r'? '\n'   {$channel=HIDDEN;}
>>>     ;
>>>
>>>  The easiest way os to use your own channel, say 2, which means the
>>> parser will ignore them but they are preserved in the input stream (actually
>>> they are when HIDDEN but that really means 'anything you want to hide' and
>>> you specifically want to inspect comments. Then, when you walk your tree
>>> (assuming you are using a tree but that is best), at any point where the
>>> comments are required, you can search within the start and stop tokens for
>>> the AST rule and find anything on channel 2, doing with it as you will. You
>>> can also do this from the parser of course.
>>>
>>> The other option is to pass the COMMENT token through as a normal token,
>>> and create parser rules to assemble them at various points. The problem here
>>> comes when the COMMENT can be anywhere, such as in the middle of
>>> expressions, so the parser ends up having the COMMENT token everywhere and
>>> complicates your grammar enormously.
>>>
>>> Jim
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080728/f5022cb9/attachment.html 

From jaluber at gmx.de  Mon Jul 28 03:13:42 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 28 Jul 2008 12:13:42 +0200
Subject: [antlr-interest] recombining tokens
In-Reply-To: <1217232195.3131.7.camel@tc35>
References: <1217232195.3131.7.camel@tc35>
Message-ID: <488D9BD6.5060200@gmx.de>

Davyd Madeley schrieb:
> Hi all,
> 
> I'm currently writing a grammar in which '/' is used to append a
> qualifier to a token. Unfortunately it is also used in path parameters.
> 
> I am trying to figure out how I can recombine tokens in the case where I
> determine I'm reading a path.
> 
> e.g.
> 
> // these are my token delimiters
> TOKEN
> 	: ~(','|'>'|'*'|'/'|'('|')'|LINE_TERMINATOR)+
> 	;
> 
> At one point in the state machine, I expect to be able to start reading
> parameters ('LINE' is a special token at the start of the file, but
> after that is just a regular token):
> 
> parameter
> 	: a=TOKEN	-> PARAMETER[$a]
> 	| a='LINE'	-> PARAMETER[$a]
> 	| path		-> ^(PATH path)
> 	;
> 
> path
> 	: ('/' TOKEN)+
> 	;
> 
> Every so often, a path will be provided. Currently this will be
> tokenised around the '/', which is undesirable.
> 
> e.g.
>       PATH (9) .......................... PATH
>         '/' (20) ........................ /
>         TOKEN (11) ...................... path
>         '/' (20) ........................ /
>         TOKEN (11) ...................... to
>         '/' (20) ........................ /
>         TOKEN (11) ...................... my.file
> 
> What I want to do is be able to recombine this into a
> PARAMETER["/path/to/my.file"].
> 
> Someone spoke about a concatenation operator, but I can't find any info
> about it.
> 
> Regards,
> --davyd
> 

The root cause of the problem is that the tokenizer is independent from 
the parser, so you can't decide without extra code in the lexer if a '/' 
belongs to a qualifier or a path. This approach means also to create a 
mini-parser, which may need more context information than a pure lexer 
can provide. It may be easier to recognize in a first pass the paths as 
a series of tokens and then to rewrite it into a single one. This 
approach means that you need an AST grammar.

Another question is if you truly need a single PATH token or if you can 
use the $path.text attribute instead. Depending on your needs this may 
still perform better than the other two approaches above.

Johannes

From ladam at vbi.vt.edu  Mon Jul 28 07:13:27 2008
From: ladam at vbi.vt.edu (Laura Adam)
Date: Mon, 28 Jul 2008 10:13:27 -0400 (EDT)
Subject: [antlr-interest] lexer : find every possibilities in a text
	(backtrack)
Message-ID: <163000196.1352991217254407492.JavaMail.root@zimbra>

Hello,
I would like the lexer to give me every possibilities there are to cut the text, following the rules I gave.
Rigth now I use backtrack and memoize. I found one solution while reading the text.
What should I work on? Should I rewrite some antlr functions?
Thanks,
Laura Adam

From rkevinburton at charter.net  Mon Jul 28 11:00:18 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 28 Jul 2008 11:00:18 -0700
Subject: [antlr-interest] ANTLRWorks preference location?
Message-ID: <20080728140018.NGI5T.134100.root@fepweb07>

All of the windows when I bring up ANTLRWorks are now displaying right. Is there a way to get back to the configuration before I messed it up. In other words I want all of the preferences that have taken effect to be removed. I am assuming that in order to do this I need to delete the file that contains the preferences. Unfortunately I cannot find that file. Any ideas?

Thank you.

Kevin

From lgcraymer at yahoo.com  Mon Jul 28 11:20:19 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 28 Jul 2008 11:20:19 -0700 (PDT)
Subject: [antlr-interest] Problem with semantic predicates
Message-ID: <348139.12543.qm@web55908.mail.re3.yahoo.com>

I would guess that you are using 3.0.1; somehow a critical line was commented out in that version that allows decisions with multiple sempreds (hoisted or otherwise).? Try using one of the 3.1 betas.
--Loring



----- Original Message ----
> From: Thomas Woelfle <thomas.woelfle at interactive-objects.com>
> To: antlr-interest at antlr.org
> Sent: Monday, July 28, 2008 2:18:28 AM
> Subject: [antlr-interest] Problem with semantic predicates
> 
> Hi,
> 
> I have to write a grammar for an existing language that allows keywords 
> to be used as variables. I've been able to write most of the grammar 
> using semantic predicates. But now I've been running into a problem 
> where I don't know whether I'm using semantic predicates the wrong way 
> or whether it is a bug in ANTLR. I have reduced the problem to the 
> following grammar:
> 
> 
> grammar foo;
> 
> options
> {
> ? ? ASTLabelType = CommonTree;
> ? ? output = AST;
> ? ? language = Java;
> }
> 
> master? 
> ? ? :? ? foo
> ? ? |? ? bar
> ? ? |? ? blup
> ? ? ;
> ? 
> foo? ? :? ? {input.LT(1).getText().equals("FOO")}? IDENTIFIER LBRACE 
> IDENTIFIER RBRACE
> ? ? ;
> ? 
> bar? ? :? ? {input.LT(1).getText().equals("BAR")}? IDENTIFIER (LBRACE 
> IDENTIFIER RBRACE)?
> ? ? ;
> ? 
> blup? ? :? ? {input.LT(1).getText().equals("BLUP")}? IDENTIFIER
> ? ? ;
> 
> LBRACE? ? :? ? '(';
> RBRACE? ? :? ? ')';
> ? 
> IDENTIFIER
> ? ? :? ? 'A'..'Z'*;
> 
> The rules 'foo' and 'bar' are almost identical. The only differences are 
> the semantic predicates and the fact that in the rule 'bar' the braced 
> identifier is optional.
> Evaluating a string "BAR(HI)" using this grammar starting with the rule 
> 'master' leads to an error since the rule 'foo' is chosen instead of 
> rule 'bar'. Having a look at the generated JAVA code shows following logic:
> 
> 
> ? ? // $ANTLR start master
> ? ? // C:\\Temp\\foo.g:10:1: master : ( foo | bar | blup );
> ? ? public final master_return master() throws RecognitionException {
> ? ? ? ? master_return retval = new master_return();
> ? ? ? ? retval.start = input.LT(1);
> 
> ? ? ? ? CommonTree root_0 = null;
> 
> ? ? ? ? foo_return foo1 = null;
> 
> ? ? ? ? bar_return bar2 = null;
> 
> ? ? ? ? blup_return blup3 = null;
> 
> ? ? ? ? try {
> ? ? ? ? ? ? // C:\\Temp\\foo.g:11:5: ( foo | bar | blup )
> ? ? ? ? ? ? int alt1=3;
> ? ? ? ? ? ? int LA1_0 = input.LA(1);
> 
> ? ? ? ? ? ? if ( (LA1_0==IDENTIFIER) ) {
> ? ? ? ? ? ? ? ? int LA1_1 = input.LA(2);
> 
> ? ? ? ? ? ? ? ? if ( (LA1_1==LBRACE) ) {
> ? ? ? ? ? ? ? ? ? ? alt1=1;
> ? ? ? ? ? ? ? ? }
> ? ? ? ? ? ? ? ? else if ( (input.LT(1).getText().equals("BAR")) ) {
> ? ? ? ? ? ? ? ? ? ? alt1=2;
> ? ? ? ? ? ? ? ? }
> ? ? ? ? ? ? ? ? else if ( (input.LT(1).getText().equals("BLUP")) ) {
> ? ? ? ? ? ? ? ? ? ? alt1=3;
> ? ? ? ? ? ? ? ? }
> ? ? ? ? ? ? ? ? else {
> ? ? ? ? ? ? ? ? ? ? NoViableAltException nvae =
> ? ? ? ? ? ? ? ? ? ? ? ? new NoViableAltException("10:1: master : ( foo | 
> bar | blup );", 1, 1, input);
> 
> ? ? ? ? ? ? ? ? ? ? throw nvae;
> ? ? ? ? ? ? ? ? }
> ? ? ? ? ? ? }
> ? ? ? ? ? ......
> 
> 
> The first "if" checks whether the current token is an identifier. This 
> is ok. But the next "if" statement checks whether the next token is a 
> left brace. If true it decides for the sub rule "foo" without evaluating 
> the semantic predicates. Is this a bug in ANTLR or am I using semantic 
> predicates the wrong way?
> 
> Any help appreciated.
> 
> Regards,
> Thomas
> 
> -- 
> Interactive Objects Software GmbH
> Basler Strasse 61
> 79100 Freiburg, Germany
> 
> Phone:? +49?761?400?73?0
> mailto:thomas.woelfle at interactive-objects.com
> 
> 
> ------------------------------------------------------------------------
> 
> Interactive Objects' Legacy Modernization Solutions 
> 
> Get Your Applications SOA-Ready!
> 
> See http://www.interactive-objects.com/ for more information.
> 
> ------------------------------------------------------------------------
> 
> 
> Interactive Objects Software GmbH - Freiburg - Gesch?ftsf?hrer: Thomas Wager - 
> AG Frbg. HRB 5810 - USt-IdNr. DE197983057



      

From jaluber at gmx.de  Mon Jul 28 11:27:01 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 28 Jul 2008 20:27:01 +0200
Subject: [antlr-interest] ANTLRWorks preference location?
In-Reply-To: <20080728140018.NGI5T.134100.root@fepweb07>
References: <20080728140018.NGI5T.134100.root@fepweb07>
Message-ID: <488E0F75.2060709@gmx.de>

rkevinburton at charter.net schrieb:
> All of the windows when I bring up ANTLRWorks are now displaying right. Is there a way to get back to the configuration before I messed it up. In other words I want all of the preferences that have taken effect to be removed. I am assuming that in order to do this I need to delete the file that contains the preferences. Unfortunately I cannot find that file. Any ideas?
> 
> Thank you.
> 
> Kevin
> 
Supposedly the preferences are located in the windows registry. Delete 
them there and that should reset them. It would help if there is a way 
to reset them via ANTLRworks.

Johannes

From rkevinburton at charter.net  Mon Jul 28 12:12:07 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 28 Jul 2008 12:12:07 -0700
Subject: [antlr-interest] No viable alternative.
Message-ID: <20080728151207.DE7D8.138711.root@fepweb09>

I am relatively new to ANTLR and so I decided to look at "modifying" some existing grammars and see what that gives me. I decided to start with a ECMAScript grammar from Xebic Research. The only change I made to it was to add types to the arguments to functions and have it generate C# code. It didn't work :-( The following function declaration works just fine:

function GetCatalogs(catalogContext:CatalogContext)
{
 var getCatalogs = catalogContext.GetCatalogs().Catalogs
}


BUt as soon as I add another variable declaration I get a NoViableAlt exception:

function GetCatalogs(catalogContext:CatalogContext)
{
 var getCatalogs = catalogContext.GetCatalogs().Catalogs
 var catalogResponseType = new CatalogDataSet()
}

Due to the size I will not try to reproduce the applicable rules here but I ran it under ANTLRWorks (Interpeter) and I received the same results. So if you need to test you could take the above function declaration (take out the argument type after the colon if you haven't modified the grammar to handle types) and you should get the same error (starting at functionDeclaration). Any ideas?

Thank you.

Kevin

From Fred.Brisard at ca.com  Mon Jul 28 12:18:50 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Mon, 28 Jul 2008 15:18:50 -0400
Subject: [antlr-interest] Constants in AST
Message-ID: <7D50572C73BC634F92EE211BFF16F4A10648E01A@USILMS12.ca.com>

Is there a simple way to insert constants into an AST?  It seems like
the operators require anything being inserted into an AST node to be
either a lexical token or a parser rule.  

I just want to put a simple constant in a node so that I can search on
it later.  Maybe that's a bad idea so it isn't supported.

I did notice that I could define fragment lexical tokens that could be
inserted.

Thanks for any clarification or suggestions.

Regards, Fred

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080728/52bca285/attachment.html 

From jaluber at gmx.de  Mon Jul 28 12:59:11 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 28 Jul 2008 21:59:11 +0200
Subject: [antlr-interest] Constants in AST
In-Reply-To: <7D50572C73BC634F92EE211BFF16F4A10648E01A@USILMS12.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A10648E01A@USILMS12.ca.com>
Message-ID: <488E250F.3070403@gmx.de>

Brisard, Fred D schrieb:
> Is there a simple way to insert constants into an AST?  It seems like 
> the operators require anything being inserted into an AST node to be 
> either a lexical token or a parser rule. 
> 
> I just want to put a simple constant in a node so that I can search on 
> it later.  Maybe that?s a bad idea so it isn?t supported.
> 
> I did notice that I could define fragment lexical tokens that could be 
> inserted.
> 
> Thanks for any clarification or suggestions.
> 
> Regards, Fred
> 
Did you try imaginary tokens? Those are defined in the tokens section 
like this:

tokens {
CONSTANT_2;
}

And they can be inserted like real tokens anywhere you need them.

Johannes

From antlr at mirality.co.nz  Mon Jul 28 14:00:16 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 29 Jul 2008 09:00:16 +1200
Subject: [antlr-interest] lexer : find every possibilities in a text
 (backtrack)
In-Reply-To: <163000196.1352991217254407492.JavaMail.root@zimbra>
References: <163000196.1352991217254407492.JavaMail.root@zimbra>
Message-ID: <20080728210022.29DE1352298@www.antlr.org>

At 02:13 29/07/2008, Laura Adam wrote:
 >I would like the lexer to give me every possibilities there are 
to
 >cut the text, following the rules I gave.
 >Rigth now I use backtrack and memoize. I found one solution 
while
 >reading the text.

ANTLR isn't really designed for that sort of thing (and 
backtracking and memoisation only apply to the parser, not the 
lexer).

You need to construct your lexer grammar in such a way that any 
given input leads to exactly one unambiguous token stream.  If 
your language structure is ambiguous then you'll need to either 
force longer lookahead with predicates or defer decisions until 
parse time (eg. accepting multiple types of tokens at certain 
points).


From antlr at mirality.co.nz  Mon Jul 28 14:03:04 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 29 Jul 2008 09:03:04 +1200
Subject: [antlr-interest] Constants in AST
In-Reply-To: <488E250F.3070403@gmx.de>
References: <7D50572C73BC634F92EE211BFF16F4A10648E01A@USILMS12.ca.com>
	<488E250F.3070403@gmx.de>
Message-ID: <20080728210309.53FF6352298@www.antlr.org>

At 07:59 29/07/2008, Johannes Luber wrote:
 >Did you try imaginary tokens? Those are defined in the tokens
 >section like this:
 >
 >tokens {
 >CONSTANT_2;
 >}

You can also do something like this:

tokens {
   CONSTANT;
}

...
   -> ^(A B CONSTANT["2"] C)
...


From rkevinburton at charter.net  Mon Jul 28 14:08:03 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 28 Jul 2008 14:08:03 -0700
Subject: [antlr-interest] ANTLRWorks preference location?
In-Reply-To: <488E0F75.2060709@gmx.de>
Message-ID: <20080728170803.MKQEO.141926.root@fepweb09>

Do you know where in the registry? I couldn't find ANTLR under HKLM or HKCU under Software.

Kevin
---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > All of the windows when I bring up ANTLRWorks are now displaying right. Is there a way to get back to the configuration before I messed it up. In other words I want all of the preferences that have taken effect to be removed. I am assuming that in order to do this I need to delete the file that contains the preferences. Unfortunately I cannot find that file. Any ideas?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> Supposedly the preferences are located in the windows registry. Delete 
> them there and that should reset them. It would help if there is a way 
> to reset them via ANTLRworks.
> 
> Johannes


From Fred.Brisard at ca.com  Mon Jul 28 14:10:38 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Mon, 28 Jul 2008 17:10:38 -0400
Subject: [antlr-interest] Constants in AST
In-Reply-To: <USILMS50b8Le5b2h6uB00009e37@mail11.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A10648E01A@USILMS12.ca.com>
	<488E250F.3070403@gmx.de>
	<USILMS50b8Le5b2h6uB00009e37@mail11.ca.com>
Message-ID: <7D50572C73BC634F92EE211BFF16F4A10648E11D@USILMS12.ca.com>

The "tokens section" solution was perfect.  

Thanks to all for suggesting it.

Regards, Fred


-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Monday, July 28, 2008 5:03 PM
To: Brisard, Fred D
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Constants in AST

At 07:59 29/07/2008, Johannes Luber wrote:
 >Did you try imaginary tokens? Those are defined in the tokens
 >section like this:
 >
 >tokens {
 >CONSTANT_2;
 >}

You can also do something like this:

tokens {
   CONSTANT;
}

...
   -> ^(A B CONSTANT["2"] C)
...



From antlr at mirality.co.nz  Mon Jul 28 14:22:04 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 29 Jul 2008 09:22:04 +1200
Subject: [antlr-interest] ANTLRWorks preference location?
In-Reply-To: <20080728170803.MKQEO.141926.root@fepweb09>
References: <488E0F75.2060709@gmx.de>
	<20080728170803.MKQEO.141926.root@fepweb09>
Message-ID: <20080728212211.6533B35229E@www.antlr.org>

At 09:08 29/07/2008, rkevinburton at charter.net wrote:
 >Do you know where in the registry? I couldn't find ANTLR under 
HKLM
 >or HKCU under Software.

Somebody already posted the path a few days ago.  Namely:

   HKEY_CURRENT_USER\Software\JavaSoft\Prefs\org\antlr\works


From rkevinburton at charter.net  Mon Jul 28 15:36:36 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Mon, 28 Jul 2008 15:36:36 -0700
Subject: [antlr-interest] Debugger
Message-ID: <20080728183636.MUN6N.789302.root@mp14>

I downloaded the JDK and now I am able to specify a javac path for ANTLRWorks. But, when I do (specify the debugger path) this I get a dialog error box that is bigger than my screen. I am not able to even see an OK button let alone click on it. And until I close this dialog box I have no access to ANTLRWorks. So essentially specifying the debugger locks up the ANTLRWorks tool.

Kevin

From cvrebert at gmail.com  Mon Jul 28 15:39:49 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Mon, 28 Jul 2008 15:39:49 -0700
Subject: [antlr-interest] No viable alternative.
In-Reply-To: <20080728151207.DE7D8.138711.root@fepweb09>
References: <20080728151207.DE7D8.138711.root@fepweb09>
Message-ID: <47c890dc0807281539l7adf55f5r22056d30abf275f0@mail.gmail.com>

Just a hunch, but what happens if you add a semicolon at the end of
the first "var" line?

On Mon, Jul 28, 2008 at 12:12 PM,  <rkevinburton at charter.net> wrote:
> I am relatively new to ANTLR and so I decided to look at "modifying" some existing grammars and see what that gives me. I decided to start with a ECMAScript grammar from Xebic Research. The only change I made to it was to add types to the arguments to functions and have it generate C# code. It didn't work :-( The following function declaration works just fine:
>
> function GetCatalogs(catalogContext:CatalogContext)
> {
>  var getCatalogs = catalogContext.GetCatalogs().Catalogs
> }
>
>
> BUt as soon as I add another variable declaration I get a NoViableAlt exception:
>
> function GetCatalogs(catalogContext:CatalogContext)
> {
>  var getCatalogs = catalogContext.GetCatalogs().Catalogs
>  var catalogResponseType = new CatalogDataSet()
> }
>
> Due to the size I will not try to reproduce the applicable rules here but I ran it under ANTLRWorks (Interpeter) and I received the same results. So if you need to test you could take the above function declaration (take out the argument type after the colon if you haven't modified the grammar to handle types) and you should get the same error (starting at functionDeclaration). Any ideas?
>
> Thank you.
>
> Kevin
>

From parrt at cs.usfca.edu  Mon Jul 28 16:28:20 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 28 Jul 2008 16:28:20 -0700
Subject: [antlr-interest] 3.1 final this weekend?
Message-ID: <03F67592-245F-4B0E-BDAB-8E6A8D9CE024@cs.usfca.edu>

Hi gang,

can we go 3.1 final this weekend?  Any major show stoppers?

Target developers: we ok for 3.1 final?

Terence

From rkevinburton at charter.net  Mon Jul 28 21:18:59 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Tue, 29 Jul 2008 0:18:59 -0400
Subject: [antlr-interest] No viable alternative.
In-Reply-To: <47c890dc0807281539l7adf55f5r22056d30abf275f0@mail.gmail.com>
Message-ID: <20080729001859.BJQOJ.151708.root@fepweb09>

Same problem. That is one of the first things that I tried. The grammer "auto-inserts" the semi. Whan I run it in the interpreter the presense or absence of the semi doesn't seem to affect the results.

Thank you.

Kevin
---- Chris Rebert <cvrebert at gmail.com> wrote: 
> Just a hunch, but what happens if you add a semicolon at the end of
> the first "var" line?
> 
> On Mon, Jul 28, 2008 at 12:12 PM,  <rkevinburton at charter.net> wrote:
> > I am relatively new to ANTLR and so I decided to look at "modifying" some existing grammars and see what that gives me. I decided to start with a ECMAScript grammar from Xebic Research. The only change I made to it was to add types to the arguments to functions and have it generate C# code. It didn't work :-( The following function declaration works just fine:
> >
> > function GetCatalogs(catalogContext:CatalogContext)
> > {
> >  var getCatalogs = catalogContext.GetCatalogs().Catalogs
> > }
> >
> >
> > BUt as soon as I add another variable declaration I get a NoViableAlt exception:
> >
> > function GetCatalogs(catalogContext:CatalogContext)
> > {
> >  var getCatalogs = catalogContext.GetCatalogs().Catalogs
> >  var catalogResponseType = new CatalogDataSet()
> > }
> >
> > Due to the size I will not try to reproduce the applicable rules here but I ran it under ANTLRWorks (Interpeter) and I received the same results. So if you need to test you could take the above function declaration (take out the argument type after the colon if you haven't modified the grammar to handle types) and you should get the same error (starting at functionDeclaration). Any ideas?
> >
> > Thank you.
> >
> > Kevin
> >


From varun.bhargava at carsales.com.au  Tue Jul 29 01:46:20 2008
From: varun.bhargava at carsales.com.au (Varun Bhargava)
Date: Tue, 29 Jul 2008 18:46:20 +1000
Subject: [antlr-interest] Print an AST in original order
Message-ID: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>

Hi All,

 

I'm using ANTLR3 for C# target. My problem is to load up a statement
into a tree, so some substitutions to the tree and then print out the
tree in original order to re-generate the input statement but with some
substitutions.

 

I cannot seem to print the AST in its original order. For EG;

 

          WHERE

              |

             AND

           /       \

        =           =

      /   \        /  \

     A    5      b    10

 

 

The above tree should be printed as WHERE A=5 AND b = 10

 

However this is not the case in ANTLR. Has anyone done this before? If
yes could you please point me in the right direction or give me some
sample code?

 

Thanks

Varun

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080729/2518d2df/attachment.html 

From pink at odahoda.de  Tue Jul 29 03:08:46 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Tue, 29 Jul 2008 12:08:46 +0200
Subject: [antlr-interest] 3.1 final this weekend?
In-Reply-To: <03F67592-245F-4B0E-BDAB-8E6A8D9CE024@cs.usfca.edu>
References: <03F67592-245F-4B0E-BDAB-8E6A8D9CE024@cs.usfca.edu>
Message-ID: <543531490807290308l3201f9ebu8fd72053b25c3c28@mail.gmail.com>

Hi Ter,

On Tue, Jul 29, 2008 at 1:28 AM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi gang,
>
> can we go 3.1 final this weekend?  Any major show stoppers?
>
> Target developers: we ok for 3.1 final?

There's a bit of work to catch up for the Python target, but next
weekend sounds good - I have some free time at hand that I want to use
for ANTLR.

-Ben

From r_reitzi at cs.uni-kl.de  Tue Jul 29 06:03:21 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Tue, 29 Jul 2008 15:03:21 +0200
Subject: [antlr-interest] How to generate code files
	for	treeGrammarFileName.g?
In-Reply-To: <20080728053626.89B473D7464@mail3-147.sinamail.sina.com.cn>
References: <20080728053626.89B473D7464@mail3-147.sinamail.sina.com.cn>
Message-ID: <20080729150321.15354xcnu0n1kum8@horde.verrech.net>

Hi!

I fear a tree walker makes no sense without any tree, so you'll need a  
parser to generate a tree. The parser again needs a lexer. You should  
have both.

Regards

Raphael

cokey5614 at sina.com wrote (Mon Jul 28 07:36:26 2008):

> &nbsp;Hi,
> I created treeGrammarFileName.g file(it is started with [tree  
> grammar fileName]) and treeGrammarFileNameWalker.testSuite file in  
> source folder, and then
> tried the command :
> &nbsp;&nbsp;&nbsp; org.antlr.gunit.Interp treeGrammarFileNameWalker.testSuite
> but,error{
> &nbsp;&nbsp;&nbsp; java.lang.ClassNOtFoundException:treeGrammarFileNameLexer
> &nbsp;&nbsp;&nbsp; at java.net.URLClassLoader$1.run(Unknown Source)
> } always happen.
> in fact, in source folder, there are only treeGrammarFileName.java  
> and treeGrammarFileName.class ,
> there is no treeGrammarFileNameLexer.java file.
> but, It seems that treeGrammarFileNameLexer.java and  
> treeGrammarFileNameParser.java are necessary too.
> Q:How to generate [ treeGrammarFileNameLexer.java and  
> treeGrammarFileNameParser.java] code files for treeGrammarFileName.g?
>
> thanks
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
> cokey
>
> -------------------------------------------------------------------
> ????2G????(http://mail.sina.com.cn/)



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080729/ba05e943/attachment.bin 

From parrt at cs.usfca.edu  Tue Jul 29 09:36:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 29 Jul 2008 09:36:26 -0700
Subject: [antlr-interest] 3.1 final this weekend?
In-Reply-To: <543531490807290308l3201f9ebu8fd72053b25c3c28@mail.gmail.com>
References: <03F67592-245F-4B0E-BDAB-8E6A8D9CE024@cs.usfca.edu>
	<543531490807290308l3201f9ebu8fd72053b25c3c28@mail.gmail.com>
Message-ID: <25493221-6A02-4C56-A475-DB80FC8AE5D6@cs.usfca.edu>

awesome
Ter
On Jul 29, 2008, at 3:08 AM, Benjamin Niemann wrote:

> Hi Ter,
>
> On Tue, Jul 29, 2008 at 1:28 AM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
>> Hi gang,
>>
>> can we go 3.1 final this weekend?  Any major show stoppers?
>>
>> Target developers: we ok for 3.1 final?
>
> There's a bit of work to catch up for the Python target, but next
> weekend sounds good - I have some free time at hand that I want to use
> for ANTLR.
>
> -Ben


From cummings at kjchome.homeip.net  Tue Jul 29 10:13:28 2008
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Tue, 29 Jul 2008 13:13:28 -0400
Subject: [antlr-interest] Print an AST in original order
In-Reply-To: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
References: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
Message-ID: <488F4FB8.9090505@kjchome.homeip.net>

Varun Bhargava wrote:
> Hi All,
> 
> I?m using ANTLR3 for C# target. My problem is to load up a statement 
> into a tree, so some substitutions to the tree and then print out the 
> tree in original order to re-generate the input statement but with some 
> substitutions.
> 
> I cannot seem to print the AST in its original order. For EG;
> 
>           WHERE
> 
>               |
> 
>              AND
> 
>            /       \
> 
>         =           =
> 
>       /   \        /  \
> 
>      A    5      b    10

Doesn't your tree actually look like this:?

WHERE
   |
  AND
   |
   = ------=
   |       |
   A - 5   b - 10

I think your problem comes in how you are interpreting your 
root/children associations.  Insert your root between binary children, 
or before a unary subtree (as if there is no LHS).  It seems to work for 
this example....

> The above tree should be printed as WHERE A=5 AND b = 10
> 
> However this is not the case in ANTLR. Has anyone done this before? If 
> yes could you please point me in the right direction or give me some 
> sample code?

What are you using to do this with?

> Thanks
> 
> Varun

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From vitaka at gmail.com  Tue Jul 29 10:53:28 2008
From: vitaka at gmail.com (=?ISO-8859-1?Q?V=EDctor_Manuel_S=E1nchez_Cartagena?=)
Date: Tue, 29 Jul 2008 19:53:28 +0200
Subject: [antlr-interest] Bug in ANTLRv3.g
Message-ID: <e77e34270807291053l4349c4f1jd46a2452583f707c@mail.gmail.com>

I think I have found a bug in the ANTLRv3.g grammar.
I build the lexer and the parser with ANTLR, and when I try to parse the
following grammar, it fails, although the grammar is correct.

grammar plp2;
@members {
  public String refactor_rename_this;
  public String refactor_rename_to;
}
s returns [String value]
    :
                // It doesn't fail:
                 c["aa"]
                // It fails:
                //c[""]
    ;
c[String ambito] returns [String value]
    :    'class' ID
        {
                     // It doesn't fail:
                      $value= "class " + $ID.text + " n;" + "{}n";
                     // It fails:
                     // $value= "class " + $ID.text + " n;" + "}n";
                }
    ;
ID    :    ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9')*
    ;
ENTERO    :    ('0'..'9')+
    ;

Could anyone help me to find out what's wrong in ANTLRv3.g?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080729/180c1b28/attachment.html 

From parrt at cs.usfca.edu  Tue Jul 29 12:53:46 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 29 Jul 2008 12:53:46 -0700
Subject: [antlr-interest] Bug in ANTLRv3.g
In-Reply-To: <e77e34270807291053l4349c4f1jd46a2452583f707c@mail.gmail.com>
References: <e77e34270807291053l4349c4f1jd46a2452583f707c@mail.gmail.com>
Message-ID: <EBBA3754-3090-4FFD-87DF-0DB68565D060@cs.usfca.edu>

Ooops. change rule

fragment
ACTION_STRING_LITERAL
	:	'"' (ACTION_ESC|~('\\'|'"'))* '"'
	;

+ to *

Ter

On Jul 29, 2008, at 10:53 AM, V?ctor Manuel S?nchez Cartagena wrote:

> I think I have found a bug in the ANTLRv3.g grammar.
> I build the lexer and the parser with ANTLR, and when I try to parse  
> the  following grammar, it fails, although the grammar is correct.
>
> grammar plp2;
> @members {
>   public String refactor_rename_this;
>   public String refactor_rename_to;
> }
> s returns [String value]
>     :
>                 // It doesn't fail:
>                  c["aa"]
>                 // It fails:
>                 //c[""]
>     ;
> c[String ambito] returns [String value]
>     :    'class' ID
>         {
>                      // It doesn't fail:
>                       $value= "class " + $ID.text + " n;" + "{}n";
>                      // It fails:
>                      // $value= "class " + $ID.text + " n;" + "}n";
>                 }
>     ;
> ID    :    ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9')*
>     ;
> ENTERO    :    ('0'..'9')+
>     ;
>
> Could anyone help me to find out what's wrong in ANTLRv3.g?


From kroizguy at gmail.com  Tue Jul 29 13:15:13 2008
From: kroizguy at gmail.com (Guy Kroizman)
Date: Tue, 29 Jul 2008 23:15:13 +0300
Subject: [antlr-interest] vim syntax highlight
Message-ID: <f5c59b030807291315gfee0a7s91e19ff8cd58bf2b@mail.gmail.com>

Hi everybody.
I am using vim and it syntax highlight my combined grammar files fine, but
not my fuzzy lexer file.
any idea why? or what file should I check?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080729/e51543f6/attachment.html 

From antlr at mirality.co.nz  Tue Jul 29 14:02:26 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 30 Jul 2008 09:02:26 +1200
Subject: [antlr-interest] Print an AST in original order
In-Reply-To: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsal
	es.office>
References: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
Message-ID: <20080729210230.7F7CC11EC4A@www.antlr.org>

At 20:46 29/07/2008, Varun Bhargava wrote:
>I cannot seem to print the AST in its original order. For EG;
>
>           WHERE
>               |
>              AND
>            /       \
>         =           =
>       /   \        /  \
>      A    5      b    10
>
>
>The above tree should be printed as WHERE A=5 AND b = 10
>
>However this is not the case in ANTLR. Has anyone done this 
>before? If yes could you please point me in the right direction 
>or give me some sample code?

Apart from the initial WHERE node, what you're describing is just 
a basic in-order traversal of the tree (print left child, print 
root, print right child).  (Although generally speaking unless you 
do something clever you'll have to insert extra parentheses in 
your output, to preserve precedence for other examples of trees.)

It's fairly trivial to write code to do this sort of thing 
directly; alternatively, you could probably use a tree-walker 
grammar and either direct code or StringTemplate to generate your 
output.


From vitaka at gmail.com  Tue Jul 29 14:33:09 2008
From: vitaka at gmail.com (=?ISO-8859-1?Q?V=EDctor_Manuel_S=E1nchez_Cartagena?=)
Date: Tue, 29 Jul 2008 23:33:09 +0200
Subject: [antlr-interest] Bug in ANTLRv3.g
In-Reply-To: <EBBA3754-3090-4FFD-87DF-0DB68565D060@cs.usfca.edu>
References: <e77e34270807291053l4349c4f1jd46a2452583f707c@mail.gmail.com>
	<EBBA3754-3090-4FFD-87DF-0DB68565D060@cs.usfca.edu>
Message-ID: <e77e34270807291433h29e75d4eqa105f002d35101e6@mail.gmail.com>

Thank you very much. I changed the rule and now it doesn't fail in: c[""]
But it still fails in: $value= "class " + $ID.text + " n;" + "}n";

In fact, ANTLR gives an error in every string that starts with }.

In this case, I get the following output:

line 26:0 mismatched character '<EOF>' expecting '"'
line 19:62 no viable alternative at input 'n'
BR.recoverFromMismatchedToken


2008/7/29 Terence Parr <parrt at cs.usfca.edu>

> Ooops. change rule
>
> fragment
> ACTION_STRING_LITERAL
>        :       '"' (ACTION_ESC|~('\\'|'"'))* '"'
>        ;
>
> + to *
>
> Ter
>
>
> On Jul 29, 2008, at 10:53 AM, V?ctor Manuel S?nchez Cartagena wrote:
>
>  I think I have found a bug in the ANTLRv3.g grammar.
>> I build the lexer and the parser with ANTLR, and when I try to parse the
>>  following grammar, it fails, although the grammar is correct.
>>
>> grammar plp2;
>> @members {
>>  public String refactor_rename_this;
>>  public String refactor_rename_to;
>> }
>> s returns [String value]
>>    :
>>                // It doesn't fail:
>>                 c["aa"]
>>                // It fails:
>>                //c[""]
>>    ;
>> c[String ambito] returns [String value]
>>    :    'class' ID
>>        {
>>                     // It doesn't fail:
>>                      $value= "class " + $ID.text + " n;" + "{}n";
>>                     // It fails:
>>                     // $value= "class " + $ID.text + " n;" + "}n";
>>                }
>>    ;
>> ID    :    ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9')*
>>    ;
>> ENTERO    :    ('0'..'9')+
>>    ;
>>
>> Could anyone help me to find out what's wrong in ANTLRv3.g?
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080729/4e8534cd/attachment.html 

From parrt at cs.usfca.edu  Tue Jul 29 15:35:06 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 29 Jul 2008 15:35:06 -0700
Subject: [antlr-interest] Bug in ANTLRv3.g
In-Reply-To: <e77e34270807291433h29e75d4eqa105f002d35101e6@mail.gmail.com>
References: <e77e34270807291053l4349c4f1jd46a2452583f707c@mail.gmail.com>
	<EBBA3754-3090-4FFD-87DF-0DB68565D060@cs.usfca.edu>
	<e77e34270807291433h29e75d4eqa105f002d35101e6@mail.gmail.com>
Message-ID: <08C59DF2-A769-43FD-A6CA-CED2121A13E3@cs.usfca.edu>

ooops. try this:

ragment
NESTED_ACTION :
	'{'
	(	options {greedy=false; k=2;}
	:	NESTED_ACTION
	|	SL_COMMENT
	|	ML_COMMENT
	|	ACTION_STRING_LITERAL
	|	ACTION_CHAR_LITERAL
	|	.
	)*
	'}'
    ;
Ter
On Jul 29, 2008, at 2:33 PM, V?ctor Manuel S?nchez Cartagena wrote:

> Thank you very much. I changed the rule and now it doesn't fail in:  
> c[""]
> But it still fails in: $value= "class " + $ID.text + " n;" + "}n";
>
> In fact, ANTLR gives an error in every string that starts with }.
>
> In this case, I get the following output:
>
> line 26:0 mismatched character '<EOF>' expecting '"'
> line 19:62 no viable alternative at input 'n'
> BR.recoverFromMismatchedToken
>
>
> 2008/7/29 Terence Parr <parrt at cs.usfca.edu>
> Ooops. change rule
>
> fragment
> ACTION_STRING_LITERAL
>        :       '"' (ACTION_ESC|~('\\'|'"'))* '"'
>        ;
>
> + to *
>
> Ter
>
>
> On Jul 29, 2008, at 10:53 AM, V?ctor Manuel S?nchez Cartagena wrote:
>
> I think I have found a bug in the ANTLRv3.g grammar.
> I build the lexer and the parser with ANTLR, and when I try to parse  
> the  following grammar, it fails, although the grammar is correct.
>
> grammar plp2;
> @members {
>  public String refactor_rename_this;
>  public String refactor_rename_to;
> }
> s returns [String value]
>    :
>                // It doesn't fail:
>                 c["aa"]
>                // It fails:
>                //c[""]
>    ;
> c[String ambito] returns [String value]
>    :    'class' ID
>        {
>                     // It doesn't fail:
>                      $value= "class " + $ID.text + " n;" + "{}n";
>                     // It fails:
>                     // $value= "class " + $ID.text + " n;" + "}n";
>                }
>    ;
> ID    :    ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9')*
>    ;
> ENTERO    :    ('0'..'9')+
>    ;
>
> Could anyone help me to find out what's wrong in ANTLRv3.g?
>
>


From varun.bhargava at carsales.com.au  Tue Jul 29 18:25:01 2008
From: varun.bhargava at carsales.com.au (Varun Bhargava)
Date: Wed, 30 Jul 2008 11:25:01 +1000
Subject: [antlr-interest] Print an AST in original order
In-Reply-To: <488F4FB8.9090505@kjchome.homeip.net>
References: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
	<488F4FB8.9090505@kjchome.homeip.net>
Message-ID: <AE0A511AB227724A912139BAF4BBAC7103EE20AF@cssvrex001.carsales.office>

Hi Kevin,

Thanks for replying. I'm using ANTLR for the first time and an absolute
beginner to Parsing stuff, so my apologies if I ask stupid questions.

Firstly, you are right. The tree does look as you mentioned. 
To print the tree I am using the ToStringTree() method of the CommonTree
class.

How do I insert the root between binary children? Here is the snippet
from my grammar file:

where	
	: 
	| WHERE^ filter 
	;

filter
	: //(key compare literal | key IS NOT? NULL | keyList IN key |
NOT filter | LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
	(compareFilter | notNullFilter | keyListFilter | NOT filter |
LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
	;

compareFilter 
	:	
	key compare (literal | PARAMETER)
	;
	
notNullFilter
	:
	key IS NOT? NULL
	;
	
keyListFilter
	:
	keyList IN key
	;
			
keyList
	: key (COMMA keyList)*	
	;

compare
	: EQ | NOTEQ | LT | GT | LTE | GTE



Thanks
Varun



-----Original Message-----
From: Kevin J. Cummings [mailto:cummings at kjchome.homeip.net] 
Sent: Wednesday, 30 July 2008 03:13
To: Varun Bhargava
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Print an AST in original order

Varun Bhargava wrote:
> Hi All,
> 
> I'm using ANTLR3 for C# target. My problem is to load up a statement 
> into a tree, so some substitutions to the tree and then print out the 
> tree in original order to re-generate the input statement but with
some 
> substitutions.
> 
> I cannot seem to print the AST in its original order. For EG;
> 
>           WHERE
> 
>               |
> 
>              AND
> 
>            /       \
> 
>         =           =
> 
>       /   \        /  \
> 
>      A    5      b    10

Doesn't your tree actually look like this:?

WHERE
   |
  AND
   |
   = ------=
   |       |
   A - 5   b - 10

I think your problem comes in how you are interpreting your 
root/children associations.  Insert your root between binary children, 
or before a unary subtree (as if there is no LHS).  It seems to work for

this example....

> The above tree should be printed as WHERE A=5 AND b = 10
> 
> However this is not the case in ANTLR. Has anyone done this before? If

> yes could you please point me in the right direction or give me some 
> sample code?

What are you using to do this with?

> Thanks
> 
> Varun

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From cummings at kjchome.homeip.net  Tue Jul 29 18:45:06 2008
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Tue, 29 Jul 2008 21:45:06 -0400
Subject: [antlr-interest] Print an AST in original order
In-Reply-To: <AE0A511AB227724A912139BAF4BBAC7103EE20AF@cssvrex001.carsales.office>
References: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
	<488F4FB8.9090505@kjchome.homeip.net>
	<AE0A511AB227724A912139BAF4BBAC7103EE20AF@cssvrex001.carsales.office>
Message-ID: <488FC7A2.1080707@kjchome.homeip.net>

Varun Bhargava wrote:
> Hi Kevin,
> 
> Thanks for replying. I'm using ANTLR for the first time and an absolute
> beginner to Parsing stuff, so my apologies if I ask stupid questions.
> 
> Firstly, you are right. The tree does look as you mentioned. 
> To print the tree I am using the ToStringTree() method of the CommonTree
> class.

The ToStringTree() method is geared towards parenthesized lists 
(LISP-like) trees.  If you want to get text back out of the built trees, 
you will need to do what Gavin suggested, and write a simple tree-walker 
to produce what you need.

> How do I insert the root between binary children? Here is the snippet
> from my grammar file:
> 
> where	
> 	: 
> 	| WHERE^ filter 
> 	;
> 
> filter
> 	: //(key compare literal | key IS NOT? NULL | keyList IN key |
> NOT filter | LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
> 	(compareFilter | notNullFilter | keyListFilter | NOT filter |
> LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
> 	;
> 
> compareFilter 
> 	:	
> 	key compare (literal | PARAMETER)
> 	;
> 	
> notNullFilter
> 	:
> 	key IS NOT? NULL
> 	;
> 	
> keyListFilter
> 	:
> 	keyList IN key
> 	;
> 			
> keyList
> 	: key (COMMA keyList)*	
> 	;
> 
> compare
> 	: EQ | NOTEQ | LT | GT | LTE | GTE

You are looking at the parser.  That's the wrong place.  After you 
create a tree, you want to "uncreate" it.  You will need rules in a 
tree-walker that understand *your* grammar.  It will need to know which 
operators are unary, and which are binary.  Further, it will need to 
know which of your unary operators are prefix and which are postfix 
(WHERE looks like a prefix notation).

I have often used the ToStringTree() to look at my parsed trees because 
it shows me what the parser did, and I can see whether or not they are 
correct.

> Thanks
> Varun

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From varun.bhargava at carsales.com.au  Tue Jul 29 19:24:20 2008
From: varun.bhargava at carsales.com.au (Varun Bhargava)
Date: Wed, 30 Jul 2008 12:24:20 +1000
Subject: [antlr-interest] Print an AST in original order
In-Reply-To: <488FC7A2.1080707@kjchome.homeip.net>
References: <AE0A511AB227724A912139BAF4BBAC7103E40F8E@cssvrex001.carsales.office>
	<488F4FB8.9090505@kjchome.homeip.net>
	<AE0A511AB227724A912139BAF4BBAC7103EE20AF@cssvrex001.carsales.office>
	<488FC7A2.1080707@kjchome.homeip.net>
Message-ID: <AE0A511AB227724A912139BAF4BBAC7103EE218C@cssvrex001.carsales.office>

Thanks for pointing me in the right direction Kevin.

I'll look at the ANTLR reference.

Regards
Varun

-----Original Message-----
From: Kevin J. Cummings [mailto:cummings at kjchome.homeip.net] 
Sent: Wednesday, 30 July 2008 11:45
To: Varun Bhargava
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Print an AST in original order

Varun Bhargava wrote:
> Hi Kevin,
> 
> Thanks for replying. I'm using ANTLR for the first time and an
absolute
> beginner to Parsing stuff, so my apologies if I ask stupid questions.
> 
> Firstly, you are right. The tree does look as you mentioned. 
> To print the tree I am using the ToStringTree() method of the
CommonTree
> class.

The ToStringTree() method is geared towards parenthesized lists 
(LISP-like) trees.  If you want to get text back out of the built trees,

you will need to do what Gavin suggested, and write a simple tree-walker

to produce what you need.

> How do I insert the root between binary children? Here is the snippet
> from my grammar file:
> 
> where	
> 	: 
> 	| WHERE^ filter 
> 	;
> 
> filter
> 	: //(key compare literal | key IS NOT? NULL | keyList IN key |
> NOT filter | LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
> 	(compareFilter | notNullFilter | keyListFilter | NOT filter |
> LPAREN filter RPAREN) (AND^ filter | OR^ filter)*
> 	;
> 
> compareFilter 
> 	:	
> 	key compare (literal | PARAMETER)
> 	;
> 	
> notNullFilter
> 	:
> 	key IS NOT? NULL
> 	;
> 	
> keyListFilter
> 	:
> 	keyList IN key
> 	;
> 			
> keyList
> 	: key (COMMA keyList)*	
> 	;
> 
> compare
> 	: EQ | NOTEQ | LT | GT | LTE | GTE

You are looking at the parser.  That's the wrong place.  After you 
create a tree, you want to "uncreate" it.  You will need rules in a 
tree-walker that understand *your* grammar.  It will need to know which 
operators are unary, and which are binary.  Further, it will need to 
know which of your unary operators are prefix and which are postfix 
(WHERE looks like a prefix notation).

I have often used the ToStringTree() to look at my parsed trees because 
it shows me what the parser did, and I can see whether or not they are 
correct.

> Thanks
> Varun

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From varun.bhargava at carsales.com.au  Tue Jul 29 22:01:16 2008
From: varun.bhargava at carsales.com.au (Varun Bhargava)
Date: Wed, 30 Jul 2008 15:01:16 +1000
Subject: [antlr-interest] Grammar problem
Message-ID: <AE0A511AB227724A912139BAF4BBAC7103EE2391@cssvrex001.carsales.office>

Dear All,

 

I have written an antlr3 grammar using ANTLRWorks. 

 

When I use the 'Check Grammar' feature, ANTLRWorks reports no errors but
the IDE reports all sorts of errors when trying to view the diagram for
all the rules in the Interpreter.

 

Can someone please help me figure out what may be wrong? I have attached
my grammar for reference.

 

Thanks

Varun 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/fd7fbdf1/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Analytics.g
Type: application/octet-stream
Size: 7558 bytes
Desc: Analytics.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/fd7fbdf1/attachment.obj 

From thomas.woelfle at interactive-objects.com  Tue Jul 29 22:24:36 2008
From: thomas.woelfle at interactive-objects.com (Thomas Woelfle)
Date: Wed, 30 Jul 2008 07:24:36 +0200
Subject: [antlr-interest] Problem with semantic predicates
In-Reply-To: <348139.12543.qm@web55908.mail.re3.yahoo.com>
References: <348139.12543.qm@web55908.mail.re3.yahoo.com>
Message-ID: <488FFB14.5040009@interactive-objects.com>

Hi Loring,

thanks for the tip. I'll try it with version 3.1

Regards,
Thomas
> I would guess that you are using 3.0.1; somehow a critical line was commented out in that version that allows decisions with multiple sempreds (hoisted or otherwise).  Try using one of the 3.1 betas.
> --Loring
>
>
>
> ----- Original Message ----
>   
>> From: Thomas Woelfle <thomas.woelfle at interactive-objects.com>
>> To: antlr-interest at antlr.org
>> Sent: Monday, July 28, 2008 2:18:28 AM
>> Subject: [antlr-interest] Problem with semantic predicates
>>
>> Hi,
>>
>> I have to write a grammar for an existing language that allows keywords 
>> to be used as variables. I've been able to write most of the grammar 
>> using semantic predicates. But now I've been running into a problem 
>> where I don't know whether I'm using semantic predicates the wrong way 
>> or whether it is a bug in ANTLR. I have reduced the problem to the 
>> following grammar:
>>
>>
>> grammar foo;
>>
>> options
>> {
>>     ASTLabelType = CommonTree;
>>     output = AST;
>>     language = Java;
>> }
>>
>> master  
>>     :    foo
>>     |    bar
>>     |    blup
>>     ;
>>   
>> foo    :    {input.LT(1).getText().equals("FOO")}? IDENTIFIER LBRACE 
>> IDENTIFIER RBRACE
>>     ;
>>   
>> bar    :    {input.LT(1).getText().equals("BAR")}? IDENTIFIER (LBRACE 
>> IDENTIFIER RBRACE)?
>>     ;
>>   
>> blup    :    {input.LT(1).getText().equals("BLUP")}? IDENTIFIER
>>     ;
>>
>> LBRACE    :    '(';
>> RBRACE    :    ')';
>>   
>> IDENTIFIER
>>     :    'A'..'Z'*;
>>
>> The rules 'foo' and 'bar' are almost identical. The only differences are 
>> the semantic predicates and the fact that in the rule 'bar' the braced 
>> identifier is optional.
>> Evaluating a string "BAR(HI)" using this grammar starting with the rule 
>> 'master' leads to an error since the rule 'foo' is chosen instead of 
>> rule 'bar'. Having a look at the generated JAVA code shows following logic:
>>
>>
>>     // $ANTLR start master
>>     // C:\\Temp\\foo.g:10:1: master : ( foo | bar | blup );
>>     public final master_return master() throws RecognitionException {
>>         master_return retval = new master_return();
>>         retval.start = input.LT(1);
>>
>>         CommonTree root_0 = null;
>>
>>         foo_return foo1 = null;
>>
>>         bar_return bar2 = null;
>>
>>         blup_return blup3 = null;
>>
>>         try {
>>             // C:\\Temp\\foo.g:11:5: ( foo | bar | blup )
>>             int alt1=3;
>>             int LA1_0 = input.LA(1);
>>
>>             if ( (LA1_0==IDENTIFIER) ) {
>>                 int LA1_1 = input.LA(2);
>>
>>                 if ( (LA1_1==LBRACE) ) {
>>                     alt1=1;
>>                 }
>>                 else if ( (input.LT(1).getText().equals("BAR")) ) {
>>                     alt1=2;
>>                 }
>>                 else if ( (input.LT(1).getText().equals("BLUP")) ) {
>>                     alt1=3;
>>                 }
>>                 else {
>>                     NoViableAltException nvae =
>>                         new NoViableAltException("10:1: master : ( foo | 
>> bar | blup );", 1, 1, input);
>>
>>                     throw nvae;
>>                 }
>>             }
>>           ......
>>
>>
>> The first "if" checks whether the current token is an identifier. This 
>> is ok. But the next "if" statement checks whether the next token is a 
>> left brace. If true it decides for the sub rule "foo" without evaluating 
>> the semantic predicates. Is this a bug in ANTLR or am I using semantic 
>> predicates the wrong way?
>>
>> Any help appreciated.
>>
>> Regards,
>> Thomas
>>
>> -- 
>> Interactive Objects Software GmbH
>> Basler Strasse 61
>> 79100 Freiburg, Germany
>>
>> Phone:  +49 761 400 73 0
>> mailto:thomas.woelfle at interactive-objects.com
>>
>>
>> ------------------------------------------------------------------------
>>
>> Interactive Objects' Legacy Modernization Solutions 
>>
>> Get Your Applications SOA-Ready!
>>
>> See http://www.interactive-objects.com/ for more information.
>>
>> ------------------------------------------------------------------------
>>
>>
>> Interactive Objects Software GmbH - Freiburg - Gesch?ftsf?hrer: Thomas Wager - 
>> AG Frbg. HRB 5810 - USt-IdNr. DE197983057
>>     
>
>
>
>       
>   


-- 
Interactive Objects Software GmbH
Basler Strasse 61
79100 Freiburg, Germany

Phone:  +49 761 400 73 0
mailto:thomas.woelfle at interactive-objects.com


------------------------------------------------------------------------

Interactive Objects' Legacy Modernization Solutions 

Get Your Applications SOA-Ready!

See http://www.interactive-objects.com/ for more information.

------------------------------------------------------------------------
 

Interactive Objects Software GmbH - Freiburg - Gesch?ftsf?hrer: Thomas Wager - AG Frbg. HRB 5810 - USt-IdNr. DE197983057


From mathilde.guerin at gmail.com  Wed Jul 30 00:51:45 2008
From: mathilde.guerin at gmail.com (Mathilde GUERIN)
Date: Wed, 30 Jul 2008 09:51:45 +0200
Subject: [antlr-interest] Problems customizing tree construction
Message-ID: <50c430330807300051h2561ebcdp9ae2f89b44da4ba4@mail.gmail.com>

Hi,
I'm trying to write the grammar for the "Natural" Language
(http://en.wikipedia.org/wiki/Natural) and produce an AST.

Here's an example of a Natural program:
1 #FIELDA (A10)
1 #GROUPB
  2 #FIELDB-A (N10)
  2 #FIELDB-B (D)
1 #FIELDC (A15)
...
//The integer value represents the LEVEL of the variable to define the
data structure
//The (...) is used to define the FORMAT (type, length...) of the variable

To put it simply:
   - #FIELDA is a variable (level 1 : highest level)
   - #GROUPB is a group (level 1) composed of 2 variables //it can't
have a format... which is how i detect if this is a group or a
variable
       * #FIELDB-A (level 2): first variable of the group
       * #FIELDB-B (level 2): second variable of the group
   - #FIELDC is an other variable (level 1).

Here's a summary of what i've done so far:
//1?) Custom Node Classes
public abstract class ASTNode extends CommonTree;
public class ASTVariable extends ASTNode;
public class ASTGroup extends ASTNode;

//2?) Grammar sample:
grammar
    : (groupDefinition | varDefinition)+ ;
groupDefinition
    : INT ID endLine+ -> ^(ID<ASTGroup>[$INT.level]) ;
varDefinition
    : INT ID format endLine+ -> ^(ID<ASTVariable>[$INT.level] format) ;
...

//3?) produced AST:
ROOT <CommonTree>
  |-#FIELDA   (level=1)  <ASTVariable>
  |-#GROUPB   (level=1)  <ASTGroup>
  |-#FIELDB-A (level=2)  <ASTVariable>
  |-#FIELDA-B (level=2)  <ASTVariable>
  |-#FIELDC   (level=1)  <ASTVariable>
----------------------------------------------------------------

What i'd like to get is something like this:

ROOT
  |-#FIELDA        (level=1)  <ASTVariable>
  |-#GROUPB        (level=1)  <ASTGroup>
      |-#FIELDB-A  (level=2)  <ASTVariable>
      |-#FIELDA-B  (level=2)  <ASTVariable>
  |-#FIELDC        (level=1)  <ASTVariable>


My idea was to keep the ASTGroup node and the previous encountered
level as variables of the parser to use it to create the variable
node. Here's what I had in mind:
------------------------------------------------------------------------------------------------------

//-- ASTGroup creation --
/*generated code to create group node here...*/
// then initialize groupNode
groupNode = generatedNode;

/*...*/
//-- ASTVariable creation --
//if the variable level is lower than the group level,
if(groupNode != null && currentLevel < previousLevel){
   //then the variable parent is the group node
   adaptator.addChild(groupNode,varNode);
}
else {
   //otherwise, the variable is one of the root child nodes and
groupNode is reinitialized
   adaptator.addChild(root,varNode)
   groupNode = null;
}
------------------------------------------------------------------------------------------------------
However, i haven't found a way to keep the created group node as a
Parser variable... :/
I'm not even sure this is the right solution (or even if it'd work)
but I don't know how to create such an AST since the construction
depends on the level of variables.

If someone could help me, that'd be really great...

Thanks in advance

~MG~

From e.mortoray at ecircle.com  Wed Jul 30 02:33:27 2008
From: e.mortoray at ecircle.com (edA-qa mort-ora-y)
Date: Wed, 30 Jul 2008 11:33:27 +0200
Subject: [antlr-interest] Simple problem with tokens string
Message-ID: <48903567.90907@ecircle.com>

I'd like to do something like below in a grammar (to handle keywords and
identifiers), but it just doesn't work as expected.

grammar Test;

sample
    :    'sample' VALUE;
   
VALUE
    :    ('a'..'z')+;

This works, so long as the input is not of this form:
    sample sample
In which case I get a MismatchedTokenException.

Why is it that as soon as I use a fixed string in a token it can no
longer be identified as a different token? And how do I do it correctly?

(Using ANTLRWorks 1.1.7)

-- 
edA-qa mort-ora-y
Director Quality Assurance
______________________________________________________
eCircle AG - Inside Digital Marketing
Nymphenburger Str. 86
80636 M?nchen

Tel    +49-89-12009-773
Fax    +49-89-12009-750

E-Mail mailto:e.mort-ora-y at ecircle.com
Web    http://www.ecircle.com

______________________________________________________
Aktuelles
"Inside Digital Marketing" - der Newsletter f?r die
Online-Branche von eCircle. Jeden Monat neu & voll
mit aktuellen Fallstudien und hilfreichen Tipps!
Jetzt kostenlos abonnieren:

http://www.ecircle.com/de/newsletter
______________________________________________________

eCircle AG, HRB 136 334, Handelsregister M?nchen
Vorstand:  Lothar Lanz, Volker Wiewer (Vorsitzende), 
Thomas Wilke, Lars W?ssner, Alexander Meyer
Vorsitzender des Aufsichtsrates: Dr. Mark W?ssner


From markwright at internode.on.net  Wed Jul 30 02:59:44 2008
From: markwright at internode.on.net (Mark Wright)
Date: Wed, 30 Jul 2008 19:59:44 +1000
Subject: [antlr-interest] Problems customizing tree construction
In-Reply-To: <50c430330807300051h2561ebcdp9ae2f89b44da4ba4@mail.gmail.com>
References: <50c430330807300051h2561ebcdp9ae2f89b44da4ba4@mail.gmail.com>
Message-ID: <20080730195944.000040ae@goanna>

Hi,

An alternative approach is to create your own symbol table:

http://www.antlr.org/wiki/display/CS652/Symbol+tables

And to set pointers/references to symbol table nodes as
appropriate in the tokens, in rule actions:

http://www.antlr.org/pipermail/antlr-interest/2008-July/029365.html

Regards, Mark

-- 

From markwright at internode.on.net  Wed Jul 30 03:07:23 2008
From: markwright at internode.on.net (Mark Wright)
Date: Wed, 30 Jul 2008 20:07:23 +1000
Subject: [antlr-interest] Simple problem with tokens string
In-Reply-To: <48903567.90907@ecircle.com>
References: <48903567.90907@ecircle.com>
Message-ID: <20080730200723.00005761@goanna>

Hi,

Please see the section "Keywords as Variables" on p. 287 of the ANTLR
book.

Regards, Mark

On Wed, 30 Jul 2008 11:33:27 +0200
edA-qa mort-ora-y <e.mortoray at ecircle.com> wrote:

> I'd like to do something like below in a grammar (to handle keywords
> and identifiers), but it just doesn't work as expected.
> 
> grammar Test;
> 
> sample
>     :    'sample' VALUE;
>    
> VALUE
>     :    ('a'..'z')+;
> 
> This works, so long as the input is not of this form:
>     sample sample
> In which case I get a MismatchedTokenException.
> 
> Why is it that as soon as I use a fixed string in a token it can no
> longer be identified as a different token? And how do I do it
> correctly?
> 
> (Using ANTLRWorks 1.1.7)
> 


-- 

From Fred.Brisard at ca.com  Wed Jul 30 05:49:47 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Wed, 30 Jul 2008 08:49:47 -0400
Subject: [antlr-interest] TokenStream
Message-ID: <7D50572C73BC634F92EE211BFF16F4A10648E8E2@USILMS12.ca.com>

Is there an easy way to view the tokenstream object that is passed to
the lexer using ANTLRWorks?

Fred Brisard


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/7b96e3ff/attachment.html 

From e.mortoray at ecircle.com  Wed Jul 30 06:48:48 2008
From: e.mortoray at ecircle.com (edA-qa mort-ora-y)
Date: Wed, 30 Jul 2008 15:48:48 +0200
Subject: [antlr-interest] Rewriting with nodes from sub-rules?
Message-ID: <48907140.9090300@ecircle.com>

I would like to be able to do rewriting using the nodes/tokens from
sub-rules.  It isn't clear from the book if this is possible.

For example:

exprA : 'set' nameValue;
exprB : 'define' nameValue;
nameValue : name value;

I would like to have a rule like this:
exprA : 'set' nameValue -> ^(SET nameValue.name nameValue.value)

That is, I wish to work with the tokens of the sub-rules in the rewrite.

-- 
edA-qa mort-ora-y
Director Quality Assurance
______________________________________________________
eCircle AG - Inside Digital Marketing
Nymphenburger Str. 86
80636 M?nchen

Tel    +49-89-12009-773
Fax    +49-89-12009-750

E-Mail mailto:e.mort-ora-y at ecircle.com
Web    http://www.ecircle.com

______________________________________________________
Aktuelles
"Inside Digital Marketing" - der Newsletter f?r die
Online-Branche von eCircle. Jeden Monat neu & voll
mit aktuellen Fallstudien und hilfreichen Tipps!
Jetzt kostenlos abonnieren:

http://www.ecircle.com/de/newsletter
______________________________________________________

eCircle AG, HRB 136 334, Handelsregister M?nchen
Vorstand:  Lothar Lanz, Volker Wiewer (Vorsitzende), 
Thomas Wilke, Lars W?ssner, Alexander Meyer
Vorsitzender des Aufsichtsrates: Dr. Mark W?ssner


From mathilde.guerin at gmail.com  Wed Jul 30 06:54:30 2008
From: mathilde.guerin at gmail.com (Mathilde GUERIN)
Date: Wed, 30 Jul 2008 15:54:30 +0200
Subject: [antlr-interest] Problems customizing tree construction
In-Reply-To: <20080730195944.000040ae@goanna>
References: <50c430330807300051h2561ebcdp9ae2f89b44da4ba4@mail.gmail.com>
	<20080730195944.000040ae@goanna>
Message-ID: <50c430330807300654h7a743383g211133ffb959a07b@mail.gmail.com>

I've already looked into this approach but it wouldn't solve my
problem (or at least, I don't think so...): in my project, the
variables that compose a group have to be represented as child nodes
of the group node:

 |-#GROUPB        (level=1)  <ASTGroup>
     |-#FIELDB-A  (level=2)  <ASTVariable>
     |-#FIELDB-B  (level=2)  <ASTVariable>

>From what I gathered from the symbol table articles that I read, I
wouldn't be able to do that with this approach... right?

~MG~

From craig at palantir.co.za  Wed Jul 30 06:59:23 2008
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Wed, 30 Jul 2008 15:59:23 +0200
Subject: [antlr-interest] Tricky rewrite (for me anyway)
Message-ID: <20080730155923.jqg0qne1kcwk84ks@webmail.palantir.co.za>

Hi all,

I am struggling with a tricky little rewrite rule.
I have managed to get this to work using a deep tree.
By that I mean:
        rule (('and'|'or')^ rule)* ;

I changed it recently to a simple list as follows.
The nodes are now siblings, which is what I want.

rules:	rule (('and'|'or') rule)*
                ;
I need to figure out how to rewrite the above rule to put
the 'and' or 'or' in front so that the tree can match properly.

The tree then matches as follows:
Unfortunately due to the nature of the matching, I only get the last match
in the tree, not the 'or' or 'and'. I have looked at the tree and this
structure should work. I figure I need to put the 'and' or 'or' in front.
path : ^(ROOT xname* 'and')
     | ^(ROOT xname* 'or')
     | ^(ROOT xname*)
     ;

I need to make a tree like this.
path : ^(ROOT 'and' xname*)
        | ^(ROOT 'or' xname*)
        | ^(ROOT xname*)
        ;

because then the tree will work. How do I rewrite the tree
to make it work?


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From jean-claude.durand at imag.fr  Wed Jul 30 06:55:04 2008
From: jean-claude.durand at imag.fr (Jean-Claude Durand)
Date: Wed, 30 Jul 2008 15:55:04 +0200
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
Message-ID: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>

I get a pb easy to fix when I use composed grammars with AST: the .h  
files include
each other (because of forward references) and do not compile. Here  
is a very simple example
(I am using Version 3.1b2, and C target language):

~/Soft/Ariane-Y/V3Compilateur/ForAI: ls *.g
Composed.g  Id.g        Int.g       Lex.g
~/Soft/Ariane-Y/V3Compilateur/ForAI: more Lex.g
lexer grammar Lex;
options
{
         language=C;
}

tokens
{
         LITERAL_IM;
         INTEGER_IM;
         DECL_IM;
}

LITERAL:        'a'..'z'+       ;
INTEGER:        '0'..'9'+       ;
Blancs: ( ' ' | '\t' | '\n' )+ { $channel=HIDDEN; }     ;
~/Soft/Ariane-Y/V3Compilateur/ForAI:
~/Soft/Ariane-Y/V3Compilateur/ForAI: more Id.g
parser grammar Id;
options
{
         language=C;
         output=AST;
}

id      :
         LITERAL
                                         -> ^(LITERAL_IM LITERAL)
         ;
~/Soft/Ariane-Y/V3Compilateur/ForAI:
~/Soft/Ariane-Y/V3Compilateur/ForAI: more Int.g
parser grammar Int;
options
{
         language=C;
         output=AST;
}

ent:
         INTEGER
                                         -> INTEGER
         ;
~/Soft/Ariane-Y/V3Compilateur/ForAI:
~/Soft/Ariane-Y/V3Compilateur/ForAI: more Composed.g
parser grammar Composed;
options
{
         language=C;
         tokenVocab=Lex;
         output=AST;
}

import Id, Int;

decls
         :
         i=id
         e=ent
                                 -> ^(DECL_IM $i $e)
         ;
~/Soft/Ariane-Y/V3Compilateur/ForAI:
~/Soft/Ariane-Y/V3Compilateur/ForAI: java org.antlr.Tool Lex.g
ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008
Generating Lex.c
Generating Lex.h
~/Soft/Ariane-Y/V3Compilateur/ForAI: java org.antlr.Tool Composed.g
ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008
Generating Composed.c
Generating Composed.h
Generating Composed_Id.c
Generating Composed_Id.h
Generating Composed_Int.c
Generating Composed_Int.h
~/Soft/Ariane-Y/V3Compilateur/ForAI:
~/Soft/Ariane-Y/V3Compilateur/ForAI: c++ -c Composed.c Composed_Id.c  
Composed_Int.c Lex.c main.c -I/usr/include/sys -I/usr/local/pkg/ 
antlr-2008-06-26.17/runtime/C/include/ -I.
./Composed_Int.h:157: error: expected declaration before '}' token
./Composed.h:106: error: expected identifier before '*' token
./Composed.h:106: error: ISO C++ forbids declaration of  
'Composed_Id_id_return' with no type
./Composed.h:106: error: 'Composed_Id_id_return' declared as function  
returning a function
./Composed.h:159: error: expected declaration before '}' token
./Composed.h:107: error: expected identifier before '*' token
./Composed.h:107: error: ISO C++ forbids declaration of  
'Composed_Int_ent_return' with no type
./Composed.h:107: error: 'Composed_Int_ent_return' declared as  
function returning a function
./Composed.h:159: error: expected declaration before '}' token
./Composed_Int.h:157: error: expected declaration before '}' token
~/Soft/Ariane-Y/V3Compilateur/ForAI:

So I modified the .h files corresponding to the component grammars by  
replacing
"#include	<Composed.h>"
by
"typedef struct Composed_Ctx_struct Composed, * pComposed;"
in both files Composed_id.h and Composed_Int.h, and now, it's OK:

~/Soft/Ariane-Y/V3Compilateur/ForAI: c++ -c Composed.c Composed_Id.c  
Composed_Int.c Lex.c main.c -I/usr/include/sys -I/usr/local/pkg/ 
antlr-2008-06-26.17/runtime/C/include/ -I.
main.c: In function 'int main(int, char**)':
main.c:28: warning: comparison is always false due to limited range  
of data type
main.c:48: warning: comparison is always false due to limited range  
of data type

I took my main from the examples, and wanted to print the AST: I got a
"Bus error", if I want to print the AST with
"printf(" main: %s\n", ast.tree->toStringTree(ast.tree)->chars);":

~/Soft/Ariane-Y/V3Compilateur/ForAI: c++ Lex.o Composed.o  
Composed_Id.o Composed_Int.o main.o -lantlr3c
~/Soft/Ariane-Y/V3Compilateur/ForAI: ./a.out test.in  main:
  main: ast: 344064
Bus error
~/Soft/Ariane-Y/V3Compilateur/ForAI:

Without the printf, it's OK:

~/Soft/Ariane-Y/V3Compilateur/ForAI: ./a.out test.in
  main:
  main: ast: 344064
  main.
~/Soft/Ariane-Y/V3Compilateur/ForAI:

Here is 'my' main:
~/Soft/Ariane-Y/V3Compilateur/ForAI: cat main.c
#include "stdio.h"

#include "Lex.h"
#include "Composed.h"

int ANTLR3_CDECL
main    (int argc, char *argv[])
{
         printf(" main:\n");
    pANTLR3_UINT8            fName;
         pANTLR3_INPUT_STREAM    input;

         pLex                lxr;

         pANTLR3_COMMON_TOKEN_STREAM         tstream;
         pComposed                   psr;

    if (argc < 2 || argv[1] == NULL)
    {
                 fName   =(pANTLR3_UINT8)"./input";
    }
    else
    {
                 fName   = (pANTLR3_UINT8)argv[1];
    }

    input        = antlr3AsciiFileStreamNew(fName);
    if ( (ANTLR3_UINT64)input < 0 )
    {
                 switch((ANTLR3_UINT64)input)
                 {
                         case    ANTLR3_ERR_NOMEM:
                         fprintf(stderr, "Unable to open file %s due  
to malloc() failure1\n",
                                                                  
(char *)fName);
                 exit(1);
                 break;

                         default:
                         fprintf(stderr, "Failed to open file %s -  
exit with code %d\n",
                                                 (char *)fName,  
(ANTLR3_UINT64)input);
                 exit((int)((ANTLR3_UINT64)input));
                 break;
                 }
    }

    lxr = LexNew(input);     // SimpleLexerNew is generated by ANTLR

    if ( (ANTLR3_UINT64)lxr < 0 )
     {
                 switch((ANTLR3_UINT64)lxr)
                 {
                         case    ANTLR3_ERR_NOMEM:

                 fprintf(stderr, "Unable to create the lexer due to  
malloc() failure1\n");
                 exit(1);
                 break;

                         default:
                         fprintf(stderr, "Failed to create lexer -  
exit with code %d\n",
                                                 (ANTLR3_UINT64)lxr);
                 exit((int)((ANTLR3_UINT64)lxr));
                 break;
                 }
         }

    //tstream = antlr3CommonTokenStreamSourceNew(ANTLR3_SIZE_HINT,  
lxr->pLexer->tokSource);
         // chang? pour ci-dessous trouv? dans un programme plus  
r?cent !
         tstream = antlr3CommonTokenStreamSourceNew(ANTLR3_SIZE_HINT,  
TOKENSOURCE(lxr));

         if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
         {
                 fprintf(stderr, "Out of memory trying to allocate  
token stream\n");
                 exit(ANTLR3_ERR_NOMEM);
         }

         psr = ComposedNew(tstream);  // SimpleParserNew is generated  
by ANTLR3

         // analyse lexicale:
         /*{
                 ANTLR3_INT32 T;
                 T = 0;
                 while (T != ANTLR3_TOKEN_EOF)
                 {
                         T = tstream->tstream->istream->_LA(tstream- 
 >tstream->istream, 1);
                         tstream->tstream->istream->consume(tstream- 
 >tstream->istream);
                         printf("%d %s\n", T,  (psr->pParser->rec- 
 >state->tokenNames)[T]);
                 }
         }*/

         if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
         {
                 fprintf(stderr, "Out of memory trying to allocate  
parser\n");
                 exit(ANTLR3_ERR_NOMEM);
         }

    Composed_decls_return ast;
         ast = psr->decls(psr);

         printf(" main: ast: %d\n", ast);

         //printf(" main: %s\n", ast.tree->toStringTree(ast.tree)- 
 >chars);

         psr->free  (psr);           psr = NULL;
         tstream->free  (tstream);           tstream = NULL;
         lxr->free  (lxr);           lxr = NULL;
         input->close (input);       input = NULL;

         printf(" main.\n");
    return 0;
}
~/Soft/Ariane-Y/V3Compilateur/ForAI:

Here is the zip file of the above example including the modified files:

?

Thanks a lot,
Jean-Claude Durand

LIG, ?quipe GETALP
385, rue de la Biblioth?que
BP 53
38041 Grenoble cedex 9
FRANCE

Jean-Claude.Durand at imag.fr
t?l: +33 (0)4 76 51 43 81
fax: +33 (0)4 76 51 44 05



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/714d0041/attachment-0002.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Composed.tar.gz
Type: application/x-gzip
Size: 4044 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/714d0041/attachment-0001.gz 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/714d0041/attachment-0003.html 

From jimi at temporal-wave.com  Wed Jul 30 07:09:38 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 07:09:38 -0700
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
In-Reply-To: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
References: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
Message-ID: <1217426978.9052.16.camel@jimi>

On Wed, 2008-07-30 at 15:55 +0200, Jean-Claude Durand wrote:

> I get a pb easy to fix when I use composed grammars with AST: the .h
> files include 
> 
> each other (because of forward references) and do not compile. Here is
> a very simple example
> (I am using Version 3.1b2, and C target language):


I have both of these on my list of bugs - thanks for the effort in
looking for them. The include one is tricky, it seems that I am going to
have to be cleverer with includes in composite (import) grammars as my
recent change to the include order was to fix that. Putting it back will
fix your issue, but re-break the import.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/f02ecf7d/attachment.html 

From jimi at temporal-wave.com  Wed Jul 30 08:07:55 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 08:07:55 -0700
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
In-Reply-To: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
References: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
Message-ID: <1217430475.9052.26.camel@jimi>

On Wed, 2008-07-30 at 15:55 +0200, Jean-Claude Durand wrote:

> I get a pb easy to fix when I use composed grammars with AST: the .h
> files include 
> 
> each other (because of forward references) and do not compile. Here is
> a very simple example
> (I am using Version 3.1b2, and C target language):
> 


>    input        = antlr3AsciiFileStreamNew(fName);
>    if ( (ANTLR3_UINT64)input < 0 )
>    {
>                 switch((ANTLR3_UINT64)input)
>                 {
>                         case    ANTLR3_ERR_NOMEM:
>                         fprintf(stderr, "Unable to open file %s due to
> malloc() failure1\n", 
>                                                                 (char
> *)fName);


Please note that with 3.1, the return codes from all the functions are
either NULL (indicating failure to allocate memory), or a valid pointer,
hence the testing for <0 and so on is no longer necessary or valid. See
the drivers main.c in the 3.1 examples for details. 

Jim
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/d127bcf7/attachment.html 

From rkevinburton at charter.net  Wed Jul 30 09:00:50 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 12:00:50 -0400
Subject: [antlr-interest] Illegal escape sequence in C#
Message-ID: <20080730120050.YLZW0.182127.root@fepweb04>

I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:

    const string DFA18_eotS =
        "\1\uffff\2\4\3\uffff\1\4";
    const string DFA18_eofS =
        "\7\uffff";
    const string DFA18_minS =
        "\3\56\3\uffff\1\56";
    const string DFA18_maxS =
        "\1\71\1\56\1\71\3\uffff\1\71";
    const string DFA18_acceptS =
        "\3\uffff\1\2\1\3\1\1\1\uffff";
    const string DFA18_specialS =
        "\7\uffff}>";
    static readonly string[] DFA18_transitionS = {
            "\1\3\1\uffff\1\1\11\2",
            "\1\5",
            "\1\5\1\uffff\12\6",
            "",
            "",
            "",
            "\1\5\1\uffff\12\6"
    };

This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?

Thank you.

Kevin

From markwright at internode.on.net  Wed Jul 30 09:29:24 2008
From: markwright at internode.on.net (Mark Wright)
Date: Thu, 31 Jul 2008 02:29:24 +1000
Subject: [antlr-interest] Problems customizing tree construction
In-Reply-To: <50c430330807300654h7a743383g211133ffb959a07b@mail.gmail.com>
References: <50c430330807300051h2561ebcdp9ae2f89b44da4ba4@mail.gmail.com>
	<20080730195944.000040ae@goanna>
	<50c430330807300654h7a743383g211133ffb959a07b@mail.gmail.com>
Message-ID: <20080731022924.00001432@goanna>

On Wed, 30 Jul 2008 15:54:30 +0200
"Mathilde GUERIN" <mathilde.guerin at gmail.com> wrote:

> I've already looked into this approach but it wouldn't solve my
> problem (or at least, I don't think so...): in my project, the
> variables that compose a group have to be represented as child nodes
> of the group node:
> 
>  |-#GROUPB        (level=1)  <ASTGroup>
>      |-#FIELDB-A  (level=2)  <ASTVariable>
>      |-#FIELDB-B  (level=2)  <ASTVariable>
> 
> From what I gathered from the symbol table articles that I read, I
> wouldn't be able to do that with this approach... right?
> 
> ~MG~

Hi,

Some ideas:

(1) You could create a structure like what you have above
in a symbol table instead of in the AST.  Of course you will
need to figure out if you want to do that or not.

With the symbol table approach, you could add actions to the
grammar to set the current scope, and add the variables to
the current scope.  Something like:

@members {
  SemanticActions sa;
}
grammar 
    : (groupDefinition | varDefinition)+ ;
groupDefinition
    : INT ID endLine+
      { sa.groupDefinition($INT, $ID); }
      -> ^(ID<ASTGroup>[$INT.level]) ;
varDefinition
    : INT ID format endLine+
      { sa.varDefinition($INT, $ID); }
      -> ^(ID<ASTVariable>[$INT.level] format) ;

And in the SemanticActions.groupDefinition() you can call something
like a moveIntoGroupDefinitionScope(scopeLevel, group) method.

And in SemanticActions.varDefinition(), you can look up the
current scope, then enter the var definitions into the
group variable found from the scope lookup.

So of course you can create a symbol table data structure that
looks like the AST you asked for.

(2) Alternatively, if you want an AST like that, then one crazy idea
is as follows.  I say its crazy because it seems kind of complicated,
I wonder if there might be an easier way to do it than my suggestion
here.  I don't know if something like this can be made to work either.

You can create your own AST and Token classes, which are in
a relationship with each other, something like:

import org.antlr.runtime.tree.CommonTree;
import org.antlr.runtime.Token;
import org.antlr.runtime.CommonToken;
import tntdbo.sym.Symbol;

public class MyAST extends CommonTree {
    public MyAST(Token t) {
        super(t);
        t.setAST(this);
    }

    public MyAST(int ttype, String text) {
        Token t = new CommonToken(ttype, text);
        super(t);
        t.setAST(this);
    }
}

The varDefinition action can dynamically create the returned AST,
something like:

@members {
  SemanticActions sa;
}
@lexer::members {
    public Token emit() {
        Token t = new MyToken(input, state.type, state.channel, state.tokenStartCharIndex, getCharIndex()-1);
        t.setLine(state.tokenStartLine);
        t.setText(state.text);
        t.setCharPositionInLine(state.tokenStartCharPositionInLine);
        emit(t);
        return t;
    }
grammar 
    : (groupDefinition | varDefinition)+ ;
groupDefinition
    : INT ID endLine+
      { sa.groupDefinition($INT, $ID); }
      -> ^(ID<ASTGroup>[$INT.level]) ;
varDefinition
    : INT ID format (e+=endLine)+
      -> { sa.varDefinition(adaptor, $INT, $ID, $format, $e); }

And the method would be something like:

public CommonTree varDefinition(TreeAdaptor adaptor, Token level, Token id,
                                 List endLineTokenList) {
  CommonTree groupAST = lookupController.lookup(level, id);
  adaptor.addChild(groupAST, (CommonTree)adaptor.create(level));
  return ast;
}

Its kind of a sketch, not sure if something like this would really
work or not.

Regards, Mark

-- 

From jaluber at gmx.de  Wed Jul 30 10:11:25 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 30 Jul 2008 19:11:25 +0200
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730120050.YLZW0.182127.root@fepweb04>
References: <20080730120050.YLZW0.182127.root@fepweb04>
Message-ID: <4890A0BD.402@gmx.de>

rkevinburton at charter.net schrieb:
> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> 
>     const string DFA18_eotS =
>         "\1\uffff\2\4\3\uffff\1\4";
>     const string DFA18_eofS =
>         "\7\uffff";
>     const string DFA18_minS =
>         "\3\56\3\uffff\1\56";
>     const string DFA18_maxS =
>         "\1\71\1\56\1\71\3\uffff\1\71";
>     const string DFA18_acceptS =
>         "\3\uffff\1\2\1\3\1\1\1\uffff";
>     const string DFA18_specialS =
>         "\7\uffff}>";
>     static readonly string[] DFA18_transitionS = {
>             "\1\3\1\uffff\1\1\11\2",
>             "\1\5",
>             "\1\5\1\uffff\12\6",
>             "",
>             "",
>             "",
>             "\1\5\1\uffff\12\6"
>     };
> 
> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> 
> Thank you.
> 
> Kevin
> 
Could it be that you are using AW 1.2 beta with the CSharp target? That 
was broken in an earlier version of ANTLR. I don't know if the newest 
beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.

Johannes

From jimi at temporal-wave.com  Wed Jul 30 10:15:40 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 10:15:40 -0700
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
In-Reply-To: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
References: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
Message-ID: <1217438140.9052.30.camel@jimi>

On Wed, 2008-07-30 at 15:55 +0200, Jean-Claude Durand wrote:

> printf(" main: %s\n", ast.tree->toStringTree(ast.tree)->chars);


Fixed via ANTLR-312 . You can get this from the b3 distribution tar
(which will be updated rapidly over the next few days).

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/096b852a/attachment.html 

From rkevinburton at charter.net  Wed Jul 30 10:29:13 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 10:29:13 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <4890A0BD.402@gmx.de>
Message-ID: <20080730132913.ED5PE.183791.root@fepweb04>

This was using 1.2b5. I have avoided upgrading since I hear rumors that 3.1 of ANTLR is "soon". If I upgrade what version of ANTLRWorks should I use with which version of ANTLR?

Thank you.

Kevin
---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> > 
> >     const string DFA18_eotS =
> >         "\1\uffff\2\4\3\uffff\1\4";
> >     const string DFA18_eofS =
> >         "\7\uffff";
> >     const string DFA18_minS =
> >         "\3\56\3\uffff\1\56";
> >     const string DFA18_maxS =
> >         "\1\71\1\56\1\71\3\uffff\1\71";
> >     const string DFA18_acceptS =
> >         "\3\uffff\1\2\1\3\1\1\1\uffff";
> >     const string DFA18_specialS =
> >         "\7\uffff}>";
> >     static readonly string[] DFA18_transitionS = {
> >             "\1\3\1\uffff\1\1\11\2",
> >             "\1\5",
> >             "\1\5\1\uffff\12\6",
> >             "",
> >             "",
> >             "",
> >             "\1\5\1\uffff\12\6"
> >     };
> > 
> > This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> was broken in an earlier version of ANTLR. I don't know if the newest 
> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> 
> Johannes


From jimi at temporal-wave.com  Wed Jul 30 10:29:47 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 10:29:47 -0700
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
In-Reply-To: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
References: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
Message-ID: <1217438987.9052.35.camel@jimi>

On Wed, 2008-07-30 at 15:55 +0200, Jean-Claude Durand wrote:

> I get a pb easy to fix when I use composed grammars with AST: the .h
> files include 
> 
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: c++ -c Composed.c Composed_Id.c
> Composed_Int.c Lex.c main.c -I/usr/include/sys
> -I/usr/local/pkg/antlr-2008-06-26.17/runtime/C/include/ -I.
> ./Composed_Int.h:157: error: expected declaration before '}' token
> ./Composed.h:106: error: expected identifier before '*' token
> ./Composed.h:106: error: ISO C++ forbids declaration of
> 'Composed_Id_id_return' with no type
> ./Composed.h:106: error: 'Composed_Id_id_return' declared as function
> returning a function
> ./Composed.h:159: error: expected declaration before '}' token
> ./Composed.h:107: error: expected identifier before '*' token
> ./Composed.h:107: error: ISO C++ forbids declaration of
> 'Composed_Int_ent_return' with no type
> ./Composed.h:107: error: 'Composed_Int_ent_return' declared as
> function returning a function
> ./Composed.h:159: error: expected declaration before '}' token
> ./Composed_Int.h:157: error: expected declaration before '}' token
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: 


OK - in fact I have already fxied this. It was a C.stg template change
however - are you sure you are using teh latest ANTLR beta 2 jar as this
is the error you will get if you are not. If you definately are then you
will see:

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/ca4c7137/attachment-0001.html 

From jimi at temporal-wave.com  Wed Jul 30 10:31:47 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 10:31:47 -0700
Subject: [antlr-interest] Composed grammars and AST, pb with .h files;
	and "Bus error" with 'toStringTree'
In-Reply-To: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
References: <84BCD794-4E45-4FC9-A712-9875FB648AF4@imag.fr>
Message-ID: <1217439107.9052.38.camel@jimi>

On Wed, 2008-07-30 at 15:55 +0200, Jean-Claude Durand wrote:

> ~/Soft/Ariane-Y/V3Compilateur/ForAI: 
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: java org.antlr.Tool Lex.g
> ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008

This is not the correct verison of the beta 2 jar. It should say:

ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)  1989-2008



> Generating Lex.h
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: java org.antlr.Tool Composed.g
> ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008
> Generating Composed.c
> Generating Composed.h
> Generating Composed_Id.c
> Generating Composed_Id.h
> Generating Composed_Int.c
> Generating Composed_Int.h
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: 
> ~/Soft/Ariane-Y/V3Compilateur/ForAI: c++ -c Composed.c Composed_Id.c
> Composed_Int.c Lex.c main.c -I/usr/include/sys
> -I/usr/local/pkg/antlr-2008-06-26.17/runtime/C/include/ -I.
> ./Composed_Int.h:157: error: expected declaration before '}' token

This is already fixed if your sue the correct beta 2 jar with the C
runtime beta 2. Looks like you are using an earlier snapshot and not the
actual beta 2 ANTLR tool:

ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)  1989-2008


Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/17f71005/attachment.html 

From rkevinburton at charter.net  Wed Jul 30 10:33:07 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 10:33:07 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <4890A0BD.402@gmx.de>
Message-ID: <20080730133307.61C7C.183866.root@fepweb04>

I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).

Now I am confused.

Thank you for the tips.

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> > 
> >     const string DFA18_eotS =
> >         "\1\uffff\2\4\3\uffff\1\4";
> >     const string DFA18_eofS =
> >         "\7\uffff";
> >     const string DFA18_minS =
> >         "\3\56\3\uffff\1\56";
> >     const string DFA18_maxS =
> >         "\1\71\1\56\1\71\3\uffff\1\71";
> >     const string DFA18_acceptS =
> >         "\3\uffff\1\2\1\3\1\1\1\uffff";
> >     const string DFA18_specialS =
> >         "\7\uffff}>";
> >     static readonly string[] DFA18_transitionS = {
> >             "\1\3\1\uffff\1\1\11\2",
> >             "\1\5",
> >             "\1\5\1\uffff\12\6",
> >             "",
> >             "",
> >             "",
> >             "\1\5\1\uffff\12\6"
> >     };
> > 
> > This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> was broken in an earlier version of ANTLR. I don't know if the newest 
> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> 
> Johannes


From rkevinburton at charter.net  Wed Jul 30 10:43:55 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 10:43:55 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730133307.61C7C.183866.root@fepweb04>
Message-ID: <20080730134355.JH2BZ.184073.root@fepweb04>

I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:

        public ECMAScriptParser(ITokenStream input)
    		: this(input, new RecognizerSharedState()) {
        }

        public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
    		: base(input, state) {
    		InitializeCyclicDFAs();
        }

It seems that RecognizerSharedState is no longer recognized. Any substitutes?

Thanks again.

Kevin
---- rkevinburton at charter.net wrote: 
> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
> 
> Now I am confused.
> 
> Thank you for the tips.
> 
> Kevin
> 
> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> > rkevinburton at charter.net schrieb:
> > > I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> > > 
> > >     const string DFA18_eotS =
> > >         "\1\uffff\2\4\3\uffff\1\4";
> > >     const string DFA18_eofS =
> > >         "\7\uffff";
> > >     const string DFA18_minS =
> > >         "\3\56\3\uffff\1\56";
> > >     const string DFA18_maxS =
> > >         "\1\71\1\56\1\71\3\uffff\1\71";
> > >     const string DFA18_acceptS =
> > >         "\3\uffff\1\2\1\3\1\1\1\uffff";
> > >     const string DFA18_specialS =
> > >         "\7\uffff}>";
> > >     static readonly string[] DFA18_transitionS = {
> > >             "\1\3\1\uffff\1\1\11\2",
> > >             "\1\5",
> > >             "\1\5\1\uffff\12\6",
> > >             "",
> > >             "",
> > >             "",
> > >             "\1\5\1\uffff\12\6"
> > >     };
> > > 
> > > This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> > > 
> > > Thank you.
> > > 
> > > Kevin
> > > 
> > Could it be that you are using AW 1.2 beta with the CSharp target? That 
> > was broken in an earlier version of ANTLR. I don't know if the newest 
> > beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> > 
> > Johannes
> 


From javafoust at gmail.com  Wed Jul 30 10:44:01 2008
From: javafoust at gmail.com (Foust)
Date: Wed, 30 Jul 2008 10:44:01 -0700
Subject: [antlr-interest] Tree Rewrite Issue with Negation (~)
Message-ID: <002201c8f26b$dbc6cb00$93546100$@com>

ANTLR Gurus,

 

There seems to be an ANTLR 3 bug (all versions through 3.1b2) when using the
token negation operator to match a series of tokens in a rule that also has
an AST rewrite rule.

 

Although this works (nonsense):

x :           ':' ( v+=(';'|'}') )* ';'  -> ^(':' $v) ;

 

this expression does not work (single tilde added in order to accept all
tokens, except those two):

x :           ':' ( v+=~(';'|'}') )* ';'  -> ^(':' $v) ;

 

It works as expected, unless the rewrite rule is added to the end. Once a
"-> ." is added, the following error is produced:

 

error(10):  internal error: T.g : java.lang.IllegalArgumentException: Can't
find template matchSetTrackAndListLabel.st

 

It may be fixed by breaking out the negation logic into a separately-named
rule:

x :           ':' ( v+= configVal )* ';'  -> ^(':' $v) ;

configVal:            ~(';'|'}')+;

 

Is this a known bug?

 

The options used are:

 

grammar T;

options {

                backtrack=true;                                //
automatically resolve similar rules (which begin the same way)

                memoize=true;                                // use extra
memory to speed up backtracking

                output=AST;                                      // generate
an abstract syntax tree from matched rules

                ASTLabelType=CommonTree;    // class of tree node (must be
cast from Object, otherwise)

}

 

Brent

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/7303babc/attachment.html 

From jaluber at gmx.de  Wed Jul 30 10:56:46 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 30 Jul 2008 19:56:46 +0200
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730134355.JH2BZ.184073.root@fepweb04>
References: <20080730134355.JH2BZ.184073.root@fepweb04>
Message-ID: <4890AB5E.6050400@gmx.de>

rkevinburton at charter.net schrieb:
> I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:
> 
>         public ECMAScriptParser(ITokenStream input)
>     		: this(input, new RecognizerSharedState()) {
>         }
> 
>         public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
>     		: base(input, state) {
>     		InitializeCyclicDFAs();
>         }
> 
> It seems that RecognizerSharedState is no longer recognized. Any substitutes?
> 
> Thanks again.
> 
> Kevin

Did you use the correct assemblies? Each beta has it own version.

Johannes
> ---- rkevinburton at charter.net wrote: 
>> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
>>
>> Now I am confused.
>>
>> Thank you for the tips.
>>
>> Kevin
>>
>> ---- Johannes Luber <jaluber at gmx.de> wrote: 
>>> rkevinburton at charter.net schrieb:
>>>> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
>>>>
>>>>     const string DFA18_eotS =
>>>>         "\1\uffff\2\4\3\uffff\1\4";
>>>>     const string DFA18_eofS =
>>>>         "\7\uffff";
>>>>     const string DFA18_minS =
>>>>         "\3\56\3\uffff\1\56";
>>>>     const string DFA18_maxS =
>>>>         "\1\71\1\56\1\71\3\uffff\1\71";
>>>>     const string DFA18_acceptS =
>>>>         "\3\uffff\1\2\1\3\1\1\1\uffff";
>>>>     const string DFA18_specialS =
>>>>         "\7\uffff}>";
>>>>     static readonly string[] DFA18_transitionS = {
>>>>             "\1\3\1\uffff\1\1\11\2",
>>>>             "\1\5",
>>>>             "\1\5\1\uffff\12\6",
>>>>             "",
>>>>             "",
>>>>             "",
>>>>             "\1\5\1\uffff\12\6"
>>>>     };
>>>>
>>>> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
>>>>
>>>> Thank you.
>>>>
>>>> Kevin
>>>>
>>> Could it be that you are using AW 1.2 beta with the CSharp target? That 
>>> was broken in an earlier version of ANTLR. I don't know if the newest 
>>> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
>>>
>>> Johannes
> 


From parrt at cs.usfca.edu  Wed Jul 30 11:03:44 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 30 Jul 2008 11:03:44 -0700
Subject: [antlr-interest] Tree Rewrite Issue with Negation (~)
In-Reply-To: <002201c8f26b$dbc6cb00$93546100$@com>
References: <002201c8f26b$dbc6cb00$93546100$@com>
Message-ID: <A8208D8D-2E52-4A41-A2D5-B8E81833A9E8@cs.usfca.edu>

thanks...added bug:

http://www.antlr.org:8888/browse/ANTLR-313
Ter
On Jul 30, 2008, at 10:44 AM, Foust wrote:

> ANTLR Gurus,
>
> There seems to be an ANTLR 3 bug (all versions through 3.1b2) when  
> using the token negation operator to match a series of tokens in a  
> rule that also has an AST rewrite rule.
>
> Although this works (nonsense):
> x :           ':' ( v+=(';'|'}') )* ?;?  -> ^(':' $v) ;
>
> this expression does not work (single tilde added in order to accept  
> all tokens, except those two):
> x :           ':' ( v+=~(';'|'}') )* ?;?  -> ^(':' $v) ;
>
> It works as expected, unless the rewrite rule is added to the end.  
> Once a ?-> ?? is added, the following error is produced:
>
> error(10):  internal error: T.g :  
> java.lang.IllegalArgumentException: Can't find template  
> matchSetTrackAndListLabel.st
>
> It may be fixed by breaking out the negation logic into a separately- 
> named rule:
> x :           ':' ( v+= configVal )* ?;?  -> ^(':' $v) ;
> configVal:            ~(';'|'}')+;
>
> Is this a known bug?
>
> The options used are:
>
> grammar T;
> options {
>                 backtrack=true;                                //  
> automatically resolve similar rules (which begin the same way)
>                 memoize=true;                                // use  
> extra memory to speed up backtracking
>                 output=AST;                                      //  
> generate an abstract syntax tree from matched rules
>                 ASTLabelType=CommonTree;    // class of tree node  
> (must be cast from Object, otherwise)
> }
>
> Brent
>


From rkevinburton at charter.net  Wed Jul 30 11:48:03 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 11:48:03 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <4890AB5E.6050400@gmx.de>
Message-ID: <20080730144803.0R7H8.185232.root@fepweb04>

I am linked to the assemblies (DLLs) that are in the antlr directory. As suggested I just downloaded the ANTLRWorks zip file and changed the extension to .jar and ran it. That is the extent of my "installation". Do I need to do more?

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:
> > 
> >         public ECMAScriptParser(ITokenStream input)
> >     		: this(input, new RecognizerSharedState()) {
> >         }
> > 
> >         public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
> >     		: base(input, state) {
> >     		InitializeCyclicDFAs();
> >         }
> > 
> > It seems that RecognizerSharedState is no longer recognized. Any substitutes?
> > 
> > Thanks again.
> > 
> > Kevin
> 
> Did you use the correct assemblies? Each beta has it own version.
> 
> Johannes
> > ---- rkevinburton at charter.net wrote: 
> >> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
> >>
> >> Now I am confused.
> >>
> >> Thank you for the tips.
> >>
> >> Kevin
> >>
> >> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> >>> rkevinburton at charter.net schrieb:
> >>>> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> >>>>
> >>>>     const string DFA18_eotS =
> >>>>         "\1\uffff\2\4\3\uffff\1\4";
> >>>>     const string DFA18_eofS =
> >>>>         "\7\uffff";
> >>>>     const string DFA18_minS =
> >>>>         "\3\56\3\uffff\1\56";
> >>>>     const string DFA18_maxS =
> >>>>         "\1\71\1\56\1\71\3\uffff\1\71";
> >>>>     const string DFA18_acceptS =
> >>>>         "\3\uffff\1\2\1\3\1\1\1\uffff";
> >>>>     const string DFA18_specialS =
> >>>>         "\7\uffff}>";
> >>>>     static readonly string[] DFA18_transitionS = {
> >>>>             "\1\3\1\uffff\1\1\11\2",
> >>>>             "\1\5",
> >>>>             "\1\5\1\uffff\12\6",
> >>>>             "",
> >>>>             "",
> >>>>             "",
> >>>>             "\1\5\1\uffff\12\6"
> >>>>     };
> >>>>
> >>>> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> >>>>
> >>>> Thank you.
> >>>>
> >>>> Kevin
> >>>>
> >>> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> >>> was broken in an earlier version of ANTLR. I don't know if the newest 
> >>> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> >>>
> >>> Johannes
> > 
> 


From parrt at cs.usfca.edu  Wed Jul 30 11:50:01 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 30 Jul 2008 11:50:01 -0700
Subject: [antlr-interest] Combining jars
Message-ID: <A4E11F74-48E5-4E41-A3E3-7F63584C1418@cs.usfca.edu>

Hi,  there is a proposal before the house to combine all necessary  
jars for ANTLR into a single one. any complaints if I put

antlr-2.7.7.jar
stringtemplate-3.2.jar
antlr-3.0.jar

into a single file?   Naturally, we still need the separate libraries  
for the runtime, which time makes it awkward because we need  
stringtemplate-3.2.jar sometimes also during runtime.

  any suggestions?
Ter

From rkevinburton at charter.net  Wed Jul 30 12:27:42 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 12:27:42 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <4890AB5E.6050400@gmx.de>
Message-ID: <20080730152742.LLN71.185955.root@fepweb04>

I downloaded 3.1b2 of ANTLR and replaced the references that I had with the references to the runtime->CSharp->net2.0 assemblies. Now I am down to one error:

'Antlr.Runtime.ParserRuleReturnScope' does not contain a definition for 'start' and no extension method 'start' accepting a first argument of type 'Antlr.Runtime.ParserRuleReturnScope' could be found (are you missing a using directive or an assembly reference?)

This seems to be generated as part of the actions in the grammar. Do you know what replaced .start?

			else if (lt.Type == EOL || (lt.Type == MultiLineComment && Regex.IsMatch(lt.Text, "/.*\r\n|\r|\n")))
			{
				// We found our EOL: promote the token to on channel, position the input on it and reset the rule start.
				lt.Channel = Token.DEFAULT_CHANNEL;
				input.Seek(lt.TokenIndex);
				if (rule != null)
				{
					rule.start = lt;
				}
				break;
			}

I am relatively new to ANTLR and this from a grammar that is for ECMAScript that is on the ANTLR grammar site. I think is what is being done here is an attempt at "auto semicolon inserstion". I think is what is supposed to happen here is that if there is no semicolon but there is an EOL then reset the parser. How that is done as apparently changed between 3.0 and 3.1. Thanks again.

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:
> > 
> >         public ECMAScriptParser(ITokenStream input)
> >     		: this(input, new RecognizerSharedState()) {
> >         }
> > 
> >         public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
> >     		: base(input, state) {
> >     		InitializeCyclicDFAs();
> >         }
> > 
> > It seems that RecognizerSharedState is no longer recognized. Any substitutes?
> > 
> > Thanks again.
> > 
> > Kevin
> 
> Did you use the correct assemblies? Each beta has it own version.
> 
> Johannes
> > ---- rkevinburton at charter.net wrote: 
> >> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
> >>
> >> Now I am confused.
> >>
> >> Thank you for the tips.
> >>
> >> Kevin
> >>
> >> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> >>> rkevinburton at charter.net schrieb:
> >>>> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> >>>>
> >>>>     const string DFA18_eotS =
> >>>>         "\1\uffff\2\4\3\uffff\1\4";
> >>>>     const string DFA18_eofS =
> >>>>         "\7\uffff";
> >>>>     const string DFA18_minS =
> >>>>         "\3\56\3\uffff\1\56";
> >>>>     const string DFA18_maxS =
> >>>>         "\1\71\1\56\1\71\3\uffff\1\71";
> >>>>     const string DFA18_acceptS =
> >>>>         "\3\uffff\1\2\1\3\1\1\1\uffff";
> >>>>     const string DFA18_specialS =
> >>>>         "\7\uffff}>";
> >>>>     static readonly string[] DFA18_transitionS = {
> >>>>             "\1\3\1\uffff\1\1\11\2",
> >>>>             "\1\5",
> >>>>             "\1\5\1\uffff\12\6",
> >>>>             "",
> >>>>             "",
> >>>>             "",
> >>>>             "\1\5\1\uffff\12\6"
> >>>>     };
> >>>>
> >>>> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> >>>>
> >>>> Thank you.
> >>>>
> >>>> Kevin
> >>>>
> >>> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> >>> was broken in an earlier version of ANTLR. I don't know if the newest 
> >>> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> >>>
> >>> Johannes
> > 
> 


From jaluber at gmx.de  Wed Jul 30 13:15:08 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 30 Jul 2008 22:15:08 +0200
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730152742.LLN71.185955.root@fepweb04>
References: <20080730152742.LLN71.185955.root@fepweb04>
Message-ID: <4890CBCC.6030202@gmx.de>

rkevinburton at charter.net schrieb:
> I downloaded 3.1b2 of ANTLR and replaced the references that I had with the references to the runtime->CSharp->net2.0 assemblies. Now I am down to one error:
> 
> 'Antlr.Runtime.ParserRuleReturnScope' does not contain a definition for 'start' and no extension method 'start' accepting a first argument of type 'Antlr.Runtime.ParserRuleReturnScope' could be found (are you missing a using directive or an assembly reference?)
> 
> This seems to be generated as part of the actions in the grammar. Do you know what replaced .start?
> 
> 			else if (lt.Type == EOL || (lt.Type == MultiLineComment && Regex.IsMatch(lt.Text, "/.*\r\n|\r|\n")))
> 			{
> 				// We found our EOL: promote the token to on channel, position the input on it and reset the rule start.
> 				lt.Channel = Token.DEFAULT_CHANNEL;
> 				input.Seek(lt.TokenIndex);
> 				if (rule != null)
> 				{
> 					rule.start = lt;
> 				}
> 				break;
> 			}
> 
> I am relatively new to ANTLR and this from a grammar that is for ECMAScript that is on the ANTLR grammar site. I think is what is being done here is an attempt at "auto semicolon inserstion". I think is what is supposed to happen here is that if there is no semicolon but there is an EOL then reset the parser. How that is done as apparently changed between 3.0 and 3.1. Thanks again.
> 
> Kevin

Try .Start. I've changed some declarations to match more the .NET 
conventions.

Johannes

From rusinskystanislas at yahoo.fr  Wed Jul 30 13:12:33 2008
From: rusinskystanislas at yahoo.fr (Stanislas Rusinsky)
Date: Wed, 30 Jul 2008 20:12:33 +0000 (GMT)
Subject: [antlr-interest] Re :  Combining jars
Message-ID: <763950.87956.qm@web26508.mail.ukl.yahoo.com>

Hello Terence,

it is a good idea and as long as it is clearly stated in the documentation it would ease the use of ANTLR for newcomers, versions are not so straightforward to get together by now, your simplified packaging proposal is convenient. 

Having twice stringtemplate does not look problematic to me, as it is "packaging" for simplicity sake.

May I suggest having one shared version scheme for both ANTLR and runtime packages? (something like antlr-full-3.0.jar and antlr-runtime-full-3.0.jar for example?)

Thanks for your great work,

Stanislas.



----- Message d'origine ----
De : Terence Parr <parrt at cs.usfca.edu>
? : antlr mailing list <antlr-interest at antlr.org>
Envoy? le : Mercredi, 30 Juillet 2008, 20h50mn 01s
Objet : [antlr-interest] Combining jars

Hi,  there is a proposal before the house to combine all necessary  
jars for ANTLR into a single one. any complaints if I put

antlr-2.7.7.jar
stringtemplate-3.2.jar
antlr-3.0.jar

into a single file?   Naturally, we still need the separate libraries  
for the runtime, which time makes it awkward because we need  
stringtemplate-3.2.jar sometimes also during runtime.

  any suggestions?
Ter


      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From rkevinburton at charter.net  Wed Jul 30 13:16:14 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 13:16:14 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730152742.LLN71.185955.root@fepweb04>
Message-ID: <20080730161614.92Q83.186815.root@fepweb04>

I am getting closer. This last problem is probably something wrong with the grammar. I changed start to Start and the code now compiles (yea!!) But I get a runtime error:

A first chance exception of type 'System.InvalidCastException' occurred in JScriptParser.dll

It seems to occur with the following input:

function GetSiteConfiguration(catalogContext:CatalogContext, profileManagementContext:ProfileManagementContext)
{
 return ProfileManagementConverter.SiteConfiguration(catalogContext, profileManagementContext);
}

Is what is strange is that when I put just this input into ANTLRWorks interpretor I don't get any errors.

If I put two function declarations in ANTLRWorks with the start token as functionDeclaration I also don't get any errors but I only see the tree for one declaration. I don't think it reset properly. Unlike the rror exception thrown there is no cast being attempted. Anyway it seems to be a problem with the grammar. Unless you have some suggestions on how best to debug this kind of problem I will consider this issue closed. Thank you.

Kevin


--- rkevinburton at charter.net wrote: 
> I downloaded 3.1b2 of ANTLR and replaced the references that I had with the references to the runtime->CSharp->net2.0 assemblies. Now I am down to one error:
> 
> 'Antlr.Runtime.ParserRuleReturnScope' does not contain a definition for 'start' and no extension method 'start' accepting a first argument of type 'Antlr.Runtime.ParserRuleReturnScope' could be found (are you missing a using directive or an assembly reference?)
> 
> This seems to be generated as part of the actions in the grammar. Do you know what replaced .start?
> 
> 			else if (lt.Type == EOL || (lt.Type == MultiLineComment && Regex.IsMatch(lt.Text, "/.*\r\n|\r|\n")))
> 			{
> 				// We found our EOL: promote the token to on channel, position the input on it and reset the rule start.
> 				lt.Channel = Token.DEFAULT_CHANNEL;
> 				input.Seek(lt.TokenIndex);
> 				if (rule != null)
> 				{
> 					rule.start = lt;
> 				}
> 				break;
> 			}
> 
> I am relatively new to ANTLR and this from a grammar that is for ECMAScript that is on the ANTLR grammar site. I think is what is being done here is an attempt at "auto semicolon inserstion". I think is what is supposed to happen here is that if there is no semicolon but there is an EOL then reset the parser. How that is done as apparently changed between 3.0 and 3.1. Thanks again.
> 
> Kevin
> 
> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> > rkevinburton at charter.net schrieb:
> > > I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:
> > > 
> > >         public ECMAScriptParser(ITokenStream input)
> > >     		: this(input, new RecognizerSharedState()) {
> > >         }
> > > 
> > >         public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
> > >     		: base(input, state) {
> > >     		InitializeCyclicDFAs();
> > >         }
> > > 
> > > It seems that RecognizerSharedState is no longer recognized. Any substitutes?
> > > 
> > > Thanks again.
> > > 
> > > Kevin
> > 
> > Did you use the correct assemblies? Each beta has it own version.
> > 
> > Johannes
> > > ---- rkevinburton at charter.net wrote: 
> > >> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
> > >>
> > >> Now I am confused.
> > >>
> > >> Thank you for the tips.
> > >>
> > >> Kevin
> > >>
> > >> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> > >>> rkevinburton at charter.net schrieb:
> > >>>> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> > >>>>
> > >>>>     const string DFA18_eotS =
> > >>>>         "\1\uffff\2\4\3\uffff\1\4";
> > >>>>     const string DFA18_eofS =
> > >>>>         "\7\uffff";
> > >>>>     const string DFA18_minS =
> > >>>>         "\3\56\3\uffff\1\56";
> > >>>>     const string DFA18_maxS =
> > >>>>         "\1\71\1\56\1\71\3\uffff\1\71";
> > >>>>     const string DFA18_acceptS =
> > >>>>         "\3\uffff\1\2\1\3\1\1\1\uffff";
> > >>>>     const string DFA18_specialS =
> > >>>>         "\7\uffff}>";
> > >>>>     static readonly string[] DFA18_transitionS = {
> > >>>>             "\1\3\1\uffff\1\1\11\2",
> > >>>>             "\1\5",
> > >>>>             "\1\5\1\uffff\12\6",
> > >>>>             "",
> > >>>>             "",
> > >>>>             "",
> > >>>>             "\1\5\1\uffff\12\6"
> > >>>>     };
> > >>>>
> > >>>> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> > >>>>
> > >>>> Thank you.
> > >>>>
> > >>>> Kevin
> > >>>>
> > >>> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> > >>> was broken in an earlier version of ANTLR. I don't know if the newest 
> > >>> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> > >>>
> > >>> Johannes
> > > 
> > 
> 


From florianpasco.ml at gmail.com  Wed Jul 30 13:39:48 2008
From: florianpasco.ml at gmail.com (Florian Pasco)
Date: Wed, 30 Jul 2008 22:39:48 +0200
Subject: [antlr-interest] Bug in ANTLR 3.1b2 C target?
Message-ID: <9cd6557d0807301339x7b60ebceh4501846f6c59401e@mail.gmail.com>

Hello,

I have a C source generated from a tree grammar with ANTLR 3.1b2 which
can't compile due to an undeclared identifier ADPTOR in the line :
   ADPTOR->addChild(ADAPTOR, root_0, set27_tree);

It seems like it is caused by a typo in line 146 of
src/org/antlr/codegen/templates/C/ASTTreeParser.stg.
Excuse me if this has already been reported, I could not find any
mention of it in the archives.

From antlr at mirality.co.nz  Wed Jul 30 14:08:03 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 31 Jul 2008 09:08:03 +1200
Subject: [antlr-interest] Tree Rewrite Issue with Negation (~)
In-Reply-To: <002201c8f26b$dbc6cb00$93546100$@com>
References: <002201c8f26b$dbc6cb00$93546100$@com>
Message-ID: <20080730210812.AB8A42F433B@www.antlr.org>

At 05:44 31/07/2008, Foust wrote:
>Although this works (nonsense):
>x :           ':' ( v+=(';'|'}') )* ';'  -> ^(':' $v) ;

Last time I checked, that wouldn't have worked either (= and += 
didn't work against blocks; you had to use an extra rule).  When 
did that get changed?

Or possibly it still hasn't been fixed -- depends what definition 
of "works" you're using.  Certainly in older versions of ANTLR, 
the above would compile perfectly fine but would lead to null 
references or empty lists at runtime instead of providing the 
content you're expecting.

(And incidentally, that should have been $v* in the rewrite.)


From antlr at mirality.co.nz  Wed Jul 30 14:15:26 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 31 Jul 2008 09:15:26 +1200
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730152742.LLN71.185955.root@fepweb04>
References: <4890AB5E.6050400@gmx.de>
	<20080730152742.LLN71.185955.root@fepweb04>
Message-ID: <20080730211535.A26012F433C@www.antlr.org>

At 07:27 31/07/2008, rkevinburton at charter.net wrote:
 >			else if (lt.Type == EOL || (lt.Type == MultiLineComment &&
 >Regex.IsMatch(lt.Text, "/.*\r\n|\r|\n")))
 >			{
 >				// We found our EOL: promote the token to on channel, 
position
 >the input on it and reset the rule start.
 >				lt.Channel = Token.DEFAULT_CHANNEL;
 >				input.Seek(lt.TokenIndex);
 >				if (rule != null)
 >				{
 >					rule.start = lt;
 >				}
 >				break;
 >			}

Generally in action code you should be using ANTLR's automatic 
substitution attributes.  So use '$rule.start', not 
'rule.start'.  Then the codegen will automatically convert it to 
use the Start property -- and handle cases where the local 
variable isn't called 'rule' any more.

(Maybe ANTLR should encourage this better by doing what it did in 
v2 -- adding a unique numeric suffix to each variable [and also 
munging members like 'type' in the lexer].  That way it'll 
basically force people to use the $ syntax, which will help 
insulate them against changes in the codegen...)


From parrt at cs.usfca.edu  Wed Jul 30 14:35:35 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 30 Jul 2008 14:35:35 -0700
Subject: [antlr-interest] Re :  Combining jars
In-Reply-To: <763950.87956.qm@web26508.mail.ukl.yahoo.com>
References: <763950.87956.qm@web26508.mail.ukl.yahoo.com>
Message-ID: <4CA20552-3666-42EB-BE01-6E58DFDDFE8E@cs.usfca.edu>


On Jul 30, 2008, at 1:12 PM, Stanislas Rusinsky wrote:

> Hello Terence,
>
> it is a good idea and as long as it is clearly stated in the  
> documentation it would ease the use of ANTLR for newcomers, versions  
> are not so straightforward to get together by now, your simplified  
> packaging proposal is convenient.
>
> Having twice stringtemplate does not look problematic to me, as it  
> is "packaging" for simplicity sake.
>
> May I suggest having one shared version scheme for both ANTLR and  
> runtime packages? (something like antlr-full-3.0.jar and antlr- 
> runtime-full-3.0.jar for example?)

Yes,How about

antlr-all-3.1.jar (everything needed to run the tool)
antlr-runtime-3.1.jar
stringtemplate-3.2.jar


> Thanks for your great work,

Thanks for using it :)

Ter

From jimi at temporal-wave.com  Wed Jul 30 14:58:48 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 14:58:48 -0700
Subject: [antlr-interest] Bug in ANTLR 3.1b2 C target?
In-Reply-To: <9cd6557d0807301339x7b60ebceh4501846f6c59401e@mail.gmail.com>
References: <9cd6557d0807301339x7b60ebceh4501846f6c59401e@mail.gmail.com>
Message-ID: <1217455128.9052.62.camel@jimi>

On Wed, 2008-07-30 at 22:39 +0200, Florian Pasco wrote:

> Hello,
> 
> I have a C source generated from a tree grammar with ANTLR 3.1b2 which
> can't compile due to an undeclared identifier ADPTOR in the line :
>    ADPTOR->addChild(ADAPTOR, root_0, set27_tree);
> 
> It seems like it is caused by a typo in line 146 of
> src/org/antlr/codegen/templates/C/ASTTreeParser.stg.
> Excuse me if this has already been reported, I could not find any
> mention of it in the archives.


This is fixed in b3 (but the dist tar that contains the fix will not be
checked in until later today).

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/d6f189ad/attachment-0001.html 

From rkevinburton at charter.net  Wed Jul 30 14:58:49 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 14:58:49 -0700
Subject: [antlr-interest] Illegal escape sequence in C#
In-Reply-To: <20080730161614.92Q83.186815.root@fepweb04>
Message-ID: <20080730175849.59FXS.188665.root@fepweb04>

I found the problem with "illegal cast". Again it was in the action for the grammar. The code looks like:

    		switch ((int)(lhs.Tree))

So lhs.Tree is not and cannot be converted to int. Again I am taking a grammar (ECMAScript) on the ANTLR grammar web site) and trying to get it to work with some modification is hopes of learning ANTLR better. So please be patient. How can I modify the action so that this cast is acceptable? Of should it be acceptable?
I have attached my modified version of the grammar.

Thank you.

Kevin

---- rkevinburton at charter.net wrote: 
> I am getting closer. This last problem is probably something wrong with the grammar. I changed start to Start and the code now compiles (yea!!) But I get a runtime error:
> 
> A first chance exception of type 'System.InvalidCastException' occurred in JScriptParser.dll
> 
> It seems to occur with the following input:
> 
> function GetSiteConfiguration(catalogContext:CatalogContext, profileManagementContext:ProfileManagementContext)
> {
>  return ProfileManagementConverter.SiteConfiguration(catalogContext, profileManagementContext);
> }
> 
> Is what is strange is that when I put just this input into ANTLRWorks interpretor I don't get any errors.
> 
> If I put two function declarations in ANTLRWorks with the start token as functionDeclaration I also don't get any errors but I only see the tree for one declaration. I don't think it reset properly. Unlike the rror exception thrown there is no cast being attempted. Anyway it seems to be a problem with the grammar. Unless you have some suggestions on how best to debug this kind of problem I will consider this issue closed. Thank you.
> 
> Kevin
> 
> 
> --- rkevinburton at charter.net wrote: 
> > I downloaded 3.1b2 of ANTLR and replaced the references that I had with the references to the runtime->CSharp->net2.0 assemblies. Now I am down to one error:
> > 
> > 'Antlr.Runtime.ParserRuleReturnScope' does not contain a definition for 'start' and no extension method 'start' accepting a first argument of type 'Antlr.Runtime.ParserRuleReturnScope' could be found (are you missing a using directive or an assembly reference?)
> > 
> > This seems to be generated as part of the actions in the grammar. Do you know what replaced .start?
> > 
> > 			else if (lt.Type == EOL || (lt.Type == MultiLineComment && Regex.IsMatch(lt.Text, "/.*\r\n|\r|\n")))
> > 			{
> > 				// We found our EOL: promote the token to on channel, position the input on it and reset the rule start.
> > 				lt.Channel = Token.DEFAULT_CHANNEL;
> > 				input.Seek(lt.TokenIndex);
> > 				if (rule != null)
> > 				{
> > 					rule.start = lt;
> > 				}
> > 				break;
> > 			}
> > 
> > I am relatively new to ANTLR and this from a grammar that is for ECMAScript that is on the ANTLR grammar site. I think is what is being done here is an attempt at "auto semicolon inserstion". I think is what is supposed to happen here is that if there is no semicolon but there is an EOL then reset the parser. How that is done as apparently changed between 3.0 and 3.1. Thanks again.
> > 
> > Kevin
> > 
> > ---- Johannes Luber <jaluber at gmx.de> wrote: 
> > > rkevinburton at charter.net schrieb:
> > > > I changed the "language" to be CSharp2 and that fixed the illegal escape equence (thank youl) but now the following will not compile:
> > > > 
> > > >         public ECMAScriptParser(ITokenStream input)
> > > >     		: this(input, new RecognizerSharedState()) {
> > > >         }
> > > > 
> > > >         public ECMAScriptParser(ITokenStream input, RecognizerSharedState state)
> > > >     		: base(input, state) {
> > > >     		InitializeCyclicDFAs();
> > > >         }
> > > > 
> > > > It seems that RecognizerSharedState is no longer recognized. Any substitutes?
> > > > 
> > > > Thanks again.
> > > > 
> > > > Kevin
> > > 
> > > Did you use the correct assemblies? Each beta has it own version.
> > > 
> > > Johannes
> > > > ---- rkevinburton at charter.net wrote: 
> > > >> I did a quick check and it seems that 1.2b5 is the latest version of ANTLRWorks that is offered on the web site. Should I go back to 1.1.7? What about the version of ANTLR itselft (but I thought ANTLRWorks included ANTLR).
> > > >>
> > > >> Now I am confused.
> > > >>
> > > >> Thank you for the tips.
> > > >>
> > > >> Kevin
> > > >>
> > > >> ---- Johannes Luber <jaluber at gmx.de> wrote: 
> > > >>> rkevinburton at charter.net schrieb:
> > > >>>> I am not sure what I have done but now when I generate code from ANTLRWorks it generates lines containing escape sequences that C# doesn't understand. Like:
> > > >>>>
> > > >>>>     const string DFA18_eotS =
> > > >>>>         "\1\uffff\2\4\3\uffff\1\4";
> > > >>>>     const string DFA18_eofS =
> > > >>>>         "\7\uffff";
> > > >>>>     const string DFA18_minS =
> > > >>>>         "\3\56\3\uffff\1\56";
> > > >>>>     const string DFA18_maxS =
> > > >>>>         "\1\71\1\56\1\71\3\uffff\1\71";
> > > >>>>     const string DFA18_acceptS =
> > > >>>>         "\3\uffff\1\2\1\3\1\1\1\uffff";
> > > >>>>     const string DFA18_specialS =
> > > >>>>         "\7\uffff}>";
> > > >>>>     static readonly string[] DFA18_transitionS = {
> > > >>>>             "\1\3\1\uffff\1\1\11\2",
> > > >>>>             "\1\5",
> > > >>>>             "\1\5\1\uffff\12\6",
> > > >>>>             "",
> > > >>>>             "",
> > > >>>>             "",
> > > >>>>             "\1\5\1\uffff\12\6"
> > > >>>>     };
> > > >>>>
> > > >>>> This is just a sample. There are over 400 such errors when C# tries to compile the generated code from the lexer. How do I get ANTLRWorks to generate the "right" code again?
> > > >>>>
> > > >>>> Thank you.
> > > >>>>
> > > >>>> Kevin
> > > >>>>
> > > >>> Could it be that you are using AW 1.2 beta with the CSharp target? That 
> > > >>> was broken in an earlier version of ANTLR. I don't know if the newest 
> > > >>> beta includes ANTLR 3.1b2 but you can also switch to CSharp2 as target.
> > > >>>
> > > >>> Johannes
> > > > 
> > > 
> > 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ECMAScript.g
Type: application/octet-stream
Size: 32372 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/5ee933a1/attachment-0001.obj 

From jdn at math.carleton.ca  Wed Jul 30 14:59:22 2008
From: jdn at math.carleton.ca (Jason Nielsen)
Date: Wed, 30 Jul 2008 17:59:22 -0400 (EDT)
Subject: [antlr-interest] Bug in 64bit C backend
Message-ID: <Pine.LNX.4.64.0807301758060.10097@octopus>

Hello,

I believe there is a bug in the 64 bit version of the C backend runtime since 
using the 32bit version works as expected (or it could be that I've done 
something foolish that works in 32 bit mode and not in 64 bit). I've attached a 
tar.gz with code that illustrates the problem and was as simple as I could make 
it.  The output is also below for your convenience.

With regards,
Jason


VERSION
=====================================================================
ANTLR Parser Generator  Version 3.1b2 (July 17, 2008)  1989-2008

OUTPUT
=====================================================================
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar (ARG_DEF 
int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF char d)) (BLOCK 
(VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1)) (BLOCK (= x 3) (= y 5)))))
*** glibc detected *** ./a.out: free(): invalid pointer: 0x0000000000412888 ***
======= Backtrace: =========
/lib/libc.so.6[0x2aea72f24b0a]
/lib/libc.so.6(cfree+0x8c)[0x2aea72f286fc]
./a.out[0x40fd8f]
./a.out[0x400d94]
./a.out[0x400ca5]
/lib/libc.so.6(__libc_start_main+0xf4)[0x2aea72ed0b44]
./a.out[0x400bf9]
======= Memory map: ========
00400000-0041b000 r-xp 00000000 08:16 20414825 /home/jdn/work/antlr/test/a.out
0061a000-0061c000 rw-p 0001a000 08:16 20414825 /home/jdn/work/antlr/test/a.out
0061c000-006f9000 rw-p 0061c000 00:00 0 [heap]
2aea72c95000-2aea72cb2000 r-xp 00000000 08:15 2195523 /lib/ld-2.6.1.so
2aea72cb2000-2aea72cb6000 rw-p 2aea72cb2000 00:00 0
2aea72eb1000-2aea72eb3000 rw-p 0001c000 08:15 2195523 /lib/ld-2.6.1.so
2aea72eb3000-2aea73005000 r-xp 00000000 08:15 2195970 /lib/libc-2.6.1.so
2aea73005000-2aea73204000 ---p 00152000 08:15 2195970 /lib/libc-2.6.1.so
2aea73204000-2aea73207000 r--p 00151000 08:15 2195970 /lib/libc-2.6.1.so
2aea73207000-2aea73209000 rw-p 00154000 08:15 2195970 /lib/libc-2.6.1.so
2aea73209000-2aea7320f000 rw-p 2aea73209000 00:00 0
2aea7320f000-2aea7321c000 r-xp 00000000 08:15 2195522 /lib/libgcc_s.so.1
2aea7321c000-2aea7341c000 ---p 0000d000 08:15 2195522 /lib/libgcc_s.so.1
2aea7341c000-2aea7341d000 rw-p 0000d000 08:15 2195522 /lib/libgcc_s.so.1
2aea74000000-2aea74021000 rw-p 2aea74000000 00:00 0
2aea74021000-2aea78000000 ---p 2aea74021000 00:00 0
7fff37e00000-7fff37e15000 rw-p 7fff37e00000 00:00 0 [stack]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vdso]
Aborted (core dumped)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.tar.gz
Type: application/octet-stream
Size: 2274 bytes
Desc: 
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/000dbf74/attachment.obj 

From javafoust at gmail.com  Wed Jul 30 16:38:55 2008
From: javafoust at gmail.com (Foust)
Date: Wed, 30 Jul 2008 16:38:55 -0700
Subject: [antlr-interest] Rewriting with nodes from sub-rules?
In-Reply-To: <48907140.9090300@ecircle.com>
References: <48907140.9090300@ecircle.com>
Message-ID: <003001c8f29d$6f839220$4e8ab660$@com>

edA-qa mort-ora-y wrote:
> I wish to work with the tokens of the sub-rules in the
> rewrite. It isn't clear from the book if this is possible.

I've also had a desire to do that, but couldn't find a way. I wanted to set a synthetic token, using a token from a previous rule. So using your example, if SET is a synthetic token, I was trying to create it with the same context information as a token from a previously matched rule, such as:

	... -> ^(SET[nameValue.name] ...)

It doesn't appear that we have access to a previous rule's tokens using this syntax.

-Brent
------

> 
> For example:
> 
> exprA : 'set' nameValue;
> exprB : 'define' nameValue;
> nameValue : name value;
> 
> I would like to have a rule like this:
> exprA : 'set' nameValue -> ^(SET nameValue.name nameValue.value)



From varun.bhargava at carsales.com.au  Wed Jul 30 16:55:00 2008
From: varun.bhargava at carsales.com.au (Varun Bhargava)
Date: Thu, 31 Jul 2008 09:55:00 +1000
Subject: [antlr-interest] ANTLR tree structure
Message-ID: <AE0A511AB227724A912139BAF4BBAC7103EE274C@cssvrex001.carsales.office>

Hi All,

 

I'm writing a utility to substitute parameter values in the WHERE clause
of a SQL like language. I have a sample query below and here is what I
need to do. I need to allow the user to select parameter values from a
UI (PARAM1 and PARAM2) and then just before running the query,
substitute the parameter placeholders with the values that the user has
selected.

 

SELECT a, b FROM MyExpr WHERE a = @PARAM1 AND b = @PARAM2 OR c = 34

 

I have written the grammar and the parser that recognises the above
statements and creates an AST. The where clause is rooted at the WHERE
node. There is another root for the comparisons

 

So the tree for the WHERE clause would look like 

 

WHERE

|

A ----------AND------b-------OR-----------c

|                             |                             |

= --- @PARAM1         = --- @PARAM2         = 34     

 

 

 

If @PARAM1 or @PARAM2 is NULL then the comparison clause needs to be
removed from the where clause. The problem then arises that I might have
hanging instances of AND or OR without a left or right hand side. And if
brackets are used, it complicated things further.

 

So after substituting parameter values and deleting unwanted nodes, when
I recreate the queryString form the tree it might look like (assuming
@PARAM1 is null

 

SELECT a, b FROM MyExpr WHERE AND b = 'substituted param2' OR c = 34

 

The only way I can think is to manually then walk the tree to find such
occurances and fix them. Is there an automatic/elegant way to resolve
this? Any help would be appreciated.

 

Thanks

Varun

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/3fc7278c/attachment.html 

From javafoust at gmail.com  Wed Jul 30 17:00:10 2008
From: javafoust at gmail.com (Foust)
Date: Wed, 30 Jul 2008 17:00:10 -0700
Subject: [antlr-interest] Tree Rewrite Issue with Negation (~)
In-Reply-To: <4890d83c.0627360a.116b.3e5aSMTPIN_ADDED@mx.google.com>
References: <002201c8f26b$dbc6cb00$93546100$@com>
	<4890d83c.0627360a.116b.3e5aSMTPIN_ADDED@mx.google.com>
Message-ID: <003101c8f2a0$6755e230$3601a690$@com>

At 2:08 PM Gavin Lambert wrote:
> At 05:44 31/07/2008, Foust wrote:
> >Although this works (nonsense):
> >x :           ':' ( v+=(';'|'}') )* ';'  -> ^(':' $v) ;
> 
> Last time I checked, that wouldn't have worked either (= and +=
> didn't work against blocks; you had to use an extra rule). 

Yes, the content may not have all been there -- just generated the grammar
successfully (no internal error).

Page 146 of the DAR only shows an example using a single token "ids+=ID (','
ids+=ID)*", but it just seemed like a logical extension that it would work
for synthetic tokens specified as an inline union, as well. The tilde
operator is doing its job on the union of tokens -- it's just the +=
operator that's having trouble storing the result.

And that's probably what causes the internal error when a tree rewrite rule
is added, because only then is the value of $v actually used.

This seems like something that would make sense to support, although in the
mean time, a better error message would help.

> 
> Or possibly it still hasn't been fixed -- depends what definition
> of "works" you're using.  Certainly in older versions of ANTLR,
> the above would compile perfectly fine but would lead to null
> references or empty lists at runtime instead of providing the
> content you're expecting.
> 
> (And incidentally, that should have been $v* in the rewrite.)

Yes, thank you for your comments and for looking so closely.

Brent


From jimi at temporal-wave.com  Wed Jul 30 17:44:05 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 17:44:05 -0700
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <Pine.LNX.4.64.0807301758060.10097@octopus>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
Message-ID: <1217465045.9052.81.camel@jimi>

On Wed, 2008-07-30 at 17:59 -0400, Jason Nielsen wrote:

> Hello,
> 
> I believe there is a bug in the 64 bit version of the C backend runtime since 
> using the 32bit version works as expected (or it could be that I've done 
> something foolish that works in 32 bit mode and not in 64 bit). I've attached a 
> tar.gz with code that illustrates the problem and was as simple as I could make 
> it.  The output is also below for your convenience.


I think you may have just run into a bug that I have fixed today is all.
It is just luck of the draw whether something works or not when memory
corruption is involved so you will likely get different behaviors in 32
and 64 bit mode. But, i am not sure because your code is in error.

However, your code does not guard against errors and so on, and your
main program is trying to print a string that you have already freed in
your translate() function. You need to strdup that return string
otherwise it will be deallocated when you free the nodes and then you
try to print it. This may actaully be your problem,

The problem I fixed today involves thigns going slightly awry when a
syntax error is encountered by a tree parser. Your programs give me (10
times):

gcc -g -O2 -fPIC -m64 main.c translate.c *Lexer.c *Parser.c *Walker.c
-lantlr3c -I /tmp/test
jimi at jimi:/tmp/test$ ./a.out
-Imaginary-(0)  : error 10 : Unexpected node, at offset 0, near <missing
<invalid>> : Missing <invalid> 
-Imaginary-(0)  : error 9 : Extraneous token, at offset 0, near <missing
ID> : Extraneous input - expected <DOWN> ...
-Imaginary-(0)  : error 9 : Extraneous token, at offset 0, near <missing
ID> : Extraneous input - expected <DOWN> ...
-Imaginary-(0)  : error 10 : Missing token, at offset 93, near <missing
ID> : Missing ID 
-Imaginary-(0)  : error 3 : , at offset 0, near UP : cannot match to any
predicted input...
-Imaginary-(0)  : error 3 : , at offset 0, near UP : cannot match to any
predicted input...
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo ARG_DEF ARG_DEF) (BLOCK
(VAR_DEF int i) (for = (< i 3) = (BLOCK = =))))

Another issue is that that runtime version causes an erroneous free of
the input string in the in place stream (also fixed today). Try running
it once or download the beat 3 runtime from Fisheye,

Which tends to make me think that perhaps there is something wrong with
your input, or perhaps you have modified the sample grammars? Or perhaps
my current development version has another error. Fix your coding error
and see what you get back then.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/ec4997bb/attachment-0001.html 

From pcc482719 at gmail.com  Wed Jul 30 18:26:54 2008
From: pcc482719 at gmail.com (Peter C. Chapin)
Date: Wed, 30 Jul 2008 21:26:54 -0400
Subject: [antlr-interest] Problems with the ANTLRworks interpreter.
Message-ID: <489114DE.3080209@gmail.com>

Hello!

I'm using ANTLRworks 1.1.7 and I'm building a grammar for a C-like 
language. I've created some unit tests for my grammar... specifically a 
collection of files containing text that is intended to be syntactically 
correct. My test program loops over these files, instantiates a parser 
for each (one at a time), and tries to parse them all. I use various 
start symbols to exercise parts of the grammar incrementally in these 
tests (helps to isolate errors).

So, given a file containing just

A = B

my test program successfully parses this using a start symbol of 
'expresion.' This is fine. However, when I use the ANTLRworks 
interpreter and enter the text 'A = B' I get a 'NoViableAltException.' I 
noticed that the interpreter is ignoring my WHITSPACE rule so I removed 
the white space from the text (using 'A=B') but that didn't help. In 
fact, the interpreter produces a NoViableAltException even when I just 
use 'A' as input text. However, a bare identifier is a valid expression 
in my target language (and it parses fine when using the test program I 
described above).

I'm think I am missing something fundamental about how the interpreter 
is supposed to work. I'm hoping someone can set my feet upon the path of 
enlightenment! I did check the on-line ANTLRworks user's guide, but the 
section on the interpreter doesn't shed much light on my question.

P.S. I do have backtracking mode turned on right now in my grammar's 
option. Could that have something to do with it?

Peter


From rkevinburton at charter.net  Wed Jul 30 18:35:27 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Wed, 30 Jul 2008 18:35:27 -0700
Subject: [antlr-interest] Problems with the ANTLRworks interpreter.
In-Reply-To: <489114DE.3080209@gmail.com>
Message-ID: <20080730213527.72ASK.192048.root@fepweb04>

I don't know if this will help but I have found that the output changes based on the line ending selected (Unix(LF) or MS(CR LF).

Kevin

---- "Peter C. Chapin" <pcc482719 at gmail.com> wrote: 
> Hello!
> 
> I'm using ANTLRworks 1.1.7 and I'm building a grammar for a C-like 
> language. I've created some unit tests for my grammar... specifically a 
> collection of files containing text that is intended to be syntactically 
> correct. My test program loops over these files, instantiates a parser 
> for each (one at a time), and tries to parse them all. I use various 
> start symbols to exercise parts of the grammar incrementally in these 
> tests (helps to isolate errors).
> 
> So, given a file containing just
> 
> A = B
> 
> my test program successfully parses this using a start symbol of 
> 'expresion.' This is fine. However, when I use the ANTLRworks 
> interpreter and enter the text 'A = B' I get a 'NoViableAltException.' I 
> noticed that the interpreter is ignoring my WHITSPACE rule so I removed 
> the white space from the text (using 'A=B') but that didn't help. In 
> fact, the interpreter produces a NoViableAltException even when I just 
> use 'A' as input text. However, a bare identifier is a valid expression 
> in my target language (and it parses fine when using the test program I 
> described above).
> 
> I'm think I am missing something fundamental about how the interpreter 
> is supposed to work. I'm hoping someone can set my feet upon the path of 
> enlightenment! I did check the on-line ANTLRworks user's guide, but the 
> section on the interpreter doesn't shed much light on my question.
> 
> P.S. I do have backtracking mode turned on right now in my grammar's 
> option. Could that have something to do with it?
> 
> Peter
> 


From jimi at temporal-wave.com  Wed Jul 30 19:50:44 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Jul 2008 19:50:44 -0700
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <Pine.LNX.4.64.0807301758060.10097@octopus>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
Message-ID: <1217472644.9052.86.camel@jimi>

On Wed, 2008-07-30 at 17:59 -0400, Jason Nielsen wrote:

> Hello,
> 
> I believe there is a bug in the 64 bit version of the C backend runtime since 
> using the 32bit version works as expected (or it could be that I've done 
> something foolish that works in 32 bit mode and not in 64 bit). I've attached a 
> tar.gz with code that illustrates the problem and was as simple as I could make 
> it.  The output is also below for your convenience.
> 

IN fact my development version did have a bug because I was in the
middle of fixing something else. I just completed that fix and now i
get:

./a.out
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
(ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
(BLOCK (= x 3) (= y 5)))))


Once I fixed your translate() function and using the b3 runtime tar.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080730/f0c77290/attachment.html 

From jdn at math.carleton.ca  Wed Jul 30 20:26:36 2008
From: jdn at math.carleton.ca (Jason Nielsen)
Date: Wed, 30 Jul 2008 23:26:36 -0400 (EDT)
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <1217472644.9052.86.camel@jimi>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
	<1217472644.9052.86.camel@jimi>
Message-ID: <Pine.LNX.4.64.0807302307260.32386@taz>

> IN fact my development version did have a bug because I was in the 
> middle of fixing something else. I just completed that fix and now i 
> get:
>
> ./a.out
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
> (BLOCK (= x 3) (= y 5)))))
>
>
> Once I fixed your translate() function and using the b3 runtime tar.
>

Thank you.  Can you point out to me the problem with my translate() 
function?  My C programming skills are surely lacking.  My previous ANTLR 
experience is via the java interface but now I need to link my translator 
into lisp and hence the need for C seeing as there is a nice C ffi for 
sbcl... java however not so much.

Thanks again,
Jason

From Austin_Hastings at Yahoo.com  Wed Jul 30 21:05:02 2008
From: Austin_Hastings at Yahoo.com (Austin Hastings)
Date: Wed, 30 Jul 2008 23:05:02 -0500
Subject: [antlr-interest] ENHANCEMENT: Friendlier parser class,
 syntactic sugar for top level production.
Message-ID: <489139EE.3000905@Yahoo.com>

I didn't see this in the 3.1b? release notes, so I thought I'd ask for 
it again.

I'd like to see the Parser class come with a .parse(...) method. This 
would do what the examples suggest: create  a lexer, etc., and then 
invoke the top level production.

Obviously, you could override this. If you do, then no harm done. But 
most people are doing the same things, so why should the code generator 
generate the last little bit that they need?

Equally obviously, there would need to be a way to identify the  top 
level production. The most obvious way is to use the first one 
encountered. A slightly better way would be to add some syntax to 
identify it. Either as an option, or as a rule attribute:

options {
    language = Java;
    main_rule = compilation_unit;
}

// or

algebraic_expr
    : ...
    ;

boolean_expr
    : ...
    ;

compilation_unit
    @main_rule
    : ...
    ;


=Austin


From craig at palantir.co.za  Thu Jul 31 00:12:23 2008
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Thu, 31 Jul 2008 09:12:23 +0200
Subject: [antlr-interest] Tricky rewrite (for me anyway)
Message-ID: <20080731091223.2udxa1zw4co40c8o@webmail.palantir.co.za>

Hi Varun,

Glad to hear I am not alone!

I have not been able to get it right yet. I think its a simple problem, so
someone will give us a hand soon I am sure.

Cheers
Craig.

>> Hi Craig,

>> Have you found the answer to this yet? I'm having the exactly same problem!

>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of craig at palantir.co.za
>> Sent: Wednesday, 30 July 2008 23:59
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Tricky rewrite (for me anyway)

>> Hi all,

>> I am struggling with a tricky little rewrite rule.
>> I have managed to get this to work using a deep tree.
>> By that I mean:
>>         rule (('and'|'or')^ rule)* ;

>> I changed it recently to a simple list as follows.
>> The nodes are now siblings, which is what I want.

>> rules:	rule (('and'|'or') rule)*
>>                 ;
>> I need to figure out how to rewrite the above rule to put the 'and' or 'or'
in front so that the tree can match properly.

>> The tree then matches as follows:
>> Unfortunately due to the nature of the matching, I only get the last match in
the tree, not the 'or' or 'and'. I have looked at the tree and this structure
should work. I figure I need to put the 'and' or 'or' in front.
>> path : ^(ROOT xname* 'and')
>>      | ^(ROOT xname* 'or')
>>      | ^(ROOT xname*)
>>      ;

>> I need to make a tree like this.
>> path : ^(ROOT 'and' xname*)
>>         | ^(ROOT 'or' xname*)
>>         | ^(ROOT xname*)
>>         ;

>> because then the tree will work. How do I rewrite the tree to make it work?


>> ----------------------------------------------------------------
>> This message was sent using IMP, the Internet Messaging Program.






----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From jaluber at gmx.de  Thu Jul 31 02:45:02 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 11:45:02 +0200
Subject: [antlr-interest] ENHANCEMENT: Friendlier parser class,
 syntactic sugar for top level production.
In-Reply-To: <489139EE.3000905@Yahoo.com>
References: <489139EE.3000905@Yahoo.com>
Message-ID: <4891899E.8070806@gmx.de>

Austin Hastings schrieb:
> I didn't see this in the 3.1b? release notes, so I thought I'd ask for 
> it again.
> 
> I'd like to see the Parser class come with a .parse(...) method. This 
> would do what the examples suggest: create  a lexer, etc., and then 
> invoke the top level production.
> 
> Obviously, you could override this. If you do, then no harm done. But 
> most people are doing the same things, so why should the code generator 
> generate the last little bit that they need?
> 
> Equally obviously, there would need to be a way to identify the  top 
> level production. The most obvious way is to use the first one 
> encountered. A slightly better way would be to add some syntax to 
> identify it. Either as an option, or as a rule attribute:
> 
> options {
>    language = Java;
>    main_rule = compilation_unit;
> }
> 
> // or
> 
> algebraic_expr
>    : ...
>    ;
> 
> boolean_expr
>    : ...
>    ;
> 
> compilation_unit
>    @main_rule
>    : ...
>    ;
> 
> 
> =Austin
> 

Another possibility is to look for a rule with EOF. There should be only 
one rule anyway with EOF at its end and that is the top rule. Until name 
mangling is introduced, using parse() as standard point of entry causes 
a naming conflict with a real parse rule, though. But I haven't seen a 
grammar yet where a rule named parse makes sense, so this may not happen 
often.

Johannes

From rusinskystanislas at yahoo.fr  Thu Jul 31 02:53:04 2008
From: rusinskystanislas at yahoo.fr (Stanislas Rusinsky)
Date: Thu, 31 Jul 2008 09:53:04 +0000 (GMT)
Subject: [antlr-interest] Re :  Re :  Combining jars
Message-ID: <477191.12154.qm@web26508.mail.ukl.yahoo.com>

For ease of use you could also propose a grouped jar (antlr-runtime-all-3.1.jar) combining antlr-runtime-3.1.jar stringtemplate-3.2.jar in addition. This would allow to use only one jar  for every use case, one for the tool and one for the runtime, even if you use templates. Does that suggestion sounds good to you?

Stanislas.



----- Message d'origine ----
De : Terence Parr <parrt at cs.usfca.edu>
? : Stanislas Rusinsky <rusinskystanislas at yahoo.fr>
Cc : antlr mailing list <antlr-interest at antlr.org>
Envoy? le : Mercredi, 30 Juillet 2008, 23h35mn 35s
Objet : Re: [antlr-interest] Re :  Combining jars


On Jul 30, 2008, at 1:12 PM, Stanislas Rusinsky wrote:

> Hello Terence,
>
> it is a good idea and as long as it is clearly stated in the  
> documentation it would ease the use of ANTLR for newcomers, versions  
> are not so straightforward to get together by now, your simplified  
> packaging proposal is convenient.
>
> Having twice stringtemplate does not look problematic to me, as it  
> is "packaging" for simplicity sake.
>
> May I suggest having one shared version scheme for both ANTLR and  
> runtime packages? (something like antlr-full-3.0.jar and antlr- 
> runtime-full-3.0.jar for example?)

Yes,How about

antlr-all-3.1.jar (everything needed to run the tool)
antlr-runtime-3.1.jar
stringtemplate-3.2.jar


> Thanks for your great work,

Thanks for using it :)

Ter



      _____________________________________________________________________________ 
Envoyez avec Yahoo! Mail. Une boite mail plus intelligente http://mail.yahoo.fr

From r.a.niemeijer at tue.nl  Thu Jul 31 02:58:59 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Thu, 31 Jul 2008 11:58:59 +0200
Subject: [antlr-interest] Bug when using multi-parameter generics as return
	values?
Message-ID: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>

Hello everyone,

 

I have a question about using generics as return values (with C# as the
target language). When the generic has only one parameter everything
works correctly, e.g.

 

elements[Scene scene] returns [IEnumerable<BuildingElement> elems]

                :               ELEMS p=piece { $elems =
(IEnumerable<BuildingElement>)p.piece.Eval(scene); }

                ;

 

However, when I want to return a generic with more than one parameter,
e.g. a Func<BuildingElement, int>, the code generation screws up: it
splits the type at the comma, giving one line with Func<BuildingElement
and one with int>, which obviously results in a compile error.

It is possible to get around this problem with using-statements, such as

 

using FBI = System.Func<BuildingElement, int>;

 

and then saying returns [FBI func]. However, this is far from elegant,
especially when you have a lot of different types. Is there a correct
way to do this or if not, has this bug been fixed since Antlr 3.0.1?

 

Thanks in advance.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/d8eae4c5/attachment.html 

From jaluber at gmx.de  Thu Jul 31 03:23:33 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 12:23:33 +0200
Subject: [antlr-interest] Bug when using multi-parameter generics as
 return values?
In-Reply-To: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>
References: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>
Message-ID: <489192A5.40809@gmx.de>

Niemeijer, R.A. schrieb:
> Hello everyone,
> 
> I have a question about using generics as return values (with C# as the 
> target language). When the generic has only one parameter everything 
> works correctly, e.g.
> 
> elements[Scene scene] returns [IEnumerable<BuildingElement> elems]
> 
>                 :               ELEMS p=piece { $elems = 
> (IEnumerable<BuildingElement>)p.piece.Eval(scene); }
>                 ;
> 
> However, when I want to return a generic with more than one parameter, 
> e.g. a Func<BuildingElement, int>, the code generation screws up: it 
> splits the type at the comma, giving one line with Func<BuildingElement 
> and one with int>, which obviously results in a compile error.
> 
> It is possible to get around this problem with using-statements, such as
> 
> using FBI = System.Func<BuildingElement, int>;
> 
> and then saying returns [FBI func]. However, this is far from elegant, 
> especially when you have a lot of different types. Is there a correct 
> way to do this or if not, has this bug been fixed since Antlr 3.0.1?
> 
> Thanks in advance.

Try the newest beta. I believe some bugs regarding the handling of 
generics have been fiyed. Possibly you may need to escape <, >, [ and ] 
with a \.

Johannes


From pcc482719 at gmail.com  Thu Jul 31 03:58:29 2008
From: pcc482719 at gmail.com (Peter C. Chapin)
Date: Thu, 31 Jul 2008 06:58:29 -0400
Subject: [antlr-interest] Problems with the ANTLRworks interpreter.
In-Reply-To: <20080730213527.72ASK.192048.root@fepweb04>
References: <20080730213527.72ASK.192048.root@fepweb04>
Message-ID: <48919AD5.3080207@gmail.com>

rkevinburton at charter.net wrote:

> I don't know if this will help but I have found that the output changes based on the line ending selected (Unix(LF) or MS(CR LF).
>   

I tried playing with that setting but it didn't seem to make any difference.

Today I tried interpreting just 'A' (a bare identifier) as a 
'primary_expression' instead of as an expression. In that case I get a  
FailedPredicateException instead of a NoViableAltException. So that does 
make it sound like the issue is related to backtracking (keep in mind 
that these failures only seem to occur in the ANTLRworks interpreter).

Thanks for your suggestion!

Peter

>> Hello!
>>
>> I'm using ANTLRworks 1.1.7 and I'm building a grammar for a C-like 
>> language. I've created some unit tests for my grammar... specifically a 
>> collection of files containing text that is intended to be syntactically 
>> correct. My test program loops over these files, instantiates a parser 
>> for each (one at a time), and tries to parse them all. I use various 
>> start symbols to exercise parts of the grammar incrementally in these 
>> tests (helps to isolate errors).
>>
>> So, given a file containing just
>>
>> A = B
>>
>> my test program successfully parses this using a start symbol of 
>> 'expresion.' This is fine. However, when I use the ANTLRworks 
>> interpreter and enter the text 'A = B' I get a 'NoViableAltException.' I 
>> noticed that the interpreter is ignoring my WHITSPACE rule so I removed 
>> the white space from the text (using 'A=B') but that didn't help. In 
>> fact, the interpreter produces a NoViableAltException even when I just 
>> use 'A' as input text. However, a bare identifier is a valid expression 
>> in my target language (and it parses fine when using the test program I 
>> described above).
>>
>> I'm think I am missing something fundamental about how the interpreter 
>> is supposed to work. I'm hoping someone can set my feet upon the path of 
>> enlightenment! I did check the on-line ANTLRworks user's guide, but the 
>> section on the interpreter doesn't shed much light on my question.
>>
>> P.S. I do have backtracking mode turned on right now in my grammar's 
>> option. Could that have something to do with it?
>>
>> Peter
>>     

From r.a.niemeijer at tue.nl  Thu Jul 31 05:07:52 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Thu, 31 Jul 2008 14:07:52 +0200
Subject: [antlr-interest] Bug when using multi-parameter generics as
	return values?
In-Reply-To: <489192A5.40809@gmx.de>
References: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>
	<489192A5.40809@gmx.de>
Message-ID: <A8F615EE446C9B4D837FB67447C0D997024D21CA@EXCHANGE3.campus.tue.nl>

I switched to AntlrWorks 1.2b5 and Antlr 3.1b2.
Unfortunately this causes two problems.

The generated code for both the lexer and parser contains a group of
code that looks like this (the real version is longer):

const string DFA3_eotS =
        "\1\uffff\1\17\31\uffff";
    const string DFA3_eofS =
        "\33\uffff";
    const string DFA3_minS =
 
"\1\52\1\105\10\uffff\1\125\2\uffff\1\106\2\uffff\1\116\2\uffff"+
        "\1\103\1\61\2\105\4\uffff";

This causes compile errors. These can be overcome by putting @'s in
front of the strings, but that is not something you want to do after
every code generation.

Also, the code

var input = sequence.Select(p => p.ParserText).Flatten();
var lexer = new PuzzleLexer(new ANTLRStringStream(input));

now throws a TypeInitializationException with an InnerException of
"Index was outside the bounds of the array."

I have the suspicion that both of these have to do with encoding, but
I'm not sure. Does anyone happen to know the solution to these problems?

Thanks.

-----Original Message-----
From: Johannes Luber [mailto:jaluber at gmx.de] 
Sent: donderdag 31 juli 2008 12:24
To: Niemeijer, R.A.
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Bug when using multi-parameter generics as
return values?

Niemeijer, R.A. schrieb:
> Hello everyone,
> 
> I have a question about using generics as return values (with C# as
the 
> target language). When the generic has only one parameter everything 
> works correctly, e.g.
> 
> elements[Scene scene] returns [IEnumerable<BuildingElement> elems]
> 
>                 :               ELEMS p=piece { $elems = 
> (IEnumerable<BuildingElement>)p.piece.Eval(scene); }
>                 ;
> 
> However, when I want to return a generic with more than one parameter,

> e.g. a Func<BuildingElement, int>, the code generation screws up: it 
> splits the type at the comma, giving one line with
Func<BuildingElement 
> and one with int>, which obviously results in a compile error.
> 
> It is possible to get around this problem with using-statements, such
as
> 
> using FBI = System.Func<BuildingElement, int>;
> 
> and then saying returns [FBI func]. However, this is far from elegant,

> especially when you have a lot of different types. Is there a correct 
> way to do this or if not, has this bug been fixed since Antlr 3.0.1?
> 
> Thanks in advance.

Try the newest beta. I believe some bugs regarding the handling of 
generics have been fiyed. Possibly you may need to escape <, >, [ and ] 
with a \.

Johannes


From e.mortoray at ecircle.com  Thu Jul 31 05:28:55 2008
From: e.mortoray at ecircle.com (edA-qa mort-ora-y)
Date: Thu, 31 Jul 2008 14:28:55 +0200
Subject: [antlr-interest] importing tokens in Python
Message-ID: <4891B007.4030109@ecircle.com>

In Python if I want to refer to the tokens I need to do an import
something like this (the only example I could find online did this):
    from SchemaLexer import (SchemaLexer, ENTITY, DEFAULT, MAPPER,
PROVIDER )

Is there some way to import all these tokens?  Or better, import them
inside a class or something, so they don't pollute the main namespace?

-- 
edA-qa mort-ora-y
Director Quality Assurance
______________________________________________________
eCircle AG - Inside Digital Marketing
Nymphenburger Str. 86
80636 M?nchen

Tel    +49-89-12009-773
Fax    +49-89-12009-750

E-Mail mailto:e.mort-ora-y at ecircle.com
Web    http://www.ecircle.com

______________________________________________________
Aktuelles
"Inside Digital Marketing" - der Newsletter f?r die
Online-Branche von eCircle. Jeden Monat neu & voll
mit aktuellen Fallstudien und hilfreichen Tipps!
Jetzt kostenlos abonnieren:

http://www.ecircle.com/de/newsletter
______________________________________________________

eCircle AG, HRB 136 334, Handelsregister M?nchen
Vorstand:  Lothar Lanz, Volker Wiewer (Vorsitzende), 
Thomas Wilke, Lars W?ssner, Alexander Meyer
Vorsitzender des Aufsichtsrates: Dr. Mark W?ssner


From e.mortoray at ecircle.com  Thu Jul 31 05:39:33 2008
From: e.mortoray at ecircle.com (edA-qa mort-ora-y)
Date: Thu, 31 Jul 2008 14:39:33 +0200
Subject: [antlr-interest] importing tokens in Python
In-Reply-To: <4891B007.4030109@ecircle.com>
References: <4891B007.4030109@ecircle.com>
Message-ID: <4891B285.5080506@ecircle.com>

edA-qa mort-ora-y wrote:
> In Python if I want to refer to the tokens I need to do an import
> something like this (the only example I could find online did this):
>     from SchemaLexer import (SchemaLexer, ENTITY, DEFAULT, MAPPER,
> PROVIDER )
>
> Is there some way to import all these tokens?  Or better, import them
> inside a class or something, so they don't pollute the main namespace?
>   
I can answer my own question own, something like this works:

    import SchemaLexer as SL;
then use this syntax:
    SL.TOKEN


-- 
edA-qa mort-ora-y
Director Quality Assurance
______________________________________________________
eCircle AG - Inside Digital Marketing
Nymphenburger Str. 86
80636 M?nchen

Tel    +49-89-12009-773
Fax    +49-89-12009-750

E-Mail mailto:e.mort-ora-y at ecircle.com
Web    http://www.ecircle.com

______________________________________________________
Aktuelles
"Inside Digital Marketing" - der Newsletter f?r die
Online-Branche von eCircle. Jeden Monat neu & voll
mit aktuellen Fallstudien und hilfreichen Tipps!
Jetzt kostenlos abonnieren:

http://www.ecircle.com/de/newsletter
______________________________________________________

eCircle AG, HRB 136 334, Handelsregister M?nchen
Vorstand:  Lothar Lanz, Volker Wiewer (Vorsitzende), 
Thomas Wilke, Lars W?ssner, Alexander Meyer
Vorsitzender des Aufsichtsrates: Dr. Mark W?ssner


From jaluber at gmx.de  Thu Jul 31 06:20:58 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 15:20:58 +0200
Subject: [antlr-interest] Bug when using multi-parameter generics as
 return values?
In-Reply-To: <A8F615EE446C9B4D837FB67447C0D997024D21CA@EXCHANGE3.campus.tue.nl>
References: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>
	<489192A5.40809@gmx.de>
	<A8F615EE446C9B4D837FB67447C0D997024D21CA@EXCHANGE3.campus.tue.nl>
Message-ID: <4891BC3A.7010500@gmx.de>

Niemeijer, R.A. schrieb:
> I switched to AntlrWorks 1.2b5 and Antlr 3.1b2.
> Unfortunately this causes two problems.
> 
> The generated code for both the lexer and parser contains a group of
> code that looks like this (the real version is longer):
> 
> const string DFA3_eotS =
>         "\1\uffff\1\17\31\uffff";
>     const string DFA3_eofS =
>         "\33\uffff";
>     const string DFA3_minS =
>  
> "\1\52\1\105\10\uffff\1\125\2\uffff\1\106\2\uffff\1\116\2\uffff"+
>         "\1\103\1\61\2\105\4\uffff";
> 
> This causes compile errors. These can be overcome by putting @'s in
> front of the strings, but that is not something you want to do after
> every code generation.

Are you using CSharp as the target? AW 1.2b5 uses still ANTLR 3.1b1 
which contains the bug you encounter above (although using @'s to "fix" 
it won't actually work - use the command line or the CSharp2 target 
which has further improvements like being maintained beyound ANTLR 3.2).
> 
> Also, the code
> 
> var input = sequence.Select(p => p.ParserText).Flatten();
> var lexer = new PuzzleLexer(new ANTLRStringStream(input));
> 
> now throws a TypeInitializationException with an InnerException of
> "Index was outside the bounds of the array."
> 
> I have the suspicion that both of these have to do with encoding, but
> I'm not sure. Does anyone happen to know the solution to these problems?
> 
> Thanks.

If the encoding doesn't cause the bug tell me about it.

Johannes
> 
> -----Original Message-----
> From: Johannes Luber [mailto:jaluber at gmx.de] 
> Sent: donderdag 31 juli 2008 12:24
> To: Niemeijer, R.A.
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Bug when using multi-parameter generics as
> return values?
> 
> Niemeijer, R.A. schrieb:
>> Hello everyone,
>>
>> I have a question about using generics as return values (with C# as
> the 
>> target language). When the generic has only one parameter everything 
>> works correctly, e.g.
>>
>> elements[Scene scene] returns [IEnumerable<BuildingElement> elems]
>>
>>                 :               ELEMS p=piece { $elems = 
>> (IEnumerable<BuildingElement>)p.piece.Eval(scene); }
>>                 ;
>>
>> However, when I want to return a generic with more than one parameter,
> 
>> e.g. a Func<BuildingElement, int>, the code generation screws up: it 
>> splits the type at the comma, giving one line with
> Func<BuildingElement 
>> and one with int>, which obviously results in a compile error.
>>
>> It is possible to get around this problem with using-statements, such
> as
>> using FBI = System.Func<BuildingElement, int>;
>>
>> and then saying returns [FBI func]. However, this is far from elegant,
> 
>> especially when you have a lot of different types. Is there a correct 
>> way to do this or if not, has this bug been fixed since Antlr 3.0.1?
>>
>> Thanks in advance.
> 
> Try the newest beta. I believe some bugs regarding the handling of 
> generics have been fiyed. Possibly you may need to escape <, >, [ and ] 
> with a \.
> 
> Johannes
> 


From r.a.niemeijer at tue.nl  Thu Jul 31 06:20:25 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Thu, 31 Jul 2008 15:20:25 +0200
Subject: [antlr-interest] Bug when using multi-parameter generics as
	return values?
In-Reply-To: <4891BC3A.7010500@gmx.de>
References: <A8F615EE446C9B4D837FB67447C0D997024D215A@EXCHANGE3.campus.tue.nl>
	<489192A5.40809@gmx.de>
	<A8F615EE446C9B4D837FB67447C0D997024D21CA@EXCHANGE3.campus.tue.nl>
	<4891BC3A.7010500@gmx.de>
Message-ID: <A8F615EE446C9B4D837FB67447C0D997024D21FE@EXCHANGE3.campus.tue.nl>

Yep, setting the target to CSharp2 solved both problems.

Thanks!

-----Original Message-----
From: Johannes Luber [mailto:jaluber at gmx.de] 
Sent: donderdag 31 juli 2008 15:21
To: Niemeijer, R.A.
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Bug when using multi-parameter generics as
return values?

Niemeijer, R.A. schrieb:
> I switched to AntlrWorks 1.2b5 and Antlr 3.1b2.
> Unfortunately this causes two problems.
> 
> The generated code for both the lexer and parser contains a group of
> code that looks like this (the real version is longer):
> 
> const string DFA3_eotS =
>         "\1\uffff\1\17\31\uffff";
>     const string DFA3_eofS =
>         "\33\uffff";
>     const string DFA3_minS =
>  
> "\1\52\1\105\10\uffff\1\125\2\uffff\1\106\2\uffff\1\116\2\uffff"+
>         "\1\103\1\61\2\105\4\uffff";
> 
> This causes compile errors. These can be overcome by putting @'s in
> front of the strings, but that is not something you want to do after
> every code generation.

Are you using CSharp as the target? AW 1.2b5 uses still ANTLR 3.1b1 
which contains the bug you encounter above (although using @'s to "fix" 
it won't actually work - use the command line or the CSharp2 target 
which has further improvements like being maintained beyound ANTLR 3.2).
> 
> Also, the code
> 
> var input = sequence.Select(p => p.ParserText).Flatten();
> var lexer = new PuzzleLexer(new ANTLRStringStream(input));
> 
> now throws a TypeInitializationException with an InnerException of
> "Index was outside the bounds of the array."
> 
> I have the suspicion that both of these have to do with encoding, but
> I'm not sure. Does anyone happen to know the solution to these
problems?
> 
> Thanks.

If the encoding doesn't cause the bug tell me about it.

Johannes
> 
> -----Original Message-----
> From: Johannes Luber [mailto:jaluber at gmx.de] 
> Sent: donderdag 31 juli 2008 12:24
> To: Niemeijer, R.A.
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Bug when using multi-parameter generics
as
> return values?
> 
> Niemeijer, R.A. schrieb:
>> Hello everyone,
>>
>> I have a question about using generics as return values (with C# as
> the 
>> target language). When the generic has only one parameter everything 
>> works correctly, e.g.
>>
>> elements[Scene scene] returns [IEnumerable<BuildingElement> elems]
>>
>>                 :               ELEMS p=piece { $elems = 
>> (IEnumerable<BuildingElement>)p.piece.Eval(scene); }
>>                 ;
>>
>> However, when I want to return a generic with more than one
parameter,
> 
>> e.g. a Func<BuildingElement, int>, the code generation screws up: it 
>> splits the type at the comma, giving one line with
> Func<BuildingElement 
>> and one with int>, which obviously results in a compile error.
>>
>> It is possible to get around this problem with using-statements, such
> as
>> using FBI = System.Func<BuildingElement, int>;
>>
>> and then saying returns [FBI func]. However, this is far from
elegant,
> 
>> especially when you have a lot of different types. Is there a correct

>> way to do this or if not, has this bug been fixed since Antlr 3.0.1?
>>
>> Thanks in advance.
> 
> Try the newest beta. I believe some bugs regarding the handling of 
> generics have been fiyed. Possibly you may need to escape <, >, [ and
] 
> with a \.
> 
> Johannes
> 


From r_reitzi at cs.uni-kl.de  Thu Jul 31 08:09:00 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Thu, 31 Jul 2008 17:09:00 +0200
Subject: [antlr-interest] Problems with the ANTLRworks interpreter.
In-Reply-To: <48919AD5.3080207@gmail.com>
References: <20080730213527.72ASK.192048.root@fepweb04>
	<48919AD5.3080207@gmail.com>
Message-ID: <20080731170900.5240789v3zovik4c@horde.verrech.net>

Yup, ANTLRWorks' interpreter is (today) not capable of predicate  
evaluation. Use debugging.

Regards

Raphael

"Peter C. Chapin" <pcc482719 at gmail.com> wrote (Thu Jul 31 12:58:29 2008):

> rkevinburton at charter.net wrote:
>
>> I don't know if this will help but I have found that the output  
>> changes based on the line ending selected (Unix(LF) or MS(CR LF).
>>
>
> I tried playing with that setting but it didn't seem to make any difference.
>
> Today I tried interpreting just 'A' (a bare identifier) as a  
> 'primary_expression' instead of as an expression. In that case I get  
> a  FailedPredicateException instead of a NoViableAltException. So  
> that does make it sound like the issue is related to backtracking  
> (keep in mind that these failures only seem to occur in the  
> ANTLRworks interpreter).
>
> Thanks for your suggestion!
>
> Peter
>
>>> Hello!
>>>
>>> I'm using ANTLRworks 1.1.7 and I'm building a grammar for a C-like  
>>> language. I've created some unit tests for my grammar...  
>>> specifically a collection of files containing text that is  
>>> intended to be syntactically correct. My test program loops over  
>>> these files, instantiates a parser for each (one at a time), and  
>>> tries to parse them all. I use various start symbols to exercise  
>>> parts of the grammar incrementally in these tests (helps to  
>>> isolate errors).
>>>
>>> So, given a file containing just
>>>
>>> A = B
>>>
>>> my test program successfully parses this using a start symbol of  
>>> 'expresion.' This is fine. However, when I use the ANTLRworks  
>>> interpreter and enter the text 'A = B' I get a  
>>> 'NoViableAltException.' I noticed that the interpreter is ignoring  
>>> my WHITSPACE rule so I removed the white space from the text  
>>> (using 'A=B') but that didn't help. In fact, the interpreter  
>>> produces a NoViableAltException even when I just use 'A' as input  
>>> text. However, a bare identifier is a valid expression in my  
>>> target language (and it parses fine when using the test program I  
>>> described above).
>>>
>>> I'm think I am missing something fundamental about how the  
>>> interpreter is supposed to work. I'm hoping someone can set my  
>>> feet upon the path of enlightenment! I did check the on-line  
>>> ANTLRworks user's guide, but the section on the interpreter  
>>> doesn't shed much light on my question.
>>>
>>> P.S. I do have backtracking mode turned on right now in my  
>>> grammar's option. Could that have something to do with it?
>>>
>>> Peter
>>>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/28265dcf/attachment.bin 

From jimi at temporal-wave.com  Thu Jul 31 09:49:14 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 09:49:14 -0700
Subject: [antlr-interest] ENHANCEMENT: Friendlier parser class,
	syntactic sugar for top level production.
In-Reply-To: <4891899E.8070806@gmx.de>
References: <489139EE.3000905@Yahoo.com>  <4891899E.8070806@gmx.de>
Message-ID: <1217522954.12349.26.camel@jimi>

On Thu, 2008-07-31 at 11:45 +0200, Johannes Luber wrote:

> Austin Hastings schrieb:
> > I didn't see this in the 3.1b? release notes, so I thought I'd ask for 
> > it again.
> > 
> > I'd like to see the Parser class come with a .parse(...) method. This 
> > would do what the examples suggest: create  a lexer, etc., and then 
> > invoke the top level production.
> > 
> > Obviously, you could override this. If you do, then no harm done. But 
> > most people are doing the same things, so why should the code generator 
> > generate the last little bit that they need?
> > 
> > Equally obviously, there would need to be a way to identify the  top 
> > level production. The most obvious way is to use the first one 
> > encountered. A slightly better way would be to add some syntax to 
> > identify it. Either as an option, or as a rule attribute:


I just don't think that this makes any sense. The whole point of an
ANTLR parser is that you can start parsing with any rule. Hence where it
starts is more of a subjective matter for the programmer. All you need
ot do is copy and paste from the myriad examples in the target language.
I think that there are more important usability issues to work on,
starting with getting ANTLR3 grammars to be parsed by an ANTLR3 parser.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/84a07938/attachment.html 

From pcc482719 at gmail.com  Thu Jul 31 10:02:35 2008
From: pcc482719 at gmail.com (Peter C. Chapin)
Date: Thu, 31 Jul 2008 13:02:35 -0400
Subject: [antlr-interest] Problems with the ANTLRworks interpreter.
In-Reply-To: <20080731170900.5240789v3zovik4c@horde.verrech.net>
References: <20080730213527.72ASK.192048.root@fepweb04>	<48919AD5.3080207@gmail.com>
	<20080731170900.5240789v3zovik4c@horde.verrech.net>
Message-ID: <4891F02B.6070207@gmail.com>

Raphael Reitzig wrote:

> Yup, ANTLRWorks' interpreter is (today) not capable of predicate 
> evaluation. Use debugging.

Okay, thanks for verifying that. I'll play with the debugger next and 
see how that goes.

Peter


From sharwell at pixelminegames.com  Thu Jul 31 10:44:11 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 31 Jul 2008 12:44:11 -0500
Subject: [antlr-interest] ENHANCEMENT: Friendlier parser class,
	syntactic sugar for top level production.
In-Reply-To: <4891899E.8070806@gmx.de>
References: <489139EE.3000905@Yahoo.com> <4891899E.8070806@gmx.de>
Message-ID: <86403CA0939415448BCCB83855EFE09A64DF1F@Bloodymary.ironwillgames.com>

I use multiple rules with an EOF because my file parser doubles as an
expression fragment parser. :)

Regarding Austin's issue: I created a class that derives from
AntlrParser and has an abstract Parse function. Then I derive my
grammars from that class. It's not built into the Antlr Runtime, but it
does allow me to share certain common functionality like parse calls and
error handling/logging across several grammars.

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Johannes Luber
Sent: Thursday, July 31, 2008 4:45 AM
To: Austin_Hastings at Yahoo.com
Cc: antlr-interest
Subject: Re: [antlr-interest] ENHANCEMENT: Friendlier parser class,
syntactic sugar for top level production.

Austin Hastings schrieb:
> I didn't see this in the 3.1b? release notes, so I thought I'd ask for

> it again.
> 
> I'd like to see the Parser class come with a .parse(...) method. This 
> would do what the examples suggest: create  a lexer, etc., and then 
> invoke the top level production.
> 
> Obviously, you could override this. If you do, then no harm done. But 
> most people are doing the same things, so why should the code
generator 
> generate the last little bit that they need?
> 
> Equally obviously, there would need to be a way to identify the  top 
> level production. The most obvious way is to use the first one 
> encountered. A slightly better way would be to add some syntax to 
> identify it. Either as an option, or as a rule attribute:
> 
> options {
>    language = Java;
>    main_rule = compilation_unit;
> }
> 
> // or
> 
> algebraic_expr
>    : ...
>    ;
> 
> boolean_expr
>    : ...
>    ;
> 
> compilation_unit
>    @main_rule
>    : ...
>    ;
> 
> 
> =Austin
> 

Another possibility is to look for a rule with EOF. There should be only

one rule anyway with EOF at its end and that is the top rule. Until name

mangling is introduced, using parse() as standard point of entry causes 
a naming conflict with a real parse rule, though. But I haven't seen a 
grammar yet where a rule named parse makes sense, so this may not happen

often.

Johannes

From rkevinburton at charter.net  Thu Jul 31 10:47:41 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 10:47:41 -0700
Subject: [antlr-interest] Tree parser
Message-ID: <20080731134741.00FQN.206578.root@fepweb02>

I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):

               CSharpwalker = new CSharpWalker();
                walker.setASTFactory(new ASTNodeFactory());
                CSharpParser.initializeASTFactory(walker.getASTFactory());

where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?

Thank you.

Kevin


From himmy070 at gmail.com  Thu Jul 31 11:02:41 2008
From: himmy070 at gmail.com (mark twain)
Date: Thu, 31 Jul 2008 14:02:41 -0400
Subject: [antlr-interest] problem compiling with ANTLR3 C RunTime API!!
Message-ID: <41fde820807311102h60dfb2a8q811134ec61d1fa9c@mail.gmail.com>

Hi Every1,

I am new bie to the ANTLR tool and using SimpleCalc Example, I successfully
generated the *C source files* for Lexer and Parser <SimpleCalcLexer.c,
SimpleCalcParser.c> using java executablel  antlrworks-1.1.7.jar.  Next, I
downloaded the ANTLR3 C RunTime API source code<libantlr3c-3.0.0-rc8.tar.gz>
and build the code .  Now, when I try to compile the generated C source
 code for Lexer and Parser I am getting the following error everytime:
*Undefined                       first referenced
 symbol                             in file
__lshrdi3                           libantlr3c.a(antlr3bitset.o)
ld: fatal: Symbol referencing errors. No output written to SimpleCal*
**
I succesfully compiled and gets above error when tries to link  object files
using antlr library which I copied to current directory of object files:
 cc -o SimpleCalc SimpleCalcLexer.o SimpleCalcParser.o libantlr3c.a

Please help me as I tried to change the distro package also but everytime
getting same problem.

Cheers:-)
Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/c785e3c6/attachment.html 

From jaluber at gmx.de  Thu Jul 31 11:19:22 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 20:19:22 +0200
Subject: [antlr-interest] Tree parser
In-Reply-To: <20080731134741.00FQN.206578.root@fepweb02>
References: <20080731134741.00FQN.206578.root@fepweb02>
Message-ID: <4892022A.5000406@gmx.de>

rkevinburton at charter.net schrieb:
> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> 
>                CSharpwalker = new CSharpWalker();
>                 walker.setASTFactory(new ASTNodeFactory());
>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> 
> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> 
> Thank you.
> 
> Kevin
> 
I don't know where the syntax above comes actually from, but my own tree 
grammar used a driver like this:

CSharpParser.grammarDef_return r = parser.startRule();
CommonTree r0 = ((CommonTree) r.tree);
CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
nodes.TokenStream = tokens;
CSharpGenerator walker = new CSharpGenerator(nodes);
RuleReturnScope r1 = walker.startRule();
Console.Out.WriteLine(r1.Template.ToString());

Hope this helps

From rkevinburton at charter.net  Thu Jul 31 11:56:25 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 11:56:25 -0700
Subject: [antlr-interest] Tree parser
In-Reply-To: <4892022A.5000406@gmx.de>
Message-ID: <20080731145625.8NB27.208047.root@fepweb02>

Thank you. This syntax came from 

http://antlr.org/share/list
kcsparse - an ECMA-334 C# Grammar Sample for ANTLR v2.7.6 (C#)

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> > 
> >                CSharpwalker = new CSharpWalker();
> >                 walker.setASTFactory(new ASTNodeFactory());
> >                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> > 
> > where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> I don't know where the syntax above comes actually from, but my own tree 
> grammar used a driver like this:
> 
> CSharpParser.grammarDef_return r = parser.startRule();
> CommonTree r0 = ((CommonTree) r.tree);
> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
> nodes.TokenStream = tokens;
> CSharpGenerator walker = new CSharpGenerator(nodes);
> RuleReturnScope r1 = walker.startRule();
> Console.Out.WriteLine(r1.Template.ToString());
> 
> Hope this helps


From rkevinburton at charter.net  Thu Jul 31 12:01:13 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 15:01:13 -0400
Subject: [antlr-interest] Tree parser
In-Reply-To: <4892022A.5000406@gmx.de>
Message-ID: <20080731150113.1FISE.208165.root@fepweb02>

I tried this:

                program_return ret = parser.program();
                CommonTree ct = ((CommonTree) ret.tree); 

But the C# compiler gives me an error:

'BsiServices.Parse.ECMAScriptParser.program_return.tree' is inaccessible due to its protection level

What am I doing wrong?

Thanks again.

Kevin
---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> > 
> >                CSharpwalker = new CSharpWalker();
> >                 walker.setASTFactory(new ASTNodeFactory());
> >                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> > 
> > where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> I don't know where the syntax above comes actually from, but my own tree 
> grammar used a driver like this:
> 
> CSharpParser.grammarDef_return r = parser.startRule();
> CommonTree r0 = ((CommonTree) r.tree);
> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
> nodes.TokenStream = tokens;
> CSharpGenerator walker = new CSharpGenerator(nodes);
> RuleReturnScope r1 = walker.startRule();
> Console.Out.WriteLine(r1.Template.ToString());
> 
> Hope this helps


From rkevinburton at charter.net  Thu Jul 31 12:04:57 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 12:04:57 -0700
Subject: [antlr-interest] Tree parser
In-Reply-To: <4892022A.5000406@gmx.de>
Message-ID: <20080731150457.AWUXJ.208258.root@fepweb02>

There must be some changes to the grammar as well. The lines:

    	ECMAScriptWalker walker = new ECMAScriptWalker(nodes); 
     	RuleReturnScope rs = walker.program(); 
    	Console.Out.WriteLine(rs.Template.ToString()); 

It seems that my walker start rule does not return RuleReturnScope.

Kevin

---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> > 
> >                CSharpwalker = new CSharpWalker();
> >                 walker.setASTFactory(new ASTNodeFactory());
> >                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> > 
> > where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> > 
> > Thank you.
> > 
> > Kevin
> > 
> I don't know where the syntax above comes actually from, but my own tree 
> grammar used a driver like this:
> 
> CSharpParser.grammarDef_return r = parser.startRule();
> CommonTree r0 = ((CommonTree) r.tree);
> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
> nodes.TokenStream = tokens;
> CSharpGenerator walker = new CSharpGenerator(nodes);
> RuleReturnScope r1 = walker.startRule();
> Console.Out.WriteLine(r1.Template.ToString());
> 
> Hope this helps


From jaluber at gmx.de  Thu Jul 31 13:39:46 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 22:39:46 +0200
Subject: [antlr-interest] Tree parser
In-Reply-To: <20080731145625.8NB27.208047.root@fepweb02>
References: <20080731145625.8NB27.208047.root@fepweb02>
Message-ID: <48922312.2030009@gmx.de>

rkevinburton at charter.net schrieb:
> Thank you. This syntax came from 
> 
> http://antlr.org/share/list
> kcsparse - an ECMA-334 C# Grammar Sample for ANTLR v2.7.6 (C#)
> 
> Kevin

Anything with a version before 3.x should be considered as outdated and 
incorrect, as without knowledge of both versions one doesn't know what 
is usable in 3.x and what has to be changed.

Johannes
> 
> ---- Johannes Luber <jaluber at gmx.de> wrote: 
>> rkevinburton at charter.net schrieb:
>>> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
>>>
>>>                CSharpwalker = new CSharpWalker();
>>>                 walker.setASTFactory(new ASTNodeFactory());
>>>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
>>>
>>> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
>>>
>>> Thank you.
>>>
>>> Kevin
>>>
>> I don't know where the syntax above comes actually from, but my own tree 
>> grammar used a driver like this:
>>
>> CSharpParser.grammarDef_return r = parser.startRule();
>> CommonTree r0 = ((CommonTree) r.tree);
>> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
>> nodes.TokenStream = tokens;
>> CSharpGenerator walker = new CSharpGenerator(nodes);
>> RuleReturnScope r1 = walker.startRule();
>> Console.Out.WriteLine(r1.Template.ToString());
>>
>> Hope this helps
> 


From jaluber at gmx.de  Thu Jul 31 13:42:38 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 22:42:38 +0200
Subject: [antlr-interest] Tree parser
In-Reply-To: <20080731150113.1FISE.208165.root@fepweb02>
References: <20080731150113.1FISE.208165.root@fepweb02>
Message-ID: <489223BE.1080007@gmx.de>

rkevinburton at charter.net schrieb:
> I tried this:
> 
>                 program_return ret = parser.program();
>                 CommonTree ct = ((CommonTree) ret.tree); 
> 
> But the C# compiler gives me an error:
> 
> 'BsiServices.Parse.ECMAScriptParser.program_return.tree' is inaccessible due to its protection level
> 
> What am I doing wrong?
> 
> Thanks again.
> 
> Kevin

It could be that you have to change .tree to .Tree. I didn't check if 
the driver code is still uptodate. BTW, please look if changing the 
capitilization works before you write an email. :)

Johannes

> ---- Johannes Luber <jaluber at gmx.de> wrote: 
>> rkevinburton at charter.net schrieb:
>>> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
>>>
>>>                CSharpwalker = new CSharpWalker();
>>>                 walker.setASTFactory(new ASTNodeFactory());
>>>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
>>>
>>> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
>>>
>>> Thank you.
>>>
>>> Kevin
>>>
>> I don't know where the syntax above comes actually from, but my own tree 
>> grammar used a driver like this:
>>
>> CSharpParser.grammarDef_return r = parser.startRule();
>> CommonTree r0 = ((CommonTree) r.tree);
>> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
>> nodes.TokenStream = tokens;
>> CSharpGenerator walker = new CSharpGenerator(nodes);
>> RuleReturnScope r1 = walker.startRule();
>> Console.Out.WriteLine(r1.Template.ToString());
>>
>> Hope this helps
> 


From jaluber at gmx.de  Thu Jul 31 13:43:36 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Thu, 31 Jul 2008 22:43:36 +0200
Subject: [antlr-interest] Tree parser
In-Reply-To: <20080731150457.AWUXJ.208258.root@fepweb02>
References: <20080731150457.AWUXJ.208258.root@fepweb02>
Message-ID: <489223F8.1070901@gmx.de>

rkevinburton at charter.net schrieb:
> There must be some changes to the grammar as well. The lines:
> 
>     	ECMAScriptWalker walker = new ECMAScriptWalker(nodes); 
>      	RuleReturnScope rs = walker.program(); 
>     	Console.Out.WriteLine(rs.Template.ToString()); 
> 
> It seems that my walker start rule does not return RuleReturnScope.
> 
> Kevin

What does program() return then?

Johannes
> 
> ---- Johannes Luber <jaluber at gmx.de> wrote: 
>> rkevinburton at charter.net schrieb:
>>> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
>>>
>>>                CSharpwalker = new CSharpWalker();
>>>                 walker.setASTFactory(new ASTNodeFactory());
>>>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
>>>
>>> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
>>>
>>> Thank you.
>>>
>>> Kevin
>>>
>> I don't know where the syntax above comes actually from, but my own tree 
>> grammar used a driver like this:
>>
>> CSharpParser.grammarDef_return r = parser.startRule();
>> CommonTree r0 = ((CommonTree) r.tree);
>> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
>> nodes.TokenStream = tokens;
>> CSharpGenerator walker = new CSharpGenerator(nodes);
>> RuleReturnScope r1 = walker.startRule();
>> Console.Out.WriteLine(r1.Template.ToString());
>>
>> Hope this helps
> 


From jimi at temporal-wave.com  Thu Jul 31 13:41:53 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 13:41:53 -0700
Subject: [antlr-interest] problem compiling with ANTLR3 C RunTime API!!
In-Reply-To: <41fde820807311102h60dfb2a8q811134ec61d1fa9c@mail.gmail.com>
References: <41fde820807311102h60dfb2a8q811134ec61d1fa9c@mail.gmail.com>
Message-ID: <1217536913.12349.41.camel@jimi>

On Thu, 2008-07-31 at 14:02 -0400, mark twain wrote:
> Hi Every1,
>  
> I am new bie to the ANTLR tool and using SimpleCalc Example, I
> successfully generated the C source files for Lexer and Parser
> <SimpleCalcLexer.c, SimpleCalcParser.c> using java executablel
> antlrworks-1.1.7.jar.  Next, I downloaded the ANTLR3 C RunTime API
> source code<libantlr3c-3.0.0-rc8.tar.gz> and build the code .  


Where did you even get that tar from? ;-)

You need to be using a current release of the C runtime and not an
ancient release candidate. Visit the downloads page from the main antlr
home page, and download 3.1beta2 source. You will find the correct
tar.gz file there. Generate the C code using the jar files in that
download and not suing the ANTLRWorks jar.

Read the API docs (see the link on the main ANTLR page), before getting
started.

Jim


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/0916908c/attachment.html 

From jdn at math.carleton.ca  Thu Jul 31 13:48:50 2008
From: jdn at math.carleton.ca (Jason Nielsen)
Date: Thu, 31 Jul 2008 16:48:50 -0400 (EDT)
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <1217477920.9052.88.camel@jimi>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
	<1217472644.9052.86.camel@jimi>
	<Pine.LNX.4.64.0807302307260.32386@taz> <1217477920.9052.88.camel@jimi>
Message-ID: <Pine.LNX.4.64.0807311642070.7242@octopus>

On Wed, 30 Jul 2008, Jim Idle wrote:

> On Wed, 2008-07-30 at 23:26 -0400, Jason Nielsen wrote:
>
>>> IN fact my development version did have a bug because I was in the
>>> middle of fixing something else. I just completed that fix and now i
>>> get:
>>>
>>> ./a.out
>>> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
>>> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
>>> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
>>> (BLOCK (= x 3) (= y 5)))))
<snip>
>>> Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL (FUNC_HDR void bar
>>> (ARG_DEF int x))) (FUNC_DEF (FUNC_HDR int foo (ARG_DEF int y) (ARG_DEF
>>> char d)) (BLOCK (VAR_DEF int i) (for (= i 0) (< i 3) (= i (+ i 1))
>>> (BLOCK (= x 3) (= y 5)))))
>>>
>>>
>>> Once I fixed your translate() function and using the b3 runtime tar.
>>>

Sorry for the delay in response... it has been a busy day.  I downloaded 
the most recent beta3 from the repo and rebuilt.  Now I'm getting the 
following,

-Imaginary-(0)  : error 10 : Unexpected node, at offset 0, near <missing 
<invalid>> : Missing <invalid>
-Imaginary-(1)  : error 10 : Unexpected node, at offset 54, near <missing 
<invalid>> : Missing <invalid>
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL FUNC_HDR) (FUNC_DEF 
FUNC_HDR BLOCK)
-Imaginary-(0)  : error 10 : Unexpected node, at offset 0, near <missing 
<invalid>> : Missing <invalid>
-Imaginary-(1)  : error 10 : Unexpected node, at offset 54, near <missing 
<invalid>> : Missing <invalid>
Nodes: (VAR_DEF char c) (VAR_DEF int x) (FUNC_DECL FUNC_HDR) (FUNC_DEF 
FUNC_HDR BLOCK)
.
.
.

Thanks,
Jason
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.tar.gz
Type: application/octet-stream
Size: 2291 bytes
Desc: 
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/6c7626c4/attachment.obj 

From antlr at mirality.co.nz  Thu Jul 31 13:52:51 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 01 Aug 2008 08:52:51 +1200
Subject: [antlr-interest] Rewriting with nodes from sub-rules?
In-Reply-To: <003001c8f29d$6f839220$4e8ab660$@com>
References: <48907140.9090300@ecircle.com>
	<003001c8f29d$6f839220$4e8ab660$@com>
Message-ID: <20080731205301.76FFE11E991@www.antlr.org>

At 11:38 31/07/2008, Foust wrote:
 >	... -> ^(SET[nameValue.name] ...)

Have you tried this:

   -> ^(SET[$nameValue.name] ...)


From jimi at temporal-wave.com  Thu Jul 31 13:59:06 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 13:59:06 -0700
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <Pine.LNX.4.64.0807311642070.7242@octopus>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
	<1217472644.9052.86.camel@jimi> <Pine.LNX.4.64.0807302307260.32386@taz>
	<1217477920.9052.88.camel@jimi>
	<Pine.LNX.4.64.0807311642070.7242@octopus>
Message-ID: <1217537946.12349.48.camel@jimi>

On Thu, 2008-07-31 at 16:48 -0400, Jason Nielsen wrote:


> 
> Sorry for the delay in response... it has been a busy day.  I downloaded 
> the most recent beta3 from the repo and rebuilt.  Now I'm getting the 
> following,
> 
> -Imaginary-(0)  : error 10 : Unexpected node, at offset 0, near <missing 
> <invalid>> : Missing <invalid>


Yes - this is fixed in beta 3. We are trying for a release this weekend,
so there might not even be a beta 3 in fact.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/0de43f51/attachment.html 

From jdn at math.carleton.ca  Thu Jul 31 14:08:39 2008
From: jdn at math.carleton.ca (Jason Nielsen)
Date: Thu, 31 Jul 2008 17:08:39 -0400 (EDT)
Subject: [antlr-interest] Bug in 64bit C backend
In-Reply-To: <1217537946.12349.48.camel@jimi>
References: <Pine.LNX.4.64.0807301758060.10097@octopus>
	<1217472644.9052.86.camel@jimi>
	<Pine.LNX.4.64.0807302307260.32386@taz> <1217477920.9052.88.camel@jimi>
	<Pine.LNX.4.64.0807311642070.7242@octopus>
	<1217537946.12349.48.camel@jimi>
Message-ID: <Pine.LNX.4.64.0807311705230.7242@octopus>

On Thu, 31 Jul 2008, Jim Idle wrote:
>
> Yes - this is fixed in beta 3. We are trying for a release this weekend,
> so there might not even be a beta 3 in fact.

OK, thanks Jim.  Sorry for the noise, I mistook your reference to beta3 to 
mean just the C runtime and not all of ANTLR.

Jason

From jimi at temporal-wave.com  Thu Jul 31 14:51:51 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 14:51:51 -0700
Subject: [antlr-interest] problem compiling with ANTLR3 C RunTime API!!
In-Reply-To: <41fde820807311450h736c83afn888421f3f0a3c3fa@mail.gmail.com>
References: <41fde820807311102h60dfb2a8q811134ec61d1fa9c@mail.gmail.com>
	<1217536913.12349.41.camel@jimi>
	<41fde820807311450h736c83afn888421f3f0a3c3fa@mail.gmail.com>
Message-ID: <1217541111.12349.56.camel@jimi>

On Thu, 2008-07-31 at 17:50 -0400, mark twain wrote:
> Hi Jim, 
>  
> Thanks for replying!!
> I followed your direction and try to build the latest package but
> getting the following Error.
>  
>  cc -DHAVE_CONFIG_H -I. -Iinclude -Iinclude -O -c
> src/antlr3debughandlers.c  -KPIC -DPIC -o .libs/antlr3debughandlers.o
> "src/antlr3debughandlers.c", line 280: undefined symbol: TCP_NODELAY
> cc: acomp failed for src/antlr3debughandlers.c
> make[1]: *** [antlr3debughandlers.lo] Error 1
> make[1]: Leaving directory
> `/usr/home/antlr-3.1b2/runtime/C/dist/libantlr3c-3.1b2'
> make: *** [all] Error 2
>  
> I am building from following distro : libantlr3c-3.1b2.tar.gz .Am I
> missing something??


Did you expand the tar and run ./conifgure?

Jim
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/67e1a219/attachment.html 

From rkevinburton at charter.net  Thu Jul 31 14:56:33 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 17:56:33 -0400
Subject: [antlr-interest] ANTLR StringTemplate interface.
Message-ID: <20080731175633.FJZ45.212862.root@fepweb10>

I am really new to ANTLR and so am even newer to StingTemplates. I decided to cut and paste my tree grammar to use templates. Terrance says that StingTemplates are better than print statements so I thought I would try.

Needless to say it didn't work. The generated files from the grammar would not compile.

Here is the opening of my template grammar:

tree grammar ECMAScriptTemplate ;

options
{
	output = template;
	tokenVocab = ECMAScript ;
	language = CSharp2 ;
}

And the template rewrite rultes that I am dealing with right now look like:

functionDeclaration
	: ^( FUNCTION Identifier? LPAREN (fa+=functionArguments)* RPAREN block )
          -> template(name={$Identifier.text}, args={$fa.st})
          "<name>(<args; separator=\", \">)"
	;

functionArguments
	: ^( ARGS name=Identifier )
          -> template(argument={$name}) "<argument>"
	| ^( ARGS name=Identifier TYPES type=Identifier )
          -> template(argument={$name}, type={$type}) "<argument> <type>"
	;

Basically thiis grammar parses a JavaScript input with one modification. I have added suggested types to the arugment list. The tree walker and parser both are very happy right now. I am trying to get the StringTemplate to work. The above should recognize 'function a(b,c)' as well as 'function a(b:B,c)' where B is a type. Naturally I would like to build a template that "fills" in the argument list with types or not. As it sits now when code generated with the above statements I get:

            	// TEMPLATE REWRITE
            	// 220:11: -> template(name=$Identifier.textargs=$fa.st) \"<name>(<args; separator=\", \">)\"
            	{
            	    retval.ST = new StringTemplate(templateLib, "<name>(<args; separator=\", \">)",
            	  new STAttrMap().Add("name", ((Identifier1 != null) ? Identifier1.Text : null)).Add("args", list_fa.st));
            	}

'object' does not contain a definition for 'Text' and no extension method 'Text' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?)

Any ideas what is wrong?

Thank you.

Kevin

From rkevinburton at charter.net  Thu Jul 31 14:58:19 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 17:58:19 -0400
Subject: [antlr-interest] Tree parser
In-Reply-To: <489223F8.1070901@gmx.de>
Message-ID: <20080731175819.GKLL1.212898.root@fepweb10>

it returns void. The rule in the grammar is:

program
	: statement*
	;

Kevin
---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > There must be some changes to the grammar as well. The lines:
> > 
> >     	ECMAScriptWalker walker = new ECMAScriptWalker(nodes); 
> >      	RuleReturnScope rs = walker.program(); 
> >     	Console.Out.WriteLine(rs.Template.ToString()); 
> > 
> > It seems that my walker start rule does not return RuleReturnScope.
> > 
> > Kevin
> 
> What does program() return then?
> 
> Johannes
> > 
> > ---- Johannes Luber <jaluber at gmx.de> wrote: 
> >> rkevinburton at charter.net schrieb:
> >>> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> >>>
> >>>                CSharpwalker = new CSharpWalker();
> >>>                 walker.setASTFactory(new ASTNodeFactory());
> >>>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> >>>
> >>> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> >>>
> >>> Thank you.
> >>>
> >>> Kevin
> >>>
> >> I don't know where the syntax above comes actually from, but my own tree 
> >> grammar used a driver like this:
> >>
> >> CSharpParser.grammarDef_return r = parser.startRule();
> >> CommonTree r0 = ((CommonTree) r.tree);
> >> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
> >> nodes.TokenStream = tokens;
> >> CSharpGenerator walker = new CSharpGenerator(nodes);
> >> RuleReturnScope r1 = walker.startRule();
> >> Console.Out.WriteLine(r1.Template.ToString());
> >>
> >> Hope this helps
> > 
> 


From rkevinburton at charter.net  Thu Jul 31 14:59:20 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 14:59:20 -0700
Subject: [antlr-interest] Tree parser
In-Reply-To: <489223BE.1080007@gmx.de>
Message-ID: <20080731175920.5YN2P.212945.root@fepweb10>

Changing tree to Tree works. Thank you.

Kevin
---- Johannes Luber <jaluber at gmx.de> wrote: 
> rkevinburton at charter.net schrieb:
> > I tried this:
> > 
> >                 program_return ret = parser.program();
> >                 CommonTree ct = ((CommonTree) ret.tree); 
> > 
> > But the C# compiler gives me an error:
> > 
> > 'BsiServices.Parse.ECMAScriptParser.program_return.tree' is inaccessible due to its protection level
> > 
> > What am I doing wrong?
> > 
> > Thanks again.
> > 
> > Kevin
> 
> It could be that you have to change .tree to .Tree. I didn't check if 
> the driver code is still uptodate. BTW, please look if changing the 
> capitilization works before you write an email. :)
> 
> Johannes
> 
> > ---- Johannes Luber <jaluber at gmx.de> wrote: 
> >> rkevinburton at charter.net schrieb:
> >>> I would like to generate a tree parser. Unfortunateliy the ANTLR book has very little to say of the issue (or I just don't know where to look) and the sample grammars that I see seem to implement the 'walker' different from the way ANTLR does it now. For example in the CSharp grammar there is syntax like (the 'walker grammar names are different):
> >>>
> >>>                CSharpwalker = new CSharpWalker();
> >>>                 walker.setASTFactory(new ASTNodeFactory());
> >>>                 CSharpParser.initializeASTFactory(walker.getASTFactory());
> >>>
> >>> where the constructor for the waler no longer takes '0' arguments. There isn't a method 'setASTFactory' and there also isn't a method 'initializedASTFactory'. If I have a TreeParser grammar how do I integrate it with the parser?
> >>>
> >>> Thank you.
> >>>
> >>> Kevin
> >>>
> >> I don't know where the syntax above comes actually from, but my own tree 
> >> grammar used a driver like this:
> >>
> >> CSharpParser.grammarDef_return r = parser.startRule();
> >> CommonTree r0 = ((CommonTree) r.tree);
> >> CommonTreeNodeStream nodes = new CommonTreeNodeStream(r0);
> >> nodes.TokenStream = tokens;
> >> CSharpGenerator walker = new CSharpGenerator(nodes);
> >> RuleReturnScope r1 = walker.startRule();
> >> Console.Out.WriteLine(r1.Template.ToString());
> >>
> >> Hope this helps
> > 
> 


From jimi at temporal-wave.com  Thu Jul 31 15:00:17 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 15:00:17 -0700
Subject: [antlr-interest] problem compiling with ANTLR3 C RunTime API!!
In-Reply-To: <41fde820807311456u27ea089bo7385beac758690c1@mail.gmail.com>
References: <41fde820807311102h60dfb2a8q811134ec61d1fa9c@mail.gmail.com>
	<1217536913.12349.41.camel@jimi>
	<41fde820807311450h736c83afn888421f3f0a3c3fa@mail.gmail.com>
	<1217541111.12349.56.camel@jimi>
	<41fde820807311456u27ea089bo7385beac758690c1@mail.gmail.com>
Message-ID: <1217541617.12349.59.camel@jimi>

On Thu, 2008-07-31 at 17:56 -0400, mark twain wrote:

> Yes I did
> 
> 
> On 7/31/08, Jim Idle <jimi at temporal-wave.com> wrote: 
> 
>         On Thu, 2008-07-31 at 17:50 -0400, mark twain wrote: 
>         
>         > Hi Jim, 
>         >   
>         > Thanks for replying!! 
>         > I followed your direction and try to build the latest
>         > package but getting the following Error. 
>         >   
>         >  cc -DHAVE_CONFIG_H -I. -Iinclude -Iinclude -O -c
>         > src/antlr3debughandlers.c  -KPIC -DPIC
>         > -o .libs/antlr3debughandlers.o
>         > "src/antlr3debughandlers.c", line 280: undefined symbol:
>         > TCP_NODELAY
>         > cc: acomp failed for src/antlr3debughandlers.c
>         > make[1]: *** [antlr3debughandlers.lo] Error 1
>         > make[1]: Leaving directory
>         > `/usr/home/antlr-3.1b2/runtime/C/dist/libantlr3c-3.1b2'
>         > make: *** [all] Error 2
>         >   
>         > I am building from following distro :
>         > libantlr3c-3.1b2.tar.gz .Am I missing something??
>         
>         
>         Did you expand the tar and run ./conifgure?
>         
>         Jim 


In that case, what operating system are you compiling on? Maybe it is
something wrong with configure working out the header for this symbol.

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/44581ca2/attachment.html 

From rkevinburton at charter.net  Thu Jul 31 16:04:14 2008
From: rkevinburton at charter.net (rkevinburton at charter.net)
Date: Thu, 31 Jul 2008 19:04:14 -0400
Subject: [antlr-interest] ANTLR StringTemplate interface.
In-Reply-To: <20080731175633.FJZ45.212862.root@fepweb10>
Message-ID: <20080731190414.31IUK.213333.root@fepweb09>

If I change the rules as follows:

functionDeclaration
	: ^( FUNCTION id=Identifier? LPAREN (fa+=functionArguments)* RPAREN block )
          -> template(name={$id}, args={$fa})
          "<name>(<args; separator=\", \">)"
	;

functionArguments
	: ^( ARGS name=Identifier )
          -> template(argument={$name}) "<argument>"
	| ^( ARGS name=Identifier TYPES type=Identifier )
          -> template(argument={$name}, type={$type}) "<argument> <type>"
	;


I stepped into the generated code using the debugger and this seems to generate a "template" that is what I need. I am not sure that I totally understand why this seems to work. Now how do I output or access the generated (filled in) template?
---- rkevinburton at charter.net wrote: 
> I am really new to ANTLR and so am even newer to StingTemplates. I decided to cut and paste my tree grammar to use templates. Terrance says that StingTemplates are better than print statements so I thought I would try.
> 
> Needless to say it didn't work. The generated files from the grammar would not compile.
> 
> Here is the opening of my template grammar:
> 
> tree grammar ECMAScriptTemplate ;
> 
> options
> {
> 	output = template;
> 	tokenVocab = ECMAScript ;
> 	language = CSharp2 ;
> }
> 
> And the template rewrite rultes that I am dealing with right now look like:
> 
> functionDeclaration
> 	: ^( FUNCTION Identifier? LPAREN (fa+=functionArguments)* RPAREN block )
>           -> template(name={$Identifier.text}, args={$fa.st})
>           "<name>(<args; separator=\", \">)"
> 	;
> 
> functionArguments
> 	: ^( ARGS name=Identifier )
>           -> template(argument={$name}) "<argument>"
> 	| ^( ARGS name=Identifier TYPES type=Identifier )
>           -> template(argument={$name}, type={$type}) "<argument> <type>"
> 	;
> 
> Basically thiis grammar parses a JavaScript input with one modification. I have added suggested types to the arugment list. The tree walker and parser both are very happy right now. I am trying to get the StringTemplate to work. The above should recognize 'function a(b,c)' as well as 'function a(b:B,c)' where B is a type. Naturally I would like to build a template that "fills" in the argument list with types or not. As it sits now when code generated with the above statements I get:
> 
>             	// TEMPLATE REWRITE
>             	// 220:11: -> template(name=$Identifier.textargs=$fa.st) \"<name>(<args; separator=\", \">)\"
>             	{
>             	    retval.ST = new StringTemplate(templateLib, "<name>(<args; separator=\", \">)",
>             	  new STAttrMap().Add("name", ((Identifier1 != null) ? Identifier1.Text : null)).Add("args", list_fa.st));
>             	}
> 
> 'object' does not contain a definition for 'Text' and no extension method 'Text' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?)
> 
> Any ideas what is wrong?
> 
> Thank you.
> 
> Kevin


From anders at globe-trotter.us  Thu Jul 31 19:45:24 2008
From: anders at globe-trotter.us (=?iso-8859-1?Q?Anders=20Karlsson?=)
Date: Fri, 01 Aug 2008 10:45:24 +0800
Subject: [antlr-interest]
	=?iso-8859-1?q?antlr-interest_Digest=2C_Vol_44?=
	=?iso-8859-1?q?=2C_Issue_93?=
Message-ID: <20080801024524.3093.qmail@station198.com>

Hi

I was trying to create a tree parser but when I write

tree grammar xxx;

at the top of the file (or lex grammar xxx for that matter)

I get a null pointer exception as follows:

Cannot generate the grammar because:
error(10): internal error: C:....path to my xxx.g file : java.lang.NullPointerException
org.antlr.tool.GrammarSanity.traceStatesLookingForLeftRecursion(GrammarSanity.java:105)
...
java.lang.Thread.run(Unknown Source)

Any ideas what I am doing wrong?

The grammar follows (from the ANTLR3 ref book,slightly modified):

tree grammar evaluate;       // this causes the error, if I remove tree there is no exception

options {
	tokenVocab=expeval; // read tokens from this file expeval.tokens
	ASTLabelType=CommonTree;
	language=C;
}

@header {
  #include <stdio.h> // here some using/includes could be specified.
}

@members {
  // here some instance variables could be defined.
}

prog 
	:	statement+;

statement 
	:	 expr { char m[32]; puts( itoa( $expr.value, m, 10 ) ); }
	;

expr returns [int value] 
	:	^('+' a=expr b=expr) { $value=a+b; }
	| ^('-' a=expr b=expr) { $value=a-b; }
	| ^('*' a=expr b=expr) { $value=a*b; }	
	| ^('/' a=expr b=expr) { $value=a/b; }
	| INT { $value=atoi((const char*)($INT.text->chars)); }
	;
	
INT
	:	 '0'..'9'+
	;	


From prashant.deva at gmail.com  Thu Jul 31 19:49:53 2008
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri, 1 Aug 2008 08:19:53 +0530
Subject: [antlr-interest] a question about warnings
Message-ID: <41fed8f80807311949i571b6c97y851b7b542e3adf7@mail.gmail.com>

I get a warning like this -

*[08:14:47] warning(200): prashant.g:27:18: Decision can match input such as
"ANY" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
*
In the statement  above does it mean that both alternatives were disabled or
just the 2nd one?
Is there any way to tell antlr which specific alternative to disable?

Prashant
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080801/8fd81fc0/attachment.html 

From anders at globe-trotter.us  Thu Jul 31 19:51:42 2008
From: anders at globe-trotter.us (=?iso-8859-1?Q?Anders=20Karlsson?=)
Date: Fri, 01 Aug 2008 10:51:42 +0800
Subject: [antlr-interest] =?iso-8859-1?q?tree_grammar?=
Message-ID: <20080801025142.7488.qmail@station198.com>

Hi again,

I should have specified a subject, sorry about forgetting that.

I also forgot to mention the version i use ANTLRWorks 1.1.7 and ANTLR 3.0.1

################

I was trying to create a tree parser but when I write

tree grammar xxx;

at the top of the file (or lex grammar xxx for that matter)

I get a null pointer exception as follows:

Cannot generate the grammar because:
error(10): internal error: C:....path to my xxx.g file : java.lang.NullPointerException
org.antlr.tool.GrammarSanity.traceStatesLookingForLeftRecursion(GrammarSanity.java:105)
...
java.lang.Thread.run(Unknown Source)

Any ideas what I am doing wrong?

The grammar follows (from the ANTLR3 ref book,slightly modified):

tree grammar evaluate;       // this causes the error, if I remove tree there is no exception

options {
tokenVocab=expeval; // read tokens from this file expeval.tokens
ASTLabelType=CommonTree;
language=C;
}

@header {
  #include <stdio.h> // here some using/includes could be specified.
}

@members {
  // here some instance variables could be defined.
}

prog
: statement+;

statement
:   expr { char m[32]; puts( itoa( $expr.value, m, 10 ) ); }
;

expr returns [int value]
: ^('+' a=expr b=expr) { $value=a+b; }
| ^('-' a=expr b=expr) { $value=a-b; }
| ^('*' a=expr b=expr) { $value=a*b; }
| ^('/' a=expr b=expr) { $value=a/b; }
| INT { $value=atoi((const char*)($INT.text->chars)); }
;

INT
:   '0'..'9'+
;

####################


From jimi at temporal-wave.com  Thu Jul 31 19:58:20 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 19:58:20 -0700
Subject: [antlr-interest] antlr-interest Digest, Vol 44, Issue 93
In-Reply-To: <20080801024524.3093.qmail@station198.com>
References: <20080801024524.3093.qmail@station198.com>
Message-ID: <1217559500.12349.79.camel@jimi>

On Fri, 2008-08-01 at 10:45 +0800, Anders Karlsson wrote:

> Hi
> 
> I was trying to create a tree parser but when I write
> 
> tree grammar xxx;



> 	
> INT
> 	:	 '0'..'9'+
> 	;	
> 

INT is a lexer rule and should not be in a tree parser grammar; 
Take that out and try again, if that does not work, make sure you are
using a current version of ANTLR. 
ASTLabelType is not CommonTree for C, it is pANTLR3_BASE_TREE. 
Make sure your token vocab file exists. 
Make sure you read:  http://www.antlr.org/api/C/index.html  before
trying to use the C API. 
Make sure that your file name is the same as your tree parser name;

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/d5843148/attachment.html 

From jimi at temporal-wave.com  Thu Jul 31 20:03:40 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 31 Jul 2008 20:03:40 -0700
Subject: [antlr-interest] a question about warnings
In-Reply-To: <41fed8f80807311949i571b6c97y851b7b542e3adf7@mail.gmail.com>
References: <41fed8f80807311949i571b6c97y851b7b542e3adf7@mail.gmail.com>
Message-ID: <1217559820.12349.85.camel@jimi>

On Fri, 2008-08-01 at 08:19 +0530, Prashant Deva wrote:
> I get a warning like this -
> 
> [08:14:47] warning(200): prashant.g:27:18: Decision can match input
> such as "ANY" using multiple alternatives: 1, 2
> As a result, alternative(s) 2 were disabled for that input
> 
> In the statement  above does it mean that both alternatives were
> disabled or just the 2nd one?


As the warning says, it disables only the second option. 
Use ANTLRWorks to check the grammar and then work out which alt this
is. 

> Is there any way to tell antlr which specific alternative to disable?


No but you don't so much want that as to be able to say "A warning here
is fine", which is on a todo list somewhere. However, it is generally
better to write the grammar in such a way as these things don't arise
(if possible).

If taking the first alt is what you want it to do, then put in a
syntactic predicate of one token for alt 1, which is not massively
expensive and will make the warning go away. But, only do this if you
cannot find a way to factor the grammar such that the ambiguity goes
away. Left factoring is what is usually needed. If you are using
'literals' in your grammar, then change to real lexer rules until you
you are fully facile with ANTLR grammars.

Jim

> 
> Prashant
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080731/4db98af0/attachment.html 

