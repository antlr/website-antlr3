From eyal.junk at gmail.com  Wed Mar  1 03:30:58 2006
From: eyal.junk at gmail.com (Eyal Post)
Date: Wed Mar  1 03:31:17 2006
Subject: [antlr-interest] Ignore\recover from errors
Message-ID: <000001c63d23$9ca6bac0$8700a8c0@srv1>

I'm using Antlr to create a lexer for simple text files. I have some very
simple rules, and I want to make sure the lexer never fails and always
returns the entire text of the original file. How can I acheive this? In
case of an error, I just want the lexer to return the offending character
and continue from the next one. 
 
Eyal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060301/dfabb326/attachment.html
From philip at catinet.dk  Wed Mar  1 04:10:17 2006
From: philip at catinet.dk (Philip Heede)
Date: Wed Mar  1 04:09:43 2006
Subject: [antlr-interest] ANTLR 2.7.6 C# race condition fix
Message-ID: <87305CF2F83DCA419B5B912D4BD1C0585597A3@mailserver.catdom.local>

Hi all,
 
We are using ANTLR in an ASP.NET (C#) application with great success.
However, we are experiencing some random crashes in situations with high
memory usage, where the stack trace indicates that the crash originated
in

antlr.ASTFactory.makeASTRoot(ASTPair currentAST, AST root)
 
We've been tracking the problem for some time now without any ideas to
what might be causing it besides the fact that the servers are being
stressed when the problem occurs. The general consensus so far has been,
that the problem is because of the high memory usage rather than ANTLR
(even though the exception originates here).

However, we are at v2.7.5 and I've just noticed the following entry in
the 2.7.6 changelog regarding C#-specific changes:
 
***BREAKING CHANGE*** ASTPair object pool had a race condition in
multi-threaded environments. ASTPair is now a struct.

I wanted to hear if anyone could give some more information on this fix
before I get my hopes up. Does our problem sound like it might be caused
by the race condition mentioned in this fix? We'll be testing 2.7.6
shortly, but I hope to hear any comments you might have. Thanks! 
 
-- 
Sincerely
Philip

From open.zone at virgin.net  Wed Mar  1 07:49:27 2006
From: open.zone at virgin.net (Micheal J)
Date: Wed Mar  1 07:32:44 2006
Subject: [antlr-interest] ANTLR 2.7.6 C# race condition fix
In-Reply-To: <87305CF2F83DCA419B5B912D4BD1C0585597A3@mailserver.catdom.local>
Message-ID: <004d01c63d47$b9bc3710$6702a8c0@hercules>

> Hi all,

Philip,

> We are using ANTLR in an ASP.NET (C#) application with great 
> success. However, we are experiencing some random crashes in 
> situations with high memory usage, where the stack trace 
> indicates that the crash originated in
> 
> antlr.ASTFactory.makeASTRoot(ASTPair currentAST, AST root)

Any more info about the crash?. A stack trace?. What version of .NET?. OS?.
Is this on multi-CPU hardware?. Are you running many parsers in parallel on
separate threads?....

> We've been tracking the problem for some time now without any 
> ideas to what might be causing it besides the fact that the 
> servers are being stressed when the problem occurs. The 
> general consensus so far has been, that the problem is 
> because of the high memory usage rather than ANTLR (even 
> though the exception originates here).
> 
> However, we are at v2.7.5 and I've just noticed the following 
> entry in the 2.7.6 changelog regarding C#-specific changes:
>  
> ***BREAKING CHANGE*** ASTPair object pool had a race 
> condition in multi-threaded environments. ASTPair is now a struct.

The only report of this race-condition was in a multi-CPU environent. Under
heavy stress testing conditions iirc.

> I wanted to hear if anyone could give some more information 
> on this fix before I get my hopes up.

http://www.antlr.org/pipermail/antlr-interest/2005-April/011838.html

And search the archives for "ASTPair".

> Does our problem sound 
> like it might be caused by the race condition mentioned in 
> this fix? We'll be testing 2.7.6 shortly, but I hope to hear 
> any comments you might have. Thanks! 

Possibly, couldn't say. In Jim's case, it manifested as an infinite loop in
ASTPair.advanceChildToEnd().


Cheers,

Micheal

From seclib at seclib.com  Wed Mar  1 08:03:41 2006
From: seclib at seclib.com (Xue Yong Zhi)
Date: Wed Mar  1 08:05:57 2006
Subject: [antlr-interest] Re: is this a bug?
In-Reply-To: <35095.1068023734$1141184729@news.gmane.org>
References: <35095.1068023734$1141184729@news.gmane.org>
Message-ID: <du4gkr$jvh$1@sea.gmane.org>

What's your charVocabulary option?
Please do not include FFFF(EOF for antlr) in charVocabulary.

You can use something like this:
class MCPPLexer extends Lexer;
options
{
    exportVocab=MCPP;
    k = 3;
    charVocabulary='\u0003'..'\uFFFE';
}


> 
> generate an incorrect MCPPLexer.cpp, here is the nextToken() (function), you can see clearly that this function does not deal with EOF, so it can never stop.
> 

-- 
Xue Yong Zhi
http://seclib.blogspot.com

From philip at catinet.dk  Wed Mar  1 08:21:34 2006
From: philip at catinet.dk (Philip Heede)
Date: Wed Mar  1 08:20:58 2006
Subject: [antlr-interest] ANTLR 2.7.6 C# race condition fix
Message-ID: <87305CF2F83DCA419B5B912D4BD1C0585B4EBC@mailserver.catdom.local>

Micheal,

>> We are using ANTLR in an ASP.NET (C#) application with great success.

>> However, we are experiencing some random crashes in situations with 
>> high memory usage, where the stack trace indicates that the crash 
>> originated in
>> 
>> antlr.ASTFactory.makeASTRoot(ASTPair currentAST, AST root)

>Any more info about the crash?. A stack trace?. What version of .NET?.
OS?.
>Is this on multi-CPU hardware?. Are you running many parsers in
parallel on
>separate threads?....

The exception is a null pointer exception with varying starting points,
but
all in ASTFactory:

[NullReferenceException: Object reference not set to an instance of an
object.]
   antlr.ASTFactory.addASTChild(ASTPair currentAST, AST child) +12
   (... previous function calls are from our own internal classes,
beginning 
   with the ANTLR generated parser)

[NullReferenceException: Object reference not set to an instance of an
object.]
   antlr.ASTFactory.makeASTRoot(ASTPair currentAST, AST root) +12
   (... previous function calls are from our own internal classes,
beginning 
   with the ANTLR generated parser)

are two examples.

The application is compiled with VS.NET 2002 (.NET 1.0) but is run under
ASP.NET with the .NET 1.1 runtime. OS is Windows 2003 (with SP1).
The hardware is running a configuration with dual-cpu Intel Xeon
processors
with hyperthreading (two physical cpus, four logical cores).
The parser may be called several times in parallel on separate incoming
web requests.

>> Does our problem sound
>> like it might be caused by the race condition mentioned in this fix? 
>> We'll be testing 2.7.6 shortly, but I hope to hear any comments you 
>> might have. Thanks!

>Possibly, couldn't say. In Jim's case, it manifested as an infinite
loop
>in ASTPair.advanceChildToEnd().

Sincerely,
Philip
From open.zone at virgin.net  Wed Mar  1 09:46:38 2006
From: open.zone at virgin.net (Micheal J)
Date: Wed Mar  1 09:29:55 2006
Subject: [antlr-interest] ANTLR 2.7.6 C# race condition fix
In-Reply-To: <87305CF2F83DCA419B5B912D4BD1C0585B4EBC@mailserver.catdom.local>
Message-ID: <005101c63d58$18371fc0$6702a8c0@hercules>

Philip,

> The application is compiled with VS.NET 2002 (.NET 1.0) but 
> is run under ASP.NET with the .NET 1.1 runtime. OS is Windows 
> 2003 (with SP1). The hardware is running a configuration with 
> dual-cpu Intel Xeon processors with hyperthreading (two 
> physical cpus, four logical cores). The parser may be called 
> several times in parallel on separate incoming web requests.

It could be a manifestation of the race condition issue given your multi-CPU
environment. I'd recommend testing 2.7.6 under similar loads on a
non-production box.


Cheers,

Micheal

From ewbank at gmail.com  Wed Mar  1 13:10:42 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Wed Mar  1 13:10:44 2006
Subject: [antlr-interest] Syntax error in action: What is wrong with my
	syntax?
In-Reply-To: <b6a7b26c0602281845r1aa61edk58b2a5135c4cf984@mail.gmail.com>
References: <b6a7b26c0602281845r1aa61edk58b2a5135c4cf984@mail.gmail.com>
Message-ID: <dd3a065f0603011310x16373d0ocb8a49e3cf3dbdfd@mail.gmail.com>

Action is missing commas in tree subexpressions after [TEST1] and
[TEST2].  I seem to recall getting bit by this because my hardcopy of
the manual was scrambled due to font problems.

I find it very handy to spread out the grammar file vertically (see
below) so that the file/line localizes the error...

On 2/28/06, Mark Felzer <mark.felzer@gmail.com> wrote:
> For some reason I keep getting a syntax error, what is wrong with
> this syntax?
>
> typeDefinition:
>         ID EQUAL! type
>         { #typeDefinition=
>               #([TYPE_DEFINITION,"TypeDefinition"],
>                   ID,
>                   ([TEST1] ID),
>                   ([TEST2] type) );
>         }
>         ;
>
> grammer.txt:55:53: Syntax error in action:
> grammer.txt:55:53: expecting ')', found 'I'
> Exiting due to errors.
From vs667 at nyu.edu  Wed Mar  1 18:47:27 2006
From: vs667 at nyu.edu (Vladimir S.)
Date: Wed Mar  1 18:47:38 2006
Subject: [antlr-interest] C# Question: cannot convert from 'method group' to
	'antlr.collections.AST
Message-ID: <44065CBF.3010406@nyu.edu>

Dear Group,

I am generating C# code and I am using C#.NET 2005 express.
ANTLR does NOT complain about the syntax, but C# seems to when I compile 
the code:
The grammar in question is:

*variable :     ID
        (componentSelection )?
        { #variable=
            #(
            [VARIABLE,"VARIABLE"],
            ID,
            componentSelection
            );
        }
    ;*

In this case componentSelection is another rule in the grammar; From 
this rule I wanted to generate a node with root node being "VARIABLE" 
first child being the ID, and the second child being the tree of the 
result of expanding the componentSelection rule. It seems like when I am 
using a NON terminals in this context, I get  this error:

I keep getting this error:
        *Error    4    Argument '3': cannot convert from 'method group' 
to 'antlr.collections.AST'    
C:\=PROGRAMMING=\=Compilers=\ParserFormV03\Parser\ParserCore.cs    
1801    79    ParseFormV02
*
This is the C# code that was generated from that grammar:
*variable_AST=
                    (AST) 
astFactory.make(astFactory.create(VARIABLE,"VARIABLE"), tmp93_AST, 
componentSelection);*
       

Thanks for all your help,
Vladimir
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060301/f8d322f8/attachment.html
From brade at informatik.uni-muenchen.de  Thu Mar  2 01:19:48 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Thu Mar  2 01:19:22 2006
Subject: [antlr-interest] empty alternatives erroneously consume tokens
Message-ID: <200603021019.55640.brade@informatik.uni-muenchen.de>

Hi,

I have a problem writing a grammar for parsing arithmetic expressions that 
contain mixed prefix and infix notation. For instance, this expression
  +( 1-(3+4) +(2 3)-1 )
simply means 
  1-(3+4)+2+3-1

What I would need in antlr is a syntactic predicate inside a loop, like this:

  c_expression: c_atom ( (arithmetic_op c_atom) => arithmetic_op c_atom )* ;

to test the following tokens at each repetition and quit the loop as soon as 
the predicate fails---but that doesn't work. 

So I thought about creating a recursive rule "cont" with the predicate and an 
empty alternative if the predicate fails. This is the complete little parser:

c_expression : (c_atom|c_bracket_exp|c_prefix_exp) cont ;

cont  : (arithmetic_op (c_atom|c_bracket_exp|c_prefix_exp)) 
            => arithmetic_op (c_atom|c_bracket_exp|c_prefix_exp) cont
      | { /* empty */ }
      ;

c_bracket_exp: BR_OPEN c_expression BR_CLOSE ;
c_prefix_exp : arithmetic_op BR_OPEN c_expression c_expression BR_CLOSE ;
c_atom       : INT ;

arithmetic_op: PLUS | MINUS ;

BR_OPEN: '(' ;
BR_CLOSE: ')' ;

However, instead of generating an empty "else" in cont() the generated code 
looks like this:

if ( synPredMatched221 ) {
    // here's the code for the predicate
}
else if ((_tokenSet_68.member(LA(1)))) {
    if ( inputState.guessing==0 ) {
        /* empty */
    }
}
else {
    throw new NoViableAltException(LT(1), getFilename());
}

So when parsing an expression I get 
   ....
   < c_expression; LA(1)==)
  < c_prefix_exp; LA(1)==null
  > cont; LA(1)==null
line 7:1: unexpected token: null  // here the expression ends correctly
  < cont; LA(1)==null
 < c_expression; LA(1)==null

at the end of the parse since the "else if" wants another token.
If I remove the "else if ((_tokenSet_68...." stuff and change the code to

if ( synPredMatched221 ) {
    // here's the code for the predicate
}
else {
}

it works! So what can I do to make ANTLR generate the code I want to have? 
I.e., an empty else branch?

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/e7e70044/attachment.bin
From demakov at ispras.ru  Thu Mar  2 02:31:57 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Thu Mar  2 02:31:50 2006
Subject: [antlr-interest] empty alternatives erroneously consume tokens
References: <200603021019.55640.brade@informatik.uni-muenchen.de>
Message-ID: <010201c63de4$88636150$8cc79553@marlboro>

1. empty alternative doesn't not consume tokens because only match(...)
method consume tokens. There are no match() calls in code for empty alternative.

2. _tokenSet_68 contains all tokens that can be after cont() rule.
So, if it is full grammar, _tokenSet_68 is empty. It causes
line 7:1: unexpected token: null

3. Try to add EOF at the end of c_expression() rule:
c_expression : (c_atom|c_bracket_exp|c_prefix_exp) cont EOF;
I'm sure it will solve the problem.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: "Michael Brade" <brade@informatik.uni-muenchen.de>
To: <antlr-interest@antlr.org>
Sent: Thursday, March 02, 2006 12:19 PM
Subject: [antlr-interest] empty alternatives erroneously consume tokens

Hi,

I have a problem writing a grammar for parsing arithmetic expressions that
contain mixed prefix and infix notation. For instance, this expression
  +( 1-(3+4) +(2 3)-1 )
simply means
  1-(3+4)+2+3-1

What I would need in antlr is a syntactic predicate inside a loop, like this:

  c_expression: c_atom ( (arithmetic_op c_atom) => arithmetic_op c_atom )* ;

to test the following tokens at each repetition and quit the loop as soon as
the predicate fails---but that doesn't work.

So I thought about creating a recursive rule "cont" with the predicate and an
empty alternative if the predicate fails. This is the complete little parser:

c_expression : (c_atom|c_bracket_exp|c_prefix_exp) cont ;

cont  : (arithmetic_op (c_atom|c_bracket_exp|c_prefix_exp))
            => arithmetic_op (c_atom|c_bracket_exp|c_prefix_exp) cont
      | { /* empty */ }
      ;

c_bracket_exp: BR_OPEN c_expression BR_CLOSE ;
c_prefix_exp : arithmetic_op BR_OPEN c_expression c_expression BR_CLOSE ;
c_atom       : INT ;

arithmetic_op: PLUS | MINUS ;

BR_OPEN: '(' ;
BR_CLOSE: ')' ;

However, instead of generating an empty "else" in cont() the generated code
looks like this:

if ( synPredMatched221 ) {
    // here's the code for the predicate
}
else if ((_tokenSet_68.member(LA(1)))) {
    if ( inputState.guessing==0 ) {
        /* empty */
    }
}
else {
    throw new NoViableAltException(LT(1), getFilename());
}

So when parsing an expression I get
   ....
   < c_expression; LA(1)==)
  < c_prefix_exp; LA(1)==null
  > cont; LA(1)==null
line 7:1: unexpected token: null  // here the expression ends correctly
  < cont; LA(1)==null
 < c_expression; LA(1)==null

at the end of the parse since the "else if" wants another token.
If I remove the "else if ((_tokenSet_68...." stuff and change the code to

if ( synPredMatched221 ) {
    // here's the code for the predicate
}
else {
}

it works! So what can I do to make ANTLR generate the code I want to have?
I.e., an empty else branch?

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations


From brade at informatik.uni-muenchen.de  Thu Mar  2 02:49:41 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Thu Mar  2 02:49:38 2006
Subject: [antlr-interest] languages without reserved words
Message-ID: <200603021149.44859.brade@informatik.uni-muenchen.de>

Hi all,

is there a standard way or a best practice to implement grammars for languages 
that allow identifiers to be anything, including the keywords of the language 
itself?

Example: I have a language that has the keyword "position", and that allows to
create tags like
  NCNAME (...) { .... }
with NCNAME being all letters and '_'.

Or think of C/C++ allowing to declare a variable "int struct = 0;".

The problem is that as soon as I use literals in the parser they are passed on 
to the lexer. If I disable testLiterals all keywords stay NCNAMEs, if I 
enable testLiterals all NCNAMES with text "position" are turned into the 
position-literal.

I don't want to use actions to test the NCNAME in the parser. What other 
possibilities are there?

Thanks,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/863684a2/attachment.bin
From mail at martin-probst.com  Thu Mar  2 03:03:43 2006
From: mail at martin-probst.com (Martin Probst)
Date: Thu Mar  2 03:04:07 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <200603021149.44859.brade@informatik.uni-muenchen.de>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
Message-ID: <1141297423.5243.9.camel@localhost.localdomain>

> is there a standard way or a best practice to implement grammars for languages 
> that allow identifiers to be anything, including the keywords of the language 
> itself?

There are several ways, and all of them suck somehow.
      * stateful lexing - create a lexer that keeps track of a lexical
        state and only check for keywords in certain states - pro: you
        always know what your token is - con: pretty complicated and
        messy to implement in ANTLR at the moment (might get better soon
        with island grammars!)
      * disambiguation with predicates - always return tokens as
        keywords, have a big rules called "identifier" that lists NCNAME
        and all your keywords, and then use syntactical predicates in
        the parser to work around the ambiguities. This is a little ugly
        and may be slow.
      * Wait for ANTLR 3 - in ANTLR 3 your problem might get solved
        without the syntactical predicates

Stateful lexing is nice because it keeps the complexity within the
lexer. But it means that you cannot just stop lexing somewhere in the
source file and restart lexing later - also handling lexical errors is a
lot more difficult.

Martin

From brade at informatik.uni-muenchen.de  Thu Mar  2 05:02:51 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Thu Mar  2 05:02:53 2006
Subject: [antlr-interest] empty alternatives erroneously consume tokens
In-Reply-To: <010201c63de4$88636150$8cc79553@marlboro>
References: <200603021019.55640.brade@informatik.uni-muenchen.de>
	<010201c63de4$88636150$8cc79553@marlboro>
Message-ID: <200603021402.55229.brade@informatik.uni-muenchen.de>

On Thursday 02 March 2006 11:31, Alexey Demakov wrote:
> 2. _tokenSet_68 contains all tokens that can be after cont() rule.
> So, if it is full grammar, _tokenSet_68 is empty. It causes
> line 7:1: unexpected token: null
>
> 3. Try to add EOF at the end of c_expression() rule:
> c_expression : (c_atom|c_bracket_exp|c_prefix_exp) cont EOF;
> I'm sure it will solve the problem.
Thanks for the answer, it made me realize the problem! EOF did not help, but 
the key is indeed the FOLLOW set: if I embed the c_expression rule within 
another rule that is not recursive, e.g.
  
   expression: c_expression;

and thus has an empty follow set, then it works :)

Thanks a lot,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/1046329b/attachment.bin
From ewbank at gmail.com  Thu Mar  2 05:23:24 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Mar  2 05:23:26 2006
Subject: [antlr-interest] C# Question: cannot convert from 'method group'
	to 'antlr.collections.AST
In-Reply-To: <44065CBF.3010406@nyu.edu>
References: <44065CBF.3010406@nyu.edu>
Message-ID: <dd3a065f0603020523j60362757ufb261cf14b2181bf@mail.gmail.com>

>  variable :     ID
>          ( componentSelection )?
>          { #variable=
>              #(
>                   [VARIABLE,"VARIABLE"],
>                   ID,
>                   componentSelection
>              );
>          }
>      ;
>
>  This is the C# code that was generated from that grammar:
>  variable_AST=
>                      (AST)
> astFactory.make(astFactory.create(VARIABLE,"VARIABLE"), tmp93_AST,
> componentSelection);

There are two problems with this code; one is a code generation
problem - that's the one reporting the error - and one a logic error
that you will have to clear up on your own.

The problem in code generation is that componentSelection, inside the
#(...) expression, is not being recognized as a reference to a tree. 
Instead, it's just the bare rulename - which is a method function.  My
workaround is to (1) always name rule elements, and (2) always use the
"#" prefix, even within #(...) expressions.  Probably overkill, but I
don't have code-generation failures when I use this technique.

Your rule would end up looking like this (note that ## means "tree of
this rule"):

  variable :     id:ID
          ( cs:componentSelection )?
          { ## =
              #(
                   #[VARIABLE,"VARIABLE"],
                   #id,
                   #cs
              );
          }
      ;

The other problem (the logic problem) is that you are using the result
of componentSelection even if that rule has not been called.  At the
risk of someone accusing me of always using the same solution :-), you
could do this to avoid the logic problem:

   variable
   :     ID
           ( componentSelection )?
           { ## = #( [VARIABLE,"VARIABLE"], ## ); }
   ;

It is a more standard idiom for adding nodes to a tree, and avoids the
question of whether componentSelection was recognized.  The problem,
in this case, is that you can end up with VARIABLE nodes with either
one or two children.  I say "problem" here because it causes problems
in subsequent tree parsers; however, if you don't need to worry about
falling off of the tree, you can accept this.

There's an example in the antlrman.pdf that discusses this tree-shape
problem in the context of the "-" operator being either a minus, or a
unary negation operator.

Hope this helps,
- Bryan
From open.zone at virgin.net  Thu Mar  2 06:30:23 2006
From: open.zone at virgin.net (Micheal J)
Date: Thu Mar  2 06:13:42 2006
Subject: [antlr-interest] C# Question: cannot convert from 'method group'
	to'antlr.collections.AST
In-Reply-To: <44065CBF.3010406@nyu.edu>
Message-ID: <007001c63e05$d84b9b30$6702a8c0@hercules>

Either label ID and componentSelection (i.e. label:ruleOrTerminal) and use
those labels or, use the ## notation. The componentSelection in the
generated code is a method not an AST instance.
 
Micheal
 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Vladimir S.
Sent: 02 March 2006 02:47
To: antlr-interest@antlr.org
Subject: [antlr-interest] C# Question: cannot convert from 'method group'
to'antlr.collections.AST


Dear Group,

I am generating C# code and I am using C#.NET 2005 express. 
ANTLR does NOT complain about the syntax, but C# seems to when I compile the
code:
The grammar in question is:

variable :     ID
        (componentSelection )?
        { #variable= 
            #(
            [VARIABLE,"VARIABLE"],
            ID,
            componentSelection
            );
        }
    ;

In this case componentSelection is another rule in the grammar; From this
rule I wanted to generate a node with root node being "VARIABLE" first child
being the ID, and the second child being the tree of the result of expanding
the componentSelection rule. It seems like when I am using a NON terminals
in this context, I get  this error:

I keep getting this error:
        Error    4    Argument '3': cannot convert from 'method group' to
'antlr.collections.AST'
C:\=PROGRAMMING=\=Compilers=\ParserFormV03\Parser\ParserCore.cs    1801
79    ParseFormV02

This is the C# code that was generated from that grammar:
variable_AST= 
                    (AST)
astFactory.make(astFactory.create(VARIABLE,"VARIABLE"), tmp93_AST,
componentSelection);
        

Thanks for all your help,
Vladimir 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/fda474de/attachment.html
From christopher.d.schultz at comcast.net  Thu Mar  2 07:58:13 2006
From: christopher.d.schultz at comcast.net (Christopher Schultz)
Date: Thu Mar  2 07:58:17 2006
Subject: [antlr-interest] Help with circular reference in parser?
Message-ID: <44071615.50902@comcast.net>

All,

Sorry for the potentially newbie question, but I have a circular
reference in my grammar that I'm not sure how to resolve. I'd love it if
someone would take a quick look and let me know if it's something simple
that I should change.

To begin with, I had a completely working mathematical expression
evaluator. I decided to add "array references" so that I could have
expressions like

     array[index]

This worked just fine, and I even got dynamic indexes working, like:

     array[1+1]

The problem arises when I want to allow the array reference itself to be
dynamic, like this:

     array()[1]

...where "array" is a function that hopefully returns an array. In order
to allow the reference to be dynamic, I had to change my parser rule
from this:

// Array reference (i.e. a[3])
arrayref returns [ Expression exp = null ] throws EvaluationException
    {
        Expression index; // dynamic index ;)
    }
    :
        array:IDENTIFIER^ LBRACKET! (index=expr) RBRACKET!
        {
            exp = new ArrayReferenceExpression(array.getText(), index);
        }
    ;

To this:

// Array reference (i.e. a[3])
arrayref returns [ Expression exp = null ] throws EvaluationException
    {
        Expression arrayRef; // dynamic reference ;)
        Expression index; // dynamic index ;)
    }
    :
        ( array=expr ) LBRACKET! (index=expr) RBRACKET!
        {
            exp = new ArrayReferenceExpression(array, index);
        }
    ;

As one might imagine, the rule "array=expr" refers to my top-level
expression parser rule, which of course feeds back on itself. My guess
is that even though the rules are (technically) circular, the parser
ought to eventually reach a point where the input does not cause it to
feedback.

The actual error is super long, but I'm including it, anyway, in the
interest in full disclosure. Feel free to skip past it.

antlr:
    [antlr] ANTLR Parser Generator   Version 2.7.3   1989-2004 jGuru.com
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:63:13: infinite
recursion to rule atom from rule multexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:53:13: infinite
recursion to rule atom from rule addexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:37:13: infinite
recursion to rule atom from rule relexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:23:13: infinite
recursion to rule atom from rule expr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:104:17: infinite
recursion to rule atom from rule arrayref
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:140:13: infinite
recursion to rule atom from rule atom
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:77:21: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:77:21: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:79:22: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:63:13: infinite
recursion to rule atom from rule multexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:53:13: infinite
recursion to rule atom from rule addexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:37:13: infinite
recursion to rule atom from rule relexpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:23:13: infinite
recursion to rule atom from rule expr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:104:17: infinite
recursion to rule atom from rule arrayref
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:140:13: infinite
recursion to rule atom from rule atom
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:180:21: infinite
recursion to rule atom from rule atom
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:
warning:nondeterminism between alts 1 and 3 of block upon
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:     k==1:BANG
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:
k==2:PLUS,MINUS,BANG,IDENTIFIER,LPAREN,HEX_LITERAL,OCTAL_LITERAL,INT_LITERAL,DECIMAL_LITERAL,STRING
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:79:22: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:
warning:nondeterminism between alts 2 and 3 of block upon
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:     k==1:MINUS
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:76:9:
k==2:PLUS,MINUS,BANG,IDENTIFIER,LPAREN,HEX_LITERAL,OCTAL_LITERAL,INT_LITERAL,DECIMAL_LITERAL,STRING
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:23: infinite
recursion to rule atom from rule unaryExpr
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:10:
warning:nondeterminism between alts 1 and 2 of block upon
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:10:     k==1:PLUS
    [antlr]
/home/chris/projects/evaluator/src/grammar/expression.g:81:10:
k==2:PLUS,MINUS,BANG,IDENTIFIER,LPAREN,HEX_LITERAL,OCTAL_LITERAL,INT_LITERAL,DECIMAL_LITERAL,STRING
    [antlr] Exiting due to errors.

===========================

END OF ERROR MESSAGE

===========================

Perhaps I'm way off base, too. I'm attaching my full grammar file which
has the non-working definition of "arrayref" in there.

Any help would be most appreciated.

Thanks,
-chris

From zara.sheil at ucdconnect.ie  Thu Mar  2 08:03:43 2006
From: zara.sheil at ucdconnect.ie (Zara Jane Sheil)
Date: Thu Mar  2 08:04:08 2006
Subject: [antlr-interest] unexpected AST node
Message-ID: <4599755.1141315423052.JavaMail.zara.sheil@ucdconnect.ie>

Thanks Bryan,
I thought it might have something to do with calling each function 
separately in my Main. Not too sure how to avoid this though because 
each function has a different type; int, boolean etc. Any ideas?

Thanks again,
Zara
From christopher.d.schultz at comcast.net  Thu Mar  2 08:22:32 2006
From: christopher.d.schultz at comcast.net (Christopher Schultz)
Date: Thu Mar  2 08:22:36 2006
Subject: [antlr-interest] Help with circular reference in parser?
In-Reply-To: <44071615.50902@comcast.net>
References: <44071615.50902@comcast.net>
Message-ID: <44071BC8.6010307@comcast.net>

Sorry, forgot the attachment.

Here is the grammar in all it's glory.

Thanks,
-chris


header {
    package net.christopherschultz.evaluator.parser;

    import net.christopherschultz.evaluator.*;
}

class ExpressionParserImpl extends Parser;

options {
   buildAST = false;
   k=2; // 2-token lookahead: can differentiate between
        // ( MINUS INT ) and ( MINUS FLOAT )
defaultErrorHandler = false;
}

/* We have expr and mexpr separate, with the addition and subtraction
   separate from multiplication in order to enforce order-of-operations. */
expr returns [Expression exp = null] throws EvaluationException
    {
        Expression right;
    }
    :
        exp=relexpr (
            ( AND^ right=relexpr) { exp = new MathExpression(exp, "&&",
right); }
            | (OR^ right=relexpr)  { exp = new MathExpression(exp, "||",
right); }
        )*
        // This (EOF)? seem totally sketchy, but it works!
        (EOF!)?
    ;

// Relational Expression
relexpr returns [Expression exp = null] throws EvaluationException
    {
        Expression right;
    }
    :
        exp=addexpr (
            (EQUALS^ right=addexpr) { exp = new MathExpression(exp, "=",
right); }
            | (NOT_EQUALS^ right=addexpr) { exp = new
MathExpression(exp, "!=", right); }
            | (GREATERTHAN^ right=addexpr) { exp = new
MathExpression(exp, ">", right); }
            | (LESSTHAN^ right=addexpr) { exp = new MathExpression(exp,
"<", right); }
            | (GREATERTHANEQUALTO^ right=addexpr) { exp = new
MathExpression(exp, ">=", right); }
            | (LESSTHANEQUALTO^ right=addexpr) { exp = new
MathExpression(exp, "<=", right); }
        )*
    ;

// Arithmetic Expression
addexpr returns [Expression exp = null] throws EvaluationException
    {
        Expression right;
    }
    :
        exp=multexpr (( PLUS^ right=multexpr { exp = new
MathExpression(exp, "+", right); }
                      | MINUS^ right=multexpr { exp = new
MathExpression(exp, "-", right); } ))*
    ;

// Multiplicative (or divisive) expression
multexpr returns [Expression exp = null] throws EvaluationException
    {
        Expression right;
    }
    :
        exp=unaryExpr (
            ( STAR^ right=unaryExpr { exp = new MathExpression(exp, "*",
right); } )
            |
            ( SLASH right=unaryExpr { exp = new MathExpression(exp, "/",
right); } )
            |
            ( PERCENT right=unaryExpr { exp = new MathExpression(exp,
"%", right); } )

        )*
    ;

// (Logically) negated expression
unaryExpr returns [ Expression exp = null ] throws EvaluationException
    :
        (
         (BANG^ exp=atom { exp = new NegatedExpression(exp); })
         |
         (MINUS^ exp=atom { exp = new UnaryMinusExpression(exp); })
         |
         (PLUS!)? exp=atom
        )
    ;

// Function call expression
functioncall returns [ Expression exp = null ] throws EvaluationException
    {
        java.util.List args = null;
    }
    :
        func:IDENTIFIER^ LPAREN! (args=argumentlist)? RPAREN!
        {
            exp = new FunctionCallExpression(func.getText(), args);
        }
    ;

// Array reference (i.e. a[3])
arrayref returns [ Expression exp = null ] throws EvaluationException
    {
        Expression index; // dynamic index ;)
    }
    :
        array:IDENTIFIER^ LBRACKET! (index=expr) RBRACKET!
        {
            exp = new ArrayReferenceExpression(array.getText(), index);
        }
    ;

// arrayref returns [ Expression exp = null ] throws EvaluationException
//     {
//         Expression array; // dynamic reference ;)
//         Expression index; // dynamic index ;)
//     }
//     :
//         (array=expr)
//         |
//         (array=expr) LBRACKET! (index=expr) RBRACKET!
//         {
//             exp = new ArrayReferenceExpression(array.getText(), index);
//         }
//     ;

// Argument List
argumentlist returns [java.util.List list = new java.util.ArrayList()]
throws EvaluationException
    {
        Expression arg;
    }
    :
        arg=argument { list.add(arg); }
        (COMMA! arg=argument { list.add(arg); })*
    ;

// Argument (i.e. anything)
argument returns [Expression exp = null] throws EvaluationException
    :
        exp=expr
    ;

// Indentifiers (i.e. symbols)
identifier returns [ Expression exp = null ] throws EvaluationException
    :
        id:IDENTIFIER
        {
            exp = new IdentifierExpression(id.getText());
        }
    ;

// Atoms
atom returns [Expression exp = null] throws EvaluationException
    :
        exp=functioncall
        |
        exp=arrayref
        |
        exp=identifier
        |
        hex:HEX_LITERAL {   Object value;
                            String hexStr = hex.getText();
                            int length = hexStr.length();
                            if(length > 10) // 8 hex + leading "0x"
                                value = Long.decode(hexStr);
                            else if(length > 6)
                                value = Integer.decode(hexStr);
                            else if(length > 4)
                                value = Short.decode(hexStr);
                            else
                                value = Byte.decode(hexStr);
                            exp = new ConstantExpression(value);
                        }
        |
        oct:OCTAL_LITERAL { Object value;
                            String octalStr = oct.getText();
                            int length = octalStr.length();
                            if(length > 11) // 10 octal + leading "0"
                                value = Long.decode(octalStr);
                            else if(length > 6)
                                value = Integer.decode(octalStr);
                            else if(length > 3)
                                value = Short.decode(octalStr);
                            else
                                value = Byte.decode(octalStr);
                            exp = new ConstantExpression(value);
                        }
        |
/* TODO: allow larger precision than simply 32-bit integer. Long?
BigInteger? */
/* TODO: How can we use a BigInteger to determine if the value fits into
a certain type of primitive? Just make BigInteger objects out of
Integer.MAX_VALUE, etc? */
        i:INT_LITERAL { exp = new ConstantExpression(new
Integer(i.getText())); }
        |
        f:DECIMAL_LITERAL { exp = new ConstantExpression(new
Double(f.getText())); }
        |
        s:STRING { exp = new ConstantExpression(s.getText()); }
        |
        LPAREN! exp=expr RPAREN!
    ;

class ExpressionLexerImpl extends Lexer;

options {
    k=2; // (2)needed for newline junk, (5) needed for booleans
    charVocabulary = '\3'..'\377';
}

IDENTIFIER: WORDCHAR (WORDCHAR | DIGIT)*;

STRING
    :
        DOUBLEQUOTE!
        (CHAR_ESC | ~('\"' | '\\') )*
        DOUBLEQUOTE!
    ;

protected CHAR_ESC
    :
        '\\'
        ( 'n'  { $setText("\n"); }
        | 'r'  { $setText("\r"); }
        | 't'  { $setText("\t"); }
        | 'b'  { $setText("\b"); }
        | 'f'  { $setText("\f"); }
        | '\"' { $setText("\""); }
        | '\'' { $setText("\'"); }
        | '\\' { $setText("\\"); }
        )
    ;

NUMERIC_LITERAL:
        (ZERO (OCTAL_DIGIT)+) => OCTAL_LITERAL { $setType(OCTAL_LITERAL); }
        |
        (ZERO Xx) => HEX_LITERAL  { $setType(HEX_LITERAL); }
        |
        (DOT DIGITS) => DECIMAL_LITERAL { $setType(DECIMAL_LITERAL); }
        |
        (DIGITS DOT) => DECIMAL_LITERAL { $setType(DECIMAL_LITERAL); }
        |
        (DIGITS)    { $setType(INT_LITERAL); }
        ;

/*
NUMERIC_LITERAL:
        (ZERO (OCTAL_DIGIT)+) => OCTAL_LITERAL { $setType(OCTAL_LITERAL); }
        |
        (ZERO Xx) => HEX_LITERAL  { $setType(HEX_LITERAL); }
        |
        ((
            ( PLUS  { $setType(PLUS); } )
            |
            ( MINUS { $setType(MINUS); } )
         )?
            ( ( DIGITS { $setType(INT_LITERAL); } )
              ( DOT (DIGITS)? { $setType(DECIMAL_LITERAL); } )?
              |
              ( ( DOT DIGITS ) => DECIMAL_LITERAL {
$setType(DECIMAL_LITERAL); } )
            )
        )
        |
        (DIGITS)    { $setType(INT_LITERAL); }
           ((DOT) => DECIMAL_LITERAL { $setType(DECIMAL_LITERAL); } )?
        ;
*/

protected OCTAL_LITERAL: (ZERO (OCTAL_DIGIT)+) ;

protected OCTAL_DIGIT: '0'..'7' ;

protected HEX_LITERAL :  (ZERO Xx (HEX_DIGIT)+) ;

protected ZERO: '0' ;

protected Xx: ('x' | 'X') ;

protected HEX_DIGIT: ( 'a'..'z' | 'A'..'Z' | DIGIT ) ;

protected INT_LITERAL: DIGITS ;

protected DECIMAL_LITERAL: ( ( DIGITS )? DOT ( DIGITS )? ) ;

protected DIGITS : ( DIGIT )+ ;

protected SIGN: ( PLUS | MINUS ) ;

protected
WORDCHAR:   'a'..'z' | 'A'..'Z' | '_' ;

protected
DIGIT: '0'..'9';

protected
DOT: '.' ;

BANG: '!' ;

COMMA: ','
        ;

LBRACKET: '['
        ;

RBRACKET: ']'
        ;

LPAREN: '('
        ;

RPAREN: ')'
        ;

PLUS: '+'
        ;

MINUS: '-'
        ;

STAR: '*'
    ;

PERCENT: '%'
    ;

SLASH: '/'
    ;

AND: '&''&'
        ;

OR: '|''|'
        ;

EQUALS: '='
        ;

NOT_EQUALS
    :
        BANG EQUALS
    ;

GREATERTHAN: '>' ;

LESSTHAN: '<' ;

GREATERTHANEQUALTO: '>' '=' ;

LESSTHANEQUALTO: '<' '=' ;

SINGLEQUOTE: '\'' ;

DOUBLEQUOTE: '\"' ;

/*
protected
TRUE: 't''r''u''e'
        ;

protected
FALSE: 'f''a''l''s''e'
        ;
*/

WS:
        (   ' '
        |   '\t'
        |   '\r' '\n' { newline(); }
        |   '\n'      { newline(); }
        )
        {$setType(Token.SKIP);} //ignore this token
    ;



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 250 bytes
Desc: OpenPGP digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/3ec687ba/signature.bin
From kibab at icehouse.net  Thu Mar  2 21:21:15 2006
From: kibab at icehouse.net (Kaleb Pederson)
Date: Thu Mar  2 21:21:26 2006
Subject: [antlr-interest] related master's thesis ideas...
Message-ID: <200603022121.20865.kibab@icehouse.net>

Hello all,

I'm getting close to the point where I need to start working no my master's 
thesis and am throwing around some ideas, so I thought I would see what 
suggestions some of you might have.

Here are a few thoughts that have crossed my mind, each of which somehow 
relates to parsing or compiler design (in no particular order):

1) Incremental parsing (specifically for not re-parsing an entire file, for 
example within an IDE).  This could be interesting, both in theory and to try 
to make Antlr support this.

2) Create a static code analysis tool, probably to handle C/C++ code although 
if I used the right IR trees, it could probably easily be expanded to other 
languages fairly easily.  This would probably also present the ability to 
create a mini-language of sorts, something that would allow you to create 
specific test cases that the programmer was interested in, with a certain 
standard set of featurs.

3) Something with Antlr-v3 and probably/hopefully Python ;), perhaps wrapping 
the C/C++ generated code so that it can be used as an extension module, 
assuming they were considerably faster than the regular Python one (only real 
reason to do such)?

I'm sure there are other things that will cross my mind at some point, but 
those are the first ideas that have crossed my mind (that I can still 
remember).

Right now, I'm looking for an idea that I will enjoy but also allows me the 
chance to do both theory and coding.

Ideas?

Thanks.

--Kaleb

PS: Ter, I hope your dvorak skills are coming along.  I switched to dvorak 
about two and a half years ago (maybe three now) and I'm probably 20-40% 
faster than I was back then, and I was quite capable then.  It's definitely 
worth it (although the efficiency takes a while to pick back up)!  Keep at it 
and good luck!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060302/d19c2e88/attachment.bin
From demakov at ispras.ru  Fri Mar  3 00:05:31 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Fri Mar  3 00:05:22 2006
Subject: [antlr-interest] Help with circular reference in parser?
References: <44071615.50902@comcast.net>
Message-ID: <01c801c63e99$3f401300$8cc79553@marlboro>

It is well-known left recursion. Such kind of circular references not allowed
in LL-parsers. So, you need to transform recursions to loops like

expr: primaryExpr ( arraySuffix | functionSuffix )* ;

primaryExpr: literal | identifier ;

arraySuffix: "[" expr "]" ;

functionSuffix: "(" expr ")" ;

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com

----- Original Message ----- 
From: "Christopher Schultz" <christopher.d.schultz@comcast.net>
To: <antlr-interest@antlr.org>
Sent: Thursday, March 02, 2006 6:58 PM
Subject: [antlr-interest] Help with circular reference in parser?


> All,
> 
> Sorry for the potentially newbie question, but I have a circular
> reference in my grammar that I'm not sure how to resolve. I'd love it if
> someone would take a quick look and let me know if it's something simple
> that I should change.
> 
> To begin with, I had a completely working mathematical expression
> evaluator. I decided to add "array references" so that I could have
> expressions like
> 
>     array[index]
> 
> This worked just fine, and I even got dynamic indexes working, like:
> 
>     array[1+1]
> 
> The problem arises when I want to allow the array reference itself to be
> dynamic, like this:
> 
>     array()[1]
> 
> ...where "array" is a function that hopefully returns an array. In order
> to allow the reference to be dynamic, I had to change my parser rule
> from this:
> 
> // Array reference (i.e. a[3])
> arrayref returns [ Expression exp = null ] throws EvaluationException
>    {
>        Expression index; // dynamic index ;)
>    }
>    :
>        array:IDENTIFIER^ LBRACKET! (index=expr) RBRACKET!
>        {
>            exp = new ArrayReferenceExpression(array.getText(), index);
>        }
>    ;
> 
> To this:
> 
> // Array reference (i.e. a[3])
> arrayref returns [ Expression exp = null ] throws EvaluationException
>    {
>        Expression arrayRef; // dynamic reference ;)
>        Expression index; // dynamic index ;)
>    }
>    :
>        ( array=expr ) LBRACKET! (index=expr) RBRACKET!
>        {
>            exp = new ArrayReferenceExpression(array, index);
>        }
>    ;
> 
> As one might imagine, the rule "array=expr" refers to my top-level
> expression parser rule, which of course feeds back on itself. My guess
> is that even though the rules are (technically) circular, the parser
> ought to eventually reach a point where the input does not cause it to
> feedback.


From dragonoe at mcmaster.ca  Fri Mar  3 05:40:12 2006
From: dragonoe at mcmaster.ca (Olivier Dragon)
Date: Fri Mar  3 05:34:48 2006
Subject: [antlr-interest] No literals with two parsers using same TokenTypes
Message-ID: <20060303134012.GA22494@dragon.homelinux.org>

Hi,

Using ANTLR 2.5, I have the following problem:

I'm trying to write two parsers that have the same output tree language,
but different input languages. In order to make things easier on myself
I thought of sharing token types by importing the vocabulary from
GrammarA into GrammarB.

My problem is with literals inside the parser. All the tokens defined as
rules in the lexer of GrammarB, as well as tokens defined inside the
tokens{} section of GrammarB are merged with the tokens from GrammarA
properly, except for literal strings inside the parser.

I have the following headers in GrammarB:

class GrammarBParser extends Parser;
options {
    importVocab=LanguageA;
    exportVocab=LanguageB;
}

class GrammarBLexer extends Lexer;
options {
    importVocab=LanguageA;
    exportVocab=LanguageB;
}

And a file called "LanguageATokenTypes.txt" in the same directory as
GrammarB.

Any idea what I'm doing wrong? I could put all the literals in the
tokens{} section as a workaround, but I would rather avoid that if
possible.

Thanks!
-Olivier

-- 
          __-/|    ? ?     |\-__
     __--/  /  \   (^^)   /  \  \--__
  _-/   /   /  /\ / ( )  /\  \   \   \-_
 /  /   /  /  /  (   ^^ ~  \  \  \   \  \
 / Oli Dragon    ( dragonoe@mcmaster.ca \
/  B.Eng. Sfwr   ( dragon.homelinux.org  \
/  /  /    /__--_ (   ) __--__\    \  \  \
|  /  /  _/        \_ \_       \_  \  \  |
 \/  / _/            \_ \_       \_ \  \/
  \_/ /                -\_\        \ \_/
    \/                    )         \/
                        *~
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/7115c390/attachment.bin
From brade at informatik.uni-muenchen.de  Fri Mar  3 06:44:48 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Fri Mar  3 06:43:54 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <1141297423.5243.9.camel@localhost.localdomain>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<1141297423.5243.9.camel@localhost.localdomain>
Message-ID: <200603031544.51220.brade@informatik.uni-muenchen.de>

On Thursday 02 March 2006 12:03, Martin Probst wrote:
> > is there a standard way or a best practice to implement grammars for
> > languages that allow identifiers to be anything, including the keywords
> > of the language itself?
>
> There are several ways, and all of them suck somehow.
Thanks, they suck rocks indeed... I decided to wait for v3, predicates are the 
only solution right now but since the grammar is quite big with a lot of 
keywords it is not worthwile to do.

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/5d8ea7e7/attachment.bin
From jose.ventura.roda at gmail.com  Fri Mar  3 06:51:26 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Fri Mar  3 06:51:30 2006
Subject: [antlr-interest] Relational operator in COBOL
Message-ID: <e39abda10603030651wc276fcey@mail.gmail.com>

Hi, all

I'm trying to write a cobol lex and I have a problem with the relational
operator.

In cobol the operator NOT is a unary operator, but if they is following of
the '=' operator, is the NotEqual operator. There isn't a expecific operator
for NotEqual like java ("!=").

I don't know to resolve this problem in the parser, I have to much
ambiguities.

Any know how can I detect "NOT =" OR "NOT EQUAL" ?

Thanks a lot,


class CobolLex extends Lexer;
options
{
 k=2;
 charVocabulary = '\3'..'\377'; // Unicodes usuales
 caseSensitive=false;
 caseSensitiveLiterals=false;
 testLiterals=false;
 exportVocab=CobolLexVocab;

}
tokens

{
 FIN_TODO;
 NUM;
    IDENT;
 LIT_HEXADECIMAL;
 LIT_PIC;
 LIT_COPY;
 FECHA;
 IGUAL;

    IDENTIFICATION="IDENTIFICATION";
 ID="ID";
 ENVIRONMENT="ENVIRONMENT";
 DATA="DATA";
 WORKING="WORKING-STORAGE";
 LINKAGE="LINKAGE";
 DIVISION="DIVISION";
 PROGRAM_ID="PROGRAM-ID";
 PROCEDURE="PROCEDURE";
 SECTION="SECTION";

 ACCEPT="ACCEPT";
 ADD="ADD";
 ALL="ALL";
 ALSO="ALSO";
 ALTER="ALTER";
 AND="AND";
 AT="AT";
 BLANK="BLANK";
 BY="BY";
 CALL="CALL";
 CANCEL="CANCEL";
 CICS="CICS";
 CLOSE="CLOSE";
 COMPUTE="COMPUTE";
 COMMAREA="COMMAREA";
 COMMIT="COMMIT";
 CONTINUE="CONTINUE";
 CORR="CORR";
 CORRESPONDING="CORRESPONDING";
 DELETE="DELETE";
 DELIMITED="DELIMITED";
 DISPLAY="DISPLAY";
 DIVIDE="DIVIDE";
 ELSE="ELSE";
 END="END";
 END_ADD="END-ADD";
 END_CALL="END-CALL";
 END_COMPUTE="END-COMPUTE";
 END_DIVIDE="END-DIVIDE";
 END_EVALUATE="END-EVALUATE";
 END_EXEC="END-EXEC";
 END_IF="END-IF";
 END_MULTIPLY="END-MULTIPLY";
 END_PERFORM="END-PERFORM";
 END_SEARCH="END-SEARCH";
 END_STRING="END-STRING";
 END_UNSTRING="END-UNSTRING";
 END_SUBTRACT="END-SUBTRACT";
 ENTRY="ENTRY";
 EVALUATE="EVALUATE";
 EXEC="EXEC";
 EXIT="EXIT";
 METHOD="METHOD";
 PROGRAM="PROGRAM";
 GOBACK="GOBACK";
 GO_TO="GO TO";
 IF="IF";
 IN="IN";
 INITIALIZE="INITIALIZE";
 INSPECT="INSPECT";
 INTO="INTO";
 INVOKE="INVOKE";
 LINK="LINK";
 MERGE="MERGE";
 MOVE="MOVE";
 MULTIPLY="MULTIPLY";
 OF="OF";
 OPEN="OPEN";
 OR="OR";
 OTHER="OTHER";
 PERFORM="PERFORM";
 POINTER="POINTER";
 READ="READ";
 RECEIVE="RECEIVE";
 REDEFINES="REDEFINES";
 RELEASE="RELEASE";
 REPLACING="REPLACING";
 TALLYING="TALLYING";
 RETURN="RETURN";
 REWRITE="REWRITE";
 ROLLBACK="ROLLBACK";
 SEARCH="SEARCH";
 SEND="SEND";
 SET="SET";
 SQL="SQL";
 SORT="SORT";
 SPACE="SPACE";
 SPACES="SPACES";
 START="START";
 STOP="STOP";
 STRING="STRING";
 SUBTRACT="SUBTRACT";
 SYNCPOINT="SYNCPOINT";
 TO="TO";
 THEN="THEN";
 UNSTRING="UNSTRING";
 WRITE="WRITE";
 ZERO="ZERO";
 ZEROS="ZEROS";
 ZEROES="ZEROES";
 THROUGH="THROUGH";
 THRU="THRU";
 VARYING="VARYING";
 UNTIL="UNTIL";
 USING="USING";
 WHEN="WHEN";
 WITH="WITH";
 TEST="TEST";
 BEFORE="BEFORE";
 AFTER="AFTER";
 JUSTIFIED="JUSTIFIED";
 JUST="JUST";
 OCCURS="OCCURS";
 ASCENDING="ASCENDING";
 DESCENDING="DESCENDING";
 KEY="KEY";
 IS="IS";
 INDEXED="INDEXED";
 PIC="PIC";
 PICTURE="PICTURE";
 USAGE="USAGE";
 VALUE="VALUE";
 VALUES="VALUES";
 ARE="ARE";
 RENAMES="RENAMES";
 COPY="COPY";
 BINARY="BINARY";
 COMP="COMP";
 COMP1="COMP-1";
 COMP2="COMP-2";
 COMP3="COMP-3";
 COMP4="COMP-4";
 COMPUTATIONAL="COMPUTATIONAL";
 COMPUTATIONAL1="COMPUTATIONAL-1";
 COMPUTATIONAL2="COMPUTATIONAL-2";
 COMPUTATIONAL3="COMPUTATIONAL-3";
 COMPUTATIONAL4="COMPUTATIONAL-4";
 DISPLAY1="DISPLAY-1";
 INDEX="INDEX";
 PACKED_DECIMAL="PACKED-DECIMAL";
 CHARACTERS="CHARACTERS";
 LEADING="LEADING";
 FIRST="FIRST";
 INITIAL="INITIAL";
 CONVERTING="CONVERTING";
 FOR="FOR";
 UP="UP";
 DOWN="DOWN";
 NOT="NOT";
 NULL="NULL";
 ON="ON";
 SIZE="SIZE";
 ERROR="ERROR";
 THAN="THAN";
 GREATER="GREATER";
 LESS="LESS";
 EQUAL="EQUAL";
 NUMERIC="NUMERIC";
 ALPHABETIC="ALPHABETIC";
 POSITIVE="POSITIVE";
 NEGATIVE="NEGATIVE";
 FROM="FROM";


}

{ // Comienza la zona de c?digo nativo

boolean ultPic=false;
boolean enExec=false;
protected Token makeToken(int type)
{
 // Usamos la implementaci?n de la superclase...
 Token result = null;
 if (enExec)
 {
  if (type==END_EXEC||
   type==RETURN ||
   type==RECEIVE ||
   type==SEND   ||
   type==SYNCPOINT ||
   type==LINK
   )
  {
   enExec=false;
   result = super.makeToken(type);
  }
  else
  {
   result = super.makeToken(IDENT);
  }
 }
 else
 {
  result = super.makeToken(type);
  if (type==SQL||type==CICS)
  {
   enExec = true;
  }
 }


 ultPic =(type==PIC||type==PICTURE);

 // ... a?adimos informaci?n del nombre de fichero
 result.setFilename(super.getFilename());
 // ... y devolvemos el token
 return (result);
}
}
COMENTARIO:
 '@' ( ~('\n'|'\r') )*
 {$setType(Token.SKIP);}
 ;

PAR_AB
 : {!ultPic }? '('
 ;
PAR_CE
 : {!ultPic }? ')'
 ;
CAD_COPY
 : ("==") => "==" ( ~('=') )* "=="
 { $setType(LIT_COPY); }
 | '='
 { $setType(IGUAL); }
 ;
DOSPUNTOS
 : ':'
 ;

MAS
 : {!ultPic }?
   '+' {_ttype = MAS;}
   (
     (DIGITO)+ (',' (DIGITO)+)?
   {_ttype = NUM;}
    )?
 ;

MENOS
 : {!ultPic }?
   '-' {_ttype = MENOS;}
   (
     (DIGITO)+ (',' (DIGITO)+)?
   {_ttype = NUM;}
    )?
 ;

PUNTO
 : {!ultPic }?
   '.' {_ttype = FIN_TODO;}
   (
    (DIGITO)+ {_ttype=NUM;}
    )?
  ;

COMA
 : {!ultPic }?
   ','
   (
    (DIGITO)+ {_ttype=NUM;}
    )?
  ;
POR
 : {!ultPic }? '*'
 ;

DIVIDE
 : '/'
 ;

MAYOR: '>';
MENOR: '<';
MAYOR_IGUAL: ">=";
MENOR_IGUAL: "<=";

protected
LETRA
 : 'a'..'z'
 ;

protected
DIGITO
 : '0'..'9'
 ;


protected
NL :
  (
   ("\r\n") => "\r\n" // MS-DOS
   | '\r' // MACINTOSH
   | '\n' // UNIX
   )
   {newline(); }
   ;

BLANCO :
  ( ' '
  | '\t'
  | NL
  )
  { $setType(Token.SKIP); } // La acci?n del blanco: ignorar
  ;

IDENT_NUM  options {testLiterals=true;}
 :{ ultPic }?
('+'|'-'|'$'|'b'|','|'e'|('0'..'9')|'x'|'s'|'v'|'z'|'*'|'('|')'|
                {LA(2)!=' '&&LA(2)!='\n'&&LA(2)!='\r'}? '.')+
  {$setType (LIT_PIC);}
 |('x' '\'') => 'x' '\''( ~('\''|'\n'|'\r'|'\t') )* '\''
  {$setType (LIT_HEXADECIMAL);}
 | LETRA (LETRA|DIGITO|'-'|'_')*
  {$setType (IDENT);}
 |((DIGITO)+ (LETRA|'-'|'_')) =>(DIGITO)+ (LETRA|'-'|'_')
(LETRA|DIGITO|'-'|'_')*
  {$setType (IDENT);}
 |((DIGITO)+ '/' )=> (DIGITO)+ '/' (DIGITO|'/')+
  {$setType (FECHA);}
 | (DIGITO)+ (',' (DIGITO)+)?
  {$setType (NUM);}
 | '_' (LETRA|DIGITO|'_')*
  {$setType (IDENT);}
 ;

CADENA :
 '\''!  ( ~('\''|'\n'|'\r'|'\t') )* '\''!
 | '"'! ( ~('"'|'\n'|'\r'|'\t') )* '"'!
 ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/206304dc/attachment-0001.html
From ewbank at gmail.com  Fri Mar  3 07:38:01 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar  3 07:38:04 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <200603031544.51220.brade@informatik.uni-muenchen.de>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<1141297423.5243.9.camel@localhost.localdomain>
	<200603031544.51220.brade@informatik.uni-muenchen.de>
Message-ID: <dd3a065f0603030738t5fad46ebo97b102f75ba762ec@mail.gmail.com>

Note that the alternative for v3 said "might get solved" - no
guarantee...  As a rift on stateful lexing, perhaps using two lexers
(ala java and javadoc) would allow easier partitioning of the
problem...

On 3/3/06, Michael Brade <brade@informatik.uni-muenchen.de> wrote:
> On Thursday 02 March 2006 12:03, Martin Probst wrote:
> > > is there a standard way or a best practice to implement grammars for
> > > languages that allow identifiers to be anything, including the keywords
> > > of the language itself?
> >
> > There are several ways, and all of them suck somehow.
> Thanks, they suck rocks indeed... I decided to wait for v3, predicates are the
> only solution right now but since the grammar is quite big with a lot of
> keywords it is not worthwile to do.
>
> Cheers,
> --
> Michael Brade;                 KDE Developer, Student of Computer Science
>   |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
>   ?--web: http://www.kde.org/people/michaelb.html
>
> KDE 4: Beyond Your Expectations
>
>
>
From mail at martin-probst.com  Fri Mar  3 07:52:35 2006
From: mail at martin-probst.com (Martin Probst)
Date: Fri Mar  3 07:52:59 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <dd3a065f0603030738t5fad46ebo97b102f75ba762ec@mail.gmail.com>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<1141297423.5243.9.camel@localhost.localdomain>
	<200603031544.51220.brade@informatik.uni-muenchen.de>
	<dd3a065f0603030738t5fad46ebo97b102f75ba762ec@mail.gmail.com>
Message-ID: <1141401155.4872.31.camel@localhost.localdomain>

> Note that the alternative for v3 said "might get solved" - no
> guarantee...  As a rift on stateful lexing, perhaps using two lexers
> (ala java and javadoc) would allow easier partitioning of the
> problem...

I don't really see the difference between multiple Lexers and States -
with both cases you have to do a { switchLexer(); } or
{ switchState(); } in the right places. I think that's pretty much the
same after all.

Martin

From christopher.d.schultz at comcast.net  Fri Mar  3 08:43:26 2006
From: christopher.d.schultz at comcast.net (Christopher Schultz)
Date: Fri Mar  3 08:43:34 2006
Subject: [antlr-interest] Help with circular reference in parser?
In-Reply-To: <01c801c63e99$3f401300$8cc79553@marlboro>
References: <44071615.50902@comcast.net>
	<01c801c63e99$3f401300$8cc79553@marlboro>
Message-ID: <4408722E.6050805@comcast.net>

Alexey,

Thanks for the response. I must admit that I'm not really in tune with
the Zen of these kinds of things. I built a very simply language
compiler in university and that was about all other than this project ;)

> It is well-known left recursion. Such kind of circular references not
> allowed in LL-parsers. So, you need to transform recursions to loops
> like
> 
> expr: primaryExpr ( arraySuffix | functionSuffix )* ;
> 
> primaryExpr: literal | identifier ;
> 
> arraySuffix: "[" expr "]" ;
> 
> functionSuffix: "(" expr ")" ;

Okay, I used to have the following parser rules:

expr: exp=relexpr ( ( AND^ relexpr) | (OR^ relexpr) )* (EOF!)?;

relexpr: exp=addexpr ( (EQUALS^ addexpr)
                     | (NOT_EQUALS^ addexpr)
                     | (GREATERTHAN^ addexpr)
                     | (LESSTHAN^ addexpr)
                     | (GREATERTHANEQUALTO^ addexpr)
                     | (LESSTHANEQUALTO^ addexpr)
                     )* ;

addexpr: exp=multexpr (( PLUS^ multexpr  | MINUS^ multexpr ))* ;

multexpr: exp=unaryExpr ( ( STAR^ unaryExpr ) | ( SLASH unaryExpr )
            | ( PERCENT unaryExpr ) )* ;

unaryExpr : ( (BANG^ atom ) | (MINUS^ atom ) | (PLUS!)? atom ) ;

atom:   functioncall | arrayref | identifier | number | string |
        LPAREN! expr !RPAREN ;

================

I have modified my 'atom' rule to be the following:

atom:   identifier ( functionsuffix | arraysuffix ) *
	| number | string |
        LPAREN! expr !RPAREN ;

The functionsuffix and arraysuffix branches then wrap the identifier and
appropriate extra information into the appropriate Expression subclass
that I have (I build my own tree, instead of letting ANTLR do it for me).

Everything seems to work properly (and all my old unit tests, which
included function call testing), but I get a bunch of lexical
nondeterminism warnings. Increasing 'k' seems to make things worse.

Given that things are working properly, do you think that it's safe to
ignore these warnings?

Thanks again,
-chris


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 250 bytes
Desc: OpenPGP digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/93f3cc6e/signature.bin
From christopher.d.schultz at comcast.net  Fri Mar  3 09:03:28 2006
From: christopher.d.schultz at comcast.net (Christopher Schultz)
Date: Fri Mar  3 09:03:34 2006
Subject: [antlr-interest] Help with circular reference in parser?
In-Reply-To: <4408722E.6050805@comcast.net>
References: <44071615.50902@comcast.net>	<01c801c63e99$3f401300$8cc79553@marlboro>
	<4408722E.6050805@comcast.net>
Message-ID: <440876E0.4030705@comcast.net>

Alexey,

> Everything seems to work properly (and all my old unit tests, which
> included function call testing), but I get a bunch of lexical
> nondeterminism warnings. Increasing 'k' seems to make things worse.

Oh, wait. After trashing my grammar with various attempted
modifications, I cleaned it all up (removing trivial parser rules, etc.)
and now I'm totally good to go.

No non-determinism warnings, and all tests pass!

Thanks so much for the help, Alexey!

-chris


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 250 bytes
Desc: OpenPGP digital signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/5000bb74/signature.bin
From parrt at cs.usfca.edu  Fri Mar  3 09:27:43 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Mar  3 09:27:48 2006
Subject: [antlr-interest] related master's thesis ideas...
In-Reply-To: <200603022121.20865.kibab@icehouse.net>
References: <200603022121.20865.kibab@icehouse.net>
Message-ID: <AFD10F4A-4F75-49AF-901F-D5D0C2AAA9CA@cs.usfca.edu>

On Mar 2, 2006, at 9:21 PM, Kaleb Pederson wrote:
> 1) Incremental parsing (specifically for not re-parsing an entire  
> file, for
> example within an IDE).  This could be interesting, both in theory  
> and to try
> to make Antlr support this.

Prashant  and I are going to be  publishing a paper on this soon so I  
would work on something else. ;)

> 2) Create a static code analysis tool, probably to handle C/C++  
> code although
> if I used the right IR trees, it could probably easily be expanded  
> to other
> languages fairly easily.  This would probably also present the  
> ability to
> create a mini-language of sorts, something that would allow you to  
> create
> specific test cases that the programmer was interested in, with a  
> certain
> standard set of featurs.
>
> 3) Something with Antlr-v3 and probably/hopefully Python ;),  
> perhaps wrapping
> the C/C++ generated code so that it can be used as an extension  
> module,
> assuming they were considerably faster than the regular Python one  
> (only real
> reason to do such)?

Perhaps evaluating rewrite systems for v3 like

"int <ID> = <expr>;" -> "int <ID>;\n<ID> = <expr>;"

> PS: Ter, I hope your dvorak skills are coming along.  I switched to  
> dvorak
> about two and a half years ago (maybe three now) and I'm probably  
> 20-40%
> faster than I was back then, and I was quite capable then.  It's  
> definitely
> worth it (although the efficiency takes a while to pick back up)!   
> Keep at it
> and good luck!

  thanks for the encouragement.  I memorized the keyboard and one  
point five hours but am having difficulty getting my efficiency up.  
Are you able to use emacs with the new keyboard too?

Ter
From kibab at icehouse.net  Fri Mar  3 17:48:25 2006
From: kibab at icehouse.net (Kaleb Pederson)
Date: Fri Mar  3 17:48:38 2006
Subject: [antlr-interest] related master's thesis ideas...
In-Reply-To: <AFD10F4A-4F75-49AF-901F-D5D0C2AAA9CA@cs.usfca.edu>
References: <200603022121.20865.kibab@icehouse.net>
	<AFD10F4A-4F75-49AF-901F-D5D0C2AAA9CA@cs.usfca.edu>
Message-ID: <200603031748.35703.kibab@icehouse.net>

On Friday 03 March 2006 9:27 am, Terence Parr wrote:
> Prashant  and I are going to be  publishing a paper on this soon so I
> would work on something else. ;)

I must not have been born soon enough ;)

> > 3) Something with Antlr-v3 and probably/hopefully Python ;),
> > perhaps wrapping
> > the C/C++ generated code so that it can be used as an extension
> > module,
> > assuming they were considerably faster than the regular Python one
> > (only real
> > reason to do such)?
>
> Perhaps evaluating rewrite systems for v3 like
>
> "int <ID> = <expr>;" -> "int <ID>;\n<ID> = <expr>;"

I haven't played with v3 yet (ok, well I have within the bounds of 
AntlrWorks :).  Weren't you going to be generating ASTs of some sort that 
would then be fed into different StringTemplate's, in which case the 
transformation would be written there, or as this inline with the grammar or 
something such?  Sounds interesting and useful :)

>   thanks for the encouragement.  I memorized the keyboard and one
> point five hours but am having difficulty getting my efficiency up.
> Are you able to use emacs with the new keyboard too?

Able, yes but I certainly don't when vim's available!! ;) I remember it being 
a pain at first, but after a while it's second nature.  Some of the 
combinations are awkword and some are better... but that's to be expected.

Thanks!

--Kaleb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/ae790433/attachment.bin
From mark.felzer at gmail.com  Fri Mar  3 19:16:31 2006
From: mark.felzer at gmail.com (Mark Felzer)
Date: Fri Mar  3 19:16:35 2006
Subject: [antlr-interest] getting the correct line # from an exception
Message-ID: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>

Dear Friends,

When my grammar contains an illegal token an exception is properly thrown
The exceptions message seems to always indicate the line # as being "1"
which is sorta useless when it comes to debugging,

My grammar indicates that "\n\r" should be skipped by the lexer, should I
increment something each time "\n\r" is encountered so that the exception
translates to the correct line?


Thank You Very Much,
Mark F.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/e8faa105/attachment.html
From vs667 at nyu.edu  Fri Mar  3 19:32:42 2006
From: vs667 at nyu.edu (Vladimir Sutskever)
Date: Fri Mar  3 19:33:29 2006
Subject: [antlr-interest] getting the correct line # from an exception
In-Reply-To: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>
References: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>
Message-ID: <44090A5A.9010400@nyu.edu>

Dear Mark,

You can add the additional newline() function into your lexer rule, that 
fixed it for me. Below is my grammar for white space.

//========================================================[WHITE SPACE]
WS   
    :    (SPACE
    |    '\t'
    |    '\n'
    |    '\r')
        {
            $setType(Token.SKIP);
            newline();
        }
    ;

Hope This Helps
Vladimir Sutskever

Mark Felzer wrote:
> Dear Friends,
>
> When my grammar contains an illegal token an exception is properly thrown
> The exceptions message seems to always indicate the line # as being 
> "1" which is sorta useless when it comes to debugging,
>
> My grammar indicates that "\n\r" should be skipped by the lexer, 
> should I increment something each time "\n\r" is encountered so that 
> the exception translates to the correct line?
>
>
> Thank You Very Much,
> Mark F.
>
From vs667 at nyu.edu  Fri Mar  3 19:53:40 2006
From: vs667 at nyu.edu (Vladimir Sutskever)
Date: Fri Mar  3 19:53:41 2006
Subject: [antlr-interest] getting the correct line # from an exception
In-Reply-To: <44090A5A.9010400@nyu.edu>
References: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>
	<44090A5A.9010400@nyu.edu>
Message-ID: <44090F44.8050809@nyu.edu>

Dear Mark,

Actually my last suggestion had an error. It would incremented line 
count on detecting a SPACE in addition to the newline, (which is not 
what you want I think).

I think this should work:

*SPACE*
    :    ' '
        {
           
            $setType(Token.SKIP);
        }
    ;

*NEWLINE*
    :    '\t'
    |    '\n'
    |    '\r'
        {
            $setType(Token.SKIP);
            newline();
        }
    ;   
  
Hope This Helps


Vladimir Sutskever wrote:
> Dear Mark,
>
> You can add the additional newline() function into your lexer rule, 
> that fixed it for me. Below is my grammar for white space.
>
> //========================================================[WHITE SPACE]
> WS      :    (SPACE
>    |    '\t'
>    |    '\n'
>    |    '\r')
>        {
>            $setType(Token.SKIP);
>            newline();
>        }
>    ;
>
> Hope This Helps
> Vladimir Sutskever
>
> Mark Felzer wrote:
>> Dear Friends,
>>
>> When my grammar contains an illegal token an exception is properly 
>> thrown
>> The exceptions message seems to always indicate the line # as being 
>> "1" which is sorta useless when it comes to debugging,
>>
>> My grammar indicates that "\n\r" should be skipped by the lexer, 
>> should I increment something each time "\n\r" is encountered so that 
>> the exception translates to the correct line?
>>
>>
>> Thank You Very Much,
>> Mark F.
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/30950769/attachment.html
From ewbank at gmail.com  Fri Mar  3 20:32:49 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar  3 20:32:51 2006
Subject: [antlr-interest] getting the correct line # from an exception
In-Reply-To: <44090F44.8050809@nyu.edu>
References: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>
	<44090A5A.9010400@nyu.edu> <44090F44.8050809@nyu.edu>
Message-ID: <dd3a065f0603032032q44440487xa16aeaa89d4cfe12@mail.gmail.com>

In addition to the notes from Vladimir...

Make sure to count newlines in comments, and at the end of comments,
as well as those that are "visible" as whitespace.  If you are using
the C preprocessor, also make sure you track #line directives.

Mark Felzer wrote:
> When my grammar contains an illegal token an exception is properly thrown
> The exceptions message seems to always indicate the line # as being "1"
> which is sorta useless when it comes to debugging,
From ewbank at gmail.com  Fri Mar  3 20:37:59 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar  3 20:38:00 2006
Subject: [antlr-interest] Reloading from previous parse?
Message-ID: <dd3a065f0603032037j45ceeeaha5eaface91f4b65c@mail.gmail.com>

To spin this in a different direction... I'm working on an interpreted
and optimized language, so need to be able to "dump" the results of a
parse for later reuse and integration with other components that were
similarly "dumped".

Has anyone worked on, or have pointers to, technology for AST
persistence?  I'm mainly curious about preserving/recovering symbol
table information and file/line information from the original parse -
the AST itself seems straightforward (by comparison :-)

Thank you,
- Bryan

Ter said:
> Kaleb said:
> > 1) Incremental parsing (specifically for not re-parsing an entire file, for
> > example within an IDE).  This could be interesting, both in theory and to
> > try to make Antlr support this.
>
> Prashant  and I are going to be  publishing a paper on this soon so I would
> work on something else. ;)
From fawzyj at yahoo.com  Fri Mar  3 22:15:53 2006
From: fawzyj at yahoo.com (Joe Fouad)
Date: Fri Mar  3 22:15:55 2006
Subject: [antlr-interest] tree construction question
Message-ID: <20060304061553.27584.qmail@web31813.mail.mud.yahoo.com>

hi all
this is the first time to send to this listas i am relatively a new anltr user
ok to the question
i wanna be able to parse something like 
int i,j,k;
String  a,b,c;
and produce a tree representation as a result
i am using antlr2.7.5
so i wrote the following grammer(i call variables attributes)
attributes !:
 ( t:(! type { #t = #([TYPE, "type"] , type);} ) n:IDENT   { #([ATTR,"attribute"] ,t ,n) ;} (COMMA! m:IDENT  { 
  #([ATTR,"attribute"] ,t, m) ;} )* SEMI! )*
 { #attributes = #([ATTRS,"attributes"],#attributes) ;}
;
actually antlr does its job nicely and translated without error but the javac compiler complain 
i thought that my rules is not good enough so i refactored it  to 2 rules
attributes!:
 (t:(! type) var_list[#t] SEMI!)*
 {#attributes=#([ATTRS,"attributes"],#attributes);}
;
var_list![AST type_node]:
 (name:IDENT {#([ATTR,"attribute"],type_node,name,n);})+
;
it produces the same error which is
[antlr] ANTLR Parser Generator   Version 2.7.5   1989-2005 jGuru.com
   
  compile:
    [javac] Compiling 26 source files to D:\Documents and Settings\Administrator\IdeaProjects\EAG\lang\classes
    [javac] D:\Documents and 
  Settings\Administrator\IdeaProjects\EAG\lang\src\com\corp\lang\recogniser\LangParser.java:814: not a statement
    [javac]      (AST)astFactory.make( (new 
  ASTArray(4)).add(astFactory.create(ATTR,"attribute")).add(type_node).add(name_AST).add(n_AST));
    [javac]                                         ^
    [javac] D:\Documents and 
  Settings\Administrator\IdeaProjects\EAG\lang\src\com\corp\lang\recogniser\LangTreeWalker.java:36: ')' expected
    [javac]      definition(_t,LanguageLinker linker);
    [javac]                                                                      ^
    [javac] 2 errors
the compiler error is very generic and i cannot distinguish what's wrong
so please someone tell me what is wrong, actually i am following the manual and the examples
thanx in advance
by the way i read that version 2.7.6 fixed a bug related to tree construction ,is there any relation?
and if that version fix it,please send me the jar as the build instructions state that i have to have cygwin(or unix like) env
thanx to all of u
joe 

		
---------------------------------
 Yahoo! Mail
 Use Photomail to share photos without annoying attachments.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060303/44a814f5/attachment.html
From brade at informatik.uni-muenchen.de  Sat Mar  4 03:35:39 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Sat Mar  4 03:34:51 2006
Subject: [antlr-interest] getting the correct line # from an exception
In-Reply-To: <44090F44.8050809@nyu.edu>
References: <b6a7b26c0603031916r580a088fu6e5c82d183a6b271@mail.gmail.com>
	<44090A5A.9010400@nyu.edu> <44090F44.8050809@nyu.edu>
Message-ID: <200603041235.42085.brade@informatik.uni-muenchen.de>

Hi,

On Saturday 04 March 2006 04:53, Vladimir Sutskever wrote:
> I think this should work:
> [...]
> *NEWLINE*
>     :    '\t'
>     |    '\n'
>     |    '\r'
>         {
>             $setType(Token.SKIP);
>             newline();
>         }
>     ;
No, it most probably won't... You don't want to increment the line number on a 
tab (\t). And the action you put at the end is only called for \r because the 
parentheses are missing. Here's what I'm using:

protected
EOL : ( options { generateAmbigWarnings = false; }
    : "\r\n" 
    | '\r'
    | '\n' ) { newline(); } ;

I have no Token.SKIP in there because I use this protected rule in two other 
rules that already set the Token.SKIP type.

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060304/7fff49e0/attachment-0001.bin
From aldana at gmx.de  Sun Mar  5 05:47:48 2006
From: aldana at gmx.de (manuel aldana)
Date: Sun Mar  5 05:47:51 2006
Subject: [antlr-interest] token nondeterminism problem
Message-ID: <440AEC04.3020307@gmx.de>

hey,

i've got a very simple problem, never the less i could not figure out 
(google, maillist, manuals etc.) how to overcome it.

I get this annoying nondeterminism message through this keywords vs. 
identifier problem. I read, that the solution lies in defining tokens{ 
xx } and setting testLiterals=true; to the IDENTIFIER part.

But how is it possible to put lexing-rules to the tokens definition? e.g.:
-------------------------------
class MyLexer extends Lexer;
tokens{
   BLA;		
}

BLA='x'|'y';

ID options{testLiterals:true}: ('a'..'z')+;
------------------------------------------

I know compiler is raising error this way. Setting BLA 'protected' would 
compile and avoid nondeterminism warnings but I would like to have rules 
in the tokens definition. is that possible?

thanks a lot!


-- 
  manuel aldana
  aldana@gmx.de
  aldana@cs.tu-berlin.de
From sebastian.baltes at gmx.net  Sun Mar  5 05:53:16 2006
From: sebastian.baltes at gmx.net (Sebastian Baltes)
Date: Sun Mar  5 05:53:19 2006
Subject: [antlr-interest] Lexer inheritance problem: nextToken ignores super
	implementation
Message-ID: <17534.1141566796@www060.gmx.net>

Hello Antlers,

as a newbie I have a problem with inheritance of lexers and would ask for
some help from the experts. :-)

I have a lexer InCoTempAbstractLexer that parses a litte if - else grammar.
This works well. Then I tries to make a second lexer InCoTempLineLexer that
should use the same gramar and just extends it with a new token, but this
lexer does not recognize anything. As far as I understand the problem lies
within the nextToken method. The generated java class InCoTempLineLexer
extends InCoTempAbstractLexer, but the generated nextToken method does not
implement or call any logic of the parents implementation.

Is this a bug in my grammar or in ANTLR? I use eclipse ANTLR studio.

Best Regards and thank for any help

Sebastian Baltes

---- file incotemp/incotempAbstractLexer.g

header {
  package incotemp;
}

class InCoTempAbstractLexer extends Lexer;

options {
  k=2;
  exportVocab = InCoTempBase;
}  

tokens {
  IF               = "if";
  ELSE             = "else";
  END              = "end";
}

IDENT options { testLiterals = true;}
  : ('a'..'z'|'A'..'Z'|'0'..'9'|'_')+
  ;

WHITESPACE : ( ' ' | '\t' ) {$setType(Token.SKIP);} ;

---- file incotemp/incotempLineLexer.g

header {
  package incotemp;
}

class InCoTempLineLexer extends Lexer("incotemp.InCoTempAbstractLexer");

options {
  importVocab = InCoTempBase;
}


protected
NEWLINE :  ('\n' | '\r' ('\n')?)  {$setType(Token.SKIP); newline();
GlobalLexers.getInstance().pop(); } ;


---- incotemp/InCoTempAbstractLexer.java


public class InCoTempAbstractLexer extends
antlr.antlrStudio.ASDebugCharScanner implements InCoTempBaseTokenTypes,
TokenStream
{

...

public InCoTempAbstractLexer(LexerSharedInputState state) {
  super(state);
  caseSensitiveLiterals = true;
  setCaseSensitive(true);
  literals = new Hashtable();
  literals.put(new ANTLRHashString("else", this), new Integer(13));
  literals.put(new ANTLRHashString("if", this), new Integer(12));
  literals.put(new ANTLRHashString("end", this), new Integer(14));
}

public Token nextToken() throws TokenStreamException {
  Token theRetToken=null;
tryAgain:
  for (;;) {
    Token _token = null;
    int _ttype = Token.INVALID_TYPE;
    resetText();
    try {   // for char stream error handling
      try {   // for lexical error handling
        switch ( LA(1)) {
        case '0':  case '1':  case '2':  case '3':
        case '4':  case '5':  case '6':  case '7':
        case '8':  case '9':  case 'A':  case 'B':
        
        ....
        
      }
      catch (RecognitionException e) {
        throw new TokenStreamRecognitionException(e);
      }
    }
    catch (CharStreamException cse) {
      if ( cse instanceof CharStreamIOException ) {
        throw new TokenStreamIOException(((CharStreamIOException)cse).io);
      }
      else {
        throw new TokenStreamException(cse.getMessage());
      }
    }
  }
}

---- incotemp/InCoTempLineLexer.java

public class InCoTempLineLexer extends incotemp.InCoTempAbstractLexer
implements InCoTempLineLexerTokenTypes, TokenStream
{

public InCoTempLineLexer(LexerSharedInputState state) {
  super(state);
  caseSensitiveLiterals = true;
  setCaseSensitive(true);
  literals = new Hashtable();
  literals = new Hashtable();
  literals.put(new ANTLRHashString("else", this), new Integer(13));
  literals.put(new ANTLRHashString("if", this), new Integer(12));
  literals.put(new ANTLRHashString("end", this), new Integer(14));
}

public Token nextToken() throws TokenStreamException {
  try {uponEOF();}
  catch(CharStreamIOException csioe) {
    throw new TokenStreamIOException(csioe.io);
  }
  catch(CharStreamException cse) {
    throw new TokenStreamException(cse.getMessage());
  }
  return new CommonToken(Token.EOF_TYPE, "");
}
From dieter_frej at gmx.net  Sun Mar  5 07:44:10 2006
From: dieter_frej at gmx.net (Dieter Frej)
Date: Sun Mar  5 07:44:22 2006
Subject: [antlr-interest] v3: using literals
Message-ID: <440B074A.1060101@gmx.net>

Hi,

since antlrworks is a nice program I started using it (in my case it 
does not matter whether I use antlr v2 or v3).

I have something pretty easy such as

typeSpec
	:
	(classOrInterfaceType | primitiveType)
	;
	
primitiveType
	:	//
	|	'boolean'
	|	'byte'
	|	'char'
	|	'short'
	|	'int'
	|	'float'
	|	'long'
	|	'double'
	;

classOrInterfaceType
	:	//
		IDENT
	;

IDENT
	:	('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
	;

I am getting a

[16:32:58] test.g:47:9: Decision can match input such as "IDENT" using
multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input

which I completly understand. The problem is that I do not know how to
use and test for literals in antlr v3. I did put

grammar test;
options {
	output = AST;
}
tokens {
	LITERAL_boolean='boolean';
	LITERAL_byte='byte';
	LITERAL_char='char';
	LITERAL_short='short';
	LITERAL_int='int';
	LITERAL_float='float';
	LITERAL_long='long';
	LITERAL_double='double';
}

in my grammar, but when I put testLiterals=true under options, it keeps
complaining. I searched for it on the web page, but nothing :-/ Not even
in the java example grammar that is on the v3 page.

Any hints/suggestions how I could do that in v3? Or is v3 not yet ready
for that?
If so: is there any other nice visual development tool for antlr v2?

Didi
From brade at informatik.uni-muenchen.de  Sun Mar  5 07:48:33 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Sun Mar  5 07:47:39 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <1141401155.4872.31.camel@localhost.localdomain>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<dd3a065f0603030738t5fad46ebo97b102f75ba762ec@mail.gmail.com>
	<1141401155.4872.31.camel@localhost.localdomain>
Message-ID: <200603051648.36254.brade@informatik.uni-muenchen.de>

On Friday 03 March 2006 16:52, Martin Probst wrote:
> > As a rift on stateful lexing, perhaps using two lexers 
> > (ala java and javadoc) would allow easier partitioning of the
> > problem...
>
> I don't really see the difference between multiple Lexers and States -
> with both cases you have to do a { switchLexer(); } or
> { switchState(); } in the right places. I think that's pretty much the
> same after all.
Ok, this lead me to an idea that would theoretically work and that is easy and 
beautiful. When you said to put the complexity into the lexer I pretty much 
gave up on that idea, I would have to replicate the parser in the lexer.

But this would be all I need:

identifier { lexer.testLiterals = false; } 
    : NCNAME 
     { lexer.testLiterals = true; }  // should be an "exit-action"
    ;

An init-action that switches off literals, then match NCNAME, then an 
exit-action that switches literals back on.

The problem is now that the init-action is not adhered to in rules where 
identifier is used with other alternatives, there the code immediately tests 
'if (LA(1)==NCNAME)' :-(

Furthermore, there is no such thing as an exit-action AFAIK.

Does anyone have an idea of how to do the above in ANTLR? Not possible...?

Thanks,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060305/8eaafca6/attachment.bin
From brade at informatik.uni-muenchen.de  Sun Mar  5 08:09:20 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Sun Mar  5 08:08:30 2006
Subject: [antlr-interest] token nondeterminism problem
In-Reply-To: <440AEC04.3020307@gmx.de>
References: <440AEC04.3020307@gmx.de>
Message-ID: <200603051709.24457.brade@informatik.uni-muenchen.de>

On Sunday 05 March 2006 14:47, manuel aldana wrote:
> But how is it possible to put lexing-rules to the tokens definition? e.g.:
> -------------------------------
> class MyLexer extends Lexer;
> tokens{
>    BLA;
use this instead:
      BLAX="x";
     BLAY="y";
or choose different token names.
> }
>
> BLA='x'|'y';
and then delete this rule.

> ID options{testLiterals:true}: ('a'..'z')+;
> ------------------------------------------

> I know compiler is raising error this way. Setting BLA 'protected' would
> compile and avoid nondeterminism warnings but I would like to have rules
> in the tokens definition. is that possible?
No.

Hope this helps,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060305/cff2ab62/attachment.bin
From parrt at cs.usfca.edu  Sun Mar  5 09:42:32 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar  5 09:42:35 2006
Subject: [antlr-interest] v3: using literals
In-Reply-To: <440B074A.1060101@gmx.net>
References: <440B074A.1060101@gmx.net>
Message-ID: <AEAFAB5F-45DE-45E0-8069-F3A421C770EA@cs.usfca.edu>

Hi. The grammar you have is fine minus the ambiguity.  You don't need  
to do that testLiterals stuff with v3.  It just works.

Ter

On Mar 5, 2006, at 7:44 AM, Dieter Frej wrote:

> Hi,
>
> since antlrworks is a nice program I started using it (in my case  
> it does not matter whether I use antlr v2 or v3).
>
> I have something pretty easy such as
>
> typeSpec
> 	:
> 	(classOrInterfaceType | primitiveType)
> 	;
> 	
> primitiveType
> 	:	//
> 	|	'boolean'
> 	|	'byte'
> 	|	'char'
> 	|	'short'
> 	|	'int'
> 	|	'float'
> 	|	'long'
> 	|	'double'
> 	;
>
> classOrInterfaceType
> 	:	//
> 		IDENT
> 	;
>
> IDENT
> 	:	('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
> 	;
>
> I am getting a
>
> [16:32:58] test.g:47:9: Decision can match input such as "IDENT" using
> multiple alternatives: 1, 2
> As a result, alternative(s) 2 were disabled for that input
>
> which I completly understand. The problem is that I do not know how to
> use and test for literals in antlr v3. I did put
>
> grammar test;
> options {
> 	output = AST;
> }
> tokens {
> 	LITERAL_boolean='boolean';
> 	LITERAL_byte='byte';
> 	LITERAL_char='char';
> 	LITERAL_short='short';
> 	LITERAL_int='int';
> 	LITERAL_float='float';
> 	LITERAL_long='long';
> 	LITERAL_double='double';
> }
>
> in my grammar, but when I put testLiterals=true under options, it  
> keeps
> complaining. I searched for it on the web page, but nothing :-/ Not  
> even
> in the java example grammar that is on the v3 page.
>
> Any hints/suggestions how I could do that in v3? Or is v3 not yet  
> ready
> for that?
> If so: is there any other nice visual development tool for antlr v2?
>
> Didi

From sebastian.baltes at gmx.net  Sun Mar  5 15:24:02 2006
From: sebastian.baltes at gmx.net (Sebastian Baltes)
Date: Sun Mar  5 15:24:06 2006
Subject: =?ISO-8859-1?Q?Re:_[antlr-interest]_Lexer_inheritance_problem:_nextToken_?=
	=?ISO-8859-1?Q?ignores_super=09implementation?=
References: <17534.1141566796@www060.gmx.net>
Message-ID: <11982.1141601042@www049.gmx.net>

Sorry for my question, I should have read the ANTLR Studio FAQ first. It
seems to be a bug / a missing feature in the eclipse plugin ANTLR Studio:

----
Q. How do I use grammar inehritance inside ANTLR Studio?
Although Grammar inheritance is not supported for this release of ANTLR
Studio,
you can use a build script to compile your grammar files.
Make sure that you dont enable ANTLR Studio on the project otherwise the
code will
be generated automatically without taking grammar inheritance into
consideration. 
----

ANTLR Studio does not report any warnings about the use of grammar
inheritance. But more important: ANTLR Studio seems to use its own code
generation (IMHO a big drawback).

Cheers,
Sebastian
From dieter_frej at gmx.net  Mon Mar  6 00:24:22 2006
From: dieter_frej at gmx.net (Dieter Frej)
Date: Mon Mar  6 00:24:27 2006
Subject: [antlr-interest] error report to help improving antlrwork
Message-ID: <440BF1B6.1080801@gmx.net>

Hi everone and especially Jean and Ter as antlrworks developers,

the more I use antlrworks, the more I like it. Since it is a early
access version I know that it still might ;) contain some errors. Once
in a while I discover a e.g. NullPointerException from a - from my point
of view - correct grammar. Is there anyway to report these kind of
errors? How is that done: via email or a bug reporting system?

- Didi
From jose.ventura.roda at gmail.com  Mon Mar  6 00:50:35 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Mon Mar  6 00:50:43 2006
Subject: [antlr-interest] Relational operator in COBOL
In-Reply-To: <dd3a065f0603030731n2193e0b3r16423e2e2053f068@mail.gmail.com>
References: <e39abda10603030651wc276fcey@mail.gmail.com>
	<dd3a065f0603030731n2193e0b3r16423e2e2053f068@mail.gmail.com>
Message-ID: <e39abda10603060050r457d59d1w@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
/*header 
{
	package cobol;
}
	*/
class CobolLex extends Lexer;
options 
{ 
	k=2;
	charVocabulary = '\3'..'\377'; // Unicodes usuales
	caseSensitive=false;
	caseSensitiveLiterals=false;
	testLiterals=false;
	exportVocab=CobolLexVocab;

} 
tokens										// MUST be kept in sync with "keywordsTable" Hashtable below!!
{
	FIN_TODO;
	NUM;
    IDENT;
	LIT_HEXADECIMAL;
	LIT_PIC;
	LIT_COPY;
	FECHA;
	IGUAL;
    
    IDENTIFICATION="IDENTIFICATION";
	ID="ID";
	ENVIRONMENT="ENVIRONMENT";
	DATA="DATA";
	WORKING="WORKING-STORAGE";
	LINKAGE="LINKAGE";
	DIVISION="DIVISION";
	PROGRAM_ID="PROGRAM-ID";
	PROCEDURE="PROCEDURE";
	SECTION="SECTION";

	ACCEPT="ACCEPT";
	ADD="ADD";
	ALL="ALL";
	ALSO="ALSO";
	ALTER="ALTER";
	AND="AND";
	AT="AT";
	BLANK="BLANK";
	BY="BY";
	CALL="CALL";
	CANCEL="CANCEL";
	CICS="CICS";
	CLOSE="CLOSE";
	COMPUTE="COMPUTE";
	COMMAREA="COMMAREA";
	COMMIT="COMMIT";
	CONTINUE="CONTINUE";
	CORR="CORR";
	CORRESPONDING="CORRESPONDING";
	DELETE="DELETE";
	DELIMITED="DELIMITED";
	DISPLAY="DISPLAY";
	DIVIDE="DIVIDE";
	ELSE="ELSE";
	END="END";
	END_ADD="END-ADD";
	END_CALL="END-CALL";
	END_COMPUTE="END-COMPUTE";
	END_DIVIDE="END-DIVIDE";
	END_EVALUATE="END-EVALUATE";
	END_EXEC="END-EXEC";
	END_IF="END-IF";
	END_MULTIPLY="END-MULTIPLY";
	END_PERFORM="END-PERFORM";
	END_SEARCH="END-SEARCH";
	END_STRING="END-STRING";
	END_UNSTRING="END-UNSTRING";
	END_SUBTRACT="END-SUBTRACT";
	ENTRY="ENTRY";
	EVALUATE="EVALUATE";
	EXEC="EXEC";
	EXIT="EXIT";
	METHOD="METHOD";
	PROGRAM="PROGRAM";
	GOBACK="GOBACK";
	GO_TO="GO TO";
	IF="IF";
	IN="IN";
	INITIALIZE="INITIALIZE";
	INSPECT="INSPECT";
	INTO="INTO";
	INVOKE="INVOKE";
	LINK="LINK";
	MERGE="MERGE";
	MOVE="MOVE";
	MULTIPLY="MULTIPLY";
	OF="OF";
	OPEN="OPEN";
	OR="OR";
	OTHER="OTHER";
	PERFORM="PERFORM";
	POINTER="POINTER";
	READ="READ";
	RECEIVE="RECEIVE";
	REDEFINES="REDEFINES";
	RELEASE="RELEASE";
	REPLACING="REPLACING";
	TALLYING="TALLYING";
	RETURN="RETURN";
	REWRITE="REWRITE";
	ROLLBACK="ROLLBACK";
	SEARCH="SEARCH";
	SEND="SEND";
	SET="SET";
	SQL="SQL";
	SORT="SORT";
	SPACE="SPACE";
	SPACES="SPACES";
	START="START";
	STOP="STOP";
	STRING="STRING";
	SUBTRACT="SUBTRACT";
	SYNCPOINT="SYNCPOINT";
	TO="TO";
	THEN="THEN";
	UNSTRING="UNSTRING";
	WRITE="WRITE";
	ZERO="ZERO";
	ZEROS="ZEROS";
	ZEROES="ZEROES";
	THROUGH="THROUGH";
	THRU="THRU";
	VARYING="VARYING";
	UNTIL="UNTIL";
	USING="USING";
	WHEN="WHEN";
	WITH="WITH";
	TEST="TEST";
	BEFORE="BEFORE";
	AFTER="AFTER";
	JUSTIFIED="JUSTIFIED";
	JUST="JUST";
	OCCURS="OCCURS";
	ASCENDING="ASCENDING";
	DESCENDING="DESCENDING";
	KEY="KEY";
	IS="IS";
	INDEXED="INDEXED";
	PIC="PIC";
	PICTURE="PICTURE";
	USAGE="USAGE";
	VALUE="VALUE";
	VALUES="VALUES";
	ARE="ARE";
	RENAMES="RENAMES";
	COPY="COPY";
	BINARY="BINARY";
	COMP="COMP";
	COMP1="COMP-1";
	COMP2="COMP-2";
	COMP3="COMP-3";
	COMP4="COMP-4";
	COMPUTATIONAL="COMPUTATIONAL";
	COMPUTATIONAL1="COMPUTATIONAL-1";
	COMPUTATIONAL2="COMPUTATIONAL-2";
	COMPUTATIONAL3="COMPUTATIONAL-3";
	COMPUTATIONAL4="COMPUTATIONAL-4";
	DISPLAY1="DISPLAY-1";
	INDEX="INDEX";
	PACKED_DECIMAL="PACKED-DECIMAL";
	CHARACTERS="CHARACTERS";
	LEADING="LEADING";
	FIRST="FIRST";
	INITIAL="INITIAL";
	CONVERTING="CONVERTING";
	FOR="FOR";
	UP="UP";
	DOWN="DOWN";
	NOT="NOT";
	NULL="NULL";
	ON="ON";
	SIZE="SIZE";
	ERROR="ERROR";
	THAN="THAN";
	GREATER="GREATER";
	LESS="LESS";
	EQUAL="EQUAL";
	NUMERIC="NUMERIC";
	ALPHABETIC="ALPHABETIC";
	POSITIVE="POSITIVE";
	NEGATIVE="NEGATIVE";
	FROM="FROM";
	

}

{ // Comienza la zona de c?digo nativo

boolean ultPic=false;
boolean enExec=false;
protected Token makeToken(int type)
{
	// Usamos la implementaci?n de la superclase...
	Token result = null;

	
// while I don't have a parser for CICS and SQL.

	if (enExec)
	{
		if (type==END_EXEC||
			type==RETURN ||
			type==RECEIVE ||
			type==SEND   ||
			type==SYNCPOINT ||
			type==LINK
			)
		{
			enExec=false;
			result = super.makeToken(type);
		}
		else
		{
			result = super.makeToken(IDENT);
		}
	}
	else
	{
		result = super.makeToken(type);
		if (type==SQL||type==CICS)
		{
			enExec = true;
		}
	}


	ultPic =(type==PIC||type==PICTURE);
	// ... a?adimos informaci?n del nombre de fichero
	result.setFilename(super.getFilename());
	// ... y devolvemos el token
	return (result);
}

}
COMENTARIO:
	'@' ( ~('\n'|'\r') )* 
	{$setType(Token.SKIP);}
	;

PAR_AB
	: {!ultPic }? '('
	;
PAR_CE
	: {!ultPic }? ')'
	;
CAD_COPY
	: ("==") => "==" ( ~('=') )*	"=="
	{ $setType(LIT_COPY); }
	| '='
	{ $setType(IGUAL); }
	;
DOSPUNTOS
	: ':'
	;

MAS
	: {!ultPic }? 
	  '+' {_ttype = MAS;}
	  (
	  		(DIGITO)+ (',' (DIGITO)+)? 
			{_ttype = NUM;}
	   )?
	;
	
MENOS
	: {!ultPic }?
	  '-' {_ttype = MENOS;}
	  (
	  		(DIGITO)+ (',' (DIGITO)+)? 
			{_ttype = NUM;}
	   )?
	;
	
PUNTO
	: {!ultPic }?
	  '.' {_ttype = FIN_TODO;}
	  (
	  	(DIGITO)+ {_ttype=NUM;}
	   )?
	 ;

COMA
	: {!ultPic }?
	  ',' 
	  (
	  	(DIGITO)+ {_ttype=NUM;}
	   )?
	 ;
POR
	: {!ultPic }? '*'
	;

DIVIDE
	: '/'
	;

MAYOR: '>';
MENOR: '<';
MAYOR_IGUAL: ">=";
MENOR_IGUAL: "<=";

protected
LETRA
	: 'a'..'z'
	;

protected
DIGITO
	: '0'..'9'
	;


protected 
NL :
		(
		 ("\r\n") => "\r\n" // MS-DOS
		 | '\r' // MACINTOSH
		 | '\n' // UNIX
		 )
		 {newline(); }
		 ;

BLANCO :
		( ' '
		| '\t'
		| NL
		) 
		{ $setType(Token.SKIP); } // La acci?n del blanco: ignorar
		;

IDENT_NUM  options {testLiterals=true;}
	:{ ultPic }? ('+'|'-'|'$'|'b'|','|'e'|('0'..'9')|'x'|'s'|'v'|'z'|'*'|'('|')'|
	               {LA(2)!=' '&&LA(2)!='\n'&&LA(2)!='\r'}? '.')+  
	 {$setType (LIT_PIC);}
	|('x' '\'') => 'x' '\''( ~('\''|'\n'|'\r'|'\t') )*	'\'' 
	 {$setType (LIT_HEXADECIMAL);}
	| LETRA (LETRA|DIGITO|'-'|'_')*
	 {$setType (IDENT);}
	|((DIGITO)+ (LETRA|'-'|'_')) =>(DIGITO)+ (LETRA|'-'|'_') (LETRA|DIGITO|'-'|'_')*
	 {$setType (IDENT);}
	|((DIGITO)+ '/' )=> (DIGITO)+ '/' (DIGITO|'/')+
	 {$setType (FECHA);}
	| (DIGITO)+ (',' (DIGITO)+)?
	 {$setType (NUM);}
	| '_' (LETRA|DIGITO|'_')*
	 {$setType (IDENT);}
	;

CADENA :
	'\''! 
	( ~('\''|'\n'|'\r'|'\t') )*
	'\''!
	| '"'! ( ~('"'|'\n'|'\r'|'\t') )* '"'!
	;




-------------- next part --------------
class condition extends Parser; // Se extiende Parser, y no Lexer
options {
	buildAST = true;
	importVocab = CobolLexVocab;
}

tokens
{
	CONDICION;
	FIELD;
	LIST;
}

setCondition
	: (condition FIN_TODO!)*
	{#setCondition = #( #[SET, "SET"] ,setCondition);}
	;


condition
	: conditionOR
	{#condition = #( #[CONDICION, "CONDICION"] ,#condition);}
	;
	
conditionOR
	: conditionAND (OR^ conditionAND)*
	;

conditionAND
	: expresionRelacional (AND^ expresionRelacional)*
	;
expresionRelacional
	: expresionSuma (operador_relacional expresionSuma)*
	;
	

	
expresionSuma
	: expresionPor ( (MAS^|MENOS^) expresionPor)*
	;

expresionPor
	: expresionUnitaria ( (POR^|DIVIDE^) expresionUnitaria)*
	;
	
expresionUnitaria
	: MENOS^ expresionUnitaria
	| MAS^ expresionUnitaria
	| expresionUnitariaNoMasMenos
	;
expresionUnitariaNoMasMenos
	: (IS)? NOT^ expresionUnitaria
	| expresionPrimaria
	;
	
expresionPrimaria
	: identifier
	| literal
	| POSITIVE
	| NEGATIVE
	| NUMERIC
	| ALPHABETIC
	| PAR_AB! condition PAR_CE!
	;

operador_relacional
	:(NOT)? 
	GREATER (THAN)? (OR EQUAL (TO)?)?
	|MAYOR_IGUAL
	|MAYOR
	|LESS (THAN)? (OR EQUAL (TO)?)?
	|MENOR_IGUAL
	|MENOR
	|EQUAL (TO)?
	|IGUAL
	;

	literal
	: NUM
	| CADENA
	| cero
	| SPACE
	| SPACES
	| LIT_HEXADECIMAL
	| NULL
	;
cero
	: ZERO
	| ZEROS
	| ZEROES
	;
	

identifier
	: in_of 
	 (modif_identifier)*
	{## = #( #[FIELD,"FIELD"] ,##);	}
	;

in_of 
	: IDENT ( (IN|OF ) IDENT )*
	;
	
modif_identifier 
	: (PAR_AB expresionSuma DOSPUNTOS) => PAR_AB expresionSuma DOSPUNTOS (expresionSuma)? PAR_CE
	| PAR_AB conditionList  PAR_CE
	;

conditionList
	: condition (COMA condition)*
	{#conditionList = #( #[LIST, "LIST"] ,conditionList);}
	;


-------------- next part --------------
A non-text attachment was scrubbed...
Name: mcon.java
Type: application/octet-stream
Size: 1268 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060306/8a0c8ba9/mcon.obj
-------------- next part --------------
@condition 1
ident1 > 1 .

@condition 2
ident1 = 1 or (ident2 GREATER 2). 

@condition 3
ident1 > 0 and ident1 < 50 .

@condition 4
ident1 NOT = 0 .

@condition 5, is like condition 3 
ident1 > 0 and < 50.

@condition 6
ident1 (1, hola, 3+5)(1:5) = "Test l".

From canfield at computer.org  Mon Mar  6 08:53:57 2006
From: canfield at computer.org (Bill Canfield)
Date: Mon Mar  6 08:57:42 2006
Subject: [antlr-interest] Re: Reloading from previous parse?
Message-ID: <440C6925.1070206@computer.org>

> Message: 6
> Date: Fri, 3 Mar 2006 23:37:59 -0500
> From: "Bryan Ewbank" <ewbank@gmail.com>
> Subject: [antlr-interest] Reloading from previous parse?
>
> Has anyone worked on, or have pointers to, technology for AST
> persistence?  I'm mainly curious about preserving/recovering symbol
> table information and file/line information from the original parse -
> the AST itself seems straightforward (by comparison  :-) 
> 

Bryan:

After getting really bad performance with the boost::serialization
library, I just switched to a strategy where I save the tokens from my
antlr Lexer, then have a TokenStream that feeds them to the parser when
I want to reload them.

The TokenStream that saves the tokens injects fake tokens when the
file/line number changes.  The TokenStream that reads them filters those
out and adjusts the location information accordingly.

By the way, I'm not knocking the boost stuff, I think it just turns out
that if you try to write out the contents of your ASTs, it's sort of an
uncompressed version of the text they were parsed from.  So you might as
well save the original text and reparse.

Another alternative that comes to mind is using mmap(), but I haven't
tried that myself.

Bill

From parrt at cs.usfca.edu  Mon Mar  6 11:34:27 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar  6 11:34:32 2006
Subject: [antlr-interest] error report to help improving antlrwork
In-Reply-To: <440BF1B6.1080801@gmx.net>
References: <440BF1B6.1080801@gmx.net>
Message-ID: <7581848A-6910-403A-9807-28AF83A9A297@cs.usfca.edu>

Hi.  we are about to release a new version ;)  You can email Jean  
directly or use the feedback link:

http://www.antlr.org/misc/feedback

Ter
On Mar 6, 2006, at 12:24 AM, Dieter Frej wrote:

> Hi everone and especially Jean and Ter as antlrworks developers,
>
> the more I use antlrworks, the more I like it. Since it is a early
> access version I know that it still might ;) contain some errors. Once
> in a while I discover a e.g. NullPointerException from a - from my  
> point
> of view - correct grammar. Is there anyway to report these kind of
> errors? How is that done: via email or a bug reporting system?
>
> - Didi

From enriquebris at cimex.com.cu  Mon Mar  6 12:36:14 2006
From: enriquebris at cimex.com.cu (enriquebris@cimex.com.cu)
Date: Mon Mar  6 11:34:45 2006
Subject: [antlr-interest] How Can I Get a part of file after parse it?
Message-ID: <7D750FF0E5E0984AB6FAA93D62E197F605FC62A3@email1.cimex.com.cu>

Hello

 

Suppose I'm working over the HTML example (it comes with ANTLR
distribution). It has a BODY described in grammar. So, how can I get
that BODY after parse the html file ?

 

Henry5a

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060306/6265858d/attachment-0001.html
From andrew.bell.ia at gmail.com  Mon Mar  6 16:34:55 2006
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon Mar  6 16:34:58 2006
Subject: [antlr-interest] Extracting match
Message-ID: <e80abd30603061634w3350c62bxa3dbe882606d1f5f@mail.gmail.com>

Hi,

I've got a grammar that looks something like:

rule1 : "foo" | "bar" | "baz"
   ;

rule2 : x  rule1  y rule1
  ;

I want to know in rule2 which of the strings "foo", "bar" or "baz"
were matched.  Can someone show me the preferred way to do this?

Thanks,

--
Andrew Bell
andrew.bell.ia@gmail.com
From prashant.deva at gmail.com  Mon Mar  6 16:59:21 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Mon Mar  6 16:59:24 2006
Subject: [antlr-interest] Re: [antlr-dev] How Can I Get a part of file after
	parse it?
In-Reply-To: <7D750FF0E5E0984AB6FAA93D62E197F605FC62A3@email1.cimex.com.cu>
References: <7D750FF0E5E0984AB6FAA93D62E197F605FC62A3@email1.cimex.com.cu>
Message-ID: <41fed8f80603061659o3cbd528ay3a413da4e86674e0@mail.gmail.com>

You need to either store it in an AST or just store it using an action,
while the body element is being parsed.

On 3/7/06, enriquebris@cimex.com.cu <enriquebris@cimex.com.cu> wrote:
>
>  Hello
>
>
>
> Suppose I'm working over the HTML example (it comes with ANTLR
> distribution). It has a BODY described in grammar. So, how can I get that
> BODY after parse the html file ?
>
>
>
> Henry5a
>
> _______________________________________________
> antlr-dev mailing list
> antlr-dev@antlr.org
> http://www.antlr.org/mailman/listinfo/antlr-dev
>
>
>


--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060307/0136ef7e/attachment.html
From demakov at ispras.ru  Tue Mar  7 00:40:02 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Tue Mar  7 00:40:09 2006
Subject: [antlr-interest] Extracting match
References: <e80abd30603061634w3350c62bxa3dbe882606d1f5f@mail.gmail.com>
Message-ID: <025301c641c2$ba3c4250$8cc79553@marlboro>

Hi Andrew,

Rules can return values:

rule1 returns [String text=null]
: 
  { text = LT(1).getText(); }
  ( "foo" | "bar" | "baz" ) 
;

rule2 
{
  String text1 = null;
  String text2 = null;
}
: x 
  text1=rule1  { if( text1.equals( "foo" ) ) System.out.println( "FOO" ); } 
  y 
  text2=rule1 { if( text1.equals( text2 ) ) System.out.println( "==" ); } 
;

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com



----- Original Message ----- 
From: "Andrew Bell" <andrew.bell.ia@gmail.com>
To: <antlr-interest@antlr.org>
Sent: Tuesday, March 07, 2006 3:34 AM
Subject: [antlr-interest] Extracting match


> Hi,
> 
> I've got a grammar that looks something like:
> 
> rule1 : "foo" | "bar" | "baz"
>   ;
> 
> rule2 : x  rule1  y rule1
>  ;
> 
> I want to know in rule2 which of the strings "foo", "bar" or "baz"
> were matched.  Can someone show me the preferred way to do this?
> 
> Thanks,
> 
> --
> Andrew Bell
> andrew.bell.ia@gmail.com


From rhill03 at eds.com  Tue Mar  7 02:09:03 2006
From: rhill03 at eds.com (Hill, Robert)
Date: Tue Mar  7 02:09:06 2006
Subject: [antlr-interest] V3 & C#
Message-ID: <2E909902FD3A03419E3A905908AE3DD401A98259@UKNSM201.emea.corp.eds.com>

Hi Guys, Ter,

	Im about to embark on a not unsubstantial language
transformation problem, and was wondering whether I should use 2.7.6 or
go for V3 with its nice features (and damn, antlr works look the dogs
danglies). However, I'd really prefer the codegen to be in .Net (c#) and
also im wondering how stable/bug free V3 is compared to 2.7.6?
I've checked out the V3 feature set and would really like to make the
jump but I don't want to get half way through my project and discover a
show stopper of a problem, which I wouldn't have encountered with 2.7.6.

How far off is the C# output? Kunle? Anyone?
And please tell me that AntlrWorks will use that and output the c# too?
Pretty please. Don't make me beg!

Cheers Guys!



	


--
Rob Hill
EDS - Hallamshire Business Park
F1E/087
Sheffield	
T:	+44 (0) 114 291 1928
M:	+44 (0) 791 732 1227
E:	rhill03@eds.com
From sunjigang1965 at yahoo.com.cn  Tue Mar  7 04:01:25 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Tue Mar  7 04:01:33 2006
Subject: [antlr-interest] IToken's getColumn() question,
	one TAB equals 9 spaces, 2 TABs equals 17? 
Message-ID: <20060307120125.54389.qmail@web15709.mail.cnb.yahoo.com>

I am using IToken's getColumn() method to get token postion. The getLine() works fine, and
getColumn() works fine on spaces entered by pressing spacebar of keyboard. But getColumn() could
not calculate length of '\t' correctly: when only one TAB character place before my token, it
returns 9(should be 5), twos TABs count as 17(should be 9).

Should any action be added to '\t' alternative of the following lexer grammar? 

WS:  
(	"//" ('\t'| ' '..'~')* ('\r''\n' )

	| ' '
	| '\t'
	| '\n'
	| '\r' '\n'{newline();}

) {$setType(Token.SKIP);} ;

Cheers.

Jigang



	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From demakov at ispras.ru  Tue Mar  7 04:38:53 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Tue Mar  7 04:39:04 2006
Subject: [antlr-interest] IToken's getColumn() question,
	one TAB equals 9 spaces, 2 TABs equals 17? 
References: <20060307120125.54389.qmail@web15709.mail.cnb.yahoo.com>
Message-ID: <038901c641e4$17f48e90$8cc79553@marlboro>

Default tab size is 8. Call CharScanner's method
setTabSize(int size) to override default setting.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


----- Original Message ----- 
From: " Jigang (Robert) Sun" <sunjigang1965@yahoo.com.cn>
To: <antlr-interest@antlr.org>
Sent: Tuesday, March 07, 2006 3:01 PM
Subject: [?? Probable Spam] [antlr-interest] IToken's getColumn() question,one TAB equals 9 spaces, 2 TABs equals 17?


>I am using IToken's getColumn() method to get token postion. The getLine() works fine, and
> getColumn() works fine on spaces entered by pressing spacebar of keyboard. But getColumn() could
> not calculate length of '\t' correctly: when only one TAB character place before my token, it
> returns 9(should be 5), twos TABs count as 17(should be 9).
>
> Should any action be added to '\t' alternative of the following lexer grammar?
>
> WS:
> ( "//" ('\t'| ' '..'~')* ('\r''\n' )
>
> | ' '
> | '\t'
> | '\n'
> | '\r' '\n'{newline();}
>
> ) {$setType(Token.SKIP);} ;
>
> Cheers.
>
> Jigang 


From jose.ventura.roda at gmail.com  Tue Mar  7 08:14:24 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Tue Mar  7 08:14:28 2006
Subject: [antlr-interest] Create a lexer from a String
Message-ID: <e39abda10603070814t7ca80331l@mail.gmail.com>

Hi all,

In antlr 2.7.5, Can I create a new lexer from a String?

Probably is a question of java, but I'm newbie too in java :-(

Thanks a lot.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060307/42d1f0a2/attachment.html
From parrt at cs.usfca.edu  Tue Mar  7 08:44:24 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Mar  7 08:44:26 2006
Subject: [antlr-interest] Create a lexer from a String
In-Reply-To: <e39abda10603070814t7ca80331l@mail.gmail.com>
References: <e39abda10603070814t7ca80331l@mail.gmail.com>
Message-ID: <210DFAF7-B9DF-4427-877F-65A9170766EA@cs.usfca.edu>

Sure.  See StringReader or StringInputStream I think.  Then pass to  
lexer.
Ter

On Mar 7, 2006, at 8:14 AM, Jose Ventura wrote:

> Hi all,
>
> In antlr 2.7.5, Can I create a new lexer from a String?
>
> Probably is a question of java, but I'm newbie too in java :-(
>
> Thanks a lot.
>

From dieter_frej at gmx.net  Tue Mar  7 10:09:45 2006
From: dieter_frej at gmx.net (Dieter Frej)
Date: Tue Mar  7 10:09:59 2006
Subject: [antlr-interest] v3: using literals
In-Reply-To: <AEAFAB5F-45DE-45E0-8069-F3A421C770EA@cs.usfca.edu>
References: <440B074A.1060101@gmx.net>
	<AEAFAB5F-45DE-45E0-8069-F3A421C770EA@cs.usfca.edu>
Message-ID: <440DCC69.9020700@gmx.net>

Thanks Ter! Is there any way I can get rid of this ambiguity?
... or anyone else besides Ter? ;-)

- Didi



Terence Parr wrote:
> Hi. The grammar you have is fine minus the ambiguity.  You don't need  
> to do that testLiterals stuff with v3.  It just works.
> 
> Ter
> 
> On Mar 5, 2006, at 7:44 AM, Dieter Frej wrote:
> 
>> Hi,
>>
>> since antlrworks is a nice program I started using it (in my case  it 
>> does not matter whether I use antlr v2 or v3).
>>
>> I have something pretty easy such as
>>
>> typeSpec
>>     :
>>     (classOrInterfaceType | primitiveType)
>>     ;
>>     
>> primitiveType
>>     :    //
>>     |    'boolean'
>>     |    'byte'
>>     |    'char'
>>     |    'short'
>>     |    'int'
>>     |    'float'
>>     |    'long'
>>     |    'double'
>>     ;
>>
>> classOrInterfaceType
>>     :    //
>>         IDENT
>>     ;
>>
>> IDENT
>>     :    ('a'..'z'|'A'..'Z'|'_'|'$') 
>> ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>>     ;
>>
>> I am getting a
>>
>> [16:32:58] test.g:47:9: Decision can match input such as "IDENT" using
>> multiple alternatives: 1, 2
>> As a result, alternative(s) 2 were disabled for that input
>>
>> which I completly understand. The problem is that I do not know how to
>> use and test for literals in antlr v3. I did put
>>
>> grammar test;
>> options {
>>     output = AST;
>> }
>> tokens {
>>     LITERAL_boolean='boolean';
>>     LITERAL_byte='byte';
>>     LITERAL_char='char';
>>     LITERAL_short='short';
>>     LITERAL_int='int';
>>     LITERAL_float='float';
>>     LITERAL_long='long';
>>     LITERAL_double='double';
>> }
>>
>> in my grammar, but when I put testLiterals=true under options, it  keeps
>> complaining. I searched for it on the web page, but nothing :-/ Not  even
>> in the java example grammar that is on the v3 page.
>>
>> Any hints/suggestions how I could do that in v3? Or is v3 not yet  ready
>> for that?
>> If so: is there any other nice visual development tool for antlr v2?
>>
>> Didi
> 
> 
> 

From Jeff.Barnes at codesic.com  Tue Mar  7 10:23:59 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Tue Mar  7 10:23:58 2006
Subject: [antlr-interest] v3: using literals
References: <440B074A.1060101@gmx.net><AEAFAB5F-45DE-45E0-8069-F3A421C770EA@cs.usfca.edu>
	<440DCC69.9020700@gmx.net>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D8E@hq-app2.CODESIC.COM>

Put protected in front of the two rules called by typeSpec.

________________________________

From: antlr-interest-bounces@antlr.org on behalf of Dieter Frej
Sent: Tue 3/7/2006 10:09 AM
To: antlr-interest Interest
Subject: Re: [antlr-interest] v3: using literals



Thanks Ter! Is there any way I can get rid of this ambiguity?
... or anyone else besides Ter? ;-)

- Didi



Terence Parr wrote:
> Hi. The grammar you have is fine minus the ambiguity.  You don't need 
> to do that testLiterals stuff with v3.  It just works.
>
> Ter
>
> On Mar 5, 2006, at 7:44 AM, Dieter Frej wrote:
>
>> Hi,
>>
>> since antlrworks is a nice program I started using it (in my case  it
>> does not matter whether I use antlr v2 or v3).
>>
>> I have something pretty easy such as
>>
>> typeSpec
>>     :
>>     (classOrInterfaceType | primitiveType)
>>     ;
>>    
>> primitiveType
>>     :    //
>>     |    'boolean'
>>     |    'byte'
>>     |    'char'
>>     |    'short'
>>     |    'int'
>>     |    'float'
>>     |    'long'
>>     |    'double'
>>     ;
>>
>> classOrInterfaceType
>>     :    //
>>         IDENT
>>     ;
>>
>> IDENT
>>     :    ('a'..'z'|'A'..'Z'|'_'|'$')
>> ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>>     ;
>>
>> I am getting a
>>
>> [16:32:58] test.g:47:9: Decision can match input such as "IDENT" using
>> multiple alternatives: 1, 2
>> As a result, alternative(s) 2 were disabled for that input
>>
>> which I completly understand. The problem is that I do not know how to
>> use and test for literals in antlr v3. I did put
>>
>> grammar test;
>> options {
>>     output = AST;
>> }
>> tokens {
>>     LITERAL_boolean='boolean';
>>     LITERAL_byte='byte';
>>     LITERAL_char='char';
>>     LITERAL_short='short';
>>     LITERAL_int='int';
>>     LITERAL_float='float';
>>     LITERAL_long='long';
>>     LITERAL_double='double';
>> }
>>
>> in my grammar, but when I put testLiterals=true under options, it  keeps
>> complaining. I searched for it on the web page, but nothing :-/ Not  even
>> in the java example grammar that is on the v3 page.
>>
>> Any hints/suggestions how I could do that in v3? Or is v3 not yet  ready
>> for that?
>> If so: is there any other nice visual development tool for antlr v2?
>>
>> Didi
>
>
>


From antlr at jazillian.com  Tue Mar  7 10:34:36 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Tue Mar  7 10:32:36 2006
Subject: [antlr-interest] Article against TreeWalkers
Message-ID: <440DD23C.4070300@jazillian.com>

Well, I've done it again :)
Wrote another article disagreeing with Terence.

It's called Manual Treewalking is Better than Tree Grammars:
http://jazillian.com/articles/treewalkers.html

Please post comments/corrections to the list.
If there are no glaring errors, I'll add it to the antlr.org articles 
section.

Andy
From parrt at cs.usfca.edu  Tue Mar  7 10:52:17 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Mar  7 10:52:21 2006
Subject: [antlr-interest] v3: using literals
In-Reply-To: <440DCC69.9020700@gmx.net>
References: <440B074A.1060101@gmx.net>
	<AEAFAB5F-45DE-45E0-8069-F3A421C770EA@cs.usfca.edu>
	<440DCC69.9020700@gmx.net>
Message-ID: <E551BABF-CF71-4CB1-AD03-F02B42A69A36@cs.usfca.edu>

your primitiveType is optional (empty alt) and presumably there is a  
loop above typeSpec.  That can be the only possibility...what can  
follow typeSpec?
Ter
On Mar 7, 2006, at 10:09 AM, Dieter Frej wrote:

> Thanks Ter! Is there any way I can get rid of this ambiguity?
> ... or anyone else besides Ter? ;-)
>
> - Didi
>
>
>
> Terence Parr wrote:
>> Hi. The grammar you have is fine minus the ambiguity.  You don't  
>> need  to do that testLiterals stuff with v3.  It just works.
>> Ter
>> On Mar 5, 2006, at 7:44 AM, Dieter Frej wrote:
>>> Hi,
>>>
>>> since antlrworks is a nice program I started using it (in my  
>>> case  it does not matter whether I use antlr v2 or v3).
>>>
>>> I have something pretty easy such as
>>>
>>> typeSpec
>>>     :
>>>     (classOrInterfaceType | primitiveType)
>>>     ;
>>>     primitiveType
>>>     :    //
>>>     |    'boolean'
>>>     |    'byte'
>>>     |    'char'
>>>     |    'short'
>>>     |    'int'
>>>     |    'float'
>>>     |    'long'
>>>     |    'double'
>>>     ;
>>>
>>> classOrInterfaceType
>>>     :    //
>>>         IDENT
>>>     ;
>>>
>>> IDENT
>>>     :    ('a'..'z'|'A'..'Z'|'_'|'$')  
>>> ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>>>     ;
>>>
>>> I am getting a
>>>
>>> [16:32:58] test.g:47:9: Decision can match input such as "IDENT"  
>>> using
>>> multiple alternatives: 1, 2
>>> As a result, alternative(s) 2 were disabled for that input
>>>
>>> which I completly understand. The problem is that I do not know  
>>> how to
>>> use and test for literals in antlr v3. I did put
>>>
>>> grammar test;
>>> options {
>>>     output = AST;
>>> }
>>> tokens {
>>>     LITERAL_boolean='boolean';
>>>     LITERAL_byte='byte';
>>>     LITERAL_char='char';
>>>     LITERAL_short='short';
>>>     LITERAL_int='int';
>>>     LITERAL_float='float';
>>>     LITERAL_long='long';
>>>     LITERAL_double='double';
>>> }
>>>
>>> in my grammar, but when I put testLiterals=true under options,  
>>> it  keeps
>>> complaining. I searched for it on the web page, but nothing :-/  
>>> Not  even
>>> in the java example grammar that is on the v3 page.
>>>
>>> Any hints/suggestions how I could do that in v3? Or is v3 not  
>>> yet  ready
>>> for that?
>>> If so: is there any other nice visual development tool for antlr v2?
>>>
>>> Didi
>

From mail at martin-probst.com  Tue Mar  7 13:45:50 2006
From: mail at martin-probst.com (Martin Probst)
Date: Tue Mar  7 13:46:00 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <200603051648.36254.brade@informatik.uni-muenchen.de>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<dd3a065f0603030738t5fad46ebo97b102f75ba762ec@mail.gmail.com>
	<1141401155.4872.31.camel@localhost.localdomain>
	<200603051648.36254.brade@informatik.uni-muenchen.de>
Message-ID: <1141767950.10511.4.camel@localhost.localdomain>

> identifier { lexer.testLiterals = false; } 
>     : NCNAME 
>      { lexer.testLiterals = true; }  // should be an "exit-action"
>     ;

The problem is that every parser would first need to know if an NCNAME
comes up to decide to enter the identifier rules. That's always a
problem with state switching in the parser - lookahead stops working
predictably. There is no way around that - you can't decide to enter the
identifier rule before you know there's an identifier coming up, for
which you need to know whether you're in the identifier rule ...

> Does anyone have an idea of how to do the above in ANTLR? Not possible...?

Not possible, but not only not possible in ANTLR, but impossible in the
general sense.

Martin

From omni_consumers at yahoo.com  Tue Mar  7 16:41:10 2006
From: omni_consumers at yahoo.com (frank uno)
Date: Tue Mar  7 16:41:13 2006
Subject: [antlr-interest] action syntax - "#"
Message-ID: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>

Hi all

We are working with a part of the ANTLR grammar for
XQuery from the eXist project. 

We are unable to find any documentation for the symbol
- "#" used in the action syntax part.

For Example:

quantifiedInVarBinding throws XPathException
{ String varName; }:
	DOLLAR! varName=qName! ( typeDeclaration )? "in"!
exprSingle
	{ #quantifiedInVarBinding = #(#[VARIABLE_BINDING,
varName], #quantifiedInVarBinding); }
	;

Any help would be greatly appreaciated.

---
Thank You



__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
From tom at tomgoff.com  Tue Mar  7 17:04:36 2006
From: tom at tomgoff.com (Tom Goff)
Date: Tue Mar  7 17:04:43 2006
Subject: [antlr-interest] Best way to get LT(0)?
Message-ID: <000c01c6424c$453b9c00$6501a8c0@HANKY>

Hello,

 

I need to be able to look back at the previous token for Intellisense type
functionality. Can someone please point me in the right direction?

 

I was going to derive a class from TokenBuffer and maintain it there, but
I'm not sure if there's an easier way.

 

Thanks in advance,

Tom

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060307/5de7f93d/attachment.html
From stanio at myrealbox.com  Tue Mar  7 23:09:53 2006
From: stanio at myrealbox.com (Stanimir Stamenkov)
Date: Tue Mar  7 23:07:58 2006
Subject: [antlr-interest] action syntax - "#"
In-Reply-To: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>
References: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>
Message-ID: <440E8341.6000004@myrealbox.com>

/frank uno/:

> We are unable to find any documentation for the symbol 
> - "#" used in the action syntax part.

 From the ANTLR Reference Manual:

ANTLR Tree Construction <http://www.antlr.org/doc/trees.html>

> For Example:
> 
> quantifiedInVarBinding throws XPathException
> { String varName; }:
> 	DOLLAR! varName=qName! ( typeDeclaration )? "in"!
> exprSingle
> 	{ #quantifiedInVarBinding = #(#[VARIABLE_BINDING,
> varName], #quantifiedInVarBinding); }
> 	;

I guess you need something like:

quantifiedInVarBinding throws XPathException
{ String varName; }:
	DOLLAR! varName:qName! ( typeDeclaration )? "in"!
exprSingle
	{ #quantifiedInVarBinding = #([VARIABLE_BINDING,
varName], quantifiedInVarBinding); }
	;

Something I haven't actually got from the documentation is the exact 
syntax:

#(A, B, C)

i.e. separating the tokens with commas. In the documentation there 
are examples without commas, like:

> stat:
>         ID EQUALS^ expr   // auto construction
>     ... some alternatives ...
>     |!  RETURN expr
>         {#stat = #([IMAGINARY_TOKEN_TYPE] expr);}
>     ... more alternatives ...
>     ; 

but this gives me an error running the ANTLR tool. There is example 
using a comma, too:

> decl : ( TYPE ID )+
>        { #decl = #([DECL,"decl"], #decl); }
>      ;

but this one is slightly different as it creates one more tree 
branch (if it matters at all).

-- 
Stanimir
From jose.ventura.roda at gmail.com  Wed Mar  8 01:50:31 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Wed Mar  8 01:50:34 2006
Subject: [antlr-interest] Create a lexer from a String
In-Reply-To: <210DFAF7-B9DF-4427-877F-65A9170766EA@cs.usfca.edu>
References: <e39abda10603070814t7ca80331l@mail.gmail.com>
	<210DFAF7-B9DF-4427-877F-65A9170766EA@cs.usfca.edu>
Message-ID: <e39abda10603080150g60a04cbcv@mail.gmail.com>

Thank's Terence.


2006/3/7, Terence Parr <parrt@cs.usfca.edu>:
>
> Sure.  See StringReader or StringInputStream I think.  Then pass to
> lexer.
> Ter
>
> On Mar 7, 2006, at 8:14 AM, Jose Ventura wrote:
>
> > Hi all,
> >
> > In antlr 2.7.5, Can I create a new lexer from a String?
> >
> > Probably is a question of java, but I'm newbie too in java :-(
> >
> > Thanks a lot.
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/820376e8/attachment.html
From brade at informatik.uni-muenchen.de  Wed Mar  8 02:14:08 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar  8 02:13:16 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <1141767950.10511.4.camel@localhost.localdomain>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<200603051648.36254.brade@informatik.uni-muenchen.de>
	<1141767950.10511.4.camel@localhost.localdomain>
Message-ID: <200603081114.15693.brade@informatik.uni-muenchen.de>

On Tuesday 07 March 2006 22:45, Martin Probst wrote:
> The problem is that every parser would first need to know if an NCNAME
> comes up to decide to enter the identifier rules. That's always a
> problem with state switching in the parser - lookahead stops working
> predictably. There is no way around that - you can't decide to enter the
> identifier rule before you know there's an identifier coming up, for
> which you need to know whether you're in the identifier rule ...
Not quite. There's a line "if (LA(1)==NCNAME)" in the code "to know if an 
NCNAME comes up". The trick I would need is simply a 
lexer.testLiterals=false; call right before it. That's all. I could modify 
the generated code by hand, but that's something I'd rather avoid for now.

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/aa4d64e2/attachment.bin
From brade at informatik.uni-muenchen.de  Wed Mar  8 02:24:05 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar  8 02:23:08 2006
Subject: [antlr-interest] action syntax - "#"
In-Reply-To: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>
References: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>
Message-ID: <200603081124.06122.brade@informatik.uni-muenchen.de>

Hi,

On Wednesday 08 March 2006 01:41, frank uno wrote:
> We are working with a part of the ANTLR grammar for
> XQuery from the eXist project.
>
> We are unable to find any documentation for the symbol
> - "#" used in the action syntax part.
Look in antlr-2.7.6/antlr/actions/java/action.g for a short explanation.

> For Example:
>
> quantifiedInVarBinding throws XPathException
> { String varName; }:
> 	DOLLAR! varName=qName! ( typeDeclaration )? "in"!
> exprSingle
> 	{ #quantifiedInVarBinding = #(#[VARIABLE_BINDING,
> varName], #quantifiedInVarBinding); }
> 	;
In addition to what Stanimir said, there's an even shorter version:

quantifiedInVarBinding throws XPathException
{ String varName; }:
	DOLLAR! varName=qName! ( typeDeclaration )? "in"! exprSingle
	{ ## = #([VARIABLE_BINDING, varName], ##); }
	;

*if* I understand you correctly and all you want to do is add an imaginary 
token VARIABLE_BINDING on top of the tree generated by that rule with the 
contents of the variable being the descendents of it.

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/9e539cd0/attachment.bin
From mail at martin-probst.com  Wed Mar  8 02:33:21 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar  8 02:33:35 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <200603081114.15693.brade@informatik.uni-muenchen.de>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<200603051648.36254.brade@informatik.uni-muenchen.de>
	<1141767950.10511.4.camel@localhost.localdomain>
	<200603081114.15693.brade@informatik.uni-muenchen.de>
Message-ID: <1141814001.4920.5.camel@localhost.localdomain>

Hi,

> > The problem is that every parser would first need to know if an NCNAME
> > comes up to decide to enter the identifier rules. That's always a
> > problem with state switching in the parser - lookahead stops working
> > predictably. There is no way around that - you can't decide to enter the
> > identifier rule before you know there's an identifier coming up, for
> > which you need to know whether you're in the identifier rule ...
>
> Not quite. There's a line "if (LA(1)==NCNAME)" in the code "to know if an 
> NCNAME comes up". The trick I would need is simply a 
> lexer.testLiterals=false; call right before it. That's all. I could modify 
> the generated code by hand, but that's something I'd rather avoid for now.

The problem is where to check for NCNAMEs and where not to. You
certainly have some parts in your grammar where you expect NCNAMEs and
some parts where you have to test for the operators. The knowledge where
that is appropriate and where not is not available to ANTLR.

If it's really exactly one place, then this probably means your just
referring there from exactly one place, i.e. the "identifier" rule is
only accessed from one point. You can then switch off literal testing in
the calling rule before the branching decision is made, e.g.

fooRule:
  BAR BAZ { lexer.testLiterals = off; } identifier;

Martin

From brade at informatik.uni-muenchen.de  Wed Mar  8 03:42:45 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar  8 03:41:51 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <1141814001.4920.5.camel@localhost.localdomain>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<200603081114.15693.brade@informatik.uni-muenchen.de>
	<1141814001.4920.5.camel@localhost.localdomain>
Message-ID: <200603081242.51295.brade@informatik.uni-muenchen.de>

On Wednesday 08 March 2006 11:33, Martin Probst wrote:
> > Not quite. There's a line "if (LA(1)==NCNAME)" in the code "to know if an
> > NCNAME comes up". The trick I would need is simply a
> > lexer.testLiterals=false; call right before it. That's all. I could
> > modify the generated code by hand, but that's something I'd rather avoid
> > for now.
>
> The problem is where to check for NCNAMEs and where not to. You
> certainly have some parts in your grammar where you expect NCNAMEs and
> some parts where you have to test for the operators. The knowledge where
> that is appropriate and where not is not available to ANTLR.
To be honest, I don't follow you here. The check for NCNAMEs is correct in 
every case, and I do expect NCNAMEs in all those places. 

I guess you also meant s/operators/keywords/? Then yes, this knowledge is 
available, since the grammar contains e.g. (simplified)

data_term : "declare" ("ns-prefix" NCNAME ASSIGN STRING)* LP (data_term)* RP
          | (...) => NCNAME (AT NCNAME)? (COLON NCNAME) LP (data_term)* RP
          | NCNAME
          ;

[LP = '(', RP = ')', guessing left empty for simplicity, see below]

and all NCNAMEs must not test for keywords (literals), although "declare" etc. 
must do so. The generated code could be modified to switch testLiterals on 
and off in each and every place where NCNAME is used.

> If it's really exactly one place, then this probably means your just
> referring there from exactly one place, i.e. the "identifier" rule is
> only accessed from one point. You can then switch off literal testing in
> the calling rule before the branching decision is made, e.g.
>
> fooRule:
>   BAR BAZ { lexer.testLiterals = off; } identifier;
The big problem with this is that guessing won't pick it up and will thus 
fail. In the above grammar I need the guessing in the second line (left 
empty) to see if there is at least an LP coming up.

But thanks for your help anyway!

Actually, I just had an idea: what about switching testLiterals off completely 
in the lexer and (in the generated parser code) in every place where there's 
an 
  LA(1)==SOME_KEYWORD 
replace the code with 
  LA(1)==NCNAME && testLiteralsTable(LA(1))==SOME_KEYWORD
?
That would work, no? And it could be done with a little script?

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/a90462eb/attachment-0001.bin
From mail at martin-probst.com  Wed Mar  8 04:47:01 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar  8 04:47:12 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <200603081242.51295.brade@informatik.uni-muenchen.de>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<200603081114.15693.brade@informatik.uni-muenchen.de>
	<1141814001.4920.5.camel@localhost.localdomain>
	<200603081242.51295.brade@informatik.uni-muenchen.de>
Message-ID: <1141822021.4781.10.camel@localhost.localdomain>

> > The problem is where to check for NCNAMEs and where not to. You
> > certainly have some parts in your grammar where you expect NCNAMEs and
> > some parts where you have to test for the operators. The knowledge where
> > that is appropriate and where not is not available to ANTLR.
>
> To be honest, I don't follow you here. The check for NCNAMEs is correct in 
> every case, and I do expect NCNAMEs in all those places. 

Sorry, my wording was a little bad. What I meant is "when to interpret a
character sequence which is both a valid NCNAME and a valid keyword like
an NCNAME or a keyword, respectively".

> I guess you also meant s/operators/keywords/? Then yes, this knowledge is 
> available, since the grammar contains e.g. (simplified)
> 
> data_term : "declare" ("ns-prefix" NCNAME ASSIGN STRING)* LP (data_term)* RP
>           | (...) => NCNAME (AT NCNAME)? (COLON NCNAME) LP (data_term)* RP
>           | NCNAME
>           ;

So, at the start of data_term, "declare" is a keyword, and the optional
NCNAME cannot be "declare". For input "declare" "ns-prefix" then the
input "declare" is legal and an NCNAME. I think we'll end up with the
conclusion we already had - keyword free grammars are messy, and the
distinction between parser and lexer doesn't really hold for them.

> The big problem with this is that guessing won't pick it up and will thus 
> fail. In the above grammar I need the guessing in the second line (left 
> empty) to see if there is at least an LP coming up.

I think the only way to keep guessing working with such a language in
ANTLR 2 is to have a stateful lexer.

> But thanks for your help anyway!
> 
> Actually, I just had an idea: what about switching testLiterals off completely 
> in the lexer and (in the generated parser code) in every place where there's 
> an 
>   LA(1)==SOME_KEYWORD 
> replace the code with 
>   LA(1)==NCNAME && testLiteralsTable(LA(1))==SOME_KEYWORD
> ?
> That would work, no? And it could be done with a little script?

You could also write:

data_term: { LA(1).getText().equals("declare") }? NCNAME "ns-prefix" ...
	| NCNAME
	;

Martin

From brade at informatik.uni-muenchen.de  Wed Mar  8 07:02:26 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar  8 07:01:32 2006
Subject: [antlr-interest] languages without reserved words
In-Reply-To: <1141822021.4781.10.camel@localhost.localdomain>
References: <200603021149.44859.brade@informatik.uni-muenchen.de>
	<200603081242.51295.brade@informatik.uni-muenchen.de>
	<1141822021.4781.10.camel@localhost.localdomain>
Message-ID: <200603081602.32225.brade@informatik.uni-muenchen.de>

On Wednesday 08 March 2006 13:47, Martin Probst wrote:
> conclusion we already had - keyword free grammars are messy, and the
> distinction between parser and lexer doesn't really hold for them.
I see, and now that makes a lot more sense to me, I didn't understand it 
before.

> > The big problem with this is that guessing won't pick it up and will thus
> > fail. In the above grammar I need the guessing in the second line (left
> > empty) to see if there is at least an LP coming up.
>
> I think the only way to keep guessing working with such a language in
> ANTLR 2 is to have a stateful lexer.
yeah, and I'm not gonna implement that :-/

> You could also write:
>
> data_term: { LA(1).getText().equals("declare") }? NCNAME "ns-prefix" ...
> 	| NCNAME
I'm not sure. That would mean the second NCNAME alternative would never be 
executed because the first throws an exception. At least the rules that only 
have one alternative won't work since there is no backtracking. I thought 
about those things already but apart from modifying the generated code I 
haven't been able to find another solution.

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/5d741091/attachment.bin
From jose.ventura.roda at gmail.com  Wed Mar  8 07:13:13 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Wed Mar  8 07:13:17 2006
Subject: Fwd: [antlr-interest] Relational operator in COBOL
In-Reply-To: <e39abda10603060050r457d59d1w@mail.gmail.com>
References: <e39abda10603030651wc276fcey@mail.gmail.com>
	<dd3a065f0603030731n2193e0b3r16423e2e2053f068@mail.gmail.com>
	<e39abda10603060050r457d59d1w@mail.gmail.com>
Message-ID: <e39abda10603080713mac53abeu@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: mcon.java
Type: application/octet-stream
Size: 1268 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/e385920e/mcon-0001.obj
-------------- next part --------------
@condition 1
ident1 > 1 .

@condition 2
ident1 = 1 or (ident2 GREATER 2). 

@condition 3
ident1 > 0 and ident1 < 50 .

@condition 4
ident1 NOT = 0 .

@condition 5, is like condition 3 
ident1 > 0 and < 50.

@condition 6
ident1 (1, hola, 3+5)(1:5) = "Test l".


















-------------- next part --------------
/*header 
{
	package cobol;
}
	*/
class CobolLex extends Lexer;
options 
{ 
	k=1;
	charVocabulary = '\3'..'\377'; // Unicodes usuales
	caseSensitive=false;
	caseSensitiveLiterals=false;
	testLiterals=false;
	exportVocab=CobolLexVocab;

} 
tokens										// MUST be kept in sync with "keywordsTable" Hashtable below!!
{
	FIN_TODO;
	NUM;
    IDENT;
	LIT_HEXADECIMAL;
	LIT_PIC;
	LIT_COPY;
	FECHA;
	IGUAL;
	MAYOR_IGUAL;
	MENOR_IGUAL;
	NOT_REL;
    
    IDENTIFICATION="IDENTIFICATION";
	ID="ID";
	ENVIRONMENT="ENVIRONMENT";
	DATA="DATA";
	WORKING="WORKING-STORAGE";
	LINKAGE="LINKAGE";
	DIVISION="DIVISION";
	PROGRAM_ID="PROGRAM-ID";
	PROCEDURE="PROCEDURE";
	SECTION="SECTION";

	ACCEPT="ACCEPT";
	ADD="ADD";
	ALL="ALL";
	ALSO="ALSO";
	ALTER="ALTER";
	AND="AND";
	AT="AT";
	BLANK="BLANK";
	BY="BY";
	CALL="CALL";
	CANCEL="CANCEL";
	CICS="CICS";
	CLOSE="CLOSE";
	COMPUTE="COMPUTE";
	COMMAREA="COMMAREA";
	COMMIT="COMMIT";
	CONTINUE="CONTINUE";
	CORR="CORR";
	CORRESPONDING="CORRESPONDING";
	DELETE="DELETE";
	DELIMITED="DELIMITED";
	DISPLAY="DISPLAY";
	DIVIDE="DIVIDE";
	ELSE="ELSE";
	END="END";
	END_ADD="END-ADD";
	END_CALL="END-CALL";
	END_COMPUTE="END-COMPUTE";
	END_DIVIDE="END-DIVIDE";
	END_EVALUATE="END-EVALUATE";
	END_EXEC="END-EXEC";
	END_IF="END-IF";
	END_MULTIPLY="END-MULTIPLY";
	END_PERFORM="END-PERFORM";
	END_SEARCH="END-SEARCH";
	END_STRING="END-STRING";
	END_UNSTRING="END-UNSTRING";
	END_SUBTRACT="END-SUBTRACT";
	ENTRY="ENTRY";
	EVALUATE="EVALUATE";
	EXEC="EXEC";
	EXIT="EXIT";
	METHOD="METHOD";
	PROGRAM="PROGRAM";
	GOBACK="GOBACK";
	GO_TO="GO TO";
	IF="IF";
	IN="IN";
	INITIALIZE="INITIALIZE";
	INSPECT="INSPECT";
	INTO="INTO";
	INVOKE="INVOKE";
	LINK="LINK";
	MERGE="MERGE";
	MOVE="MOVE";
	MULTIPLY="MULTIPLY";
	OF="OF";
	OPEN="OPEN";
	OR="OR";
	OTHER="OTHER";
	PERFORM="PERFORM";
	POINTER="POINTER";
	READ="READ";
	RECEIVE="RECEIVE";
	REDEFINES="REDEFINES";
	RELEASE="RELEASE";
	REPLACING="REPLACING";
	TALLYING="TALLYING";
	RETURN="RETURN";
	REWRITE="REWRITE";
	ROLLBACK="ROLLBACK";
	SEARCH="SEARCH";
	SEND="SEND";
	SET="SET";
	SQL="SQL";
	SORT="SORT";
	SPACE="SPACE";
	SPACES="SPACES";
	START="START";
	STOP="STOP";
	STRING="STRING";
	SUBTRACT="SUBTRACT";
	SYNCPOINT="SYNCPOINT";
	TO="TO";
	THEN="THEN";
	UNSTRING="UNSTRING";
	WRITE="WRITE";
	ZERO="ZERO";
	ZEROS="ZEROS";
	ZEROES="ZEROES";
	THROUGH="THROUGH";
	THRU="THRU";
	VARYING="VARYING";
	UNTIL="UNTIL";
	USING="USING";
	WHEN="WHEN";
	WITH="WITH";
	TEST="TEST";
	BEFORE="BEFORE";
	AFTER="AFTER";
	JUSTIFIED="JUSTIFIED";
	JUST="JUST";
	OCCURS="OCCURS";
	ASCENDING="ASCENDING";
	DESCENDING="DESCENDING";
	KEY="KEY";
	IS="IS";
	INDEXED="INDEXED";
	PIC="PIC";
	PICTURE="PICTURE";
	USAGE="USAGE";
	VALUE="VALUE";
	VALUES="VALUES";
	ARE="ARE";
	RENAMES="RENAMES";
	COPY="COPY";
	BINARY="BINARY";
	COMP="COMP";
	COMP1="COMP-1";
	COMP2="COMP-2";
	COMP3="COMP-3";
	COMP4="COMP-4";
	COMPUTATIONAL="COMPUTATIONAL";
	COMPUTATIONAL1="COMPUTATIONAL-1";
	COMPUTATIONAL2="COMPUTATIONAL-2";
	COMPUTATIONAL3="COMPUTATIONAL-3";
	COMPUTATIONAL4="COMPUTATIONAL-4";
	DISPLAY1="DISPLAY-1";
	INDEX="INDEX";
	PACKED_DECIMAL="PACKED-DECIMAL";
	CHARACTERS="CHARACTERS";
	LEADING="LEADING";
	FIRST="FIRST";
	INITIAL="INITIAL";
	CONVERTING="CONVERTING";
	FOR="FOR";
	UP="UP";
	DOWN="DOWN";
	NOT="NOT";
	NULL="NULL";
	ON="ON";
	SIZE="SIZE";
	ERROR="ERROR";
	THAN="THAN";
	GREATER="GREATER";
	LESS="LESS";
	EQUAL="EQUAL";
	NUMERIC="NUMERIC";
	ALPHABETIC="ALPHABETIC";
	POSITIVE="POSITIVE";
	NEGATIVE="NEGATIVE";
	FROM="FROM";
	

}

{ // Comienza la zona de c?digo nativo

boolean ultPic=false;
boolean enExec=false;
protected Token makeToken(int type)
{
	// Usamos la implementaci?n de la superclase...
	Token result = null;

	
// while I don't have a parser for CICS and SQL.

	if (enExec)
	{
		if (type==END_EXEC||
			type==RETURN ||
			type==RECEIVE ||
			type==SEND   ||
			type==SYNCPOINT ||
			type==LINK
			)
		{
			enExec=false;
			result = super.makeToken(type);
		}
		else
		{
			result = super.makeToken(IDENT);
		}
	}
	else
	{
		if (type==NOT)
		{
			if (esOperadorRelacional())
			{
				type=NOT_REL;
				System.out.println ("Se cambia a NOT");
			}
		}
		result = super.makeToken(type);
	}

	enExec=(type==SQL||type==CICS);
	ultPic =(type==PIC||type==PICTURE);
	
	
		
	// ... a?adimos informaci?n del nombre de fichero
	result.setFilename(super.getFilename());
	// ... y devolvemos el token
	return (result);
	
}

protected boolean esOperadorRelacional ()
{
	boolean operadorRelacional = false;
	int marca = mark();
	try
	{
		while ( LA(1)==' ')
		{
			try
			{
				match(' ');
			}
			catch (MismatchedCharException m)
			{
				System.out.println ("Error en el match del NOT. "+m.getMessage());
			}
		}
		switch (LA(1))
		{
			case '=':
				operadorRelacional = true;
				break;
			case '>':
				operadorRelacional = true;
				break;
			case '<':
				operadorRelacional = true;
				break;
			case 'g':
				operadorRelacional = true;
				try
				{
					match("greater");
				}
				catch (MismatchedCharException m)
				{
					operadorRelacional = false;
				}
				break;
			case 'l':
				operadorRelacional = true;
				try
				{
					match("less");
				}
				catch (MismatchedCharException m)
				{
					operadorRelacional = false;
				}
				break;
			case 'e':
				operadorRelacional = true;
				try
				{
					match("equal");
				}
				catch (MismatchedCharException m)
				{
					operadorRelacional = false;
				}
				break;
		}
	}
	catch (CharStreamException c)
	{
		System.out.println ("problemas al leer despues del NOT");
	}
	rewind (marca);
	return (operadorRelacional);

}

}
COMENTARIO:
	'@' ( ~('\n'|'\r') )* 
	{$setType(Token.SKIP);}
	;

PAR_AB
	: {!ultPic }? '('
	;
PAR_CE
	: {!ultPic }? ')'
	;
CAD_COPY
	: ("==") => "==" ( ~('=') )*	"=="
	{ $setType(LIT_COPY); }
	| '='
	{ $setType(IGUAL); }
	;
DOSPUNTOS
	: ':'
	;

MAS
	: {!ultPic }? 
	  '+' {_ttype = MAS;}
	  (
	  		(DIGITO)+ (',' (DIGITO)+)? 
			{_ttype = NUM;}
	   )?
	;
	
MENOS
	: {!ultPic }?
	  '-' {_ttype = MENOS;}
	  (
	  		(DIGITO)+ (',' (DIGITO)+)? 
			{_ttype = NUM;}
	   )?
	;
	
PUNTO
	: {!ultPic }?
	  '.' {_ttype = FIN_TODO;}
	  (
	  	(DIGITO)+ {_ttype=NUM;}
	   )?
	 ;
COMA
	: {!ultPic }?
	  ',' {_ttype=COMA;} 
	  (
	  	(DIGITO)+ {_ttype=NUM;}
	   )?
	 ;
	 
POR
	: {!ultPic }? '*'
	;

DIVIDE
	: '/'
	;

MAYOR
	: '>'
		('=' {_ttype=MAYOR_IGUAL;})?
	;
MENOR: '<'
		('=' {_ttype=MENOR_IGUAL;})?
	;

protected
LETRA
	: 'a'..'z'
	;

protected
DIGITO
	: '0'..'9'
	;


protected 
NL :
		(
		 ("\r\n") => "\r\n" // MS-DOS
		 | '\r' // MACINTOSH
		 | '\n' // UNIX
		 )
		 {newline(); }
		 ;

BLANCO :
		( ' '
		| '\t'
		| NL
		) 
		{ $setType(Token.SKIP); } // La acci?n del blanco: ignorar
		;

IDENT_NUM  options {testLiterals=true;}
	:{ ultPic }? ('+'|'-'|'$'|'b'|','|'e'|('0'..'9')|'x'|'s'|'v'|'z'|'*'|'('|')'|
	               {LA(2)!=' '&&LA(2)!='\n'&&LA(2)!='\r'}? '.')+  
	 {$setType (LIT_PIC);}
	|('x' '\'') => 'x' '\''( ~('\''|'\n'|'\r'|'\t') )*	'\'' 
	 {$setType (LIT_HEXADECIMAL);}
	| LETRA (LETRA|DIGITO|'-'|'_')*
	 {$setType (IDENT);}
	|((DIGITO)+ (LETRA|'-'|'_')) =>(DIGITO)+ (LETRA|'-'|'_') (LETRA|DIGITO|'-'|'_')*
	 {$setType (IDENT);}
	|((DIGITO)+ '/' )=> (DIGITO)+ '/' (DIGITO|'/')+
	 {$setType (FECHA);}
	| (DIGITO)+  ({LA(2)!=' '&&LA(2)!='\n'&&LA(2)!='\r'}? ',' (DIGITO)+)?
	 {$setType (NUM);}
	| '_' (LETRA|DIGITO|'_')*
	 {$setType (IDENT);}
	;

CADENA :
	'\''! 
	( ~('\''|'\n'|'\r'|'\t') )*
	'\''!
	| '"'! ( ~('"'|'\n'|'\r'|'\t') )* '"'!
	;


















-------------- next part --------------
class condition extends Parser; // Se extiende Parser, y no Lexer
options {
	buildAST = true;
	importVocab = CobolLexVocab;
}

tokens
{
	CONDICION;
	FIELD;
	LIST;
	MOD_TEXTO;
	INDICE;
}

setCondition
	: (condition FIN_TODO!)*
	{#setCondition = #( #[SET, "SET"] ,setCondition);}
	;


condition
	: conditionOR
	{#condition = #( #[CONDICION, "CONDICION"] ,#condition);}
	;
	
conditionOR
	: conditionAND (OR^ conditionAND)*
	;

conditionAND
	: expresionRelacional (AND^ expresionRelacional)*
	;
expresionRelacional
	: (expresionSuma)? (operador_relacional expresionSuma)*
	;
	

	
expresionSuma
	: expresionPor ( (MAS^|MENOS^) expresionPor)*
	;

expresionPor
	: expresionUnitaria ( (POR^|DIVIDE^) expresionUnitaria)*
	;
	
expresionUnitaria
	: MENOS^ expresionUnitaria
	| MAS^ expresionUnitaria
	| expresionUnitariaNoMasMenos
	;
expresionUnitariaNoMasMenos
	: (IS)? NOT^ expresionUnitaria
	| expresionPrimaria
	;
	
expresionPrimaria
	: identifier
	| literal
	| POSITIVE
	| NEGATIVE
	| NUMERIC
	| ALPHABETIC
	| PAR_AB! condition PAR_CE!
	;

operador_relacional
	:(NOT_REL)? 
	(GREATER (THAN)? (OR EQUAL (TO)?)?
	|MAYOR_IGUAL
	|MAYOR
	|LESS (THAN)? (OR EQUAL (TO)?)?
	|MENOR_IGUAL
	|MENOR
	|EQUAL (TO)?
	|IGUAL
	)
	;

	literal
	: NUM
	| CADENA
	| cero
	| SPACE
	| SPACES
	| LIT_HEXADECIMAL
	| NULL
	;
cero
	: ZERO
	| ZEROS
	| ZEROES
	;
	

identifier
	{String texto="";String i="";}
	: i=in_of {texto=i;}
	 (modif_campo)*
	{
		## = #( #[FIELD,texto] ,##);
	}
	;

in_of returns [String t]
	{t="";}
	: i1:IDENT {t+=#i1.getText();}
	  ( ( in1:IN {t+=" "+#in1.getText();}
	      |of1:OF {t+=" "+#of1.getText();}
		 )
		 i2:IDENT {t+=" "+#i2.getText();}
	  )*
	;
	
modif_campo 
	: (PAR_AB expresionSuma DOSPUNTOS) => PAR_AB! expresionSuma DOSPUNTOS (expresionSuma)? PAR_CE!
	{#modif_campo= #( #[MOD_TEXTO,"MOD_TEXTO"],#modif_campo);}
	| PAR_AB! conditionList  PAR_CE!
	{#modif_campo= #( #[INDICE,"INDICE"],#modif_campo);}
	;


conditionList
	: condition (COMA condition)*
	{#conditionList = #( #[LIST, "LIST"] ,conditionList);}
	;
















From Jeff.Barnes at codesic.com  Wed Mar  8 08:54:27 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Wed Mar  8 08:53:26 2006
Subject: [antlr-interest] Article against TreeWalkers
References: <440DD23C.4070300@jazillian.com>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>

A couple of questions, Andy...
 
Would it be fair to say that one big switch statement is not as good as an interface?
 
Does the tree grammar "mix languages" anywhere else besides actions and semantic preds? Would a solution that defines constraint and action languages be palatable to you? Or am I being too much of an "Insightful Linguist"?
 
Andy sez:
I realized that tree parsing is identical to text parsing, albeit in two dimensions instead of one. 

Go ahead and take an few minutes, a few hours, or a full PhD program to really absorb that. I'll wait right here.... 

Jeff sez:

LOL! I never got that either. To me, a tree seems multi-dimensional; a table is two-dimensional. Terrence??

Andy, your disenfranchisement lends credibility to the Tree Grammar.

Regards,

Jeff

 

From parrt at cs.usfca.edu  Wed Mar  8 09:02:20 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed Mar  8 09:02:26 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
Message-ID: <9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>

On Mar 8, 2006, at 8:54 AM, Jeff Barnes wrote:
> Andy sez:
> I realized that tree parsing is identical to text parsing, albeit  
> in two dimensions instead of one.

I've been trying to scream that as loud as I can...not loud enough I  
guess. ;)  All v3 recognizers derive from same base class, so even in  
practice recog. is all the same thing: 1D or 2D :)

> Jeff sez:
>
> LOL! I never got that either. To me, a tree seems multi- 
> dimensional; a table is two-dimensional. Terrence??

a : ^(A B) ;

is same as

a : A DOWN B UP ;

if you insert those imaginary navigation nodes, it is just a simple  
1D grammar. :)  v3 does this.  Rather a nice generalization, right?   
I have a paper waiting to be written on this...stupid lame hands  
prevents more papers...oh and my job doing grad directorship at USF  
takes most of my time right now... ;)

Ter
From kroepke at dolphin-services.de  Wed Mar  8 09:42:02 2006
From: kroepke at dolphin-services.de (Kay Roepke)
Date: Wed Mar  8 09:42:13 2006
Subject: [antlr-interest] action syntax - "#"
In-Reply-To: <200603081124.06122.brade@informatik.uni-muenchen.de>
References: <20060308004111.47036.qmail@web35509.mail.mud.yahoo.com>
	<200603081124.06122.brade@informatik.uni-muenchen.de>
Message-ID: <F2485BBF-5F6E-4E7B-99F5-14A8FB7B694F@dolphin-services.de>


On 8. Mar 2006, at 18:24 Uhr, Michael Brade wrote:

>> We are unable to find any documentation for the symbol
>> - "#" used in the action syntax part.
> Look in antlr-2.7.6/antlr/actions/java/action.g for a short  
> explanation.

I'm not getting tired of pointing to this great piece of text:
http://antlr.org/article/1137964510001/manual.tree.construction.txt

;)

HTH,
Kay

P.S.: I'm starting to get the hang of this Australian  
weather...anyone like to start a software shop down here in Perth?
I'd be all for it...I gather they have snow and bird flu at home at  
the moment...;)
From sunjigang1965 at yahoo.com.cn  Wed Mar  8 09:48:34 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Wed Mar  8 09:48:39 2006
Subject: [antlr-interest] infinite iteration in AST make(params AST[] nodes)
Message-ID: <20060308174834.75150.qmail@web15702.mail.cnb.yahoo.com>


> 
> The code generated by following grammar 
> 
> program
> 	:
> 	m:mainClass l:classDeclList  {## = #( #[PROGRAM,
> "PROGRAM","MiniJava.Program"],#m,#l);} EOF
> 	; 	
> 
> runs into infinite iteration at
> 
> public virtual AST make(params AST[] nodes)
> {
> ...
>      while (tail.getNextSibling() != null) //could not
> get out of here
>     {
>         tail = tail.getNextSibling();
>         Console.WriteLine(tail.GetType());//added by
> me
>     }
>   }
> return root;
> }
> 
> After putting to the end of ! program, got expected
> tree.
> 
> What I remember last time for formalList, I put ! to
> formalList after computer got into dead iteration,
> then   I continue to other grammar modification which
> is irrelavant to formalList, then remove the bomb off.
> It worked normally.
> 
> Jigang  
> 
> 
> --- Micheal J <open.zone@virgin.net>:
> 
> > > Code generated by the attached grammar only
> > produces a
> > > root StatementList node contains an empty list of
> > > Statement. After remove ! from end of 
> > > "statementList", desired result got. Is this
> > normal?
> > 
> > Yes. "!" means don't generate standard tree creation
> > code. You now have to
> > provide that yourself. For statementList, you should
> > leave it  out.
> > 
> > > While the following grammar works well.
> > > 
> > > formalList!
> > > 	:
> > > 	 (formal ( COMMA! formal)* { ## = 
> > > #(#[FORMAL_LIST,"FORMAL_LIST"],##); })?
> > > 	;
> > 
> > Strange. This should give the root node only as
> > well.
> > 
> > 
> > Micheal
> > 
> > 
> 
> 
> 
> 		
> ___________________________________________________________ 
> 1G 
> http://cn.mail.yahoo.com/
> 



	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From antlr at jazillian.com  Wed Mar  8 10:58:51 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Wed Mar  8 10:56:54 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
Message-ID: <440F296B.8040405@jazillian.com>

Jeff Barnes wrote:

>A couple of questions, Andy...
> 
>Would it be fair to say that one big switch statement is not as good as an interface?
>  
>
I don't think so. I'm not sure how an interface could even replace a big 
switch statement in the case I show there, where we're
saying "I'm processing a particular AST node, and here's a huge switch 
statement on the node type". I suppose we could
have a bunch interfaces (e.g. "ImABinaryOperatorNode"), and have the AST 
node implement one of them, but that
doesn't seem to make things any cleaner to me.

> 
>Does the tree grammar "mix languages" anywhere else besides actions and semantic preds? Would a solution that defines constraint and action languages be palatable to you? Or am I being too much of an "Insightful Linguist"?
> 
>Andy sez:
>I realized that tree parsing is identical to text parsing, albeit in two dimensions instead of one. 
>
>Go ahead and take an few minutes, a few hours, or a full PhD program to really absorb that. I'll wait right here.... 
>
>Jeff sez:
>
>LOL! I never got that either. To me, a tree seems multi-dimensional; a table is two-dimensional. Terrence??
>
>  
>
I see how a tree is 2D, and I can even see how it might be nice to use 
the same language to parse the 2D tree that you
used to parse the 1D token stream. But then in practice, I think the two 
tasks are different enough that it doesn't help
to use the same language. And this despite the fact that I love that the 
one ANTLR language does both lexing and parsing.

>Andy, your disenfranchisement lends credibility to the Tree Grammar.
>
>Regards,
>
>Jeff
>
> 
>
>
>  
>

From Jeff.Barnes at codesic.com  Wed Mar  8 12:59:02 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Wed Mar  8 12:58:00 2006
Subject: [antlr-interest] Article against TreeWalkers
References: <440DD23C.4070300@jazillian.com><FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<440F296B.8040405@jazillian.com>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D91@hq-app2.CODESIC.COM>

Jeff sez:
 
>Would it be fair to say that one big switch statement is not as good as an interface?
> 
>
Andy sez:
I don't think so. I'm not sure how an interface could even replace a big
switch statement in the case I show there, where we're
saying "I'm processing a particular AST node, and here's a huge switch
statement on the node type". I suppose we could
have a bunch interfaces (e.g. "ImABinaryOperatorNode"), and have the AST
node implement one of them, but that
doesn't seem to make things any cleaner to me.

Jeff sez:

If using an interface doesn't seem cleaner, then you probably are better off with a big switch statement. Me? I groan whenever I have to look at a big switch statement. But my primary reason for using an interface is by extension; I want to give the metatype as much responsibility as I can. I can see similarity between the tree metalanguage and metamodel. I just wish there were a mechanism for explicit constraints in the tree grammar without going to code.

My lexers get "primitive" values. For example:

COMMA:
    ","
;
    
protected
DIGIT:
    '0'..'9'
;

protected
DOUBLE:
    INT '.' INT
;
    
protected
ID:
    (LETTER | '_') (DIGIT | LETTER | '_')*
    ;
    

...


My parsers make sure the words form structurally valid sentences:

model 
{
}
:
    object object
;

object
{
}
:
    LPAREN! OBJECT^
    typeid:ID 
    (
        param
    )*
    (
        attribute
    )* 
    RPAREN!
;

attribute
{
}
:
    ID^
    value 
;

...

And my trees make sure the parser doesn't return nonsense as well as check other "paragraph" structure:

pkg
{
        String component = null;
}
:!
    #(
        OBJECT
        pkgid:ID {pkgid.getText().equals("Class_Category")}? {## = #pkgid;}
        name:STRING {#pkgid.addChild(#name);}
            (
                {_t.getText().equals("logical_models")}? 
                    #(ID 
                        #(LIST ID {component = _t.getFirstChild().getText(); }
                            (   {(_t.getFirstChild() != null) && {(_t.getFirstChild().getText().equals("Class_Category"))}? p:pkg {#name.addChild(#p);}
                            |   {(_t.getFirstChild() != null) && {(_t.getFirstChild().getText().equals("Class"))}? c:clazz {#name.addChild(#c);}

...
                            )*
                        )
                    )
            |   {_t.getText().equals("statemachine")}? #(smid:ID sm:state_machine {#name.addChild(#smid); #smid.addChild(#sm);})
            |!  attr:attribute
            )+
        
    )
;

clazz
{
    int irCt = 0;
}
:!
    #(
        OBJECT
        clid:ID {## = #(#clid,#[ID,"Name"]);}
        name:STRING {#clid.getFirstChild().addChild(#name);}
        (   {_t.getText().equals("class_attributes")}?  
                #(atts:ID {#clid.addChild(#atts);}
                    #(LIST ID 
                        (
                            ca:class_attribute {#atts.addChild(#ca);}
                        )*
                    )
                )
        |   {_t.getText().equals("nestedClasses")}? 
                #(nc:ID {#clid.addChild(#nc);}
                    #(LIST ID 
                        (
                            c:clazz {#nc.addChild(#c);}
                        )*
                    )
                )
        |   {_t.getText().equals("superclasses")}? 
                #(sups:ID {#clid.addChild(#sups);}
                    #(LIST ID 
                        (
                            ir:inheritance_relationship {#sups.addChild(#ir);}
                        )*
                    )
                )
        |   {_t.getText().equals("statemachine")}? #(smid:ID sm:state_machine {#clid.addChild(#smid); #smid.addChild(#sm);})
        |!  attr:attribute! 
        )*
    )
;

class_attribute
{}
:!
    #(
        OBJECT
        attid:ID {attid.getText().equals("ClassAttribute")}? {## = #(#attid,#[ID,"Name"]);}
        name:STRING {#attid.getFirstChild().addChild(#name);}
        (
            {_t.getText().equals("type")}?
                #(id1:ID sv:STRING) {#attid.addChild(#id1); #id1.addChild(#sv);}
        |
            {_t.getText().equals("static")}?
                #(id2:ID bv1:BOOLEAN) {#attid.addChild(#id2); #id2.addChild(#bv1);}
        |
            {_t.getText().equals("derived")}?
                #(id3:ID bv2:BOOLEAN) {#attid.addChild(#id3); #id3.addChild(#bv2);}
        |! attribute
        )+
    )
;

 

Now I just gotta figure out a way to get the state of the tree without going to code (_t, etc.).

Jeff

From Kurt.E.McCall at nasa.gov  Wed Mar  8 14:30:34 2006
From: Kurt.E.McCall at nasa.gov (McCall, Kurt)
Date: Wed Mar  8 14:30:38 2006
Subject: [antlr-interest] ANTLR 2.7.6 on Tru64 Unix
Message-ID: <EAFC0B8AFC4E3B42934CECA5232E45DD03C31B59@msecho2.msfc.nasa.gov>


Just wanted to let you know, I was able to install 2.7.6 on a DEC Alpha
running Tru64 Unix (version V5.1, Rev. 732), compiled with Compac cxx
version V6.5-042.  The compiler is fairly up-to-date, but I think our OS
is somewhat old.  We haven't upgraded because the newest OS is
incompatible with some of our hardware.

I did the configuration with environmental variables and did not use
autoconf.  Here are two source code changes that were necessary to
create libantlr.a:

1.   Had to add #define __USE_STD_IOSTREAM to the top of CharBuffer.cpp
and String.cpp.  
2.   Had to add #include <locale> to the top of String.cpp, after the
change in (1).

It runs quite well! 

Kurt


There is a world that we know nothing about, that we can only imagine.
And that is the world of books.





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060308/2525c7d2/attachment.html
From andrew.bell.ia at gmail.com  Thu Mar  9 07:33:09 2006
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu Mar  9 07:33:13 2006
Subject: [antlr-interest] Rethrowing Exception?
Message-ID: <e80abd30603090733i36e285ccs33c3811d7e0ac2f5@mail.gmail.com>

Hi,

If an exception is found and handled during parsing, how can this
information best be passed to the function that first started the
parsing - so that you know that things failed other than getting a
message on your screen.

Thanks,

--
Andrew Bell
andrew.bell.ia@gmail.com
From parrt at cs.usfca.edu  Thu Mar  9 10:52:15 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Mar  9 10:52:20 2006
Subject: [antlr-interest] new AW and ANTLR release this weekend 
Message-ID: <BC780935-A19C-42CC-9C4D-361CE8EBFF90@cs.usfca.edu>

howdy...major improvements and fixes...soon to be yours.

Jean Bovet and I visit Apple's groovy dev group on Monday to show  
off. :)

Ter
From andrew.bell.ia at gmail.com  Thu Mar  9 11:28:33 2006
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu Mar  9 11:28:35 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
Message-ID: <e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>

On 3/8/06, Terence Parr <parrt@cs.usfca.edu> wrote:
> On Mar 8, 2006, at 8:54 AM, Jeff Barnes wrote:
> > Andy sez:
> > I realized that tree parsing is identical to text parsing, albeit
> > in two dimensions instead of one.
>
> I've been trying to scream that as loud as I can...not loud enough I
> guess. ;)  All v3 recognizers derive from same base class, so even in
> practice recog. is all the same thing: 1D or 2D :)
>
> > Jeff sez:
> >
> > LOL! I never got that either. To me, a tree seems multi-
> > dimensional; a table is two-dimensional. Terrence??
>
> a : ^(A B) ;
>
> is same as
>
> a : A DOWN B UP ;
>
> if you insert those imaginary navigation nodes, it is just a simple
> 1D grammar. :)  v3 does this.  Rather a nice generalization, right?

But aren't you parsing input _text_.  Isn't what this is all about? 
What do DOWN and UP do here?  Is there a token in the input called UP
or DOWN?  You aren't really parsing a tree, you are building a tree. 
You are parsing a 1-D input and producing a tree output, right?  What
am I missing here?

--
Andrew Bell
andrew.bell.ia@gmail.com
From parrt at cs.usfca.edu  Thu Mar  9 11:40:00 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Mar  9 11:40:03 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
Message-ID: <DE0C9F30-C240-4C1B-9EFA-C66F198F1F49@cs.usfca.edu>


On Mar 9, 2006, at 11:28 AM, Andrew Bell wrote:
>> a : ^(A B) ;
>>
>> is same as
>>
>> a : A DOWN B UP ;
>>
>> if you insert those imaginary navigation nodes, it is just a simple
>> 1D grammar. :)  v3 does this.  Rather a nice generalization, right?
>
> But aren't you parsing input _text_.

Hi.

nope

>   Isn't what this is all about?
> What do DOWN and UP do here?  Is there a token in the input called UP
> or DOWN?  You aren't really parsing a tree, you are building a tree.

we're talking about walking a tree here...

> You are parsing a 1-D input and producing a tree output, right?  What
> am I missing here?

This is the tree parser not parser creating trees.  Once you have a  
tree, you need to walk it either by hand or by grammar.  By grammar,  
you can serialize a tree by adding imaginary nodes UP and DOWN that  
encode 2D aspect.  Then you parse normally as a 1D stream of nodes.   
Char, token, tree node...same thing.  a stream of int types to parse :)

Ter
From mental at rydia.net  Thu Mar  9 12:10:12 2006
From: mental at rydia.net (mental@rydia.net)
Date: Thu Mar  9 12:10:59 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
Message-ID: <1141935012.44108ba439376@www.rydia.net>

Quoting Andrew Bell <andrew.bell.ia@gmail.com>:

> But aren't you parsing input _text_.  Isn't what this is all
> about?  What do DOWN and UP do here?  Is there a token in the
> input called UP or DOWN?

It's just a notional thing; they don't actually exist as tokens in
the grammar or in any real way in ANTLR.

It might help if you imagined an ordinary (1-d) rule where each
token were succeded by a navigation operation:

For example:

 a : A B C ;

could (notionally) be written:

 a : A NEXT B NEXT C NEXT ;

NEXT simply indicates the normal behavior of advancing to the next
token.

However, when your tokens happen to be nodes in a tree, there are
additional navigation possibilities.  You could still use NEXT to
advance to the next sibling token (i.e. node), but you also have:

 * UP - moves to the parent of the current node

 * DOWN - moves to the first child of the current node

This is a bit like the way that zippers unravel a tree into a
sequence of navigation operations, though through a different axis.

A 1-d sequence is simply a special case of a large family of data
structures.  In principle, given appropriate navigation primitives,
this approach to parsing could be generalized to pretty much any
acyclic data structure.

> You aren't really parsing a tree, you are building a tree.
> You are parsing a 1-D input and producing a tree output, right?
> What am I missing here?

In this case he really is talking about parsing one tree directly
and outputting another.

-mental
From mental at rydia.net  Thu Mar  9 12:15:44 2006
From: mental at rydia.net (mental@rydia.net)
Date: Thu Mar  9 12:15:47 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <1141935012.44108ba439376@www.rydia.net>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<1141935012.44108ba439376@www.rydia.net>
Message-ID: <1141935344.44108cf0811de@www.rydia.net>

Quoting mental@rydia.net:

> In principle, given appropriate navigation primitives,
> this approach to parsing could be generalized to pretty much any
> acyclic data structure.

Actually, I guess a directed, acyclic data structure is kind of a
tree by definition.  You can add more degrees of freedom, but a
tree is a tree is a tree...

-mental
From andrew.bell.ia at gmail.com  Thu Mar  9 12:36:47 2006
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu Mar  9 12:36:51 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <1141935012.44108ba439376@www.rydia.net>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<1141935012.44108ba439376@www.rydia.net>
Message-ID: <e80abd30603091236j20da6418hf608c03e042e949b@mail.gmail.com>

On 3/9/06, mental@rydia.net <mental@rydia.net> wrote:
> Quoting Andrew Bell <andrew.bell.ia@gmail.com>:
>
> For example:
>
>  a : A B C ;
>
> could (notionally) be written:
>
>  a : A NEXT B NEXT C NEXT ;
>
> NEXT simply indicates the normal behavior of advancing to the next
> token.
>
> However, when your tokens happen to be nodes in a tree, there are
> additional navigation possibilities.  You could still use NEXT to
> advance to the next sibling token (i.e. node), but you also have:
>
>  * UP - moves to the parent of the current node
>
>  * DOWN - moves to the first child of the current node
>
> This is a bit like the way that zippers unravel a tree into a
> sequence of navigation operations, though through a different axis.

I guess I wasn't clear.  Aren't we still talking about parsing a text
stream?  Or are we parsing something else -- some data structure that
is in the form of a tree.

--
Andrew Bell
andrew.bell.ia@gmail.com
From mental at rydia.net  Thu Mar  9 12:52:50 2006
From: mental at rydia.net (mental@rydia.net)
Date: Thu Mar  9 12:52:54 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <e80abd30603091236j20da6418hf608c03e042e949b@mail.gmail.com>
References: <440DD23C.4070300@jazillian.com>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>
	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<1141935012.44108ba439376@www.rydia.net>
	<e80abd30603091236j20da6418hf608c03e042e949b@mail.gmail.com>
Message-ID: <1141937570.441095a2a7b3c@www.rydia.net>

Quoting Andrew Bell <andrew.bell.ia@gmail.com>:

> I guess I wasn't clear.  Aren't we still talking about parsing a
> text stream?  Or are we parsing something else -- some data
> structure that is in the form of a tree.

The latter.  The point, though, is that ANTLR is useful for both
because one is more or less a special case of the other.

-mental
From Jeff.Barnes at codesic.com  Thu Mar  9 13:11:11 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Thu Mar  9 13:10:09 2006
Subject: [antlr-interest] Article against TreeWalkers
References: <440DD23C.4070300@jazillian.com><FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM><9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu><e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com><1141935012.44108ba439376@www.rydia.net><e80abd30603091236j20da6418hf608c03e042e949b@mail.gmail.com>
	<1141937570.441095a2a7b3c@www.rydia.net>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D95@hq-app2.CODESIC.COM>

One thing that really helped me get my first tree walker "out the door" was to use the AST frame. Helps to visualize the second dimension.
 
            ASTFrame frame = new ASTFrame("AST", tree.getAST());
            frame.setVisible(true);

 
From Jeff.Barnes at codesic.com  Thu Mar  9 14:14:14 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Thu Mar  9 14:13:13 2006
Subject: [antlr-interest] Article against TreeWalkers
References: <440DD23C.4070300@jazillian.com><FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM><9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu><e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<DE0C9F30-C240-4C1B-9EFA-C66F198F1F49@cs.usfca.edu>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D96@hq-app2.CODESIC.COM>

Andrew sez:
 
> You are parsing a 1-D input and producing a tree output, right?  What
> am I missing here?

Terence sez:

<snip> Once you have a 
tree, you need to walk it either by hand or by grammar.  By grammar, 
you can serialize a tree by adding imaginary nodes UP and DOWN that 
encode 2D aspect.  

Jeff sez:
 
So, why aren't there UP and DOWN tokens in the tree metalanguage? Or am I missing something? Methinks that would coolify a TreeWalker.
 
Regards,
Jeff

From parrt at cs.usfca.edu  Thu Mar  9 14:22:47 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Mar  9 14:22:51 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <FC6B2BF8B2FE854EAE0C380E55CA5734119D96@hq-app2.CODESIC.COM>
References: <440DD23C.4070300@jazillian.com><FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM><9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu><e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<DE0C9F30-C240-4C1B-9EFA-C66F198F1F49@cs.usfca.edu>
	<FC6B2BF8B2FE854EAE0C380E55CA5734119D96@hq-app2.CODESIC.COM>
Message-ID: <96D53595-AB15-4D04-9B2F-F9CAA3D9035B@cs.usfca.edu>


On Mar 9, 2006, at 2:14 PM, Jeff Barnes wrote:

> Andrew sez:
>
>> You are parsing a 1-D input and producing a tree output, right?  What
>> am I missing here?
>
> Terence sez:
>
> <snip> Once you have a
> tree, you need to walk it either by hand or by grammar.  By grammar,
> you can serialize a tree by adding imaginary nodes UP and DOWN that
> encode 2D aspect.
>
> Jeff sez:
>
> So, why aren't there UP and DOWN tokens in the tree metalanguage?

They are added for you so you can just give a nice tree grammar like:

expr : ^(PLUS expr expr)
	| INT
	;

> Or am I missing something? Methinks that would coolify a TreeWalker.

Tree grammars are cool :)

Ter
From Anthony.Youngman at eca-international.com  Fri Mar 10 01:45:13 2006
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Fri Mar 10 01:45:22 2006
Subject: [antlr-interest] languages without reserved words
Message-ID: <C7FE35004D40FD45AA342991B88CE404012901BF@lnml1.eca-international.local>

If I understand you correctly, you might find Rob Colquhoun's DATABASIC
grammar interesting. Let's take the following line in databasic ...

REM: REM = REM(6,4) ; REM this assigns the remainder of 6,4 to the
variable called REM

As you can see, I've used REM four times, in four different states,
namely label, identifier, function reference, and keyword! Different
dialects of databasic allow all four variants!

The way I think Rob has tackled it, and I certainly would, is a token
filter. Unfortunately that's not easy with v2 - I gather it should be a
lot easier with v3.

Okay, with the databasic language it's fairly easy, but the lexer simply
marks everything it recognises as a keyword, and the token filter
maintains state, flipping keywords into identifiers everywhere that a
keyword is not a legal option.

Cheers,
Wol

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Martin Probst
Sent: 02 March 2006 11:04
To: antlr-interest@antlr.org
Subject: Re: [antlr-interest] languages without reserved words

> is there a standard way or a best practice to implement grammars for
languages 
> that allow identifiers to be anything, including the keywords of the
language 
> itself?

There are several ways, and all of them suck somehow.
      * stateful lexing - create a lexer that keeps track of a lexical
        state and only check for keywords in certain states - pro: you
        always know what your token is - con: pretty complicated and
        messy to implement in ANTLR at the moment (might get better soon
        with island grammars!)
      * disambiguation with predicates - always return tokens as
        keywords, have a big rules called "identifier" that lists NCNAME
        and all your keywords, and then use syntactical predicates in
        the parser to work around the ambiguities. This is a little ugly
        and may be slow.
      * Wait for ANTLR 3 - in ANTLR 3 your problem might get solved
        without the syntactical predicates

Stateful lexing is nice because it keeps the complexity within the
lexer. But it means that you cannot just stop lexing somewhere in the
source file and restart lexing later - also handling lexical errors is a
lot more difficult.

Martin


* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From Anthony.Youngman at eca-international.com  Fri Mar 10 02:16:44 2006
From: Anthony.Youngman at eca-international.com (Anthony Youngman)
Date: Fri Mar 10 02:17:02 2006
Subject: [antlr-interest] Article against TreeWalkers
Message-ID: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local>

:-)

I had intended to send this reply in response to the switch/interface
post.

In my studies I came across something that said "only 50% progress from
concrete to abstract thought". Okay, I guess most of us here are in the
50% that have progressed.

But a switch statement is a far more concrete construct than an
interface. I'm fine with metadata, but I find Antlr pushing me into
realms I have problems with.

I guess what I'm trying to say is "Antlr is a complex tool. Some of its
advanced techniques may be beyond the ability of some people to
comprehend". It's in that context that the ability to provide a concrete
model for the weaker members to get their brain round is worth its
weight in gold.

Cheers,
Wol

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Jeff Barnes
Sent: 09 March 2006 21:11
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] Article against TreeWalkers

One thing that really helped me get my first tree walker "out the door"
was to use the AST frame. Helps to visualize the second dimension.
 
            ASTFrame frame = new ASTFrame("AST", tree.getAST());
            frame.setVisible(true);

 

* ************************************************************************ *

This transmission is intended for the named recipient only. It may contain private and confidential information. If this has come to you in error you must not act on anything disclosed in it, nor must you copy it, modify it, disseminate it in any way, or show it to anyone. Please e-mail the sender to inform us of the transmission error or telephone ECA International immediately and delete the e-mail from your information system.

Telephone numbers for ECA International offices are: Sydney +61 (0)2 8272 5300, Hong Kong + 852 2121 2388, London +44 (0)20 7351 5000 and New York +1 212 582 2333.

* ************************************************************************ *

From open.zone at virgin.net  Fri Mar 10 04:22:29 2006
From: open.zone at virgin.net (Micheal J)
Date: Fri Mar 10 04:05:49 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <440DD23C.4070300@jazillian.com>
Message-ID: <007001c6443d$4d85b560$6b02a8c0@hercules>

Andy,

> Well, I've done it again :)
> Wrote another article disagreeing with Terence.
> 
> It's called Manual Treewalking is Better than Tree Grammars: 
> http://jazillian.com/articles/treewalkers.html

Interesting article.

Leaving the Treewalking vs TreeGrammer issue to one side for a moment, what
advantage does manually developing your own treewalking code (a la
JavaEmitter.java) have over using a tool like TreeDL and one of the Visitor
pattern variants?


Cheers,

Micheal

From open.zone at virgin.net  Fri Mar 10 04:22:59 2006
From: open.zone at virgin.net (Micheal J)
Date: Fri Mar 10 04:06:23 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <440DD23C.4070300@jazillian.com>
Message-ID: <007101c6443d$60085350$6b02a8c0@hercules>

Andy,

> Well, I've done it again :)
> Wrote another article disagreeing with Terence.
> 
> It's called Manual Treewalking is Better than Tree Grammars: 
> http://jazillian.com/articles/treewalkers.html

Interesting article.

Leaving the Treewalking vs TreeGrammer issue to one side for a moment, what
advantage does manually developing your own treewalking code (a la
JavaEmitter.java) have over using a tool like TreeDL and one of the Visitor
pattern variants?


Cheers,

Micheal

From antlr at jazillian.com  Fri Mar 10 07:27:45 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Fri Mar 10 07:25:42 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <007001c6443d$4d85b560$6b02a8c0@hercules>
References: <007001c6443d$4d85b560$6b02a8c0@hercules>
Message-ID: <44119AF1.1070002@jazillian.com>

Micheal J wrote:

>
>Leaving the Treewalking vs TreeGrammer issue to one side for a moment, what
>advantage does manually developing your own treewalking code (a la
>JavaEmitter.java) have over using a tool like TreeDL and one of the Visitor
>pattern variants?
>  
>
I'm not sure, as I haven't tried TreeDL, or even writing a significant 
amount of "hand-code" to
manipulate ASTs. The JavaEmitter example I talk about in the article is 
obviously just printing out
the AST (i.e. walking only), not manipulating it.

But my general feeling is that yes, using TreeDL or some other 
AST-manipulation-tool would be better
than "hand-coding". I had looked into TXL in detail a long time ago, and 
also looked into DMS
from Semantic Designs.

 From what I remember about TXL, I thought it didn't go nearly far
enough in functionality. The examples where all completely trivial (e.g. 
"here's how to insert a typecast")
compared to what I needed ("Look at each variable reference to see if 
it's being used as a boolean
and if it's usually used as a boolean, change it's type to boolean, and 
at each reference where
it's not used as a boolean, change the expression so that the expression 
still works"). Yes, you could
"jump out" and do anything you want by hand-coding, but it seemed like 
I'd have to do that everywhere,
and thus not get much benefit from the tool.

DMS sounded like a nice, sophisticated framework that might be a good 
"engine" for building an
AST-maniplulating application on top of. But it was hard to evaluate it 
further without paying
tens of thousands of dollars to buy it or take a week-long course.

My test for any of these tools would be "Does it make it easier for me 
to change
'printf("%s\n", "Hello, World");'   to 'System.out.println("Hello, 
World");'  ?
If the tool isn't making stuff like that easier, then it's not helping.
(Take a few moments here and picture the two AST's here: it's not a 
trivial AST manipulation!)

So, in summary, my feeling is "If you're just going to walk the tree, 
just write the code to do it,
check out these tools first". But if I looked into TreeDL, I may end up 
saying "nah, just write your
own handful of tree-manipulation functions", I don't know.

Andy

From antlr at jazillian.com  Fri Mar 10 09:21:34 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Fri Mar 10 09:19:32 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local>
References: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local>
Message-ID: <4411B59E.4080301@jazillian.com>

Anthony Youngman wrote:

>:-)
>
>I had intended to send this reply in response to the switch/interface
>post.
>
>In my studies I came across something that said "only 50% progress from
>concrete to abstract thought". Okay, I guess most of us here are in the
>50% that have progressed.
>
>But a switch statement is a far more concrete construct than an
>interface. I'm fine with metadata, but I find Antlr pushing me into
>realms I have problems with.
>
>  
>
I'd like to replay the last 15 minutes of my life stream of conciousness...

I wonder what this whole "interfaces are better than switches" thing is 
about...must be a design pattern
...google "switch antipattern"...poke around a bit...Aha! The Strategy 
Pattern...break out the GoF
Design Patterns book...Strategy p315....read through the mumbo 
jumbo...OK, I got it, a big switch
statement can be hard to maintain when things get complicated, so you 
could create an interface,
many classes that each implement the interface and then each do their 
own thing rather than you doing it
all for them in a big switch.OK, that all sounds fine, but things aren't 
that complicated here. Each
switch case is quite trivial. Not worth it to get fancy here. I'll keep 
my big switch as is, and now add
Strategy to my list of Design Patterns that I think I understand :)
From parrt at cs.usfca.edu  Fri Mar 10 09:36:47 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Mar 10 09:36:49 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <4411B59E.4080301@jazillian.com>
References: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local>
	<4411B59E.4080301@jazillian.com>
Message-ID: <AB0D5122-77DD-44A5-A835-8EF304D68AE0@cs.usfca.edu>

On Mar 10, 2006, at 9:21 AM, Andy Tripp wrote:
> Anthony Youngman wrote:
>
> Design Patterns book...Strategy p315....read through the mumbo  
> jumbo...OK, I got it, a big switch
> statement can be hard to maintain when things get complicated, so  
> you could create an interface,
> many classes that each implement the interface and then each do  
> their own thing rather than you doing it
> all for them in a big switch.

hi, everybody!  Actually, I don't do that.  I create methods, one for  
each rule and switch on the lookahead to jump to the rule...not a big  
fan of lots of classes to do this for me--this is why I build tree  
recognizers not hand-built heterogeneous classes just to switch on  
token type.  Seems people are getting all sorts of stuff  
confused...got no time to clarify my position (hands still out of  
action too).

> OK, that all sounds fine, but things aren't that complicated here.  
> Each
> switch case is quite trivial. Not worth it to get fancy here. I'll  
> keep my big switch as is, and now add
> Strategy to my list of Design Patterns that I think I understand :)

Don't forget that lookahead computation is complicated by hand and in  
my experience people get it wrong.  Grammars allow automatic  
computation and more importantly warnings when you have specified  
something that would by hand go unnoticed.  Lookahead can change in  
one spot from changes elsewhere in the grammar you'll recall.  Do we  
really need to have the handbuilt parser vs grammar discussion in  
this group?  Perhaps we're not talking about parsing anymore...just  
coding.  if so, please move random coding discussions off the  
list...thanks!

Terence "if grammars are good enough for tokens, they're good enough  
for tree nodes" Parr
From dev at arabink.com  Fri Mar 10 09:46:11 2006
From: dev at arabink.com (Gregg Reynolds)
Date: Fri Mar 10 09:46:20 2006
Subject: tree v text parsing (was Re: [antlr-interest] Article against
	TreeWalkers)
In-Reply-To: <e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
References: <440DD23C.4070300@jazillian.com>	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
Message-ID: <4411BB63.1050704@arabink.com>

Andrew Bell wrote:
> On 3/8/06, Terence Parr <parrt@cs.usfca.edu> wrote:
>> On Mar 8, 2006, at 8:54 AM, Jeff Barnes wrote:
>>> Andy sez:
>>> I realized that tree parsing is identical to text parsing, albeit
>>> in two dimensions instead of one.
>> I've been trying to scream that as loud as I can...not loud enough I
>> guess. ;)  All v3 recognizers derive from same base class, so even in
>> practice recog. is all the same thing: 1D or 2D :)
>>

I notice from some other posts that there seems to be some confusion or
controversy about this idea of text v. tree parsing, so I'll take a stab
at it 'cause it's kinda fun.  I suspect people run into trouble with it
because they're thinking in concrete physical metaphors - an actual tree
structure, in 2d or 3d space.  But computational "trees" are not trees
at all - that's just a metaphor.  Nothing says we must construe trees in
2d space.  In fact, I'll wager most if not all mathematical structures
can be modeled as flat structures - what is a set, after all?  It's easy
to model a tree as a set, and therefore as a sequence, just like a
string of text.  (For that matter, even the "dimensionality" of a string
or sequence is metaphorical, a mapping between our experience of living
in physical space to the purely mathematical relations of sequences.)

It's easiest to see the fundamental unity of *all* parsing if one
focuses on the concepts of language and representation instead of the
metaphysics of things like "data structures" or the like.  Language is
inherently sequential, since time is at its core.  It also involves
"seeing" structure which only exists linguistically, but it remains
sequential.  (I'm not even sure what "2d language" would mean.)

Going from "text parsing" to "tree parsing" is no different than going
from lexing to parsing.  It's all just parsing, and one only ever parses
language utterances (texts, strings, whatever you want to call them).
The only way it even makes sense to talk about tree parsing is if one
construes a concrete tree as an expression in a language.

Consider:

a.	Bill is the father of Mary and John.

Text?  String?  Tree?  All of the above?  What about

b.	^(Bill Mary John)
c.	(father Bill (Mary John))
d.	Mary to John wa Biru ga papa desu
e.	Mary, John <-^ Bill
d.	...whatever syntax you please...

I see different strings that can be construed to mean the same thing.
They could all be either strings in a text or in a grammar. What those
strings represent ("mean") depends on the languages used to *interpret*
them.  The grammar provides structure; how one interprets the
metaphysics of that structure is a different thing.  Each of the above
strings could be interpreted as a representation of a tree or of the
parse structure of a  set of trees (a grammar).

So I guess I must quibble with Terence on one point:  I don't see the
need for 1d or 2d etc. to enter into it.  All parsing is the same.  Or
more accurately, all grammars map source sequences to target sequences,
  regardless of what the elements of those sequences represent.  Usually
the target sequences represent the interpretation of a hierarchical (2d)
structural grouping of source elements.  You could have an n-dimensional
tree, and still write a grammar for it that doesn't differ fundamentally
from a programming language grammar.

-gregg
From parrt at cs.usfca.edu  Fri Mar 10 10:01:32 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Mar 10 10:01:34 2006
Subject: tree v text parsing (was Re: [antlr-interest] Article against
	TreeWalkers)
In-Reply-To: <4411BB63.1050704@arabink.com>
References: <440DD23C.4070300@jazillian.com>	<FC6B2BF8B2FE854EAE0C380E55CA5734119D8F@hq-app2.CODESIC.COM>	<9152C12E-D1E1-43CE-B76C-B4143CA8A719@cs.usfca.edu>
	<e80abd30603091128w38ae5f1aud6ba1c04802164cd@mail.gmail.com>
	<4411BB63.1050704@arabink.com>
Message-ID: <2A7F03AF-7DC0-4619-8D9D-57D2D11A66F5@cs.usfca.edu>


On Mar 10, 2006, at 9:46 AM, Gregg Reynolds wrote:

> Andrew Bell wrote:

[snip]

Very well put.  recognition is recognition.

> So I guess I must quibble with Terence on one point:  I don't see the
> need for 1d or 2d etc. to enter into it.  All parsing is the same.  Or
> more accurately, all grammars map source sequences to target  
> sequences,
>   regardless of what the elements of those sequences represent.   
> Usually
> the target sequences represent the interpretation of a hierarchical  
> (2d)
> structural grouping of source elements.  You could have an n- 
> dimensional
> tree, and still write a grammar for it that doesn't differ  
> fundamentally
> from a programming language grammar.

Agreed...I'm "playing to my audience" a bit.  Parsing is about a  
stream of symbols; how you get the stream is up to you.  It's easy to  
say that you are taking a 2D structure like a tree and serializing to  
a node stream in 1D to help people understand how the tree parsing  
works. :)

Ter

From antlr at jazillian.com  Fri Mar 10 10:03:43 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Fri Mar 10 10:01:40 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <AB0D5122-77DD-44A5-A835-8EF304D68AE0@cs.usfca.edu>
References: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local>	<4411B59E.4080301@jazillian.com>
	<AB0D5122-77DD-44A5-A835-8EF304D68AE0@cs.usfca.edu>
Message-ID: <4411BF7F.7060904@jazillian.com>

Right, sorry, this discussion is off track onto switches vs. interfaces 
and the Strategy pattern.
Has nothing to do with treewalkers, and I didn't mean to imply anything 
about what Terence
might think on switch statements vs. interfaces.


Terence Parr wrote:

> On Mar 10, 2006, at 9:21 AM, Andy Tripp wrote:
>
>> Anthony Youngman wrote:
>>
>> Design Patterns book...Strategy p315....read through the mumbo  
>> jumbo...OK, I got it, a big switch
>> statement can be hard to maintain when things get complicated, so  
>> you could create an interface,
>> many classes that each implement the interface and then each do  
>> their own thing rather than you doing it
>> all for them in a big switch.
>
>
> hi, everybody!  Actually, I don't do that.  I create methods, one for  
> each rule and switch on the lookahead to jump to the rule...not a big  
> fan of lots of classes to do this for me--this is why I build tree  
> recognizers not hand-built heterogeneous classes just to switch on  
> token type.  Seems people are getting all sorts of stuff  
> confused...got no time to clarify my position (hands still out of  
> action too).
>
>> OK, that all sounds fine, but things aren't that complicated here.  Each
>> switch case is quite trivial. Not worth it to get fancy here. I'll  
>> keep my big switch as is, and now add
>> Strategy to my list of Design Patterns that I think I understand :)
>
>
> Don't forget that lookahead computation is complicated by hand and in  
> my experience people get it wrong.  Grammars allow automatic  
> computation and more importantly warnings when you have specified  
> something that would by hand go unnoticed.  Lookahead can change in  
> one spot from changes elsewhere in the grammar you'll recall.  Do we  
> really need to have the handbuilt parser vs grammar discussion in  
> this group?  Perhaps we're not talking about parsing anymore...just  
> coding.  if so, please move random coding discussions off the  
> list...thanks!
>
> Terence "if grammars are good enough for tokens, they're good enough  
> for tree nodes" Parr
>

From davemac2 at yahoo.com  Fri Mar 10 10:29:29 2006
From: davemac2 at yahoo.com (Dave McD)
Date: Fri Mar 10 10:29:31 2006
Subject: [antlr-interest] Is this mailing list/archives searchable?
Message-ID: <20060310182930.85125.qmail@web30506.mail.mud.yahoo.com>

Just wondering since I don't see a search interface here.  It would be very useful to have, especially to search the archives for questions that have already been answered.
   
  Dave Mc
   

			
---------------------------------
 Yahoo! Mail
 Use Photomail to share photos without annoying attachments.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060310/5f97dcd0/attachment.html
From davemac2 at yahoo.com  Fri Mar 10 10:32:55 2006
From: davemac2 at yahoo.com (Dave McD)
Date: Fri Mar 10 10:32:58 2006
Subject: [antlr-interest] Adding Utility Methods to a parser
Message-ID: <20060310183255.80385.qmail@web30508.mail.mud.yahoo.com>

I'm not all that familiar with Java and am new to ANTLR, so this may be obvious for other folks here.  Question: How can I add additional methods to the Parser class that ANTLR generates?  I want to define some utlity methods that I can use in my actions within the rules.  Or is there a better way to do this?
   
  thanks
   
  Dave Mc
   

		
---------------------------------
Yahoo! Mail
Bring photos to life! New PhotoMail  makes sharing a breeze. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060310/689d488a/attachment-0001.html
From sunjigang1965 at yahoo.com.cn  Fri Mar 10 11:29:00 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Fri Mar 10 11:29:05 2006
Subject: =?gb2312?q?=BB=D8=B8=B4=A3=BA=20[antlr-interest]=20Is=20this=20mailing=20?=
	=?gb2312?q?list/archives=20searchable=3F?=
In-Reply-To: <20060310182930.85125.qmail@web30506.mail.mud.yahoo.com>
Message-ID: <20060310192900.302.qmail@web15709.mail.cnb.yahoo.com>


--- Dave McD <davemac2@yahoo.com>:

> Just wondering since I don't see a search interface here.  It would be very useful to have,
> especially to search the archives for questions that have already been answered.
>    
>   Dave Mc
>    
> 
> 			
> ---------------------------------
>  Yahoo! Mail
>  Use Photomail to share photos without annoying attachments.



		
___________________________________________________________ 
 
http://cn.photos.yahoo.com
From sunjigang1965 at yahoo.com.cn  Fri Mar 10 11:45:43 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Fri Mar 10 11:45:48 2006
Subject: =?gb2312?q?=BB=D8=B8=B4=A3=BA=20[antlr-interest]=20Adding=20Utility=20Met?=
	=?gb2312?q?hods=20to=20a=20parser?=
In-Reply-To: <20060310183255.80385.qmail@web30508.mail.mud.yahoo.com>
Message-ID: <20060310194543.42383.qmail@web15708.mail.cnb.yahoo.com>

anywhere after your parser declaration, put your method definition in {}, e.g.

class MyParser extends Parser;
{
    public void  myMethod()
    {
         System.out.println("hello world");
    }
}

...

myGrammar:
   xxxx
   | yyyy { myMethod();}
   ;

...

Jigang 



--- Dave McD <davemac2@yahoo.com>:

> I'm not all that familiar with Java and am new to ANTLR, so this may be obvious for other folks
> here.  Question: How can I add additional methods to the Parser class that ANTLR generates?  I
> want to define some utlity methods that I can use in my actions within the rules.  Or is there a
> better way to do this?
>    
>   thanks
>    
>   Dave Mc
>    
> 
> 		
> ---------------------------------
> Yahoo! Mail
> Bring photos to life! New PhotoMail  makes sharing a breeze. 



		
____________________________________________________

From parrt at cs.usfca.edu  Fri Mar 10 12:32:55 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Mar 10 12:33:00 2006
Subject: [antlr-interest] Is this mailing list/archives searchable?
In-Reply-To: <20060310182930.85125.qmail@web30506.mail.mud.yahoo.com>
References: <20060310182930.85125.qmail@web30506.mail.mud.yahoo.com>
Message-ID: <3E091BDA-24DA-4EAF-9E6D-85C7E62E44B7@cs.usfca.edu>


On Mar 10, 2006, at 10:29 AM, Dave McD wrote:

> Just wondering since I don't see a search interface here.  It would  
> be very useful to have, especially to search the archives for  
> questions that have already been answered.
>

Hi.  The search box on antlr.org will include mailing list :)
Ter
From Jeff.Barnes at codesic.com  Fri Mar 10 12:50:32 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Fri Mar 10 12:49:29 2006
Subject: [antlr-interest] Article against TreeWalkers
References: <C7FE35004D40FD45AA342991B88CE404012901C0@lnml1.eca-international.local><4411B59E.4080301@jazillian.com>
	<AB0D5122-77DD-44A5-A835-8EF304D68AE0@cs.usfca.edu>
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D97@hq-app2.CODESIC.COM>

Terence said:

hi, everybody!  Actually, I don't do that.  I create methods, one for 
each rule and switch on the lookahead to jump to the rule...not a big 
fan of lots of classes to do this for me--this is why I build tree 
recognizers not hand-built heterogeneous classes just to switch on 
token type.  
 
I say:
You don't need lots of classes. You don't need a switch statement either. And frankly it's just not expensive to make first class objects out of TokenTypes. Instead of trying to describe the grammar using 3 levels of metadata, it can be described in relationships. Much prettier model. 
 
Regards,
Jeff
From sunjigang1965 at yahoo.com.cn  Fri Mar 10 14:21:36 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Fri Mar 10 14:21:41 2006
Subject: [antlr-interest] If I missed a "}" in a action...
Message-ID: <20060310222136.25078.qmail@web15710.mail.cnb.yahoo.com>

If I missed a "}" in a action follow a grammar alt, say on line 30, antlr tells me that } is
expected on the end of grammar file, say on line 300, instead of ;

Any improvement possible?

jigang


		
___________________________________________________________ 
 
http://cn.photos.yahoo.com
From mail at martin-probst.com  Fri Mar 10 15:37:43 2006
From: mail at martin-probst.com (Martin Probst)
Date: Fri Mar 10 15:37:51 2006
Subject: =?iso-8859-1?Q?=BB=D8=B8=B4=A3=BA_[antlr-interest]_Adding_Utility_Methods?=
	to a parser
In-Reply-To: <20060310194543.42383.qmail@web15708.mail.cnb.yahoo.com>
References: <20060310183255.80385.qmail@web30508.mail.mud.yahoo.com>
	<20060310194543.42383.qmail@web15708.mail.cnb.yahoo.com>
Message-ID: <14431.1671.213.93.6.164.1142033863.squirrel@webmailer.hosteurope.de>

> anywhere after your parser declaration, put your method definition in {},

Another way is to extend an abstract base parser. While that is still not
a very clean separation between Java code and parser rules you can at
least use your favorite Editor / IDE with all functionality on the Java
file.

class MyParser extends Parser("com.foo.bar.AbstractParser");
...
myGrammar:
   xxxx
   | yyyy { myMethod();}
   ;

From open.zone at virgin.net  Fri Mar 10 16:54:49 2006
From: open.zone at virgin.net (Micheal J)
Date: Fri Mar 10 16:38:04 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <FC6B2BF8B2FE854EAE0C380E55CA5734119D97@hq-app2.CODESIC.COM>
Message-ID: <009501c644a6$67414af0$6b02a8c0@hercules>

> I say:
> You don't need lots of classes. You don't need a switch 
> statement either. And frankly it's just not expensive to make 
> first class objects out of TokenTypes. Instead of trying to 
> describe the grammar using 3 levels of metadata, it can be 
> described in relationships. Much prettier model. 

Jeff,

A little too abstract for me so, coupla questions:

1. What are the 3 levels of metadata you mention is used to describe the
grammar?

2. Can you point to some code that illustrates your thinking (i.e.
describing the grammar in relationships)?.

Cheers,

Micheal

From antlr at klaashofstra.com  Fri Mar 10 17:47:24 2006
From: antlr at klaashofstra.com (Klaas Hofstra)
Date: Fri Mar 10 17:45:58 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <440DD23C.4070300@jazillian.com>
References: <440DD23C.4070300@jazillian.com>
Message-ID: <200603110247.24600.antlr@klaashofstra.com>

I have implemented a language translation system both with and without 
treeparsers. My problem with treeparsers is the mixing of grammar and logic, 
which might my considered a plus by others. 

For my implementation without treeparsers I was greatly influenced by the 
implementation of the Boo language, which uses ANTLR for parsing. Everyone 
who is looking for an alternative for treewalkers should have  a look at the 
Boo code. Just like Boo I use a small script (<100 lines of python code) to 
generate the heterogeneous classes and visitors/transformers. This approach 
has worked well for me and might work for others too.

Cheers,

Klaas Hofstra
From ewbank at gmail.com  Fri Mar 10 19:48:28 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar 10 19:48:30 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <200603110247.24600.antlr@klaashofstra.com>
References: <440DD23C.4070300@jazillian.com>
	<200603110247.24600.antlr@klaashofstra.com>
Message-ID: <dd3a065f0603101948r2fe58a96hd832225ec38edb9d@mail.gmail.com>

I looked around the boo source package, but was overwhelmed.  Can you
point out the python script?  This looks like a very handy technique.

Thanks,
- Bryan

On 3/10/06, Klaas Hofstra <antlr@klaashofstra.com> wrote:
> I have implemented a language translation system both with and without
> treeparsers. My problem with treeparsers is the mixing of grammar and logic,
> which might my considered a plus by others.
>
> For my implementation without treeparsers I was greatly influenced by the
> implementation of the Boo language, which uses ANTLR for parsing. Everyone
> who is looking for an alternative for treewalkers should have  a look at the
> Boo code. Just like Boo I use a small script (<100 lines of python code) to
> generate the heterogeneous classes and visitors/transformers. This approach
> has worked well for me and might work for others too.
>
> Cheers,
>
> Klaas Hofstra
>
From ewbank at gmail.com  Fri Mar 10 19:52:27 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar 10 19:52:29 2006
Subject: [antlr-interest] If I missed a "}" in a action...
In-Reply-To: <20060310222136.25078.qmail@web15710.mail.cnb.yahoo.com>
References: <20060310222136.25078.qmail@web15710.mail.cnb.yahoo.com>
Message-ID: <dd3a065f0603101952s10935c40p9c535eb21f60cb8a@mail.gmail.com>

What I do is to add a "}" at the end of the file, then bounce to the
matching "{" (in vi, that's the "%" key).  Hope this helps...

- Bryan

On 3/10/06,  Jigang (Robert) Sun <sunjigang1965@yahoo.com.cn> wrote:
>
> If I missed a "}" in a action follow a grammar alt, say on line 30, antlr
> tells me that } is
> expected on the end of grammar file, say on line 300, instead of ;
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060310/0e333fef/attachment.html
From jun.tsai at gmail.com  Fri Mar 10 20:11:14 2006
From: jun.tsai at gmail.com (Jun Tsai)
Date: Fri Mar 10 20:11:16 2006
Subject: [antlr-interest] Help me the chemmestry forumla grammer?
Message-ID: <86d374e30603102011v44ebc5dk@mail.gmail.com>

hi all.
I want to parse a chemestry forumla.such as:
A2(B3)2C3  => A2B6C3
A2(AB3)2C3 =>A4B6C3
A(CB3)2C3 =>A1B6C5

How to do it?

I use :
parser:

entry : (atom)+
      ;
atom : (c:CHAR n:NUM)
	{System.out.println("c:"+c.getText()+" ");}
	| (LPAREN entry RPAREN n:NUM)
	{
		System.out.println("okay "+n.getText());
	
	}

Lexer:

NUM :('0'..'9')*;


Thanks.
Jun Tsai
--
Welcome to China Java Users Group(CNJUG).
http://cnjug.dev.java.net
From antlr at klaashofstra.com  Sat Mar 11 05:35:46 2006
From: antlr at klaashofstra.com (Klaas Hofstra)
Date: Sat Mar 11 05:34:20 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <dd3a065f0603101948r2fe58a96hd832225ec38edb9d@mail.gmail.com>
References: <440DD23C.4070300@jazillian.com>
	<200603110247.24600.antlr@klaashofstra.com>
	<dd3a065f0603101948r2fe58a96hd832225ec38edb9d@mail.gmail.com>
Message-ID: <200603111435.46104.antlr@klaashofstra.com>

On Saturday 11 March 2006 04:48, Bryan Ewbank wrote:
> I looked around the boo source package, but was overwhelmed.  Can you
> point out the python script?  This looks like a very handy technique.
The boo code generation scripts (written in boo) and templates can be found in 
the scripts directory of the boo source distribution.

In my implementation I use a python script and a text file that defines the 
name/members/superclass of the heterogeneous classes.

Cheers,

Klaas
From jbb at acm.org  Sat Mar 11 09:28:03 2006
From: jbb at acm.org (John B. Brodie)
Date: Sat Mar 11 09:28:10 2006
Subject: [antlr-interest] Help me the chemmestry forumla grammer?
In-Reply-To: <86d374e30603102011v44ebc5dk@mail.gmail.com> (message from Jun
	Tsai on Sat, 11 Mar 2006 12:11:14 +0800)
References: <86d374e30603102011v44ebc5dk@mail.gmail.com>
Message-ID: <E1FI7sp-0005P5-00@gecko>

Jun Tsai wrote:
>hi all.

hi!

>I want to parse a chemestry forumla.such as:
>A2(B3)2C3  => A2B6C3
>A2(AB3)2C3 =>A4B6C3
>A(CB3)2C3 =>A1B6C5
>
>How to do it?

see attached. doing this was fun for me - thanks!. i've been away from
antlr for toooooo long....

hope this helps
   -jbb

(note i am using some new, to me, e-mail software, so if the
attachment doesn't work for you let me know and i'll try again)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Chemicals.g
Type: application/octet-stream
Size: 2205 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060311/ee123b87/Chemicals-0001.obj
From parrt at cs.usfca.edu  Sat Mar 11 12:58:23 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 11 12:58:27 2006
Subject: [antlr-interest] ANTLR 3.0ea8 released
Message-ID: <AB63F9A0-CBA8-4387-BA2E-BD54930AC6CF@cs.usfca.edu>

Howdy, 3.0ea8 is ready-to-eat:

	http://www.antlr.org/v3/index.html

or more directly for the impatient:

	http://www.antlr.org/download/antlr-3.0ea8.tar.gz

Huge number of bug fixes, clean up work:

	http://www.antlr.org/v3/README.txt

Includes among other stuff:

* the latest ST incorporation stuff like %foo(a={}...) for ST stuff  
in actions.

* $x[i]::y and $x[-i]::y notation for accesssing absolute scope stack
   indexes and relative negative scopes.  $x[-1]::y is the y attribute
   of the previous scope (stack top - 1).

* filter=true mode for lexers; can do this now...upon mismatch, just
   consumes a char and tries again:
lexer grammar FuzzyJava;
options {filter=true;}
FIELD
     :   TYPE WS? name=ID WS? (';'|'=')
         {System.out.println("found var "+$name.text);}
     ;

* added basic exception handling; no labels, just general catches:

* literals are now passed in the .tokens files so you can ref them in
   tree parses, for example.

Includes ANTLR 2.7.6 and ST 2.3b6 jars needed to run it.  Jean is  
working on ANTLRWorks 1.0ea8 which should be out today/tomorrow!

I updated the examples to ensure they work still with latest:

http://www.antlr.org/download/examples-v3.tar.gz

Wooohooo!!!  Getting closer...

Enjoy,
Ter
From antlr-list at arizona-software.ch  Sat Mar 11 14:23:20 2006
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sat Mar 11 14:23:30 2006
Subject: [antlr-interest] ANTLRWorks 3.0ea8 released
Message-ID: <710403D7-3420-439C-A743-E80E8A878848@arizona-software.ch>

Hello!

ANTLRWorks 1.0ea8 is now available:

http://www.antlr.org/works/index.html

This version fixes and improves several things. I would like to  
emphasis some new features:
- rule dependency graph
- display unreachable alternative in syntax diagram
- contextual menus in editor, syntax diagram, interpreter and debugger
- all visual graph can be exported to ps
- can now specify which tokens are to be ignored in the interpreter

The ANTLRWorks jar has everything you need including the latest  
version of ANTLR 3.0ea8 and StringTemplate 2.3b6.

Enjoy!

Jean


*** History ***

Version 1.0ea8 - 03/11/06

- new: rule dependency graph (can be exported to EPS or bitmap file)
- new: syntax coloring for generated Java code
- new: references, comments and strings are now colorized inside actions
- new: contextual menus in editor, syntax diagram, interpreter and  
debugger
- new: user can now specify tokens to be ignored in interpreter
- new: syntax colors can be changed in the preferences
- new: display of unreachable alternatives in the syntax diagram

- parse tree (interpreter/debugger) can now be scrolled by clicking  
and dragging the mouse
- new idea to convert invalid string literals to single quote literals
- new message in status bar if an error is reported in the console
- ctrl-k: now copy the deleted end of line to the system clipboard
- ctrl-t: now swap two characters (insert templates is now invoked  
using meta-k)
- click in the debug parse tree will show corresponding token in  
input stream and position in grammar
- kill the remote parser if the debugger cannot stop it (not  
applicable to remote parser)
- update the rules status and syntax diagram each time the grammar is  
analyzed (not only when using the Check Grammar command)
- improved ANTLR usage by running ANTLR only when necessary
- rules are now sorted in interpreter and debugger if they are sorted  
in the editor
- disabling syntax diagram now display a message
- now reload the tokenVocab file content when ANTLRWorks is back to  
front
- improved selection of a identifier
- improved word selection using the mouse: dragging the mouse without  
releasing the button
   now extends the selection word by word (as expected on Mac OS X)
- improved decision DFA diagram using more precise B-splines
- added an arrow at the end of each syntax diagram
- check grammar command now also analyzes the lexer part of a  
combined grammar
- improved current select path in syntax diagram when switching path  
visiblity
- improved syntax diagram display (colored label and smaller size)

- fixed a bug where auto-indentation would be applied for a ':' even  
inside an action block
- fixed a bug where some tokens were not properly colorized (cut and  
past the same token over itself)
- fixed a bug where the file content was not properly parsed if  
modified outside ANTLRWorks
- fixed a bug where the analysis indicator was colored improperly
- fixed a bug where Go To Character would be off by one character
- fixed a bug when reading the tokenVocab file (was missing the first  
character)
- fixed a bug where ANTLR would not be able to read the tokenVocab  
file (missing path)
- fixed a bug in the code generation (problem with grammar name)
- fixed a bug in the syntax diagram engine where a link from a rule  
to another rule would start at the wrong state
- fixed a bug in the syntax diagram path drawing where some paths  
were not correctly rendered

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060311/54b7b93a/attachment.html
From sunjigang1965 at yahoo.com.cn  Sat Mar 11 14:47:24 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Sat Mar 11 14:47:30 2006
Subject: RE [antlr-interest] ANTLR 3.0ea8 released
In-Reply-To: <AB63F9A0-CBA8-4387-BA2E-BD54930AC6CF@cs.usfca.edu>
Message-ID: <20060311224724.48340.qmail@web15706.mail.cnb.yahoo.com>

I am using 2.7.6, Should I switch to v3? Is v3 better?

Jigang 

--- Terence Parr <parrt@cs.usfca.edu>:

> Howdy, 3.0ea8 is ready-to-eat:
> 
> 	http://www.antlr.org/v3/index.html
> 
> or more directly for the impatient:
> 
> 	http://www.antlr.org/download/antlr-3.0ea8.tar.gz
> 
> Huge number of bug fixes, clean up work:
> 
> 	http://www.antlr.org/v3/README.txt
> 
> Includes among other stuff:
> 
> * the latest ST incorporation stuff like %foo(a={}...) for ST stuff  
> in actions.
> 
> * $x[i]::y and $x[-i]::y notation for accesssing absolute scope stack
>    indexes and relative negative scopes.  $x[-1]::y is the y attribute
>    of the previous scope (stack top - 1).
> 
> * filter=true mode for lexers; can do this now...upon mismatch, just
>    consumes a char and tries again:
> lexer grammar FuzzyJava;
> options {filter=true;}
> FIELD
>      :   TYPE WS? name=ID WS? (';'|'=')
>          {System.out.println("found var "+$name.text);}
>      ;
> 
> * added basic exception handling; no labels, just general catches:
> 
> * literals are now passed in the .tokens files so you can ref them in
>    tree parses, for example.
> 
> Includes ANTLR 2.7.6 and ST 2.3b6 jars needed to run it.  Jean is  
> working on ANTLRWorks 1.0ea8 which should be out today/tomorrow!
> 
> I updated the examples to ensure they work still with latest:
> 
> http://www.antlr.org/download/examples-v3.tar.gz
> 
> Wooohooo!!!  Getting closer...
> 
> Enjoy,
> Ter
> 



	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From parrt at cs.usfca.edu  Sat Mar 11 14:50:49 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 11 14:50:52 2006
Subject: RE [antlr-interest] ANTLR 3.0ea8 released
In-Reply-To: <20060311224724.48340.qmail@web15706.mail.cnb.yahoo.com>
References: <20060311224724.48340.qmail@web15706.mail.cnb.yahoo.com>
Message-ID: <A1345811-18A3-4925-99B4-57CB56587569@cs.usfca.edu>


On Mar 11, 2006, at 2:47 PM, ??? Jigang (Robert) Sun wrote:

> I am using 2.7.6, Should I switch to v3? Is v3 better?

When it has documentation and doesn't crash on bad input, yes, it  
will be better :)  Read the pages for v3 and you will achieve  
enlightenment

Ter
From sunjigang1965 at yahoo.com.cn  Sat Mar 11 17:54:45 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Sat Mar 11 17:54:54 2006
Subject: [antlr-interest] ??? launching ANTLRWorks
Message-ID: <20060312015445.54231.qmail@web15708.mail.cnb.yahoo.com>


I do not understand the words:

Make sure ANTLR 3 is in your CLASSPATH and then launch ANTLRWorks
using "java org.antlr.works.IDE".

of http://www.antlr.org/works/doc/readme.txt

I installed antlr v3 in D:\antlr-3.0ea8, antlrWorks in D:\antlrWorks. I typed following command
that does work:

D:\antlrWorks\org\antlr\works>java -cp D:\antlr-3.0ea8\lib\antlr-3.0ea8.jar  IDE.class
Exception in thread "main" java.lang.NoClassDefFoundError: IDE/class

D:\antlrWorks\org\antlr\works>

Operating system of my computer is Windows xp.

Cheers.

Jigang


		
___________________________________________________________
 
 

From jsamort at rogers.com  Sun Mar 12 08:51:26 2006
From: jsamort at rogers.com (Scott Amort)
Date: Sun Mar 12 08:51:33 2006
Subject: [antlr-interest] TokenStreamRewriteEngine question
Message-ID: <1142182286.28156.11.camel@localhost>

Hi All,

I am using a TokenStreamRewriteEngine to discard unwanted whitespace and
comments, while still retaining the original file contents for debug and
error messages.  However, I have noticed that within my lexer, I
'prediscard' a number of other characters, such as double-quotes,
backslashes, etc.  These latter types are necessary to define certain
tokens, but I don't want them actually passed on to the parser, so I
have lexer defines like:

TAG
: '\\'! IDENT
;

Where IDENT is an alphanumeric identifier.  What I have noticed,
however, is that the backslash character never makes it to the rewrite
engine, and so, is missing from the output of originalToStream.

A possible solution to this is to not have my lexer do as much
'parsing', and just be concerned with more basic token types, but once I
do that I get a wide variety of non-determinism errors.  There are
actually only three characters that I discard in the lexer - the equals
sign, double-quotes and the backslash.  Is there an easier way to have
these included, or do I have to redesign my lexer?  Thanks!

Best,
Scott

From parrt at cs.usfca.edu  Sun Mar 12 11:02:55 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 12 11:02:58 2006
Subject: [antlr-interest] TokenStreamRewriteEngine question
In-Reply-To: <1142182286.28156.11.camel@localhost>
References: <1142182286.28156.11.camel@localhost>
Message-ID: <323342C9-EEBB-417F-8D06-C9646DEFE145@cs.usfca.edu>


On Mar 12, 2006, at 8:51 AM, Scott Amort wrote:

> Hi All,
>
> I am using a TokenStreamRewriteEngine to discard unwanted  
> whitespace and
> comments, while still retaining the original file contents for  
> debug and
> error messages.  However, I have noticed that within my lexer, I
> 'prediscard' a number of other characters, such as double-quotes,
> backslashes, etc.  These latter types are necessary to define certain
> tokens, but I don't want them actually passed on to the parser, so I
> have lexer defines like:
>
> TAG
> : '\\'! IDENT
> ;
>
> Where IDENT is an alphanumeric identifier.  What I have noticed,
> however, is that the backslash character never makes it to the rewrite
> engine, and so, is missing from the output of originalToStream.

Yep.  don't mod the token stream...v3 doesn't have this problem...

> A possible solution to this is to not have my lexer do as much
> 'parsing', and just be concerned with more basic token types, but  
> once I

a good strategy...

> do that I get a wide variety of non-determinism errors.  There are

can u use syn preds?

Ter

From parrt at cs.usfca.edu  Sun Mar 12 11:22:31 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 12 11:22:36 2006
Subject: [antlr-interest] Exceptions and finally blocks
Message-ID: <9EEED65A-7F9E-46AF-BD31-80ED231DA506@cs.usfca.edu>

hi,

  I'm running into this very strange Java behavior, which I believe  
is considered normal but it does not give us what we want.   when an  
exception is thrown in a method it still tries to execute the finally  
of course. However, when an exception occurs usually it means that  
this stuff in the finally clause will not execute without its own  
exception. This second exception forces the first exception to be  
lost. It is very confusing because you see an exception in the  
finally when all of those variables should be okay but you get null  
pointer.

  should I add the following:

catch (Exception e) {
..handle exception..perhaps noUserFinally=true;
throw e;
}
finally {
   usual cleanup
   if ( !noUserFinally ) { user stuff }
...
}

Hmm.... this is turning out to be a serious problem for me as I  
developed my Mantra language with version three. Very very   
annoying.  Suggestions?

Ter
From scott at javadude.com  Sun Mar 12 11:38:07 2006
From: scott at javadude.com (Scott Stanchfield)
Date: Sun Mar 12 11:38:21 2006
Subject: [antlr-interest] Exceptions and finally blocks
In-Reply-To: <9EEED65A-7F9E-46AF-BD31-80ED231DA506@cs.usfca.edu>
Message-ID: <200603121923.k2CJNNlJ007585@s2.eroute.net>

heheh... Fun stuff. The trick is that Java only allows one pending
exception. I usually handle it something like this (useful for jdbc close,
for example)

Throwable pendingThrowable = null;
Connection connection = null;
try {
  try {
    connection = ... // open connection
    // do database stuff
  } catch(Throwable t) {
    pendingThrowable = t;
  } 

} finally {
  try {
    if (connection != null) {
      connection.close();
    }
  } catch(Throwable t) {
    if (pendingThrowable != null) {
      throw pendingThrowable;
    }
    throw t;
  }
}

Lovely, ain't it? Gotta fix this when I write my language...

Hope this helps a bit...
-- Scott


> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Terence Parr
> Sent: Sunday, March 12, 2006 2:23 PM
> To: antlr-interest Interest
> Subject: [antlr-interest] Exceptions and finally blocks
> 
> hi,
> 
>   I'm running into this very strange Java behavior, which I believe  
> is considered normal but it does not give us what we want.   when an  
> exception is thrown in a method it still tries to execute the 
> finally of course. However, when an exception occurs usually 
> it means that this stuff in the finally clause will not 
> execute without its own exception. This second exception 
> forces the first exception to be lost. It is very confusing 
> because you see an exception in the finally when all of those 
> variables should be okay but you get null pointer.
> 
>   should I add the following:
> 
> catch (Exception e) {
> ..handle exception..perhaps noUserFinally=true; throw e; } finally {
>    usual cleanup
>    if ( !noUserFinally ) { user stuff }
> ...
> }
> 
> Hmm.... this is turning out to be a serious problem for me as I  
> developed my Mantra language with version three. Very very   
> annoying.  Suggestions?
> 
> Ter
> 


From parrt at cs.usfca.edu  Sun Mar 12 11:41:20 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 12 11:41:25 2006
Subject: [antlr-interest] Exceptions and finally blocks
In-Reply-To: <200603121923.k2CJNNlJ007585@s2.eroute.net>
References: <200603121923.k2CJNNlJ007585@s2.eroute.net>
Message-ID: <AED107F3-4FE3-42A9-944F-F08994705868@cs.usfca.edu>

Yep, was thinking that or wrapping exception or someting...i like  
this pending thing.thanks
T
On Mar 12, 2006, at 11:38 AM, Scott Stanchfield wrote:

> heheh... Fun stuff. The trick is that Java only allows one pending
> exception. I usually handle it something like this (useful for jdbc  
> close,
> for example)
>
> Throwable pendingThrowable = null;
> Connection connection = null;
> try {
>   try {
>     connection = ... // open connection
>     // do database stuff
>   } catch(Throwable t) {
>     pendingThrowable = t;
>   }
>
> } finally {
>   try {
>     if (connection != null) {
>       connection.close();
>     }
>   } catch(Throwable t) {
>     if (pendingThrowable != null) {
>       throw pendingThrowable;
>     }
>     throw t;
>   }
> }
>
> Lovely, ain't it? Gotta fix this when I write my language...
>
> Hope this helps a bit...
> -- Scott
>
>
>> -----Original Message-----
>> From: antlr-interest-bounces@antlr.org
>> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Terence Parr
>> Sent: Sunday, March 12, 2006 2:23 PM
>> To: antlr-interest Interest
>> Subject: [antlr-interest] Exceptions and finally blocks
>>
>> hi,
>>
>>   I'm running into this very strange Java behavior, which I believe
>> is considered normal but it does not give us what we want.   when an
>> exception is thrown in a method it still tries to execute the
>> finally of course. However, when an exception occurs usually
>> it means that this stuff in the finally clause will not
>> execute without its own exception. This second exception
>> forces the first exception to be lost. It is very confusing
>> because you see an exception in the finally when all of those
>> variables should be okay but you get null pointer.
>>
>>   should I add the following:
>>
>> catch (Exception e) {
>> ..handle exception..perhaps noUserFinally=true; throw e; } finally {
>>    usual cleanup
>>    if ( !noUserFinally ) { user stuff }
>> ...
>> }
>>
>> Hmm.... this is turning out to be a serious problem for me as I
>> developed my Mantra language with version three. Very very
>> annoying.  Suggestions?
>>
>> Ter
>>
>
>

From antlr-list at arizona-software.ch  Sun Mar 12 11:55:41 2006
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sun Mar 12 11:55:52 2006
Subject: [antlr-interest] ??? launching ANTLRWorks
In-Reply-To: <20060312015445.54231.qmail@web15708.mail.cnb.yahoo.com>
References: <20060312015445.54231.qmail@web15708.mail.cnb.yahoo.com>
Message-ID: <79E7091D-9AC2-4A01-9F51-0000E50AD894@arizona-software.ch>

I would suggest to launch ANTLRWorks using the jar file because it  
contains everything needed to run ANTLRWorks:

java -jar antlrworks-1.0ea8.jar

Now, if you really want to launch ANTLRWorks by hand, I would cd  
before the "org" directory and type something like (don't write the  
class extension after IDE):

java -cp D:\antlr-3.0ea8\lib\antlr-3.0ea8.jar:.  org.antlr.works.IDE

Make sure also to include in the classpath ANTLR 2.7.6 and  
StringTemplate if they are not included in the ANTLR 3 jar.

Hope this help

Jean

On Mar 11, 2006, at 5:54 PM, ??? Jigang (Robert) Sun wrote:

>
> I do not understand the words:
>
> Make sure ANTLR 3 is in your CLASSPATH and then launch ANTLRWorks
> using "java org.antlr.works.IDE".
>
> of http://www.antlr.org/works/doc/readme.txt
>
> I installed antlr v3 in D:\antlr-3.0ea8, antlrWorks in D: 
> \antlrWorks. I typed following command
> that does work:
>
> D:\antlrWorks\org\antlr\works>java -cp D:\antlr-3.0ea8\lib 
> \antlr-3.0ea8.jar  IDE.class
> Exception in thread "main" java.lang.NoClassDefFoundError: IDE/class
>
> D:\antlrWorks\org\antlr\works>
>
> Operating system of my computer is Windows xp.
>
> Cheers.
>
> Jigang
>
>
> 		
> ___________________________________________________________
>
> ?????????????
>

From voytechs at yahoo.com  Sun Mar 12 12:19:14 2006
From: voytechs at yahoo.com (Mark Bednarczyk)
Date: Sun Mar 12 12:18:58 2006
Subject: [antlr-interest] Appropriate pattern for interpreter
Message-ID: <03f801c64612$3bedbe70$6401a8c0@marksdesktop>

I enjoyed reading the article and thead hread with pros and cons
of TreeWalkers by Andy Tripp, but I'm still not sure where my
preference lies. I have implemented my own language (NPL -
Network Protocol Language) geared toward describing network
protocol structure using manual Lexer/Parser and then the
Visitor pattern. This is an interpreted language executed
directly from the AST.
 
I'm redoing the interpreter and I have already replaced
Lexer/Parser using ANTLR grammar which is actually a superset of
java.g grammar since NPL 90% based on java syntax.
 
 
One thing I really don't like about the Visitor pattern is that
the Linker and the Decoder which both use the Visitor pattern,
are huuuugggggeeee. Too big for my taste. I like to break things
up into smaller more managable pieces. It seems to me that the
TreeWalker aproach is simply going to produce a huge TreeWalker
file with the mix of languages.
 
Andy's approach of looking things up in the AST seems simple on
the surface, but from my experience I could not do it. I had to
pass around state using parameters and some global (within the
class) structures.
 
The NPL syntax if very rich, all the java statements,
conditianals and operators plus a number of custom ones thrown
in. Stuffing all this logic into a single file is really going
to bloat it, no way around that.
 
Are there other algorithmic patters that I should consider? I
really only know of the TreeWalker and the Visitor. Is there
anything else that might work better for an interpreter?
 
One of the things I've considered is simply cross compiling NPL
into java. I'm kind'of afraid of going the TreeWalker approach
since the syntax seems complex, the file is going to end up
being huge and I've gained huge amount of experience with the
Visitor pattern approach (whether I like it or not.)
 
You guys have all the experience in the world here. I really
would aprechiate some insight or direction from experienced
compiler guru.
 
Linker.java source:  http://tinyurl.com/f4jx2
Decoder.java source:   http://tinyurl.com/z27hs 
Project pages: http://jnetstream.sourceforge.net
 
Cheers,
mark....
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060312/224e590d/attachment.html
From parrt at cs.usfca.edu  Sun Mar 12 12:53:15 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 12 12:53:45 2006
Subject: [antlr-interest] Exceptions and finally blocks
In-Reply-To: <200603121923.k2CJNNlJ007585@s2.eroute.net>
References: <200603121923.k2CJNNlJ007585@s2.eroute.net>
Message-ID: <4D15D227-B4E3-4D6C-ABF7-EE5A1CFBACF3@cs.usfca.edu>


On Mar 12, 2006, at 11:38 AM, Scott Stanchfield wrote:
> Throwable pendingThrowable = null;
> Connection connection = null;
> try {
>   try {
>     connection = ... // open connection
>     // do database stuff
>   } catch(Throwable t) {
>     pendingThrowable = t;
>   }
>
> } finally {
>   try {
>     if (connection != null) {
>       connection.close();
>     }
>   } catch(Throwable t) {
>     if (pendingThrowable != null) {
>       throw pendingThrowable;
>     }
>     throw t;
>   }
> }
>
> Lovely, ain't it? Gotta fix this when I write my language...

Ok, tried this out and Java makes me put "throws Throwable" on EVERY  
FREAKIN METHOD.  Literally...almost all runtime methods can  
eventually call something that might throw an exception.  Java makes  
me say "throws Throwable" so we're sunk...i'm not putting that on  
every method in my program.  Stupid java.

ok, i'm going to simply allow the user to specify default catch stuff  
for rules:

@rulecatch {
catch (...) {...}
catch (...) {...}
}

The user can add that to the grammar and it will override all rule  
catch stuff.  As you can see the exceptions on a rule will override  
the default.

<if(exceptions)>
     <exceptions:{e|<catch(decl=e.decl,action=e.action)><\n>}>
<else>
<if(!emptyRule)>
<if(actions.(actionScope).rulecatch)>
<actions.(actionScope).rulecatch>
<else>
     catch (RecognitionException re) {
         reportError(re);
         recover(input,re);
     }<\n>
<endif>
<endif>
<endif>

Is rulecatch the right name?

Ter
From parrt at cs.usfca.edu  Sun Mar 12 12:57:12 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 12 12:57:15 2006
Subject: [antlr-interest] example rulecatch
Message-ID: <D7FDD1DC-1347-4B56-AC38-5C6B1B7249FA@cs.usfca.edu>

grammar Mantra;

@rulecatch {
catch (RecognitionException re) {
     reportError(re);
     recover(input,re);
}
catch (Throwable t) {
     System.err.println(t);
}
}

At least now exceptions are not lost...

Ter
From jun.tsai at gmail.com  Sun Mar 12 17:42:03 2006
From: jun.tsai at gmail.com (Jun Tsai)
Date: Sun Mar 12 17:42:08 2006
Subject: [antlr-interest] How to catch error message.
Message-ID: <86d374e30603121742p204bee92y@mail.gmail.com>

hi all,
  In my grammer,I find some error message not excpetion was thrown.How to
catch the exception.
Such as I have a grammer to count the chemistry formula. When I input
"Na(OH" ,no exception was thrown,But I find some error message in
console.How to catche the message?

====Code ===
header {
package poison.antlr;
import java.io.StringReader;
import java.util.HashMap;
import java.util.TreeSet;
import java.util.TreeMap;
import java.util.Comparator;
import java.util.List;
import java.util.Arrays;
}
/**
 * Convert Chemical Forumal.
 * Co3-H5-Al8  => H5Al8Co3
 * Al3(AlH3)3Al => H9Al7
 * Al3-(AlH3)3Al => H9Al7
 * Al3(AlH3)3Al.4H2Al => H17Al11
*  Thank Jbb
 * @author Jun Tsai
 */
class ChemicalsParser extends Parser;
{
    public static String getFormulaMerged(String str) throws
RecognitionException, TokenStreamException{
        final ChemicalsLexer lexer =  new ChemicalsLexer(new
StringReader(str));
        final ChemicalsParser parser =  new ChemicalsParser(lexer);

        return parser.entry().getFormulaMerged();
    }
    public static void main(String [] args) {
        final String [] inputs=  {
            "(Co4)3C24-H72-(H2Co2)2Co-N12-O9-P62Cl",        // >
C24Cl1Co17H76N12O9P62
            "(Co4)3C24-H72-(H2Co2)2Co-N12-O9-P62Cl.5Cl8F9",        // >
C24Cl41Co17F45H76N12O9P62
            "Co3-H5-Al8",       // > Al8Co3H5
            "Al3(AlH3)3Al", //   H9Al7
            "Al3-(AlH3)3Al", // H9Al7
            "Al3(AlH3)3Al.4H2Al" //H17Al11
        };

        for (String s : inputs) {
            try {
                System.out.format("about to parse: `%s` ", s);
                final ChemicalsLexer lexer =  new ChemicalsLexer(new
StringReader(s));
                final ChemicalsParser parser =  new ChemicalsParser(lexer);

                parser.entry().print();

            } catch( Exception e ) {
                e.printStackTrace();
            }
        }

    }
    /**
    * Periodic Table
    */
    public static final class Table extends TreeMap<PeriodicElement,Integer>
{

        public final void print() {

            System.out.println(getFormulaMerged());
        }
        public final String getFormulaMerged(){
            TreeSet<PeriodicElement> sorted_Keys =  new
TreeSet<PeriodicElement>(keySet());
            StringBuffer sb=new StringBuffer();
            for (PeriodicElement key : sorted_Keys) {
                sb.append(String.format("%s%s", key.getName(),get(key)));
            }
            return sb.toString();
        }
        public final int getMolecularWeight(){
            TreeSet<PeriodicElement> sorted_Keys =  new
TreeSet<PeriodicElement>(keySet());
            int weight=0;
            for (PeriodicElement key : sorted_Keys) {
                System.out.println("key:"+key.getValue());
                weight+=key.getValue();
            }
            return weight;
        }

        public final void merge(Table m) {
            for (PeriodicElement key : m.keySet()) {
                final int v=  m.get(key);
                if (containsKey(key)) {
                    int old = get(key);
                    put(key, old + v);
                } else {
                    put(key,v);
                }
            }
        }

        public final void update(int n) {
            for (PeriodicElement key : keySet()) {
                final int v = get(key);
                put(key, n * v);
            }
        }

    }
     private static final class PeriodicElement implements
            Comparable<PeriodicElement> {
        private String name;

        private int value;

        public static final List<String> list = Arrays.asList(new String[] {
                "H", "He", "Li", "Be", "B", "C", "N", "O", "F", "Ne", "Na",
                "Mg", "Al", "Si", "P", "S", "Cl", "Ar", "K", "Ca", "Sc",
"Ti",
                "V", "Cr", "Mn", "Fe", "Co", "Ni", "Cu", "Zn", "Ga", "Ge",
                "As", "Se", "Br", "Kr", "Rb", "Sr", "Y", "Zr", "Nb", "Mo",
                "Tc", "Ru", "Rh", "Pd", "Ag", "Cd", "In", "Sn", "Sb", "Te",
                "I", "Xe", "Cs", "Ba", "La", "Ce", "Pr", "Nd", "Pm", "Sm",
                "Eu", "Gd", "Tb", "Dy", "Ho", "Er", "Tm", "Yb", "Lu", "Hf",
                "Ta", "W", "Re", "Os", "Ir", "Pt", "Au", "Hg", "Tl", "Pb",
                "Bi", "Po", "At", "Rn", "Fr", "Ra", "Ac", "Th", "Pa", "U",
                "Np", "Pu", "Am", "Cm", "Bk", "Cf", "Es", "Fm", "Md", "No",
                "Lr", "Rf", "Db", "Sg", "Bh", "Hs", "Mt" });

        public PeriodicElement(String name) {
            this.name = name;
            this.value=list.indexOf(name)+1;
        }

        public String getName() {
            return name;
        }
        public int getValue(){
            return this.value;
        }
        public int compareTo(PeriodicElement o) {

            return this.value - o.value;
        }

        @Override
        public boolean equals(Object obj) {
            if(obj instanceof PeriodicElement){
                return this.value == (((PeriodicElement) obj).getValue());
            }else{
                return false;
            }
        }

    }


}

entry returns [ Table e = null; ] :
        e=expression EOF
        ;
expression returns [ Table v = null ] :
       v=term
         ( { final int c; final Table t; }
           DOT c=count t=term
           { t.update(c); v.merge(t); }
         )*
   ;
term returns [ Table v =  new Table() ] :
        ( { final Table a; } a=atom { v.merge(a); } )+
    ;

atom returns [ Table v = null ] :
          ( { final int n2; }
            LPAREN v=expression RPAREN n2=count
            { v.update(n2); }
        )
        |
        ( { final String b; final int n1; }
            b=base n1=count
            { v =  new Table(); v.put(new PeriodicElement(b),n1); }
        )

    ;

base returns [ String c= null ] : x:CHAR { c =  x.getText(); } ;

count returns [ int v = 1 ] :
        ( n:NUM { v=Integer.parseInt(n.getText()); } )?
    ;

/**
 *
 * @author Jun Tsai
 */
class ChemicalsLexer extends Lexer;
options { k=2;}
CHAR :
"H"|"He"|"Li"|"Be"|"B"|"C"|"N"|"O"|"F"|"Ne"|"Na"|"Mg"|"Al"|"Si"|"P"|"S"|"Cl"|"Ar"|"K"|"Ca"|"Sc"|"Ti"|"V"


|"Cr"|"Mn"|"Fe"|"Co"|"Ni"|"Cu"|"Zn"|"Ga"|"Ge"|"As"|"Se"|"Br"|"Kr"|

"Rb"|"Sr"|"Y"|"Zr"|"Nb"|"Mo"|"Tc"|"Ru"|"Rh"|"Pd"|"Ag"|"Cd"|"In"|"Sn"|"Sb"|"Te"|"I"|"Xe"|


"Cs"|"Ba"|"La"|"Ce"|"Pr"|"Nd"|"Pm"|"Sm"|"Eu"|"Gd"|"Tb"|"Dy"|"Ho"|"Er"|"Tm"|"Yb"|"Lu"|"Hf"|


"Ta"|"W"|"Re"|"Os"|"Ir"|"Pt"|"Au"|"Hg"|"Tl"|"Pb"|"Bi"|"Po"|"At"|"Rn"|

"Fr"|"Ra"|"Ac"|"Th"|"Pa"|"U"|"Np"|"Pu"|"Am"|"Cm"|"Bk"|"Cf"|"Es"|"Fm"|"Md"|"No"|"Lr"|"Rf"|"Db"|"Sg"|"Bh"|"Hs"|"Mt";


protected DIGIT : '0'..'9' ;
NUM : ( DIGIT )+ ;
DOT:'.';
LPAREN : '(' ;
RPAREN : ')' ;
WS     :
    (' '
    | '\t'
    |'-'
    | '\r' '\n' { newline(); }
    | '\n'      { newline(); }
    )
    { $setType(Token.SKIP); }
  ;


====End ===

--
Welcome to China Java Users Group(CNJUG).
http://cnjug.dev.java.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060313/44f82b26/attachment-0001.html
From jbarnesweb at yahoo.com  Mon Mar 13 01:42:46 2006
From: jbarnesweb at yahoo.com (Jeff Barnes)
Date: Mon Mar 13 01:42:49 2006
Subject: [antlr-interest] Article against TreeWalkers
In-Reply-To: <009501c644a6$67414af0$6b02a8c0@hercules>
Message-ID: <20060313094247.14378.qmail@web54504.mail.yahoo.com>



--- Micheal J <open.zone@virgin.net> wrote:

> 
> 1. What are the 3 levels of metadata you mention is
> used to describe the
> grammar?
>

Sure, 3 levels of metadata refers to the different
tiers of metadata. The OMG provides a better
discussion in
http://www.omg.org/docs/formal/00-04-03.pdf (pages 2-2
and 2-3; they call it 4-layer and I call it 3-levels +
data) than i could provide in a post.
 
> 2. Can you point to some code that illustrates your
> thinking (i.e.
> describing the grammar in relationships)?.

The following document illustrates 3 different design
patterns that illustrate my
thinking.http://www.geocities.com/jbarnesweb/fsmsurvey.pdf

I favor the Fowler pattern illustrated last. The
InputSymbolType maps to the first class TokenType I
was talking about.

Regards,
Jeff



=========
Jeff Barnes
(206)245-6100


Few things are impossible to diligence and skill.
--- Samuel Johnson (Rasselas Chap. xii.)
From demakov at ispras.ru  Mon Mar 13 02:33:35 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Mon Mar 13 02:33:58 2006
Subject: [antlr-interest] TreeDL way (was: Article against TreeWalkers)
References: <440DD23C.4070300@jazillian.com>
Message-ID: <020c01c64689$95546dc0$8cc79553@marlboro>

Hi all,

My project, TreeDL (http://treedl.sf.net), is mentioned in the article 
"Manual Tree Walking Is Better Than Tree Grammars" 
by Andy Tripp. I generally agree with this statement
but can't agree with the context:
>The mapping from one AST structure to another is quite complex
>(see XSLT, TXL, or TreeDL for example), and a single BNF-like 
>grammar doesn't capture it.

TreeDL is not for AST transformations, but for AST description
(as a structure of heterogenous tree) and for generation of code
from this AST description. It generates classes for AST node types
and for tree processing: base visitors, walkers, factories etc
- all code that is defined by AST structure.

We've compared homogenous vs heterogenous trees and
ways of tree processing in this list long time ago, just after 
"Translators Should Use Tree Grammars" article was published:
http://www.antlr.org/pipermail/antlr-interest/2004-November/thread.html

Mentioned in this article advantages of tree grammars 
(over visitors and other approaches to tree processing) exist only if
tree grammars have good tool support and other approaches don't have one.
But homogenous trees processing without tool support are much more dangerous
than heterogenous trees processing!

So, why to write additional AST description?

1. It is interface to results of parsing. Not all developers
need to look at antlr parser - with predicates, error recovery,
tree construction code (btw, it is most complicated part of antlr language 
- count percent of questions about tree construction in this list)
AST description is very clear: 
http://treedl.sourceforge.net/frontend/java5/treedl/com/unitesk/java5/Java5.tdl-xref/index.html

2a. It is source of code generation. You need not write depth-first
walker by hands and update it on each AST change - just re-generate it.

2b. It allows additional checking of tree processing code to compensate
well-known disadvantages (of visitors). For example, it is possible to
define operation over tree:

operation Object compute( virtual Expression expr, SymbolTable table )
{
  case( MinusExpression expr, table ): 
  { 
    return   (Integer)compute( expr.getLeft() )
           - (Integer)compute( expr.getRight() ); 
  }

  case( ConditionalExpression expr, table ): 
  { 
    return   (Boolean)compute( expr.getConditional() )
           ?   compute( expr.getThen() )
             : compute( expr.getElse() ); 
  }
  case( NameExpression expr, table )
  {
    return table.getValue( expr.getName() );
  }
  ...
}

Tool will check that operation case is defined for each inheritor of Expression.
So, when new expression type will be added, you will get reminder that
compute() operation should be updated. Note, in contrast to visitors
you can define additional parameters and result type.

3. Generated tree can implement any tree interface you need, including
homogenous interface (for example, ANTLR Node). It allows to process
tree using various approaches.

4. Tree can be created without parser. For example, it can be model in MVC pattern.
And you can use the same text generation library (StringTemplate?) for this model.

Analogies of TreeDL in XML world are binding APIs that create
classes for given schema to represent XML documents.
I don't know is there binding API that generate something in addition to node classes.
XML parser can be generated automaticly (advantage of standard syntax)
and we need to write parser with actions for tree creation.
Luckily, it is very straightforward code.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com

From digitale at digitaleric.net  Mon Mar 13 11:54:52 2006
From: digitale at digitaleric.net (Eric Northup)
Date: Mon Mar 13 12:04:46 2006
Subject: [antlr-interest] parsing dynamic infix operators
Message-ID: <1142279692.18544.100.camel@souvenir>

Hi all,

I need to parse a language where the list of operators can change
dynamically (as in ML or Prolog).  For example, after a statement

:- operator(400, yfx, ~).

// 400 is the precedence
// yfx means an infix, left-associative operator
// ~ is the newly bound operator name

the fragment

foo(5~6, X~Y~Z)

would be parsed as:
foo(~(5,6), ~(~(X,Y),Z))

or, after the statements

:- operator(500, yfx, plus).
:- operator(400, yfx, times).
:- operator(300, fy, cos).
:- operator(200, yf, squared).

the fragment

X plus cos Y times cos (cos Z) squared

would parse as:

plus(X, times(cos(Y), cos(squared(cos(Z)))))



As in Prolog, the operator types (xfx,yfx,xfy,fx,fy,yf,xf) specify
the operators arity and associativity.

f: the operator (required)
x: this sub-expression must be of lower precedence than f's
y: this sub-expression must be of less than or equal precedence than
   f's

For example : fy is a recursive prefix operator, but fx is a
non-recurisve prefix operator.

Any expression enclosed in parenthesis has a precedence of zero.



An operator-precedence parser which pushes tokens on a stack while
precedence is decreasing seems like the obvious way to go.  It seems
like it might be possible to do this in ANTLR with syntactic and/or
semantic predicates, but it's not immediately clear to me how this
would work.

The best I've come up with would use semantic predicates to check
whether the precedence matches as expected, but would continue
checking other alternatives if the check failed (see ***).
Something along the lines of the grammar sketched below:

pattern returns [int precedence]
        {int arg1, arg2}
        : ATOM { precedence=0; }
        | '(' pattern ')' { precedence=0; }
        | fx:ATOM arg1=pattern { is_fxoperator(fx.getText())
                                 && opr_prec(fx.getText()) <= arg1 }?
                                // ***
                                // if the above check fails, I'd like
                                // to continue checking other matching
                               { precedence = opr_prec(fx.getText(); }

        | arg1=pattern xfy:ATOM arg1=pattern
              { is_xfyoperator(xfy.getText())
                && opr_prec(xfy.getText()) < arg1
                && opr_prec(xfy.getText()) <= arg2}?
                // ***
              { precedence = opr_prec(fx.getText(); }
        | ... // other productions


Alternately, I could use syntactic predicates, but there doesn't
seem to be a way to add native code checks to them (checking that
the precedence is decreasing).

Does anyone have suggestions for persuading ANTLR to parse such a
language?

-Eric

From priya.uky at gmail.com  Mon Mar 13 12:24:28 2006
From: priya.uky at gmail.com (Priya)
Date: Mon Mar 13 12:24:35 2006
Subject: [antlr-interest] Adding attributes
Message-ID: <2b8e23150603131224t64cff186i23b28cab0de2ddd6@mail.gmail.com>

Hello Everybody,
Can anyone throw light on "How to add attributes to a node  of an
Abstract Syntax Tree?"
Thanks in advance
Priya
From parrt at cs.usfca.edu  Mon Mar 13 14:06:50 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 13 14:06:56 2006
Subject: [antlr-dev] Re: [antlr-interest] Exceptions and finally blocks
In-Reply-To: <!&!AAAAAAAAAAAuAAAAAAAAAGzpMNnTzs5AqxLyQkwLpfsBALNszDMqMpBPj6PeE0ojUzYAAAAANCkAABAAAAApQbG6/eRYSqDMBfvRpHenAQAAAAA=@intersystems.com>
References: <!&!AAAAAAAAAAAuAAAAAAAAAGzpMNnTzs5AqxLyQkwLpfsBALNszDMqMpBPj6PeE0ojUzYAAAAANCkAABAAAAApQbG6/eRYSqDMBfvRpHenAQAAAAA=@intersystems.com>
Message-ID: <43AEBD9B-7DD8-4122-85CE-740176D4E787@cs.usfca.edu>


On Mar 13, 2006, at 2:00 PM, Jim Idle wrote:

> What you need is something that can parser java and rewrite the  
> methods with
> throws throwable on it ;-)
>
> However, the replacement you suggest is a lot easier to implement for
> languages that don't throw anything other than core dumps, such as  
> C ;-)
>
> I find nothing objectionable to @rulecatch myself.= for what it is  
> worth.

Groovy..also answers a request from users to be able to specify a  
default catch set.

Ter
From jose.ventura.roda at gmail.com  Mon Mar 13 23:48:27 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Mon Mar 13 23:48:30 2006
Subject: Fwd: [antlr-interest] Adding attributes
In-Reply-To: <e39abda10603132347x577ac168x@mail.gmail.com>
References: <2b8e23150603131224t64cff186i23b28cab0de2ddd6@mail.gmail.com>
	<e39abda10603132347x577ac168x@mail.gmail.com>
Message-ID: <e39abda10603132348v16b1012ek@mail.gmail.com>

 You can extend te CommonAST class. There is an example in antlr called
ASTSupport that show how you can create nodes derived from CommonAST.

Regards,


2006/3/13, Priya <priya.uky@gmail.com>:
>
> Hello Everybody,
> Can anyone throw light on "How to add attributes to a node  of an
> Abstract Syntax Tree?"
> Thanks in advance
> Priya
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/7b725fee/attachment.html
From jose.ventura.roda at gmail.com  Mon Mar 13 23:49:51 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Mon Mar 13 23:49:55 2006
Subject: [antlr-interest] Adding attributes
In-Reply-To: <e39abda10603132347x577ac168x@mail.gmail.com>
References: <2b8e23150603131224t64cff186i23b28cab0de2ddd6@mail.gmail.com>
	<e39abda10603132347x577ac168x@mail.gmail.com>
Message-ID: <e39abda10603132349w36963f68p@mail.gmail.com>

You can extend te CommonAST class. There is an example in antlr called
ASTSupport that show how you can create nodes derived from CommonAST.

Regards,


2006/3/13, Priya <priya.uky@gmail.com>:
>
> Hello Everybody,
> Can anyone throw light on "How to add attributes to a node  of an
> Abstract Syntax Tree?"
> Thanks in advance
> Priya
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/ebe79d39/attachment.html
From prashant.deva at gmail.com  Tue Mar 14 01:49:41 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Tue Mar 14 01:49:44 2006
Subject: [antlr-interest] Looking for ANT build files....
Message-ID: <41fed8f80603140149n42c76fc2h21868da61969719c@mail.gmail.com>

I am doing some research and I need to take a look at some complex ANT build
files.
Now I can easily get build files for apps from sourceforge, but I cant seem
to get hold of any for websites.

If any of you have got any old build files lying around from any of your
projects, especially some website, it would be great if you can send them to
me.

Thanks,
--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/49f2d8fa/attachment.html
From mark.kattenbelt at gmail.com  Tue Mar 14 02:40:59 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Tue Mar 14 02:41:03 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0
Message-ID: <44169DBB.2000403@gmail.com>

Hello,

I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 2005, 
so far unsuccessfully.
In mingw, I manage to compile it fine, only took a few minutes to set 
up! I use the following settings for VS:

Include dir: "lib\cpp"
Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
Run-time library: Multi-treaded debug.
Create precompiled headers: yes.
Function level linking: yes.
RTTI: yes.

Which results into compiling with the following line:

/O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" /D 
"ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
/Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" /nologo /c 
/TP /errorReport:prompt

And linking with:

/OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL /MANIFEST 
/MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
/ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib 
winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
oleaut32.lib uuid.lib odbc32.lib odbccp32.lib

Now this fails during the linking stage, in particular it keeps finding 
symbols that are defined in multiple places:

ASTFactory.obj : error LNK2005: "class std::basic_istream<char,struct 
std::char_traits<char> > & __cdecl antlr::eatwhite(class 
std::basic_istream<char,struct std::char_traits<char> > &)" 
(?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
already defined in ANTLRUtil.obj
ASTFactory.obj : error LNK2005: "class std::basic_string<char,struct 
std::char_traits<char>,class std::allocator<char> > __cdecl 
antlr::read_string(class std::basic_istream<char,struct 
std::char_traits<char> > &)" ...

I have tried to compile without precompiled headers, because I do not 
see the need for them, this results in:

MismatchedCharException.obj : error LNK2005: "public: static int const 
antlr::MismatchedCharException::CHAR" 
(?CHAR@MismatchedCharException@antlr@@2HB) already defined in 
CharScanner.obj
MismatchedCharException.obj : error LNK2005: "public: static int const 
antlr::MismatchedCharException::NOT_CHAR" 
(?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
CharScanner.obj
MismatchedCharException.obj : error LNK2005: "public: static int const 
antlr::MismatchedCharException::RANGE" 
(?RANGE@MismatchedCharException@antlr@@2HB) already defined in 
CharScanner.obj

Clearly I am doing something wrong, and the settings need tweaking. Has 
anyone here managed to build antlr (2.7.6?) with Visual Studio (8.0?). 
If so could you please share your settings? Any help is appreciated.

Also, trying to compile it into a static library does not offer any 
relief, the errors still persist.

Cheers,

Mark Kattenbelt



From enriquebris at cimex.com.cu  Tue Mar 14 06:37:33 2006
From: enriquebris at cimex.com.cu (enriquebris@cimex.com.cu)
Date: Tue Mar 14 05:35:59 2006
Subject: [antlr-interest] nongreedy parsing, how Can I?
Message-ID: <7D750FF0E5E0984AB6FAA93D62E197F606080991@email1.cimex.com.cu>

I?m trying to write a parser rule like this 

 

rule : (OTAG) (.)?{some code...} (CTAG)

 

The problem is that the (.)? eats all characters including CTAG (>). I try with (options greedy=false) but with no changes. What can I do to solve this?

 

 

in the lexer :

 

OTAG : '<';

CTAG : '>';

 

 

Enrique

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/9af18984/attachment.html
From stanio at myrealbox.com  Tue Mar 14 07:41:58 2006
From: stanio at myrealbox.com (Stanimir Stamenkov)
Date: Tue Mar 14 07:42:02 2006
Subject: [antlr-interest] nongreedy parsing, how Can I?
In-Reply-To: <7D750FF0E5E0984AB6FAA93D62E197F606080991@email1.cimex.com.cu>
References: <7D750FF0E5E0984AB6FAA93D62E197F606080991@email1.cimex.com.cu>
Message-ID: <4416E446.7060406@myrealbox.com>

/enriquebris@cimex.com.cu/:

> rule : (OTAG) (.)?{some code?} (CTAG)
> 
> The problem is that the (.)? eats all characters including CTAG (>).

The (.)? will match a CTAG also, and then the rule will try to match 
one more CTAG. I guess you need to use (~CTAG)? which will match any 
token except CTAG.

-- 
Stanimir
From brade at informatik.uni-muenchen.de  Tue Mar 14 07:38:42 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Tue Mar 14 07:45:01 2006
Subject: [antlr-interest] TreeParser transform examples
Message-ID: <200603141638.50186.brade@informatik.uni-muenchen.de>

Hi,

I'm having quite some trouble building a tree parser that outputs another and 
thus has buildAST=true set. I did not find any examples that are extensive 
and that do that. Any ideas? The Calc example shipped with antlr is far too 
simple.

One question I cannot figure out for instance: how do I add more children to 
the output AST being generated by a rule in another action?

This does not work:

structured_term!: #(NS_LABEL #(PREFIX prefix:NCNAME)
                             #(LOCAL   label:NCNAME)
                    {
                      ## = #([OPERATORS,"operators"],
                               #([TYPE_SEL,"type"], [STRING,"tree"]),
                               #([NAMESPACE_SEL,"namespace"], prefix),
                               #([LABEL_SEL,"label"], label),
                            );
                    }
                    t:children
                    {
                      ##.addChild( #([STRING,"TEST-NODE"]) );  // NOPE!!! :(
                    }
                   )
                ;

The addChild call puts a 
structured_term_AST = (AST)currentAST.root;
in the generated code right before the addChild call and spoils all the fun.

Hints?

Thanks,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/61695d31/attachment.bin
From jose.ventura.roda at gmail.com  Tue Mar 14 08:31:39 2006
From: jose.ventura.roda at gmail.com (Jose Ventura)
Date: Tue Mar 14 08:31:42 2006
Subject: [antlr-interest] TreeParser transform examples
In-Reply-To: <200603141638.50186.brade@informatik.uni-muenchen.de>
References: <200603141638.50186.brade@informatik.uni-muenchen.de>
Message-ID: <e39abda10603140831w5fb89f3en@mail.gmail.com>

If I understand you, you want add STRING AST in OPERATORS.
I don't test this code, but you can try anything also:

structured_term!:
                 * {AST aux=null;}*
                   #(NS_LABEL #(PREFIX prefix:NCNAME)
                            #(LOCAL   label:NCNAME)
                   {
                     ## = #([OPERATORS,"operators"],
                              #([TYPE_SEL,"type"], [STRING,"tree"]),
                              #([NAMESPACE_SEL,"namespace"], prefix),
                              #([LABEL_SEL,"label"], label),
                           );
                    * aux=##;
*                   }
                   t:children
                   {
*                      aux.addChild (#([STRING,"TEST-NODE"]));
*                   }
                  )
               ;

Regards,
Jos? Ventura

2006/3/14, Michael Brade <brade@informatik.uni-muenchen.de>:
>
> Hi,
>
> I'm having quite some trouble building a tree parser that outputs another
> and
> thus has buildAST=true set. I did not find any examples that are extensive
> and that do that. Any ideas? The Calc example shipped with antlr is far
> too
> simple.
>
> One question I cannot figure out for instance: how do I add more children
> to
> the output AST being generated by a rule in another action?
>
> This does not work:
>
> structured_term!: #(NS_LABEL #(PREFIX prefix:NCNAME)
>                             #(LOCAL   label:NCNAME)
>                    {
>                      ## = #([OPERATORS,"operators"],
>                               #([TYPE_SEL,"type"], [STRING,"tree"]),
>                               #([NAMESPACE_SEL,"namespace"], prefix),
>                               #([LABEL_SEL,"label"], label),
>                            );
>                    }
>                    t:children
>                    {
>                      ##.addChild( #([STRING,"TEST-NODE"]) );  // NOPE!!!
> :(
>                    }
>                   )
>                ;
>
> The addChild call puts a
> structured_term_AST = (AST)currentAST.root;
> in the generated code right before the addChild call and spoils all the
> fun.
>
> Hints?
>
> Thanks,
> --
> Michael Brade;                 KDE Developer, Student of Computer Science
> |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
> ?--web: http://www.kde.org/people/michaelb.html
>
> KDE 4: Beyond Your Expectations
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/cc234ed2/attachment.html
From Gerald.Khin at ids-scheer.com  Tue Mar 14 08:47:35 2006
From: Gerald.Khin at ids-scheer.com (Khin, Gerald)
Date: Tue Mar 14 08:49:49 2006
Subject: [antlr-interest] maven-antlr-plugin compatibility of antlrall.jar
	and antlr.jar?
Message-ID: <7CD50CE878D92841A224D410B2B2DF0B6BA418@049SBEVS1.me.corp.ids-scheer.com>

Hi!
 
There is an antlrall-2.7.4.jar used by maven-antlr-plugin in
http://www.ibiblio.org/maven2/antlr/antlrall/
<http://www.ibiblio.org/maven2/antlr/antlrall/>  whereas 2.7.4 is the
highest version number available for that antlrall jar. But in
http://www.ibiblio.org/maven2/antlr/antlr/
<http://www.ibiblio.org/maven2/antlr/antlr/>  there is also an
antlr-2.7.5.jar and an antlr-2.7.6.jar. Now, I wonder if the code built
with the buildtime antlrall-2.7.4.jar is compatible with the runtime
libraries antlr-2.7.5.jar or antlr-2.7.6.jar?
 
Regards
Gerald
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/66447864/attachment.html
From antlr at jazillian.com  Tue Mar 14 09:05:15 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Tue Mar 14 09:03:09 2006
Subject: [antlr-interest] TreeDL way
In-Reply-To: <020c01c64689$95546dc0$8cc79553@marlboro>
References: <440DD23C.4070300@jazillian.com>
	<020c01c64689$95546dc0$8cc79553@marlboro>
Message-ID: <4416F7CB.2010209@jazillian.com>

Alexey Demakov wrote:

> Hi all,
>
> My project, TreeDL (http://treedl.sf.net), is mentioned in the article 
> "Manual Tree Walking Is Better Than Tree Grammars" by Andy Tripp. I 
> generally agree with this statement
> but can't agree with the context:
>
>> The mapping from one AST structure to another is quite complex
>> (see XSLT, TXL, or TreeDL for example), and a single BNF-like grammar 
>> doesn't capture it.
>
>
Hi Alexey,
Yea, I guess I shouldn't mentioned TreeDL. Thanks for correcting that - 
I'll take it out.
As you can see, I was just trying to list a few technologies relating to 
tree-transformation.

As for the rest of your comments, I just have one place where I'm very 
sceptical:

>
> 2a. It is source of code generation. You need not write depth-first
> walker by hands and update it on each AST change - just re-generate it.

I'm not sure exactly what you're claiming here. You're not saying that, 
for example,
I could change ANTLR to produce a different AST structure for Java code 
input,
and have whatever AST-processing I've written still work correctly, are you?

I mean, if the AST structure changes, whatever code is written that does 
something
with that AST (whether just print it, change it, or whatever) is now broken.

Andy
From mike at doublevdesign.co.uk  Tue Mar 14 09:26:15 2006
From: mike at doublevdesign.co.uk (Mike Ventham)
Date: Tue Mar 14 09:26:28 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0
In-Reply-To: <44169DBB.2000403@gmail.com>
References: <44169DBB.2000403@gmail.com>
Message-ID: <7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>

Mark,

If it is any help, I built a static library (.lib) using 2.7.6 with 
the command line.

/Od /I "C:\Development\antlr\antlr-2.7.6\lib\cpp\\" /D "WIN32" /D 
"_DEBUG" /D "_LIB" /D "_CRT_SECURE_NO_DEPRECATE" /D 
"_VC80_UPGRADE=0x0600" /D "_MBCS" /FD /EHsc /RTC1 /MDd /Zc:wchar_t- 
/Zc:forScope- /GR- /Fp".\Debug/antlr_lib.pch" /Fo".\Debug/" 
/Fd".\Debug/" /FR".\Debug\\" /W3 /nologo /c /Z7 /errorReport:prompt

There is a change in TokenStreamRewriteEngine.cpp (already submitted to Ter)

#ifndef NO_STATIC_CONSTS
const size_t TokenStreamRewriteEngine::MIN_TOKEN_INDEX = 0;
const int TokenStreamRewriteEngine::PROGRAM_INIT_SIZE = 100;
#endif


At 10:40 14/03/2006, Mark Kattenbelt wrote:
>Hello,
>
>I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 
>2005, so far unsuccessfully.
>In mingw, I manage to compile it fine, only took a few minutes to 
>set up! I use the following settings for VS:
>
>Include dir: "lib\cpp"
>Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
>Run-time library: Multi-treaded debug.
>Create precompiled headers: yes.
>Function level linking: yes.
>RTTI: yes.
>
>Which results into compiling with the following line:
>
>/O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" 
>/D "ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
>/Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" /nologo 
>/c /TP /errorReport:prompt
>
>And linking with:
>
>/OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL 
>/MANIFEST 
>/MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
>/ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib 
>winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
>oleaut32.lib uuid.lib odbc32.lib odbccp32.lib
>
>Now this fails during the linking stage, in particular it keeps 
>finding symbols that are defined in multiple places:
>
>ASTFactory.obj : error LNK2005: "class 
>std::basic_istream<char,struct std::char_traits<char> > & __cdecl 
>antlr::eatwhite(class std::basic_istream<char,struct 
>std::char_traits<char> > &)" 
>(?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
>already defined in ANTLRUtil.obj
>ASTFactory.obj : error LNK2005: "class std::basic_string<char,struct 
>std::char_traits<char>,class std::allocator<char> > __cdecl 
>antlr::read_string(class std::basic_istream<char,struct 
>std::char_traits<char> > &)" ...
>
>I have tried to compile without precompiled headers, because I do 
>not see the need for them, this results in:
>
>MismatchedCharException.obj : error LNK2005: "public: static int 
>const antlr::MismatchedCharException::CHAR" 
>(?CHAR@MismatchedCharException@antlr@@2HB) already defined in CharScanner.obj
>MismatchedCharException.obj : error LNK2005: "public: static int 
>const antlr::MismatchedCharException::NOT_CHAR" 
>(?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>CharScanner.obj
>MismatchedCharException.obj : error LNK2005: "public: static int 
>const antlr::MismatchedCharException::RANGE" 
>(?RANGE@MismatchedCharException@antlr@@2HB) already defined in CharScanner.obj
>
>Clearly I am doing something wrong, and the settings need tweaking. 
>Has anyone here managed to build antlr (2.7.6?) with Visual Studio 
>(8.0?). If so could you please share your settings? Any help is appreciated.
>
>Also, trying to compile it into a static library does not offer any 
>relief, the errors still persist.
>
>Cheers,
>
>Mark Kattenbelt
>
>
>


Regards

Mike


Mike Ventham
Chief Technical Consultant
Double V Design & Support Services
Email : mike@doublevdesign.co.uk


From crackajaxx at gmail.com  Tue Mar 14 11:48:07 2006
From: crackajaxx at gmail.com (Aaron)
Date: Tue Mar 14 11:48:10 2006
Subject: [antlr-interest] Expression parser expecting token at EOF
Message-ID: <2fb2e54f0603141148j2cd3f84eo8c98c994443d5cd3@mail.gmail.com>

I apologize if this is the wrong forum for this message, but I'm still
new here (so punt me the right direction if need be).  I've written a
parser for what I think is a relatively simple grammar for
expressions.  I'm using antlr 2.7.5 with C# as the language.

I noticed that when I provided the input "test" to the expression
element that it would fail when attempting to do a lookahead(1).  So I
narrowed the problem down to the variant element that is listed in the
grammer and reduced the variant element to only allow one expression
for ease of reading.

I wrote a small C# wrapper around this that calls variant() on the parser.

The sample works for the inputs "test(20)" and "test[20]", but fails for "test".
The problem appears to be in the output code to "variantAtoms" which
performs a switch(LA(1)) and then requires a token to be present or it
throws NoViableAltException and my execution is done.

Ironically, if I enter "test)" it works.  variantAtom has a case
statement for RPAREN and for the life of me I can't understand where
in the tree it would expect to see RPAREN as the next token.

Thanks in advance...

----------

class KExprParser extends Parser;
options
{
    buildAST = true;
}

tokens
{
    UNARY_MINUS; UNARY_PLUS;
}

expression
    :    assignmentExpression
    ;

assignmentExpression
    :    logicalOrExpression
    ;

logicalOrExpression
    :    logicalAndExpression ("or"^ logicalAndExpression)*
    ;

logicalAndExpression
    :    eqExpression ("and"^ eqExpression)*
    ;

eqExpression
    :    relationalExpression (EQ^ relationalExpression)*
    ;

relationalExpression
    :    additiveExpression ( ( LTNE^ | GTNE^ | LTEQ^ | GTEQ^ )
additiveExpression)*
    ;

additiveExpression
    :    multiplicativeExpression ((PLUS^ | MINUS^) multiplicativeExpression)*
    ;

multiplicativeExpression
    :    unaryExpression ((STAR^ | DIV^ | MOD^ ) unaryExpression)*
    ;

unaryExpression
    :    MINUS^ {#MINUS.setType(UNARY_MINUS);} unaryExpression
    |    PLUS^  {#PLUS.setType(UNARY_PLUS);} unaryExpression
    |    unaryExpressionNotPlusMinus
    ;

unaryExpressionNotPlusMinus
    :    ("not"^) unaryExpression
    |    primaryExpression
    ;

primaryExpression
    :    variant
    |    NUMBER
    |    "true"^
    |    "false"^
    |    LPAREN! assignmentExpression RPAREN!
    ;

variant
    :    IDENT variantAtoms
    ;

variantAtoms
    :
    |    LBRACKET! NUMBER RBRACKET!
    |    LPAREN! expression RPAREN!
    ;

class KExprLexer extends Lexer;

options
{
    caseSensitive = false;
    testLiterals = false;
    k = 2;
}

WS
    :    (' ' | '\t' | '\n' | '\r')
    { _ttype = Token.SKIP ; }
    ;

LBRACKET    :    '[' ;
RBRACKET    :    ']' ;

LPAREN    :    '('    ;
RPAREN    :    ')' ;
STAR    :    '*' ;
DIV        :    '/' ;
PLUS    :   '+' ;
MINUS   :   '-' ;
MOD        :    '%' ;
COLON    :    ':' ;
QUESTION    :    '?' ;
COMMA    :    ',' ;

ATSIGN    :    '@' ;

GTNE    :   ">" ;
GTEQ    :   ">=" ;
LTNE    :   "<" ;
LTEQ    :    "<=" ;
EQ      :   "=" ;

STRING_LITERAL
    :    '"' (~'"')* '"'
    |    '\'' (~'\'')* '\''
    ;

IDENT
    options {testLiterals=true;}
    :    ('a' .. 'z') ('a' .. 'z' | '0' .. '9' | '_' | '.')*
    ;

NUMBER
    :    ('0'..'9')+ ('.' (('0'..'9')+)?)?
    ;
From Erik.Putrycz at nrc-cnrc.gc.ca  Tue Mar 14 16:27:38 2006
From: Erik.Putrycz at nrc-cnrc.gc.ca (Putrycz, Erik)
Date: Tue Mar 14 16:27:43 2006
Subject: [antlr-interest] ANTLR 3 and getColumn()
Message-ID: <E4D07AB09F5F044299333C8D0FEB45E901B66777@nrccenexb1.nrc.ca>

I'm currently working on a COBOL grammar for ANTLR and I have to say
that AntLRWorks is really easing my life... 

In COBOL, white spaces play a major role and I looked at the Python
example. I find the startPos way less friendly than the v2 getColumn().

If I understand, currently there is no way to attach hooks (such as
overriding nextToken()) in AntLRWorks. Are there plans for that? 

 

Thanks,

 

Erik Putrycz, Ph.D - Research Associate /
<mailto:erik.putrycz@nrc-cnrc.gc.ca> erik.putrycz@nrc-cnrc.gc.ca / (613)
990 0681

Institute for Information Technology - Software Engineering Group

National Research Council, Canada - Building M-50, 1200 Montreal Road

Ottawa, Ontario, CANADA K1A 0R6

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060314/92f5ee3f/attachment.html
From parrt at cs.usfca.edu  Tue Mar 14 16:30:27 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Mar 14 16:30:31 2006
Subject: [antlr-interest] ANTLR 3 and getColumn()
In-Reply-To: <E4D07AB09F5F044299333C8D0FEB45E901B66777@nrccenexb1.nrc.ca>
References: <E4D07AB09F5F044299333C8D0FEB45E901B66777@nrccenexb1.nrc.ca>
Message-ID: <4AAEB2BE-55FD-466F-BA14-712C480FBE7B@cs.usfca.edu>


On Mar 14, 2006, at 4:27 PM, Putrycz, Erik wrote:

> I?m currently working on a COBOL grammar for ANTLR and I have to  
> say that AntLRWorks is really easing my life?
>
> In COBOL, white spaces play a major role and I looked at the Python  
> example. I find the startPos way less friendly than the v2 getColumn 
> ().
>
> If I understand, currently there is no way to attach hooks (such as  
> overriding nextToken()) in AntLRWorks. Are there plans for that?

It's an ANTLR thing...you should be able to override that method in  
your Token to do what you want. :)

Ter
From llewmason at yahoo.com  Tue Mar 14 22:03:25 2006
From: llewmason at yahoo.com (Llew Mason)
Date: Tue Mar 14 22:03:30 2006
Subject: [antlr-interest] Parser help with grabbing unparsed code blocks
Message-ID: <2A14F03D-2B1F-40B9-AACB-36D992D26911@yahoo.com>

Hi all,

I'm trying to write a parser/lexer to deal with a language that  
contains code blocks that will not be interpreted by the parser, but  
I want the parser to extract them as chunks of text.

For example, here's a dummy piece of code to be parsed:

COMMAND {CAT, DOG}
{
    if (id.call() == true)
    {
	id.otherCall();
    }
}

I want the parser to understand the tokens COMMAND { CAT , DOG } and  
parse those, and then expect a code block in curly braces.  However,  
it shouldn't attempt to parse the contents of the code block.  The  
action for the command rule needs to pull the entire contents of the  
curly braces (because I want to pass them onto beanshell as code).

I've tried a bunch of different ways to get this to work, and seem to  
want something like the code below to work, but I can't work out what  
to put for 'ANYTHING' in the block below that gives me what I want.   
Having the lexer define ANYTHING appropriately (with the curly braces  
in the lexer rule instead of the parse rule) makes it gobble up  
things like {CAT, DOG} too.  I get the feeling that maybe predicates  
could be used in the lexer to solve my problem, but updating a state  
variable communicating between the parser and lexer didn't seem to  
work right.  I also briefly looked at using the multiplexing support,  
but I don't want to _parse_ the code block, just grab it.

command :
(
     "COMMAND" id "{" ANYTHING "}"
     {
         ... do something with the contents of the code block in the  
curly braces ...
     }
);

id :
(
     ("{" WORD ("," WORD)? "}")
     {
     }
);

Did this make any sense?  If so, can anyone point me in the right  
direction?  It seems like I'm missing something and there is an easy  
way to accomplish what I want.

Thanks,

Llew


From brade at informatik.uni-muenchen.de  Wed Mar 15 01:30:28 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar 15 01:29:29 2006
Subject: [antlr-interest] TreeParser transform examples
In-Reply-To: <e39abda10603140831w5fb89f3en@mail.gmail.com>
References: <200603141638.50186.brade@informatik.uni-muenchen.de>
	<e39abda10603140831w5fb89f3en@mail.gmail.com>
Message-ID: <200603151030.31344.brade@informatik.uni-muenchen.de>

On Tuesday 14 March 2006 17:31, Jose Ventura wrote:
> If I understand you, you want add STRING AST in OPERATORS.
> I don't test this code, but you can try anything also:
>
> structured_term!:
>                  * {AST aux=null;}*
>                    #(NS_LABEL #(PREFIX prefix:NCNAME)
>                             #(LOCAL   label:NCNAME)
>                    {
>                      ## = #([OPERATORS,"operators"],
>                               #([TYPE_SEL,"type"], [STRING,"tree"]),
>                               #([NAMESPACE_SEL,"namespace"], prefix),
>                               #([LABEL_SEL,"label"], label),
>                            );
>                     * aux=##;
Heh, nice one! Thanks, it works. I still find it a little weird and hacky to 
have to do that...

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060315/077329cb/attachment.bin
From demakov at ispras.ru  Wed Mar 15 01:56:16 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Wed Mar 15 01:56:36 2006
Subject: [antlr-interest] TreeDL way
References: <440DD23C.4070300@jazillian.com>
	<020c01c64689$95546dc0$8cc79553@marlboro>
	<4416F7CB.2010209@jazillian.com>
Message-ID: <00ee01c64816$b38e0fb0$8cc79553@marlboro>

From: "Andy Tripp" <antlr@jazillian.com>
> Alexey Demakov wrote:
>> My project, TreeDL (http://treedl.sf.net), is mentioned in the article 
>> "Manual Tree Walking Is Better Than Tree Grammars" by Andy Tripp. I 
>> generally agree with this statement
>> but can't agree with the context:
>>
>>> The mapping from one AST structure to another is quite complex
>>> (see XSLT, TXL, or TreeDL for example), and a single BNF-like grammar 
>>> doesn't capture it.
>>
>>
> Hi Alexey,
> Yea, I guess I shouldn't mentioned TreeDL. Thanks for correcting that - 
> I'll take it out.
> As you can see, I was just trying to list a few technologies relating to 
> tree-transformation.
> 
> As for the rest of your comments, I just have one place where I'm very 
> sceptical:
> 
>>
>> 2a. It is source of code generation. You need not write depth-first
>> walker by hands and update it on each AST change - just re-generate it.
> 
> I'm not sure exactly what you're claiming here. You're not saying that, 
> for example,
> I could change ANTLR to produce a different AST structure for Java code 
> input,
> and have whatever AST-processing I've written still work correctly, are you?
> 
> I mean, if the AST structure changes, whatever code is written that does 
> something
> with that AST (whether just print it, change it, or whatever) is now broken.

Of course, if your code is not generated, it can be broken. But I'm saying
about base classes that are fully defined by AST structure.
For example, depth-first walker that calls user methods in each node, can be 
generated automatically. User methods can require manual update.

The main problem is to find out when user code is broken.
For example, if you write your visitor as an inheritor of generated empty visitor,
after creation of new node type empty visitor will be re-generated. And you
will not have any messages telling that your visitor probably should be updated
to process new node type!

It is one of the main disadvantages of tree processing in general purpose programming
language (I'm thinking about Java, but the problem exists in other languages, may be not in all).
So, we need tool support to make additional checking, specific for our domain,
for our data structures. I contend that a set of tree node types allowed in AST
should be considered as specific data type with specific operations.
For example, when you are making switch by node type: switch(ast.getType())
you implicitly suppose that node type belongs to right AST structure,
because node type is unique only within AST structure.
So, we can talk about operations on AST that must be defined for eash node type in AST structure.
Or about partial operations on AST that must be defined for some node type
and all its inheritors in AST structure.
But in general-purpose programming language we have no support for such data types
and can't check that operation is defined correctly (on each required node type).
Simple domain-specific language (for example, TreeDL) solves the problem.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


From brade at informatik.uni-muenchen.de  Wed Mar 15 03:55:43 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar 15 03:54:42 2006
Subject: [antlr-interest] Difference between foo and #foo?
Message-ID: <200603151255.47139.brade@informatik.uni-muenchen.de>

Hi,

what is the exact difference between the trees referenced by foo and #foo if 
declared like this:
  #( ... foo:children )

The fact that tmp.addChild( foo ); even compiles was the reason I didn't 
notice that I forgot the '#' for hours...

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060315/d06c55f7/attachment.bin
From brade at informatik.uni-muenchen.de  Wed Mar 15 04:16:17 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar 15 04:15:17 2006
Subject: [antlr-interest] Difference between foo and #foo?
In-Reply-To: <200603151255.47139.brade@informatik.uni-muenchen.de>
References: <200603151255.47139.brade@informatik.uni-muenchen.de>
Message-ID: <200603151316.21236.brade@informatik.uni-muenchen.de>

On Wednesday 15 March 2006 12:55, Michael Brade wrote:
> what is the exact difference between the trees referenced by foo and #foo
> if declared like this:
>   #( ... foo:children )
sorry, I forgot to mention that this is in a TreeParser with buildAST=true.

Thanks,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060315/60eeb259/attachment.bin
From mail at martin-probst.com  Wed Mar 15 04:39:41 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 15 04:39:49 2006
Subject: [antlr-interest] Difference between foo and #foo?
In-Reply-To: <200603151255.47139.brade@informatik.uni-muenchen.de>
References: <200603151255.47139.brade@informatik.uni-muenchen.de>
Message-ID: <1142426381.5493.4.camel@localhost.localdomain>

> what is the exact difference between the trees referenced by foo and #foo if 
> declared like this:
>   #( ... foo:children )

foo is just some Java text, and #foo is text that is supposed to be
handled by ANTLR. Meaning: if your action contains #something, ANTLR
will replace it with something, otherwise not. In your case in a
TreeParser (I assume) there is actually no difference because the AST
fragments are directly called "foo" and not "foo_AST" as in the parser
(where just using foo will give you a compile error).

I would think of this as a leaking in the abstraction, don't use 'foo'
as this behaviour might change in later versions.

Martin

From sunjigang1965 at yahoo.com.cn  Wed Mar 15 05:09:34 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Wed Mar 15 05:09:39 2006
Subject: [antlr-interest] position information with AST node
Message-ID: <20060315130934.39354.qmail@web15709.mail.cnb.yahoo.com>

I want position information with AST node as IToken does(getLin(), getColumn()). How to achive
that?

Cheers.

Jigang  


	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From brade at informatik.uni-muenchen.de  Wed Mar 15 05:34:49 2006
From: brade at informatik.uni-muenchen.de (Michael Brade)
Date: Wed Mar 15 05:33:57 2006
Subject: [antlr-interest] Difference between foo and #foo?
In-Reply-To: <1142426381.5493.4.camel@localhost.localdomain>
References: <200603151255.47139.brade@informatik.uni-muenchen.de>
	<1142426381.5493.4.camel@localhost.localdomain>
Message-ID: <200603151434.54787.brade@informatik.uni-muenchen.de>

On Wednesday 15 March 2006 13:39, Martin Probst wrote:
> > what is the exact difference between the trees referenced by foo and #foo
> > if declared like this:
> >   #( ... foo:children )
>
> foo is just some Java text, and #foo is text that is supposed to be
> handled by ANTLR. Meaning: if your action contains #something, ANTLR
> will replace it with something, otherwise not.
Yup. So far, so good. But since ANTLR generates both variables, i.e.
                AST foo_AST = null;
                AST foo = null;
in every method for every label, I thought it has to have a reason.

> In your case in a TreeParser (I assume) there is actually no difference
> because the AST fragments are directly called "foo" and not "foo_AST" as in
> the parser (where just using foo will give you a compile error).
Thanks for your answer, in the meantime I sat down and tried to understand the 
generated code---successfully :-) So no, it's not the same: foo == #foo_in! 
So no wonder I didn't understand my results, in case you forget the '#', what 
you get is not the output tree but the input tree for that rule.... creepy ;)

Cheers,
-- 
Michael Brade;                 KDE Developer, Student of Computer Science
  |-mail: echo brade !#|tr -d "c oh"|s\e\d 's/e/\@/2;s/$/.org/;s/bra/k/2'
  ?--web: http://www.kde.org/people/michaelb.html

KDE 4: Beyond Your Expectations
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20060315/38368f11/attachment.bin
From mark.kattenbelt at gmail.com  Wed Mar 15 05:39:47 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Wed Mar 15 05:40:05 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0
In-Reply-To: <7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
References: <44169DBB.2000403@gmail.com>
	<7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
Message-ID: <44181923.50901@gmail.com>

Hi Mike,

Thanks for sharing that. I've updated that file, which indeed causes an 
error when NO_STATIC_CONSTS is defined. Initially I kept trying to 
compile without NO_STATIC_CONSTS defined (as this shouldn't be a problem 
for any newish compiler), but this gives a lot of problems when linking. 
This is because most static const int's are initialized in the class 
declaration, which I dont think is the correct way. Even with some 
tweaking there was no way I could get VS to compile antlr without 
setting NO_STATIC_CONSTS.

However, with your fix and that define I've managed to make a dynamic 
library. Hopefully this will work well.

I do think antlr should be a bit more user friendly towards visual 
studio users.

Cheers,

Mark
> Mark,
>
> If it is any help, I built a static library (.lib) using 2.7.6 with 
> the command line.
>
> /Od /I "C:\Development\antlr\antlr-2.7.6\lib\cpp\\" /D "WIN32" /D 
> "_DEBUG" /D "_LIB" /D "_CRT_SECURE_NO_DEPRECATE" /D 
> "_VC80_UPGRADE=0x0600" /D "_MBCS" /FD /EHsc /RTC1 /MDd /Zc:wchar_t- 
> /Zc:forScope- /GR- /Fp".\Debug/antlr_lib.pch" /Fo".\Debug/" 
> /Fd".\Debug/" /FR".\Debug\\" /W3 /nologo /c /Z7 /errorReport:prompt
>
> There is a change in TokenStreamRewriteEngine.cpp (already submitted 
> to Ter)
>
> #ifndef NO_STATIC_CONSTS
> const size_t TokenStreamRewriteEngine::MIN_TOKEN_INDEX = 0;
> const int TokenStreamRewriteEngine::PROGRAM_INIT_SIZE = 100;
> #endif
>
>
> At 10:40 14/03/2006, Mark Kattenbelt wrote:
>> Hello,
>>
>> I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 
>> 2005, so far unsuccessfully.
>> In mingw, I manage to compile it fine, only took a few minutes to set 
>> up! I use the following settings for VS:
>>
>> Include dir: "lib\cpp"
>> Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
>> Run-time library: Multi-treaded debug.
>> Create precompiled headers: yes.
>> Function level linking: yes.
>> RTTI: yes.
>>
>> Which results into compiling with the following line:
>>
>> /O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" /D 
>> "ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
>> /Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" /nologo 
>> /c /TP /errorReport:prompt
>>
>> And linking with:
>>
>> /OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL 
>> /MANIFEST /MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
>> /ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib 
>> winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
>> oleaut32.lib uuid.lib odbc32.lib odbccp32.lib
>>
>> Now this fails during the linking stage, in particular it keeps 
>> finding symbols that are defined in multiple places:
>>
>> ASTFactory.obj : error LNK2005: "class std::basic_istream<char,struct 
>> std::char_traits<char> > & __cdecl antlr::eatwhite(class 
>> std::basic_istream<char,struct std::char_traits<char> > &)" 
>> (?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
>> already defined in ANTLRUtil.obj
>> ASTFactory.obj : error LNK2005: "class std::basic_string<char,struct 
>> std::char_traits<char>,class std::allocator<char> > __cdecl 
>> antlr::read_string(class std::basic_istream<char,struct 
>> std::char_traits<char> > &)" ...
>>
>> I have tried to compile without precompiled headers, because I do not 
>> see the need for them, this results in:
>>
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::CHAR" 
>> (?CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::NOT_CHAR" 
>> (?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::RANGE" 
>> (?RANGE@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>>
>> Clearly I am doing something wrong, and the settings need tweaking. 
>> Has anyone here managed to build antlr (2.7.6?) with Visual Studio 
>> (8.0?). If so could you please share your settings? Any help is 
>> appreciated.
>>
>> Also, trying to compile it into a static library does not offer any 
>> relief, the errors still persist.
>>
>> Cheers,
>>
>> Mark Kattenbelt
>>
>>
>>
>
>
> Regards
>
> Mike
>
>
> Mike Ventham
> Chief Technical Consultant
> Double V Design & Support Services
> Email : mike@doublevdesign.co.uk
>
>
>

From mail at martin-probst.com  Wed Mar 15 05:44:51 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 15 05:44:55 2006
Subject: [antlr-interest] Difference between foo and #foo?
In-Reply-To: <200603151434.54787.brade@informatik.uni-muenchen.de>
References: <200603151255.47139.brade@informatik.uni-muenchen.de>
	<1142426381.5493.4.camel@localhost.localdomain>
	<200603151434.54787.brade@informatik.uni-muenchen.de>
Message-ID: <1142430291.5493.6.camel@localhost.localdomain>

> > In your case in a TreeParser (I assume) there is actually no difference
> > because the AST fragments are directly called "foo" and not "foo_AST" as in
> > the parser (where just using foo will give you a compile error).
> Thanks for your answer, in the meantime I sat down and tried to understand the 
> generated code---successfully :-) So no, it's not the same: foo == #foo_in! 
> So no wonder I didn't understand my results, in case you forget the '#', what 
> you get is not the output tree but the input tree for that rule.... creepy ;)

Ouch, sorry. I never had buildAST = true in an tree parser, so for my
case #foo was always == foo.

Martin

From mail at martin-probst.com  Wed Mar 15 05:45:51 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 15 05:46:02 2006
Subject: [antlr-interest] position information with AST node
In-Reply-To: <20060315130934.39354.qmail@web15709.mail.cnb.yahoo.com>
References: <20060315130934.39354.qmail@web15709.mail.cnb.yahoo.com>
Message-ID: <1142430351.5493.8.camel@localhost.localdomain>

> I want position information with AST node as IToken does(getLin(), getColumn()). How to achive
> that?

That's explained in the manual. Look for using a custom AST class.

Cheers,
Martin

From mike at doublevdesign.co.uk  Wed Mar 15 06:24:20 2006
From: mike at doublevdesign.co.uk (Mike Ventham)
Date: Wed Mar 15 06:24:46 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0
In-Reply-To: <44181923.50901@gmail.com>
References: <44169DBB.2000403@gmail.com>
	<7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
	<44181923.50901@gmail.com>
Message-ID: <7.0.0.16.0.20060315142307.02503eb8@doublevdesign.co.uk>

Mark,

There was an additional change in config.hpp

# if ( _MSC_VER <= 1400 )
// Supposedly only for MSVC7 and before...
// Not allowed to put 'static const int XXX=20;' in a class definition
#       define NO_STATIC_CONSTS
#       define NO_TEMPLATE_PARTS
# endif

Version 8 is MSC_VER 1400

Apologies for the omission.

Mike
At 13:39 15/03/2006, Mark Kattenbelt wrote:
>Hi Mike,
>
>Thanks for sharing that. I've updated that file, which indeed causes 
>an error when NO_STATIC_CONSTS is defined. Initially I kept trying 
>to compile without NO_STATIC_CONSTS defined (as this shouldn't be a 
>problem for any newish compiler), but this gives a lot of problems 
>when linking. This is because most static const int's are 
>initialized in the class declaration, which I dont think is the 
>correct way. Even with some tweaking there was no way I could get VS 
>to compile antlr without setting NO_STATIC_CONSTS.
>
>However, with your fix and that define I've managed to make a 
>dynamic library. Hopefully this will work well.
>
>I do think antlr should be a bit more user friendly towards visual 
>studio users.
>
>Cheers,
>
>Mark
>>Mark,
>>
>>If it is any help, I built a static library (.lib) using 2.7.6 with 
>>the command line.
>>
>>/Od /I "C:\Development\antlr\antlr-2.7.6\lib\cpp\\" /D "WIN32" /D 
>>"_DEBUG" /D "_LIB" /D "_CRT_SECURE_NO_DEPRECATE" /D 
>>"_VC80_UPGRADE=0x0600" /D "_MBCS" /FD /EHsc /RTC1 /MDd /Zc:wchar_t- 
>>/Zc:forScope- /GR- /Fp".\Debug/antlr_lib.pch" /Fo".\Debug/" 
>>/Fd".\Debug/" /FR".\Debug\\" /W3 /nologo /c /Z7 /errorReport:prompt
>>
>>There is a change in TokenStreamRewriteEngine.cpp (already submitted to Ter)
>>
>>#ifndef NO_STATIC_CONSTS
>>const size_t TokenStreamRewriteEngine::MIN_TOKEN_INDEX = 0;
>>const int TokenStreamRewriteEngine::PROGRAM_INIT_SIZE = 100;
>>#endif
>>
>>
>>At 10:40 14/03/2006, Mark Kattenbelt wrote:
>>>Hello,
>>>
>>>I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 
>>>2005, so far unsuccessfully.
>>>In mingw, I manage to compile it fine, only took a few minutes to 
>>>set up! I use the following settings for VS:
>>>
>>>Include dir: "lib\cpp"
>>>Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
>>>Run-time library: Multi-treaded debug.
>>>Create precompiled headers: yes.
>>>Function level linking: yes.
>>>RTTI: yes.
>>>
>>>Which results into compiling with the following line:
>>>
>>>/O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" 
>>>/D "ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
>>>/Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" 
>>>/nologo /c /TP /errorReport:prompt
>>>
>>>And linking with:
>>>
>>>/OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL 
>>>/MANIFEST 
>>>/MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
>>>/ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib 
>>>gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib 
>>>ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib
>>>
>>>Now this fails during the linking stage, in particular it keeps 
>>>finding symbols that are defined in multiple places:
>>>
>>>ASTFactory.obj : error LNK2005: "class 
>>>std::basic_istream<char,struct std::char_traits<char> > & __cdecl 
>>>antlr::eatwhite(class std::basic_istream<char,struct 
>>>std::char_traits<char> > &)" 
>>>(?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
>>>already defined in ANTLRUtil.obj
>>>ASTFactory.obj : error LNK2005: "class 
>>>std::basic_string<char,struct std::char_traits<char>,class 
>>>std::allocator<char> > __cdecl antlr::read_string(class 
>>>std::basic_istream<char,struct std::char_traits<char> > &)" ...
>>>
>>>I have tried to compile without precompiled headers, because I do 
>>>not see the need for them, this results in:
>>>
>>>MismatchedCharException.obj : error LNK2005: "public: static int 
>>>const antlr::MismatchedCharException::CHAR" 
>>>(?CHAR@MismatchedCharException@antlr@@2HB) already defined in CharScanner.obj
>>>MismatchedCharException.obj : error LNK2005: "public: static int 
>>>const antlr::MismatchedCharException::NOT_CHAR" 
>>>(?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>>>CharScanner.obj
>>>MismatchedCharException.obj : error LNK2005: "public: static int 
>>>const antlr::MismatchedCharException::RANGE" 
>>>(?RANGE@MismatchedCharException@antlr@@2HB) already defined in CharScanner.obj
>>>
>>>Clearly I am doing something wrong, and the settings need 
>>>tweaking. Has anyone here managed to build antlr (2.7.6?) with 
>>>Visual Studio (8.0?). If so could you please share your settings? 
>>>Any help is appreciated.
>>>
>>>Also, trying to compile it into a static library does not offer 
>>>any relief, the errors still persist.
>>>
>>>Cheers,
>>>
>>>Mark Kattenbelt
>>>
>>>
>>
>>
>>Regards
>>
>>Mike
>>
>>
>>Mike Ventham
>>Chief Technical Consultant
>>Double V Design & Support Services
>>Email : mike@doublevdesign.co.uk
>>
>>
>


From open.zone at virgin.net  Wed Mar 15 06:56:48 2006
From: open.zone at virgin.net (Micheal J)
Date: Wed Mar 15 06:39:54 2006
Subject: [antlr-interest] position information with AST node
In-Reply-To: <1142430351.5493.8.camel@localhost.localdomain>
Message-ID: <002001c64840$b047cc40$6b02a8c0@hercules>

Also study the examples. The Java and C# grammar samples do this iirc.

Micheal


> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of Martin Probst
> Sent: 15 March 2006 13:46
> To: antlr-interest@antlr.org
> Subject: Re: [antlr-interest] position information with AST node
> 
> 
> > I want position information with AST node as IToken does(getLin(), 
> > getColumn()). How to achive that?
> 
> That's explained in the manual. Look for using a custom AST class.
> 
> Cheers,
> Martin
> 

From Ulrich.Frank at dlr.de  Wed Mar 15 08:24:43 2006
From: Ulrich.Frank at dlr.de (Ulrich Frank)
Date: Wed Mar 15 08:24:43 2006
Subject: [antlr-interest] Testing a grammar
Message-ID: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>

Hi there,

I have a more general problem namely I wrote a grammar and now I want  
to test it, which means I need test cases so that every posibility of  
the grammar is covered by one test case.
Example:
rule : "from" IDENT "select" (IDENT)?
for a complete coverage I need two test cases:
1. "from" abc "select"
2. "from" abc "select" def
Do you know an efficient approach getting all these test cases? How  
about recursion regarding a rule like this: plus : IDENT ("+" plus)+   ?

Thanks a lot,
Uli
From mail at martin-probst.com  Wed Mar 15 09:27:32 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 15 09:27:37 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
Message-ID: <1142443652.5493.20.camel@localhost.localdomain>

> I have a more general problem namely I wrote a grammar and now I want  
> to test it, which means I need test cases so that every posibility of  
> the grammar is covered by one test case.

I think Terence wrote something like that once, a tool that generates
random and meaningless, but syntactically correct, expressions from your
grammar. Maybe in the filesharing section?

Martin

From gudnabrsam at yahoo.com  Wed Mar 15 09:35:40 2006
From: gudnabrsam at yahoo.com (Matt Benson)
Date: Wed Mar 15 09:35:44 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <1142443652.5493.20.camel@localhost.localdomain>
Message-ID: <20060315173540.19359.qmail@web30911.mail.mud.yahoo.com>

Isn't that an integral part of V3?

-Matt

--- Martin Probst <mail@martin-probst.com> wrote:

> > I have a more general problem namely I wrote a
> grammar and now I want  
> > to test it, which means I need test cases so that
> every posibility of  
> > the grammar is covered by one test case.
> 
> I think Terence wrote something like that once, a
> tool that generates
> random and meaningless, but syntactically correct,
> expressions from your
> grammar. Maybe in the filesharing section?
> 
> Martin
> 
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
From gcaglar at gmail.com  Wed Mar 15 10:08:16 2006
From: gcaglar at gmail.com (Gokhan Caglar)
Date: Wed Mar 15 10:08:19 2006
Subject: [antlr-interest] Non-determinism when k==2
Message-ID: <2cc5308c0603151008x358d035dkbc1ce2329ca03458@mail.gmail.com>

Here are two grammars which I think are semantically equal, look at
the do loop in the generated code.  I know I can left factor DO's but
I am trying to demonstrate a behavior.  The first one reports a non
determinism:

For the grammar:

options {
    k = 2;
}

batch
    :
        (statement1)*
        (statement2)?
    ;

statement1
    :
        DO THIS
    | BREAK
    ;

statement2
    : DO THAT
    ;


This code gets generated:

            public final void batch() throws RecognitionException,
TokenStreamException {
                        try {      // for error handling
                                    {
                                    _loop6:
                                    do {
                                                if
((LA(1)==DO||LA(1)==BREAK) && (_tokenSet_1.member(LA(2)))) {
                                                            statement();
                                                }
                                                else {
                                                            break _loop6;
                                                }
                                    } while (true);
                                    }
                                    {
                                    switch ( LA(1)) {
                                    case DO:
                                    {
                                                statement2();
                                                break;
                                    }
                                    case EOF:
                                    case GO:
                                    {
                                                break;
                                    }
                                    default:
                                    {
                                                throw new
NoViableAltException(LT(1), getFilename());
                                    }
                                    }
                                    }
                        }
                        catch (RecognitionException ex) {
                                    reportError(ex);
                                    recover(ex,_tokenSet_2);
                        }
            }



For the grammar:

options {
    k = 2;
}

batch
    :
        (statement1 | statement3)*
        (statement2)?
    ;

statement1
    :
        DO THIS
    ;

statement3
    :
     BREAK
    ;

statement2
    : DO THAT
    ;


This code gets generated:

            public final void batch() throws RecognitionException,
TokenStreamException {
                        try {      // for error handling
                                    {
                                    _loop6:
                                    do {
                                                if ((LA(1)==DO) &&
(LA(2)==THIS)) {
                                                            statement1();
                                                }
                                                else if ((LA(1)==BREAK)) {
                                                            statement3();
                                                }
                                                else {
                                                            break _loop6;
                                                }
                                    } while (true);
                                    }
                                    {
                                    switch ( LA(1)) {
                                    case DO:
                                    {
                                                statement2();
                                                break;
                                    }
                                    case EOF:
                                    case GO:
                                    {
                                                break;
                                    }
                                    default:
                                    {
                                                throw new
NoViableAltException(LT(1), getFilename());
                                    }
                                    }
                                    }
                        }
                        catch (RecognitionException ex) {
                                    reportError(ex);
                                    recover(ex,_tokenSet_1);
                        }
            }

It goes back to the first generated code, and reports non-determinism
if we do this:
batch
    :
        ((statement1 | statement3))*  // Adding an extra paranthesis
        (statement2)?
    ;


Thanks,
Gokhan
From giarcmirt at gmail.com  Wed Mar 15 11:56:16 2006
From: giarcmirt at gmail.com (C T)
Date: Wed Mar 15 11:56:18 2006
Subject: [antlr-interest] Parsing a grammar file 2.7.5
Message-ID: <bfaeeb7f0603151156y108dae9bp52cb1da05934b64b@mail.gmail.com>

Hi,

Using 2.7.5.  I'm trying to parse a grammar file I created using the
following code:

 FileInputStream fos = new FileInputStream(new File(filename));
 ANTLRLexer lexer = new ANTLRLexer(fos);
 ANTLRParser parser = new ANTLRParser(lexer);
 parser.grammar();
 AST ast = parser.getAST();
 DumpASTVisitor visitor = new DumpASTVisitor();
 visitor.visit(ast);

When I do this I get a Null Pointer Exception.  Looks like this constructor:

 public ANTLRParser(
    TokenBuffer tokenBuf,
    ANTLRGrammarParseBehavior behavior_,

    Tool tool_
 )

 it not being instantiated, and so the ANTLRGrammarParseBehavior behavior
object remains null.  Should I construct the ANTLRParser class differently,
or am I doing something else wrong?

 Thanks in advance,
 Torrance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060315/d4b98224/attachment.html
From ewbank at gmail.com  Wed Mar 15 12:01:44 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Wed Mar 15 12:01:48 2006
Subject: [antlr-interest] Parser help with grabbing unparsed code blocks
In-Reply-To: <2A14F03D-2B1F-40B9-AACB-36D992D26911@yahoo.com>
References: <2A14F03D-2B1F-40B9-AACB-36D992D26911@yahoo.com>
Message-ID: <dd3a065f0603151201j69dbfd77p57f45dd6ebad04cc@mail.gmail.com>

Right off the top, can you change from { CAT, DOG } to ( CAT, DOG ) for the
parameters?  You now have a situation where the lexer is stateful because "{"
means something in one place, but "{" means ANYTHING in another place.

If you can't change the syntax, it would seem that you must use lexer state; at
the very least, track the last token, then match ANYTHING only when the last
token was "}" and therefore "{" means ANYTHING.

Perhaps another way is to have ANYTHING match from "}" (after DOG) to "}"; it's
unambiguous in the grammar as you've sketched it....

On 3/15/06, Llew Mason <llewmason@yahoo.com> wrote:
> Hi all,
>
> I'm trying to write a parser/lexer to deal with a language that
> contains code blocks that will not be interpreted by the parser, but
> I want the parser to extract them as chunks of text.
>
> For example, here's a dummy piece of code to be parsed:
>
> COMMAND {CAT, DOG}
> {
>     if (id.call() == true)
>     {
>         id.otherCall();
>     }
> }
>
> I want the parser to understand the tokens COMMAND { CAT , DOG } and
> parse those, and then expect a code block in curly braces.  However,
> it shouldn't attempt to parse the contents of the code block.  The
> action for the command rule needs to pull the entire contents of the
> curly braces (because I want to pass them onto beanshell as code).
From antlr at shmuelhome.mine.nu  Wed Mar 15 12:02:45 2006
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Wed Mar 15 12:04:00 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <1142443652.5493.20.camel@localhost.localdomain>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
	<1142443652.5493.20.camel@localhost.localdomain>
Message-ID: <441872E5.4090101@shmuelhome.mine.nu>

Martin Probst wrote:
>> I have a more general problem namely I wrote a grammar and now I want  
>> to test it, which means I need test cases so that every posibility of  
>> the grammar is covered by one test case.
> 
> I think Terence wrote something like that once, a tool that generates
> random and meaningless, but syntactically correct, expressions from your
> grammar. Maybe in the filesharing section?
> 
> Martin
> 
That strikes me as something that might test the program that uses the 
parser but it would hardly test the parser. After all, the test input is 
guaranteed to obey the rules of the parser.


-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.375 / Virus Database: 268.2.3/281 - Release Date: 3/14/2006



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.375 / Virus Database: 268.2.3/281 - Release Date: 3/14/2006

From mail at martin-probst.com  Wed Mar 15 12:23:54 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 15 12:23:58 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <441872E5.4090101@shmuelhome.mine.nu>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
	<1142443652.5493.20.camel@localhost.localdomain>
	<441872E5.4090101@shmuelhome.mine.nu>
Message-ID: <1142454234.5536.9.camel@localhost.localdomain>

> > I think Terence wrote something like that once, a tool that generates
> > random and meaningless, but syntactically correct, expressions from your
> > grammar. Maybe in the filesharing section?
> > 
> That strikes me as something that might test the program that uses the 
> parser but it would hardly test the parser. After all, the test input is 
> guaranteed to obey the rules of the parser.

That's right, it's more like a test that you're parser is stable, e.g.
doesn't throw NPEs or segfaults for the C++ side of life.

I should be pretty easy to write a coverage tool for the parser that
checks that every rule and subrule has been passed at least once (and
every loop has been run at least 2 times, etc.) by modifying the code
generator - that might be very useful, too.

Martin

From bharath_d at yahoo.com  Wed Mar 15 12:38:45 2006
From: bharath_d at yahoo.com (Bharath Devanathan)
Date: Wed Mar 15 12:38:47 2006
Subject: [antlr-interest] (no subject)
Message-ID: <20060315203845.73155.qmail@web31810.mail.mud.yahoo.com>

Hello all,

I am at a situation where we need to break binary compatiblity. As a result a lot of code has to be changed and recompiled. I am looking into automating this task.

For example, lets say I have a class A that looks like this

class A
{
  char* name;
};

After the binary compatibility change has been made, class A now will look like

class A
{
  char* name();
};


So for all code that used to refer A now has to change .

A* p;

After the change made to class A, tp->name has to change to p->name();

We have many more cases like this, but what I have described is a simplified view of the problem. 

What I am looking to do is to say

1. Find all variables of type A
2. For all these variables that match a certain criteria, (for ex variable->name), change the code to be something else. (variable->name())


I stumbled upon ANTLR from a websearch, and havent read enough about it yet. I would like to know if ANTLR is the right tool for this kind of job. If not, can someone on this list point me in the right direction?

Thanks in advance,
Bharath


From antlr at shmuelhome.mine.nu  Wed Mar 15 13:10:08 2006
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Wed Mar 15 13:09:59 2006
Subject: [antlr-interest] Parser help with grabbing unparsed code blocks
In-Reply-To: <2A14F03D-2B1F-40B9-AACB-36D992D26911@yahoo.com>
References: <2A14F03D-2B1F-40B9-AACB-36D992D26911@yahoo.com>
Message-ID: <441882B0.6050806@shmuelhome.mine.nu>

I would say that your language is ambiguous unless you can tell me 
something about the rules of right braces in the inner block, like they 
must be balanced and they are meaningless inside of strings. Otherwise 
it is impossible to tell if a right brace is part of the text or the 
terminator of the text. Assuming reasonable rules for your sub-language, 
I would create a token string for "ANYTHING" that reads like,

ANYTHING: ( NormalText | String | Block)*;
NormalText :		(~ ('{' | '}' | '"'))*;
String: '"' (~ '"')* '"';
Block: '{' (NormalText | String)* '}';

Llew Mason wrote:
> Hi all,
> 
> I'm trying to write a parser/lexer to deal with a language that contains 
> code blocks that will not be interpreted by the parser, but I want the 
> parser to extract them as chunks of text.
> 
> For example, here's a dummy piece of code to be parsed:
> 
> COMMAND {CAT, DOG}
> {
>    if (id.call() == true)
>    {
>     id.otherCall();
>    }
> }
> 
> I want the parser to understand the tokens COMMAND { CAT , DOG } and 
> parse those, and then expect a code block in curly braces.  However, it 
> shouldn't attempt to parse the contents of the code block.  The action 
> for the command rule needs to pull the entire contents of the curly 
> braces (because I want to pass them onto beanshell as code).
> 
> I've tried a bunch of different ways to get this to work, and seem to 
> want something like the code below to work, but I can't work out what to 
> put for 'ANYTHING' in the block below that gives me what I want.  Having 
> the lexer define ANYTHING appropriately (with the curly braces in the 
> lexer rule instead of the parse rule) makes it gobble up things like 
> {CAT, DOG} too.  I get the feeling that maybe predicates could be used 
> in the lexer to solve my problem, but updating a state variable 
> communicating between the parser and lexer didn't seem to work right.  I 
> also briefly looked at using the multiplexing support, but I don't want 
> to _parse_ the code block, just grab it.
> 
> command :
> (
>     "COMMAND" id "{" ANYTHING "}"
>     {
>         ... do something with the contents of the code block in the 
> curly braces ...
>     }
> );
> 
> id :
> (
>     ("{" WORD ("," WORD)? "}")
>     {
>     }
> );
> 
> Did this make any sense?  If so, can anyone point me in the right 
> direction?  It seems like I'm missing something and there is an easy way 
> to accomplish what I want.
> 
> Thanks,
> 
> Llew
> 
> 



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.375 / Virus Database: 268.2.3/281 - Release Date: 3/14/2006



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.375 / Virus Database: 268.2.3/281 - Release Date: 3/14/2006

From seclib at seclib.com  Wed Mar 15 13:37:40 2006
From: seclib at seclib.com (Xue Yong Zhi)
Date: Wed Mar 15 13:38:25 2006
Subject: [antlr-interest] Re: Non-determinism when k==2
In-Reply-To: <2cc5308c0603151008x358d035dkbc1ce2329ca03458@mail.gmail.com>
References: <2cc5308c0603151008x358d035dkbc1ce2329ca03458@mail.gmail.com>
Message-ID: <44188924.3000609@seclib.com>

The nondeterminism warning comes from "linear approximate lookahead".
Antlr may still generate the right code. if so you can either shutdown 
the warning or workaround the grammar(left factor).

Gokhan Caglar wrote:
> Here are two grammars which I think are semantically equal, look at
> the do loop in the generated code.  I know I can left factor DO's but
> I am trying to demonstrate a behavior.  The first one reports a non
> determinism:
> 
> For the grammar:
> 
> options {
>     k = 2;
> }
> 
> batch
>     :
>         (statement1)*
>         (statement2)?
>     ;
> 
> statement1
>     :
>         DO THIS
>     | BREAK
>     ;
> 
> statement2
>     : DO THAT
>     ;
> 
> 
> This code gets generated:
> 
>             public final void batch() throws RecognitionException,
> TokenStreamException {
>                         try {      // for error handling
>                                     {
>                                     _loop6:
>                                     do {
>                                                 if
> ((LA(1)==DO||LA(1)==BREAK) && (_tokenSet_1.member(LA(2)))) {
>                                                             statement();
>                                                 }
>                                                 else {
>                                                             break _loop6;
>                                                 }
>                                     } while (true);
>                                     }
>                                     {
>                                     switch ( LA(1)) {
>                                     case DO:
>                                     {
>                                                 statement2();
>                                                 break;
>                                     }
>                                     case EOF:
>                                     case GO:
>                                     {
>                                                 break;
>                                     }
>                                     default:
>                                     {
>                                                 throw new
> NoViableAltException(LT(1), getFilename());
>                                     }
>                                     }
>                                     }
>                         }
>                         catch (RecognitionException ex) {
>                                     reportError(ex);
>                                     recover(ex,_tokenSet_2);
>                         }
>             }
> 
> 
> 
> For the grammar:
> 
> options {
>     k = 2;
> }
> 
> batch
>     :
>         (statement1 | statement3)*
>         (statement2)?
>     ;
> 
> statement1
>     :
>         DO THIS
>     ;
> 
> statement3
>     :
>      BREAK
>     ;
> 
> statement2
>     : DO THAT
>     ;
> 
> 
> This code gets generated:
> 
>             public final void batch() throws RecognitionException,
> TokenStreamException {
>                         try {      // for error handling
>                                     {
>                                     _loop6:
>                                     do {
>                                                 if ((LA(1)==DO) &&
> (LA(2)==THIS)) {
>                                                             statement1();
>                                                 }
>                                                 else if ((LA(1)==BREAK)) {
>                                                             statement3();
>                                                 }
>                                                 else {
>                                                             break _loop6;
>                                                 }
>                                     } while (true);
>                                     }
>                                     {
>                                     switch ( LA(1)) {
>                                     case DO:
>                                     {
>                                                 statement2();
>                                                 break;
>                                     }
>                                     case EOF:
>                                     case GO:
>                                     {
>                                                 break;
>                                     }
>                                     default:
>                                     {
>                                                 throw new
> NoViableAltException(LT(1), getFilename());
>                                     }
>                                     }
>                                     }
>                         }
>                         catch (RecognitionException ex) {
>                                     reportError(ex);
>                                     recover(ex,_tokenSet_1);
>                         }
>             }
> 
> It goes back to the first generated code, and reports non-determinism
> if we do this:
> batch
>     :
>         ((statement1 | statement3))*  // Adding an extra paranthesis
>         (statement2)?
>     ;
> 
> 
> Thanks,
> Gokhan
> 


-- 
Xue Yong Zhi
http://seclib.blogspot.com

From gcaglar at gmail.com  Wed Mar 15 13:48:58 2006
From: gcaglar at gmail.com (Gokhan Caglar)
Date: Wed Mar 15 13:49:01 2006
Subject: [antlr-interest] Re: Non-determinism when k==2
In-Reply-To: <44188924.3000609@seclib.com>
References: <2cc5308c0603151008x358d035dkbc1ce2329ca03458@mail.gmail.com>
	<44188924.3000609@seclib.com>
Message-ID: <2cc5308c0603151348n1bf4799fjba7df12ce6bad557@mail.gmail.com>

> The nondeterminism warning comes from "linear approximate lookahead".
> Antlr may still generate the right code. if so you can either shutdown
> the warning or workaround the grammar(left factor).

Antlr is not generating the right code in this case,

The first one is wrong:
                                   do {
                                               if
((LA(1)==DO||LA(1)==BREAK) && (_tokenSet_1.member(LA(2)))) {
                                                           statement();
                                               }
                                               else {
                                                           break _loop6;
                                               }
                                   } while (true);

The second one is right:
                                               if ((LA(1)==DO) &&
(LA(2)==THIS)) {
                                                           statement1();
                                               }
                                               else if ((LA(1)==BREAK)) {
                                                           statement3();
                                               }
                                               else {
                                                           break _loop6;
                                               }
                                   } while (true);

The only difference is saying ( (statement1 | statement3) )* vs.
saying (statement1 | statement3)

Thanks,
Gokhan
From bharath_d at yahoo.com  Wed Mar 15 13:56:31 2006
From: bharath_d at yahoo.com (Bharath Devanathan)
Date: Wed Mar 15 13:56:33 2006
Subject: [antlr-interest] help with modifying c++ code
Message-ID: <20060315215631.43985.qmail@web31809.mail.mud.yahoo.com>

Hello all,

I am at a situation where we need to break binary compatiblity. As a result a lot of code has to be changed and recompiled. I am looking into automating this task.

For example, lets say I have a class A that looks like this

class A
{
  char* name;
};

After the binary compatibility change has been made, class A now will look like

class A
{
  char* name();
};


So for all code that used to refer A now has to change .

A* p;

After the change made to class A, tp->name has to change to p->name();

We have many more cases like this, but what I have described is a simplified view of the problem. 

What I am looking to do is to say

1. Find all variables of type A
2. For all these variables that match a certain criteria, (for ex variable->name), change the code to be something else. (variable->name())


I stumbled upon ANTLR from a websearch, and havent read enough about it yet. I would like to know if ANTLR is the right tool for this kind of job. If not, can someone on this list point me in the right direction?

Thanks in advance,
Bharath



From sohail at taggedtype.net  Wed Mar 15 14:01:22 2006
From: sohail at taggedtype.net (Sohail Somani)
Date: Wed Mar 15 14:01:40 2006
Subject: [antlr-interest] help with modifying c++ code
In-Reply-To: <20060315215631.43985.qmail@web31809.mail.mud.yahoo.com>
References: <20060315215631.43985.qmail@web31809.mail.mud.yahoo.com>
Message-ID: <1142460082.8731.1.camel@localhost.localdomain>

On Wed, 2006-03-15 at 13:56 -0800, Bharath Devanathan wrote
> After the change made to class A, tp->name has to change to p->name();
> 
> We have many more cases like this, but what I have described is a simplified view of the problem. 

First thing I'd ask is if this is the most complicated situation and if
so, whats wrong with good ol regex? I would look at the most complicated
thing you have to translate before looking at options.

From mark.felzer at gmail.com  Wed Mar 15 19:27:34 2006
From: mark.felzer at gmail.com (Mark Felzer)
Date: Wed Mar 15 19:27:37 2006
Subject: [antlr-interest] Type Checker Implementation Question
Message-ID: <4418DB26.8070405@gmail.com>

Hey group!

I am planning to implement a type-checker, for an existing AST, I build 
with the ANTLR.
I am weighting the option of embedding symbol table generation and 
checking into the the parser / tree walker grammar V.S. creating a 
separate application that analyzes the AST generating a symbol table.

Any advise which way I should go? Which implementation would be easier 
and more intuitive?

Thank you,
-Mark

From Ulrich.Frank at dlr.de  Thu Mar 16 02:39:20 2006
From: Ulrich.Frank at dlr.de (Ulrich Frank)
Date: Thu Mar 16 02:39:27 2006
Subject: [antlr-interest] Testing a grammar
Message-ID: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>

So summarizing your opinions and proposals I get the following:

It doesn't make sense to create test input for a application using a  
parser because the test input can only be generated based on the  
grammar itself. So of course the test input follows the rules of the  
grammar. Conclusion: I can only use the test input automatically  
generated based on the grammar to verify, if the test input is  
correct. Correct means if I see a generated test input string I can  
decide, if it is correct or not (if I see "from abc where def > 4" I  
know "select" is missing and therefore I know there is something  
wrong with my grammar definition).
Terence Parr introduced the new feature for generating strings  
following the rules of a grammar in this slides: http://www.antlr.org/ 
workshop/ANTLR2005/presentations/Automated-Language-Testing.ppt
This is coming with ANTLR v3. Of course it would be important to know  
if the generated strings cover the whole grammar or if they are  
totally random and ignore some possibilities.

Regards,
Uli
From mail at martin-probst.com  Thu Mar 16 03:19:10 2006
From: mail at martin-probst.com (Martin Probst)
Date: Thu Mar 16 03:19:18 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
References: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
Message-ID: <1142507950.5695.8.camel@localhost.localdomain>

It depends on what you want to do - throwing strings generated from the
grammar definition on your application is probably a nice test to see if
the app is stable, e.g. it doesn't crash on illegal input.

If you want to test whether it conforms to some specification (e.g. a
language standard) you'll probably have to use the tool called "human"
for that :-)

Martin

From sunjigang1965 at yahoo.com.cn  Thu Mar 16 03:35:03 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Thu Mar 16 03:35:10 2006
Subject: [antlr-interest] How to place syntactic predicate between rules
Message-ID: <20060316113503.83241.qmail@web15703.mail.cnb.yahoo.com>

both rule varDeclList and statementList in the following method declaration could be none and
their FIRST set contain ID, so when they are next to each other, nondertermistic warning was
given:

methodDecl
	:  "public" typeDenotor ID LPAREN formalList RPAREN 
			LBRACE varDeclList  statementList
			 "return" expression SEMI RBRACE
	;	

varDeclList
	:
	(varDecl)* 
	;

varDecl
	:	
	typeDenotor ID SEMI //int v; ID ID; 
	;

typeDenotor
	:
	"int"
	| ID 
 	;

statementList
	:
	(statement)* 
	;

statement
    :
     "if" LPAREN  expression RPAREN statement "else" statement 
    | ID BECOMES expression SEMI //v=8;
    ; 
		
If both confilicted subrules could be placed in one rule, I could put a syntactic predicate to
distinguish them: 

imaginaryRule
   :
   (ID BECOMES)=>ID BECOMES expression SEMI //v=8;
  | ID ID SEMI //int v; ID ID;
  ;

Does anyone have a solution to this? Is a way to put syntactic predicate between rules? 

Cheers.

Jigang



	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From antlr at shmuelhome.mine.nu  Thu Mar 16 03:55:02 2006
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Thu Mar 16 03:55:01 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <1142454234.5536.9.camel@localhost.localdomain>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>	<1142443652.5493.20.camel@localhost.localdomain>	<441872E5.4090101@shmuelhome.mine.nu>
	<1142454234.5536.9.camel@localhost.localdomain>
Message-ID: <44195216.4000400@shmuelhome.mine.nu>

Martin Probst wrote:
> I should be pretty easy to write a coverage tool for the parser that
> checks that every rule and subrule has been passed at least once (and
> every loop has been run at least 2 times, etc.) by modifying the code
> generator - that might be very useful, too.
>
> Martin
>   
Such a tool would be very welcome. Have you just volunteered?
From mark.kattenbelt at gmail.com  Thu Mar 16 05:00:18 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Thu Mar 16 05:00:27 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0 (Again)
In-Reply-To: <7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
References: <44169DBB.2000403@gmail.com>
	<7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
Message-ID: <44196162.9040705@gmail.com>

Hi Mike and others,

At least I wasn't the only one experiencing that problem then. By the 
looks of it you compile your assembly with /MDd, a multi-threaded debug 
library. If I compile with this setting, and link to any project (al be 
it an example) I get a whole lot of run-time errors.

In particular I get a problem when I use the 
TokenStreamRecognitionConstructor(RecognitionException& re) constructor, 
I get heap corruptions as soon as the result of re.getMessage() is 
called. I would like to know if ever someone experienced the same 
problems and recognizes my mistakes.

Even the examples fail. If I compile (against multi-threaded debug for 
both the antlr library and the project) calc then the same problem 
occurs (the stack):

 ...
     operator new(unsigned int size=0x0012f0ac)    C++
     std::basic_string<char,std::char_traits<char>,std::allocator<char> 
 >::_Eos(unsigned int _Newsize=0x0012f300)    C++
     std::basic_string<char,std::char_traits<char>,std::allocator<char> 
 >::assign(const 
std::basic_string<char,std::char_traits<char>,std::allocator<char> > & 
_Right=<Bad Ptr>, unsigned int _Roff=0x0040b76a, unsigned int 
_Count=0x00344818)    C++
     0012fad0   
     std::basic_string<char,std::char_traits<char>,std::allocator<char> 
 >::assign(const 
std::basic_string<char,std::char_traits<char>,std::allocator<char> > & 
_Right=<Bad Ptr>, unsigned int _Roff=0x0012f2e4, unsigned int 
_Count=0x0012f2b8)    C++
     std::allocator<char>::deallocate(char * _Ptr=0x00344888, unsigned 
int __formal=0x00000020)    C++
     std::basic_string<char,std::char_traits<char>,std::allocator<char> 
 >::_Tidy(bool _Built=true, unsigned int _Newsize=0x00000000)    C++
     std::basic_string<char,std::char_traits<char>,std::allocator<char> 
 >::~basic_string<char,std::char_traits<char>,std::allocator<char> 
 >()    C++
 >    
antlr::TokenStreamRecognitionException::TokenStreamRecognitionException(antlr::RecognitionException 
& re={...})    C++
     CalcLexer::nextToken()    C++
     antlr::TokenBuffer::fill(unsigned int amount=0x00000001)    C++
     antlr::TokenBuffer::LT(unsigned int i=0x00000001)    C++
     antlr::LLkParser::LT(unsigned int i=0x00000001)    C++
     CalcParser::atom()    C++
     CalcParser::mexpr()    C++
     CalcParser::expr()    C++
     main(int argc=0x00000001, char * * argv=0x00363380)    C++
     __tmainCRTStartup()    C
     7c816d4f   
     7c8399f3   

A simple program like the following already gives this type of error:

int main()
{
        antlr::NoViableAltForCharException a(1, "blah", 1, 1);
        throw antlr::TokenStreamRecognitionException(a);
}

I presume antlr itself is free of such bugs, but I do not understand 
where I go wrong.

If anyone could shed light on this this would be greatly appreciated.

Cheers,

Mark




>
>
> If it is any help, I built a static library (.lib) using 2.7.6 with 
> the command line.
>
> /Od /I "C:\Development\antlr\antlr-2.7.6\lib\cpp\\" /D "WIN32" /D 
> "_DEBUG" /D "_LIB" /D "_CRT_SECURE_NO_DEPRECATE" /D 
> "_VC80_UPGRADE=0x0600" /D "_MBCS" /FD /EHsc /RTC1 /MDd /Zc:wchar_t- 
> /Zc:forScope- /GR- /Fp".\Debug/antlr_lib.pch" /Fo".\Debug/" 
> /Fd".\Debug/" /FR".\Debug\\" /W3 /nologo /c /Z7 /errorReport:prompt
>
> There is a change in TokenStreamRewriteEngine.cpp (already submitted 
> to Ter)
>
> #ifndef NO_STATIC_CONSTS
> const size_t TokenStreamRewriteEngine::MIN_TOKEN_INDEX = 0;
> const int TokenStreamRewriteEngine::PROGRAM_INIT_SIZE = 100;
> #endif
>
>
> At 10:40 14/03/2006, Mark Kattenbelt wrote:
>> Hello,
>>
>> I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 
>> 2005, so far unsuccessfully.
>> In mingw, I manage to compile it fine, only took a few minutes to set 
>> up! I use the following settings for VS:
>>
>> Include dir: "lib\cpp"
>> Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
>> Run-time library: Multi-treaded debug.
>> Create precompiled headers: yes.
>> Function level linking: yes.
>> RTTI: yes.
>>
>> Which results into compiling with the following line:
>>
>> /O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" /D 
>> "ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
>> /Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" /nologo 
>> /c /TP /errorReport:prompt
>>
>> And linking with:
>>
>> /OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL 
>> /MANIFEST /MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
>> /ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib 
>> winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
>> oleaut32.lib uuid.lib odbc32.lib odbccp32.lib
>>
>> Now this fails during the linking stage, in particular it keeps 
>> finding symbols that are defined in multiple places:
>>
>> ASTFactory.obj : error LNK2005: "class std::basic_istream<char,struct 
>> std::char_traits<char> > & __cdecl antlr::eatwhite(class 
>> std::basic_istream<char,struct std::char_traits<char> > &)" 
>> (?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
>> already defined in ANTLRUtil.obj
>> ASTFactory.obj : error LNK2005: "class std::basic_string<char,struct 
>> std::char_traits<char>,class std::allocator<char> > __cdecl 
>> antlr::read_string(class std::basic_istream<char,struct 
>> std::char_traits<char> > &)" ...
>>
>> I have tried to compile without precompiled headers, because I do not 
>> see the need for them, this results in:
>>
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::CHAR" 
>> (?CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::NOT_CHAR" 
>> (?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::RANGE" 
>> (?RANGE@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>>
>> Clearly I am doing something wrong, and the settings need tweaking. 
>> Has anyone here managed to build antlr (2.7.6?) with Visual Studio 
>> (8.0?). If so could you please share your settings? Any help is 
>> appreciated.
>>
>> Also, trying to compile it into a static library does not offer any 
>> relief, the errors still persist.
>>
>> Cheers,
>>
>> Mark Kattenbelt
>>
>>
>>
>
>
> Regards
>
> Mike
>
>
> Mike Ventham
> Chief Technical Consultant
> Double V Design & Support Services
> Email : mike@doublevdesign.co.uk
>
>
>

From mark.kattenbelt at gmail.com  Thu Mar 16 05:19:05 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Thu Mar 16 05:19:13 2006
Subject: [antlr-interest] Antlr-2.7.6 with Visual Studio 8.0
In-Reply-To: <7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
References: <44169DBB.2000403@gmail.com>
	<7.0.0.16.0.20060314171734.02691480@doublevdesign.co.uk>
Message-ID: <441965C9.7010300@gmail.com>

Hi,

Forget about my previous email. The errors have been caused by my own 
stupidity. It always seems as though as soon as you decide to ask for 
help you find the cause of the problem yourself.

For future reference: The problem was that I made antlr into a dynamic 
library, and my project linked to this dll. I compiled both against the 
multi threaded debug runtime library (staticly linked), whereas I should 
have been compiling against the multi-threaded debug DLL runtime library 
(dynamicly linked). My guess is that if both the dll and the exe have 
their own staticly linked runtime library that there arise problems with 
memory allocation and deallocation on the heap, whereas a shared 
dynamicly linked library does not have this problem.

I suppose this is an obvious mistake, however I missed it.

I can start making a promela grammar now!

Mark
> Mark,
>
> If it is any help, I built a static library (.lib) using 2.7.6 with 
> the command line.
>
> /Od /I "C:\Development\antlr\antlr-2.7.6\lib\cpp\\" /D "WIN32" /D 
> "_DEBUG" /D "_LIB" /D "_CRT_SECURE_NO_DEPRECATE" /D 
> "_VC80_UPGRADE=0x0600" /D "_MBCS" /FD /EHsc /RTC1 /MDd /Zc:wchar_t- 
> /Zc:forScope- /GR- /Fp".\Debug/antlr_lib.pch" /Fo".\Debug/" 
> /Fd".\Debug/" /FR".\Debug\\" /W3 /nologo /c /Z7 /errorReport:prompt
>
> There is a change in TokenStreamRewriteEngine.cpp (already submitted 
> to Ter)
>
> #ifndef NO_STATIC_CONSTS
> const size_t TokenStreamRewriteEngine::MIN_TOKEN_INDEX = 0;
> const int TokenStreamRewriteEngine::PROGRAM_INIT_SIZE = 100;
> #endif
>
>
> At 10:40 14/03/2006, Mark Kattenbelt wrote:
>> Hello,
>>
>> I've been trying to compile a dll of antlr 2.7.6 in Visual Studio 
>> 2005, so far unsuccessfully.
>> In mingw, I manage to compile it fine, only took a few minutes to set 
>> up! I use the following settings for VS:
>>
>> Include dir: "lib\cpp"
>> Preprocessor: WIN32;_DEBUG;_WINDOWS;_USRDLL;ANTLR_EXPORTS
>> Run-time library: Multi-treaded debug.
>> Create precompiled headers: yes.
>> Function level linking: yes.
>> RTTI: yes.
>>
>> Which results into compiling with the following line:
>>
>> /O2 /I "lib\cpp" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_USRDLL" /D 
>> "ANTLR_EXPORTS" /D "_WINDLL" /FD /EHsc /MTd /Gy /Yc 
>> /Fp"Debug\antlr-2.7.6.pch" /Fo"Debug\\" /Fd"Debug\vc80.pdb" /nologo 
>> /c /TP /errorReport:prompt
>>
>> And linking with:
>>
>> /OUT:"d:\Fmt\antlr-2.7.6\Debug\antlr-2.7.6.dll" /NOLOGO /DLL 
>> /MANIFEST /MANIFESTFILE:"Debug\antlr-2.7.6.dll.intermediate.manifest" 
>> /ASSEMBLYDEBUG /ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib 
>> winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
>> oleaut32.lib uuid.lib odbc32.lib odbccp32.lib
>>
>> Now this fails during the linking stage, in particular it keeps 
>> finding symbols that are defined in multiple places:
>>
>> ASTFactory.obj : error LNK2005: "class std::basic_istream<char,struct 
>> std::char_traits<char> > & __cdecl antlr::eatwhite(class 
>> std::basic_istream<char,struct std::char_traits<char> > &)" 
>> (?eatwhite@antlr@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV23@@Z) 
>> already defined in ANTLRUtil.obj
>> ASTFactory.obj : error LNK2005: "class std::basic_string<char,struct 
>> std::char_traits<char>,class std::allocator<char> > __cdecl 
>> antlr::read_string(class std::basic_istream<char,struct 
>> std::char_traits<char> > &)" ...
>>
>> I have tried to compile without precompiled headers, because I do not 
>> see the need for them, this results in:
>>
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::CHAR" 
>> (?CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::NOT_CHAR" 
>> (?NOT_CHAR@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>> MismatchedCharException.obj : error LNK2005: "public: static int 
>> const antlr::MismatchedCharException::RANGE" 
>> (?RANGE@MismatchedCharException@antlr@@2HB) already defined in 
>> CharScanner.obj
>>
>> Clearly I am doing something wrong, and the settings need tweaking. 
>> Has anyone here managed to build antlr (2.7.6?) with Visual Studio 
>> (8.0?). If so could you please share your settings? Any help is 
>> appreciated.
>>
>> Also, trying to compile it into a static library does not offer any 
>> relief, the errors still persist.
>>
>> Cheers,
>>
>> Mark Kattenbelt
>>
>>
>>
>
>
> Regards
>
> Mike
>
>
> Mike Ventham
> Chief Technical Consultant
> Double V Design & Support Services
> Email : mike@doublevdesign.co.uk
>
>
>

From mail at martin-probst.com  Thu Mar 16 05:19:42 2006
From: mail at martin-probst.com (Martin Probst)
Date: Thu Mar 16 05:19:50 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <44195216.4000400@shmuelhome.mine.nu>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
	<1142443652.5493.20.camel@localhost.localdomain>
	<441872E5.4090101@shmuelhome.mine.nu>
	<1142454234.5536.9.camel@localhost.localdomain>
	<44195216.4000400@shmuelhome.mine.nu>
Message-ID: <1142515183.5695.15.camel@localhost.localdomain>

> Such a tool would be very welcome. Have you just volunteered?

Sorry, definitely not in the next few weeks - and generally we don't
need such a tool as we have coverage tests from other sources - so I
can't really justify spending time on it.

Martin

From ewbank at gmail.com  Thu Mar 16 06:31:05 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Mar 16 06:31:07 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <1142515183.5695.15.camel@localhost.localdomain>
References: <EF1EBB75-ECD5-4E69-8990-DA444B0E8EE6@dlr.de>
	<1142443652.5493.20.camel@localhost.localdomain>
	<441872E5.4090101@shmuelhome.mine.nu>
	<1142454234.5536.9.camel@localhost.localdomain>
	<44195216.4000400@shmuelhome.mine.nu>
	<1142515183.5695.15.camel@localhost.localdomain>
Message-ID: <dd3a065f0603160631o601dee52q510fa349edf8314f@mail.gmail.com>

Having the tests generated from the grammar seems like a bad thing,
from a project point of view.  Perhaps for the developer, for
unit-tests, but that's about it.

It can do code-coverage and make sure that syntactically legal
programs do not cause errors.  With some imagination, it could also
test behavior with syntactically illegal programs: try putting two
tokens where zero/one are allowed by "( ... )+" in the grammar, or
inject a random token 1% of the time in the walk :-).

It cannot do validation versus requirements.

It can't do much for semantic validation without much additional help.

Taking a different tack, you could generate (for TreeParsers) input
audits that verify tree shape with a simple traversal by stripping out
the actions.  At the very least, this would help developer to see
problems.

On 3/16/06, Martin Probst <mail@martin-probst.com> wrote:
> > I think Terence wrote something like that once, a tool that generates
> > random and meaningless, but syntactically correct, expressions from your
> > grammar. Maybe in the filesharing section?
> >
> That strikes me as something that might test the program that uses the
> parser but it would hardly test the parser. After all, the test input is
> guaranteed to obey the rules of the parser.
From ewbank at gmail.com  Thu Mar 16 06:35:08 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Mar 16 06:35:10 2006
Subject: [antlr-interest] help with modifying c++ code
In-Reply-To: <1142460082.8731.1.camel@localhost.localdomain>
References: <20060315215631.43985.qmail@web31809.mail.mud.yahoo.com>
	<1142460082.8731.1.camel@localhost.localdomain>
Message-ID: <dd3a065f0603160635h38df84e3kff0ca0f20b6a5472@mail.gmail.com>

There's always using the compiler as your search engine:

(1) Change the definition of a::name to a::name() - do nothing else.
(2) Now compile the code and capture the output -- *KABOOM*
(3) Use the output (mainly file/line data) as input to a script to
make the changes.

Repeat (2) and (3) until stable, then check it in :-).


On 3/15/06, Sohail Somani <sohail@taggedtype.net> wrote:
> On Wed, 2006-03-15 at 13:56 -0800, Bharath Devanathan wrote
> > After the change made to class A, tp->name has to change to p->name();
> >
> > We have many more cases like this, but what I have described is a simplified view of the problem.
>
> First thing I'd ask is if this is the most complicated situation and if
> so, whats wrong with good ol regex? I would look at the most complicated
> thing you have to translate before looking at options.
>
>
From ewbank at gmail.com  Thu Mar 16 06:39:39 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Mar 16 06:39:44 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
References: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
Message-ID: <dd3a065f0603160639s41cb2ac7gc9c0e6d4dd95ea2a@mail.gmail.com>

On 3/16/06, Ulrich Frank <Ulrich.Frank@dlr.de> wrote:
> So summarizing your opinions and proposals I get the following:
>
> It doesn't make sense to create test input for a application using a parser
> because the test input can only be generated based on the grammar itself. So
> of course the test input follows the rules of the grammar. Conclusion: I can
> only use the test input automatically generated based on the grammar to
> verify, if the test input is correct.

You can create syntactically illegal input to test error legs as well - just
inject a token that is not part of the follow set at any point in the token
stream.

- Bryan
From parrt at cs.usfca.edu  Thu Mar 16 08:42:48 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu Mar 16 08:42:51 2006
Subject: [antlr-interest] Testing a grammar
In-Reply-To: <dd3a065f0603160639s41cb2ac7gc9c0e6d4dd95ea2a@mail.gmail.com>
References: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
	<dd3a065f0603160639s41cb2ac7gc9c0e6d4dd95ea2a@mail.gmail.com>
Message-ID: <4B7B1264-C285-4FA5-B291-D23D02DAD3CD@cs.usfca.edu>

Hi Gang, nice discussion.  Note that in addtion to RandomPhrase, I  
plan on building another tool (secret name) that attempts to provide  
variations on valid programs (semantically and syntactically) that  
are invalid, again hoping to crash the language tool.

Ter

On Mar 16, 2006, at 6:39 AM, Bryan Ewbank wrote:

> On 3/16/06, Ulrich Frank <Ulrich.Frank@dlr.de> wrote:
>> So summarizing your opinions and proposals I get the following:
>>
>> It doesn't make sense to create test input for a application using  
>> a parser
>> because the test input can only be generated based on the grammar  
>> itself. So
>> of course the test input follows the rules of the grammar.  
>> Conclusion: I can
>> only use the test input automatically generated based on the  
>> grammar to
>> verify, if the test input is correct.
>
> You can create syntactically illegal input to test error legs as  
> well - just
> inject a token that is not part of the follow set at any point in  
> the token
> stream.
>
> - Bryan

From enriquebris at cimex.com.cu  Thu Mar 16 11:39:02 2006
From: enriquebris at cimex.com.cu (enriquebris@cimex.com.cu)
Date: Thu Mar 16 10:37:45 2006
Subject: [antlr-interest] please help ... I need to parse a paper ...
Message-ID: <7D750FF0E5E0984AB6FAA93D62E197F6060D018A@email1.cimex.com.cu>

Hello,,,

 

I'm trying to parse a paper. The document format is more or less like
the following:

 

Title

Authors

 

Abstract

Keywords

 

Introduction

 

...

 

References

 

First of all, I'm trying to get the text before ABSTRACT ... I have a
lexer rule -->  ABSTRACT_WORD : "abstract"; and in the parser -->
abstract : (~ABSTRACT_WORD) but it doesn't work as I expect. The thing
is: I want to obtain all the text before the word ABSTRACT
(ABSTRACT_WORD token), and the text between ABSTRACT_WORD (token) and
INTRODUCTION_WORD (Also I have a INTRODUCTION_WORD declared in the
lexer). Please,,, can anybody suggest me an idea to solve this ?

 

Enrique

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060316/655b2c51/attachment.html
From mail at martin-probst.com  Thu Mar 16 14:44:41 2006
From: mail at martin-probst.com (Martin Probst)
Date: Thu Mar 16 14:44:47 2006
Subject: [antlr-interest] please help ... I need to parse a paper ...
In-Reply-To: <7D750FF0E5E0984AB6FAA93D62E197F6060D018A@email1.cimex.com.cu>
References: <7D750FF0E5E0984AB6FAA93D62E197F6060D018A@email1.cimex.com.cu>
Message-ID: <1142549081.5720.13.camel@localhost.localdomain>

The best way to think about such stuff is probably this:
What happens if you get

Abstract
Hello World, the 
Introduction contains interesting stuff.
Introduction
As mentioned in the
Abstract this is very interesting

To get around this you will have to either impose rules on the authors
(the word Abstract may not appear in text, or at least not at the start
of lines, etc.). Or you will have to lex context dependent, e.g. after
the first "Abstract" token, "Abstract" cannot occur anymore. That
doesn't get you around the problem with the word "Introduction" within
the abstract. Or you could require the whole Abstract/Introduction
whatever text to be on one line ...

Anyways, ANTLR doesn't provide built-in support for line based parsing,
you'd have to hack that into actions yourself. ANTLR (and similar tools)
are best at token based languages like programming languages, where
keywords (like "Abstract" in your case) always mean the same thing
independent of the position in the text.

You might end up with a hand-built solution being easier than using a
parser generator like ANTLR. What about splitting up the text in lines
and checking if the line is "Abstract" and taking all subsequent lines
until one is "Introduction" (or whatever)?

HTH,
Martin


From craymer at warpiv.com  Thu Mar 16 20:30:04 2006
From: craymer at warpiv.com (Loring Craymer)
Date: Thu Mar 16 20:30:10 2006
Subject: [antlr-interest] please help ... I need to parse a paper ...
In-Reply-To: <7D750FF0E5E0984AB6FAA93D62E197F6060D018A@email1.cimex.com.cu>
Message-ID: <007001c6497b$77e10b00$8302a8c0@Fafnir>

I did something like this a few years back with PCCTS (ANTLR 1).  As Martin
points out, English keywords are not enough to handle the general case,
since the same words may appear in the body of the text.

 

What helps is to take advantage of formatting information in the document.
I used RTF (Microsoft's rich text formatting), but HTML or any other
formatting language would work as well.  Only a subset of the formatting
keywords need be recognized:  you only need to recognize formatting
information that would be coupled with a title (title such as   "Abstract").
Other keywords can be ignored in the lexer.

 

You end up with two versions of many rules:  one version recognizes the
textual keywords like "Abstract" or "Title" and a second that recognizes
generic text.  These are distinguished with syntactic predicates (ANTLR 3
may let you get by without them).  I also used syntactic predicates to
recognize textual keywords; predicate hoisting was an essential.  RTF
keywords were handled using ugh a machine-generated symbol table (I
converted a list of keywords which took arguments or had a specific type,
like "header", that needed to have their token type values changed in the
lexer; the symbol table was used inside of semantic predicates and
subsequent actions).

 

This is a problem whose solution depends heavily on predicated parsing;
solving it by hand would be a gruesome experience.  With ANTLR, it was not
that difficult, although I did run into annoying places where the RTF that I
was parsing deviated from the Microsoft spec.

 

--Loring

 

  _____  

From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
enriquebris@cimex.com.cu
Sent: Thursday, March 16, 2006 11:39 AM
To: antlr-interest@antlr.org
Subject: [antlr-interest] please help ... I need to parse a paper ...

 

Hello,,,

 

I'm trying to parse a paper. The document format is more or less like the
following:

 

Title

Authors

 

Abstract

Keywords

 

Introduction

 

.

 

References

 

First of all, I'm trying to get the text before ABSTRACT . I have a lexer
rule -->  ABSTRACT_WORD : "abstract"; and in the parser --> abstract :
(~ABSTRACT_WORD) but it doesn't work as I expect. The thing is: I want to
obtain all the text before the word ABSTRACT (ABSTRACT_WORD token), and the
text between ABSTRACT_WORD (token) and INTRODUCTION_WORD (Also I have a
INTRODUCTION_WORD declared in the lexer). Please,,, can anybody suggest me
an idea to solve this ?

 

Enrique

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060316/0c47ca7d/attachment.html
From Gerald.Khin at ids-scheer.com  Fri Mar 17 00:16:16 2006
From: Gerald.Khin at ids-scheer.com (Khin, Gerald)
Date: Fri Mar 17 00:19:24 2006
Subject: [antlr-interest] maven-antlr-plugin compatibility of
	antlrall.jarand antlr.jar?
Message-ID: <7CD50CE878D92841A224D410B2B2DF0B6BA673@049SBEVS1.me.corp.ids-scheer.com>

Hi!
 
Is there a compatibility matrix somewhere in the antlr documentation
where I could look which buildtime and runtime versions are compatible
to each other?

Or is there some written or unwritten rule telling "do never ever use a
newer antlr.jar with code that was generated using an older version"?

Cheers,
Gerald
 


________________________________

	From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Khin, Gerald
	Sent:  03/14/2006 17:48
	To: antlr-interest@antlr.org
	Subject: [antlr-interest] maven-antlr-plugin compatibility of
antlrall.jarand antlr.jar?
	
	
	Hi!
	 
	There is an antlrall-2.7.4.jar used by maven-antlr-plugin in
http://www.ibiblio.org/maven2/antlr/antlrall/
<http://www.ibiblio.org/maven2/antlr/antlrall/>  whereas 2.7.4 is the
highest version number available for that antlrall jar. But in
http://www.ibiblio.org/maven2/antlr/antlr/
<http://www.ibiblio.org/maven2/antlr/antlr/>  there is also an
antlr-2.7.5.jar and an antlr-2.7.6.jar. Now, I wonder if the code built
with the buildtime antlrall-2.7.4.jar is compatible with the runtime
libraries antlr-2.7.5.jar or antlr-2.7.6.jar?
	 
	Regards
	Gerald
	 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060317/73d1e75c/attachment.html
From moon_ari at hotmail.com  Thu Mar 16 13:50:21 2006
From: moon_ari at hotmail.com (Florian)
Date: Fri Mar 17 01:41:11 2006
Subject: [antlr-interest] Re: Type Checker Implementation Question
References: <4418DB26.8070405@gmail.com>
Message-ID: <loom.20060316T224159-827@post.gmane.org>

Hello,

Mark Felzer <mark.felzer@...> writes:
> Hey group!
> 
> I am planning to implement a type-checker, for an existing AST, I build 
> with the ANTLR.
> I am weighting the option of embedding symbol table generation and 
> checking into the the parser / tree walker grammar V.S. creating a 
> separate application that analyzes the AST generating a symbol table.
> 
> Any advise which way I should go? Which implementation would be easier 
> and more intuitive?
> 
> Thank you,
> -Mark

My choice is to type-check as soon as I've built a complete AST for an
expression, but without waiting to parse the whole input. This allows to keep
error messages in order (syntactic ones and typechecking ones) while preserving
separation of parsing and typechecking code.

I do symbol generation in the parser -- added code is small: lookup symbol
table, assign the symbol found, insert symbol in symbol table.

Florian.



From open.zone at virgin.net  Fri Mar 17 03:34:38 2006
From: open.zone at virgin.net (Micheal J)
Date: Fri Mar 17 03:17:52 2006
Subject: [antlr-interest] maven-antlr-plugin compatibility
	ofantlrall.jarand antlr.jar?
In-Reply-To: <7CD50CE878D92841A224D410B2B2DF0B6BA673@049SBEVS1.me.corp.ids-scheer.com>
Message-ID: <000201c649b6$c78f2340$6b02a8c0@hercules>

There is such an unwritten [but frequently verbalized ;-)] rule. In the C#
line for instance, breaking changes mean 2.7.4, 2.7.5 and 2.7.5 aren't
directly compatible.
 
Micheal
 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Khin, Gerald
Sent: 17 March 2006 08:16
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] maven-antlr-plugin compatibility
ofantlrall.jarand antlr.jar?


Hi!
 
Is there a compatibility matrix somewhere in the antlr documentation where I
could look which buildtime and runtime versions are compatible to each
other?

Or is there some written or unwritten rule telling "do never ever use a
newer antlr.jar with code that was generated using an older version"?

Cheers,
Gerald
 


  _____  

From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Khin, Gerald
Sent:  03/14/2006 17:48
To: antlr-interest@antlr.org
Subject: [antlr-interest] maven-antlr-plugin compatibility of
antlrall.jarand antlr.jar?


Hi!
 
There is an antlrall-2.7.4.jar used by maven-antlr-plugin in
<http://www.ibiblio.org/maven2/antlr/antlrall/>
http://www.ibiblio.org/maven2/antlr/antlrall/ whereas 2.7.4 is the highest
version number available for that antlrall jar. But in
<http://www.ibiblio.org/maven2/antlr/antlr/>
http://www.ibiblio.org/maven2/antlr/antlr/ there is also an antlr-2.7.5.jar
and an antlr-2.7.6.jar. Now, I wonder if the code built with the buildtime
antlrall-2.7.4.jar is compatible with the runtime libraries antlr-2.7.5.jar
or antlr-2.7.6.jar?
 
Regards
Gerald
 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060317/d68f211e/attachment-0001.html
From ewbank at gmail.com  Fri Mar 17 06:24:50 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Fri Mar 17 06:24:54 2006
Subject: [antlr-interest] Re: Type Checker Implementation Question
In-Reply-To: <loom.20060316T224159-827@post.gmane.org>
References: <4418DB26.8070405@gmail.com>
	<loom.20060316T224159-827@post.gmane.org>
Message-ID: <dd3a065f0603170624k52d0b91em8b5739130c64f8cc@mail.gmail.com>

To take this a step further...

(1) Build a separate tree-walking grammer as you describe.
(2) Use it as a separate tree-walking pass, for initial debugging.
(3) Finally, move calls of the semantic rules into the appropriate
parser actions.

This way, you get the isolation in which to build a clean pass; you also get
the benefits of a "single pass" for syntax and semantics.


On 3/16/06, Florian <moon_ari@hotmail.com> wrote:
> Hello,
>
> Mark Felzer <mark.felzer@...> writes:
> > Hey group!
> >
> > I am planning to implement a type-checker, for an existing AST, I build
> > with the ANTLR.
> > I am weighting the option of embedding symbol table generation and
> > checking into the the parser / tree walker grammar V.S. creating a
> > separate application that analyzes the AST generating a symbol table.
> >
> > Any advise which way I should go? Which implementation would be easier
> > and more intuitive?
> >
> > Thank you,
> > -Mark
>
> My choice is to type-check as soon as I've built a complete AST for an
> expression, but without waiting to parse the whole input. This allows to keep
> error messages in order (syntactic ones and typechecking ones) while preserving
> separation of parsing and typechecking code.
>
> I do symbol generation in the parser -- added code is small: lookup symbol
> table, assign the symbol found, insert symbol in symbol table.
>
> Florian.
>
>
>
>
From tom at tomgoff.com  Fri Mar 17 10:21:15 2006
From: tom at tomgoff.com (Tom Goff)
Date: Fri Mar 17 10:21:20 2006
Subject: [antlr-interest] Add addition "using" statements?
Message-ID: <004701c649ef$943f8500$6701a8c0@HANKY>

How can I add additional "using" or "import" statements to the top of my
generated Parser? I can find anything in the options help.

 

Thanks

Tom

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060317/431f5f27/attachment.html
From bianculld at tiscali.it  Fri Mar 17 10:28:31 2006
From: bianculld at tiscali.it (Domenico Bianculli)
Date: Fri Mar 17 10:28:46 2006
Subject: [antlr-interest] Add addition "using" statements?
In-Reply-To: <004701c649ef$943f8500$6701a8c0@HANKY>
References: <004701c649ef$943f8500$6701a8c0@HANKY>
Message-ID: <200603171928.32314.bianculld@tiscali.it>

You can put them in the header section, the first section of the grammar file.
See also http://antlr.org/doc/metalang.html#_bb3

Domenico

On Friday 17 March 2006 19:21, Tom Goff wrote:
> How can I add additional "using" or "import" statements to the top of my
> generated Parser? I can find anything in the options help.
>
>
>
> Thanks
>
> Tom
From mzawadzinski at gmail.com  Sun Mar 19 07:32:35 2006
From: mzawadzinski at gmail.com (=?ISO-8859-2?Q?Maciej_Zawadzi=F1ski?=)
Date: Sun Mar 19 07:32:40 2006
Subject: [antlr-interest] problem with comments
Message-ID: <32eb83090603190732w71e8771aq663f6f5227176f6b@mail.gmail.com>

Hi!

I've just discovered that ANTLR generates in some cases code that
can't process the grammar correctly.

...
class ZolwLexer extends Lexer;

options {
        k = 2;
}
...
MULT : '*' | '/' | '%';
CMP : '<' | '>' | "<=" | ">=" | "!=" ;
...
COMMENT : ( "//" (~ '\n')* '\n'
        | "#" (~ '\n')* '\n' )
        { $setType(ANTLR_USE_NAMESPACE(antlr)Token::SKIP); }
        ;

The problem occurs when generated code tries to distinguish between
the division ('/') and the beginning of the comment ('//').

ANTLR generates the following code:

...
if ((LA(1) == 0x23 /* '#' */  || LA(1) == 0x2f /* '/' */ ) && ((LA(2)
>= 0x0 /* '\0' */  && LA(2) <= 0x7f))) {
      mCOMMENT(true);
      theRetToken=_returnToken;
}
else if ((LA(1) == 0x2b /* '+' */  || LA(1) == 0x2d /* '-' */ ) && (true)) {
     mPLUS(true);
     theRetToken=_returnToken;
}
else if ((LA(1) == 0x25 /* '%' */  || LA(1) == 0x2a /* '*' */  ||
LA(1) == 0x2f /* '/' */ ) && (true)) {
     mMULT(true);
     theRetToken=_returnToken;
}
...

So you can clearly see that the first "if" statement is applied when
we process something like: "10 / 2", but it shouldn't. Anyone has
experienced similar problems?

I resolved it by splitting the COMMENT rule:
...
COMMENT1 : "//" (~ '\n')* '\n'
        { $setType(ANTLR_USE_NAMESPACE(antlr)Token::SKIP); }
        ;

COMMENT2 : "#" (~ '\n')* '\n'
        { $setType(ANTLR_USE_NAMESPACE(antlr)Token::SKIP); }
        ;
...

Now ANTLR generates correct code:
...
if ((LA(1) == 0x2f /* '/' */ ) && (LA(2) == 0x2f /* '/' */ )) {
   mCOMMENT1(true);
   theRetToken=_returnToken;
 }
 else if ((LA(1) == 0x2b /* '+' */  || LA(1) == 0x2d /* '-' */ ) && (true)) {
   mPLUS(true);
   theRetToken=_returnToken;
 }
 else if ((LA(1) == 0x25 /* '%' */  || LA(1) == 0x2a /* '*' */  ||
LA(1) == 0x2f /* '/' */ ) && (true)) {
   mMULT(true);
   theRetToken=_returnToken;
 }
....

Regards,
Maciek

--
Maciej Zawadzi?ski
From Vladimir.Kvashin at Sun.COM  Mon Mar 20 21:15:47 2006
From: Vladimir.Kvashin at Sun.COM (Vladmir Kvashin)
Date: Mon Mar 20 10:15:46 2006
Subject: [antlr-interest] Why does ASTFactory.create(Token tok) creates new
 token instead of using token passed as a parameter
Message-ID: <441F8C03.4090703@sun.com>

Hi,

Could anybody answer my, why TokenFactory behaves in a following way.

In method create(Token tok) it creates a new token and then just copies 
(via initialize() method) values from the token that is passes as a 
parameter.

    public AST create(Token tok) {
        AST t = create(tok.getType());
        if ( t!=null ) {
            t.initialize(tok);
        }
        return t;
    }

My idea is to make my own extension of AstFactory, which would hold the 
initial token instead of creation new one. Are some drawbacks of such 
decision? I don't see any.

If there are no, then probably it's worth to make this behaviour default?

Thanks,
Vladimir


From Kai.Koehne at student.hpi.uni-potsdam.de  Mon Mar 20 10:43:24 2006
From: Kai.Koehne at student.hpi.uni-potsdam.de (Koehne Kai)
Date: Mon Mar 20 10:43:29 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
Message-ID: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>

Hi,
 
I have used AntLR for a while now, and thought I knew most of the traps. I was wrong :-(
 
I am working on a compiler that started as a multi-person project. We decided to separate the different compiler stages in different grammars: A lexer generates tokens, a parser constructs an AST, which all the following stages consume. These stages are mostly written as TreeWalkers, which all inherit from an abstract TreeWalker grammar describing the output of the parser ... I think this is the standard way to do it with AntLR.
 
However, I just detected that the compiler fails to reject a lot of incorrect programs! This happens because the parser sometimes generates AST nodes that the TreeWalker grammar just silently ignores ... First I thought that there is something wrong with AntLR or with my error-handling code. But then I reread the documentation, and there it is:
 
"An important thing to remember when specifying tree patterns and tree grammars in general is that sufficient matches are done not exact matches. As long as the tree satistfies the pattern, a match is reported, regardless of how much is left unparsed."
 
This can be very annoying! If there is an inconsistency between the Parser and the TreeWalker grammar, there is very little chance to detect it. Instead, unknown nodes are sometimes silently ignored. Is there a way to turn off this feature? How do you ensure that the TreeWalker grammars really correspond to the AST generated by the parser?
 
Regards,
 
Kai Koehne
 
From parrt at cs.usfca.edu  Mon Mar 20 11:06:22 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 11:06:27 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
Message-ID: <08EC8D6C-B8BE-489D-BDE9-562E487285BD@cs.usfca.edu>


On Mar 20, 2006, at 10:43 AM, Koehne Kai wrote:
> "An important thing to remember when specifying tree patterns and  
> tree grammars in general is that sufficient matches are done not  
> exact matches. As long as the tree satistfies the pattern, a match  
> is reported, regardless of how much is left unparsed."
>
> This can be very annoying! If there is an inconsistency between the  
> Parser and the TreeWalker grammar, there is very little chance to  
> detect it. Instead, unknown nodes are sometimes silently ignored.  
> Is there a way to turn off this feature? How do you ensure that the  
> TreeWalker grammars really correspond to the AST generated by the  
> parser?

The funny part is that v3 enforces this strictly, but now I'm trying  
to find out how to turn off for quick filtering!  ;)

Ter
From mail at martin-probst.com  Mon Mar 20 11:07:48 2006
From: mail at martin-probst.com (Martin Probst)
Date: Mon Mar 20 11:07:57 2006
Subject: [antlr-interest] Why does ASTFactory.create(Token tok) creates
	new token instead of using token passed as a parameter
In-Reply-To: <441F8C03.4090703@sun.com>
References: <441F8C03.4090703@sun.com>
Message-ID: <1142881668.11121.1.camel@localhost.localdomain>

> In method create(Token tok) it creates a new token and then just copies 
> (via initialize() method) values from the token that is passes as a 
> parameter.

Are you sure? I don't have the code here right now, but I think
create(Token) returns an AST node, not a Token, and then initialises it
using the token.

Martin

From mail at martin-probst.com  Mon Mar 20 11:14:35 2006
From: mail at martin-probst.com (Martin Probst)
Date: Mon Mar 20 11:14:44 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
Message-ID: <1142882075.11121.7.camel@localhost.localdomain>

Hi,

you might get around it by specifying an optional error rule, e.g.

fooRule: #(A B C)

gets

fooRule: #(A #(B error) #(C error) error)

error: ( . { throw new ... } )?

So every rule allows for another (virtual) child of any token type, and
throws an error if it encounters one. However I admit having to write
that everywhere sucks.

Martin

PS: what's your project at the HPI?

From mail at martin-probst.com  Mon Mar 20 11:19:14 2006
From: mail at martin-probst.com (Martin Probst)
Date: Mon Mar 20 11:19:19 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <08EC8D6C-B8BE-489D-BDE9-562E487285BD@cs.usfca.edu>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
	<08EC8D6C-B8BE-489D-BDE9-562E487285BD@cs.usfca.edu>
Message-ID: <1142882354.11121.13.camel@localhost.localdomain>

> The funny part is that v3 enforces this strictly, but now I'm trying  
> to find out how to turn off for quick filtering!  ;)

In my opinion I need two things:
      * Complete tree parsers that check for everything (translation)
      * Matchers that search the tree for certain patterns
        (optimisation)
Both are not exactly what ANTLR 2 is providing at the moment.

IMHO it would be very nice if this was an option in tree grammars in v3.

Martin

From parrt at cs.usfca.edu  Mon Mar 20 12:01:36 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 12:01:39 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <1142882354.11121.13.camel@localhost.localdomain>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
	<08EC8D6C-B8BE-489D-BDE9-562E487285BD@cs.usfca.edu>
	<1142882354.11121.13.camel@localhost.localdomain>
Message-ID: <255C7EEA-93FF-4BA9-8806-E8E3AC1D7FB0@cs.usfca.edu>


On Mar 20, 2006, at 11:19 AM, Martin Probst wrote:

>> The funny part is that v3 enforces this strictly, but now I'm trying
>> to find out how to turn off for quick filtering!  ;)
>
> In my opinion I need two things:
>       * Complete tree parsers that check for everything (translation)
>       * Matchers that search the tree for certain patterns
>         (optimisation)
> Both are not exactly what ANTLR 2 is providing at the moment.
>
> IMHO it would be very nice if this was an option in tree grammars  
> in v3.

I completely agree.  It's on my list.
Ter

From mdanjou at neterion.com  Mon Mar 20 12:47:15 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 12:47:20 2006
Subject: [antlr-interest] antlrworks and gij
Message-ID: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>

I have a problem starting antlrworks with gij:

$ gij -jar antlrworks-1.0ea8.jar
Exception in thread "main" java.lang.UnsupportedOperationException
    at java.awt.Window.setLocationRelativeTo(java.awt.Component) 
(/usr/lib/libgcj.so.5.0.0)
    at org.antlr.works.SplashScreen.SplashScreen() (Unknown Source)
    at org.antlr.works.IDE.main(java.lang.String[]) (Unknown Source)

How do I get it to work?

Thanks,
Martin
From parrt at cs.usfca.edu  Mon Mar 20 13:26:20 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 13:26:23 2006
Subject: [antlr-interest] antlrworks and gij
In-Reply-To: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
Message-ID: <E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>

sounds like a GCJ implementation issue...what platform?
Ter
On Mar 20, 2006, at 12:47 PM, Martin d'Anjou wrote:

> I have a problem starting antlrworks with gij:
>
> $ gij -jar antlrworks-1.0ea8.jar
> Exception in thread "main" java.lang.UnsupportedOperationException
>    at java.awt.Window.setLocationRelativeTo(java.awt.Component) (/ 
> usr/lib/libgcj.so.5.0.0)
>    at org.antlr.works.SplashScreen.SplashScreen() (Unknown Source)
>    at org.antlr.works.IDE.main(java.lang.String[]) (Unknown Source)
>
> How do I get it to work?
>
> Thanks,
> Martin

From mdanjou at neterion.com  Mon Mar 20 13:58:45 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 13:58:49 2006
Subject: [antlr-interest] antlrworks and gij
In-Reply-To: <E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
Message-ID: <Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>

gij (GNU libgcj) version 3.4.4 20050721 (Red Hat 3.4.4-2)

i.e. CentOS.

Martin

On Mon, 20 Mar 2006, Terence Parr wrote:

> sounds like a GCJ implementation issue...what platform?
> Ter
> On Mar 20, 2006, at 12:47 PM, Martin d'Anjou wrote:
>
>> I have a problem starting antlrworks with gij:
>> 
>> $ gij -jar antlrworks-1.0ea8.jar
>> Exception in thread "main" java.lang.UnsupportedOperationException
>>   at java.awt.Window.setLocationRelativeTo(java.awt.Component) 
>> (/usr/lib/libgcj.so.5.0.0)
>>   at org.antlr.works.SplashScreen.SplashScreen() (Unknown Source)
>>   at org.antlr.works.IDE.main(java.lang.String[]) (Unknown Source)
>> 
>> How do I get it to work?
>> 
>> Thanks,
>> Martin
>
From parrt at cs.usfca.edu  Mon Mar 20 14:34:52 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 14:34:55 2006
Subject: [antlr-interest] antlrworks and gij
In-Reply-To: <Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
	<Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
Message-ID: <9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>


On Mar 20, 2006, at 1:58 PM, Martin d'Anjou wrote:

> gij (GNU libgcj) version 3.4.4 20050721 (Red Hat 3.4.4-2)
>
> i.e. CentOS.

How good is GJC's AWT implementation these days?  That must be the  
culprit...works fine on linux, mac, pc.

Ter
From mdanjou at neterion.com  Mon Mar 20 14:47:18 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 14:47:24 2006
Subject: [antlr-interest] antlrworks and gij
In-Reply-To: <9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
	<Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
	<9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
Message-ID: <Pine.LNX.4.63.0603201746300.6039@martin.s2io.com>

I installed Sun's j2re and it works.

On Mon, 20 Mar 2006, Terence Parr wrote:
>
> On Mar 20, 2006, at 1:58 PM, Martin d'Anjou wrote:
>
>> gij (GNU libgcj) version 3.4.4 20050721 (Red Hat 3.4.4-2)
>> 
>> i.e. CentOS.
>
> How good is GJC's AWT implementation these days?  That must be the 
> culprit...works fine on linux, mac, pc.
>
> Ter
From mdanjou at neterion.com  Mon Mar 20 15:05:26 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 15:05:31 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
	<Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
	<9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
Message-ID: <Pine.LNX.4.63.0603201752500.6039@martin.s2io.com>

The following highly simplified grammar:

grammar mygrammar;
def	:	ID;
ID	:	LETTER;
LETTER	:	'a';

Gives me this error in antlrworks:
  "The following token definitions are unreachable: LETTER"

When I change "ID" to lower case "id", it works...
Am I missing something?

Martin
From dragonoe at mcmaster.ca  Mon Mar 20 15:13:13 2006
From: dragonoe at mcmaster.ca (O.E. Dragon)
Date: Mon Mar 20 15:13:20 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <Pine.LNX.4.63.0603201752500.6039@martin.s2io.com>
Message-ID: <web-121018583@cgpsrv2.cis.mcmaster.ca>

On Mon, 20 Mar 2006 18:05:26 -0500 (EST)
 "Martin d'Anjou" <mdanjou@neterion.com> wrote:
> The following highly simplified grammar:
> 
> grammar mygrammar;
> def	:	ID;
> ID	:	LETTER;
> LETTER	:	'a';
> 
> Gives me this error in antlrworks:
>   "The following token definitions are unreachable: LETTER"
> 
> When I change "ID" to lower case "id", it works...
> Am I missing something?

By convention, grammar rule that start with a lower case letter are
expected to be parser rules, and those starting with an upper case
letter are lexer rules.

I don't know how ANTLR v3 works but in v2 you need to put parser rules
in a separate grammar section.

Cheers,
-Olivier
From parrt at cs.usfca.edu  Mon Mar 20 15:29:49 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 15:29:58 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <Pine.LNX.4.63.0603201752500.6039@martin.s2io.com>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
	<Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
	<9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
	<Pine.LNX.4.63.0603201752500.6039@martin.s2io.com>
Message-ID: <508932CD-8E4B-46A9-8005-C752941C79BC@cs.usfca.edu>


On Mar 20, 2006, at 3:05 PM, Martin d'Anjou wrote:

> The following highly simplified grammar:
>
> grammar mygrammar;
> def	:	ID;
> ID	:	LETTER;
> LETTER	:	'a';
>
> Gives me this error in antlrworks:
>  "The following token definitions are unreachable: LETTER"

ID is a letter is an 'a' hence the two are equivalent.  ANTLR chooses  
first.  You want

ID : LETTER+ ;

fragment LETTER : 'a' ;

I think.

Ter

From mdanjou at neterion.com  Mon Mar 20 15:32:45 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 15:32:51 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <web-121018583@cgpsrv2.cis.mcmaster.ca>
References: <web-121018583@cgpsrv2.cis.mcmaster.ca>
Message-ID: <Pine.LNX.4.63.0603201826550.6039@martin.s2io.com>

On Mon, 20 Mar 2006, O.E. Dragon wrote:
> On Mon, 20 Mar 2006 18:05:26 -0500 (EST)
> "Martin d'Anjou" <mdanjou@neterion.com> wrote:
>> The following highly simplified grammar:
>>
>> grammar mygrammar;
>> def	:	ID;
>> ID	:	LETTER;
>> LETTER	:	'a';
>>
>> Gives me this error in antlrworks:
>>   "The following token definitions are unreachable: LETTER"
>>
>> When I change "ID" to lower case "id", it works...
>> Am I missing something?
>
> By convention, grammar rule that start with a lower case letter are
> expected to be parser rules, and those starting with an upper case
> letter are lexer rules.
>
> I don't know how ANTLR v3 works but in v2 you need to put parser rules
> in a separate grammar section.

I have looked at the examples for v3, but I don't find how to create a 
seperate section for lexer rules. The closest is the ruby.g file, where it 
has the GVAR token defined in terms of ID, but I don't see what it is that 
explicitely seperates the grammar and the lexer.

Martin
From parrt at cs.usfca.edu  Mon Mar 20 15:40:10 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon Mar 20 15:40:14 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <Pine.LNX.4.63.0603201826550.6039@martin.s2io.com>
References: <web-121018583@cgpsrv2.cis.mcmaster.ca>
	<Pine.LNX.4.63.0603201826550.6039@martin.s2io.com>
Message-ID: <7AACAE7C-15AE-49F5-B195-B6BA84AE5198@cs.usfca.edu>

stick with one grammar file for now though you can say "lexer grammar  
foo;" and put in separate file.
Ter
On Mar 20, 2006, at 3:32 PM, Martin d'Anjou wrote:

> On Mon, 20 Mar 2006, O.E. Dragon wrote:
>> On Mon, 20 Mar 2006 18:05:26 -0500 (EST)
>> "Martin d'Anjou" <mdanjou@neterion.com> wrote:
>>> The following highly simplified grammar:
>>>
>>> grammar mygrammar;
>>> def	:	ID;
>>> ID	:	LETTER;
>>> LETTER	:	'a';
>>>
>>> Gives me this error in antlrworks:
>>>   "The following token definitions are unreachable: LETTER"
>>>
>>> When I change "ID" to lower case "id", it works...
>>> Am I missing something?
>>
>> By convention, grammar rule that start with a lower case letter are
>> expected to be parser rules, and those starting with an upper case
>> letter are lexer rules.
>>
>> I don't know how ANTLR v3 works but in v2 you need to put parser  
>> rules
>> in a separate grammar section.
>
> I have looked at the examples for v3, but I don't find how to  
> create a seperate section for lexer rules. The closest is the  
> ruby.g file, where it has the GVAR token defined in terms of ID,  
> but I don't see what it is that explicitely seperates the grammar  
> and the lexer.
>
> Martin

From ewbank at gmail.com  Mon Mar 20 16:47:32 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Mon Mar 20 16:47:35 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
Message-ID: <dd3a065f0603201647p5b2d5221u34be94c92a6f7f01@mail.gmail.com>

One thing that will help is to share token types using the import mechanism.
We have the Parser produce a token file, and the TreeParsers use that token
*.txt file as their token set.  To audit, use diff of the Parser's *.txt file
with each TreeParser's *.txt file.

Another thing is a light-weight tree audit pass (one rule, one lookup table);
We implemented tree audit passes with a rule and a lookup table:

   node : #(op:. { audit(op->getType(), op->numKids()); } ( node )* );

The audit() method looks up a node type in a table, and verifies that the
number of kids is correct.  It can also report if there's a node that is not in
the table of NodeType->#kids map.

We also use more precise audit passes that define the contract between passes
by detecting correctly formed trees:

   noMoreKids[AST root] : ( . { report failure here; } )? ;

   expr : #(op:EXPRESSION value noMoreKids[#op]);
   value : add | sub | mult | div | .... ;
   add : #(op: ADD value value noMoreKids[#op] );
   sub : #(op: SUB value value noMoreKids[#op] );
   mult : #(op: MULT value value noMoreKids[#op] );
   div : #(op: DIV value value noMoreKids[#op] );
   // etc

Hope this helps,
- Bryan E

On 3/20/06, Koehne Kai <Kai.Koehne@student.hpi.uni-potsdam.de> wrote:
> Hi,
>
> I have used AntLR for a while now, and thought I knew most of the traps. I was wrong :-(
>
> I am working on a compiler that started as a multi-person project. We decided
> to separate the different compiler stages in different grammars: A lexer
> generates tokens, a parser constructs an AST, which all the following stages
> consume. These stages are mostly written as TreeWalkers, which all inherit
> from an abstract TreeWalker grammar describing the output of the parser ... I
> think this is the standard way to do it with AntLR.
>
> However, I just detected that the compiler fails to reject a lot of incorrect
> programs! This happens because the parser sometimes generates AST nodes that
> the TreeWalker grammar just silently ignores ... First I thought that there
> is something wrong with AntLR or with my error-handling code. But then I
> reread the documentation, and there it is:
>
> "An important thing to remember when specifying tree patterns and tree
> grammars in general is that sufficient matches are done not exact matches. As
> long as the tree satistfies the pattern, a match is reported, regardless of
> how much is left unparsed."
>
> This can be very annoying! If there is an inconsistency between the Parser
> and the TreeWalker grammar, there is very little chance to detect it.
> Instead, unknown nodes are sometimes silently ignored. Is there a way to turn
> off this feature? How do you ensure that the TreeWalker grammars really
> correspond to the AST generated by the parser?
>
> Regards,
>
> Kai Koehne
>
>
From mdanjou at neterion.com  Mon Mar 20 16:56:40 2006
From: mdanjou at neterion.com (Martin d'Anjou)
Date: Mon Mar 20 16:56:44 2006
Subject: [antlr-interest] antlrworks 3.0ea8 unreachable error
In-Reply-To: <508932CD-8E4B-46A9-8005-C752941C79BC@cs.usfca.edu>
References: <Pine.LNX.4.63.0603201545200.6039@martin.s2io.com>
	<E13D6AB0-5B9D-4E02-B567-EFE489812B16@cs.usfca.edu>
	<Pine.LNX.4.63.0603201637400.6039@martin.s2io.com>
	<9C265CDA-DADC-4B81-A2BC-C6760D6C6775@cs.usfca.edu>
	<Pine.LNX.4.63.0603201752500.6039@martin.s2io.com>
	<508932CD-8E4B-46A9-8005-C752941C79BC@cs.usfca.edu>
Message-ID: <Pine.LNX.4.63.0603201954471.9863@martin.s2io.com>

On Mon, 20 Mar 2006, Terence Parr wrote:
>
> On Mar 20, 2006, at 3:05 PM, Martin d'Anjou wrote:
>
>> The following highly simplified grammar:
>> 
>> grammar mygrammar;
>> def	:	ID;
>> ID	:	LETTER;
>> LETTER	:	'a';
>> 
>> Gives me this error in antlrworks:
>> "The following token definitions are unreachable: LETTER"
>
> ID is a letter is an 'a' hence the two are equivalent.  ANTLR chooses first. 
> You want
>
> ID : LETTER+ ;
>
> fragment LETTER : 'a' ;

Awesome. "fragment" works. Thanks.

Martin
From priya.uky at gmail.com  Tue Mar 21 08:28:07 2006
From: priya.uky at gmail.com (Priya)
Date: Tue Mar 21 08:28:11 2006
Subject: [antlr-interest] Attributes on AST nodes
Message-ID: <2b8e23150603210828j746a9a4di1694c4499aded9c3@mail.gmail.com>

Hi Everyone,
I am parsing a C-like syntax with C++ grammar specified in ANTLR.
This is a small snippet from my program .

int:3 a[10]; // a 3 bit integer declaration
int:4 b[10];
int:2 c[5];

The grammar description looks like

type COLON Integer Name LSQB Integer RSQB SEMI;

I modify the default AST structure and now the  AST for this
declaration looks like

a----------------b ----------------c
|                  |                  |
int---[           int---[           int---[
|      |            |     |            |     |
3     10         4    10         2     5

for the declaration part
 I make the AST nodes a ,b and c to be of type NAMENode , where i
override the Base
AST factory that I already have with the methods of NAMENode and i add
additional methods called get_width() and get_precision() that walk
down the tree to get the values using the getFirstChild() and
getNextSibling() methods . This width and precision information is
recorded in a symbol table ...

when I encounter an expression like the following in my source language ,
c[2]=a[5]+b[7];

I want to know the precision of the variables 'a' and 'b'  and perform
a promotion operation in order to add the two variables.
I can go do a symbol table look up to find this out but ,
Is there a way to directly encode the precision and width information as
a.precision , b.precision  a.width b.width etc directly  in the node itself?

Hope i made my question clear ..
Thanks in advance for your help
Priya
From jpequery at objecteering.com  Tue Mar 21 09:37:12 2006
From: jpequery at objecteering.com (Jerome Pequery)
Date: Tue Mar 21 09:32:30 2006
Subject: [antlr-interest] my parser loops
Message-ID: <442039C8.70904@objecteering.com>

Hi everyone,

I have written a java parser using antlr 2.7.2, having for particularity 
to integrate comments into the AST while parsing. And i have a problem 
using class contents and what is between { and }:

> // This is the body of a class.  You can have fields and extra semicolons,
> // That's about it (until you see what a field is...)
> classBlock
>     : LCURLY!
>         ((j:commentDefinition)?
>             (    (field[#j])=>field[#j]
>             |     (semiOrSemiComment)
>                 {
>                     astFactory.addASTChild(currentAST, j_AST);
>                     break;
>                 }
>             )
>         )*
>     RCURLY!
>       {#classBlock = #([OBJBLOCK, "OBJBLOCK"], #classBlock);}
>     ;


I parse an optional comment (commentdefinition) and, if there is, parse 
a field (attribute or operation), passing it its association comment as 
parameter.

But now, if the comment close the class content, as in this example :

> public class GameStatusLabel extends JLabel implements GameListener {
>     /**
>      * commentaire
>      */
>     public void updateStatus(String message)
>     {
>         frame.addWindowListener(new WindowAdapter()
>         {
>         });
>     }
>
>     //public Dimension getMaximumSize() {
>     //Dimension d = getPreferredSize();
>     //d.width = Short.MAX_VALUE;
>     //return d;
>     //}
> }

There is no associated field for my comment. So the parser give me a 
syntax error on }.

Now, if I use sytactic predicates to check for this case and simply drop 
theses comments, so my rule is modified.

> classBlock
>     : LCURLY!
>         ((j:commentDefinition)?
>             (    (field[#j])=>field[#j]
>             |     (semiOrSemiComment)
>                 {
>                     astFactory.addASTChild(currentAST, j_AST);
>                     break;
>                 }
>             | (RCURLY)=> {
>                     astFactory.addASTChild(currentAST, j_AST);
>                     break;
>             }
>             )
>         )*
>     RCURLY!
>       {#classBlock = #([OBJBLOCK, "OBJBLOCK"], #classBlock);}
>     ;

The syntax error disappear, and my code is parsed. But anonymous classes 
parsing are now looping. In my upper java sample, the generated parser 
loop indefinitly with LA(1)=RCURLY and LA(2)=RPAREN.

How can I correct my grammar to support both comments  at end of a class 
and anonymous classes ?

Thanks in advance,

Jerome Pequery



From open.zone at virgin.net  Tue Mar 21 10:26:30 2006
From: open.zone at virgin.net (Micheal J)
Date: Tue Mar 21 10:09:34 2006
Subject: [antlr-interest] V3 & C#
In-Reply-To: <2E909902FD3A03419E3A905908AE3DD401A98259@UKNSM201.emea.corp.eds.com>
Message-ID: <004201c64d14$fa60f260$6b02a8c0@hercules>

> Hi Guys, Ter,
> 
> 	Im about to embark on a not unsubstantial language 
> transformation problem, and was wondering whether I should 
> use 2.7.6 or go for V3 with its nice features (and damn, 
> antlr works look the dogs danglies). However, I'd really 
> prefer the codegen to be in .Net (c#) and also im wondering 
> how stable/bug free V3 is compared to 2.7.6? I've checked out 
> the V3 feature set and would really like to make the jump but 
> I don't want to get half way through my project and discover 
> a show stopper of a problem, which I wouldn't have 
> encountered with 2.7.6.
> 
> How far off is the C# output? Kunle? Anyone?

"Working in the lab". Tested with a few samples. Not bundled with last v3
release. Maybe next.

V3 is still in development and is *still* changing. It's bleeding edge stuff
so, you will need to do testing with your actual grammars to determine if
using V3 rather than V2 is for you.

> And please tell me that AntlrWorks will use that and output 
> the c# too? Pretty please. Don't make me beg!

Can't comment on AntlrWorks beyond saying that it would eventually support
"remotely" debugging non-Java Lexers/Parsers/TreeParsers via over some IPC
mechanism.


Cheers,

Micheal

From open.zone at virgin.net  Tue Mar 21 10:26:30 2006
From: open.zone at virgin.net (Micheal J)
Date: Tue Mar 21 10:09:42 2006
Subject: [antlr-interest] Expression parser expecting token at EOF
In-Reply-To: <2fb2e54f0603141148j2cd3f84eo8c98c994443d5cd3@mail.gmail.com>
Message-ID: <004301c64d14$fb50d0a0$6b02a8c0@hercules>

Hi Aaron,

> I apologize if this is the wrong forum for this message, but 
> I'm still new here (so punt me the right direction if need 
> be).  I've written a parser for what I think is a relatively 
> simple grammar for expressions.  I'm using antlr 2.7.5 with 
> C# as the language.

ANTLR 2.7.6 has been out for a while now.

> I noticed that when I provided the input "test" to the 
> expression element that it would fail when attempting to do a 
> lookahead(1).  So I narrowed the problem down to the variant 
> element that is listed in the grammer and reduced the variant 
> element to only allow one expression for ease of reading.
> 
> I wrote a small C# wrapper around this that calls variant() 
> on the parser.
> 
> The sample works for the inputs "test(20)" and "test[20]", 
> but fails for "test". The problem appears to be in the output 
> code to "variantAtoms" which performs a switch(LA(1)) and 
> then requires a token to be present or it throws 
> NoViableAltException and my execution is done.
> 
> Ironically, if I enter "test)" it works.  variantAtom has a 
> case statement for RPAREN and for the life of me I can't 
> understand where in the tree it would expect to see RPAREN as 
> the next token.
> 
> Thanks in advance...

I tried your grammar with ANTLR 2.7.6 (language=C#) and it works as
expected:

"test" => fails because variant is defined as "IDENT variantAtoms"
"test)" => fails for same reason since ")" is not matched as a
"variantAtoms"

"test(20)", "test[20" => recognized.


Cheers,

Micheal
ANTLR/C#

From parrt at cs.usfca.edu  Tue Mar 21 10:11:26 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Mar 21 10:11:32 2006
Subject: [antlr-interest] V3 & C#
In-Reply-To: <004201c64d14$fa60f260$6b02a8c0@hercules>
References: <004201c64d14$fa60f260$6b02a8c0@hercules>
Message-ID: <E91BC359-16BB-4DE5-B1A3-28F246ADD850@cs.usfca.edu>


On Mar 21, 2006, at 10:26 AM, Micheal J wrote:
>> And please tell me that AntlrWorks will use that and output
>> the c# too? Pretty please. Don't make me beg!
>
> Can't comment on AntlrWorks beyond saying that it would eventually  
> support
> "remotely" debugging non-Java Lexers/Parsers/TreeParsers via over  
> some IPC
> mechanism.

ANTLR generates the output so ANTLRWorks should just...well, work :)

Ter
From jsamort at rogers.com  Tue Mar 21 15:42:20 2006
From: jsamort at rogers.com (Scott Amort)
Date: Tue Mar 21 15:42:23 2006
Subject: [antlr-interest] antlr 2.7.6 and C#
Message-ID: <1142984540.11594.4.camel@localhost>

Hi All,

I've been meaning to ask this for a while.  When I try to compile ANTLR
2.7.6 on my Linux machine, with C# enabled, I get the following error:

config.status: creating lib/csharp/Makefile
config.status: creating lib/csharp/src/Makefile
config.status: error: cannot find input file: lib/csharp/src/Makefile.in

/lib/csharp/src is empty!

Disabling C# allows the compilation to proceed as expected.  The
antlr-2.7.6 tarball seems to being missing that src directory entirely.
Perhaps someone might be able to advise me on where the missing files
have gone!

Best,
Scott

From tom at tomgoff.com  Tue Mar 21 16:30:52 2006
From: tom at tomgoff.com (Tom Goff)
Date: Tue Mar 21 16:31:00 2006
Subject: [antlr-interest] Mix Custom and Default error handling...
Message-ID: <010601c64d47$e0445830$6701a8c0@HANKY>

Hello,

I would like to use the default error/exception handling built into antlr
2.7.5, but I would like to add some clean up code before it's executed. For
example,

myRule:
	{
		MyRuleClass rc = null;
	}
	:
	{
		rc = new MyRuleClass();
	}
	RULE
	a:ID { rc.ID = a.getText(); }
	{ this.Rules.Add(rc); }
	;

In this rule, I would like to delete rc if an exception is thrown. I know I
can modify it like so:

myRule:
	{
		MyRuleClass rc = null;
	}
	:
	{
		rc = new MyRuleClass();
	}
	RULE
	a:ID { rc.ID = a.getText(); }
	{ this.Rules.Add(rc); }
	;
	exception // for rule
		catch [RecognitionException ex] {
			if (null == rc)
				delete rc;
		}

But then I lose the call to reportError (which I can easily add) and recover
(which I can't add easily). How can I reproduce or keep the call to recover?
Or is there another easy option?

Any help would be great and thanks,
Tom

From swapnil.kashikar at gmail.com  Wed Mar 22 00:00:27 2006
From: swapnil.kashikar at gmail.com (Swapnil Kashikar)
Date: Wed Mar 22 00:00:30 2006
Subject: [antlr-interest] PLSQL parsing nondeterminism
Message-ID: <b38f063f0603220000i4a78481dra3fdbbfdeeb2f022@mail.gmail.com>

Hi,
I am very new to antlr.
I was trying to parse PLSQL select  statement with the following grammar and
got the following warning:
Can't figure out what alt 1 and alt 2 are and how to remove this
non-determinism.
Thanks,
SKashikar

--------------
warning: nondeterminism between alts 1 and 2 of block upon
k==1 CONNECT
k==2 BY
--------------
The grammar snippet is :

subquery :
  "SELECT"
 (distinct_all_or_unique)? select_list
 from_clause
 (where_clause)?
 (hierarchical_query_clause)?
 (group_by_clause)?
 (having_clause)?
 (subquery_clause)?
 (order_by_clause)?
 ;

hierarchical_query_clause :
 "CONNECT" "BY" connect_by_expression
 ;

connect_by_expression : expression
 ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060322/bfdde0f9/attachment.html
From open.zone at virgin.net  Wed Mar 22 01:28:58 2006
From: open.zone at virgin.net (Micheal J)
Date: Wed Mar 22 01:34:21 2006
Subject: [antlr-interest] antlr 2.7.6 and C#
In-Reply-To: <1142984540.11594.4.camel@localhost>
Message-ID: <005a01c64d93$0d29c3d0$6b02a8c0@hercules>

> Hi All,
> 
> I've been meaning to ask this for a while.  When I try to 
> compile ANTLR 2.7.6 on my Linux machine, with C# enabled, I 
> get the following error:
> 
> config.status: creating lib/csharp/Makefile
> config.status: creating lib/csharp/src/Makefile
> config.status: error: cannot find input file: 
> lib/csharp/src/Makefile.in
> 
> /lib/csharp/src is empty!
> 
> Disabling C# allows the compilation to proceed as expected.  
> The antlr-2.7.6 tarball seems to being missing that src 
> directory entirely. Perhaps someone might be able to advise 
> me on where the missing files have gone!

/lib/csharp/src => /lib/csharp/antlr.runtime

The buildfiles were updated prior to 2.7.6 release iirc.

From mark.kattenbelt at gmail.com  Wed Mar 22 01:54:52 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Wed Mar 22 01:54:58 2006
Subject: [antlr-interest] ASTRefCount and Dynamic Libraries (c++).
Message-ID: <44211EEC.9020901@gmail.com>

Hello all,

I most likely am wrong but I think I may have found an issue in Antlr
2.7.6 with MSVC 8.0 when compiling antlr into a dynamic library. The
issue is the following: Class templates can typically not be included in
dynamic libraries, as it is not known with which types they will be
instantiated. They should be defined totally in the headers, so that
projects using the library can include the instantations themselves.

Now there is a class in the antlr library defined as:

template<class T>
    class ANTLR_API ASTRefCount
{
    ..
}

Which is rightfully implemented in the header only. But when someone
compiles this into a DLL file this definition is typically not included
in the exported symbols.

But say you implement your custom AST class and include an instantiation
of ASTRefCount (like i did)

#include <antlr/CommonAST.hpp>
#include <antlr/ASTFactory.hpp>
#include <antlr/ASTRefCount.hpp>

class PromelaAST;

typedef antlr::ASTRefCount<PromelaAST> RefPromelaAST;
template class antlr::ASTRefCount<PromelaAST>;

Then there is a problem, because the ANTLR_IMPORTS directive means that
ANTLR_API is expanded to:

__declspec(dllimport)

Meaning that the linker should look in the antlr library for the
antlr::ASTRefCount<PromelaAST> symbol, which is incorrect I think (it is
fine for all normal classes and functions, but not for class templates,
function templates or member templates).
Solution: All is well when ANTLR_API is removed from the ASTRefCount
class template definition.

Here in terms of code what goes wrong (just as an indication of the
errors received):

http://cpp.sourceforge.net/?show=13927

Feel free to prove me wrong and tell me what I should have done
different (for I am not an expert).

Cheers,

Mark Kattenbelt








From mail at martin-probst.com  Wed Mar 22 02:22:51 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 22 02:22:57 2006
Subject: [antlr-interest] PLSQL parsing nondeterminism
In-Reply-To: <b38f063f0603220000i4a78481dra3fdbbfdeeb2f022@mail.gmail.com>
References: <b38f063f0603220000i4a78481dra3fdbbfdeeb2f022@mail.gmail.com>
Message-ID: <1143022971.5503.10.camel@localhost.localdomain>

Hi,
> 
> I was trying to parse PLSQL select  statement with the following
> grammar and got the following warning:
> Can't figure out what alt 1 and alt 2 are and how to remove this
> non-determinism.

The alternative with alt 1 and alt 2 is in this case whether or not to
actually enter an optional block. This is just a guess as I don't know
the exact line or your complete grammar, but can a subquery clause start
with "CONNECT" "BY"?

Look for a clause that comes after the clause ANTLR complains about and
that may start with CONNECT BY. If you've found it, figure out what the
parser is supposed to do in that situation - most of the time this gives
the answer what to do about it.

Martin

From matt at aclaro.com  Wed Mar 22 09:36:21 2006
From: matt at aclaro.com (Matthew Mastracci)
Date: Wed Mar 22 10:11:25 2006
Subject: [antlr-interest] Performance tweak for .NET antlr library
Message-ID: <dvs1um$d9q$1@sea.gmane.org>

I've been profiling our application and it looks like there's a small 
tweak to the .NET runtime library's ASTFactory that cuts a small amount 
of time out when parsing large amounts of data.

The ASTFactor constructor takes the name of a type, but needs to scan 
all assemblies for an instance of the type.  I added a new constructor 
that takes System.Type and modified the default constructor to pass in 
typeof(CommonAST) instead of "antlr.CommonAST".

I've attached the patched file, but I can generate a proper patch if 
required.
-------------- next part --------------
using System;
using System.Collections;
using Assembly			= System.Reflection.Assembly;
using ArrayList			= System.Collections.ArrayList;
using Debug				= System.Diagnostics.Debug;
using AST				= antlr.collections.AST;
using ASTArray			= antlr.collections.impl.ASTArray;
using ANTLRException	= antlr.ANTLRException;

namespace antlr
{
	/*ANTLR Translator Generator
	* Project led by Terence Parr at http://www.jGuru.com
	* Software rights: http://www.antlr.org/license.html
	*
	* $Id:$
	*/
	
	//
	// ANTLR C# Code Generator by Micheal Jordan
	//                            Kunle Odutola       : kunle UNDERSCORE odutola AT hotmail DOT com
	//                            Anthony Oguntimehin
	//
	// With many thanks to Eric V. Smith from the ANTLR list.
	//


	// HISTORY:
	//
	// 19-Aug-2002 kunle    Augmented the basic flexibility of the default ASTFactory with a map
	//                      of TokenID-to-NodeTypeName. It's now a proper GoF-style Factory ;-)
	//

	/// <summary>
	/// AST Support code shared by TreeParser and Parser.
	/// </summary>
	/// <remarks>
	/// <para>
	/// We use delegation to share code (and have only one 
	/// bit of code to maintain) rather than subclassing
	/// or superclassing (forces AST support code to be
	/// loaded even when you don't want to do AST stuff).
	/// </para>
	/// <para>
	/// Typically, <see cref="setASTNodeType"/>  is used to specify the
	/// homogeneous type of node to create, but you can override
	/// <see cref="create"/>  to make heterogeneous nodes etc...
	/// </para>
	/// </remarks>
	public class ASTFactory
	{
		//---------------------------------------------------------------------
		// CONSTRUCTORS
		//---------------------------------------------------------------------

		/// <summary>
		/// Constructs an <c>ASTFactory</c> with the default AST node type of
		/// <see cref="antlr.CommonAST"/>.
		/// </summary>
		public ASTFactory() : this(typeof(antlr.CommonAST))
		{
		}

		/// <summary>
		/// Constructs an <c>ASTFactory</c> and use the specified AST node type
		/// as the default.
		/// </summary>
		/// <param name="nodeTypeName">
		///		Name of default AST node type for this factory.
		/// </param>
		public ASTFactory(string nodeTypeName) : this(loadNodeTypeObject(nodeTypeName))
		{
		}
		
		/// <summary>
		/// Constructs an <c>ASTFactory</c> and use the specified AST node type
		/// as the default.
		/// </summary>
		/// <param name="nodeType">
		///		Name of default AST node type for this factory.
		/// </param>
		public ASTFactory(Type nodeType)
		{
			heteroList_					= new FactoryEntry[Token.MIN_USER_TYPE+1];
			defaultASTNodeTypeObject_	= nodeType;
			defaultCreator_				= null;
			typename2creator_			= new Hashtable(32, (float) 0.3);
			typename2creator_["antlr.CommonAST"]					= CommonAST.Creator;
			typename2creator_["antlr.CommonASTWithHiddenTokens"]	= CommonASTWithHiddenTokens.Creator;

		}
		
		//---------------------------------------------------------------------
		// DATA MEMBERS
		//---------------------------------------------------------------------

		/// <summary>
		/// Stores the Type of the default AST node class to be used during tree construction.
		/// </summary>
		protected Type				defaultASTNodeTypeObject_;
		protected ASTNodeCreator	defaultCreator_;

		/// <summary>
		/// Stores the mapping between custom AST NodeTypes and their NodeTypeName/NodeTypeClass
		/// and ASTNodeCreator.
		/// </summary>
		protected FactoryEntry[]	heteroList_;

		/// <summary>
		/// Stores the mapping between AST node typenames and their token ID.
		/// </summary>
		protected Hashtable			typename2creator_;

		//---------------------------------------------------------------------
		// FUNCTION MEMBERS
		//---------------------------------------------------------------------

		/// <summary>
		/// Specify an "override" for the <see cref="AST"/> type created for
		/// the specified Token type.
		/// </summary>
		/// <remarks>
		/// This method is useful for situations that ANTLR cannot oridinarily deal 
		/// with (i.e., when you  create a token based upon a nonliteral token symbol 
		/// like #[LT(1)].  This is a runtime value and ANTLR cannot determine the token 
		/// type (and hence the AST) statically.
		/// </remarks>
		/// <param name="tokenType">Token type to override.</param>
		/// <param name="NodeTypeName">
		///		Fully qualified AST typename (or null to specify 
		///		the factory's default AST type).
		/// </param>
		public void setTokenTypeASTNodeType(int tokenType, string NodeTypeName)
		{
			// check validity of arguments...
			if( tokenType < Token.MIN_USER_TYPE )
				throw new ANTLRException("Internal parser error: Cannot change AST Node Type for Token ID '" + tokenType + "'");

			// resize up to and including 'type' and initialize any gaps to default
			// factory.
			if (tokenType > (heteroList_.Length+1))
				setMaxNodeType(tokenType);
			// And add new thing..
			if (heteroList_[tokenType] == null)
                heteroList_[tokenType] = new FactoryEntry(loadNodeTypeObject(NodeTypeName));
			else
				heteroList_[tokenType].NodeTypeObject = loadNodeTypeObject(NodeTypeName);
		}

		/// <summary>
		/// Register an AST Node Type for a given Token type ID.
		/// </summary>
		/// <param name="NodeType">The Token type ID.</param>
		/// <param name="NodeTypeName">The AST Node Type to register.</param>
		[Obsolete("Replaced by setTokenTypeASTNodeType(int, string) since version 2.7.2.6", true)]
		public void registerFactory(int NodeType, string NodeTypeName)
		{
			setTokenTypeASTNodeType(NodeType, NodeTypeName);
		}

		/// <summary>
		/// Register an ASTNodeCreator for a given Token type ID.
		/// </summary>
		/// <param name="NodeType">The Token type ID.</param>
		/// <param name="creator">The creater to register.</param>
		public void setTokenTypeASTNodeCreator(int NodeType, ASTNodeCreator creator)
		{
			// check validity of arguments...
			if( NodeType < Token.MIN_USER_TYPE )
				throw new ANTLRException("Internal parser error: Cannot change AST Node Type for Token ID '" + NodeType + "'");

			// resize up to and including 'type' and initialize any gaps to default
			// factory.
			if (NodeType > (heteroList_.Length+1))
				setMaxNodeType(NodeType);
			// And add new thing..
			if (heteroList_[NodeType] == null)
				heteroList_[NodeType] = new FactoryEntry(creator);
			else
				heteroList_[NodeType].Creator = creator;

			//typename2creator_[NodeType.ToString()]		= creator;
			typename2creator_[creator.ASTNodeTypeName]	= creator;
		}

		/// <summary>
		/// Register an ASTNodeCreator to be used for creating node by default.
		/// </summary>
		/// <param name="creator">The ASTNodeCreator.</param>
		public void setASTNodeCreator(ASTNodeCreator creator)
		{
			defaultCreator_ = creator;
		}

		/// <summary>
		/// Pre-expands the internal list of TokenTypeID-to-ASTNodeType mappings
		/// to the specified size.
		/// This is primarily a convenience method that can be used to prevent 
		/// unnecessary and costly re-org of the mappings list.
		/// </summary>
		/// <param name="NodeType">Maximum Token Type ID.</param>
		public void setMaxNodeType( int NodeType )
		{
			//Debug.WriteLine(this, "NodeType = " + NodeType + " and NodeList.Length = " + nodeTypeList_.Length);
			if (heteroList_ == null)
			{
				heteroList_ = new FactoryEntry[NodeType+1];
			}
			else
			{
				int length = heteroList_.Length;

				if ( NodeType >= length )
				{
					FactoryEntry[] newList = new FactoryEntry[NodeType+1];
					Array.Copy(heteroList_, 0, newList, 0, length);
					heteroList_ = newList;
				}
				else if ( NodeType < length )
				{
					FactoryEntry[] newList = new FactoryEntry[NodeType+1];
					Array.Copy(heteroList_, 0, newList, 0, (NodeType+1));
					heteroList_ = newList;
				}
			}
			//Debug.WriteLine(this, "NodeType = " + NodeType + " and NodeList.Length = " + nodeTypeList_.Length);
		}

		/// <summary>
		/// Add a child to the current AST
		/// </summary>
		/// <param name="currentAST">The AST to add a child to</param>
		/// <param name="child">The child AST to be added</param>
		public virtual void  addASTChild(ref ASTPair currentAST, AST child)
		{
			if (child != null)
			{
				if (currentAST.root == null)
				{
					// Make new child the current root
					currentAST.root = child;
				}
				else
				{
					if (currentAST.child == null)
					{
						// Add new child to current root
						currentAST.root.setFirstChild(child);
					}
					else
					{
						currentAST.child.setNextSibling(child);
					}
				}
				// Make new child the current child
				currentAST.child = child;
				currentAST.advanceChildToEnd();
			}
		}
		
		/// <summary>
		/// Creates a new uninitialized AST node. Since a specific AST Node Type
		/// wasn't indicated, the new AST node is created using the current default
		/// AST Node type - <see cref="defaultASTNodeTypeObject_"/>
		/// </summary>
		/// <returns>An uninitialized AST node object.</returns>
		public virtual AST create()
		{
			AST newNode;
			
			if (defaultCreator_ == null)
				newNode = createFromNodeTypeObject(defaultASTNodeTypeObject_);
			else
				newNode = defaultCreator_.Create();

			return newNode;
		}
		
		/// <summary>
		/// Creates and initializes a new AST node using the specified Token Type ID.
		/// The <see cref="System.Type"/> used for creating this new AST node is 
		/// determined by the following:
		/// <list type="bullet">
		///		<item>the current TokenTypeID-to-ASTNodeType mapping (if any) or,</item>
		///		<item>the <see cref="defaultASTNodeTypeObject_"/> otherwise</item>
		/// </list>
		/// </summary>
		/// <param name="type">Token type ID to be used to create new AST Node.</param>
		/// <returns>An initialized AST node object.</returns>
		public virtual AST create(int type)
		{
			AST newNode = createFromNodeType(type);
			newNode.initialize(type, "");
			return newNode;
		}
		
		/// <summary>
		/// Creates and initializes a new AST node using the specified Token Type ID.
		/// The <see cref="System.Type"/> used for creating this new AST node is 
		/// determined by the following:
		/// <list type="bullet">
		///		<item>the current TokenTypeID-to-ASTNodeType mapping (if any) or,</item>
		///		<item>the <see cref="defaultASTNodeTypeObject_"/> otherwise</item>
		/// </list>
		/// </summary>
		/// <param name="type">Token type ID to be used to create new AST Node.</param>
		/// <param name="txt">Text for initializing the new AST Node.</param>
		/// <returns>An initialized AST node object.</returns>
		public virtual AST create(int type, string txt)
		{
			AST newNode = createFromNodeType(type);
			newNode.initialize(type, txt);
			return newNode;
		}
		
		/// <summary>
		/// Creates a new AST node using the specified AST Node Type name. Once created,
		/// the new AST node is initialized with the specified Token type ID and string.
		/// The <see cref="System.Type"/> used for creating this new AST node is 
		/// determined solely by <c>ASTNodeTypeName</c>.
		/// The AST Node type must have a default/parameterless constructor.
		/// </summary>
		/// <param name="type">Token type ID to be used to create new AST Node.</param>
		/// <param name="txt">Text for initializing the new AST Node.</param>
		/// <param name="ASTNodeTypeName">Fully qualified name of the Type to be used for creating the new AST Node.</param>
		/// <returns>An initialized AST node object.</returns>
		public virtual AST create(int type, string txt, string ASTNodeTypeName)
		{
			AST newNode = createFromNodeName(ASTNodeTypeName);
			newNode.initialize(type, txt);
			return newNode;
		}
		
		/// <summary>
		/// Creates a new AST node using the specified AST Node Type name.
		/// </summary>
		/// <param name="tok">Token instance to be used to initialize the new AST Node.</param>
		/// <param name="ASTNodeTypeName">
		///		Fully qualified name of the Type to be used for creating the new AST Node.
		///	</param>
		/// <returns>A newly created and initialized AST node object.</returns>
		/// <remarks>
		/// Once created, the new AST node is initialized with the specified Token 
		/// instance. The <see cref="System.Type"/> used for creating this new AST 
		/// node is  determined solely by <c>ASTNodeTypeName</c>.
		/// <para>The AST Node type must have a default/parameterless constructor.</para>
		/// </remarks>
		public virtual AST create(IToken tok, string ASTNodeTypeName)
		{
			AST newNode = createFromNodeName(ASTNodeTypeName);
			newNode.initialize(tok);
			return newNode;
		}
		
		/// <summary>
		/// Creates and initializes a new AST node using the specified AST Node instance.
		/// the new AST node is initialized with the specified Token type ID and string.
		/// The <see cref="System.Type"/> used for creating this new AST node is 
		/// determined solely by <c>aNode</c>.
		/// The AST Node type must have a default/parameterless constructor.
		/// </summary>
		/// <param name="aNode">AST Node instance to be used for creating the new AST Node.</param>
		/// <returns>An initialized AST node object.</returns>
		public virtual AST create(AST aNode)
		{
			AST	newNode;

			if (aNode == null)
				newNode = null;
			else
			{			
				newNode = createFromAST(aNode);
				newNode.initialize(aNode);
			}
			return newNode;
		}
		
		/// <summary>
		/// Creates and initializes a new AST node using the specified Token instance.
		/// The <see cref="System.Type"/> used for creating this new AST node is 
		/// determined by the following:
		/// <list type="bullet">
		///		<item>the current TokenTypeID-to-ASTNodeType mapping (if any) or,</item>
		///		<item>the <see cref="defaultASTNodeTypeObject_"/> otherwise</item>
		/// </list>
		/// </summary>
		/// <param name="tok">Token instance to be used to create new AST Node.</param>
		/// <returns>An initialized AST node object.</returns>
		public virtual AST create(IToken tok)
		{
			AST newNode;

			if (tok == null)
				newNode = null;
			else
			{
				newNode = createFromNodeType(tok.Type);
				newNode.initialize(tok);
			}
			return newNode;
		}
		
		/// <summary>
		/// Returns a copy of the specified AST Node instance. The copy is obtained by
		/// using the <see cref="ICloneable"/> method Clone().
		/// </summary>
		/// <param name="t">AST Node to copy.</param>
		/// <returns>An AST Node (or null if <c>t</c> is null).</returns>
		public virtual AST dup(AST t)
		{
			// The Java version is implemented using code like this:
			if (t == null)
				return null;

			AST dup_edNode = createFromAST(t);
			dup_edNode.initialize(t);
			return dup_edNode;
		}
		
		/// <summary>
		/// Duplicate AST Node tree rooted at specified AST node and all of it's siblings.
		/// </summary>
		/// <param name="t">Root of AST Node tree.</param>
		/// <returns>Root node of new AST Node tree (or null if <c>t</c> is null).</returns>
		public virtual AST dupList(AST t)
		{
			AST result = dupTree(t); // if t == null, then result==null
			AST nt = result;
			while (t != null)
			{
				// for each sibling of the root
				t = t.getNextSibling();
				nt.setNextSibling(dupTree(t)); // dup each subtree, building new tree
				nt = nt.getNextSibling();
			}
			return result;
		}
		
		/// <summary>
		/// Duplicate AST Node tree rooted at specified AST node. Ignore it's siblings.
		/// </summary>
		/// <param name="t">Root of AST Node tree.</param>
		/// <returns>Root node of new AST Node tree (or null if <c>t</c> is null).</returns>
		public virtual AST dupTree(AST t)
		{
			AST result = dup(t); // make copy of root
			// copy all children of root.
			if (t != null)
			{
				result.setFirstChild(dupList(t.getFirstChild()));
			}
			return result;
		}
		
		/// <summary>
		/// Make a tree from a list of nodes.  The first element in the
		/// array is the root.  If the root is null, then the tree is
		/// a simple list not a tree.  Handles null children nodes correctly.
		/// For example, build(a, b, null, c) yields tree (a b c).  build(null,a,b)
		/// yields tree (nil a b).
		/// </summary>
		/// <param name="nodes">List of Nodes.</param>
		/// <returns>AST Node tree.</returns>
		public virtual AST make(params AST[] nodes)
		{
			if (nodes == null || nodes.Length == 0)
				return null;
			AST root = nodes[0];
			AST tail = null;
			if (root != null)
			{
				root.setFirstChild(null); // don't leave any old pointers set
			}
			// link in children;
			for (int i = 1; i < nodes.Length; i++)
			{
				if (nodes[i] == null)
					continue;
				// ignore null nodes
				if (root == null)
				{
					// Set the root and set it up for a flat list
					root = (tail = nodes[i]);
				}
				else if (tail == null)
				{
					root.setFirstChild(nodes[i]);
					tail = root.getFirstChild();
				}
				else
				{
					tail.setNextSibling(nodes[i]);
					tail = tail.getNextSibling();
				}
				// Chase tail to last sibling
				while (tail.getNextSibling() != null)
				{
					tail = tail.getNextSibling();
				}
			}
			return root;
		}
		
		/// <summary>
		/// Make a tree from a list of nodes, where the nodes are contained
		/// in an ASTArray object.
		/// </summary>
		/// <param name="nodes">List of Nodes.</param>
		/// <returns>AST Node tree.</returns>
		public virtual AST make(ASTArray nodes)
		{
			return make(nodes.array);
		}
		
		/// <summary>
		/// Make an AST the root of current AST.
		/// </summary>
		/// <param name="currentAST"></param>
		/// <param name="root"></param>
		public virtual void  makeASTRoot(ref ASTPair currentAST, AST root)
		{
			if (root != null)
			{
				// Add the current root as a child of new root
				root.addChild(currentAST.root);
				// The new current child is the last sibling of the old root
				currentAST.child = currentAST.root;
				currentAST.advanceChildToEnd();
				// Set the new root
				currentAST.root = root;
			}
		}

		/// <summary>
		/// Sets the global default AST Node Type for this ASTFactory instance.
		/// This method also attempts to load the <see cref="System.Type"/> instance
		/// for the specified typename.
		/// </summary>
		/// <param name="t">Fully qualified AST Node Type name.</param>
		public virtual void  setASTNodeType(string t)
		{
			if (defaultCreator_ != null)
			{
				if (t != defaultCreator_.ASTNodeTypeName)
				{
					defaultCreator_ = null;
				}
			}
			defaultASTNodeTypeObject_ = loadNodeTypeObject(t);
		}
		
		/// <summary>
		/// To change where error messages go, can subclass/override this method
		/// and then setASTFactory in Parser and TreeParser.  This method removes
		/// a prior dependency on class antlr.Tool.
		/// </summary>
		/// <param name="e"></param>
		public virtual void  error(string e)
		{
			Console.Error.WriteLine(e);
		}

		//---------------------------------------------------------------------
		// PRIVATE FUNCTION MEMBERS
		//---------------------------------------------------------------------

		private static Type loadNodeTypeObject(string nodeTypeName)
		{
			Type	nodeTypeObject	= null;
			bool	typeCreated		= false;

			if (nodeTypeName != null)
			{
				foreach (Assembly assem in AppDomain.CurrentDomain.GetAssemblies())
				{
					try
					{
						nodeTypeObject = assem.GetType(nodeTypeName);
						if (nodeTypeObject != null)
						{
							typeCreated = true;
							break;
						}
					}
					catch
					{
						typeCreated = false;
					}
				}
			}
			if (!typeCreated)
			{
				throw new TypeLoadException("Unable to load AST Node Type: '" + nodeTypeName + "'");
			}
			return nodeTypeObject;
		}

		private AST createFromAST(AST node)
		{
			AST		newNode			= null;
			Type	nodeAsTypeObj	= node.GetType();

			ASTNodeCreator creator = (ASTNodeCreator) typename2creator_[nodeAsTypeObj.FullName];
			if (creator != null)
			{
				newNode = creator.Create();
				if (newNode == null)
				{
					throw new ArgumentException("Unable to create AST Node Type: '" + nodeAsTypeObj.FullName + "'");
				}
			}
			else
			{
				newNode = createFromNodeTypeObject(nodeAsTypeObj);
			}
			return newNode;
		}

		private AST createFromNodeName(string nodeTypeName)
		{
			AST		newNode			= null;

			ASTNodeCreator creator = (ASTNodeCreator) typename2creator_[nodeTypeName];
			if (creator != null)
			{
				newNode = creator.Create();
				if (newNode == null)
				{
					throw new ArgumentException("Unable to create AST Node Type: '" + nodeTypeName + "'");
				}
			}
			else
			{
				newNode = createFromNodeTypeObject( loadNodeTypeObject(nodeTypeName) );
			}
			return newNode;
		}

		private AST createFromNodeType(int nodeTypeIndex)
		{
			Debug.Assert((nodeTypeIndex >= 0) && (nodeTypeIndex <= heteroList_.Length), "Invalid AST node type!");
			AST newNode = null;

			FactoryEntry	entry = heteroList_[nodeTypeIndex];
			if ((entry != null) && (entry.Creator != null))
			{
				newNode = entry.Creator.Create();
			}
			else
			{
				if ((entry == null) || (entry.NodeTypeObject == null))
				{
					if (defaultCreator_ == null)
					{
						newNode = createFromNodeTypeObject(defaultASTNodeTypeObject_);
					}
					else
						newNode = defaultCreator_.Create();
				}
				else
                    newNode = createFromNodeTypeObject( entry.NodeTypeObject );
			}
			return newNode;
		}

		private AST createFromNodeTypeObject(Type nodeTypeObject)
		{
			AST		newNode			= null;

			try
			{
				newNode = (AST) Activator.CreateInstance(nodeTypeObject);
				if (newNode == null)
				{
					throw new ArgumentException("Unable to create AST Node Type: '" + nodeTypeObject.FullName + "'");
				}
			}
			catch(Exception ex)
			{
				throw new ArgumentException("Unable to create AST Node Type: '" + nodeTypeObject.FullName + "'", ex);
			}
			return newNode;
		}

		protected class FactoryEntry
		{
			public FactoryEntry(Type typeObj, ASTNodeCreator creator)
			{
				NodeTypeObject	= typeObj;
				Creator			= creator;
			}

			public FactoryEntry(Type typeObj)
			{
				NodeTypeObject	= typeObj;
			}

			public FactoryEntry(ASTNodeCreator creator)
			{
				Creator			= creator;
			}

			public Type				NodeTypeObject;
			public ASTNodeCreator	Creator;
		}
	}
}
From prashant.deva at gmail.com  Wed Mar 22 13:28:35 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Wed Mar 22 13:28:40 2006
Subject: [antlr-interest] ANTLR Studio 1.1 Released !!!
Message-ID: <41fed8f80603221328n7e3dc78o50f4bcd283a641ca@mail.gmail.com>

ANTLR Studio 1.1 has been released.

This release contains support for antlr 2.7.6, enhancements to existing
features and lots of bugfixes :)

Existing users can upgrade for free.

Get ANTLR Studio at -
http://placidsystems.com/


My blog entry for the release -
http://placidsystems.com/blog/2006/03/antlr-studio-11-released.html

Have fun and enjoy ANTLR Studio 1.1 :)

--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060323/66b8502d/attachment.html
From prashant.deva at gmail.com  Wed Mar 22 14:00:05 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Wed Mar 22 14:00:09 2006
Subject: [antlr-interest] ANTLR Studio for $29 only till April 6th!
Message-ID: <41fed8f80603221400k340fa9f6rc306c5b216408e85@mail.gmail.com>

I guess this is important enough to require another thread ;)

The ANTLR Studio Giveaway offer is on.
You can purchase ANTLR Studio 1.1 for $29 only instead of the usual $49 till
April 6th. :)

Enjoy,
--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060323/1b54fc40/attachment.html
From rhill03 at eds.com  Wed Mar 22 23:20:57 2006
From: rhill03 at eds.com (Hill, Robert)
Date: Wed Mar 22 23:30:33 2006
Subject: [antlr-interest] V3 & C#
Message-ID: <2E909902FD3A03419E3A905908AE3DD401BBD5F8@UKNSM201.emea.corp.eds.com>

Thanks for the responses Ter, Micheal!
I think I'll stick with 2.7.6 for now ,I think I'm familiar with it
enough to sort out most problems , so I can do without more risk
incurred by using V3. Looking at AntlrWorks, I see that Prashant has
sorted out some 2.7.6 compatibility now too. How cool is that?!, The
credit cards definitely coming out in a mo and its on special offer two!
:)

Cheers guys!

/2ob

Ps, does anyone else's spell checker insist that AntlrWorks should be
AngleWorms? :)


--
Rob Hill
EDS - Hallamshire Business Park
F1E/087
Sheffield	
T:	+44 (0) 114 291 1928
M:	+44 (0) 791 732 1227
E:	rhill03@eds.com

 

>-----Original Message-----
>From: antlr-interest-bounces@antlr.org 
>[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Terence Parr
>Sent: 21 March 2006 18:11
>To: antlr-interest Interest
>Cc: Jean Bovet
>Subject: Re: [antlr-interest] V3 & C#
>
>
>On Mar 21, 2006, at 10:26 AM, Micheal J wrote:
>>> And please tell me that AntlrWorks will use that and output the c# 
>>> too? Pretty please. Don't make me beg!
>>
>> Can't comment on AntlrWorks beyond saying that it would eventually 
>> support "remotely" debugging non-Java Lexers/Parsers/TreeParsers via 
>> over some IPC mechanism.
>
>ANTLR generates the output so ANTLRWorks should just...well, work :)
>
>Ter
>
From rhill03 at eds.com  Wed Mar 22 23:34:36 2006
From: rhill03 at eds.com (Hill, Robert)
Date: Wed Mar 22 23:45:33 2006
Subject: [antlr-interest] V3 & C#
Message-ID: <2E909902FD3A03419E3A905908AE3DD401BBD5F9@UKNSM201.emea.corp.eds.com>


Err, that should be special offer *TOO* 
Lol, its too early for this!

--
Rob Hill
EDS - Hallamshire Business Park
F1E/087
Sheffield	
T:	+44 (0) 114 291 1928
M:	+44 (0) 791 732 1227
E:	rhill03@eds.com

 

>-----Original Message-----
>From: antlr-interest-bounces@antlr.org 
>[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Hill, Robert
>Sent: 23 March 2006 07:21
>To: antlr-interest@antlr.org
>Subject: RE: [antlr-interest] V3 & C#
>
>Thanks for the responses Ter, Micheal!
>I think I'll stick with 2.7.6 for now ,I think I'm familiar 
>with it enough to sort out most problems , so I can do without 
>more risk incurred by using V3. Looking at AntlrWorks, I see 
>that Prashant has sorted out some 2.7.6 compatibility now too. 
>How cool is that?!, The credit cards definitely coming out in 
>a mo and its on special offer two!
>:)
>
>Cheers guys!
>
>/2ob
>
>Ps, does anyone else's spell checker insist that AntlrWorks 
>should be AngleWorms? :)
>
>
>--
>Rob Hill
>EDS - Hallamshire Business Park
>F1E/087
>Sheffield	
>T:	+44 (0) 114 291 1928
>M:	+44 (0) 791 732 1227
>E:	rhill03@eds.com
>
> 
>
>>-----Original Message-----
>>From: antlr-interest-bounces@antlr.org 
>>[mailto:antlr-interest-bounces@antlr.org] On Behalf Of Terence Parr
>>Sent: 21 March 2006 18:11
>>To: antlr-interest Interest
>>Cc: Jean Bovet
>>Subject: Re: [antlr-interest] V3 & C#
>>
>>
>>On Mar 21, 2006, at 10:26 AM, Micheal J wrote:
>>>> And please tell me that AntlrWorks will use that and output the c# 
>>>> too? Pretty please. Don't make me beg!
>>>
>>> Can't comment on AntlrWorks beyond saying that it would eventually 
>>> support "remotely" debugging non-Java 
>Lexers/Parsers/TreeParsers via 
>>> over some IPC mechanism.
>>
>>ANTLR generates the output so ANTLRWorks should just...well, work :)
>>
>>Ter
>>
>
From open.zone at virgin.net  Thu Mar 23 01:44:20 2006
From: open.zone at virgin.net (Micheal J)
Date: Thu Mar 23 01:27:22 2006
Subject: [antlr-interest] Performance tweak for .NET antlr library
In-Reply-To: <dvs1um$d9q$1@sea.gmane.org>
Message-ID: <008f01c64e5e$5d081160$6b02a8c0@hercules>

> I've been profiling our application and it looks like there's a small 
> tweak to the .NET runtime library's ASTFactory that cuts a 
> small amount 
> of time out when parsing large amounts of data.
> 
> The ASTFactor constructor takes the name of a type, but needs to scan 
> all assemblies for an instance of the type.  I added a new 
> constructor 
> that takes System.Type and modified the default constructor 
> to pass in 
> typeof(CommonAST) instead of "antlr.CommonAST".
> 
> I've attached the patched file, but I can generate a proper patch if 
> required.

Thanks Matthew.

Using a custom ASTFactory that creates the AST classes directly [i.e. new
MyAST(...)] is another recommended performance tweak.

If a project uses one AST class (i.e. homogeneous AST), using a custom
ASTNodeCreator is a simpler option.

Cheers,

Micheal

From antlr at jazillian.com  Thu Mar 23 06:47:05 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Thu Mar 23 06:47:11 2006
Subject: [antlr-interest] How to force a TreeWalker to match exactly?
In-Reply-To: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
References: <D90489B77ED9F8439A3C784F732BEC9C737E5F@3mxstu1r.hpi.uni-potsdam.de>
Message-ID: <4422B4E9.6040705@jazillian.com>


> 
>This can be very annoying! If there is an inconsistency between the Parser and the TreeWalker grammar, there is very little chance to detect it. Instead, unknown nodes are sometimes silently ignored. Is there a way to turn off this feature? How do you ensure that the TreeWalker grammars really correspond to the AST generated by the parser?
>  
>
I discuss this in several places in my article about why I don't like 
TreeWalkers.
http://www.jazillian.com/articles/treewalkers.html
For example, I say:
------------
..do we want our AST-transformation phase to be tied tightly (to "look 
like", really) the AST structure of the parser? In my opinion, the 
answer is "no". By not having the AST-transformer tightly bound to the 
AST structure, it's easier to maintain, enhance, and modify to work with 
other languages and AST structures.
*
*

Glancing at the "by-hand" code gives little clue as to the input AST 
structure, and I think that's a good thing, because
 that way, it is less dependent on the input AST structure. For example, 
all the node types that are binary operators are lumped together because 
they are all processed in the same way, and we don't care where they may 
appear in the AST.

----------
So I think your life might be easier if you don't even attempt to 
explicitly validate AST structure in your treewalker.


From antlr at jazillian.com  Thu Mar 23 06:52:24 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Thu Mar 23 06:52:30 2006
Subject: [antlr-interest] Why does ASTFactory.create(Token tok) creates
	new token instead of using token passed as a parameter
In-Reply-To: <441F8C03.4090703@sun.com>
References: <441F8C03.4090703@sun.com>
Message-ID: <4422B628.3040006@jazillian.com>

Vladmir Kvashin wrote:

> Hi,
>
> Could anybody answer my, why TokenFactory behaves in a following way.
>
> In method create(Token tok) it creates a new token and then just 
> copies (via initialize() method) values from the token that is passes 
> as a parameter.
>
>    public AST create(Token tok) {
>        AST t = create(tok.getType());
>        if ( t!=null ) {
>            t.initialize(tok);
>        }
>        return t;
>    }
>
> My idea is to make my own extension of AstFactory, which would hold 
> the initial token instead of creation new one. Are some drawbacks of 
> such decision? I don't see any.
>
> If there are no, then probably it's worth to make this behaviour default?
>
> Thanks,
> Vladimir

My Tokens have extra information. For example, each token knows what 
file it's in. So
reusing a single Token in multiple places won't work for me.

I think it makes more sense to
have create() return a copy, because you can always create a second 
pointer to
the same instance with a simple "AST myCopy = myOriginal;" assignment.

>
>

From antlr at jazillian.com  Thu Mar 23 07:02:37 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Thu Mar 23 07:02:35 2006
Subject: [antlr-interest] Attributes on AST nodes
In-Reply-To: <2b8e23150603210828j746a9a4di1694c4499aded9c3@mail.gmail.com>
References: <2b8e23150603210828j746a9a4di1694c4499aded9c3@mail.gmail.com>
Message-ID: <4422B88D.8040909@jazillian.com>

Priya wrote:

>Is there a way to directly encode the precision and width information as
>a.precision , b.precision  a.width b.width etc directly  in the node itself?
>
>  
>
Yes, just make your own subclass of antlr.Token.
There's some method to tell the lexer to create instances of your 
subclass rather than antlr.Token objects.
I can't remember offhand what that method is, as I've done it the way it 
should be done...

Have this interface:
interface TokenFactory {
    antlr.Token makeToken(int type);
}

Have this method in the lexer:
public void setTokenFactory(TokenFactory tokenFactory) {
...
}

I hope that ANTLR v3 does it this way (maybe it already does it this way 
- I'm still on 2.7.2)



From priya.uky at gmail.com  Thu Mar 23 07:16:58 2006
From: priya.uky at gmail.com (Priya)
Date: Thu Mar 23 07:17:02 2006
Subject: [antlr-interest] Symbol Table
Message-ID: <2b8e23150603230716p758dcbefqd76f4e99a49d65e3@mail.gmail.com>

Hi Everyone ,
I'm building a compiler front end for which I have 3 grammar files
bLexer.g , bParser.g , bWalker.g and  a main.cpp , a myAST.h  etc .
Which file should i place the symbol table  for it to be accessible
from both parser and walker ?
Thanks in advance for your help
Priya
From demakov at ispras.ru  Thu Mar 23 07:19:34 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Thu Mar 23 07:19:33 2006
Subject: [antlr-interest] Testing a grammar
References: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
Message-ID: <010e01c64e8d$311c95b0$8cc79553@marlboro>

Hi all,

Recent discussion on this topic force me to release our internal tool 
that generates tests for parsers. The source for test generation is BNF grammar.
But this grammar may differ from parser's grammar - it may be any context free grammar,
not necessarily LR(k). It is possible, that you have such grammar before parser development
and you try to resolve all conflicts that ANTLR reports. So, tests generated from source
grammar can help you find out inconsistency between parser and source grammar.

I absolutely have no time to write docs now, use examples in source distribution.
Unfortunately all docs we have are in Russian :(

Here is grammar for used BNF notation:
-----
grammar ::= ( rule )+ ;

rule ::= ( <JAVADOC> )? id "::=" expression ";" ;

expression ::= term ( "|" term )* ;

term ::= ( factor )+ ;

factor ::=   id
           | <LEXEME_TEXT>
           | <LEXEME_NAME>
           | "(" expression ")" ( "*" | "+" | "?" | "#" )?
       ;

id ::= <ID> ;
-----

'#' is special modifiers useful for such things as java modifiers
( 'public' | 'protected' | 'private' )# 
means the same as 
( 'public' | 'protected' | 'private' )*
but each alternative can't be used more than once.

Lexeme values are in separate file:

-----
<JAVADOC>     "/** javadoc */"
<LEXEME_TEXT> "\"lexeme\""
<LEXEME_NAME> "<LEXEME>"
<ID>          "id1" "id2"
-----

From demakov at ispras.ru  Thu Mar 23 07:23:10 2006
From: demakov at ispras.ru (Alexey Demakov)
Date: Thu Mar 23 07:23:08 2006
Subject: [antlr-interest] Testing a grammar
References: <280FCE4A-6213-4562-9A72-000838D329E9@dlr.de>
Message-ID: <012001c64e8d$b1c60de0$8cc79553@marlboro>

Hi all,

Recent discussion on this topic force me to release our internal tool 
that generates tests for parsers. The source for test generation is BNF grammar.
But this grammar may differ from parser's grammar - it may be any context free grammar,
not necessarily LR(k). It is possible, that you have such grammar before parser development
and you try to resolve all conflicts that ANTLR reports. So, tests generated from source
grammar can help you find out inconsistency between parser and source grammar.

I absolutely have no time to write docs now, use examples in source distribution.
Unfortunately all docs we have are in Russian :(

Here is grammar for used BNF notation:
-----
grammar ::= ( rule )+ ;

rule ::= ( <JAVADOC> )? id "::=" expression ";" ;

expression ::= term ( "|" term )* ;

term ::= ( factor )+ ;

factor ::=   id
           | <LEXEME_TEXT>
           | <LEXEME_NAME>
           | "(" expression ")" ( "*" | "+" | "?" | "#" )?
       ;

id ::= <ID> ;
-----

'#' is special modifiers useful for such things as java modifiers
( 'public' | 'protected' | 'private' )# 
means the same as 
( 'public' | 'protected' | 'private' )*
but each alternative can't be used more than once.

Lexeme values are in separate file:

-----
<JAVADOC>     "/** javadoc */"
<LEXEME_TEXT> "\"lexeme\""
<LEXEME_NAME> "<LEXEME>"
<ID>          "id1" "id2"
-----

Download standalone distribution from from http://sourceforge.net/projects/bnftool

Ask me if you have questions, I will try to answer.

Regards,
Alexey

-----
Alexey Demakov
TreeDL: Tree Description Language: http://treedl.sourceforge.net
RedVerst Group: http://www.unitesk.com


From mach_ray at yahoo.com  Thu Mar 23 07:44:19 2006
From: mach_ray at yahoo.com (Mach Ray)
Date: Thu Mar 23 07:44:21 2006
Subject: [antlr-interest] parsing same file more than once
Message-ID: <20060323154419.93302.qmail@web60817.mail.yahoo.com>

Dear all,

I want to parse the same file multiple times,
depending on the number of input arguments. The input
file name is an extern variable defined in the
grammar. Here is a segment of the main function. 

// ...
if (frules.substr(frules.find('.')) == ".rules"){

ifstream infile (frules.c_str(), ios::in);
if( !infile.is_open() ){
   cerr << "Error in opening the conversion rules
file"      << endl;
   return 1;
}
			   
for( int i = 2; i < argc; i++ ){
   xml_file = argv[i]; // a global variable

   XML2OWLLexer lexer(std::cin);
   XML2OWLParser parser(lexer);
   LexerSharedInputState lex_state =  
lexer.getInputState();
   lex_state->initialize(infile, frules.c_str());
   
   parser.getInputState()->reset();
   parser.setFilename(frules);
   
   parser.file();
// ...

The first execution of the for loop is witout any
error. During the second execution, the parse throws
the following error
cont.rules:1:1: unexpected end of file

Thanks
Mach

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
From ewbank at gmail.com  Thu Mar 23 08:12:27 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Thu Mar 23 08:12:36 2006
Subject: [antlr-interest] Threading a compiler (C++)
Message-ID: <dd3a065f0603230812j6bacb7bfr1cc6fe34fe0a8a60@mail.gmail.com>

Has anyone done any work with threading an ANTLR-based compiler so
that each pass is in a separate thread?  Any things to be aware of
when taking this approach (e.g., unexpected state information, etc)?

I'm looking at a function inlining pass (whole program optimization)
that makes the AST simply huge, followed by an optimization pass that
shrinks the AST substantially, and rather than having them each
operate on the whole program, instead have them work on each
statement, preserving state as needed.

So, instead of each TreeParser starting here:
   program : #( PROGRAM ( statement )* );

I instead have a wrapper that does this:
   program : #( PROGRAM ( s1: statement { inline.statement(s1);
optim.statement(s1); } )* );

then each of the other passes (inlining, optimization) would be a
separate thread...

Any advice would be great
- Bryan Ewbank
From matt at aclaro.com  Thu Mar 23 09:09:09 2006
From: matt at aclaro.com (Matthew Mastracci)
Date: Thu Mar 23 09:13:00 2006
Subject: [antlr-interest] Re: Performance tweak for .NET antlr library
In-Reply-To: <008f01c64e5e$5d081160$6b02a8c0@hercules>
References: <dvs1um$d9q$1@sea.gmane.org>
	<008f01c64e5e$5d081160$6b02a8c0@hercules>
Message-ID: <dvuknl$9u0$1@sea.gmane.org>

Micheal J wrote:

> Using a custom ASTFactory that creates the AST classes directly [i.e. new
> MyAST(...)] is another recommended performance tweak.
> 
> If a project uses one AST class (i.e. homogeneous AST), using a custom
> ASTNodeCreator is a simpler option.

Cool - I didn't know this was possible.  We're just using CommonAST, so 
this should certainly improve things (esp. by avoiding the 
Activator.CreateInstance call).

For the most part, the ANTLR parsers seem to be very high-performance. 
Through my profiling, however, I saw that 75% of the time parsing was 
spent in the constructor of ASTFactor.

Matt.

From antlr at jazillian.com  Thu Mar 23 11:39:47 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Thu Mar 23 11:39:45 2006
Subject: [antlr-interest] parsing same file more than once
In-Reply-To: <20060323154419.93302.qmail@web60817.mail.yahoo.com>
References: <20060323154419.93302.qmail@web60817.mail.yahoo.com>
Message-ID: <4422F983.5030106@jazillian.com>

I'm not sure if this is the cause or not, but when I reuse my parser,
I call reset() as you do, but also set traceDepth to 0.

Andy

Mach Ray wrote:

>Dear all,
>
>I want to parse the same file multiple times,
>depending on the number of input arguments. The input
>file name is an extern variable defined in the
>grammar. Here is a segment of the main function. 
>
>// ...
>if (frules.substr(frules.find('.')) == ".rules"){
>
>ifstream infile (frules.c_str(), ios::in);
>if( !infile.is_open() ){
>   cerr << "Error in opening the conversion rules
>file"      << endl;
>   return 1;
>}
>			   
>for( int i = 2; i < argc; i++ ){
>   xml_file = argv[i]; // a global variable
>
>   XML2OWLLexer lexer(std::cin);
>   XML2OWLParser parser(lexer);
>   LexerSharedInputState lex_state =  
>lexer.getInputState();
>   lex_state->initialize(infile, frules.c_str());
>   
>   parser.getInputState()->reset();
>   parser.setFilename(frules);
>   
>   parser.file();
>// ...
>
>The first execution of the for loop is witout any
>error. During the second execution, the parse throws
>the following error
>cont.rules:1:1: unexpected end of file
>
>Thanks
>Mach
>
>__________________________________________________
>Do You Yahoo!?
>Tired of spam?  Yahoo! Mail has the best spam protection around 
>http://mail.yahoo.com 
>
>  
>

From owong at castortech.com  Thu Mar 23 14:22:58 2006
From: owong at castortech.com (Oliver Wong)
Date: Thu Mar 23 14:23:11 2006
Subject: [antlr-interest] Are there any functioning Java 1.5 grammars for
	ANTLR?
Message-ID: <D5F291ABFAB3454D85DB58B747B6398213983B@castor-srvr1.castortech.com>

I went to http://www.antlr.org/grammar/list to look for a Java 1.5
grammar for ANTLR, but I couldn't get any of the ones I tried to work.

The "Updated Java 1.5 Grammar" by Scott Wisniewski, for example, Java
generates code which seems to be using a keyword "internal" which
doesn't exist in Java. Specifically, it generates code like:

<code>
internal class JavaLexer extends antlr.CharScanner implements
JavaTokenTypes, TokenStream
 {
</code>

With "Yet another java 1.5 grammar" by Michael Stahl, when I try to a
very simple Java program with the following code:

<code>
import antlr.RecognitionException;
import antlr.TokenStreamException;
import antlr.collections.AST;

public class Test {
  public static void main(String args[]) throws RecognitionException,
TokenStreamException {
    JavaLexer lexer = new JavaLexer(System.in);
    JavaRecognizer recognizer = new JavaRecognizer(lexer);
    recognizer.compilationUnit();
    AST tree = recognizer.getAST();
    System.out.println(tree.toStringTree());
  }
}
</code>

The resulting AST only contains the first import statement of the parsed
file, rather than the whole file. Specifically, when I try to parse the
code for Test which I've posted above (i.e. running the parser on
itself), the output is:

<output>
( import ( . antlr RecognitionException ) )
</output>

Instead of the expect output of something like

<expectedOutput>
( compilationUnit
  (import
    (. antlr RecongitionException )
  )
  (import
    (. antlr TokenStreamException )
etc.
</expectedOutput>

And so on, for every other grammar I've tried. I simply haven't had any
luck in getting any of the grammar files to generating working parsers.

I'm using ANTLR 2.7.6. What am I doing wrong? It seems implausible that
EVERY grammar file posted on there is broken, so I must be
misunderstanding something.

	- Oliver
From Jeff.Barnes at codesic.com  Thu Mar 23 16:34:51 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Thu Mar 23 16:33:30 2006
Subject: [antlr-interest] Lexer Question
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119D9A@hq-app2.CODESIC.COM>

I think I may be confusing a couple of issues... Consider the following partial rule:
 
SF
{
    int length = 0;
}
:       
    '\u005A'!
    byte1:'\0'..'\u007F'
    byte2:. {length = (byte1<<8)+(byte2&0XFF);}
    '\u00D3'
    (
        '\u00A0'
        (
            '\u0088' {$setType(MFC_SF);}  '\0' '\0' '\0' MFC_SF[length-12]
        |   '\u0090' {$setType(TLE_SF);}  '\0' '\0' '\0' TLE_SF[length-8]
        )
    |   '\u00A2' '\u0088' {$setType(MCC_SF);}  '\0' '\0' '\0' MCC_SF[length-8]
...
    )
...
 
With this kind of lexing, each byte specifies the one and only path (state) the lexer can follow (be in).
 
It's not a DFA, but it sorta acts like one. The subrules are called and no recursion back to SF occurs from the subrules.
 
If I were looking to describe this strategy in a few words, what would I call it? Left-factoring?

Regards,
Jeff
From dholenstein at gmail.com  Fri Mar 24 01:21:21 2006
From: dholenstein at gmail.com (Dominik Holenstein)
Date: Fri Mar 24 01:21:27 2006
Subject: [antlr-interest] Compiler Issue (Eclipse 3.1.2 / Antlr Studio 1.1)
Message-ID: <8ab6a9f00603240121s58b0f584o82f48d6f59842837@mail.gmail.com>

Hello,

I am very new to Eclipse, Java and ANTLR. So my question is a very basic one
but after looking for a solution for several hours I want to ask you whether
you can help me:

This is my grammar file:


header {
}
class XMLParser extends Parser;

startMark
  : name:NAME
  {System.out.println("Name: "+name.getText());} ;


class XMLLexer extends Lexer;
NAME: ('a'..'z'|'A'..'Z'|'0'..'9')+ NEWLINE;
NEWLINE
    :   '\r' '\n'   // DOS   ;

And this is my Main.java file:

import java.io.*;

class Main {
 public static void main(String[] args) {
  try {
        XMLLexer lexer = new XMLLexer(new DataInputStream(System.in));  /*
Problem see below
        XMLParser parser = new
XMLParser(lexer);                                      /* Problem see below
        parser.startMark();
  }

  catch(Exception e) {
   System.err.println("exception: "+e);
  }
 }
}

This is the system I am working with:
- Windows XP
- Eclipse 3.1.2
- ANTLR Studio 1.1

When I want to run the application (Run -> Run as -> Java Application) I get
this very nice messages in the console view of Eclipse:

Exception in thread "main" java.lang.Error: Unresolved compilation problems:

 XMLLexer cannot be resolved to a type
 XMLLexer cannot be resolved to a type
 XMLParser cannot be resolved to a type
 XMLParser cannot be resolved to a type

 at Main.main(Main.java:7)



Where do I have to look at to solve this issue?
- java or antlr code files?
- classpath and variables settings?
- other project settings?
- other ideas?

I know it is a  very basic question but I appreciate any help very much.
My plans are to develop a simple XML parser first just for learning
purposed.

Kind regards,

Dominik
Zurich, Switzerland
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060324/49b78c75/attachment.html
From jbarnesweb at yahoo.com  Fri Mar 24 06:48:35 2006
From: jbarnesweb at yahoo.com (Jeff Barnes)
Date: Fri Mar 24 06:48:38 2006
Subject: [antlr-interest] Compiler Issue (Eclipse 3.1.2 / Antlr Studio 1.1)
In-Reply-To: <8ab6a9f00603240121s58b0f584o82f48d6f59842837@mail.gmail.com>
Message-ID: <20060324144836.43397.qmail@web54506.mail.yahoo.com>

You have to add the generated code to the build path
in Eclipse.

Commonly you do this by adding the folder where the
generated code is placed to the build path in Eclipse.

Regards,
Jeff


--- Dominik Holenstein <dholenstein@gmail.com> wrote:

> Hello,
> 
> I am very new to Eclipse, Java and ANTLR. So my
> question is a very basic one
> but after looking for a solution for several hours I
> want to ask you whether
> you can help me:
> 
> This is my grammar file:
> 
> 
> header {
> }
> class XMLParser extends Parser;
> 
> startMark
>   : name:NAME
>   {System.out.println("Name: "+name.getText());} ;
> 
> 
> class XMLLexer extends Lexer;
> NAME: ('a'..'z'|'A'..'Z'|'0'..'9')+ NEWLINE;
> NEWLINE
>     :   '\r' '\n'   // DOS   ;
> 
> And this is my Main.java file:
> 
> import java.io.*;
> 
> class Main {
>  public static void main(String[] args) {
>   try {
>         XMLLexer lexer = new XMLLexer(new
> DataInputStream(System.in));  /*
> Problem see below
>         XMLParser parser = new
> XMLParser(lexer);                                   
>   /* Problem see below
>         parser.startMark();
>   }
> 
>   catch(Exception e) {
>    System.err.println("exception: "+e);
>   }
>  }
> }
> 
> This is the system I am working with:
> - Windows XP
> - Eclipse 3.1.2
> - ANTLR Studio 1.1
> 
> When I want to run the application (Run -> Run as ->
> Java Application) I get
> this very nice messages in the console view of
> Eclipse:
> 
> Exception in thread "main" java.lang.Error:
> Unresolved compilation problems:
> 
>  XMLLexer cannot be resolved to a type
>  XMLLexer cannot be resolved to a type
>  XMLParser cannot be resolved to a type
>  XMLParser cannot be resolved to a type
> 
>  at Main.main(Main.java:7)
> 
> 
> 
> Where do I have to look at to solve this issue?
> - java or antlr code files?
> - classpath and variables settings?
> - other project settings?
> - other ideas?
> 
> I know it is a  very basic question but I appreciate
> any help very much.
> My plans are to develop a simple XML parser first
> just for learning
> purposed.
> 
> Kind regards,
> 
> Dominik
> Zurich, Switzerland
> 


=========
Jeff Barnes
(206)245-6100


Few things are impossible to diligence and skill.
--- Samuel Johnson (Rasselas Chap. xii.)
From prashant.deva at gmail.com  Fri Mar 24 10:05:59 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri Mar 24 10:06:02 2006
Subject: [antlr-interest] Compiler Issue (Eclipse 3.1.2 / Antlr Studio 1.1)
In-Reply-To: <8ab6a9f00603240121s58b0f584o82f48d6f59842837@mail.gmail.com>
References: <8ab6a9f00603240121s58b0f584o82f48d6f59842837@mail.gmail.com>
Message-ID: <41fed8f80603241005v28133860ne55c853b3ac1df4b@mail.gmail.com>

Did you 'Enable ANTLR Studio' on the project first?

On 3/24/06, Dominik Holenstein <dholenstein@gmail.com> wrote:
>
> Hello,
>
> I am very new to Eclipse, Java and ANTLR. So my question is a very basic
> one but after looking for a solution for several hours I want to ask you
> whether you can help me:
>
> This is my grammar file:
>
>
> header {
> }
> class XMLParser extends Parser;
>
> startMark
>   : name:NAME
>   {System.out.println("Name: "+name.getText());} ;
>
>
> class XMLLexer extends Lexer;
> NAME: ('a'..'z'|'A'..'Z'|'0'..'9')+ NEWLINE;
> NEWLINE
>     :   '\r' '\n'   // DOS   ;
>
> And this is my Main.java file:
>
> import java.io.*;
>
> class Main {
>  public static void main(String[] args) {
>   try {
>         XMLLexer lexer = new XMLLexer(new DataInputStream(System.in));  /*
> Problem see below
>         XMLParser parser = new
> XMLParser(lexer);                                      /* Problem see below
>         parser.startMark();
>   }
>
>   catch(Exception e) {
>    System.err.println("exception: "+e);
>   }
>  }
> }
>
> This is the system I am working with:
> - Windows XP
> - Eclipse 3.1.2
> - ANTLR Studio 1.1
>
> When I want to run the application (Run -> Run as -> Java Application) I
> get this very nice messages in the console view of Eclipse:
>
> Exception in thread "main" java.lang.Error: Unresolved compilation
> problems:
>  XMLLexer cannot be resolved to a type
>  XMLLexer cannot be resolved to a type
>  XMLParser cannot be resolved to a type
>  XMLParser cannot be resolved to a type
>
>  at Main.main(Main.java:7)
>
>
>
> Where do I have to look at to solve this issue?
> - java or antlr code files?
> - classpath and variables settings?
> - other project settings?
> - other ideas?
>
> I know it is a  very basic question but I appreciate any help very much.
> My plans are to develop a simple XML parser first just for learning
> purposed.
>
> Kind regards,
>
> Dominik
> Zurich, Switzerland
>
>
>



--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060324/5d9aa180/attachment.html
From madcapmaggie at yahoo.com  Fri Mar 24 14:31:12 2006
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Fri Mar 24 14:31:17 2006
Subject: [antlr-interest] Threading a compiler (C++)
In-Reply-To: <dd3a065f0603230812j6bacb7bfr1cc6fe34fe0a8a60@mail.gmail.com>
Message-ID: <20060324223112.30122.qmail@web30201.mail.mud.yahoo.com>

Bryan,

We're doing something similar -- separate threads for
various phases -- one thread does the lexing and
parsing, another does the semantic analysis.

We haven't run into any major problems beyond needing
to be very careful with locks so the reference counts
on the ANTLR nodes don't get screwed up.  

I was occasionally paranoid in that some routines made
copies of their input before making any modifications.

I'll be in the office next week if you'd like to
discuss any details.

We're using C++ and Zthreads on Linux.  

Peggy

--- Bryan Ewbank <ewbank@gmail.com> wrote:

> Has anyone done any work with threading an
> ANTLR-based compiler so
> that each pass is in a separate thread?  Any things
> to be aware of
> when taking this approach (e.g., unexpected state
> information, etc)?
> 
> I'm looking at a function inlining pass (whole
> program optimization)
> that makes the AST simply huge, followed by an
> optimization pass that
> shrinks the AST substantially, and rather than
> having them each
> operate on the whole program, instead have them work
> on each
> statement, preserving state as needed.
> 
> So, instead of each TreeParser starting here:
>    program : #( PROGRAM ( statement )* );
> 
> I instead have a wrapper that does this:
>    program : #( PROGRAM ( s1: statement {
> inline.statement(s1);
> optim.statement(s1); } )* );
> 
> then each of the other passes (inlining,
> optimization) would be a
> separate thread...
> 
> Any advice would be great
> - Bryan Ewbank
> 

From prashant.deva at gmail.com  Fri Mar 24 20:58:19 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Fri Mar 24 20:58:27 2006
Subject: [antlr-interest] ANTLR Studio sales gone CRAZY!
Message-ID: <41fed8f80603242058i2969831by391324f5b885ed73@mail.gmail.com>

ANTLR Studio 1.1 sales have gone crazy since the release of v1.1 with the
GiveAway offer!

In 2 days I sold the no licenses generally sold in an entire month !!!

I guess the much improved quality of 1.1 coupled with the lower price of $29
is the reason for that :)

--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060325/e537ed1a/attachment.html
From dholenstein at gmail.com  Fri Mar 24 22:22:52 2006
From: dholenstein at gmail.com (Dominik Holenstein)
Date: Fri Mar 24 22:22:55 2006
Subject: [antlr-interest] Compiler Issue (Eclipse 3.1.2 / Antlr Studio 1.1)
In-Reply-To: <41fed8f80603241005v28133860ne55c853b3ac1df4b@mail.gmail.com>
References: <8ab6a9f00603240121s58b0f584o82f48d6f59842837@mail.gmail.com>
	<41fed8f80603241005v28133860ne55c853b3ac1df4b@mail.gmail.com>
Message-ID: <8ab6a9f00603242222v4e2ee90ga4049633f907f46@mail.gmail.com>

Oliver, Jeff, Prashant,

I thank you very much for answering my question!

The error was caused by a wrong classpath. Further, I installed Antlr Studio
in the same Eclipse environment where I installed the free Antlr plugin. I
removed the free plugin and corrected the classpath and the variables.
Everything is working fine now and I can continue to learn Java and Antlr.

All the best,
Dominik



On 3/24/06, Prashant Deva <prashant.deva@gmail.com> wrote:
>
> Did you 'Enable ANTLR Studio' on the project first?
>
>
> On 3/24/06, Dominik Holenstein <dholenstein@gmail.com> wrote:
> >
> >  Hello,
> >
> > I am very new to Eclipse, Java and ANTLR. So my question is a very basic
> > one but after looking for a solution for several hours I want to ask you
> > whether you can help me:
> >
> > This is my grammar file:
> >
> >
> > header {
> > }
> > class XMLParser extends Parser;
> >
> > startMark
> >   : name:NAME
> >   {System.out.println("Name: "+name.getText());} ;
> >
> >
> > class XMLLexer extends Lexer;
> > NAME: ('a'..'z'|'A'..'Z'|'0'..'9')+ NEWLINE;
> > NEWLINE
> >     :   '\r' '\n'   // DOS   ;
> >
> > And this is my Main.java file:
> >
> > import java.io.*;
> >
> > class Main {
> >  public static void main(String[] args) {
> >   try {
> >         XMLLexer lexer = new XMLLexer(new DataInputStream( System.in<http://system.in/>));
> > /* Problem see below
> >         XMLParser parser = new
> > XMLParser(lexer);                                      /* Problem see below
> >         parser.startMark();
> >   }
> >
> >   catch(Exception e) {
> >    System.err.println("exception: "+e);
> >   }
> >  }
> > }
> >
> > This is the system I am working with:
> > - Windows XP
> > - Eclipse 3.1.2
> > - ANTLR Studio 1.1
> >
> > When I want to run the application (Run -> Run as -> Java Application) I
> > get this very nice messages in the console view of Eclipse:
> >
> > Exception in thread "main" java.lang.Error: Unresolved compilation
> > problems:
> >  XMLLexer cannot be resolved to a type
> >  XMLLexer cannot be resolved to a type
> >  XMLParser cannot be resolved to a type
> >  XMLParser cannot be resolved to a type
> >
> >  at Main.main(Main.java:7)
> >
> >
> >
> > Where do I have to look at to solve this issue?
> > - java or antlr code files?
> > - classpath and variables settings?
> > - other project settings?
> > - other ideas?
> >
> > I know it is a  very basic question but I appreciate any help very much.
> >
> > My plans are to develop a simple XML parser first just for learning
> > purposed.
> >
> > Kind regards,
> >
> > Dominik
> > Zurich, Switzerland
> >
> >
> >
>
>
>
> --
> Prashant Deva
> Creator, ANTLR Studio
> Founder, Placid Systems, www.placidsystems.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060325/76fe53d0/attachment.html
From mzawadzinski at gmail.com  Sat Mar 25 02:52:30 2006
From: mzawadzinski at gmail.com (=?ISO-8859-2?Q?Maciej_Zawadzi=F1ski?=)
Date: Sat Mar 25 02:52:33 2006
Subject: [antlr-interest] writing an interpreter
Message-ID: <32eb83090603250252n2ac33a11u70cfc11067f9e60@mail.gmail.com>

Hi!

I am gonna write an interpreter of simple language. I am thinking of
implementing it as a treewalker, but I encountered some problems with
loops. How can I force ANTLR treewalker not to parse some nodes of
tree? (e.g. "body" of the if/while loop if the condition is not
satisfied?)

regards,
Maciek

--
Maciej Zawadzi?ski
From ewbank at gmail.com  Sat Mar 25 07:22:27 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Sat Mar 25 07:22:31 2006
Subject: [antlr-interest] writing an interpreter
In-Reply-To: <32eb83090603250252n2ac33a11u70cfc11067f9e60@mail.gmail.com>
References: <32eb83090603250252n2ac33a11u70cfc11067f9e60@mail.gmail.com>
Message-ID: <dd3a065f0603250722l5a654284nf9c3d2ae8dfdefec@mail.gmail.com>

On 3/25/06, Maciej Zawadzi?ski <mzawadzinski@gmail.com> wrote:
> I am gonna write an interpreter of simple language. I am thinking of
> implementing it as a treewalker, but I encountered some problems with loops.
>
> How can I force ANTLR treewalker not to parse some nodes of tree? (e.g.
> "body" of the if/while loop if the condition is not satisfied?)

Assuming your if node looks like this:
    #( IF e1 s1 s2 )
        -- e1 is the expression to evaluate
        -- s1 is the statement to evaluate if e1 is true
        -- s2 is the statement to evaluate if e2 is false

The ANTLR for driving evaluation is:

    if_statement
    { bool res; }
    :
        #( IF res=exprbool
            ( {res == true}?  statement .   // i.e., skip "s2"
            |                 . statement   // i.e., skip "s1"
            )
        )
    ;

This assumes that <exprbool> evaluates a boolean expression and returns
true/false.  In other words, it has this ANTLR signature:

    exprbool
    returns [bool result = false]
    :
        ... ... ...
    ;

WHILE follows from IF; tracking the current state of the expression is left as
an exercise for the user :-)

Note that the same structure can be used to short-circuit &&, || operators, and
control selective evaluation of the ternary ?: operator.

- Bryan
From parrt at cs.usfca.edu  Sat Mar 25 10:42:58 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 25 10:43:02 2006
Subject: [antlr-interest] writing an interpreter
In-Reply-To: <dd3a065f0603250722l5a654284nf9c3d2ae8dfdefec@mail.gmail.com>
References: <32eb83090603250252n2ac33a11u70cfc11067f9e60@mail.gmail.com>
	<dd3a065f0603250722l5a654284nf9c3d2ae8dfdefec@mail.gmail.com>
Message-ID: <D6B90A3F-5FB6-45D9-A0DA-615DB93751C4@cs.usfca.edu>


On Mar 25, 2006, at 7:22 AM, Bryan Ewbank wrote:

> On 3/25/06, Maciej Zawadzi?ski <mzawadzinski@gmail.com> wrote:
>> I am gonna write an interpreter of simple language. I am thinking of
>> implementing it as a treewalker, but I encountered some problems  
>> with loops.

StringTemplate Is a tree-based interpreter. You can take a look at  
that implementation.

Ter
From jr.williams at tiscali.co.uk  Sat Mar 25 11:17:28 2006
From: jr.williams at tiscali.co.uk (John Williams)
Date: Sat Mar 25 11:11:28 2006
Subject: [antlr-interest] C++ & JAVA code in the same grammar file?
Message-ID: <44259748.7000809@tiscali.co.uk>

The project I am working on requires the parser to be generated in JAVA and C++. 
What I would like to do is to use one grammar file and include my C++ and JAVA 
code in it. Is there any way that I can ask ANTLR to use the included JAVA code 
when I specify language="java" and the included C++ code when I specify 
language="Cpp"? It's a pity you can't tag the code with the language ie:

C++ { ...}
  or java { ...}


Thanks for any help.

John
From parrt at cs.usfca.edu  Sat Mar 25 11:51:37 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 25 11:51:43 2006
Subject: [antlr-interest] new DFA implementation for generated v3 recognizers
Message-ID: <FBD50F79-4A57-4064-9431-4235912CCD4B@cs.usfca.edu>

Hi, see

http://www.antlr.org/blog/antlr3/codegen.tml

for a write-up on new DFA implementation; should be able to do in a  
few months.  The problem is highlighted by the following:

In the Mantra language parser there are about 700 lines out of 8726  
of class definitions for DFA states. In the lexer there were 2051  
lines out of 5670. There are about 400 .class files in the directory  
just for DFA states (from 1 parser and 3 tree parsers). Ick.

Ter
From mzawadzinski at gmail.com  Sat Mar 25 12:44:39 2006
From: mzawadzinski at gmail.com (=?ISO-8859-2?Q?Maciej_Zawadzi=F1ski?=)
Date: Sat Mar 25 12:44:42 2006
Subject: [antlr-interest] writing an interpreter
In-Reply-To: <dd3a065f0603250722l5a654284nf9c3d2ae8dfdefec@mail.gmail.com>
References: <32eb83090603250252n2ac33a11u70cfc11067f9e60@mail.gmail.com>
	<dd3a065f0603250722l5a654284nf9c3d2ae8dfdefec@mail.gmail.com>
Message-ID: <32eb83090603251244y46d728d2w5f50af4c6c7ccc9d@mail.gmail.com>

On 3/25/06, Bryan Ewbank <ewbank@gmail.com> wrote:
> On 3/25/06, Maciej Zawadzi?ski <mzawadzinski@gmail.com> wrote:
> > I am gonna write an interpreter of simple language. I am thinking of
> > implementing it as a treewalker, but I encountered some problems with loops.
> >
> > How can I force ANTLR treewalker not to parse some nodes of tree? (e.g.
> > "body" of the if/while loop if the condition is not satisfied?)
>
> Assuming your if node looks like this:
>     #( IF e1 s1 s2 )
>         -- e1 is the expression to evaluate
>         -- s1 is the statement to evaluate if e1 is true
>         -- s2 is the statement to evaluate if e2 is false
>
> The ANTLR for driving evaluation is:
>
>     if_statement
>     { bool res; }
>     :
>         #( IF res=exprbool
>             ( {res == true}?  statement .   // i.e., skip "s2"
>             |                 . statement   // i.e., skip "s1"
>             )
>         )
>     ;
>

Thanks a lot! I am close to understanding antlr now ;)

But nothing comes so quickly. I had some problems with optional "else"
phrase, but I finally wrote something like this that works:

ifStatement { int e = 0; }:
  ( #("if" expr stmt "else") ) => #("if" e=expr ( {e == true}? stmt |
. "else" stmt ) )
 | ( #("if" expr stmt) ) => #("if" e=expr ( {e == true}? stmt | . ) )


It looks a bit ugly, is there a way to make it without syntactic predicates?

greets,

--
Maciej Zawadzi?ski
From prashant.deva at gmail.com  Sat Mar 25 12:46:21 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Sat Mar 25 12:46:28 2006
Subject: [antlr-interest] C++ & JAVA code in the same grammar file?
In-Reply-To: <44259748.7000809@tiscali.co.uk>
References: <44259748.7000809@tiscali.co.uk>
Message-ID: <41fed8f80603251246n47ea74b8vcb88b76ad4a185a9@mail.gmail.com>

1 grammar file can generate code in only 1 target language. You need 2
different grammar files to gen code in 2 diff languages.

--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com

On 3/26/06, John Williams <jr.williams@tiscali.co.uk> wrote:
>
> The project I am working on requires the parser to be generated in JAVA
> and C++.
> What I would like to do is to use one grammar file and include my C++ and
> JAVA
> code in it. Is there any way that I can ask ANTLR to use the included JAVA
> code
> when I specify language="java" and the included C++ code when I specify
> language="Cpp"? It's a pity you can't tag the code with the language ie:
>
> C++ { ...}
>   or java { ...}
>
>
> Thanks for any help.
>
> John
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060326/bbcd2d11/attachment.html
From parrt at cs.usfca.edu  Sat Mar 25 14:39:19 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 25 14:39:22 2006
Subject: [antlr-interest] draft Mantra language proposal
Message-ID: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>

Howdy,

I have much of the following proposal implemented for Mantra:

http://www.linguamantra.org/

It will serve as a tutorial for ANTLR v3 once I get it cleaned up as  
it uses about everything :)

Terence
From antlr at shmuelhome.mine.nu  Sat Mar 25 17:09:24 2006
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Sat Mar 25 17:09:19 2006
Subject: [antlr-interest] new DFA implementation for generated v3
	recognizers
In-Reply-To: <FBD50F79-4A57-4064-9431-4235912CCD4B@cs.usfca.edu>
References: <FBD50F79-4A57-4064-9431-4235912CCD4B@cs.usfca.edu>
Message-ID: <4425E9C4.3090004@shmuelhome.mine.nu>

Terence Parr wrote:
> Hi, see
> 
> http://www.antlr.org/blog/antlr3/codegen.tml
> 
> for a write-up on new DFA implementation; should be able to do in a few 
> months.  

Have you looked into using a ternary tree approach for compression? 
Should handle Unicode fairly well but will probably need some 
modification to handle "not sets".


-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.385 / Virus Database: 268.3.0/290 - Release Date: 3/23/2006



-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.385 / Virus Database: 268.3.0/290 - Release Date: 3/23/2006

From parrt at cs.usfca.edu  Sat Mar 25 17:48:29 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 25 17:48:35 2006
Subject: [antlr-interest] new DFA implementation for generated v3
	recognizers
In-Reply-To: <4425E9C4.3090004@shmuelhome.mine.nu>
References: <FBD50F79-4A57-4064-9431-4235912CCD4B@cs.usfca.edu>
	<4425E9C4.3090004@shmuelhome.mine.nu>
Message-ID: <8D2D06C3-272A-4C9C-A26A-9AD96F83EE67@cs.usfca.edu>


On Mar 25, 2006, at 5:09 PM, shmuel siegel wrote:

> Terence Parr wrote:
>> Hi, see
>> http://www.antlr.org/blog/antlr3/codegen.tml
>> for a write-up on new DFA implementation; should be able to do in  
>> a few months.
>
> Have you looked into using a ternary tree approach for compression?  
> Should handle Unicode fairly well but will probably need some  
> modification to handle "not sets".

Yeah, i am not sure that is the best data structure; seems like it  
would be pretty slow.  It would effectively split states with lots of  
edges into many many states.  Thanks for the suggestion though...

The solution I have is optimal in time and very good in space for all  
states with less than some threshold number of edges.  For example,  
if a state has just 1 edge, then there is an array of size 1 for that  
state stored at transition[state].  Worst case density (i.e., most  
sparse) would be states with char \u0000 and char 0..0xFFFE for the  
edges.  I'd waste all the space in between.  This will waste 64k ints  
for any state that does that, but naturally, I'll push that to a  
"special" state.

Ter

From jbarnesweb at yahoo.com  Sat Mar 25 18:24:25 2006
From: jbarnesweb at yahoo.com (Jeff Barnes)
Date: Sat Mar 25 18:24:29 2006
Subject: [antlr-interest] new DFA implementation for generated v3
	recognizers
In-Reply-To: <8D2D06C3-272A-4C9C-A26A-9AD96F83EE67@cs.usfca.edu>
Message-ID: <20060326022425.21533.qmail@web54515.mail.yahoo.com>



--- Terence Parr <parrt@cs.usfca.edu> wrote:

> 
> The solution I have is optimal in time and very good
> in space for all  
> states with less than some threshold number of
> edges.  

<snip>

> I'd waste all the space in between.  This
> will waste 64k ints  
> for any state that does that, but naturally, I'll
> push that to a  
> "special" state.
> 

So you'll have varying degrees of optimity in the time
domain, with no optimity in the space domain...

How are you constructing the "special" states?

Regards,
Jeff

=========
Jeff Barnes
(206)245-6100


Few things are impossible to diligence and skill.
--- Samuel Johnson (Rasselas Chap. xii.)
From craymer at warpiv.com  Sat Mar 25 19:06:19 2006
From: craymer at warpiv.com (Loring Craymer)
Date: Sat Mar 25 19:06:26 2006
Subject: [antlr-interest] writing an interpreter
In-Reply-To: <32eb83090603251244y46d728d2w5f50af4c6c7ccc9d@mail.gmail.com>
Message-ID: <008801c65082$41ea4300$8302a8c0@Fafnir>

Compiling to threaded code has many advantages over interpreting the tree
directly and costs no more to implement.  Basically, threaded code is a
sequence of instructions and arguments:

instr1 instr2 (instr3 arg1 arg2) instr4 ...

The instr items might be bytes containing an instruction code, addresses of
code to be executed, or some more indirect approach.  The arguments
(parentheses in the example just indicate that arg1 and arg2 are associated
with instr3; the above is a linear list) might be word-sized integers,
pointers, indices into tables (strings in Java, for example, where there are
no pointers to take advantage of), or whatever.

The approach is to do a tree walk to compile to threaded code; there is a
separate interpreter (a big case statement is the norm when the interpreter
is written in a high level language) in which each case represents an instr
value.

if..else statements compile to
<if> <offset to else code> <sequence of statements to execute if true>
<branch> <offset to skip else code> <statements to execute if false>

A one pass (treewalk) compiler lays down <if> <hole> ... code and backfills
the hole with an offset when the else or end of the if statement is
encountered.

Most modern interpreted languages (python, perl, ghc, etc.) use threaded
code; if you look at the source code, you can see the compiler.  Timothy
Budd's Little Smalltalk (he wrote a short book which may still be findable)
is a good example to learn from, but there are probably others.

--Loring 

> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Maciej Zawadzinski
> Sent: Saturday, March 25, 2006 12:45 PM
> To: ANTLR Interest
> Subject: Re: [antlr-interest] writing an interpreter
> 
> On 3/25/06, Bryan Ewbank <ewbank@gmail.com> wrote:
> > On 3/25/06, Maciej Zawadzi?ski <mzawadzinski@gmail.com> wrote:
> > > I am gonna write an interpreter of simple language. I am thinking of
> > > implementing it as a treewalker, but I encountered some problems with
> loops.
> > >
> > > How can I force ANTLR treewalker not to parse some nodes of tree?
> (e.g.
> > > "body" of the if/while loop if the condition is not satisfied?)
> >
> > Assuming your if node looks like this:
> >     #( IF e1 s1 s2 )
> >         -- e1 is the expression to evaluate
> >         -- s1 is the statement to evaluate if e1 is true
> >         -- s2 is the statement to evaluate if e2 is false
> >
> > The ANTLR for driving evaluation is:
> >
> >     if_statement
> >     { bool res; }
> >     :
> >         #( IF res=exprbool
> >             ( {res == true}?  statement .   // i.e., skip "s2"
> >             |                 . statement   // i.e., skip "s1"
> >             )
> >         )
> >     ;
> >
> 
> Thanks a lot! I am close to understanding antlr now ;)
> 
> But nothing comes so quickly. I had some problems with optional "else"
> phrase, but I finally wrote something like this that works:
> 
> ifStatement { int e = 0; }:
>   ( #("if" expr stmt "else") ) => #("if" e=expr ( {e == true}? stmt |
> . "else" stmt ) )
>  | ( #("if" expr stmt) ) => #("if" e=expr ( {e == true}? stmt | . ) )
> 
> 
> It looks a bit ugly, is there a way to make it without syntactic
> predicates?
> 
> greets,
> 
> --
> Maciej Zawadzi?ski

From parrt at cs.usfca.edu  Sat Mar 25 23:11:14 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat Mar 25 23:11:18 2006
Subject: [antlr-interest] new DFA implementation for generated v3
	recognizers
In-Reply-To: <20060326022425.21533.qmail@web54515.mail.yahoo.com>
References: <20060326022425.21533.qmail@web54515.mail.yahoo.com>
Message-ID: <3D17D328-3B70-478F-84F0-272652CD3B11@cs.usfca.edu>


On Mar 25, 2006, at 6:24 PM, Jeff Barnes wrote:
>> I'd waste all the space in between.  This
>> will waste 64k ints
>> for any state that does that, but naturally, I'll
>> push that to a
>> "special" state.
>>
>
> So you'll have varying degrees of optimity in the time
> domain, with no optimity in the space domain...

Well, for ascii and all unicode states with only a few edges, I'm as  
close to optimal in time/space as you can expect.  What I'm doing is  
fairly typical for the old ascii-based dfa-based lexer generators  
like lex.  I could even optimize the size of the elements to char  
from int for state numbers etc...  I'll try it out and see what we get.

> How are you constructing the "special" states?

switch on char or if-then-else depending on the edges.  If  
predicates, it's perforce if-then-else.

Got another suggestion?  I'm all ears!

Ter
From open.zone at virgin.net  Sun Mar 26 03:42:06 2006
From: open.zone at virgin.net (Micheal J)
Date: Sun Mar 26 03:25:07 2006
Subject: [antlr-interest] C++ & JAVA code in the same grammar file?
In-Reply-To: <44259748.7000809@tiscali.co.uk>
Message-ID: <005f01c650ca$50c3c160$6702a8c0@hercules>

Serach the archives for Bogdan Mitu's annotation tool. Someone also did an
updated version of it a coupla years back.

Micheal


> -----Original Message-----
> From: antlr-interest-bounces@antlr.org 
> [mailto:antlr-interest-bounces@antlr.org] On Behalf Of John Williams
> Sent: 25 March 2006 19:17
> To: antlr-interest@antlr.org
> Subject: [antlr-interest] C++ & JAVA code in the same grammar file?
> 
> 
> The project I am working on requires the parser to be 
> generated in JAVA and C++. 
> What I would like to do is to use one grammar file and 
> include my C++ and JAVA 
> code in it. Is there any way that I can ask ANTLR to use the 
> included JAVA code 
> when I specify language="java" and the included C++ code when 
> I specify 
> language="Cpp"? It's a pity you can't tag the code with the 
> language ie:
> 
> C++ { ...}
>   or java { ...}
> 
> 
> Thanks for any help.
> 
> John
> 

From ewbank at gmail.com  Sun Mar 26 04:06:50 2006
From: ewbank at gmail.com (Bryan Ewbank)
Date: Sun Mar 26 04:06:52 2006
Subject: [antlr-interest] C++ & JAVA code in the same grammar file?
In-Reply-To: <44259748.7000809@tiscali.co.uk>
References: <44259748.7000809@tiscali.co.uk>
Message-ID: <dd3a065f0603260406p5f34b88fua5191578f35f6d5a@mail.gmail.com>

On 3/25/06, John Williams <jr.williams@tiscali.co.uk> wrote:
> Is there any way that I can ask ANTLR to use the included JAVA code when I
> specify language="java" and the included C++ code when I specify
> language="Cpp"?

Since C and java use common syntax for some stuff (e.g., function calls), you
might explore how close you can get by extracting /all/ behavior to another
file, and then just doing callouts in the grammar file - e.g., calling
functions inherited from the baseclass.

This would allow one ANTLR input file that requires minor preprocessing
changes, as with sed, to work for both target languages.  This would be ideal,
but I'm sure there will be other minor tweaks required...
    sed 's/language="java"/language="Cpp"/'

Hope this helps,
- Bryan
From prashant.deva at gmail.com  Sun Mar 26 12:32:40 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Sun Mar 26 12:32:43 2006
Subject: [antlr-interest] ANTLR Studio in Programmation Sous Linux Magazine!
Message-ID: <41fed8f80603261232x3b2cd124s5c7e0d5c1feac1be@mail.gmail.com>

ANTLR Studio is in the latest issue of Programmaion Sous Linux Magazine!

http://translate.google.com/translate?hl=en&sl=fr&u=www.proglinux.org/fr/modules/news2/article.php?storyid=2

The magazine contains an article on AS and AS itself on the cd.
Its available in French & German only.

Ironically, although the magazine contains my article and my software on the
cd, the publishers havent been kind enough to send me a copy of it. My
emails to them about it has gone unanswered.

If anyone gets hold of an issue of the magazine, could you please atleast
send me some scans of the front cover and the pages containing the article?

--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060327/123bb676/attachment.html
From cao at danucom.com  Sun Mar 26 14:25:52 2006
From: cao at danucom.com (Guoliang Cao)
Date: Sun Mar 26 14:25:58 2006
Subject: [antlr-interest] HELP: translate javascript code to C#
Message-ID: <804822922.20060326172552@danucom.com>

Hello everyone,

I'm new to ANTLR and face a language translation task: translate
Javascript code to C#. Here is the detail:

I can create a form based PDF document and embed Javascript code
snippets in the document. What javascript code does here is accessing
the form controls inside the document, initializing, validating or
computing when a user is operating on the document.

The PDF document is converted to our private format, its forms, fields
are all converted. Now I need to convert Javascript code to C# code
because our private format only supports C# scripting and uses a
different set of APIs.

I read through a couple ANTLR tutorials and basically know how it
works, then I found the only available Javascript grammar on ANTLR
grammar list. I downloaded it, tried to build a parser but got a lot
of warnings. Hoping those warnings are not fatal, I passed a short
code snippet to it. It ruthlessly failed at first character:

line 1:1:unexpected token: v

Then I dive into the grammar, added missing lexical rules, made a few
changes which I think might help, rebuilt the parser, still got
warnings and failed at first character. Anyone please help me. I would
appreciate any ideas, suggestions and comments.

For your convenience, I copied related code/error below. The .g file
can be found at http://www.daoqigame.com/temp/js-new.g

==== grammar warnings ====
ANTLR Parser Generator   Version 2.7.6 (2005-12-22)   1989-2005
src\main\config\js-new.g: warning:lexical nondeterminism between rules EXPONENT_INDICATOR and ALPHA_CHARACTER upon
src\main\config\js-new.g:     k==1:'E','e'
src\main\config\js-new.g:     k==2:<end-of-token>
src\main\config\js-new.g:     k==3:<end-of-token>
src\main\config\js-new.g:     k==4:<end-of-token>
src\main\config\js-new.g: warning:lexical nondeterminism between rules EXPONENT_INDICATOR and LOWER_ALPHA_CHAR upon
src\main\config\js-new.g:     k==1:'e'
src\main\config\js-new.g:     k==2:<end-of-token>
src\main\config\js-new.g:     k==3:<end-of-token>
src\main\config\js-new.g:     k==4:<end-of-token>
...

==== java code ====
JavascriptLexer lexer = new JavascriptLexer(new FileInputStream("input.js"));
JavascriptParser parser = new JavascriptParser(lexer);
parser.program();
System.out.println(parser.getAST().toStringTree());

==== input.js ====
var table = remainingValue.substring(start + 1, end);

// availableList.appendChild(selectedList.options.item(selIndex))

if (formName == xdpText)
{
        var len = anotherList.length++;
        anotherList.options[len].text = subString;
        anotherList.options[len].value = subString1;
}


From parrt at cs.usfca.edu  Sun Mar 26 18:12:36 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun Mar 26 18:12:39 2006
Subject: [antlr-interest] HELP: translate javascript code to C#
In-Reply-To: <804822922.20060326172552@danucom.com>
References: <804822922.20060326172552@danucom.com>
Message-ID: <F41FBD72-FDB7-44FF-92B7-A39C9443ACB7@cs.usfca.edu>

Hi.  Failing so completely must mean a character encoding problem.   
Make sure the main program that sends a stream of char to the lexer  
is decoding the input file properly.  You might be trying to read a  
file from one country using the encoding on your machine or the main  
program does not use the proper reader.  OR, you are sending in RDF,  
which is clearly wrong but thought I'd mention it ;)
Ter

From benjamin.burkhart at navpos.de  Mon Mar 27 01:18:43 2006
From: benjamin.burkhart at navpos.de (Benjamin B.)
Date: Mon Mar 27 01:18:57 2006
Subject: [antlr-interest] antlr on Microsoft Visual C++ 6 ...
Message-ID: <4427ADF3.10807@navpos.de>

Hello everyone,

are there any tricks and intricacies concerning the usage of antlr on 
Microsoft Visual C++? The reason why I'm asking is that I'm getting 
loads of linker errors.

Linker arguments:
C:\Programme\antlr\lib\antlr.lib kernel32.lib user32.lib gdi32.lib 
winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib 
gdi32.lib winspool.lib comdlg32.lib advapi32.lib sh
ell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib 
/subsystem:console /incremental:no "/pdb:Release/antlr.pdb" 
/machine:I386 "/out:Release/antlr.exe"
.\Release\antlr.obj

The first few linker error messages:
libcp.lib(locale.obj) : error LNK2005: "public: static class 
std::locale::id std::num_put<char,class 
std::ostreambuf_iterator<char,struct std::char_traits<char> > >::id" 
(?id@?$num_put@DV?$ostreambuf_iterator@DU?$char_traits@D@std@@@std@@@std@@2V0lo
cale@2@A) already defined in antlr.lib(CharScanner.obj)
libcp.lib(locale.obj) : error LNK2005: "public: static class 
std::locale::id std::numpunct<char>::id" 
(?id@?$numpunct@D@std@@2V0locale@2@A) already defined in 
antlr.lib(CharScanner.obj)
antlr.obj : error LNK2001: unresolved external symbol "public: void 
__thiscall P::startRule(void)" (?startRule@P@@QAEXXZ)
antlr.obj : error LNK2001: unresolved external symbol "public: 
__thiscall P::P(class antlr::TokenStream &)" 
(??0P@@QAE@AAVTokenStream@antlr@@@Z)
antlr.obj : error LNK2001: unresolved external symbol "public: 
__thiscall L::L(class std::basic_istream<char,struct 
std::char_traits<char> > &)" 
(??0L@@QAE@AAV?$basic_istream@DU?$char_traits@D@std@@@std@@@Z)
antlr.lib(String.obj) : error LNK2001: unresolved external symbol 
"public: void __thiscall std::_String_base::_Xlen(void)const " 
(?_Xlen@_String_base@std@@QBEXXZ)
antlr.lib(BaseAST.obj) : error LNK2001: unresolved external symbol 
"public: void __thiscall std::_String_base::_Xlen(void)const " 
(?_Xlen@_String_base@std@@QBEXXZ)

The antlr is version 2.7.5, the msi packet, on Windows XP 2 with the 
mentioned development environment. And, to reduce confusion, this is a 
small trial project which I named "antlr".

Cheers and thanks
Benjamin
From mark.kattenbelt at gmail.com  Mon Mar 27 03:31:49 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Mon Mar 27 03:31:57 2006
Subject: [antlr-interest] antlr on Microsoft Visual C++ 6 ...
In-Reply-To: <4427ADF3.10807@navpos.de>
References: <4427ADF3.10807@navpos.de>
Message-ID: <4427CD25.10505@gmail.com>

Hello Benjamin,

Did you use precompiled headers? This solved some linker errors for me. 
Also are you compiling it to be a dynamic or static library? What flags 
did you define?

Cheers,

Mark
> Hello everyone,
>
> are there any tricks and intricacies concerning the usage of antlr on 
> Microsoft Visual C++? The reason why I'm asking is that I'm getting 
> loads of linker errors.
>
> Linker arguments:
> C:\Programme\antlr\lib\antlr.lib kernel32.lib user32.lib gdi32.lib 
> winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
> oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib 
> gdi32.lib winspool.lib comdlg32.lib advapi32.lib sh
> ell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib 
> /subsystem:console /incremental:no "/pdb:Release/antlr.pdb" 
> /machine:I386 "/out:Release/antlr.exe"
> .\Release\antlr.obj
>
> The first few linker error messages:
> libcp.lib(locale.obj) : error LNK2005: "public: static class 
> std::locale::id std::num_put<char,class 
> std::ostreambuf_iterator<char,struct std::char_traits<char> > >::id" 
> (?id@?$num_put@DV?$ostreambuf_iterator@DU?$char_traits@D@std@@@std@@@std@@2V0lo 
>
> cale@2@A) already defined in antlr.lib(CharScanner.obj)
> libcp.lib(locale.obj) : error LNK2005: "public: static class 
> std::locale::id std::numpunct<char>::id" 
> (?id@?$numpunct@D@std@@2V0locale@2@A) already defined in 
> antlr.lib(CharScanner.obj)
> antlr.obj : error LNK2001: unresolved external symbol "public: void 
> __thiscall P::startRule(void)" (?startRule@P@@QAEXXZ)
> antlr.obj : error LNK2001: unresolved external symbol "public: 
> __thiscall P::P(class antlr::TokenStream &)" 
> (??0P@@QAE@AAVTokenStream@antlr@@@Z)
> antlr.obj : error LNK2001: unresolved external symbol "public: 
> __thiscall L::L(class std::basic_istream<char,struct 
> std::char_traits<char> > &)" 
> (??0L@@QAE@AAV?$basic_istream@DU?$char_traits@D@std@@@std@@@Z)
> antlr.lib(String.obj) : error LNK2001: unresolved external symbol 
> "public: void __thiscall std::_String_base::_Xlen(void)const " 
> (?_Xlen@_String_base@std@@QBEXXZ)
> antlr.lib(BaseAST.obj) : error LNK2001: unresolved external symbol 
> "public: void __thiscall std::_String_base::_Xlen(void)const " 
> (?_Xlen@_String_base@std@@QBEXXZ)
>
> The antlr is version 2.7.5, the msi packet, on Windows XP 2 with the 
> mentioned development environment. And, to reduce confusion, this is a 
> small trial project which I named "antlr".
>
> Cheers and thanks
> Benjamin
>

From benjamin.burkhart at navpos.de  Mon Mar 27 03:43:24 2006
From: benjamin.burkhart at navpos.de (Benjamin B.)
Date: Mon Mar 27 03:43:34 2006
Subject: [antlr-interest] antlr on Microsoft Visual C++ 6 ...
In-Reply-To: <4427CD25.10505@gmail.com>
References: <4427ADF3.10807@navpos.de> <4427CD25.10505@gmail.com>
Message-ID: <4427CFDC.4010701@navpos.de>

Mark Kattenbelt schrieb:
> Hello Benjamin,
> 
> Did you use precompiled headers? This solved some linker errors for me. 
> Also are you compiling it to be a dynamic or static library? What flags 
> did you define?

Hello Mark,

this is statically linked, not using precompiled headers. What 
advantages do those have? Apart from the few seconds of reduction in 
compile time? And which options do you mean apart from the linker options?

Cheers and thanks so far.
PS: If someone feels that this is off-topic, let me know ...
From benjamin.burkhart at navpos.de  Mon Mar 27 05:02:39 2006
From: benjamin.burkhart at navpos.de (Benjamin B.)
Date: Mon Mar 27 05:02:51 2006
Subject: [antlr-interest] antlr on Microsoft Visual C++ 6 ...
In-Reply-To: <4427CD25.10505@gmail.com>
References: <4427ADF3.10807@navpos.de> <4427CD25.10505@gmail.com>
Message-ID: <4427E26F.8050706@navpos.de>

Mark Kattenbelt schrieb:
> Hello Benjamin,
> 
> Did you use precompiled headers? This solved some linker errors for me. 
> Also are you compiling it to be a dynamic or static library? What flags 
> did you define?


Just found out that
a) the symbols in the file antlr.lib delivered with the msi package may 
have been - or probably have been - produced by a different compiler and 
may be incompatible with VC6.

b) building an antlr library myself is not possible with this compiler 
either - see line 24 in dll.cpp:
# error "DLL Build not supported on old MSVC's"

I'll go for a different compiler then. Thanks anyway.

Cheers
Benjamin
From akiskal at hol.gr  Mon Mar 27 05:33:24 2006
From: akiskal at hol.gr (Vaios Kalpias)
Date: Mon Mar 27 05:33:23 2006
Subject: [antlr-interest] generating formatted java code from an AST
Message-ID: <4427E9A4.8020904@hol.gr>

Hello everybody. I want to generate java code from a given antlr AST 
tree. I know about the JavaEmitter class, but this class is outdated, as 
it works only for Java 1.3. Does anybody know where I can get an updated 
version of the class for Java 1.5? Or maybe you could tell me if there 
is something similar I could use... I tried to update JavaEmitter on my 
own, but there are a lot of things I don't understand yet. So any help 
would be appreciated, because this is extremely important for me!

Thx a lot!
Vaios.
From antlr at jazillian.com  Mon Mar 27 07:49:57 2006
From: antlr at jazillian.com (Andy Tripp)
Date: Mon Mar 27 07:49:57 2006
Subject: [antlr-interest] generating formatted java code from an AST
In-Reply-To: <4427E9A4.8020904@hol.gr>
References: <4427E9A4.8020904@hol.gr>
Message-ID: <442809A5.6000809@jazillian.com>

Vaios Kalpias wrote:

> Hello everybody. I want to generate java code from a given antlr AST 
> tree. I know about the JavaEmitter class, but this class is outdated, 
> as it works only for Java 1.3. Does anybody know where I can get an 
> updated version of the class for Java 1.5? Or maybe you could tell me 
> if there is something similar I could use... I tried to update 
> JavaEmitter on my own, but there are a lot of things I don't 
> understand yet. So any help would be appreciated, because this is 
> extremely important for me!
>
> Thx a lot!
> Vaios.
>
I'll try to update my JavaEmitter to work with Java 1.5 over the next 
few days.

On a related note, I've build a prototype of a WYSIWYG AST Emitter. You 
feed it the ANTLRTokenTypes.txt file and and any AST,
and then you see the AST in a tree on the left and the pretty output on 
the right. You then specify how each
AST node type should be displayed by clicking various nodes in the tree 
and setting properties, and you see the
pretty output get prettier as you do it. It's pretty cool. I was able to 
build a JavaEmitter without any programming in
just a few minutes. This will take a few weeks to a few months to clean 
up and make it more generic so that it works
with any sort of AST.

Andy
From akiskal at hol.gr  Mon Mar 27 08:10:27 2006
From: akiskal at hol.gr (Vaios Kalpias)
Date: Mon Mar 27 08:10:29 2006
Subject: [antlr-interest] generating formatted java code from an AST
In-Reply-To: <442809A5.6000809@jazillian.com>
References: <4427E9A4.8020904@hol.gr> <442809A5.6000809@jazillian.com>
Message-ID: <44280E73.5090405@hol.gr>

Andy Tripp wrote:

> Vaios Kalpias wrote:
>
>> Hello everybody. I want to generate java code from a given antlr AST 
>> tree. I know about the JavaEmitter class, but this class is outdated, 
>> as it works only for Java 1.3. Does anybody know where I can get an 
>> updated version of the class for Java 1.5? Or maybe you could tell me 
>> if there is something similar I could use... I tried to update 
>> JavaEmitter on my own, but there are a lot of things I don't 
>> understand yet. So any help would be appreciated, because this is 
>> extremely important for me!
>>
>> Thx a lot!
>> Vaios.
>>
> I'll try to update my JavaEmitter to work with Java 1.5 over the next 
> few days.
>
> On a related note, I've build a prototype of a WYSIWYG AST Emitter. 
> You feed it the ANTLRTokenTypes.txt file and and any AST,
> and then you see the AST in a tree on the left and the pretty output 
> on the right. You then specify how each
> AST node type should be displayed by clicking various nodes in the 
> tree and setting properties, and you see the
> pretty output get prettier as you do it. It's pretty cool. I was able 
> to build a JavaEmitter without any programming in
> just a few minutes. This will take a few weeks to a few months to 
> clean up and make it more generic so that it works
> with any sort of AST.
>
> Andy
>
>
> __________ NOD32 1.1454 (20060321) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>

I'd be glad to help you if you want, because Im working on my thesis and 
it's very important for me to do it before say august. The updated 
version is what is important for me...Please contact me to talk about 
it! (akiskal@hol.gr)

Nice idea about the GUI btw!

From mail at martin-probst.com  Mon Mar 27 08:12:16 2006
From: mail at martin-probst.com (Martin Probst)
Date: Mon Mar 27 08:12:25 2006
Subject: [antlr-interest] generating formatted java code from an AST
In-Reply-To: <442809A5.6000809@jazillian.com>
References: <4427E9A4.8020904@hol.gr>  <442809A5.6000809@jazillian.com>
Message-ID: <1143475937.6248.2.camel@localhost.localdomain>

> On a related note, I've build a prototype of a WYSIWYG AST Emitter. You 
> feed it the ANTLRTokenTypes.txt file and and any AST,

Any reasons why you didn't use Parser._tokenNames[] (or whatever it's
called) instead of the XXXTokenTypes.txt?

> and then you see the AST in a tree on the left and the pretty output on 
> the right. You then specify how each
> AST node type should be displayed by clicking various nodes in the tree 
> and setting properties, and you see the
> pretty output get prettier as you do it. It's pretty cool. I was able to 
> build a JavaEmitter without any programming in
> just a few minutes. This will take a few weeks to a few months to clean 
> up and make it more generic so that it works
> with any sort of AST.

This might also be handy to generate readable token descriptions, e.g.
the text you can set to get "expected 'class'" instead of "expected
CLASS".

Martin

From cao at danucom.com  Mon Mar 27 08:41:00 2006
From: cao at danucom.com (Guoliang Cao)
Date: Mon Mar 27 08:41:05 2006
Subject: [antlr-interest] HELP: translate javascript code to C#
In-Reply-To: <F41FBD72-FDB7-44FF-92B7-A39C9443ACB7@cs.usfca.edu>
References: <804822922.20060326172552@danucom.com>
	<F41FBD72-FDB7-44FF-92B7-A39C9443ACB7@cs.usfca.edu>
Message-ID: <1951650917.20060327114100@danucom.com>

I changed input to an embeded String but got the same error. Maybe I
should encode the input in unicode? how?

JavascriptLexer lexer = new JavascriptLexer(new StringReader("var table = remainingValue.substring(start + 1, end);"));
JavascriptParser parser = new JavascriptParser(lexer);
parser.program();

> Hi.  Failing so completely must mean a character encoding problem.   
> Make sure the main program that sends a stream of char to the lexer  
> is decoding the input file properly.  You might be trying to read a  
> file from one country using the encoding on your machine or the main  
> program does not use the proper reader.  OR, you are sending in RDF,  
> which is clearly wrong but thought I'd mention it ;)
> Ter




From mark.kattenbelt at gmail.com  Mon Mar 27 09:22:29 2006
From: mark.kattenbelt at gmail.com (Mark Kattenbelt)
Date: Mon Mar 27 09:22:34 2006
Subject: [antlr-interest] antlr on Microsoft Visual C++ 6 ...
In-Reply-To: <4427E26F.8050706@navpos.de>
References: <4427ADF3.10807@navpos.de> <4427CD25.10505@gmail.com>
	<4427E26F.8050706@navpos.de>
Message-ID: <44281F55.2000800@gmail.com>

Hello,

I have got it to work with MSVC 8.0 (VS 2005), with some difficulties on
the way. It seems as though the c++ runtime of antlr is biased towards
GNU compilers. (As then it compiles without any problem).  If want GNU
compilers for windows have a look at cygwin and mingw/minsys. Antlr
works like a charm with with them. If you want an IDE, look at
code::blocks or dev-c++. I've compiled antlr with those IDE's
succesfully before.

Good luck,

Mark

> Mark Kattenbelt schrieb:
>> Hello Benjamin,
>>
>> Did you use precompiled headers? This solved some linker errors for 
>> me. Also are you compiling it to be a dynamic or static library? What 
>> flags did you define?
>
>
> Just found out that
> a) the symbols in the file antlr.lib delivered with the msi package 
> may have been - or probably have been - produced by a different 
> compiler and may be incompatible with VC6.
>
> b) building an antlr library myself is not possible with this compiler 
> either - see line 24 in dll.cpp:
> # error "DLL Build not supported on old MSVC's"
>
> I'll go for a different compiler then. Thanks anyway.
>
> Cheers
> Benjamin
>


From fermin.reig at gmail.com  Mon Mar 27 14:27:55 2006
From: fermin.reig at gmail.com (F Reig)
Date: Mon Mar 27 14:27:57 2006
Subject: [antlr-interest] Manual tree construction in 2.7.6 (buggy?)
Message-ID: <4f1b77310603271427y922b01bn4d51aa801b0d2bab@mail.gmail.com>

Hi,

I'm using 2.7.6, generating C#, and I'm seeing something that looks like a bug.

In my source language, I can write

:DEFAULT x, 1;

and I want to translate that during parsing to:

:DEFAULT (:IF x == NIL; x := 1; :ENDIF;)

I construct the tree by hand like this:

decl_default!
    : d:DEFAULT i:IDENT COMMA e:exp SEMI

       {## = #(#d, #([IF,":IF"],
                     #([EQ_EQ,"=="],#i,#([NIL,"NIL"])),
                     #([STMTS,"STMTS"],
                           #([EXPR,"EXPR"], #([BECOMES,"BECOMES"],#i,#e))
                      )
                    )
              );
       }
    ;

When I dump the tree (or visualize it with antlr.astframe) I see this:

( :DEFAULT ( :IF ( == x NIL 1) ( STMTS ( EXPR ( BECOMES x NIL 1 )))))

That is, there is a spurious "1" in the test, and a spurious "NIL" in
the assignment. Yet, the tree constructor looks OK to me. Am I doing
something wrong, or is there a bug somewhere?

Thanks
Fermin
From Richard.Kennard at mail.thomson.com  Mon Mar 27 15:21:11 2006
From: Richard.Kennard at mail.thomson.com (Richard.Kennard@mail.thomson.com)
Date: Mon Mar 27 15:20:38 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E2F@TLRAUSYDMBX01.ERF.THOMSON.COM>

Dear All,

I am looking to migrate an existing grammar from JavaCC to ANTLR, but am having difficultly with the Lexer.

Specifically, my grammer is very 'English-y', and while JavaCC appears to employ (I'm guessing here) a rather forgiving 'longest match' Lexer, ANTLR warns me to specify an actual 'k=x' lookahead number. I have found this number needs to be pretty large (17) to stop the warning, at which point ANTLR seems to crash (and besides http://www.antlr.org/doc/options.html warns against it, saying 'at large depths will include almost everything').

Here is a snippet of my working JavaCC grammer...

	PARSER_END( BusinessLanguage )

	TOKEN :
	{
		< EQUALS: "is" | "is the same as" | "the same as" | "are" | "are the same as" | "of" >
	|	< NOT_EQUALS: "is not" | "is not the same as" >
	|	< LESS_THAN: "is less than" >
	|	< IDENTIFIER: <LETTER> (<LETTER>|<DIGIT>)* >
	}  	

...and the sort of thing it parses...

	if Status is "Closed" then error "Already closed"
	if Version is less than 1 then error "Version cannot be less than 1"

...and here is what I tried in ANTLR...

	class BusinessLexer extends Lexer;

	options
	{
		k=17;
	}

	EQUALS: "is" | "is the same as" | "the same as" | "are" | "are the same as" | "of";
	NOT_EQUALS: "is not" | "is not the same as";
	LESS_THAN: "is less than";
	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*;

Clearly there is a lot of contention in this grammer, but is there a way to get the equvialent JavaCC behaviour? I would rather not have to code something along the lines of...

	("is" ("not" | "less than")) | ("are" ( "the same as" ))

Your wisdom is most appreciated :)

Regards,

Richard.

From open.zone at virgin.net  Mon Mar 27 15:41:25 2006
From: open.zone at virgin.net (Micheal J)
Date: Mon Mar 27 15:24:26 2006
Subject: [antlr-interest] Manual tree construction in 2.7.6 (buggy?)
In-Reply-To: <4f1b77310603271427y922b01bn4d51aa801b0d2bab@mail.gmail.com>
Message-ID: <000a01c651f7$f7868cc0$6702a8c0@hercules>

> I construct the tree by hand like this:
> 
> decl_default!
>     : d:DEFAULT i:IDENT COMMA e:exp SEMI
> 
>        {## = #(#d, #([IF,":IF"],
>                      #([EQ_EQ,"=="],#i,#([NIL,"NIL"])),
>                      #([STMTS,"STMTS"],
>                            #([EXPR,"EXPR"], 
> #([BECOMES,"BECOMES"],#i,#e))
>                       )
>                     )
>               );
>        }
>     ;
> 
> When I dump the tree (or visualize it with antlr.astframe) I see this:
> 
> ( :DEFAULT ( :IF ( == x NIL 1) ( STMTS ( EXPR ( BECOMES x NIL 1 )))))
> 
> That is, there is a spurious "1" in the test, and a spurious 
> "NIL" in the assignment. Yet, the tree constructor looks OK 
> to me. Am I doing something wrong

Yes. You are trying to add the single IDENT node to two different AST
[sub-]trees.

You need to copy the node if you wish to use it multiple times. Use
dupTree() for that and be sure to set the first-child and next-sibling links
appropriately.

Cheers,

Micheal

From prashant.deva at gmail.com  Mon Mar 27 15:24:32 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Mon Mar 27 15:24:35 2006
Subject: [antlr-interest] Could anybody please suggest a good hosting
	provider
Message-ID: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>

Ok, the ANTLR Studio website (placidsystems.com) is down again!

I am looking for a good hosting provider with 99.9% uptime.
My requirements are  -
Asp.net 1.1
Jvm 1.4
MySql Database

Could anybody give me some suggestions?

--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060328/a5185707/attachment.html
From Richard.Kennard at mail.thomson.com  Mon Mar 27 15:37:40 2006
From: Richard.Kennard at mail.thomson.com (Richard.Kennard@mail.thomson.com)
Date: Mon Mar 27 15:37:07 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E32@TLRAUSYDMBX01.ERF.THOMSON.COM>

Jeff,

Thank you so much for your reply.

I'm afraid I don't think it addresses my issue, principally because the contention is not between the different forms of the same token, but between different tokens. For example...

	EQUALS: "is" | "are";
	NOT_EQUALS: "is not";
	LESS_THAN: "is less than";

...these 3 tokens all begin with "is", and that is what is throwing ANTLR (but not JavaCC) off. I can't make "is" some kind of fixed keyword either, because at least one form of EQUALS ("are") does not require it.

Is there some other way to obtain JavaCC behaviour?

Regards,

Richard.

-----Original Message-----
From: Jeff Barnes [mailto:Jeff.Barnes@codesic.com]
Sent: Tuesday, 28 March 2006 10:26 AM
To: Kennard, Richard; antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


The short answer is:
 
        class BusinessLexer extends Lexer;

        options
        {
        }

        EQUALS: IS_THE_SAME_AS | IS | ARE_THE_SAME_AS | ARE | OF;
       protected IS: "is";
       protected IS_THE_SAME_AS: "is the same as";
       protected ARE: "are";
       protected ARE_THE_SAME_AS: "are the same as";
       protected OF: "of";

Do the same for the other conflicting rules. Check the manual under alts for more info.
 
Your solution may or may not be this simple.
Jeff

From Richard.Kennard at mail.thomson.com  Mon Mar 27 16:02:10 2006
From: Richard.Kennard at mail.thomson.com (Richard.Kennard@mail.thomson.com)
Date: Mon Mar 27 16:01:38 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E34@TLRAUSYDMBX01.ERF.THOMSON.COM>

Robert,

Thank you for your response! I tried your suggestion, but I'm afraid it only succeeded in moving the problem :(

My grammar now looks like...

	equalsCondition :
		"is" ("a")? relativeParameter
		{
			addEqualsCondition();
		}
	;

	notEqualsCondition :
		"is" "not" relativeParameter
		{
			addNotEqualsCondition();
		}		
	;

...and when parsing something like...

	if Item is not blank

...it gets confused saying...

	line 5:12: unexpected token: not

...because, presumably, it is going down the path of the first equalsCondition upon seeing the "is", not the second notEqualsCondition. I'd really rather avoid having to do something like...

	equalsOrNotEqualsCondition :
		"is" (
			( "a" )? relativeParameter
			{
				addEqualsCondition();
			}
			|
			"not" relativeParameter
			{
				addNotEqualsCondition();
			}
			)
	;

...especially when JavaCC handles this so much more compactly.

Your suggestions are much appreciated,

Richard.

-----Original Message-----
From: PATERSON, Robert [mailto:r.paterson@ioof.com.au]
Sent: Tuesday, 28 March 2006 10:37 AM
To: Kennard, Richard
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


The way to do this in ANTLR would be leave only your IDENTIFIER token in
the Lexer and then in the parser refer to your literal tokens directly.
You may need to set testLiterals=true in the options, but I think this
is the default. What ANTLR does is maintain a list of any string
literals used in the grammar and whenever it finds a token it tests the
text against this list of literals to see if it's just a plain old
identifier or if it's a special keyword.

Something like:

	class BusinessParser extends Parser;

	options
	{
		k=1;
	}

	equals :
         "is" ("the" "same" "as")?
         |
         "the" "same" "as"
         |
         "are" ("the" "same" "as")?
         |
         "of"
      ;

	class BusinessLexer extends Lexer;

	options
	{
		k=1;
	}

	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*; 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 10:21 AM
To: antlr-interest@antlr.org
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?

Dear All,

I am looking to migrate an existing grammar from JavaCC to ANTLR, but am
having difficultly with the Lexer.

Specifically, my grammer is very 'English-y', and while JavaCC appears
to employ (I'm guessing here) a rather forgiving 'longest match' Lexer,
ANTLR warns me to specify an actual 'k=x' lookahead number. I have found
this number needs to be pretty large (17) to stop the warning, at which
point ANTLR seems to crash (and besides
http://www.antlr.org/doc/options.html warns against it, saying 'at large
depths will include almost everything').

Here is a snippet of my working JavaCC grammer...

	PARSER_END( BusinessLanguage )

	TOKEN :
	{
		< EQUALS: "is" | "is the same as" | "the same as" |
"are" | "are the same as" | "of" >
	|	< NOT_EQUALS: "is not" | "is not the same as" >
	|	< LESS_THAN: "is less than" >
	|	< IDENTIFIER: <LETTER> (<LETTER>|<DIGIT>)* >
	}  	

...and the sort of thing it parses...

	if Status is "Closed" then error "Already closed"
	if Version is less than 1 then error "Version cannot be less
than 1"

...and here is what I tried in ANTLR...

	class BusinessLexer extends Lexer;

	options
	{
		k=17;
	}

	EQUALS: "is" | "is the same as" | "the same as" | "are" | "are
the same as" | "of";
	NOT_EQUALS: "is not" | "is not the same as";
	LESS_THAN: "is less than";
	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*;

Clearly there is a lot of contention in this grammer, but is there a way
to get the equvialent JavaCC behaviour? I would rather not have to code
something along the lines of...

	("is" ("not" | "less than")) | ("are" ( "the same as" ))

Your wisdom is most appreciated :)

Regards,

Richard.



****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From r.paterson at ioof.com.au  Mon Mar 27 16:05:03 2006
From: r.paterson at ioof.com.au (PATERSON, Robert)
Date: Mon Mar 27 16:05:15 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <FB120A6865FF7741A38A948247A91F12030C6E09@MELSSRV007.ioof.com.au>

I'm afraid your only option is to either increase k to '2' so it can
distinguish between "is" and "is" "not" in separate rules or to left
factor as you've suggested. I think you can specify k=2 as a local
option to particular rules.

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 11:02 AM
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?

Robert,

Thank you for your response! I tried your suggestion, but I'm afraid it
only succeeded in moving the problem :(

My grammar now looks like...

	equalsCondition :
		"is" ("a")? relativeParameter
		{
			addEqualsCondition();
		}
	;

	notEqualsCondition :
		"is" "not" relativeParameter
		{
			addNotEqualsCondition();
		}		
	;

...and when parsing something like...

	if Item is not blank

...it gets confused saying...

	line 5:12: unexpected token: not

...because, presumably, it is going down the path of the first
equalsCondition upon seeing the "is", not the second notEqualsCondition.
I'd really rather avoid having to do something like...

	equalsOrNotEqualsCondition :
		"is" (
			( "a" )? relativeParameter
			{
				addEqualsCondition();
			}
			|
			"not" relativeParameter
			{
				addNotEqualsCondition();
			}
			)
	;

...especially when JavaCC handles this so much more compactly.

Your suggestions are much appreciated,

Richard.

-----Original Message-----
From: PATERSON, Robert [mailto:r.paterson@ioof.com.au]
Sent: Tuesday, 28 March 2006 10:37 AM
To: Kennard, Richard
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


The way to do this in ANTLR would be leave only your IDENTIFIER token in
the Lexer and then in the parser refer to your literal tokens directly.
You may need to set testLiterals=true in the options, but I think this
is the default. What ANTLR does is maintain a list of any string
literals used in the grammar and whenever it finds a token it tests the
text against this list of literals to see if it's just a plain old
identifier or if it's a special keyword.

Something like:

	class BusinessParser extends Parser;

	options
	{
		k=1;
	}

	equals :
         "is" ("the" "same" "as")?
         |
         "the" "same" "as"
         |
         "are" ("the" "same" "as")?
         |
         "of"
      ;

	class BusinessLexer extends Lexer;

	options
	{
		k=1;
	}

	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*; 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 10:21 AM
To: antlr-interest@antlr.org
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?

Dear All,

I am looking to migrate an existing grammar from JavaCC to ANTLR, but am
having difficultly with the Lexer.

Specifically, my grammer is very 'English-y', and while JavaCC appears
to employ (I'm guessing here) a rather forgiving 'longest match' Lexer,
ANTLR warns me to specify an actual 'k=x' lookahead number. I have found
this number needs to be pretty large (17) to stop the warning, at which
point ANTLR seems to crash (and besides
http://www.antlr.org/doc/options.html warns against it, saying 'at large
depths will include almost everything').

Here is a snippet of my working JavaCC grammer...

	PARSER_END( BusinessLanguage )

	TOKEN :
	{
		< EQUALS: "is" | "is the same as" | "the same as" |
"are" | "are the same as" | "of" >
	|	< NOT_EQUALS: "is not" | "is not the same as" >
	|	< LESS_THAN: "is less than" >
	|	< IDENTIFIER: <LETTER> (<LETTER>|<DIGIT>)* >
	}  	

...and the sort of thing it parses...

	if Status is "Closed" then error "Already closed"
	if Version is less than 1 then error "Version cannot be less
than 1"

...and here is what I tried in ANTLR...

	class BusinessLexer extends Lexer;

	options
	{
		k=17;
	}

	EQUALS: "is" | "is the same as" | "the same as" | "are" | "are
the same as" | "of";
	NOT_EQUALS: "is not" | "is not the same as";
	LESS_THAN: "is less than";
	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*;

Clearly there is a lot of contention in this grammer, but is there a way
to get the equvialent JavaCC behaviour? I would rather not have to code
something along the lines of...

	("is" ("not" | "less than")) | ("are" ( "the same as" ))

Your wisdom is most appreciated :)

Regards,

Richard.



****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From Richard.Kennard at mail.thomson.com  Mon Mar 27 16:08:42 2006
From: Richard.Kennard at mail.thomson.com (Richard.Kennard@mail.thomson.com)
Date: Mon Mar 27 16:08:08 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E35@TLRAUSYDMBX01.ERF.THOMSON.COM>

Robert,

Fair enough.

So would I be right in thinking that the JavaCC Lexer is implemented quite differently? That there is no ANTLR equivalent (either now or planned, though I guess that is a question for Ter)?

Regards,

Richard.

-----Original Message-----
From: PATERSON, Robert [mailto:r.paterson@ioof.com.au]
Sent: Tuesday, 28 March 2006 11:05 AM
To: Kennard, Richard
Cc: antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


I'm afraid your only option is to either increase k to '2' so it can
distinguish between "is" and "is" "not" in separate rules or to left
factor as you've suggested. I think you can specify k=2 as a local
option to particular rules.

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 11:02 AM
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?

Robert,

Thank you for your response! I tried your suggestion, but I'm afraid it
only succeeded in moving the problem :(

My grammar now looks like...

	equalsCondition :
		"is" ("a")? relativeParameter
		{
			addEqualsCondition();
		}
	;

	notEqualsCondition :
		"is" "not" relativeParameter
		{
			addNotEqualsCondition();
		}		
	;

...and when parsing something like...

	if Item is not blank

...it gets confused saying...

	line 5:12: unexpected token: not

...because, presumably, it is going down the path of the first
equalsCondition upon seeing the "is", not the second notEqualsCondition.
I'd really rather avoid having to do something like...

	equalsOrNotEqualsCondition :
		"is" (
			( "a" )? relativeParameter
			{
				addEqualsCondition();
			}
			|
			"not" relativeParameter
			{
				addNotEqualsCondition();
			}
			)
	;

...especially when JavaCC handles this so much more compactly.

Your suggestions are much appreciated,

Richard.

-----Original Message-----
From: PATERSON, Robert [mailto:r.paterson@ioof.com.au]
Sent: Tuesday, 28 March 2006 10:37 AM
To: Kennard, Richard
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


The way to do this in ANTLR would be leave only your IDENTIFIER token in
the Lexer and then in the parser refer to your literal tokens directly.
You may need to set testLiterals=true in the options, but I think this
is the default. What ANTLR does is maintain a list of any string
literals used in the grammar and whenever it finds a token it tests the
text against this list of literals to see if it's just a plain old
identifier or if it's a special keyword.

Something like:

	class BusinessParser extends Parser;

	options
	{
		k=1;
	}

	equals :
         "is" ("the" "same" "as")?
         |
         "the" "same" "as"
         |
         "are" ("the" "same" "as")?
         |
         "of"
      ;

	class BusinessLexer extends Lexer;

	options
	{
		k=1;
	}

	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*; 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 10:21 AM
To: antlr-interest@antlr.org
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?

Dear All,

I am looking to migrate an existing grammar from JavaCC to ANTLR, but am
having difficultly with the Lexer.

Specifically, my grammer is very 'English-y', and while JavaCC appears
to employ (I'm guessing here) a rather forgiving 'longest match' Lexer,
ANTLR warns me to specify an actual 'k=x' lookahead number. I have found
this number needs to be pretty large (17) to stop the warning, at which
point ANTLR seems to crash (and besides
http://www.antlr.org/doc/options.html warns against it, saying 'at large
depths will include almost everything').

Here is a snippet of my working JavaCC grammer...

	PARSER_END( BusinessLanguage )

	TOKEN :
	{
		< EQUALS: "is" | "is the same as" | "the same as" |
"are" | "are the same as" | "of" >
	|	< NOT_EQUALS: "is not" | "is not the same as" >
	|	< LESS_THAN: "is less than" >
	|	< IDENTIFIER: <LETTER> (<LETTER>|<DIGIT>)* >
	}  	

...and the sort of thing it parses...

	if Status is "Closed" then error "Already closed"
	if Version is less than 1 then error "Version cannot be less
than 1"

...and here is what I tried in ANTLR...

	class BusinessLexer extends Lexer;

	options
	{
		k=17;
	}

	EQUALS: "is" | "is the same as" | "the same as" | "are" | "are
the same as" | "of";
	NOT_EQUALS: "is not" | "is not the same as";
	LESS_THAN: "is less than";
	IDENTIFIER: ('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*;

Clearly there is a lot of contention in this grammer, but is there a way
to get the equvialent JavaCC behaviour? I would rather not have to code
something along the lines of...

	("is" ("not" | "less than")) | ("are" ( "the same as" ))

Your wisdom is most appreciated :)

Regards,

Richard.



****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From r.paterson at ioof.com.au  Mon Mar 27 16:11:51 2006
From: r.paterson at ioof.com.au (PATERSON, Robert)
Date: Mon Mar 27 16:11:59 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <FB120A6865FF7741A38A948247A91F12030C6E0B@MELSSRV007.ioof.com.au>

Well, my ANTLR experience is limited to knocking out some pretty
straight forward parsers, so I wouldn't draw any conclusions from
anything I say! 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 11:09 AM
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?

Robert,

Fair enough.

So would I be right in thinking that the JavaCC Lexer is implemented
quite differently? That there is no ANTLR equivalent (either now or
planned, though I guess that is a question for Ter)?

Regards,

Richard.


****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From Richard.Kennard at mail.thomson.com  Mon Mar 27 16:14:09 2006
From: Richard.Kennard at mail.thomson.com (Richard.Kennard@mail.thomson.com)
Date: Mon Mar 27 16:14:37 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
Message-ID: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E36@TLRAUSYDMBX01.ERF.THOMSON.COM>

Robert,

On the contrary, I place a lot of value in answers from people who know what they don't know :)

Richard.

-----Original Message-----
From: PATERSON, Robert [mailto:r.paterson@ioof.com.au]
Sent: Tuesday, 28 March 2006 11:12 AM
To: Kennard, Richard; antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?


Well, my ANTLR experience is limited to knocking out some pretty
straight forward parsers, so I wouldn't draw any conclusions from
anything I say! 

-----Original Message-----
From: antlr-interest-bounces@antlr.org
[mailto:antlr-interest-bounces@antlr.org] On Behalf Of
Richard.Kennard@mail.thomson.com
Sent: Tuesday, 28 March 2006 11:09 AM
To: antlr-interest@antlr.org
Subject: RE: [antlr-interest] ANTLR equivalent of JavaCC Lexer
behaviour?

Robert,

Fair enough.

So would I be right in thinking that the JavaCC Lexer is implemented
quite differently? That there is no ANTLR equivalent (either now or
planned, though I guess that is a question for Ter)?

Regards,

Richard.


****************************************************************************
IMPORTANT - PLEASE READ
This communication is intended only for the use of the addressee and 
may contain personal information, confidential information or legally 
privileged information. If personal information is contained in this e-mail, 
then it is governed by the Privacy Act 1988 and must be treated in 
accordance with the Privacy Act 1988 by the recipient. The legal 
privilege and confidentiality attached to this e-mail is not waivered, 
lost or destroyed by reason of mistaken delivery to you. If you are not 
the intended recipient, we would appreciate immediate notification by 
return e-mail or telephoning +61-3-8614-4444 and ask that the message 
be permanently deleted from your system. If you are the intended 
recipient of this communication you should not copy, disclose or distribute this communication without the authority of IOOF or its related entities (the IOOF Group).
Any views expressed in this message are those of the individual sender, 
except where they are specifically stated to be the views of the IOOF 
Group.
This e-mail and any attachments have been scanned for computer viruses 
using anti-viral software, but you should also perform your own scan. We 
do not accept liability for any loss or damage, whether caused by our own negligence or not, that results from a computer virus or a defect in the transmission of the e-mail or any attached file.
****************************************************************************

From open.zone at virgin.net  Mon Mar 27 18:23:12 2006
From: open.zone at virgin.net (Micheal J)
Date: Mon Mar 27 18:06:11 2006
Subject: [antlr-interest] ANTLR equivalent of JavaCC Lexer behaviour?
In-Reply-To: <4C9E66B7E0FD5B448B6FBDAF4482B13DA41E35@TLRAUSYDMBX01.ERF.THOMSON.COM>
Message-ID: <000f01c6520e$90e64e30$6702a8c0@hercules>

> Robert,
> 
> Fair enough.
> 
> So would I be right in thinking that the JavaCC Lexer is 
> implemented quite differently?

Yes, it's implemented as a traditional [D]FA-based recognizer afaict. ANTLR
lexers are LL recognizers.

> That there is no ANTLR 
> equivalent (either now or planned, though I guess that is a 
> question for Ter)?

You can continue as you are doing and [re-]write/massage your grammar for
ANTLR lexing. Or you could try using JFlex/CsFlex. They also generate
DFA-based recognizers but, these recognizers can be easily interfaced with
ANTLR. ANTLR 2.7.6 includes an example (in C#) of using CsFlex and an ANTLR
parser. It is called 'csharp_v1'.


Cheers,

Micheal

From mail at martin-probst.com  Tue Mar 28 00:05:15 2006
From: mail at martin-probst.com (Martin Probst)
Date: Tue Mar 28 00:05:18 2006
Subject: [antlr-interest] Could anybody please suggest a good hosting
	provider
In-Reply-To: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>
References: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>
Message-ID: <1143533115.5517.5.camel@localhost.localdomain>

How can you expect a hoster to provide ASP.NET and a stable server at
the same time? *ducks for cover*

Martin

From prashant.deva at gmail.com  Tue Mar 28 00:34:49 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Tue Mar 28 00:35:02 2006
Subject: [antlr-interest] Could anybody please suggest a good hosting
	provider
In-Reply-To: <1143533115.5517.5.camel@localhost.localdomain>
References: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>
	<1143533115.5517.5.camel@localhost.localdomain>
Message-ID: <41fed8f80603280034t6d982ecek40ce20ef4af800db@mail.gmail.com>

Usually its tomcat which screws up ;)

Asp.net runs like a dream. I hate having to run one module of the website on
java, but that part cant be done in .net so I dont have a choice :(


On 3/28/06, Martin Probst <mail@martin-probst.com> wrote:
>
> How can you expect a hoster to provide ASP.NET and a stable server at
> the same time? *ducks for cover*
>
> Martin
>
>


--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060328/61eea549/attachment.html
From sunjigang1965 at yahoo.com.cn  Tue Mar 28 02:23:53 2006
From: sunjigang1965 at yahoo.com.cn (=?gb2312?q?=CB=EF=BC=CD=B8=D5=20Jigang=20(Robert)=20Sun?=)
Date: Tue Mar 28 02:23:59 2006
Subject: [antlr-interest] In c#, how to override a vaiable in a subclass 
Message-ID: <20060328102353.95951.qmail@web15708.mail.cnb.yahoo.com>

I want to declare a geneirc variable in a parent class, then use it as as diffrent type in
respective subclasses. I tried as such which was rejected: 

class P
{
   object v;
   ...
}

class Child1:P
{ 
    (int) v;//want to override object v as integer type, rejected
...
}
class Child2:P
{
    (string) v; //want to override object v as string type, rejected
...
}

Cheers.

Jigang



	

	
		
___________________________________________________________ 
1G 
http://cn.mail.yahoo.com/
From open.zone at virgin.net  Tue Mar 28 03:00:16 2006
From: open.zone at virgin.net (Micheal J)
Date: Tue Mar 28 02:43:15 2006
Subject: [antlr-interest] In c#, how to override a vaiable in a subclass 
In-Reply-To: <20060328102353.95951.qmail@web15708.mail.cnb.yahoo.com>
Message-ID: <001901c65256$ccbaff30$6702a8c0@hercules>

> I want to declare a geneirc variable in a parent class, then 
> use it as as diffrent type in respective subclasses. I tried 
> as such which was rejected: 
> 
> class P
> {
>    object v;
>    ...
> }

You can't "override" a field. What about using properties?

Given class P as above (v needs to be declared as "protected"), you could
try this:

class Child1 : P
{
    public int Value
    {
	get { return (int)v; }
	set { v = value; }
    }
}

class Child2 : P
{
    public string Value
    {
	get { return (string)v; }
	set { v = value; }
    }
}


Cheers,

Micheal

From craymer at warpiv.com  Tue Mar 28 02:53:55 2006
From: craymer at warpiv.com (Loring Craymer)
Date: Tue Mar 28 02:54:04 2006
Subject: [antlr-interest] Could anybody please suggest a good
	hostingprovider
In-Reply-To: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>
Message-ID: <00b101c65255$eb46a090$8302a8c0@Fafnir>

Prashant--

Check out www.ixwebhosting.com.  It is hard to beat their prices, and the
servers are well-behaved.  I assume that they support JVM 1.4, but haven't
had reason to verify that.  They do support your other requirements.

--Loring

> -----Original Message-----
> From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> bounces@antlr.org] On Behalf Of Prashant Deva
> Sent: Monday, March 27, 2006 3:25 PM
> To: antlr-interest
> Subject: [antlr-interest] Could anybody please suggest a good
> hostingprovider
> 
> Ok, the ANTLR Studio website (placidsystems.com) is down again!
> 
> I am looking for a good hosting provider with 99.9% uptime.
> My requirements are  -
> Asp.net <http://Asp.net>  1.1
> Jvm 1.4
> MySql Database
> 
> Could anybody give me some suggestions?
> 
> --
> Prashant Deva
> Creator, ANTLR Studio
> Founder, Placid Systems, www.placidsystems.com


From mail at martin-probst.com  Tue Mar 28 03:45:20 2006
From: mail at martin-probst.com (Martin Probst)
Date: Tue Mar 28 03:45:21 2006
Subject: [antlr-interest] In c#, how to override a vaiable in a subclass
In-Reply-To: <20060328102353.95951.qmail@web15708.mail.cnb.yahoo.com>
References: <20060328102353.95951.qmail@web15708.mail.cnb.yahoo.com>
Message-ID: <1143546320.5517.26.camel@localhost.localdomain>

Hi,

I think what you're trying to do is highly deprecated/considered
harmful, that's why it's rather difficult in programming languages. If
you have a field 'v' that sometimes is of type string and sometimes of
type integer, what is the relation between the two values that justifies
them to have the same name?

Why do you have to declare it in a top level class if you cannot use it
in there, because you don't have a clue about it's type?

Martin

From aldana at gmx.de  Tue Mar 28 07:08:16 2006
From: aldana at gmx.de (manuel aldana)
Date: Tue Mar 28 07:08:19 2006
Subject: [antlr-interest] custom methods to CommonAST
Message-ID: <44295160.4080304@gmx.de>

how is it possible to append custom helper methods to my CommonAST

something like for parser/lexer block:
{
   ...
}

just for my CommonAST. so if i call parser.getAST() i get an ast where i 
can call some additional methods.

custom methods are simple makros which use already existing methods like 
getNextSibling() or similar, they have no effects to my parser grammar, 
their just custom queries.
i read that i can hook to ASTFactory but i want to avoid that because it 
is just little query-helper methods i want to provide.

thanks a lot!

-- 
  manuel aldana
  aldana@gmx.de
  aldana@cs.tu-berlin.de
	
From kalle at snigel.net  Tue Mar 28 11:00:30 2006
From: kalle at snigel.net (karl wettin)
Date: Tue Mar 28 10:58:15 2006
Subject: [antlr-interest] my nondeterministic grammar
Message-ID: <77CE9E0F-2FF3-4031-9F8A-3188EF575DD5@snigel.net>

Basically I'm trying to use Antlr as a natrual language parser. I've  
succeded with the grammar before, but as I felt the urge to refactor  
it I I get all these nondeterministic warnings. I understand what  
they mean, but I can understand why I get them.
If there is one rule I don't understand why it is nondeterministic,  
it's the protected EN_NATURAL_EPISODE. And since this rule "fails" my  
grammar is rendered useless. I've been reading up on syntactic  
predicate, but don't think that it's the solution.

There are no trees or any other fancy things. It's a straight forward  
Lexer. It's Java and I have added a main method that explains what I  
try to parse.

Also, I don't understand why my EN_NATURAL_NUMBER returns a token and  
not an integer?

I would be very greatful if someone could take a few minutes and look  
it. I'll even out the karma from freeloading by answering newbie  
questions on other forums until I've figured this out. :)


header {
	package se.snigel.tindex.analysis.tvserie;
	import java.util.*;
	import java.io.*;
	
	import antlr.CommonToken;
	import antlr.Token;	
}


class TVSerieEpisodeLexer extends Lexer;
options {
	k=10;
}
{	
	public class SeasonAndEpisode {
		private int season;
		private int episode;	
		private SeasonAndEpisode(int season, int episode) {
			this.season = season;
			this.episode = episode;
		}
		public int getSeason() {
			return season;
		}
		public int getEpisode() {
			return episode;
		}
		public String toString() {
			return season + "x" + episode;	
		}
	}
	
	private LinkedList<SeasonAndEpisode> episodes = new  
LinkedList<SeasonAndEpisode>();
	private LinkedList<Integer> seasons = new LinkedList<Integer>();
	
	/** for sanity checks */
	private Long fileSize;
	
	private void addSequence(boolean skipFirstEpisode, Integer  
fromSeason, Integer fromEpisode, Integer toSeason, Integer toEpisode) {
         int startEpisode = fromEpisode;
         int endEpisode;
         if (fromSeason == toSeason) {
             endEpisode = toEpisode;
         } else {
             throw new RuntimeException("Need to figure out the last  
episode of this season.");
         }

         LinkedList<SeasonAndEpisode> saes = new  
LinkedList<SeasonAndEpisode>();

         for (int season = fromSeason; season <= toSeason; season++) {
             for (int episode = startEpisode; episode <= endEpisode;  
episode++) {
                 saes.add(new SeasonAndEpisode(season, episode));
             }
             startEpisode = 1;
         }

         if (skipFirstEpisode) {
			saes.removeFirst();
         }

         // how big is the file, and how many episodes are there?
         if (fileSize != null) {
             if (120 * 1024 * saes.size() <= fileSize) {
                 episodes.addAll(saes);
             } else {
                 // todo could it be S1 - 7 as in s1e7?
             }
         }

     }

     public String toString() {
     		StringBuffer buf = new StringBuffer();
     		for (SeasonAndEpisode sae : episodes) {
     			buf.append(sae);
			buf.append('\n');	
     		}
     		for (Integer s : seasons) {
     			buf.append(s);
			buf.append('\n');	
     		}
     		
     		return buf.toString();
     }

	public static void main(String[] args) throws Exception {
	
		String[] testText = new String[]{
			"season 1 jo men visst",
			"s1e1",
			"s1",
			"s 1",
			"season 1",
			"season 1 episode 3",
			"s1,s2,s3",
			"s1-s3",
			"s1e3-4",
			"s1 e4, 5, 6",
			"season one will fail. how do I handle the EN_NATURAL_NUMBER int?",
			"s1 - 4 is this really four seasons? sanity check. is it s1e4?",
			"s1e19-s2e12 what is the last episode of season 1?",
		};
			
		for (String text : testText) {
			System.out.println(text);
			TVSerieEpisodeLexer lexer = new TVSerieEpisodeLexer(new  
StringReader(text));
			lexer.nextToken();
			System.out.println(lexer);
		}
	}
	
}


	
protected WHITESPACE :
	('.' | ' ')+
	;

protected EN_NATURAL_SEASON :
	's' ("eason" ('s')?)?
	;

protected EN_NATURAL_EPISODE :
	'e'('p'("isode" | 's')?)?
	/*"episode" | "eps" | "ep" | "e"*/
	;

protected EN_NATURAL_VECTOR :
	"and" | ","
	;

protected EN_NATURAL_SEQUENCE :
	"to" | "through" | "-"
	;

protected EN_NATURAL_NUMBER returns [int v] :
     ('0'..'9')+ { v=Integer.valueOf($getText); }
     | "one"     { v=1; }
     | "two"     { v=2; }
     | "three"   { v=3; }
     | "four"    { v=4; }
     | "five"    { v=5; }
     | "six"     { v=6; }
     | "seven"   { v=7; }
     | "eight"   { v=8; }
     | "nine"    { v=9; }
     | "ten"     { v=10;}
     ;

	
EN_NATURAL :
	{System.out.println("EN_NATURAL");}
	EN_NATURAL_SEASON (WHITESPACE)?
	startSeason:EN_NATURAL_NUMBER
		
	(	
		// specific episodes
		EN_NATURAL_EPISODE (WHITESPACE)?
		startEpisode:EN_NATURAL_NUMBER	
		(
			{System.out.println("episode sequence");}
			// sequence
			EN_NATURAL_SEQUENCE (WHITESPACE)?
			(
		        EN_NATURAL_SEASON (WHITESPACE)?
		        episodeSequenceEndSeason:EN_NATURAL_NUMBER (WHITESPACE)?	
		    )?
		    EN_NATURAL_EPISODE (WHITESPACE)?
		    episodeSequenceEndEpisode:EN_NATURAL_NUMBER
		    {
		    		addSequence(false,
					new Integer(startSeason.getText()),
					new Integer(startEpisode.getText()),
					episodeSequenceEndSeason == null ? new Integer 
(startSeason.getText()) : new Integer(episodeSequenceEndSeason.getText 
()),
					new Integer(episodeSequenceEndEpisode.getText())
				);
		    }
			
		
	    ) | (
	    		{System.out.println("episode vector");}	    		
	    		// vector
			{
	    			Integer lastSeenSeason = new Integer(startSeason.getText());
	    			episodes.add(new SeasonAndEpisode(new Integer 
(startSeason.getText()), new Integer(startEpisode.getText())));				
	    		}
	    		(	    			
				EN_NATURAL_VECTOR (WHITESPACE)?
				(
					EN_NATURAL_SEASON (WHITESPACE)?
					episodeVectorAndSeason:EN_NATURAL_NUMBER (WHITESPACE)?
					{
						lastSeenSeason = new Integer(episodeVectorAndSeason.getText());	
					}
				)?
				EN_NATURAL_EPISODE (WHITESPACE)?

				episodeVectorAndEpisode:EN_NATURAL_NUMBER (WHITESPACE)?
				{
	            		episodes.add(new SeasonAndEpisode(lastSeenSeason, new  
Integer(episodeVectorAndEpisode.getText())));
	            }
			)+
			
	    		
		) | (
			(.)*
			{System.out.println("a specific episode in a season.");}
			{
				episodes.add(new SeasonAndEpisode(new Integer(startSeason.getText 
()), new Integer(startEpisode.getText())));
			}
			
			
		)  		
	) | (
		{System.out.println("season only.");}
		(	
			{System.out.println("sequence of seasons.");}
			// sequence
			EN_NATURAL_SEQUENCE (WHITESPACE)?
			(EN_NATURAL_SEASON (WHITESPACE)?)?
		    seasonSequenceEndSeason:EN_NATURAL_NUMBER			
		    {
		    		for (int i= new Integer(startSeason.getText()); i <= new  
Integer(seasonSequenceEndSeason.getText()); i++) {
					seasons.add(i);
					// todo sanity check file size	
		    		}		
		    }		    	    		
		) | (
		
			{System.out.println("vector of seasons");}
			// vector			
			{
				seasons.add(new Integer(startSeason.getText()));
			}
			(								
		        EN_NATURAL_VECTOR (WHITESPACE)?
		        (
		            (EN_NATURAL_SEASON (WHITESPACE)?)?
		            seasonVectorAndSeason:EN_NATURAL_NUMBER (WHITESPACE)?
		            {		            		
		            		seasons.add(new Integer(seasonVectorAndSeason.getText 
()));
		            }
		        )
		    )+
		
		) | (		
			(.)*
			{System.out.println("a single season");}
			{
				seasons.add(new Integer(startSeason.getText()));
			}				
		)
	)
	;

From prashant.deva at gmail.com  Tue Mar 28 15:18:51 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Tue Mar 28 15:18:53 2006
Subject: [antlr-interest] Could anybody please suggest a good
	hostingprovider
In-Reply-To: <00b101c65255$eb46a090$8302a8c0@Fafnir>
References: <41fed8f80603271524v16648ca7iffe2f5c465370935@mail.gmail.com>
	<00b101c65255$eb46a090$8302a8c0@Fafnir>
Message-ID: <41fed8f80603281518g45f2be35yababeb62a99de42e@mail.gmail.com>

Hi Loring,
Thanks for the link :)

 Yes the price is very nice but I will have to check their support for jvm.
Also the page doesnt say anything about 24x7 support which is another
requirement (i forget to mention in original post). ;-)

On 3/28/06, Loring Craymer <craymer@warpiv.com> wrote:
>
> Prashant--
>
> Check out www.ixwebhosting.com.  It is hard to beat their prices, and the
> servers are well-behaved.  I assume that they support JVM 1.4, but haven't
> had reason to verify that.  They do support your other requirements.
>
> --Loring
>
> > -----Original Message-----
> > From: antlr-interest-bounces@antlr.org [mailto:antlr-interest-
> > bounces@antlr.org] On Behalf Of Prashant Deva
> > Sent: Monday, March 27, 2006 3:25 PM
> > To: antlr-interest
> > Subject: [antlr-interest] Could anybody please suggest a good
> > hostingprovider
> >
> > Ok, the ANTLR Studio website (placidsystems.com) is down again!
> >
> > I am looking for a good hosting provider with 99.9% uptime.
> > My requirements are  -
> > Asp.net <http://Asp.net>  1.1
> > Jvm 1.4
> > MySql Database
> >
> > Could anybody give me some suggestions?
> >
> > --
> > Prashant Deva
> > Creator, ANTLR Studio
> > Founder, Placid Systems, www.placidsystems.com
>
>
>


--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060329/34c17d8b/attachment.html
From prashant.deva at gmail.com  Tue Mar 28 15:24:07 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Tue Mar 28 15:24:10 2006
Subject: [antlr-interest] Re: ANTLR Studio in Programmation Sous Linux
	Magazine!
In-Reply-To: <41fed8f80603261232x3b2cd124s5c7e0d5c1feac1be@mail.gmail.com>
References: <41fed8f80603261232x3b2cd124s5c7e0d5c1feac1be@mail.gmail.com>
Message-ID: <41fed8f80603281524w42a404d6p573dd1fe0a8d55e1@mail.gmail.com>

As an update to this, the publishers were kind enough to send the scans of
the magazine pages on request.

I will upload them shortly so that everyone can take a look :)

Thanks also to Dominik Holenstein for offering to send the scans :)

On 3/27/06, Prashant Deva <prashant.deva@gmail.com> wrote:
>
> ANTLR Studio is in the latest issue of Programmaion Sous Linux Magazine!
>
> http://translate.google.com/translate?hl=en&sl=fr&u=www.proglinux.org/fr/modules/news2/article.php?storyid=2
>
>
> The magazine contains an article on AS and AS itself on the cd.
> Its available in French & German only.
>
> Ironically, although the magazine contains my article and my software on
> the cd, the publishers havent been kind enough to send me a copy of it. My
> emails to them about it has gone unanswered.
>
> If anyone gets hold of an issue of the magazine, could you please atleast
> send me some scans of the front cover and the pages containing the article?
>
> --
> Prashant Deva
> Creator, ANTLR Studio
> Founder, Placid Systems, www.placidsystems.com
>



--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060329/1701a3dd/attachment.html
From jg at pcCFD.com  Tue Mar 28 15:40:29 2006
From: jg at pcCFD.com (Joseph Goettgens)
Date: Tue Mar 28 15:40:37 2006
Subject: [antlr-interest] Re: antlr-interest@antlr.org
Message-ID: <000901c652c1$01ff4470$1863a8c0@lynx>

Karl,

> succeded with the grammar before, ...

> Basically I'm trying to use Antlr as a natrual language parser.
you seem to put a lot of (read: too much) stuff  into the lexer. The grammar 
is probaly the center for organizing things since it is more  "capable" than 
a lexer, though antlr blurs this difference to some degree. The grammar 
eventually will tell you which token types you need to 
distinguish---shouldn't be too many as natural languages don't have things 
like reserved words or other constructs derived from regular expressions. 
Have a look at http://en.wikipedia.org/wiki/Formal_language . I guess you 
are still dealing with a formal languange and not a natural one (e.g. see 
http://en.wikipedia.org/wiki/Noam_Chomsky). If you were really dealing with 
a natural language you'd be dealing with ungrammatical things sooner or 
later. Kalle, f?r den Fall, dass Du zuviel Bier trinkts, the lexer will 
become a real challenge, Prost and indeed.

Even if you were able to specify a description of your language with a 
single meta-language you are giving up one level of abstraction, since 
grammars give rules for types of words and lexers give rules on how to form 
words from elements of a vocabulary. In algebraic terms, you would avoid 
factoring out common terms and are punished by dealing with unnecessarily 
complex expression, subsequently.

jg

From janm at transactionware.com  Tue Mar 28 17:05:57 2006
From: janm at transactionware.com (Jan Mikkelsen)
Date: Tue Mar 28 16:58:20 2006
Subject: [antlr-interest] draft Mantra language proposal
In-Reply-To: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>
References: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>
Message-ID: <4429DD75.3060204@transactionware.com>

Hi,

Terence Parr wrote:
> I have much of the following proposal implemented for Mantra:
> 
> http://www.linguamantra.org/
> 
> It will serve as a tutorial for ANTLR v3 once I get it cleaned up as  it 
> uses about everything :)

Interesting.

Is this intended to run on top of existing JVMs, or have its own 
execution environment?

Is the point to have some kind of access to existing Java stuff without 
having to deal with the Java language?  (otherwise you'd just use Ruby 
or Python.)  Or is there some other point that I've missed?

Regards,

Jan Mikkelsen




From parrt at cs.usfca.edu  Tue Mar 28 17:44:20 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue Mar 28 17:44:25 2006
Subject: [antlr-interest] draft Mantra language proposal
In-Reply-To: <4429DD75.3060204@transactionware.com>
References: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>
	<4429DD75.3060204@transactionware.com>
Message-ID: <07CCB604-844E-4036-BA37-D628F99CC34F@cs.usfca.edu>


On Mar 28, 2006, at 5:05 PM, Jan Mikkelsen wrote:

> Hi,
>
> Terence Parr wrote:
>> I have much of the following proposal implemented for Mantra:
>> http://www.linguamantra.org/
>> It will serve as a tutorial for ANTLR v3 once I get it cleaned up  
>> as  it uses about everything :)
>
> Interesting.
>
> Is this intended to run on top of existing JVMs, or have its own  
> execution environment?

Yes, just a source to source translator to Java...

> Is the point to have some kind of access to existing Java stuff  
> without having to deal with the Java language?

Correct.  I'm tired of casting out of data structures etc...

>   (otherwise you'd just use Ruby or Python.)

Well, i like static types for humans and for speed.  I don't like  
Ruby syntax and I think Python has limited closures.  I also like  
types as I said.  Hence, Mantra. :)

The file extension is ".om" for "oooohhhhmmmm" (you know, like a  
mantra chant). :)

>   Or is there some other point that I've missed?

You are correct :)

It will also be a great v3 demo/tutorial.

Ter
From mail at martin-probst.com  Wed Mar 29 00:58:39 2006
From: mail at martin-probst.com (Martin Probst)
Date: Wed Mar 29 00:58:43 2006
Subject: [antlr-interest] draft Mantra language proposal
In-Reply-To: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>
References: <3A108B6D-F611-44F7-BD4F-E4332DF8CA47@cs.usfca.edu>
Message-ID: <1143622719.5639.31.camel@localhost.localdomain>

Hi,

to begin with: did you look at some of the other languages? There are
quite some that might solve your issues without having to introduce a
new language. E.g. Groovy, JRuby and Jython on the dynamic side, or
Scala and Nice for static languages. I think all of them provide
closures, function pointers, built in types and the casting thing. Scala
and Nice also have a lot of really interesting functional featuers.

Some longer comments:

* Overly intrusive casting

I don't quite get what you want to do there. From the example you give
it looks as if objects and be auto-cast into subtypes, ie if A extends
B, than you can do "A a = b". I think that is an important feature of a
statically typed OOP programming language. The feature is that the
language gives errors on certain conditions that are with almost
absolute certainty programming errors or design errors. I concurr that
there (almost) should not be a cast statement, but without any automatic
casting ;-). And for casting out of structures you have Java 5 generics.

* Fixing main() declaration

It's kind of annoying, though in every app you develop it happens
exactly once ... are you going to allow function declarations in that
anonymous file without a class? How are you going to identify the
program to run (if you don't have the class name)?

* Closures, function pointers

That's certainly nice. Are you going to have static typing on closures
and function pointers?

* Built in list, hash

That's really nice, too. Always been a pain in Java.

* Properties

I really don't know what people have about this, but maybe it's just me.

And some quick comments:

      * a.b.c is ambiguous; use package::class.member - I think that is
        a non issue, I've never heard of anyone running into that as a
        problem, and if so, it's easily fixed
      * CLASSPATH for dev and deploy can be different; result of
        compilation should be a jar - you mean "should be a *single*
        jar"? I'm not sure if that is something you really want - think
        of web containers a la tomcat, layered class loaders, common
        (shared) libraries etc. If you duplicate the same libraries in
        every jar of every web app you have you'll get an insane memory
        usage
      * exception "throw or catch contract" is annoying; remove contract
        (I might be wrong about this) - I certainly think you are ;-)
      * mutable strings; I do not like that the strings and StringBuffer
        are different. - this may be a major performance issue, no? Plus
        if you add more functional language stuff and especially with
        closures, you should probably endorse immutable values, no?

From prashant.deva at gmail.com  Wed Mar 29 09:47:17 2006
From: prashant.deva at gmail.com (Prashant Deva)
Date: Wed Mar 29 09:47:22 2006
Subject: [antlr-interest] Re: ANTLR Studio in Programmation Sous Linux
	Magazine!
In-Reply-To: <41fed8f80603281524w42a404d6p573dd1fe0a8d55e1@mail.gmail.com>
References: <41fed8f80603261232x3b2cd124s5c7e0d5c1feac1be@mail.gmail.com>
	<41fed8f80603281524w42a404d6p573dd1fe0a8d55e1@mail.gmail.com>
Message-ID: <41fed8f80603290947j437c31f2k9288341b425ae9d5@mail.gmail.com>

Ok, I have posted the scans in my blog :)

Find everything here -
http://placidsystems.com/blog/2006/03/antlr-studio-featured-in-programmation.html


Enjoy,
--
Prashant Deva
Creator, ANTLR Studio
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060329/0ced27b7/attachment.html
From aldana at gmx.de  Wed Mar 29 11:14:55 2006
From: aldana at gmx.de (manuel aldana)
Date: Wed Mar 29 11:15:02 2006
Subject: [antlr-interest] Change token-type in AST
Message-ID: <442ADCAF.6040204@gmx.de>

hi,

i've got a problem with changing the type of an AST node. i am 
generating a python parser.

just the nitty part i am struggling with (abbreviated):

--------------------------------------
foo: IDENTIFIER IDENTIFIER
--------------------------------------

i am building an AST for that grammar.
if it comes to foo i want the first IDENTIFIER (-> any combination of 
letters) to change to a different token-type:

--------------------------------------
token{OTHER_TOKEN;}
....
foo: i:IDENTIFIER {i.setType(OTHER_TOKEN)} IDENTIFIER
--------------------------------------

unfortunately, if i build an AST and get to the respective node, its 
token-type is still IDENTIFIER :(.

my questions:
1)does the AST only take token-types which stand "directly" in the grammar?
2)does it go a different way to change token-type for an AST node?
3)(most likely not, but) could that be a bug?

thank you very much!!



-- 
  manuel aldana
  aldana@gmx.de
  aldana@cs.tu-berlin.de
	
From kalle at snigel.net  Wed Mar 29 12:06:41 2006
From: kalle at snigel.net (karl wettin)
Date: Wed Mar 29 12:04:23 2006
Subject: [antlr-interest] Assignment from token reference only allowed in
	lexer
In-Reply-To: <77CE9E0F-2FF3-4031-9F8A-3188EF575DD5@snigel.net>
References: <77CE9E0F-2FF3-4031-9F8A-3188EF575DD5@snigel.net>
Message-ID: <5DE1B02D-BCF3-42F8-B401-9C123C366C69@snigel.net>

28 mar 2006 kl. 21.00 skrev karl wettin:


> Basically I'm trying to use Antlr as a natrual language parser.
>

I've been suggested to move most of my lexer code to a parser. So I  
did. But now I get this error I don't understand.

Assignment from token reference only allowed in lexer.

What am I supposed to do? I can't more the rule to the Parser, it has  
a 0..9.

class TestParser extends Parser;
options {
	k=1;
}

expr
{int v;}
	: v = EN_NATURAL_NUMBER
	;

class TestLexer extends Lexer;
options {
	k=2;
	testLiterals=false;
}

protected EN_NATURAL_NUMBER returns [int v] :
     | ('0'..'9')+ { v=Integer.valueOf($getText); }
     | "one"     { v=1; }
     | "two"     { v=2; }
     | "three"   { v=3; }
     | "four"    { v=4; }
     | "five"    { v=5; }
     | "six"     { v=6; }
     | "seven"   { v=7; }
     | "eight"   { v=8; }
     | "nine"    { v=9; }
     | "ten"     { v=10;}
     ;


From kalle at snigel.net  Wed Mar 29 14:38:20 2006
From: kalle at snigel.net (karl wettin)
Date: Wed Mar 29 14:36:04 2006
Subject: [antlr-interest] solution: Assignment from token reference only
	allowed in lexer
In-Reply-To: <5DE1B02D-BCF3-42F8-B401-9C123C366C69@snigel.net>
References: <77CE9E0F-2FF3-4031-9F8A-3188EF575DD5@snigel.net>
	<5DE1B02D-BCF3-42F8-B401-9C123C366C69@snigel.net>
Message-ID: <3A609F48-920F-4C26-93FA-33F080E1BB0D@snigel.net>


29 mar 2006 kl. 22.06 skrev karl wettin:

> 28 mar 2006 kl. 21.00 skrev karl wettin:
>
>
> Assignment from token reference only allowed in lexer.
>
> What am I supposed to do? I can't more the rule to the Parser, it  
> has a 0..9.

I move only the one, two... and keep the 0..9 in the lexer, of course.





> class TestParser extends Parser;
> options {
> 	k=1;
> }
>
> expr
> {int v;}
> 	: v = EN_NATURAL_NUMBER
> 	;
>
> class TestLexer extends Lexer;
> options {
> 	k=2;
> 	testLiterals=false;
> }
>
> protected EN_NATURAL_NUMBER returns [int v] :
>     | ('0'..'9')+ { v=Integer.valueOf($getText); }
>     | "one"     { v=1; }
>     | "two"     { v=2; }
>     | "three"   { v=3; }
>     | "four"    { v=4; }
>     | "five"    { v=5; }
>     | "six"     { v=6; }
>     | "seven"   { v=7; }
>     | "eight"   { v=8; }
>     | "nine"    { v=9; }
>     | "ten"     { v=10;}
>     ;
>
>
>

From kalle at snigel.net  Wed Mar 29 15:14:23 2006
From: kalle at snigel.net (karl wettin)
Date: Wed Mar 29 15:12:08 2006
Subject: [antlr-interest] line 0:0: expecting
Message-ID: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>

Ok, I think the grammar is working now. No nondeterminism or anything.

Running main in the parser below now produce this:

> season 1 jo men visst
> line 0:0: expecting EN_NATURAL_SEASON, found ''
>
> s1e1
> line 0:0: expecting EN_NATURAL_SEASON, found ''

Have I misunderstood how to combine a parser and a lexer? Too me that  
error sounds like there is no input.


header {
	package se.snigel.tindex.analysis.tvserie;
	import java.util.*;
	import java.io.*;
	
	import antlr.CommonToken;
	import antlr.Token;	
}


class TVSerieEpisodeParser extends Parser;
options {
	k=1;
}
{
	public class SeasonAndEpisode {
		private int season;
		private int episode;
		private SeasonAndEpisode(int season, int episode) {
			this.season = season;
			this.episode = episode;
		}
		public int getSeason() {
			return season;
		}
		public int getEpisode() {
			return episode;
		}
		public String toString() {
			return season + "x" + episode;
		}
	}

	private LinkedList<SeasonAndEpisode> episodes = new  
LinkedList<SeasonAndEpisode>();
	private LinkedList<Integer> seasons = new LinkedList<Integer>();

	/** for sanity checks */
	private Long fileSize;

	private void addSequence(boolean skipFirstEpisode, Integer  
fromSeason, Integer fromEpisode, Integer toSeason, Integer toEpisode) {
         int startEpisode = fromEpisode;
         int endEpisode;
         if (fromSeason == toSeason) {
             endEpisode = toEpisode;
         } else {
             throw new RuntimeException("Need to figure out the last  
episode of this season.");
         }

         LinkedList<SeasonAndEpisode> saes = new  
LinkedList<SeasonAndEpisode>();

         for (int season = fromSeason; season <= toSeason; season++) {
             for (int episode = startEpisode; episode <= endEpisode;  
episode++) {
                 saes.add(new SeasonAndEpisode(season, episode));
             }
             startEpisode = 1;
         }

         if (skipFirstEpisode) {
			saes.removeFirst();
         }

         // how big is the file, and how many episodes are there?
         if (fileSize != null) {
             if (120 * 1024 * saes.size() <= fileSize) {
                 episodes.addAll(saes);
             } else {
                 // todo could it be S1 - 7 as in s1e7?
             }
         }

     }

     public String toString() {
     		StringBuffer buf = new StringBuffer();
     		for (SeasonAndEpisode sae : episodes) {
     			buf.append(sae);
			buf.append('\n');
     		}
     		for (Integer s : seasons) {
     			buf.append(s);
			buf.append('\n');
     		}

     		return buf.toString();
     }

	public static void main(String[] args) throws Exception {

		String[] testText = new String[]{
			"season 1 jo men visst",
			"s1e1",
			"s1",
			"s 1",
			"season 1",
			"season 1 episode 3",
			"s1,s2,s3",
			"s1-s3",
			"s1e3-4",
			"s1 e4, 5, 6",
			"season one will fail. how do I handle the EN_NATURAL_NUMBER int?",
			"s1 - 4 is this really four seasons? sanity check. is it s1e4?",
			"s1e19-s2e12 what is the last episode of season 1?",
		};

		for (String text : testText) {
			System.out.println(text);
			TVSerieEpisodeLexer lexer = new TVSerieEpisodeLexer(new  
StringReader(text));
			TVSerieEpisodeParser parser = new TVSerieEpisodeParser(lexer);
			parser.en_NATURAL();
			System.out.println(parser);
		}
	}

}

en_NATURAL
{
	int startSeason;
}
  	:	EN_NATURAL_SEASON (WHITESPACE)?
		startSeason = en_NATURAL_NUMBER
		(	
			en_NATURAL_EPISODE[startSeason]
			| en_NATURAL_SEASON[startSeason]
		)
	;


en_NATURAL_NUMBER returns [int n=-1;]
	: NUMBER	    {n=1;}
	| "one"     { n=1; }
     | "two"     { n=2; }
     | "three"   { n=3; }
     | "four"    { n=4; }
     | "five"    { n=5; }
     | "six"     { n=6; }
     | "seven"   { n=7; }
     | "eight"   { n=8; }
     | "nine"    { n=9; }
     | "ten"     { n=10;}
     ;

en_NATURAL_EPISODE [int startSeason]
{
	System.out.println("specific episode(s)");
	int startEpisode;
}
	:
	EN_NATURAL_EPISODE (WHITESPACE)?
	startEpisode = en_NATURAL_NUMBER
	{
		// add inital episode
		episodes.add(new SeasonAndEpisode(startSeason, startEpisode));
	}	
	(	en_NATURAL_EPISODE_SEQUENCE [startSeason, startEpisode]
	|	en_NATURAL_EPISODE_VECTOR [startSeason, startEpisode]
	)
	;

en_NATURAL_EPISODE_SEQUENCE [int startSeason, int startEpisode]
{
	System.out.println("episode sequence");
}
	:

	// sequence
	EN_NATURAL_SEQUENCE (WHITESPACE)?
	(
	    EN_NATURAL_SEASON (WHITESPACE)?
	    episodeSequenceEndSeason:EN_NATURAL_NUMBER (WHITESPACE)?	
	)?
	EN_NATURAL_EPISODE (WHITESPACE)?
	episodeSequenceEndEpisode:EN_NATURAL_NUMBER
	{
		// true cuts of the first episode in the list. it is already added.
		addSequence(true,
			startSeason,
			startEpisode,
			episodeSequenceEndSeason == null ? startSeason : new Integer 
(episodeSequenceEndSeason.getText()),
			new Integer(episodeSequenceEndEpisode.getText())
		);
	}    	    		
	;

en_NATURAL_EPISODE_VECTOR [int startSeason, int startEpisode]
{
	int episodeVectorAndSeason;
	int episodeVectorAndEpisode;
}
	:
	{System.out.println("episode vector");}	    		
	// vector
	{
		Integer lastSeenSeason = startSeason;
		// this is already done. episodes.add(new SeasonAndEpisode 
(startSeason, startEpisode));				
	}
	(	    			
		EN_NATURAL_VECTOR (WHITESPACE)?
		(
			EN_NATURAL_SEASON (WHITESPACE)?
			episodeVectorAndSeason = en_NATURAL_NUMBER (WHITESPACE)?
			{
				lastSeenSeason = episodeVectorAndSeason;	
			}
		)?
		EN_NATURAL_EPISODE (WHITESPACE)?
	
		episodeVectorAndEpisode = en_NATURAL_NUMBER (WHITESPACE)?
		{
	    		episodes.add(new SeasonAndEpisode(lastSeenSeason,  
episodeVectorAndEpisode));
	    }
	)+
	;

en_NATURAL_SEASON [int startSeason]
{
	System.out.println("full season(s)");
	// add inital season
	seasons.add(startSeason);
	// todo sanity check file size
}
	:	en_NATURAL_SEASON_SEQUENCE [startSeason]
	|	en_NATURAL_SEASON_VECTOR [startSeason]
	;	

en_NATURAL_SEASON_SEQUENCE [int startSeason]
{
	System.out.println("sequence of seasons.");		
	int seasonSequenceEndSeason;
}
	:
	EN_NATURAL_SEQUENCE (WHITESPACE)?
	(EN_NATURAL_SEASON (WHITESPACE)?)?
     seasonSequenceEndSeason = en_NATURAL_NUMBER			
     {
     		for (int i= startSeason + 1; i <= seasonSequenceEndSeason; i++) {
			seasons.add(i);
			// todo sanity check file size	
     		}		
     }		    	    		
	;

en_NATURAL_SEASON_VECTOR [int startSeason]
{
	System.out.println("vector of seasons");
	int seasonVectorAndSeason;
}
	:			
	(								
         EN_NATURAL_VECTOR (WHITESPACE)?
         (
             (EN_NATURAL_SEASON (WHITESPACE)?)?
             seasonVectorAndSeason = en_NATURAL_NUMBER (WHITESPACE)?
             {		            		
             		seasons.add(seasonVectorAndSeason);
             }
         )
     )+
	;



class TVSerieEpisodeLexer extends Lexer;

options {
	k=2;
	testLiterals=false;
}


protected WHITESPACE
	: ('.' | ' ')+
	;

protected EN_NATURAL_SEASON
	: 's' ("eason" ('s')?)?
	;

protected EN_NATURAL_EPISODE
	: 'e'('p'(("isode"('s')?) | 's')?)?
	;

protected EN_NATURAL_VECTOR
	: "and" | ","
	;

protected EN_NATURAL_SEQUENCE
	: "to" 	| "through" 	| "-"
	;

protected NUMBER returns [int v]
	: ('0'..'9')+ { v=Integer.valueOf($getText); }
     ;

	
From fermin.reig at gmail.com  Thu Mar 30 13:48:36 2006
From: fermin.reig at gmail.com (F Reig)
Date: Thu Mar 30 13:48:39 2006
Subject: [antlr-interest] Manual tree construction in 2.7.6 (buggy?)
In-Reply-To: <000a01c651f7$f7868cc0$6702a8c0@hercules>
References: <4f1b77310603271427y922b01bn4d51aa801b0d2bab@mail.gmail.com>
	<000a01c651f7$f7868cc0$6702a8c0@hercules>
Message-ID: <4f1b77310603301348p79e6400uc82622d5cd7cbe95@mail.gmail.com>

On 3/28/06, Micheal J <open.zone@virgin.net> wrote:
> > I construct the tree by hand like this:
> >
> > decl_default!
> >     : d:DEFAULT i:IDENT COMMA e:exp SEMI
> >
> >        {## = #(#d, #([IF,":IF"],
> >                      #([EQ_EQ,"=="],#i,#([NIL,"NIL"])),
> >                      #([STMTS,"STMTS"],
> >                            #([EXPR,"EXPR"],
> > #([BECOMES,"BECOMES"],#i,#e))
> >                       )
> >                     )
> >               );
> >        }
> >     ;
> >
> > When I dump the tree (or visualize it with antlr.astframe) I see this:
> >
> > ( :DEFAULT ( :IF ( == x NIL 1) ( STMTS ( EXPR ( BECOMES x NIL 1 )))))
> >
> > That is, there is a spurious "1" in the test, and a spurious
> > "NIL" in the assignment. Yet, the tree constructor looks OK
> > to me. Am I doing something wrong
>
> Yes. You are trying to add the single IDENT node to two different AST
> [sub-]trees.
>
> You need to copy the node if you wish to use it multiple times. Use
> dupTree() for that and be sure to set the first-child and next-sibling links
> appropriately.
>
> Cheers,
>
> Micheal

This seems to work:

         { AST i2 = astFactory.dupTree(#i);

         ## = #(#d, #([IF,":IF"],
                      #([EQ_EQ,"=="],#i,#([NIL,"NIL"])),
                      #([STMTS,"STMTS"],
                            #([EXPR,"EXPR"],
                                #([BECOMES,"BECOMES"], i2 ,#e)))));

And it seems that I don't need to set any links by hand. Thanks Micheal

I would suggest that a similar example be included in the manual.

Fermin
From fermin.reig at gmail.com  Thu Mar 30 14:10:14 2006
From: fermin.reig at gmail.com (F Reig)
Date: Thu Mar 30 15:13:46 2006
Subject: [antlr-interest] 2.7.6/examples/csharp/cpp broken (C#)
Message-ID: <4f1b77310603301410l12c2e29fmc4e2b684606fb582@mail.gmail.com>

Hi,

I need a nested lexer to handle included files, and I was looking at
the examples in the distribution for inspiration. I've generated C#
from  cpp.g and tested the resulting lexer with the sample input. I
get this output:

./cppLexer.exe < cpp.in
int a,b;

int x;
int z;

which is incorrect.

Can anyone else please verify this?  (I don't have access to Java in
this computer right now, so I cannot verify whether the same example
works OK when antlr generates Java. That would help diagnose the
problem as a bug in cpp.g or a bug in antlr generating C#)

Thanks in advance
Fermin
From kalle at snigel.net  Fri Mar 31 03:49:29 2006
From: kalle at snigel.net (karl wettin)
Date: Fri Mar 31 03:47:11 2006
Subject: [antlr-interest] line 0:0: expecting
In-Reply-To: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>
References: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>
Message-ID: <D2BBA467-915C-44C3-A2B8-348EF9D53930@snigel.net>


30 mar 2006 kl. 01.14 skrev karl wettin:

> Ok, I think the grammar is working now. No nondeterminism or anything.
>
> Running main in the parser below now produce this:
>
>> season 1 jo men visst
>> line 0:0: expecting EN_NATURAL_SEASON, found ''
>>
>> s1e1
>> line 0:0: expecting EN_NATURAL_SEASON, found ''
>
> Have I misunderstood how to combine a parser and a lexer? Too me  
> that error sounds like there is no input.

Nobody? I'm really stuck here. Can't find any references to this on  
the net, and I can't figure out the Antlr code that throws the  
exception. :(

From dimax at gmx.de  Fri Mar 31 04:20:28 2006
From: dimax at gmx.de (Dima)
Date: Fri Mar 31 04:20:33 2006
Subject: [antlr-interest] How get the parsing progress from parser?
Message-ID: <20060331122031.741CADCC66@www.antlr.org>

Hi,

 

I've a C# Parser and I'm runing this as a thread.

My problem is, I need some feedback from parser (e.g. if parsing process
complete)

 

How can I change my grammer to get Events from parser?

 

Thank you!!!

 

--

  Demetrius Axenowski

  dimax@gmx.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060331/361b8204/attachment.html
From ric.klaren at gmail.com  Fri Mar 31 05:53:28 2006
From: ric.klaren at gmail.com (Ric Klaren)
Date: Fri Mar 31 05:53:30 2006
Subject: [antlr-interest] line 0:0: expecting
In-Reply-To: <D2BBA467-915C-44C3-A2B8-348EF9D53930@snigel.net>
References: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>
	<D2BBA467-915C-44C3-A2B8-348EF9D53930@snigel.net>
Message-ID: <bc607a4e0603310553h1a8145dme35ec14898c9b536@mail.gmail.com>

On 3/31/06, karl wettin <kalle@snigel.net> wrote:
> 30 mar 2006 kl. 01.14 skrev karl wettin:
> > Ok, I think the grammar is working now. No nondeterminism or anything.
> >
> > Running main in the parser below now produce this:
> >
> >> season 1 jo men visst
> >> line 0:0: expecting EN_NATURAL_SEASON, found ''
> >>
> >> s1e1
> >> line 0:0: expecting EN_NATURAL_SEASON, found ''
> >
> > Have I misunderstood how to combine a parser and a lexer? Too me
> > that error sounds like there is no input.
>
> Nobody? I'm really stuck here. Can't find any references to this on
> the net, and I can't figure out the Antlr code that throws the
> exception. :(

(sorry haven't had time to look at previous posts/grammars)

Try generating the parser with -traceParser and rebuild then see if
the trace output gives you some insight. You can also enable tracing
for the other parts of the antlr generated code see the documentation
on the options (or antlr --help)

Cheers,

Ric
From fermin.reig at gmail.com  Fri Mar 31 06:59:16 2006
From: fermin.reig at gmail.com (F Reig)
Date: Fri Mar 31 06:59:23 2006
Subject: [antlr-interest] antlr 2.7.6 C# bug confirmed. Re:
	2.7.6/examples/csharp/cpp broken (C#)
Message-ID: <4f1b77310603310659h6cd49684ofbfd31ae30db2a1f@mail.gmail.com>

On 3/30/06, F Reig <fermin.reig@gmail.com> wrote:
>
> Hi,
>
> I need a nested lexer to handle included files, and I was looking at
> the examples in the distribution for inspiration. I've generated C#
> from  cpp.g and tested the resulting lexer with the sample input. I
> get this output:
>
> ./cppLexer.exe < cpp.in
> int a,b;
>
> int x;
> int z;
>
> which is incorrect.
>
> Can anyone else please verify this?  (I don't have access to Java in
> this computer right now, so I cannot verify whether the same example
> works OK when antlr generates Java. That would help diagnose the
> problem as a bug in cpp.g or a bug in antlr generating C#)


I've checked this with antlr generating Java, and it works as expected:

java -classpath .:$CLASSPATH cpp < cpp.in
int a,b;
int x;
int z;
int y;
int c;

This suggests that there is a bug in antlr itself (2.7.6), either in the C#
library, or (less likely) in the C# code generator.

Fermin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20060331/eb34c98b/attachment.html
From Jeff.Barnes at codesic.com  Fri Mar 31 12:45:48 2006
From: Jeff.Barnes at codesic.com (Jeff Barnes)
Date: Fri Mar 31 12:44:19 2006
Subject: [antlr-interest] Lexer StringTemplate error/stack trace
Message-ID: <FC6B2BF8B2FE854EAE0C380E55CA5734119DA2@hq-app2.CODESIC.COM>

Can someone help me find a work around for this problem?
 
Can't parse chunk: &quot;#,##0.00"/>

</Style>

<Style ss:ID="s25">

<NumberFormat ss:Format="&quot;$&quot;#,##0.00"/>

</Style>

<Style ss:ID="s26">

<Alignment ss:Vertical="Top" ss:WrapText="1"/>

<NumberFormat ss:Format="Percent"/>

</Style>

<Style ss:ID="s27">

<NumberFormat ss:Format="Percent"/>

</Style>

<Style ss:ID="s28">

<NumberFormat/>

</Style>

</Styles>

<Worksheet ss:Name="National">

<Table ss:ExpandedColumnCount="19" ss:ExpandedRowCount="8" x:FullColumns="1"

x:FullRows="1">

<Row ss:Height="38.25" ss:StyleID="s23">

<Cell ss:StyleID="s22"><Data ss:Type="String">Credit Class</Data></Cell>

line 1:1: unexpected char: '&'

at org.antlr.stringtemplate.language.ActionLexer.nextToken(ActionLexer.java:217)

at antlr.TokenBuffer.fill(TokenBuffer.java:69)

at antlr.TokenBuffer.LA(TokenBuffer.java:80)

at antlr.LLkParser.LA(LLkParser.java:52)

at org.antlr.stringtemplate.language.ActionParser.action(ActionParser.java:105)

at org.antlr.stringtemplate.StringTemplate.parseAction(StringTemplate.java:845)

at org.antlr.stringtemplate.language.TemplateParser.action(TemplateParser.java:151)

at org.antlr.stringtemplate.language.TemplateParser.template(TemplateParser.java:119)

at org.antlr.stringtemplate.StringTemplate.breakTemplateIntoChunks(StringTemplate.java:821)

at org.antlr.stringtemplate.StringTemplate.setTemplate(StringTemplate.java:428)

at org.antlr.stringtemplate.language.GroupParser.template(GroupParser.java:204)

at org.antlr.stringtemplate.language.GroupParser.group(GroupParser.java:123)

at org.antlr.stringtemplate.StringTemplateGroup.parseGroup(StringTemplateGroup.java:500)

at org.antlr.stringtemplate.StringTemplateGroup.<init>(StringTemplateGroup.java:205)

at org.antlr.stringtemplate.StringTemplateGroup.<init>(StringTemplateGroup.java:183)

at com.cingular.orbit.reporting.AbstractTemplateReport.loadTemplate(AbstractTemplateReport.java:72)

at com.cingular.orbit.reporting.oca.OcaCreditClassSummaryReport.<init>(OcaCreditClassSummaryReport.java:38)

at com.cingular.orbit.reporting.oca.OcaCreditClassSummaryReportTest$test.<init>(OcaCreditClassSummaryReportTest.java:18)

at com.cingular.orbit.reporting.oca.OcaCreditClassSummaryReportTest.setUp(OcaCreditClassSummaryReportTest.java:49)

at junit.framework.TestCase.runBare(TestCase.java:125)

at junit.framework.TestResult$1.protect(TestResult.java:106)

at junit.framework.TestResult.runProtected(TestResult.java:124)

at junit.framework.TestResult.run(TestResult.java:109)

at junit.framework.TestCase.run(TestCase.java:118)

at junit.framework.TestSuite.runTest(TestSuite.java:208)

at junit.framework.TestSuite.run(TestSuite.java:203)

at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:478)

at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:344)

at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)

 
From parrt at cs.usfca.edu  Fri Mar 31 13:12:10 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri Mar 31 13:12:14 2006
Subject: [antlr-interest] Lexer StringTemplate error/stack trace
In-Reply-To: <FC6B2BF8B2FE854EAE0C380E55CA5734119DA2@hq-app2.CODESIC.COM>
References: <FC6B2BF8B2FE854EAE0C380E55CA5734119DA2@hq-app2.CODESIC.COM>
Message-ID: <7CFA6CD6-762A-4A11-AD80-622B321CFE38@cs.usfca.edu>


On Mar 31, 2006, at 12:45 PM, Jeff Barnes wrote:

> Can someone help me find a work around for this problem?
>
> Can't parse chunk: &quot;#,##0.00"/>
>
> </Style>
>
> <Style ss:ID="s25">
>
> <NumberFormat ss:Format="&quot;$&quot;#,##0.00"/>

That & after the $ is the problem...use \$
Ter
From kalle at snigel.net  Fri Mar 31 16:48:50 2006
From: kalle at snigel.net (karl wettin)
Date: Fri Mar 31 16:46:32 2006
Subject: [antlr-interest] line 0:0: expecting
In-Reply-To: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>
References: <B409D6D8-AC06-43D7-AAE2-7888235E2FB4@snigel.net>
Message-ID: <444AE7CB-9539-4DE0-A869-2618CCF8B0E9@snigel.net>


30 mar 2006 kl. 01.14 skrev karl wettin:

>> line 0:0: expecting EN_NATURAL_SEASON, found ''
>
> Have I misunderstood how to combine a parser and a lexer? Too me  
> that error sounds like there is no input.

This is an error you get when you are calling protected Lexer rules  
from the Parser.

It should really be mentioned somewhere. It is not. I'm actually  
suprised that Antlr accepts the code!

And now I got some new problems, of course :)


header {
	package se.snigel.tindex.analysis.tvserie;
	import java.util.*;
	import java.io.*;
	
	import antlr.CommonToken;
	import antlr.Token;	
}


class TVSerieEpisodeParser extends Parser;
options {
	k=1;
}
{
	public class SeasonAndEpisode {
		private int season;
		private int episode;
		private SeasonAndEpisode(int season, int episode) {
			this.season = season;
			this.episode = episode;
		}
		public int getSeason() {
			return season;
		}
		public int getEpisode() {
			return episode;
		}
		public String toString() {
			return season + "x" + episode;
		}
	}

	private LinkedList<SeasonAndEpisode> episodes = new  
LinkedList<SeasonAndEpisode>();
	private LinkedList<Integer> seasons = new LinkedList<Integer>();

	/** for sanity checks */
	private Long fileSize;

	private void addSequence(boolean skipFirstEpisode, Integer  
fromSeason, Integer fromEpisode, Integer toSeason, Integer toEpisode) {
         int startEpisode = fromEpisode;
         int endEpisode;
         if (fromSeason == toSeason) {
             endEpisode = toEpisode;
         } else {
             throw new RuntimeException("Need to figure out the last  
episode of this season.");
         }

         LinkedList<SeasonAndEpisode> saes = new  
LinkedList<SeasonAndEpisode>();

                 int size = 0;
         for (int season = fromSeason; season <= toSeason; season++) {
             for (int episode = startEpisode; episode <= endEpisode;  
episode++) {
                 saes.add(new SeasonAndEpisode(season, episode));
                 size++;
             }
             startEpisode = 1;
         }

         if (skipFirstEpisode) {
			saes.removeFirst();			
         }


         // how big is the file, and how many episodes are there?
         if (fileSize != null) {
             if (120 * 1024 * size <= fileSize) {
                 episodes.addAll(saes);
             } else {
                 // todo could it be S1 - 7 as in s1e7?
             }
         } else {
         		episodes.addAll(saes);
         }

     }

     public String toString() {
     		StringBuffer buf = new StringBuffer();
     		for (SeasonAndEpisode sae : episodes) {
     			buf.append(sae);
			buf.append('\n');
     		}
     		for (Integer s : seasons) {
     			buf.append(s);
			buf.append('\n');
     		}

     		return buf.toString();
     }

	public static void main(String[] args) throws Exception {

		String[] testText = new String[]{
			"season1",
			"s1e1",
			"s1",
			"s 1",
			"season 1",
			"season 1 episode 3",
			"s1,s2,s3",
			"s1-s3",
			"s1e3-4",
			"s1 e4, 5, 6",
			"season one will fail. how do I handle the EN_NATURAL_NUMBER int?",
			"s1 - 4 is this really four seasons? sanity check. is it s1e4?",
			"s1e19-s2e12 what is the last episode of season 1?",
		};

		for (String text : testText) {
			System.out.println(text);
			TVSerieEpisodeLexer lexer = new TVSerieEpisodeLexer(new  
StringReader(text));
			TVSerieEpisodeParser parser = new TVSerieEpisodeParser(lexer);
			parser.en_NATURAL();
			System.out.println(parser);
		}
	}

}

en_NATURAL
{
	int startSeason;
		StringBuffer prefix = new StringBuffer();
	StringBuffer suffix = new StringBuffer();
}
  	:	
		NATURAL_SEASON
		(WHITESPACE)?
		startSeason = en_NATURAL_NUMBER
		(WHITESPACE)?
		(	
			//en_NATURAL_EPISODE[startSeason]
			(
				{
					System.out.println("specific episode(s)");
					int startEpisode;
				}
					
				NATURAL_EPISODE (WHITESPACE)?
				startEpisode = en_NATURAL_NUMBER
				{
					// add inital episode
					episodes.add(new SeasonAndEpisode(startSeason, startEpisode));
				}	
				(	en_NATURAL_EPISODE_SEQUENCE [startSeason, startEpisode] |  
en_NATURAL_EPISODE_VECTOR [startSeason, startEpisode])?
			)
			| //en_NATURAL_SEASON[startSeason]
			(
				{
					System.out.println("full season(s)");
					// add inital season
					seasons.add(startSeason);
					// todo sanity check file size
				}
				(	en_NATURAL_SEASON_SEQUENCE [startSeason] |  
en_NATURAL_SEASON_VECTOR [startSeason])?
			)
		)	
	;


en_NATURAL_NUMBER returns [int n=-1;]
     : v:NUMBER  { n = Integer.valueOf(v.getText()); }
     | "one"     { n=1; }
     | "two"     { n=2; }
     | "three"   { n=3; }
     | "four"     { n=4; }
     | "five"      { n=5; }
     | "six"       { n=6; }
     | "seven"   { n=7; }
     | "eight"   { n=8; }
     | "nine"    { n=9; }
     | "ten"     { n=10;}
     ;

//en_NATURAL_EPISODE [int startSeason]


en_NATURAL_EPISODE_SEQUENCE [int startSeason, int startEpisode]
{
	System.out.println("episode sequence");
	Integer episodeSequenceEndSeason = null;
	int episodeSequenceEndEpisode;
}
	:

	// sequence
	NATURAL_SEQUENCE (WHITESPACE)?
	(
	    NATURAL_SEASON (WHITESPACE)?
	    episodeSequenceEndSeason = en_NATURAL_NUMBER (WHITESPACE)?	
	)?
	(NATURAL_EPISODE (WHITESPACE))?
	episodeSequenceEndEpisode = en_NATURAL_NUMBER
	{
		// true cuts of the first episode in the list. it is already added.
		addSequence(true,
			startSeason,
			startEpisode,
			episodeSequenceEndSeason == null ? startSeason :  
episodeSequenceEndSeason,
			episodeSequenceEndEpisode
		);
	}    	    		
	;

en_NATURAL_EPISODE_VECTOR [int startSeason, int startEpisode]
{
	int episodeVectorAndSeason;
	int episodeVectorAndEpisode;
}
	:
	{System.out.println("episode vector");}	    		
	// vector
	{
		Integer lastSeenSeason = startSeason;
		// this is already done. episodes.add(new SeasonAndEpisode 
(startSeason, startEpisode));				
	}
	(	    			
		NATURAL_VECTOR (WHITESPACE)?
		(
			NATURAL_SEASON (WHITESPACE)?
			episodeVectorAndSeason = en_NATURAL_NUMBER (WHITESPACE)?
			{
				lastSeenSeason = episodeVectorAndSeason;	
			}
		)?
		NATURAL_EPISODE (WHITESPACE)?
	
		episodeVectorAndEpisode = en_NATURAL_NUMBER (WHITESPACE)?
		{
	    		episodes.add(new SeasonAndEpisode(lastSeenSeason,  
episodeVectorAndEpisode));
	    }
	)+
	;

//en_NATURAL_SEASON [int startSeason]

en_NATURAL_SEASON_SEQUENCE [int startSeason]
{
	System.out.println("sequence of seasons.");		
	int seasonSequenceEndSeason;
}
	:
	NATURAL_SEQUENCE (WHITESPACE)?
	(NATURAL_SEASON (WHITESPACE)?)?
     seasonSequenceEndSeason = en_NATURAL_NUMBER			
     {
     		for (int i= startSeason + 1; i <= seasonSequenceEndSeason; i++) {
			seasons.add(i);
			// todo sanity check file size	
     		}		
     }		    	    		
	;

en_NATURAL_SEASON_VECTOR [int startSeason]
{
	System.out.println("vector of seasons");
	int seasonVectorAndSeason;
}
	:			
	(								
         NATURAL_VECTOR
         (NATURAL_SEASON (WHITESPACE)?)?
         seasonVectorAndSeason = en_NATURAL_NUMBER (WHITESPACE)?
         {		            		
         		seasons.add(seasonVectorAndSeason);
         }
     )+
	;



class TVSerieEpisodeLexer extends Lexer;

options {
	k=2;
	testLiterals=false;
}


WHITESPACE
	: ('.' | " ")+
	;

NATURAL_SEASON
	: 's' ("eason" ('s')?)?
	;

NATURAL_EPISODE
	: 'e'('p'(("isode"('s')?) | 's')?)?
	;

NATURAL_VECTOR
	: "and" | ","
	;

NATURAL_SEQUENCE
	: "to" | "through" | "-"
	;

NUMBER
	: ('0'..'9')+
     ;

PUNCTSPACE
	: ('!'
	| '"'
	| '#'
	| '$'
	| '%'
	| '&'
	| '('
	| ')'
	| '*'
	| '+'
	| "|"
	| '-'
	| '.'
	 | '/'
	  | ':'
	  | ';'
	  | '<'
	  | '='
	  | '>'
	  | '?'
	  | '@'
	  | '['
	| '\\'
	| ']'
	| '^'
	| '_'
	| '`'
	| '{'
	 | '}'
	 | '~'
	 | ' ')+	
	;

	
